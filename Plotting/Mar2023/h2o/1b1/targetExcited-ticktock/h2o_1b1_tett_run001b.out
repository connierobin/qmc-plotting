Rank =    0  Free Memory = 74159 MB
Rank =    1  Free Memory = 74159 MB
Rank =    2  Free Memory = 74159 MB
Rank =    3  Free Memory = 74159 MB
Rank =    4  Free Memory = 74159 MB
Rank =    5  Free Memory = 74159 MB
Rank =    6  Free Memory = 74159 MB
Rank =    7  Free Memory = 74159 MB
Rank =    8  Free Memory = 74159 MB
Rank =    9  Free Memory = 74158 MB
Rank =   10  Free Memory = 74158 MB
Rank =   11  Free Memory = 74158 MB
Rank =   12  Free Memory = 74158 MB
Rank =   13  Free Memory = 74158 MB
Rank =   14  Free Memory = 74157 MB
Rank =   15  Free Memory = 74146 MB
Rank =   16  Free Memory = 74144 MB
Rank =   17  Free Memory = 74144 MB
Rank =   18  Free Memory = 74144 MB
Rank =   19  Free Memory = 74144 MB
Rank =   20  Free Memory = 74143 MB
Rank =   21  Free Memory = 74143 MB
Rank =   22  Free Memory = 74143 MB
Rank =   23  Free Memory = 74143 MB
Rank =   24  Free Memory = 74143 MB
Rank =   25  Free Memory = 74143 MB
Rank =   26  Free Memory = 74143 MB
Rank =   27  Free Memory = 74143 MB
Rank =   28  Free Memory = 74143 MB
Rank =   29  Free Memory = 74143 MB
Rank =   30  Free Memory = 74143 MB
Rank =   31  Free Memory = 74143 MB
Rank =   32  Free Memory = 85154 MB
Rank =   33  Free Memory = 85154 MB
Rank =   34  Free Memory = 85154 MB
Rank =   35  Free Memory = 85154 MB
Rank =   36  Free Memory = 85154 MB
Rank =   37  Free Memory = 85154 MB
Rank =   38  Free Memory = 85154 MB
Rank =   39  Free Memory = 85154 MB
Rank =   40  Free Memory = 85154 MB
Rank =   41  Free Memory = 85154 MB
Rank =   42  Free Memory = 85154 MB
Rank =   43  Free Memory = 85154 MB
Rank =   44  Free Memory = 85154 MB
Rank =   45  Free Memory = 85154 MB
Rank =   46  Free Memory = 85154 MB
Rank =   47  Free Memory = 85154 MB
Rank =   48  Free Memory = 85154 MB
Rank =   49  Free Memory = 85154 MB
Rank =   50  Free Memory = 85154 MB
Rank =   51  Free Memory = 85154 MB
Rank =   52  Free Memory = 85154 MB
Rank =   53  Free Memory = 85154 MB
Rank =   54  Free Memory = 85154 MB
Rank =   55  Free Memory = 85154 MB
Rank =   56  Free Memory = 85154 MB
Rank =   57  Free Memory = 85154 MB
Rank =   58  Free Memory = 85154 MB
Rank =   59  Free Memory = 85154 MB
Rank =   60  Free Memory = 85154 MB
Rank =   61  Free Memory = 85154 MB
Rank =   62  Free Memory = 85154 MB
Rank =   63  Free Memory = 85154 MB
Rank =   64  Free Memory = 84592 MB
Rank =   65  Free Memory = 84592 MB
Rank =   66  Free Memory = 84592 MB
Rank =   67  Free Memory = 84592 MB
Rank =   68  Free Memory = 84592 MB
Rank =   69  Free Memory = 84592 MB
Rank =   70  Free Memory = 84592 MB
Rank =   71  Free Memory = 84592 MB
Rank =   72  Free Memory = 84592 MB
Rank =   73  Free Memory = 84592 MB
Rank =   74  Free Memory = 84592 MB
Rank =   75  Free Memory = 84592 MB
Rank =   76  Free Memory = 84592 MB
Rank =   77  Free Memory = 84592 MB
Rank =   78  Free Memory = 84592 MB
Rank =   79  Free Memory = 84592 MB
Rank =   80  Free Memory = 84592 MB
Rank =   81  Free Memory = 84592 MB
Rank =   82  Free Memory = 84592 MB
Rank =   83  Free Memory = 84592 MB
Rank =   84  Free Memory = 84592 MB
Rank =   85  Free Memory = 84592 MB
Rank =   86  Free Memory = 84592 MB
Rank =   87  Free Memory = 84592 MB
Rank =   88  Free Memory = 84592 MB
Rank =   89  Free Memory = 84592 MB
Rank =   90  Free Memory = 84592 MB
Rank =   91  Free Memory = 84592 MB
Rank =   92  Free Memory = 84592 MB
Rank =   93  Free Memory = 84591 MB
Rank =   94  Free Memory = 84591 MB
Rank =   95  Free Memory = 84591 MB
Rank =   96  Free Memory = 84264 MB
Rank =   97  Free Memory = 84264 MB
Rank =   98  Free Memory = 84264 MB
Rank =   99  Free Memory = 84264 MB
Rank =  100  Free Memory = 84264 MB
Rank =  101  Free Memory = 84264 MB
Rank =  102  Free Memory = 84264 MB
Rank =  103  Free Memory = 84264 MB
Rank =  104  Free Memory = 84264 MB
Rank =  105  Free Memory = 84264 MB
Rank =  106  Free Memory = 84264 MB
Rank =  107  Free Memory = 84264 MB
Rank =  108  Free Memory = 84264 MB
Rank =  109  Free Memory = 84264 MB
Rank =  110  Free Memory = 84264 MB
Rank =  111  Free Memory = 84264 MB
Rank =  112  Free Memory = 84264 MB
Rank =  113  Free Memory = 84264 MB
Rank =  114  Free Memory = 84264 MB
Rank =  115  Free Memory = 84264 MB
Rank =  116  Free Memory = 84264 MB
Rank =  117  Free Memory = 84264 MB
Rank =  118  Free Memory = 84264 MB
Rank =  119  Free Memory = 84264 MB
Rank =  120  Free Memory = 84264 MB
Rank =  121  Free Memory = 84264 MB
Rank =  122  Free Memory = 84264 MB
Rank =  123  Free Memory = 84264 MB
Rank =  124  Free Memory = 84264 MB
Rank =  125  Free Memory = 84264 MB
Rank =  126  Free Memory = 84264 MB
Rank =  127  Free Memory = 84264 MB
  Input file(s): opt_h2o_1b1_tett_run001b.xml 

=====================================================
                    QMCPACK 3.7.9

       (c) Copyright 2003-  QMCPACK developers

                    Please cite:
 J. Kim et al. J. Phys. Cond. Mat. 30 195901 (2018)
      https://doi.org/10.1088/1361-648X/aab9c3

  Git branch: gvp
  Last git commit: a1d851bbe8d902a0d3168a885b757a378aeaab54-dirty
  Last git commit date: Mon Feb 13 11:52:39 2023 -0800
  Last git commit subject: Print param update magnitude and largest update
=====================================================
  Global options 

  Total number of MPI ranks = 128
  Number of MPI groups      = 1
  MPI group ID              = 0
  Number of ranks in group  = 128
  MPI ranks per node        = 32
  OMP 1st level threads     = 1
  OMP nested threading disabled or only 1 thread on the 2nd level

  Precision used in this calculation, see definitions in the manual:
  Base precision      = double
  Full precision      = double

  Structure-of-arrays (SoA) optimization enabled

  Input XML = opt_h2o_1b1_tett_run001b.xml

  Project = H2O
  date    = 2023-03-06 17:14:37 PST
  host    = n0117.savio3

 Random Number
 -------------
  Offset for the random number seeds based on time: 1021

  Range of prime numbers to use as seeds over processors and threads = 8147-9293


 Particle Set 
 ------------
  Name: e
  All the species have the same mass 1
  Particle set size: 8

 Particle Set 
 ------------
  Name: ion0
  All the species have the same mass 1
  Particle set size: 3

 Wavefunction setup: 
 ------------------- 
  Name: psi0

   Jastrow
   -------
    Name: J2   Type: Two-Body   Function: Bspline

    Radial function for species: u - u
     Number of parameters: 10
     Cusp: -0.25
     Cutoff radius: 10

     Name                        Value Type Recompute Use Index
     ---- ---------------------------- ---- --------- --- -----
     uu_0                 3.027108e-01    1         1  ON     0
     uu_1                 1.395499e-01    1         1  ON     1
     uu_2                 4.158458e-02    1         1  ON     2
     uu_3                -1.946409e-02    1         1  ON     3
     uu_4                -6.333239e-02    1         1  ON     4
     uu_5                -9.587524e-02    1         1  ON     5
     uu_6                -1.205706e-01    1         1  ON     6
     uu_7                -1.310580e-01    1         1  ON     7
     uu_8                -1.203232e-01    1         1  ON     8
     uu_9                -9.277332e-02    1         1  ON     9

    Radial function for species: u - d
     Number of parameters: 10
     Cusp: -5.000000e-01
     Cutoff radius: 1.000000e+01

     Name                        Value Type Recompute Use Index
     ---- ---------------------------- ---- --------- --- -----
     ud_0                 4.114416e-01    1         1  ON     0
     ud_1                 1.583401e-01    1         1  ON     1
     ud_2                 6.092685e-02    1         1  ON     2
     ud_3                 2.699750e-03    1         1  ON     3
     ud_4                -5.713986e-02    1         1  ON     4
     ud_5                -1.014997e-01    1         1  ON     5
     ud_6                -1.286687e-01    1         1  ON     6
     ud_7                -1.435029e-01    1         1  ON     7
     ud_8                -1.424319e-01    1         1  ON     8
     ud_9                -1.344547e-01    1         1  ON     9


   Jastrow
   -------
    Name: J1   Type: One-Body   Function: Bspline

    Radial function for element: O
     Number of parameters: 10
     Cusp: 0.000000e+00
     Cutoff radius: 1.000000e+01

     Name                        Value Type Recompute Use Index
     ---- ---------------------------- ---- --------- --- -----
     eO_0                -7.043100e-01    1         1  ON     0
     eO_1                -4.137154e-01    1         1  ON     1
     eO_2                -3.185752e-02    1         1  ON     2
     eO_3                 2.692030e-01    1         1  ON     3
     eO_4                 4.916456e-01    1         1  ON     4
     eO_5                 4.596091e-01    1         1  ON     5
     eO_6                 2.360353e-01    1         1  ON     6
     eO_7                -5.591968e-02    1         1  ON     7
     eO_8                -1.959242e-01    1         1  ON     8
     eO_9                -5.768884e-02    1         1  ON     9

    Radial function for element: H1
     Number of parameters: 10
     Cusp: 0.000000e+00
     Cutoff radius: 1.000000e+01

      Name                        Value Type Recompute Use Index
     ----- ---------------------------- ---- --------- --- -----
     eH1_0                -2.099404e-01    1         1  ON     0
     eH1_1                -1.274877e-01    1         1  ON     1
     eH1_2                -8.838243e-02    1         1  ON     2
     eH1_3                -3.738645e-02    1         1  ON     3
     eH1_4                 1.159942e-02    1         1  ON     4
     eH1_5                 4.473069e-02    1         1  ON     5
     eH1_6                 9.476145e-02    1         1  ON     6
     eH1_7                 1.381756e-01    1         1  ON     7
     eH1_8                 1.456924e-01    1         1  ON     8
     eH1_9                 3.283823e-02    1         1  ON     9

    Radial function for element: H2
     Number of parameters: 10
     Cusp: 0.000000e+00
     Cutoff radius: 1.000000e+01

      Name                        Value Type Recompute Use Index
     ----- ---------------------------- ---- --------- --- -----
     eH2_0                -2.088198e-01    1         1  ON     0
     eH2_1                -1.265485e-01    1         1  ON     1
     eH2_2                -8.741031e-02    1         1  ON     2
     eH2_3                -3.640778e-02    1         1  ON     3
     eH2_4                 1.289653e-02    1         1  ON     4
     eH2_5                 4.794967e-02    1         1  ON     5
     eH2_6                 1.006131e-01    1         1  ON     6
     eH2_7                 1.496008e-01    1         1  ON     7
     eH2_8                 1.537439e-01    1         1  ON     8
     eH2_9                 1.292423e-02    1         1  ON     9

  Created SPOSet builder named 'LCAOBSet' of type molecularorbital
  LCAO: SoaAtomicBasisSet<MultiQuintic,0>
  AO BasisSet for O
   Angular momentum expanded in cartesian functions x^lx y^ly z^lz according to Gamess
Using log grid with default values: ri = 1.000000e-06 rf = 1.000000e+02 npts = 1001
   R(n,l,m,s) 0 0 0 0
   R(n,l,m,s) 1 0 0 0
   R(n,l,m,s) 2 1 0 0
   R(n,l,m,s) 3 1 0 0
   R(n,l,m,s) 4 2 0 0
Expanding Ylm (angular function) according to Gamess using cartesian gaussians
Adding 1 cartesian gaussian orbitals for l= 0
Adding 1 cartesian gaussian orbitals for l= 0
Adding 3 cartesian gaussian orbitals for l= 1
Adding 3 cartesian gaussian orbitals for l= 1
Adding 6 cartesian gaussian orbitals for l= 2
  Setting cutoff radius 1.018591e+01

   Maximum Angular Momentum  = 2
   Number of Radial functors = 5
   Basis size                = 14

  AO BasisSet for H1
   Angular momentum expanded in cartesian functions x^lx y^ly z^lz according to Gamess
Using log grid with default values: ri = 1.000000e-06 rf = 1.000000e+02 npts = 1001
   R(n,l,m,s) 0 0 0 0
   R(n,l,m,s) 1 0 0 0
   R(n,l,m,s) 2 1 0 0
Expanding Ylm (angular function) according to Gamess using cartesian gaussians
Adding 1 cartesian gaussian orbitals for l= 0
Adding 1 cartesian gaussian orbitals for l= 0
Adding 3 cartesian gaussian orbitals for l= 1
  Setting cutoff radius 1.270574e+01

   Maximum Angular Momentum  = 1
   Number of Radial functors = 3
   Basis size                = 5

  AO BasisSet for H2
   Angular momentum expanded in cartesian functions x^lx y^ly z^lz according to Gamess
Using log grid with default values: ri = 1.000000e-06 rf = 1.000000e+02 npts = 1001
   R(n,l,m,s) 0 0 0 0
   R(n,l,m,s) 1 0 0 0
   R(n,l,m,s) 2 1 0 0
Expanding Ylm (angular function) according to Gamess using cartesian gaussians
Adding 1 cartesian gaussian orbitals for l= 0
Adding 1 cartesian gaussian orbitals for l= 0
Adding 3 cartesian gaussian orbitals for l= 1
  Setting cutoff radius 1.270574e+01

   Maximum Angular Momentum  = 1
   Number of Radial functors = 3
   Basis size                = 5

Creating SPOSet in SlaterDetBuilder::put(xmlNodePtr cur).
spo_name = spo-up
  Building SPOSet 'spo-up' with '' basis set.
Creating SPOSet in SlaterDetBuilder::put(xmlNodePtr cur).
spo_name = spo-dn
  Building SPOSet 'spo-dn' with '' basis set.
Using Bryan's algorithm for MultiSlaterDeterminant expansion. 
Creating base determinant (up) for MSD expansion. 
Creating base determinant (down) for MSD expansion. 
Found determinant list. 
Reading CI expansion.
Found 75 terms in the MSD expansion.
Norm of ci vector (sum of ci^2): 9.916972e-01
Norm of qchem ci vector (sum of qchem_ci^2): 0.000000e+00
Found 30 unique up determinants.
Found 30 unique down determinants.
Number of terms in pairs array: 20
Number of terms in pairs array: 20
CI coefficients are not optimizable. 
  FermionWF = MultiSlaterDeterminantFast
  QMCHamiltonian::addOperator Kinetic to H, physical Hamiltonian 
  QMCHamiltonian::addOperator ElecElec to H, physical Hamiltonian 
QMCHamiltonian::addOperatorType added type coulomb named ElecElec

  ECPotential builder for pseudopotential 

  Adding pseudopotential for O
   Linear grid  ri=0.000000e+00 rf=1.000000e+01 npts = 10001
    ECPComponentBuilder::buildSemiLocalAndLocal 
    Assuming Hartree unit
   Number of angular momentum channels 2
   Maximum angular momentum channel 1
   Creating a Linear Grid Rmax=1.075000e+00
  Using global grid with delta = 1.000000e-03
   Making L=1 a local potential with a radial cutoff of 9.999000e+00
    Non-local pseudopotential parameters
    Maximum angular mementum = 0
    Number of non-local channels = 1
       l(0)=0
    Cutoff radius = 1.075000e+00
    Spherical grids and weights: 
         1.0000000000e+00  0.0000000000e+00  0.0000000000e+00    8.3333333333e-02
        -1.0000000000e+00  1.2246467991e-16  0.0000000000e+00    8.3333333333e-02
         4.4721359550e-01  8.9442719100e-01  0.0000000000e+00    8.3333333333e-02
        -4.4721359550e-01  7.2360679775e-01  5.2573111212e-01    8.3333333333e-02
         4.4721359550e-01  2.7639320225e-01  8.5065080835e-01    8.3333333333e-02
        -4.4721359550e-01 -2.7639320225e-01  8.5065080835e-01    8.3333333333e-02
         4.4721359550e-01 -7.2360679775e-01  5.2573111212e-01    8.3333333333e-02
        -4.4721359550e-01 -8.9442719100e-01  1.0953573965e-16    8.3333333333e-02
         4.4721359550e-01 -7.2360679775e-01 -5.2573111212e-01    8.3333333333e-02
        -4.4721359550e-01 -2.7639320225e-01 -8.5065080835e-01    8.3333333333e-02
         4.4721359550e-01  2.7639320225e-01 -8.5065080835e-01    8.3333333333e-02
        -4.4721359550e-01  7.2360679775e-01 -5.2573111212e-01    8.3333333333e-02
    Maximum cutoff radius 1.0750000000e+00

  Adding pseudopotential for H1
   Linear grid  ri=0.0000000000e+00 rf=1.0000000000e+01 npts = 10001
    ECPComponentBuilder::buildSemiLocalAndLocal 
    Assuming Hartree unit
   Number of angular momentum channels 2
   Maximum angular momentum channel 1
   Creating a Linear Grid Rmax=1.0000000000e-10
  Using global grid with delta = 1.0000000000e-03
   Making L=1 a local potential with a radial cutoff of 9.9990000000e+00
    Non-local pseudopotential parameters
    Maximum angular mementum = 0
    Number of non-local channels = 1
       l(0)=0
    Cutoff radius = 1.0000000000e-03
    Spherical grids and weights: 
         1.0000000000e+00  0.0000000000e+00  0.0000000000e+00    8.3333333333e-02
        -1.0000000000e+00  1.2246467991e-16  0.0000000000e+00    8.3333333333e-02
         4.4721359550e-01  8.9442719100e-01  0.0000000000e+00    8.3333333333e-02
        -4.4721359550e-01  7.2360679775e-01  5.2573111212e-01    8.3333333333e-02
         4.4721359550e-01  2.7639320225e-01  8.5065080835e-01    8.3333333333e-02
        -4.4721359550e-01 -2.7639320225e-01  8.5065080835e-01    8.3333333333e-02
         4.4721359550e-01 -7.2360679775e-01  5.2573111212e-01    8.3333333333e-02
        -4.4721359550e-01 -8.9442719100e-01  1.0953573965e-16    8.3333333333e-02
         4.4721359550e-01 -7.2360679775e-01 -5.2573111212e-01    8.3333333333e-02
        -4.4721359550e-01 -2.7639320225e-01 -8.5065080835e-01    8.3333333333e-02
         4.4721359550e-01  2.7639320225e-01 -8.5065080835e-01    8.3333333333e-02
        -4.4721359550e-01  7.2360679775e-01 -5.2573111212e-01    8.3333333333e-02
    Maximum cutoff radius 1.0000000000e-03

  Adding pseudopotential for H2
   Linear grid  ri=0.0000000000e+00 rf=1.0000000000e+01 npts = 10001
    ECPComponentBuilder::buildSemiLocalAndLocal 
    Assuming Hartree unit
   Number of angular momentum channels 2
   Maximum angular momentum channel 1
   Creating a Linear Grid Rmax=1.0000000000e-10
  Using global grid with delta = 1.0000000000e-03
   Making L=1 a local potential with a radial cutoff of 9.9990000000e+00
    Non-local pseudopotential parameters
    Maximum angular mementum = 0
    Number of non-local channels = 1
       l(0)=0
    Cutoff radius = 1.0000000000e-03
    Spherical grids and weights: 
         1.0000000000e+00  0.0000000000e+00  0.0000000000e+00    8.3333333333e-02
        -1.0000000000e+00  1.2246467991e-16  0.0000000000e+00    8.3333333333e-02
         4.4721359550e-01  8.9442719100e-01  0.0000000000e+00    8.3333333333e-02
        -4.4721359550e-01  7.2360679775e-01  5.2573111212e-01    8.3333333333e-02
         4.4721359550e-01  2.7639320225e-01  8.5065080835e-01    8.3333333333e-02
        -4.4721359550e-01 -2.7639320225e-01  8.5065080835e-01    8.3333333333e-02
         4.4721359550e-01 -7.2360679775e-01  5.2573111212e-01    8.3333333333e-02
        -4.4721359550e-01 -8.9442719100e-01  1.0953573965e-16    8.3333333333e-02
         4.4721359550e-01 -7.2360679775e-01 -5.2573111212e-01    8.3333333333e-02
        -4.4721359550e-01 -2.7639320225e-01 -8.5065080835e-01    8.3333333333e-02
         4.4721359550e-01  2.7639320225e-01 -8.5065080835e-01    8.3333333333e-02
        -4.4721359550e-01  7.2360679775e-01 -5.2573111212e-01    8.3333333333e-02
    Maximum cutoff radius 1.0000000000e-03
  QMCHamiltonian::addOperator LocalECP to H, physical Hamiltonian 

  Using NonLocalECP potential 
    Maximum grid on a sphere for NonLocalECPotential: 12
  QMCHamiltonian::addOperator NonLocalECP to H, physical Hamiltonian 
QMCHamiltonian::addOperatorType added type pseudo named NonLocalECP
  QMCHamiltonian::addOperator IonIon to H, physical Hamiltonian 
QMCHamiltonian::addOperatorType added type coulomb named IonIon

  QMCHamiltonian::add2WalkerProperty added
    5 to P::PropertyList 
    0 to P::Collectables 
    starting Index of the observables in P::PropertyList = 10
ParticleSetPool::randomize 
  Initialization Execution time = 2.6159e-01 secs
=========================================================
 Summary of QMC systems 
=========================================================
ParticleSetPool has: 

  ParticleSet 'e' contains 8 particles :  u(4) d(4)

    u  6.1002844054e-01  1.3250453608e-01 -4.2267217978e-01
    u -4.3494847795e-01 -2.3203549626e-01  1.0876787134e-01
    u -1.5984350305e-01  8.1842956548e-01  5.1837161342e-02
    u  1.1948334779e+00  1.4453040952e+00  1.6346730752e+00
    d -9.5054657961e-01  2.3768909128e-01 -6.0876959125e-01
    d -2.0429807517e-01  1.5546410594e+00 -1.0292769217e-01
    d  4.7451519973e-01  3.4811618685e-02  3.5425821429e-01
    d -8.6403568621e-02 -1.8286319639e+00  9.9844026831e-01

  Distance table for similar particles (A-A):
    source/target: e
    Using structure-of-arrays (SoA) data layout
    Distance computations use open boundary conditions in 3D.

  Distance table for dissimilar particles (A-B):
    source: ion0  target: e
    Using structure-of-arrays (SoA) data layout
    Distance computations use open boundary conditions in 3D.


  ParticleSet 'ion0' contains 3 particles :  O(1) H1(1) H2(1)

    O  0.0000000000e+00  0.0000000000e+00 -1.3209751581e-01
    H1  0.0000000000e+00  1.4315279079e+00  9.7970009311e-01
    H2  0.0000000000e+00 -1.4315279079e+00  9.7970009311e-01

  Distance table for similar particles (A-A):
    source/target: ion0
    Using structure-of-arrays (SoA) data layout
    Distance computations use open boundary conditions in 3D.


  Hamiltonian h0
  Kinetic         Kinetic energy
  ElecElec        CoulombAA source/target e

  LocalECP        LocalECPotential: ion0
  NonLocalECP     NonLocalECPotential: ion0
  IonIon          CoulombAA source/target ion0


Loop execution max-interations = 60
Inside LM engine constructor, num_params is: 0 and _total_num_params is: 0

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s000 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15
  Adding 1 walkers to 0 existing sets
  Total number of walkers: 1.2800000000e+02
  Total weight: 1.2800000000e+02

=========================================================
  Start VMC
  File Root H2O.s000 append = no 
=========================================================
Resetting walkers
  Using the current 1 walkers.
  Total number of walkers: 1.2800000000e+02
  Total weight: 1.2800000000e+02
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=0  my_counter=0
  time step      = 5.0000000000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000000000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625000000e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000000000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000000000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000000000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000000000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000000000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000000000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000000000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625000000e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000000000e-02</parameter>
<parameter name="time_step" condition="au">5.0000000000e-02</parameter>
<parameter name="timestep" condition="au">5.0000000000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
  Set drift_modifier UNR parameter a = 1.0000000000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000000000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: 0 and ratio_threshold_: 0.0000000000e+00
Allocating full size _hmat_temp and _smat_temp
Inside LM engine's get_param, num_params is: 50
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 0
    time step          = 0.05
    reference energy   = -16.8787
    reference variance = 0.21824
====================================================
  Execution time = 2.1283e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s000
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6903e+01
  VMC Evar = 3.2961e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.4608e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.329610939868
                                         uncertainty =       0.008233129966

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.329610939868
                                         uncertainty =       0.008233129966

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000405964381
  error estimate for blocks of size 2^( 2) =       0.000419638052
  error estimate for blocks of size 2^( 3) =       0.000433997342
  error estimate for blocks of size 2^( 4) =       0.000447197402
  error estimate for blocks of size 2^( 5) =       0.000458468635
  error estimate for blocks of size 2^( 6) =       0.000467133166
  error estimate for blocks of size 2^( 7) =       0.000473087273

      target function =      -0.870139984924
              le_mean =     -16.902988146337
             les_mean =     286.040622268068
             stat err =       0.000461471619
             autocorr =       1.292153569253
   target nu stat err =       0.000461471619
   target dn stat err =       0.007931885543
      target stat err =       0.010889313016
              std dev =       0.574120333787
             le_variance =       0.329614157668


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy-1.690298814634e+01 
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.5000e-01, overlap shift 2.5000e+00 and omega -1.7456e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.870276270169       residual = 2.80e-01           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.872935151450       residual = 4.96e-02           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.873669927700       residual = 2.27e-02           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.874071210292       residual = 1.48e-02           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.874340417256       residual = 6.58e-03           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.874641948229       residual = 5.31e-03           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.874828405748       residual = 7.49e-03           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.874966125389       residual = 2.89e-03           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.875057198033       residual = 1.20e-03           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.875121468514       residual = 8.23e-04           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.875193708688       residual = 8.55e-04           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.875274368760       residual = 1.21e-03           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.875345072890       residual = 5.29e-04           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.875388725065       residual = 1.68e-04           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.875411192227       residual = 1.46e-04           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.875431147035       residual = 8.82e-05           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.875439936201       residual = 4.91e-05           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.875447002637       residual = 5.42e-05           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.875451397253       residual = 2.48e-05           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.875453473873       residual = 1.13e-05           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.875456900501       residual = 9.15e-06           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.875457694253       residual = 4.70e-06           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.875458525971       residual = 1.23e-06           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.875459146896       residual = 1.20e-06           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.875459429843       residual = 8.78e-07           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =      -0.875459170564       residual = 3.83e-07           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   tar_fn =      -0.875459413694       residual = 3.92e-08           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   tar_fn =      -0.875459378882       residual = 2.76e-08           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   tar_fn =      -0.875459363715       residual = 1.17e-08           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   tar_fn =      -0.875459433453       residual = 1.57e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         29 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.5000e-01 is 1.227746e-02

solving harmonic davidson linear method for identity shift 1.0000e+00, overlap shift 1.0000e+01 and omega -1.7456e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.870276270169       residual = 2.80e-01           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.871075845931       residual = 5.17e-02           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.871304560428       residual = 2.21e-02           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.871425032570       residual = 1.46e-02           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.871502553198       residual = 6.48e-03           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.871589644506       residual = 5.10e-03           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.871639529139       residual = 7.17e-03           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.871682482936       residual = 2.58e-03           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.871707561735       residual = 1.10e-03           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.871724831540       residual = 7.55e-04           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.871743096511       residual = 7.90e-04           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.871763014820       residual = 9.94e-04           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.871782620129       residual = 4.18e-04           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.871793251212       residual = 1.44e-04           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.871798636611       residual = 1.13e-04           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.871803256919       residual = 6.69e-05           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.871805249324       residual = 3.60e-05           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.871806820103       residual = 4.00e-05           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.871807678432       residual = 1.59e-05           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.871808090584       residual = 8.44e-06           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.871808755477       residual = 5.15e-06           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.871808915604       residual = 2.99e-06           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.871809058667       residual = 7.01e-07           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.871809181193       residual = 5.78e-07           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.871809211179       residual = 5.87e-07           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =      -0.871809166034       residual = 2.63e-07           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   tar_fn =      -0.871809191241       residual = 1.68e-08           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   tar_fn =      -0.871809189072       residual = 7.66e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         27 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.0000e+00 is 3.494026e-03

solving harmonic davidson linear method for identity shift 4.0000e+00, overlap shift 4.0000e+01 and omega -1.7456e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.870276270169       residual = 2.80e-01           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.870486808882       residual = 5.24e-02           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.870547682967       residual = 2.19e-02           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.870579409597       residual = 1.46e-02           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.870599526332       residual = 6.46e-03           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.870622157093       residual = 5.04e-03           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.870634847648       residual = 7.03e-03           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.870646236453       residual = 2.50e-03           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.870652662309       residual = 1.07e-03           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.870657050300       residual = 7.37e-04           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.870661613078       residual = 7.68e-04           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.870666614541       residual = 9.36e-04           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.870671586372       residual = 3.91e-04           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.870674212134       residual = 1.38e-04           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.870675533641       residual = 1.04e-04           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.870676658909       residual = 6.15e-05           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.870677139798       residual = 3.28e-05           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.870677517461       residual = 3.65e-05           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.870677714713       residual = 1.39e-05           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.870677810700       residual = 7.80e-06           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.870677963074       residual = 4.36e-06           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.870678001257       residual = 2.70e-06           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.870678032747       residual = 5.93e-07           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.870678061518       residual = 4.62e-07           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.870678064987       residual = 4.43e-07           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =      -0.870678056695       residual = 2.32e-07           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   tar_fn =      -0.870678061728       residual = 1.31e-08           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   tar_fn =      -0.870678060189       residual = 5.07e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         27 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 4.0000e+00 is 9.064964e-04

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.031854 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.6784e+01
  </log>
  <optVariables href="H2O.s000.opt.xml">
uu_0  3.008785e-01                 1 1 ON  0
uu_1  1.384322e-01                 1 1 ON  1
uu_2  4.114082e-02                 1 1 ON  2
uu_3  -1.945566e-02                1 1 ON  3
uu_4  -6.297395e-02                1 1 ON  4
uu_5  -9.536089e-02                1 1 ON  5
uu_6  -1.199780e-01                1 1 ON  6
uu_7  -1.302326e-01                1 1 ON  7
uu_8  -1.196407e-01                1 1 ON  8
uu_9  -9.213520e-02                1 1 ON  9
ud_0  4.093807e-01                 1 1 ON  10
ud_1  1.583324e-01                 1 1 ON  11
ud_2  6.047007e-02                 1 1 ON  12
ud_3  2.164049e-03                 1 1 ON  13
ud_4  -5.692625e-02                1 1 ON  14
ud_5  -1.010150e-01                1 1 ON  15
ud_6  -1.282079e-01                1 1 ON  16
ud_7  -1.428926e-01                1 1 ON  17
ud_8  -1.417201e-01                1 1 ON  18
ud_9  -1.331964e-01                1 1 ON  19
eO_0  -7.008160e-01                1 1 ON  20
eO_1  -4.117455e-01                1 1 ON  21
eO_2  -3.057929e-02                1 1 ON  22
eO_3  2.690566e-01                 1 1 ON  23
eO_4  4.883739e-01                 1 1 ON  24
eO_5  4.566338e-01                 1 1 ON  25
eO_6  2.346798e-01                 1 1 ON  26
eO_7  -5.517490e-02                1 1 ON  27
eO_8  -1.955306e-01                1 1 ON  28
eO_9  -5.781995e-02                1 1 ON  29
eH1_0 -2.111230e-01                1 1 ON  30
eH1_1 -1.266626e-01                1 1 ON  31
eH1_2 -8.682228e-02                1 1 ON  32
eH1_3 -3.659367e-02                1 1 ON  33
eH1_4 1.135089e-02                 1 1 ON  34
eH1_5 4.363426e-02                 1 1 ON  35
eH1_6 9.385955e-02                 1 1 ON  36
eH1_7 1.381388e-01                 1 1 ON  37
eH1_8 1.457120e-01                 1 1 ON  38
eH1_9 3.316706e-02                 1 1 ON  39
eH2_0 -2.105771e-01                1 1 ON  40
eH2_1 -1.261482e-01                1 1 ON  41
eH2_2 -8.612513e-02                1 1 ON  42
eH2_3 -3.563827e-02                1 1 ON  43
eH2_4 1.281123e-02                 1 1 ON  44
eH2_5 4.769962e-02                 1 1 ON  45
eH2_6 1.002987e-01                 1 1 ON  46
eH2_7 1.490414e-01                 1 1 ON  47
eH2_8 1.538070e-01                 1 1 ON  48
eH2_9 1.339868e-02                 1 1 ON  49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 0
    time step          = 0.05
    reference energy   = -16.855
    reference variance = 0.511255
====================================================
  Execution time = 2.0655e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s000
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6903e+01
  VMC Evar = 3.2975e-01
  Total weights = 2.0000e+06
  Execution time = 1.8820e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.332361294785
                                         uncertainty =       0.009192132639

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.332361294785
                                         uncertainty =       0.009192132639

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000407588042
  error estimate for blocks of size 2^( 2) =       0.000422039757
  error estimate for blocks of size 2^( 3) =       0.000436384782
  error estimate for blocks of size 2^( 4) =       0.000448973235
  error estimate for blocks of size 2^( 5) =       0.000461351229
  error estimate for blocks of size 2^( 6) =       0.000468047556
  error estimate for blocks of size 2^( 7) =       0.000476114999

      target function =      -0.866505493767
              le_mean =     -16.902978477591
             les_mean =     286.042937271965
             stat err =       0.000463621755
             autocorr =       1.293852425230
   target nu stat err =       0.000463621755
   target dn stat err =       0.008926523998
      target stat err =       0.012147559879
              std dev =       0.576416537055
             le_variance =       0.332256024191

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.324784032161
                                         uncertainty =       0.008919953789

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.324784032161
                                         uncertainty =       0.008919953789

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000402916248
  error estimate for blocks of size 2^( 2) =       0.000417634020
  error estimate for blocks of size 2^( 3) =       0.000432307220
  error estimate for blocks of size 2^( 4) =       0.000445212899
  error estimate for blocks of size 2^( 5) =       0.000457835084
  error estimate for blocks of size 2^( 6) =       0.000464576347
  error estimate for blocks of size 2^( 7) =       0.000472544288

      target function =      -0.876919699358
              le_mean =     -16.903025063104
             les_mean =     286.036939128184
             stat err =       0.000460042154
             autocorr =       1.303664063235
   target nu stat err =       0.000460042154
   target dn stat err =       0.008672445368
      target stat err =       0.012088529123
              std dev =       0.569809623126
             le_variance =       0.324683006607

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.327497862096
                                         uncertainty =       0.009020802234

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.327497862096
                                         uncertainty =       0.009020802234

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000404595624
  error estimate for blocks of size 2^( 2) =       0.000419202360
  error estimate for blocks of size 2^( 3) =       0.000433737190
  error estimate for blocks of size 2^( 4) =       0.000446510661
  error estimate for blocks of size 2^( 5) =       0.000459031329
  error estimate for blocks of size 2^( 6) =       0.000465754074
  error estimate for blocks of size 2^( 7) =       0.000473760795

      target function =      -0.873162469417
              le_mean =     -16.902980576953
             les_mean =     286.038147459568
             stat err =       0.000461264215
             autocorr =       1.299742028741
   target nu stat err =       0.000461264215
   target dn stat err =       0.008766878236
      target stat err =       0.012114550857
              std dev =       0.572184619175
             le_variance =       0.327395238420

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.331681571726
                                         uncertainty =       0.009169145068

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.331681571726
                                         uncertainty =       0.009169145068

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000407171129
  error estimate for blocks of size 2^( 2) =       0.000421641985
  error estimate for blocks of size 2^( 3) =       0.000436010801
  error estimate for blocks of size 2^( 4) =       0.000448622878
  error estimate for blocks of size 2^( 5) =       0.000461019288
  error estimate for blocks of size 2^( 6) =       0.000467718908
  error estimate for blocks of size 2^( 7) =       0.000475778300

      target function =      -0.867430053220
              le_mean =     -16.902974261574
             les_mean =     286.042115378094
             stat err =       0.000463284843
             autocorr =       1.294619762938
   target nu stat err =       0.000463284843
   target dn stat err =       0.008905112596
      target stat err =       0.012144224390
              std dev =       0.575826932716
             le_variance =       0.331576656441


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.866505493767        initial
     2.5000e-01     2.5000e+00             1.2277e-02        -0.876919699358  <--
     1.0000e+00     1.0000e+01             3.4940e-03        -0.873162469417
     4.0000e+00     4.0000e+01             9.0650e-04        -0.867430053220

*****************************************************************************
Applying the update for shift_i =   2.5000e-01     and shift_s =   2.5000e+00
*****************************************************************************

  Execution time = 3.0149e+01
  </log>
  <optVariables href="H2O.s000.opt.xml">
 uu_0                 2.965402e-01 1 1  ON 0
 uu_1                 1.356654e-01 1 1  ON 1
 uu_2                 3.991147e-02 1 1  ON 2
 uu_3                -1.958472e-02 1 1  ON 3
 uu_4                -6.220609e-02 1 1  ON 4
 uu_5                -9.412819e-02 1 1  ON 5
 uu_6                -1.184880e-01 1 1  ON 6
 uu_7                -1.281981e-01 1 1  ON 7
 uu_8                -1.178675e-01 1 1  ON 8
 uu_9                -9.040628e-02 1 1  ON 9
 ud_0                 4.046320e-01 1 1  ON 10
 ud_1                 1.580058e-01 1 1  ON 11
 ud_2                 5.921628e-02 1 1  ON 12
 ud_3                 7.925401e-04 1 1  ON 13
 ud_4                -5.652987e-02 1 1  ON 14
 ud_5                -9.987132e-02 1 1  ON 15
 ud_6                -1.270213e-01 1 1  ON 16
 ud_7                -1.413231e-01 1 1  ON 17
 ud_8                -1.398485e-01 1 1  ON 18
 ud_9                -1.298942e-01 1 1  ON 19
 eO_0                -6.920325e-01 1 1  ON 20
 eO_1                -4.063805e-01 1 1  ON 21
 eO_2                -2.706995e-02 1 1  ON 22
 eO_3                 2.687484e-01 1 1  ON 23
 eO_4                 4.802083e-01 1 1  ON 24
 eO_5                 4.487251e-01 1 1  ON 25
 eO_6                 2.308412e-01 1 1  ON 26
 eO_7                -5.338296e-02 1 1  ON 27
 eO_8                -1.944127e-01 1 1  ON 28
 eO_9                -5.816715e-02 1 1  ON 29
eH1_0                -2.136664e-01 1 1  ON 30
eH1_1                -1.246016e-01 1 1  ON 31
eH1_2                -8.312448e-02 1 1  ON 32
eH1_3                -3.466112e-02 1 1  ON 33
eH1_4                 1.075864e-02 1 1  ON 34
eH1_5                 4.090039e-02 1 1  ON 35
eH1_6                 9.146297e-02 1 1  ON 36
eH1_7                 1.379359e-01 1 1  ON 37
eH1_8                 1.457299e-01 1 1  ON 38
eH1_9                 3.408427e-02 1 1  ON 39
eH2_0                -2.145752e-01 1 1  ON 40
eH2_1                -1.251594e-01 1 1  ON 41
eH2_2                -8.314789e-02 1 1  ON 42
eH2_3                -3.384066e-02 1 1  ON 43
eH2_4                 1.261563e-02 1 1  ON 44
eH2_5                 4.708734e-02 1 1  ON 45
eH2_6                 9.947363e-02 1 1  ON 46
eH2_7                 1.475505e-01 1 1  ON 47
eH2_8                 1.539112e-01 1 1  ON 48
eH2_9                 1.471376e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.6940e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s001 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s001 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=1  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6867e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 1
    time step          = 0.05
    reference energy   = -16.8701
    reference variance = 0.446897
====================================================
  Execution time = 2.0457e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s001
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6903e+01
  VMC Evar = 3.0646e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.5184e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.306445371169
                                         uncertainty =       0.002828915937

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.306445371169
                                         uncertainty =       0.002828915937

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000391443155
  error estimate for blocks of size 2^( 2) =       0.000405888750
  error estimate for blocks of size 2^( 3) =       0.000420809549
  error estimate for blocks of size 2^( 4) =       0.000434241702
  error estimate for blocks of size 2^( 5) =       0.000445369427
  error estimate for blocks of size 2^( 6) =       0.000452683328
  error estimate for blocks of size 2^( 7) =       0.000458126754

      target function =      -0.903185863267
              le_mean =     -16.902889049739
             les_mean =     286.014113561437
             stat err =       0.000447605303
             autocorr =       1.307534148307
   target nu stat err =       0.000447605303
   target dn stat err =       0.002864859871
      target stat err =       0.004289441302
              std dev =       0.553584218416
             le_variance =       0.306455486879


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690288904974e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 6.2500e-02, overlap shift 6.2500e-01 and omega -1.7456e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.903204528787       residual = 1.63e-01           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.906854366220       residual = 2.79e-02           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.907936399121       residual = 1.66e-02           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.908644111861       residual = 1.14e-02           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.909126911873       residual = 4.96e-03           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.909709780656       residual = 4.46e-03           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.910109958856       residual = 5.25e-03           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.910334662950       residual = 2.59e-03           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.910538837826       residual = 1.07e-03           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.910691237024       residual = 7.85e-04           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.910859078228       residual = 8.59e-04           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.911167470355       residual = 8.71e-04           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.911289421397       residual = 7.53e-04           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.911372245061       residual = 1.89e-04           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.911429565656       residual = 2.04e-04           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.911497863097       residual = 1.32e-04           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.911540451076       residual = 7.45e-05           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.911564930732       residual = 7.33e-05           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.911591011951       residual = 3.03e-05           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.911596339108       residual = 2.55e-05           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.911609850581       residual = 2.96e-05           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.911616872942       residual = 2.15e-05           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.911619511267       residual = 5.14e-06           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.911624581261       residual = 2.39e-06           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.911626374092       residual = 2.88e-06           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =      -0.911628118158       residual = 1.57e-06           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   tar_fn =      -0.911629314985       residual = 3.05e-07           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   tar_fn =      -0.911628585581       residual = 1.80e-07           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   tar_fn =      -0.911629029528       residual = 5.92e-08           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   tar_fn =      -0.911629373391       residual = 1.25e-08           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   tar_fn =      -0.911629545817       residual = 1.04e-08           smallest_sin_value = 1.00e+00
davidson iteration   31:   krylov dim =  32   tar_fn =      -0.911629565186       residual = 4.83e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         31 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 6.2500e-02 is 2.961008e-02

solving harmonic davidson linear method for identity shift 2.5000e-01, overlap shift 2.5000e+00 and omega -1.7456e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.903204528787       residual = 1.63e-01           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.904755870604       residual = 3.01e-02           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.905242773063       residual = 1.58e-02           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.905543285064       residual = 1.12e-02           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.905731408637       residual = 4.67e-03           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.905956493438       residual = 3.92e-03           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.906090233381       residual = 5.20e-03           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.906191141297       residual = 2.07e-03           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.906264033963       residual = 8.80e-04           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.906315668093       residual = 5.95e-04           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.906368211556       residual = 6.72e-04           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.906454349969       residual = 7.26e-04           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.906492692757       residual = 4.22e-04           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.906515833440       residual = 1.35e-04           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.906531809757       residual = 1.16e-04           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.906547602359       residual = 6.93e-05           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.906557302116       residual = 3.71e-05           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.906561431700       residual = 3.81e-05           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.906566423268       residual = 1.55e-05           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.906567792369       residual = 9.72e-06           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.906570675988       residual = 1.14e-05           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.906571590518       residual = 5.28e-06           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.906571482542       residual = 1.09e-06           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.906571929627       residual = 9.90e-07           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.906572190080       residual = 6.35e-07           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =      -0.906572365854       residual = 2.29e-07           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   tar_fn =      -0.906572181304       residual = 2.75e-08           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   tar_fn =      -0.906572292767       residual = 2.89e-08           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   tar_fn =      -0.906572230472       residual = 7.30e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         28 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.5000e-01 is 1.025644e-02

solving harmonic davidson linear method for identity shift 1.0000e+00, overlap shift 1.0000e+01 and omega -1.7456e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.903204528787       residual = 1.63e-01           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.903674338912       residual = 3.14e-02           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.903826108946       residual = 1.54e-02           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.903917341711       residual = 1.10e-02           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.903971632295       residual = 4.54e-03           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.904036494700       residual = 3.69e-03           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.904072866722       residual = 5.02e-03           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.904103951849       residual = 1.87e-03           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.904124070813       residual = 8.10e-04           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.904137971813       residual = 5.32e-04           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.904151526091       residual = 6.26e-04           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.904170903610       residual = 7.67e-04           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.904183180956       residual = 3.01e-04           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.904189428011       residual = 1.16e-04           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.904193281489       residual = 8.76e-05           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.904196916692       residual = 5.17e-05           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.904199121745       residual = 2.71e-05           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.904199913711       residual = 2.83e-05           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.904200956072       residual = 1.06e-05           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.904201303301       residual = 6.81e-06           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.904201940551       residual = 6.49e-06           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.904202065640       residual = 2.77e-06           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.904201997346       residual = 6.90e-07           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.904202035225       residual = 6.02e-07           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.904202097363       residual = 3.43e-07           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =      -0.904202152550       residual = 1.38e-07           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   tar_fn =      -0.904202092041       residual = 1.10e-08           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   tar_fn =      -0.904202102683       residual = 8.30e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         27 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.0000e+00 is 2.884766e-03

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.064086 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.6012e+01
  </log>
  <optVariables href="H2O.s001.opt.xml">
 uu_0                 2.914647e-01 1 1  ON 0
 uu_1                 1.325507e-01 1 1  ON 1
 uu_2                 3.856574e-02 1 1  ON 2
 uu_3                -1.958339e-02 1 1  ON 3
 uu_4                -6.153912e-02 1 1  ON 4
 uu_5                -9.288978e-02 1 1  ON 5
 uu_6                -1.165723e-01 1 1  ON 6
 uu_7                -1.262761e-01 1 1  ON 7
 uu_8                -1.164771e-01 1 1  ON 8
 uu_9                -8.816305e-02 1 1  ON 9
 ud_0                 3.982905e-01 1 1  ON 10
 ud_1                 1.564621e-01 1 1  ON 11
 ud_2                 5.678809e-02 1 1  ON 12
 ud_3                -1.733376e-03 1 1  ON 13
 ud_4                -5.664003e-02 1 1  ON 14
 ud_5                -9.825341e-02 1 1  ON 15
 ud_6                -1.249015e-01 1 1  ON 16
 ud_7                -1.387167e-01 1 1  ON 17
 ud_8                -1.370798e-01 1 1  ON 18
 ud_9                -1.252573e-01 1 1  ON 19
 eO_0                -6.817761e-01 1 1  ON 20
 eO_1                -4.000034e-01 1 1  ON 21
 eO_2                -2.261491e-02 1 1  ON 22
 eO_3                 2.684613e-01 1 1  ON 23
 eO_4                 4.702066e-01 1 1  ON 24
 eO_5                 4.398722e-01 1 1  ON 25
 eO_6                 2.260090e-01 1 1  ON 26
 eO_7                -5.176979e-02 1 1  ON 27
 eO_8                -1.929725e-01 1 1  ON 28
 eO_9                -5.840462e-02 1 1  ON 29
eH1_0                -2.176990e-01 1 1  ON 30
eH1_1                -1.230289e-01 1 1  ON 31
eH1_2                -7.924659e-02 1 1  ON 32
eH1_3                -3.239390e-02 1 1  ON 33
eH1_4                 1.015892e-02 1 1  ON 34
eH1_5                 3.912440e-02 1 1  ON 35
eH1_6                 8.906986e-02 1 1  ON 36
eH1_7                 1.362388e-01 1 1  ON 37
eH1_8                 1.464979e-01 1 1  ON 38
eH1_9                 3.599757e-02 1 1  ON 39
eH2_0                -2.176263e-01 1 1  ON 40
eH2_1                -1.227759e-01 1 1  ON 41
eH2_2                -7.870472e-02 1 1  ON 42
eH2_3                -3.174013e-02 1 1  ON 43
eH2_4                 1.165626e-02 1 1  ON 44
eH2_5                 4.429909e-02 1 1  ON 45
eH2_6                 9.716280e-02 1 1  ON 46
eH2_7                 1.466649e-01 1 1  ON 47
eH2_8                 1.535498e-01 1 1  ON 48
eH2_9                 1.627089e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 1
    time step          = 0.05
    reference energy   = -16.974
    reference variance = 0.258663
====================================================
  Execution time = 2.2518e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s001
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6903e+01
  VMC Evar = 3.0329e-01
  Total weights = 2.0000e+06
  Execution time = 1.8813e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.308110676436
                                         uncertainty =       0.002324988173

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.308110676436
                                         uncertainty =       0.002324988173

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000392477884
  error estimate for blocks of size 2^( 2) =       0.000406886702
  error estimate for blocks of size 2^( 3) =       0.000421617445
  error estimate for blocks of size 2^( 4) =       0.000434784049
  error estimate for blocks of size 2^( 5) =       0.000444987309
  error estimate for blocks of size 2^( 6) =       0.000452632780
  error estimate for blocks of size 2^( 7) =       0.000457877538

      target function =      -0.900802873113
              le_mean =     -16.902963574584
             les_mean =     286.018255227766
             stat err =       0.000447570419
             autocorr =       1.300446146531
   target nu stat err =       0.000447570419
   target dn stat err =       0.002480686241
      target stat err =       0.003713376296
              std dev =       0.555047545795
             le_variance =       0.308077778093

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.298265089215
                                         uncertainty =       0.002204390389

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.298265089215
                                         uncertainty =       0.002204390389

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000386157102
  error estimate for blocks of size 2^( 2) =       0.000401374888
  error estimate for blocks of size 2^( 3) =       0.000417088288
  error estimate for blocks of size 2^( 4) =       0.000431144959
  error estimate for blocks of size 2^( 5) =       0.000442031689
  error estimate for blocks of size 2^( 6) =       0.000450047145
  error estimate for blocks of size 2^( 7) =       0.000455568363

      target function =      -0.915488840713
              le_mean =     -16.903068705243
             les_mean =     286.011966120052
             stat err =       0.000444698039
             autocorr =       1.326179698940
   target nu stat err =       0.000444698039
   target dn stat err =       0.002368746888
      target stat err =       0.003666471433
              std dev =       0.546108610986
             le_variance =       0.298234614993

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.299447754866
                                         uncertainty =       0.002219041264

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.299447754866
                                         uncertainty =       0.002219041264

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000386922001
  error estimate for blocks of size 2^( 2) =       0.000401965440
  error estimate for blocks of size 2^( 3) =       0.000417447329
  error estimate for blocks of size 2^( 4) =       0.000431277945
  error estimate for blocks of size 2^( 5) =       0.000441971090
  error estimate for blocks of size 2^( 6) =       0.000449919605
  error estimate for blocks of size 2^( 7) =       0.000455382764

      target function =      -0.913697270758
              le_mean =     -16.902968032003
             les_mean =     286.009745411670
             stat err =       0.000444637851
             autocorr =       1.320583934607
   target nu stat err =       0.000444637851
   target dn stat err =       0.002383288789
      target stat err =       0.003673252928
              std dev =       0.547190342092
             le_variance =       0.299417270479

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.306547965385
                                         uncertainty =       0.002308260689

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.306547965385
                                         uncertainty =       0.002308260689

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000391481449
  error estimate for blocks of size 2^( 2) =       0.000405972576
  error estimate for blocks of size 2^( 3) =       0.000420803641
  error estimate for blocks of size 2^( 4) =       0.000434060500
  error estimate for blocks of size 2^( 5) =       0.000444329484
  error estimate for blocks of size 2^( 6) =       0.000452020342
  error estimate for blocks of size 2^( 7) =       0.000457297663

      target function =      -0.903102054058
              le_mean =     -16.902926978518
             les_mean =     286.015455737669
             stat err =       0.000446926997
             autocorr =       1.303319234579
   target nu stat err =       0.000446926997
   target dn stat err =       0.002465298344
      target stat err =       0.003709278577
              std dev =       0.553638374590
             le_variance =       0.306515449819


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.900802873113        initial
     6.2500e-02     6.2500e-01             2.9610e-02        -0.915488840713  <--
     2.5000e-01     2.5000e+00             1.0256e-02        -0.913697270758
     1.0000e+00     1.0000e+01             2.8848e-03        -0.903102054058

*****************************************************************************
Applying the update for shift_i =   6.2500e-02     and shift_s =   6.2500e-01
*****************************************************************************

  Execution time = 3.1985e+01
  </log>
  <optVariables href="H2O.s001.opt.xml">
 uu_0                 2.831640e-01 1 1  ON 0
 uu_1                 1.267185e-01 1 1  ON 1
 uu_2                 3.522180e-02 1 1  ON 2
 uu_3                -2.071799e-02 1 1  ON 3
 uu_4                -6.111879e-02 1 1  ON 4
 uu_5                -9.097441e-02 1 1  ON 5
 uu_6                -1.131870e-01 1 1  ON 6
 uu_7                -1.225673e-01 1 1  ON 7
 uu_8                -1.133118e-01 1 1  ON 8
 uu_9                -8.344929e-02 1 1  ON 9
 ud_0                 3.881278e-01 1 1  ON 10
 ud_1                 1.520454e-01 1 1  ON 11
 ud_2                 5.154800e-02 1 1  ON 12
 ud_3                -6.683001e-03 1 1  ON 13
 ud_4                -5.775480e-02 1 1  ON 14
 ud_5                -9.610431e-02 1 1  ON 15
 ud_6                -1.212051e-01 1 1  ON 16
 ud_7                -1.337440e-01 1 1  ON 17
 ud_8                -1.311931e-01 1 1  ON 18
 ud_9                -1.158134e-01 1 1  ON 19
 eO_0                -6.624225e-01 1 1  ON 20
 eO_1                -3.859461e-01 1 1  ON 21
 eO_2                -1.278660e-02 1 1  ON 22
 eO_3                 2.683586e-01 1 1  ON 23
 eO_4                 4.522254e-01 1 1  ON 24
 eO_5                 4.208706e-01 1 1  ON 25
 eO_6                 2.144165e-01 1 1  ON 26
 eO_7                -4.983047e-02 1 1  ON 27
 eO_8                -1.892836e-01 1 1  ON 28
 eO_9                -5.880446e-02 1 1  ON 29
eH1_0                -2.229501e-01 1 1  ON 30
eH1_1                -1.203896e-01 1 1  ON 31
eH1_2                -7.366155e-02 1 1  ON 32
eH1_3                -2.917961e-02 1 1  ON 33
eH1_4                 9.074188e-03 1 1  ON 34
eH1_5                 3.591357e-02 1 1  ON 35
eH1_6                 8.433440e-02 1 1  ON 36
eH1_7                 1.324133e-01 1 1  ON 37
eH1_8                 1.478386e-01 1 1  ON 38
eH1_9                 4.091860e-02 1 1  ON 39
eH2_0                -2.209501e-01 1 1  ON 40
eH2_1                -1.185747e-01 1 1  ON 41
eH2_2                -7.194423e-02 1 1  ON 42
eH2_3                -2.838347e-02 1 1  ON 43
eH2_4                 1.013224e-02 1 1  ON 44
eH2_5                 3.937964e-02 1 1  ON 45
eH2_6                 9.240436e-02 1 1  ON 46
eH2_7                 1.443000e-01 1 1  ON 47
eH2_8                 1.524299e-01 1 1  ON 48
eH2_9                 2.018161e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.8004e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s002 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s002 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=2  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6894e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 2
    time step          = 0.05
    reference energy   = -16.9046
    reference variance = 0.195939
====================================================
  Execution time = 2.0552e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s002
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6903e+01
  VMC Evar = 2.9503e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.5209e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.295104891728
                                         uncertainty =       0.002611615333

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.295104891728
                                         uncertainty =       0.002611615333

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000384077897
  error estimate for blocks of size 2^( 2) =       0.000399013382
  error estimate for blocks of size 2^( 3) =       0.000414802992
  error estimate for blocks of size 2^( 4) =       0.000428684991
  error estimate for blocks of size 2^( 5) =       0.000440131290
  error estimate for blocks of size 2^( 6) =       0.000448209518
  error estimate for blocks of size 2^( 7) =       0.000451313321

      target function =      -0.920359952998
              le_mean =     -16.902752246451
             les_mean =     285.998065018871
             stat err =       0.000442084780
             autocorr =       1.324867656176
   target nu stat err =       0.000442084780
   target dn stat err =       0.002540878312
      target stat err =       0.003960549565
              std dev =       0.543168170521
             le_variance =       0.295031661468


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690275224645e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.5625e-02, overlap shift 1.5625e-01 and omega -1.7456e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.920375417576       residual = 3.12e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.921423595766       residual = 6.63e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.921900095722       residual = 5.54e-03           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.922234637331       residual = 4.00e-03           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.922503302010       residual = 2.48e-03           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.922897718500       residual = 1.98e-03           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.923244323734       residual = 1.44e-03           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.923374540091       residual = 1.41e-03           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.923471978208       residual = 7.69e-04           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.923618429875       residual = 6.12e-04           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.923889542428       residual = 8.28e-04           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.924239828043       residual = 4.59e-04           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.924367054089       residual = 2.87e-04           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.924425041141       residual = 2.11e-04           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.924534554160       residual = 1.86e-04           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.924617616574       residual = 1.39e-04           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.924691176881       residual = 1.14e-04           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.924739660815       residual = 8.10e-05           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.924776331106       residual = 4.29e-05           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.924783501034       residual = 3.46e-05           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.924811763168       residual = 2.39e-05           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.924827120470       residual = 9.77e-06           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.924842510725       residual = 1.88e-05           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.924848121578       residual = 5.87e-06           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.924860835850       residual = 7.73e-06           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =      -0.924875807032       residual = 4.18e-06           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   tar_fn =      -0.924877818115       residual = 3.92e-06           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   tar_fn =      -0.924880915697       residual = 9.87e-07           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   tar_fn =      -0.924881768394       residual = 3.70e-07           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   tar_fn =      -0.924886399298       residual = 1.99e-07           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   tar_fn =      -0.924887374996       residual = 1.01e-07           smallest_sin_value = 1.00e+00
davidson iteration   31:   krylov dim =  32   tar_fn =      -0.924888115658       residual = 4.34e-08           smallest_sin_value = 1.00e+00
davidson iteration   32:   krylov dim =  33   tar_fn =      -0.924888972064       residual = 2.04e-07           smallest_sin_value = 1.00e+00
davidson iteration   33:   krylov dim =  34   tar_fn =      -0.924889570740       residual = 9.98e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         33 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.5625e-02 is 5.044113e-02

solving harmonic davidson linear method for identity shift 6.2500e-02, overlap shift 6.2500e-01 and omega -1.7456e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.920375417576       residual = 3.12e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.921077540343       residual = 6.98e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.921402298752       residual = 5.20e-03           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.921618414954       residual = 3.89e-03           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.921781770676       residual = 2.29e-03           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.922008688548       residual = 1.72e-03           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.922185380028       residual = 2.28e-03           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.922259205535       residual = 9.51e-04           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.922333216243       residual = 5.28e-04           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.922410623897       residual = 4.50e-04           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.922540489025       residual = 6.19e-04           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.922670853801       residual = 5.24e-04           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.922728256761       residual = 2.30e-04           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.922763378349       residual = 1.04e-04           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.922817110082       residual = 9.95e-05           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.922840764697       residual = 6.17e-05           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.922863865308       residual = 5.25e-05           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.922877531672       residual = 3.02e-05           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.922886781601       residual = 1.77e-05           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.922887768313       residual = 1.57e-05           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.922894233099       residual = 9.17e-06           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.922897593840       residual = 2.57e-06           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.922901317270       residual = 2.60e-06           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.922901048436       residual = 2.44e-06           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.922905102653       residual = 1.98e-06           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =      -0.922907059468       residual = 7.91e-07           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   tar_fn =      -0.922905853849       residual = 3.77e-07           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   tar_fn =      -0.922906052930       residual = 9.41e-08           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   tar_fn =      -0.922905869673       residual = 3.48e-08           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   tar_fn =      -0.922906519195       residual = 1.15e-08           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   tar_fn =      -0.922906560527       residual = 5.04e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         30 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 6.2500e-02 is 2.174699e-02

solving harmonic davidson linear method for identity shift 2.5000e-01, overlap shift 2.5000e+00 and omega -1.7456e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.920375417576       residual = 3.12e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.920677888610       residual = 7.45e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.920820199308       residual = 4.85e-03           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.920910856632       residual = 3.73e-03           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.920973870417       residual = 2.14e-03           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.921056696058       residual = 1.57e-03           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.921112849900       residual = 2.33e-03           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.921153509533       residual = 7.01e-04           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.921179334619       residual = 4.26e-04           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.921204688837       residual = 3.57e-04           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.921243989514       residual = 5.12e-04           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.921276851312       residual = 4.54e-04           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.921298179015       residual = 1.22e-04           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.921309238428       residual = 7.56e-05           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.921323333640       residual = 4.96e-05           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.921327573921       residual = 3.08e-05           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.921332819675       residual = 2.47e-05           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.921335238277       residual = 1.10e-05           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.921336958350       residual = 8.00e-06           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.921336884342       residual = 6.67e-06           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.921338113504       residual = 3.59e-06           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.921338521987       residual = 7.17e-07           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.921338896501       residual = 5.22e-07           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.921339083442       residual = 1.17e-06           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.921339791801       residual = 6.15e-07           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =      -0.921339798649       residual = 1.64e-07           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   tar_fn =      -0.921339500767       residual = 3.70e-08           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   tar_fn =      -0.921339542930       residual = 1.39e-08           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   tar_fn =      -0.921339489900       residual = 4.74e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         28 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.5000e-01 is 6.881767e-03

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.101939 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.6116e+01
  </log>
  <optVariables href="H2O.s002.opt.xml">
 uu_0                 2.740439e-01 1 1  ON 0
 uu_1                 1.196980e-01 1 1  ON 1
 uu_2                 3.078925e-02 1 1  ON 2
 uu_3                -2.274000e-02 1 1  ON 3
 uu_4                -5.980068e-02 1 1  ON 4
 uu_5                -8.735261e-02 1 1  ON 5
 uu_6                -1.078912e-01 1 1  ON 6
 uu_7                -1.172068e-01 1 1  ON 7
 uu_8                -1.098571e-01 1 1  ON 8
 uu_9                -7.977943e-02 1 1  ON 9
 ud_0                 3.778676e-01 1 1  ON 10
 ud_1                 1.465899e-01 1 1  ON 11
 ud_2                 4.532650e-02 1 1  ON 12
 ud_3                -1.207169e-02 1 1  ON 13
 ud_4                -5.943977e-02 1 1  ON 14
 ud_5                -9.451645e-02 1 1  ON 15
 ud_6                -1.170168e-01 1 1  ON 16
 ud_7                -1.271998e-01 1 1  ON 17
 ud_8                -1.235200e-01 1 1  ON 18
 ud_9                -1.036289e-01 1 1  ON 19
 eO_0                -6.423511e-01 1 1  ON 20
 eO_1                -3.700919e-01 1 1  ON 21
 eO_2                -6.796436e-04 1 1  ON 22
 eO_3                 2.683011e-01 1 1  ON 23
 eO_4                 4.330704e-01 1 1  ON 24
 eO_5                 3.991236e-01 1 1  ON 25
 eO_6                 2.001350e-01 1 1  ON 26
 eO_7                -4.786518e-02 1 1  ON 27
 eO_8                -1.830344e-01 1 1  ON 28
 eO_9                -6.005227e-02 1 1  ON 29
eH1_0                -2.264490e-01 1 1  ON 30
eH1_1                -1.164421e-01 1 1  ON 31
eH1_2                -6.690504e-02 1 1  ON 32
eH1_3                -2.591990e-02 1 1  ON 33
eH1_4                 6.767094e-03 1 1  ON 34
eH1_5                 3.024695e-02 1 1  ON 35
eH1_6                 7.849834e-02 1 1  ON 36
eH1_7                 1.274384e-01 1 1  ON 37
eH1_8                 1.502129e-01 1 1  ON 38
eH1_9                 4.671918e-02 1 1  ON 39
eH2_0                -2.245918e-01 1 1  ON 40
eH2_1                -1.150909e-01 1 1  ON 41
eH2_2                -6.557047e-02 1 1  ON 42
eH2_3                -2.535389e-02 1 1  ON 43
eH2_4                 8.770192e-03 1 1  ON 44
eH2_5                 3.390701e-02 1 1  ON 45
eH2_6                 8.579896e-02 1 1  ON 46
eH2_7                 1.390032e-01 1 1  ON 47
eH2_8                 1.571936e-01 1 1  ON 48
eH2_9                 2.580793e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 2
    time step          = 0.05
    reference energy   = -16.8871
    reference variance = 0.229566
====================================================
  Execution time = 2.0438e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s002
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6901e+01
  VMC Evar = 2.9639e-01
  Total weights = 2.0000e+06
  Execution time = 1.8843e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.299848010176
                                         uncertainty =       0.004948087240

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.299848010176
                                         uncertainty =       0.004948087240

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000387213795
  error estimate for blocks of size 2^( 2) =       0.000402723378
  error estimate for blocks of size 2^( 3) =       0.000418454908
  error estimate for blocks of size 2^( 4) =       0.000433104519
  error estimate for blocks of size 2^( 5) =       0.000443257513
  error estimate for blocks of size 2^( 6) =       0.000450317502
  error estimate for blocks of size 2^( 7) =       0.000452129543

      target function =      -0.912946890710
              le_mean =     -16.901538617247
             les_mean =     285.961876526018
             stat err =       0.000444702269
             autocorr =       1.318976473350
   target nu stat err =       0.000444702269
   target dn stat err =       0.004832492900
      target stat err =       0.007303924330
              std dev =       0.547603000053
             le_variance =       0.299869045667

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.294838888340
                                         uncertainty =       0.004809143750

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.294838888340
                                         uncertainty =       0.004809143750

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000383966147
  error estimate for blocks of size 2^( 2) =       0.000400735108
  error estimate for blocks of size 2^( 3) =       0.000417989689
  error estimate for blocks of size 2^( 4) =       0.000434060536
  error estimate for blocks of size 2^( 5) =       0.000445377517
  error estimate for blocks of size 2^( 6) =       0.000452915684
  error estimate for blocks of size 2^( 7) =       0.000454899476

      target function =      -0.920544282195
              le_mean =     -16.901537001232
             les_mean =     285.956812860793
             stat err =       0.000446813303
             autocorr =       1.354148579035
   target nu stat err =       0.000446813303
   target dn stat err =       0.004703052911
      target stat err =       0.007228804482
              std dev =       0.543010132687
             le_variance =       0.294860004201

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.294291407242
                                         uncertainty =       0.004779558955

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.294291407242
                                         uncertainty =       0.004779558955

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000383609329
  error estimate for blocks of size 2^( 2) =       0.000400487489
  error estimate for blocks of size 2^( 3) =       0.000417782877
  error estimate for blocks of size 2^( 4) =       0.000433830397
  error estimate for blocks of size 2^( 5) =       0.000445102458
  error estimate for blocks of size 2^( 6) =       0.000452555985
  error estimate for blocks of size 2^( 7) =       0.000454512513

      target function =      -0.921382771266
              le_mean =     -16.901528046930
             les_mean =     285.955962408221
             stat err =       0.000446500338
             autocorr =       1.354769043601
   target nu stat err =       0.000446500338
   target dn stat err =       0.004675185598
      target stat err =       0.007199277500
              std dev =       0.542505515369
             le_variance =       0.294312234205

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.298264895697
                                         uncertainty =       0.004913087852

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.298264895697
                                         uncertainty =       0.004913087852

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000386190288
  error estimate for blocks of size 2^( 2) =       0.000401920178
  error estimate for blocks of size 2^( 3) =       0.000417897155
  error estimate for blocks of size 2^( 4) =       0.000432763872
  error estimate for blocks of size 2^( 5) =       0.000443088851
  error estimate for blocks of size 2^( 6) =       0.000450193655
  error estimate for blocks of size 2^( 7) =       0.000452023758

      target function =      -0.915331638187
              le_mean =     -16.901426394620
             les_mean =     285.956499900279
             stat err =       0.000444517534
             autocorr =       1.324875586198
   target nu stat err =       0.000444517534
   target dn stat err =       0.004799669480
      target stat err =       0.007291061360
              std dev =       0.546155542567
             le_variance =       0.298285876677


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.912946890710        initial
     1.5625e-02     1.5625e-01             5.0441e-02        -0.920544282195
     6.2500e-02     6.2500e-01             2.1747e-02        -0.921382771266  <--
     2.5000e-01     2.5000e+00             6.8818e-03        -0.915331638187

*****************************************************************************
Applying the update for shift_i =   6.2500e-02     and shift_s =   6.2500e-01
*****************************************************************************

  Execution time = 2.9934e+01
  </log>
  <optVariables href="H2O.s002.opt.xml">
 uu_0                 2.740439e-01 1 1  ON 0
 uu_1                 1.196980e-01 1 1  ON 1
 uu_2                 3.078925e-02 1 1  ON 2
 uu_3                -2.274000e-02 1 1  ON 3
 uu_4                -5.980068e-02 1 1  ON 4
 uu_5                -8.735261e-02 1 1  ON 5
 uu_6                -1.078912e-01 1 1  ON 6
 uu_7                -1.172068e-01 1 1  ON 7
 uu_8                -1.098571e-01 1 1  ON 8
 uu_9                -7.977943e-02 1 1  ON 9
 ud_0                 3.778676e-01 1 1  ON 10
 ud_1                 1.465899e-01 1 1  ON 11
 ud_2                 4.532650e-02 1 1  ON 12
 ud_3                -1.207169e-02 1 1  ON 13
 ud_4                -5.943977e-02 1 1  ON 14
 ud_5                -9.451645e-02 1 1  ON 15
 ud_6                -1.170168e-01 1 1  ON 16
 ud_7                -1.271998e-01 1 1  ON 17
 ud_8                -1.235200e-01 1 1  ON 18
 ud_9                -1.036289e-01 1 1  ON 19
 eO_0                -6.423511e-01 1 1  ON 20
 eO_1                -3.700919e-01 1 1  ON 21
 eO_2                -6.796436e-04 1 1  ON 22
 eO_3                 2.683011e-01 1 1  ON 23
 eO_4                 4.330704e-01 1 1  ON 24
 eO_5                 3.991236e-01 1 1  ON 25
 eO_6                 2.001350e-01 1 1  ON 26
 eO_7                -4.786518e-02 1 1  ON 27
 eO_8                -1.830344e-01 1 1  ON 28
 eO_9                -6.005227e-02 1 1  ON 29
eH1_0                -2.264490e-01 1 1  ON 30
eH1_1                -1.164421e-01 1 1  ON 31
eH1_2                -6.690504e-02 1 1  ON 32
eH1_3                -2.591990e-02 1 1  ON 33
eH1_4                 6.767094e-03 1 1  ON 34
eH1_5                 3.024695e-02 1 1  ON 35
eH1_6                 7.849834e-02 1 1  ON 36
eH1_7                 1.274384e-01 1 1  ON 37
eH1_8                 1.502129e-01 1 1  ON 38
eH1_9                 4.671918e-02 1 1  ON 39
eH2_0                -2.245918e-01 1 1  ON 40
eH2_1                -1.150909e-01 1 1  ON 41
eH2_2                -6.557047e-02 1 1  ON 42
eH2_3                -2.535389e-02 1 1  ON 43
eH2_4                 8.770192e-03 1 1  ON 44
eH2_5                 3.390701e-02 1 1  ON 45
eH2_6                 8.579896e-02 1 1  ON 46
eH2_7                 1.390032e-01 1 1  ON 47
eH2_8                 1.571936e-01 1 1  ON 48
eH2_9                 2.580793e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.6055e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s003 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s003 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=3  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6895e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 3
    time step          = 0.05
    reference energy   = -16.8789
    reference variance = 0.175841
====================================================
  Execution time = 2.0725e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s003
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6901e+01
  VMC Evar = 2.9791e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.5419e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.297924126294
                                         uncertainty =       0.002798240063

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.297924126294
                                         uncertainty =       0.002798240063

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000385944609
  error estimate for blocks of size 2^( 2) =       0.000401794970
  error estimate for blocks of size 2^( 3) =       0.000417976845
  error estimate for blocks of size 2^( 4) =       0.000431992181
  error estimate for blocks of size 2^( 5) =       0.000442448675
  error estimate for blocks of size 2^( 6) =       0.000448377721
  error estimate for blocks of size 2^( 7) =       0.000452248576

      target function =      -0.915940691721
              le_mean =     -16.901411846332
             les_mean =     285.955628733533
             stat err =       0.000443766788
             autocorr =       1.322085776927
   target nu stat err =       0.000443766788
   target dn stat err =       0.002915280140
      target stat err =       0.004472121119
              std dev =       0.545808101042
             le_variance =       0.297906483163


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690141184633e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.5625e-02, overlap shift 1.5625e-01 and omega -1.7456e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.915961252033       residual = 9.25e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.916259527915       residual = 1.46e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.916337388223       residual = 1.31e-03           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.916438849018       residual = 1.64e-03           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.916530551312       residual = 8.96e-04           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.916665591230       residual = 8.68e-04           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.916798782782       residual = 1.20e-03           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.916874158543       residual = 7.03e-04           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.916965717709       residual = 5.45e-04           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.917112596671       residual = 3.35e-04           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.917269424748       residual = 6.60e-04           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.917410137461       residual = 3.29e-04           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.917463979110       residual = 1.30e-04           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.917495560207       residual = 6.58e-05           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.917540996258       residual = 1.01e-04           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.917600223997       residual = 9.82e-05           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.917616998191       residual = 3.09e-05           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.917629806884       residual = 2.60e-05           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.917642915092       residual = 2.03e-05           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.917649132738       residual = 2.21e-05           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.917660545608       residual = 8.40e-06           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.917679374261       residual = 8.14e-06           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.917685283275       residual = 5.29e-06           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.917690700361       residual = 4.34e-06           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.917694834338       residual = 4.01e-06           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =      -0.917703471428       residual = 2.20e-06           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   tar_fn =      -0.917706868640       residual = 8.65e-07           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   tar_fn =      -0.917706002922       residual = 6.39e-07           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   tar_fn =      -0.917708138062       residual = 2.78e-07           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   tar_fn =      -0.917707652932       residual = 1.24e-07           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   tar_fn =      -0.917708171544       residual = 5.01e-08           smallest_sin_value = 1.00e+00
davidson iteration   31:   krylov dim =  32   tar_fn =      -0.917708610945       residual = 3.51e-08           smallest_sin_value = 1.00e+00
davidson iteration   32:   krylov dim =  33   tar_fn =      -0.917708964308       residual = 6.26e-08           smallest_sin_value = 1.00e+00
davidson iteration   33:   krylov dim =  34   tar_fn =      -0.917709100303       residual = 1.16e-08           smallest_sin_value = 1.00e+00
davidson iteration   34:   krylov dim =  35   tar_fn =      -0.917709452099       residual = 4.51e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         34 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.5625e-02 is 4.426616e-02

solving harmonic davidson linear method for identity shift 6.2500e-02, overlap shift 6.2500e-01 and omega -1.7456e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.915961252033       residual = 9.25e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.916159231577       residual = 1.55e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.916212089445       residual = 1.22e-03           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.916277938369       residual = 1.55e-03           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.916330365162       residual = 7.86e-04           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.916407439348       residual = 6.86e-04           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.916474195039       residual = 1.04e-03           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.916519741472       residual = 5.45e-04           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.916565082675       residual = 3.83e-04           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.916637714155       residual = 2.39e-04           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.916712832674       residual = 3.74e-04           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.916770946122       residual = 8.68e-05           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.916788524308       residual = 4.68e-05           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.916801411714       residual = 9.68e-05           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.916811764962       residual = 5.61e-05           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.916826668222       residual = 3.10e-05           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.916829859108       residual = 1.68e-05           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.916835007343       residual = 1.31e-05           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.916838888723       residual = 6.66e-06           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.916839463789       residual = 8.11e-06           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.916842170587       residual = 4.35e-06           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.916846658824       residual = 1.83e-06           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.916848886119       residual = 1.62e-06           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.916849751238       residual = 1.18e-06           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.916850860221       residual = 8.36e-07           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =      -0.916851068939       residual = 3.31e-07           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   tar_fn =      -0.916851206646       residual = 7.61e-08           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   tar_fn =      -0.916851200619       residual = 2.20e-08           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   tar_fn =      -0.916851016111       residual = 9.68e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         28 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 6.2500e-02 is 1.820732e-02

solving harmonic davidson linear method for identity shift 2.5000e-01, overlap shift 2.5000e+00 and omega -1.7456e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.915961252033       residual = 9.25e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.916045670355       residual = 1.66e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.916068953503       residual = 1.13e-03           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.916096422297       residual = 1.43e-03           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.916115401617       residual = 7.00e-04           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.916144144556       residual = 5.53e-04           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.916166617546       residual = 9.14e-04           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.916184811848       residual = 4.33e-04           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.916199451822       residual = 2.82e-04           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.916222862893       residual = 1.88e-04           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.916241795627       residual = 3.13e-04           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.916256309241       residual = 1.08e-04           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.916261219427       residual = 4.44e-05           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.916265443449       residual = 3.07e-05           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.916269598854       residual = 2.37e-05           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.916272239742       residual = 1.33e-05           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.916272796949       residual = 1.00e-05           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.916274098972       residual = 5.87e-06           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.916274690614       residual = 2.52e-06           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.916274623483       residual = 3.42e-06           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.916275276573       residual = 1.87e-06           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.916276114795       residual = 5.24e-07           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.916276580084       residual = 4.35e-07           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.916276680245       residual = 4.81e-07           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.916276756843       residual = 2.31e-07           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =      -0.916276710850       residual = 6.12e-08           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   tar_fn =      -0.916276674035       residual = 1.34e-08           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   tar_fn =      -0.916276699430       residual = 5.47e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         27 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.5000e-01 is 5.689989e-03

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.137229 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.6309e+01
  </log>
  <optVariables href="H2O.s003.opt.xml">
 uu_0                 2.675935e-01 1 1  ON 0
 uu_1                 1.140911e-01 1 1  ON 1
 uu_2                 2.663895e-02 1 1  ON 2
 uu_3                -2.523735e-02 1 1  ON 3
 uu_4                -6.063380e-02 1 1  ON 4
 uu_5                -8.668637e-02 1 1  ON 5
 uu_6                -1.055320e-01 1 1  ON 6
 uu_7                -1.128659e-01 1 1  ON 7
 uu_8                -1.049315e-01 1 1  ON 8
 uu_9                -7.359387e-02 1 1  ON 9
 ud_0                 3.701494e-01 1 1  ON 10
 ud_1                 1.414705e-01 1 1  ON 11
 ud_2                 3.996723e-02 1 1  ON 12
 ud_3                -1.712967e-02 1 1  ON 13
 ud_4                -6.195792e-02 1 1  ON 14
 ud_5                -9.372468e-02 1 1  ON 15
 ud_6                -1.136408e-01 1 1  ON 16
 ud_7                -1.227776e-01 1 1  ON 17
 ud_8                -1.181525e-01 1 1  ON 18
 ud_9                -9.328804e-02 1 1  ON 19
 eO_0                -6.291874e-01 1 1  ON 20
 eO_1                -3.593940e-01 1 1  ON 21
 eO_2                 6.414068e-03 1 1  ON 22
 eO_3                 2.693003e-01 1 1  ON 23
 eO_4                 4.222446e-01 1 1  ON 24
 eO_5                 3.809163e-01 1 1  ON 25
 eO_6                 1.878002e-01 1 1  ON 26
 eO_7                -4.412416e-02 1 1  ON 27
 eO_8                -1.775503e-01 1 1  ON 28
 eO_9                -6.018318e-02 1 1  ON 29
eH1_0                -2.279641e-01 1 1  ON 30
eH1_1                -1.150940e-01 1 1  ON 31
eH1_2                -6.505468e-02 1 1  ON 32
eH1_3                -2.573020e-02 1 1  ON 33
eH1_4                 4.812094e-03 1 1  ON 34
eH1_5                 2.487006e-02 1 1  ON 35
eH1_6                 7.449303e-02 1 1  ON 36
eH1_7                 1.291487e-01 1 1  ON 37
eH1_8                 1.531380e-01 1 1  ON 38
eH1_9                 5.121724e-02 1 1  ON 39
eH2_0                -2.228862e-01 1 1  ON 40
eH2_1                -1.100388e-01 1 1  ON 41
eH2_2                -6.039801e-02 1 1  ON 42
eH2_3                -2.208406e-02 1 1  ON 43
eH2_4                 8.215694e-03 1 1  ON 44
eH2_5                 2.694023e-02 1 1  ON 45
eH2_6                 7.483557e-02 1 1  ON 46
eH2_7                 1.354241e-01 1 1  ON 47
eH2_8                 1.562803e-01 1 1  ON 48
eH2_9                 3.313112e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 3
    time step          = 0.05
    reference energy   = -16.8983
    reference variance = 0.351721
====================================================
  Execution time = 2.0308e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s003
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6900e+01
  VMC Evar = 2.9480e-01
  Total weights = 2.0000e+06
  Execution time = 1.8870e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.296106353976
                                         uncertainty =       0.002942914185

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.296106353976
                                         uncertainty =       0.002942914185

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000384723934
  error estimate for blocks of size 2^( 2) =       0.000400566986
  error estimate for blocks of size 2^( 3) =       0.000416446023
  error estimate for blocks of size 2^( 4) =       0.000430444911
  error estimate for blocks of size 2^( 5) =       0.000441966386
  error estimate for blocks of size 2^( 6) =       0.000447111320
  error estimate for blocks of size 2^( 7) =       0.000451296334

      target function =      -0.918747313410
              le_mean =     -16.899880397636
             les_mean =     285.901982317066
             stat err =       0.000442704738
             autocorr =       1.324127879723
   target nu stat err =       0.000442704738
   target dn stat err =       0.002795996487
      target stat err =       0.004307922073
              std dev =       0.544081805126
             le_variance =       0.296025010669

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.294335673407
                                         uncertainty =       0.002889580920

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.294335673407
                                         uncertainty =       0.002889580920

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000383573654
  error estimate for blocks of size 2^( 2) =       0.000400453049
  error estimate for blocks of size 2^( 3) =       0.000417650393
  error estimate for blocks of size 2^( 4) =       0.000432925325
  error estimate for blocks of size 2^( 5) =       0.000445291997
  error estimate for blocks of size 2^( 6) =       0.000450972018
  error estimate for blocks of size 2^( 7) =       0.000455397027

      target function =      -0.921443389062
              le_mean =     -16.899976077489
             les_mean =     285.903448768336
             stat err =       0.000446146592
             autocorr =       1.352874840523
   target nu stat err =       0.000446146592
   target dn stat err =       0.002746504466
      target stat err =       0.004260116894
              std dev =       0.542455063368
             le_variance =       0.294257495773

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.294133186272
                                         uncertainty =       0.002883098186

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.294133186272
                                         uncertainty =       0.002883098186

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000383441771
  error estimate for blocks of size 2^( 2) =       0.000400250330
  error estimate for blocks of size 2^( 3) =       0.000417312513
  error estimate for blocks of size 2^( 4) =       0.000432412025
  error estimate for blocks of size 2^( 5) =       0.000444632820
  error estimate for blocks of size 2^( 6) =       0.000450235679
  error estimate for blocks of size 2^( 7) =       0.000454627994

      target function =      -0.921749992273
              le_mean =     -16.899912361366
             les_mean =     285.901092858144
             stat err =       0.000445477130
             autocorr =       1.349745791692
   target nu stat err =       0.000445477130
   target dn stat err =       0.002740728518
      target stat err =       0.004253534168
              std dev =       0.542268552766
             le_variance =       0.294055183319

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.295573321331
                                         uncertainty =       0.002930663495

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.295573321331
                                         uncertainty =       0.002930663495

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000384377829
  error estimate for blocks of size 2^( 2) =       0.000400371267
  error estimate for blocks of size 2^( 3) =       0.000416430189
  error estimate for blocks of size 2^( 4) =       0.000430589893
  error estimate for blocks of size 2^( 5) =       0.000442207634
  error estimate for blocks of size 2^( 6) =       0.000447417748
  error estimate for blocks of size 2^( 7) =       0.000451632639

      target function =      -0.919554815699
              le_mean =     -16.899834981959
             les_mean =     285.899914901124
             stat err =       0.000442961978
             autocorr =       1.328055548238
   target nu stat err =       0.000442961978
   target dn stat err =       0.002784636565
      target stat err =       0.004298082269
              std dev =       0.543592339379
             le_variance =       0.295492631431


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.918747313410        initial
     1.5625e-02     1.5625e-01             4.4266e-02        -0.921443389062
     6.2500e-02     6.2500e-01             1.8207e-02        -0.921749992273  <--
     2.5000e-01     2.5000e+00             5.6900e-03        -0.919554815699

*****************************************************************************
Applying the update for shift_i =   6.2500e-02     and shift_s =   6.2500e-01
*****************************************************************************

  Execution time = 2.9824e+01
  </log>
  <optVariables href="H2O.s003.opt.xml">
 uu_0                 2.675935e-01 1 1  ON 0
 uu_1                 1.140911e-01 1 1  ON 1
 uu_2                 2.663895e-02 1 1  ON 2
 uu_3                -2.523735e-02 1 1  ON 3
 uu_4                -6.063380e-02 1 1  ON 4
 uu_5                -8.668637e-02 1 1  ON 5
 uu_6                -1.055320e-01 1 1  ON 6
 uu_7                -1.128659e-01 1 1  ON 7
 uu_8                -1.049315e-01 1 1  ON 8
 uu_9                -7.359387e-02 1 1  ON 9
 ud_0                 3.701494e-01 1 1  ON 10
 ud_1                 1.414705e-01 1 1  ON 11
 ud_2                 3.996723e-02 1 1  ON 12
 ud_3                -1.712967e-02 1 1  ON 13
 ud_4                -6.195792e-02 1 1  ON 14
 ud_5                -9.372468e-02 1 1  ON 15
 ud_6                -1.136408e-01 1 1  ON 16
 ud_7                -1.227776e-01 1 1  ON 17
 ud_8                -1.181525e-01 1 1  ON 18
 ud_9                -9.328804e-02 1 1  ON 19
 eO_0                -6.291874e-01 1 1  ON 20
 eO_1                -3.593940e-01 1 1  ON 21
 eO_2                 6.414068e-03 1 1  ON 22
 eO_3                 2.693003e-01 1 1  ON 23
 eO_4                 4.222446e-01 1 1  ON 24
 eO_5                 3.809163e-01 1 1  ON 25
 eO_6                 1.878002e-01 1 1  ON 26
 eO_7                -4.412416e-02 1 1  ON 27
 eO_8                -1.775503e-01 1 1  ON 28
 eO_9                -6.018318e-02 1 1  ON 29
eH1_0                -2.279641e-01 1 1  ON 30
eH1_1                -1.150940e-01 1 1  ON 31
eH1_2                -6.505468e-02 1 1  ON 32
eH1_3                -2.573020e-02 1 1  ON 33
eH1_4                 4.812094e-03 1 1  ON 34
eH1_5                 2.487006e-02 1 1  ON 35
eH1_6                 7.449303e-02 1 1  ON 36
eH1_7                 1.291487e-01 1 1  ON 37
eH1_8                 1.531380e-01 1 1  ON 38
eH1_9                 5.121724e-02 1 1  ON 39
eH2_0                -2.228862e-01 1 1  ON 40
eH2_1                -1.100388e-01 1 1  ON 41
eH2_2                -6.039801e-02 1 1  ON 42
eH2_3                -2.208406e-02 1 1  ON 43
eH2_4                 8.215694e-03 1 1  ON 44
eH2_5                 2.694023e-02 1 1  ON 45
eH2_6                 7.483557e-02 1 1  ON 46
eH2_7                 1.354241e-01 1 1  ON 47
eH2_8                 1.562803e-01 1 1  ON 48
eH2_9                 3.313112e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.6139e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s004 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s004 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=4  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6893e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 4
    time step          = 0.05
    reference energy   = -16.9088
    reference variance = 0.169955
====================================================
  Execution time = 2.0901e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s004
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6900e+01
  VMC Evar = 3.0658e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.5174e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.306673508813
                                         uncertainty =       0.008724243817

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.306673508813
                                         uncertainty =       0.008724243817

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000391521186
  error estimate for blocks of size 2^( 2) =       0.000407410128
  error estimate for blocks of size 2^( 3) =       0.000423633902
  error estimate for blocks of size 2^( 4) =       0.000437933668
  error estimate for blocks of size 2^( 5) =       0.000450047270
  error estimate for blocks of size 2^( 6) =       0.000455701933
  error estimate for blocks of size 2^( 7) =       0.000459208354

      target function =      -0.902825569596
              le_mean =     -16.900092978867
             les_mean =     285.919720219420
             stat err =       0.000450722806
             autocorr =       1.325282708989
   target nu stat err =       0.000450722806
   target dn stat err =       0.009067764100
      target stat err =       0.013322905563
              std dev =       0.553694571361
             le_variance =       0.306577678354


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690009297887e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.5625e-02, overlap shift 1.5625e-01 and omega -1.7456e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.903019109931       residual = 6.05e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.903236092865       residual = 1.48e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.903365741196       residual = 1.36e-03           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.903444300623       residual = 6.95e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.903522875111       residual = 4.65e-04           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.903588305031       residual = 6.39e-04           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.903697141222       residual = 4.90e-04           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.903751913730       residual = 6.00e-04           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.903808358928       residual = 6.01e-04           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.903878839317       residual = 2.25e-04           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.903973005269       residual = 3.55e-04           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.904057221539       residual = 3.26e-04           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.904132291790       residual = 1.90e-04           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.904168658546       residual = 5.60e-05           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.904205741697       residual = 8.11e-05           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.904225418638       residual = 7.76e-05           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.904282325901       residual = 6.61e-05           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.904301792320       residual = 3.10e-05           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.904310378190       residual = 1.41e-05           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.904335256388       residual = 1.29e-05           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.904343315996       residual = 1.20e-05           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.904350649412       residual = 1.26e-05           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.904350662631       residual = 6.05e-06           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.904357475201       residual = 2.83e-06           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.904361830981       residual = 4.80e-06           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =      -0.904371655591       residual = 2.25e-06           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   tar_fn =      -0.904372869993       residual = 8.94e-07           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   tar_fn =      -0.904374218268       residual = 1.84e-07           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   tar_fn =      -0.904374226834       residual = 1.82e-07           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   tar_fn =      -0.904377397896       residual = 5.40e-08           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   tar_fn =      -0.904376678798       residual = 5.86e-08           smallest_sin_value = 1.00e+00
davidson iteration   31:   krylov dim =  32   tar_fn =      -0.904376984376       residual = 1.82e-08           smallest_sin_value = 1.00e+00
davidson iteration   32:   krylov dim =  33   tar_fn =      -0.904376901394       residual = 2.91e-08           smallest_sin_value = 1.00e+00
davidson iteration   33:   krylov dim =  34   tar_fn =      -0.904377455726       residual = 4.59e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         33 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.5625e-02 is 4.212101e-02

solving harmonic davidson linear method for identity shift 6.2500e-02, overlap shift 6.2500e-01 and omega -1.7456e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.903019109931       residual = 6.05e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.903159336632       residual = 1.42e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.903244827135       residual = 1.31e-03           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.903296853013       residual = 6.79e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.903341239269       residual = 4.24e-04           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.903377908322       residual = 6.08e-04           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.903429207721       residual = 8.08e-04           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.903455190131       residual = 3.70e-04           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.903494957079       residual = 3.41e-04           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.903536184413       residual = 1.60e-04           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.903581450305       residual = 2.15e-04           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.903617183230       residual = 1.88e-04           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.903641619902       residual = 1.05e-04           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.903652769278       residual = 3.47e-05           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.903668308701       residual = 4.90e-05           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.903673890741       residual = 4.05e-05           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.903689863740       residual = 2.22e-05           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.903694141914       residual = 1.12e-05           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.903695387541       residual = 5.44e-06           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.903700368694       residual = 7.21e-06           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.903704346054       residual = 3.14e-06           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.903704252082       residual = 2.40e-06           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.903703915764       residual = 1.82e-06           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.903704653558       residual = 8.54e-07           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.903705576861       residual = 6.01e-07           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =      -0.903706733294       residual = 2.42e-07           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   tar_fn =      -0.903706066527       residual = 8.78e-08           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   tar_fn =      -0.903706191028       residual = 1.35e-08           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   tar_fn =      -0.903706406761       residual = 1.25e-08           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   tar_fn =      -0.903706567548       residual = 2.39e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         29 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 6.2500e-02 is 1.727595e-02

solving harmonic davidson linear method for identity shift 2.5000e-01, overlap shift 2.5000e+00 and omega -1.7456e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.903019109931       residual = 6.05e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.903077171406       residual = 1.38e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.903113586975       residual = 1.26e-03           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.903136065555       residual = 6.58e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.903151821017       residual = 3.88e-04           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.903164735131       residual = 6.01e-04           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.903181751308       residual = 6.54e-04           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.903193744526       residual = 2.79e-04           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.903207716338       residual = 2.61e-04           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.903220905732       residual = 1.19e-04           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.903235285315       residual = 1.34e-04           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.903245900258       residual = 9.95e-05           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.903250760994       residual = 5.88e-05           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.903252970453       residual = 2.35e-05           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.903257060716       residual = 2.91e-05           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.903257696302       residual = 2.07e-05           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.903260862563       residual = 8.91e-06           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.903261562843       residual = 5.03e-06           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.903261727661       residual = 2.34e-06           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.903262595547       residual = 2.82e-06           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.903263548575       residual = 1.25e-06           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.903263233790       residual = 5.05e-07           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.903263099437       residual = 5.25e-07           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.903263156243       residual = 2.97e-07           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.903263304036       residual = 1.51e-07           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =      -0.903263417454       residual = 5.41e-08           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   tar_fn =      -0.903263317353       residual = 1.11e-08           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   tar_fn =      -0.903263318371       residual = 2.08e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         27 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.5000e-01 is 5.329965e-03

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.171978 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.6459e+01
  </log>
  <optVariables href="H2O.s004.opt.xml">
 uu_0                 2.628869e-01 1 1  ON 0
 uu_1                 1.109961e-01 1 1  ON 1
 uu_2                 2.447988e-02 1 1  ON 2
 uu_3                -2.645374e-02 1 1  ON 3
 uu_4                -6.071283e-02 1 1  ON 4
 uu_5                -8.525023e-02 1 1  ON 5
 uu_6                -1.041736e-01 1 1  ON 6
 uu_7                -1.115258e-01 1 1  ON 7
 uu_8                -1.024719e-01 1 1  ON 8
 uu_9                -7.156430e-02 1 1  ON 9
 ud_0                 3.655565e-01 1 1  ON 10
 ud_1                 1.376862e-01 1 1  ON 11
 ud_2                 3.559546e-02 1 1  ON 12
 ud_3                -2.093942e-02 1 1  ON 13
 ud_4                -6.395500e-02 1 1  ON 14
 ud_5                -9.329416e-02 1 1  ON 15
 ud_6                -1.124727e-01 1 1  ON 16
 ud_7                -1.208116e-01 1 1  ON 17
 ud_8                -1.118307e-01 1 1  ON 18
 ud_9                -8.541976e-02 1 1  ON 19
 eO_0                -6.153364e-01 1 1  ON 20
 eO_1                -3.467120e-01 1 1  ON 21
 eO_2                 1.587967e-02 1 1  ON 22
 eO_3                 2.688823e-01 1 1  ON 23
 eO_4                 4.101520e-01 1 1  ON 24
 eO_5                 3.636403e-01 1 1  ON 25
 eO_6                 1.761874e-01 1 1  ON 26
 eO_7                -4.314594e-02 1 1  ON 27
 eO_8                -1.728533e-01 1 1  ON 28
 eO_9                -6.080622e-02 1 1  ON 29
eH1_0                -2.297680e-01 1 1  ON 30
eH1_1                -1.169620e-01 1 1  ON 31
eH1_2                -6.416866e-02 1 1  ON 32
eH1_3                -2.651091e-02 1 1  ON 33
eH1_4                 4.189967e-03 1 1  ON 34
eH1_5                 2.283437e-02 1 1  ON 35
eH1_6                 7.295239e-02 1 1  ON 36
eH1_7                 1.316474e-01 1 1  ON 37
eH1_8                 1.562415e-01 1 1  ON 38
eH1_9                 5.364950e-02 1 1  ON 39
eH2_0                -2.238379e-01 1 1  ON 40
eH2_1                -1.078839e-01 1 1  ON 41
eH2_2                -5.653014e-02 1 1  ON 42
eH2_3                -1.961139e-02 1 1  ON 43
eH2_4                 1.009331e-02 1 1  ON 44
eH2_5                 2.399474e-02 1 1  ON 45
eH2_6                 7.152083e-02 1 1  ON 46
eH2_7                 1.293528e-01 1 1  ON 47
eH2_8                 1.532515e-01 1 1  ON 48
eH2_9                 3.837013e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 4
    time step          = 0.05
    reference energy   = -16.8627
    reference variance = 0.21078
====================================================
  Execution time = 2.2473e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s004
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6899e+01
  VMC Evar = 2.9097e-01
  Total weights = 2.0000e+06
  Execution time = 1.8811e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.291484603001
                                         uncertainty =       0.003079980812

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.291484603001
                                         uncertainty =       0.003079980812

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000381718857
  error estimate for blocks of size 2^( 2) =       0.000397513314
  error estimate for blocks of size 2^( 3) =       0.000413909925
  error estimate for blocks of size 2^( 4) =       0.000428145370
  error estimate for blocks of size 2^( 5) =       0.000439882659
  error estimate for blocks of size 2^( 6) =       0.000447667261
  error estimate for blocks of size 2^( 7) =       0.000450627785

      target function =      -0.925760557144
              le_mean =     -16.899288099584
             les_mean =     285.877356699038
             stat err =       0.000441580769
             autocorr =       1.338237120092
   target nu stat err =       0.000441580769
   target dn stat err =       0.003129677314
      target stat err =       0.004875361519
              std dev =       0.539831984967
             le_variance =       0.291418571994

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.290944011624
                                         uncertainty =       0.003047985620

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.290944011624
                                         uncertainty =       0.003047985620

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000381365746
  error estimate for blocks of size 2^( 2) =       0.000397964315
  error estimate for blocks of size 2^( 3) =       0.000415421796
  error estimate for blocks of size 2^( 4) =       0.000430719450
  error estimate for blocks of size 2^( 5) =       0.000443233909
  error estimate for blocks of size 2^( 6) =       0.000451425069
  error estimate for blocks of size 2^( 7) =       0.000454703996

      target function =      -0.926592292669
              le_mean =     -16.899297794264
             les_mean =     285.877145458339
             stat err =       0.000445020606
             autocorr =       1.361685699059
   target nu stat err =       0.000445020606
   target dn stat err =       0.003092630754
      target stat err =       0.004828487754
              std dev =       0.539332610342
             le_variance =       0.290879664578

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.290915857921
                                         uncertainty =       0.003043834232

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.290915857921
                                         uncertainty =       0.003043834232

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000381347145
  error estimate for blocks of size 2^( 2) =       0.000397919037
  error estimate for blocks of size 2^( 3) =       0.000415316605
  error estimate for blocks of size 2^( 4) =       0.000430545911
  error estimate for blocks of size 2^( 5) =       0.000443006839
  error estimate for blocks of size 2^( 6) =       0.000451189843
  error estimate for blocks of size 2^( 7) =       0.000454421636

      target function =      -0.926635501270
              le_mean =     -16.899285375442
             les_mean =     285.876697344678
             stat err =       0.000444791057
             autocorr =       1.360414008732
   target nu stat err =       0.000444791057
   target dn stat err =       0.003087653289
      target stat err =       0.004821177238
              std dev =       0.539306303959
             le_variance =       0.290851289490

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.291271595481
                                         uncertainty =       0.003072823548

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.291271595481
                                         uncertainty =       0.003072823548

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000381579480
  error estimate for blocks of size 2^( 2) =       0.000397492464
  error estimate for blocks of size 2^( 3) =       0.000414040632
  error estimate for blocks of size 2^( 4) =       0.000428426613
  error estimate for blocks of size 2^( 5) =       0.000440273721
  error estimate for blocks of size 2^( 6) =       0.000448120007
  error estimate for blocks of size 2^( 7) =       0.000451120118

      target function =      -0.926086569769
              le_mean =     -16.899251153240
             les_mean =     285.875895193840
             stat err =       0.000441985115
             autocorr =       1.341668621435
   target nu stat err =       0.000441985115
   target dn stat err =       0.003121360893
      target stat err =       0.004865865171
              std dev =       0.539634875794
             le_variance =       0.291205799173


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.925760557144        initial
     1.5625e-02     1.5625e-01             4.2121e-02        -0.926592292669
     6.2500e-02     6.2500e-01             1.7276e-02        -0.926635501270  <--
     2.5000e-01     2.5000e+00             5.3300e-03        -0.926086569769

*****************************************************************************
Applying the update for shift_i =   6.2500e-02     and shift_s =   6.2500e-01
*****************************************************************************

  Execution time = 3.1976e+01
  </log>
  <optVariables href="H2O.s004.opt.xml">
 uu_0                 2.628869e-01 1 1  ON 0
 uu_1                 1.109961e-01 1 1  ON 1
 uu_2                 2.447988e-02 1 1  ON 2
 uu_3                -2.645374e-02 1 1  ON 3
 uu_4                -6.071283e-02 1 1  ON 4
 uu_5                -8.525023e-02 1 1  ON 5
 uu_6                -1.041736e-01 1 1  ON 6
 uu_7                -1.115258e-01 1 1  ON 7
 uu_8                -1.024719e-01 1 1  ON 8
 uu_9                -7.156430e-02 1 1  ON 9
 ud_0                 3.655565e-01 1 1  ON 10
 ud_1                 1.376862e-01 1 1  ON 11
 ud_2                 3.559546e-02 1 1  ON 12
 ud_3                -2.093942e-02 1 1  ON 13
 ud_4                -6.395500e-02 1 1  ON 14
 ud_5                -9.329416e-02 1 1  ON 15
 ud_6                -1.124727e-01 1 1  ON 16
 ud_7                -1.208116e-01 1 1  ON 17
 ud_8                -1.118307e-01 1 1  ON 18
 ud_9                -8.541976e-02 1 1  ON 19
 eO_0                -6.153364e-01 1 1  ON 20
 eO_1                -3.467120e-01 1 1  ON 21
 eO_2                 1.587967e-02 1 1  ON 22
 eO_3                 2.688823e-01 1 1  ON 23
 eO_4                 4.101520e-01 1 1  ON 24
 eO_5                 3.636403e-01 1 1  ON 25
 eO_6                 1.761874e-01 1 1  ON 26
 eO_7                -4.314594e-02 1 1  ON 27
 eO_8                -1.728533e-01 1 1  ON 28
 eO_9                -6.080622e-02 1 1  ON 29
eH1_0                -2.297680e-01 1 1  ON 30
eH1_1                -1.169620e-01 1 1  ON 31
eH1_2                -6.416866e-02 1 1  ON 32
eH1_3                -2.651091e-02 1 1  ON 33
eH1_4                 4.189967e-03 1 1  ON 34
eH1_5                 2.283437e-02 1 1  ON 35
eH1_6                 7.295239e-02 1 1  ON 36
eH1_7                 1.316474e-01 1 1  ON 37
eH1_8                 1.562415e-01 1 1  ON 38
eH1_9                 5.364950e-02 1 1  ON 39
eH2_0                -2.238379e-01 1 1  ON 40
eH2_1                -1.078839e-01 1 1  ON 41
eH2_2                -5.653014e-02 1 1  ON 42
eH2_3                -1.961139e-02 1 1  ON 43
eH2_4                 1.009331e-02 1 1  ON 44
eH2_5                 2.399474e-02 1 1  ON 45
eH2_6                 7.152083e-02 1 1  ON 46
eH2_7                 1.293528e-01 1 1  ON 47
eH2_8                 1.532515e-01 1 1  ON 48
eH2_9                 3.837013e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.8441e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s005 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s005 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=5  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6892e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 5
    time step          = 0.05
    reference energy   = -16.9141
    reference variance = 0.222381
====================================================
  Execution time = 2.0683e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s005
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6900e+01
  VMC Evar = 2.9036e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.6170e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.290342579455
                                         uncertainty =       0.002507257692

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.290342579455
                                         uncertainty =       0.002507257692

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000381023241
  error estimate for blocks of size 2^( 2) =       0.000397665437
  error estimate for blocks of size 2^( 3) =       0.000414773545
  error estimate for blocks of size 2^( 4) =       0.000430029723
  error estimate for blocks of size 2^( 5) =       0.000441690966
  error estimate for blocks of size 2^( 6) =       0.000448553823
  error estimate for blocks of size 2^( 7) =       0.000452636301

      target function =      -0.927419948897
              le_mean =     -16.899555427123
             les_mean =     285.885330909932
             stat err =       0.000443227703
             autocorr =       1.353165326674
   target nu stat err =       0.000443227703
   target dn stat err =       0.002577215444
      target stat err =       0.004052972657
              std dev =       0.538848235313
             le_variance =       0.290357420700


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.689955542712e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.5625e-02, overlap shift 1.5625e-01 and omega -1.7456e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.927436181464       residual = 2.10e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.927541040980       residual = 9.04e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.927590265480       residual = 5.80e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.927634770204       residual = 6.46e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.927681987047       residual = 4.30e-04           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.927711427632       residual = 1.94e-04           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.927745289806       residual = 9.98e-05           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.927770704769       residual = 1.69e-04           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.927778292247       residual = 1.91e-04           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.927792597330       residual = 8.79e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.927815443416       residual = 1.15e-04           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.927858488614       residual = 1.49e-04           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.927887015959       residual = 4.77e-05           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.927898300025       residual = 3.17e-05           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.927917964055       residual = 4.46e-05           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.927931179614       residual = 2.45e-05           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.927957910998       residual = 2.58e-05           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.927962576860       residual = 1.46e-05           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.927968394214       residual = 6.29e-06           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.927969863741       residual = 5.49e-06           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.927975168986       residual = 6.00e-06           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.927978956322       residual = 3.86e-06           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.927981363448       residual = 1.11e-05           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.927984411919       residual = 2.96e-06           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.927988825971       residual = 2.32e-06           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =      -0.927992374324       residual = 2.18e-06           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   tar_fn =      -0.927995915397       residual = 5.97e-07           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   tar_fn =      -0.927996125544       residual = 1.96e-07           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   tar_fn =      -0.927995803363       residual = 1.30e-07           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   tar_fn =      -0.927995473700       residual = 7.56e-08           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   tar_fn =      -0.927996601624       residual = 5.63e-08           smallest_sin_value = 1.00e+00
davidson iteration   31:   krylov dim =  32   tar_fn =      -0.927997165995       residual = 4.96e-08           smallest_sin_value = 1.00e+00
davidson iteration   32:   krylov dim =  33   tar_fn =      -0.927998012237       residual = 2.65e-08           smallest_sin_value = 1.00e+00
davidson iteration   33:   krylov dim =  34   tar_fn =      -0.927997945405       residual = 4.73e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         33 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.5625e-02 is 2.635734e-02

solving harmonic davidson linear method for identity shift 6.2500e-02, overlap shift 6.2500e-01 and omega -1.7456e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.927436181464       residual = 2.10e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.927503127275       residual = 8.72e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.927535109648       residual = 5.21e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.927561037644       residual = 5.57e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.927585371501       residual = 3.25e-04           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.927600652948       residual = 1.59e-04           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.927613379752       residual = 1.74e-04           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.927621845578       residual = 8.87e-05           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.927633836599       residual = 7.72e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.927640525049       residual = 6.65e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.927654989850       residual = 1.08e-04           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.927676234688       residual = 9.02e-05           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.927686424446       residual = 2.96e-05           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.927690268438       residual = 2.11e-05           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.927696386476       residual = 2.47e-05           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.927701620377       residual = 1.18e-05           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.927708140170       residual = 8.41e-06           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.927708701791       residual = 5.63e-06           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.927710495288       residual = 1.98e-06           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.927711222554       residual = 1.72e-06           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.927712442762       residual = 2.85e-06           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.927712913326       residual = 1.47e-06           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.927712905898       residual = 2.02e-06           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.927713643292       residual = 7.51e-07           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.927713804581       residual = 2.95e-07           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =      -0.927714482334       residual = 2.03e-07           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   tar_fn =      -0.927714691715       residual = 5.88e-08           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   tar_fn =      -0.927714580393       residual = 2.14e-08           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   tar_fn =      -0.927714410577       residual = 7.00e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         28 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 6.2500e-02 is 9.437414e-03

solving harmonic davidson linear method for identity shift 2.5000e-01, overlap shift 2.5000e+00 and omega -1.7456e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.927436181464       residual = 2.10e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.927463547023       residual = 8.45e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.927477039224       residual = 4.69e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.927486669459       residual = 4.77e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.927494767756       residual = 2.55e-04           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.927500228948       residual = 1.44e-04           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.927503017820       residual = 2.02e-04           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.927507228528       residual = 5.82e-05           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.927511552680       residual = 4.93e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.927514571057       residual = 5.93e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.927521110986       residual = 1.09e-04           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.927525897224       residual = 5.09e-05           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.927528232869       residual = 1.95e-05           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.927529011575       residual = 1.41e-05           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.927530132737       residual = 1.26e-05           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.927531420008       residual = 5.23e-06           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.927532524408       residual = 3.21e-06           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.927532510536       residual = 2.35e-06           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.927532962285       residual = 8.39e-07           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.927533119869       residual = 6.07e-07           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.927533224605       residual = 1.16e-06           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.927533311982       residual = 4.68e-07           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.927533403336       residual = 1.95e-07           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.927533389458       residual = 7.62e-08           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.927533471976       residual = 1.32e-07           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =      -0.927533470803       residual = 3.27e-08           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   tar_fn =      -0.927533472645       residual = 9.22e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         26 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.5000e-01 is 2.771030e-03

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.205335 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.6339e+01
  </log>
  <optVariables href="H2O.s005.opt.xml">
 uu_0                 2.597875e-01 1 1  ON 0
 uu_1                 1.077306e-01 1 1  ON 1
 uu_2                 2.142873e-02 1 1  ON 2
 uu_3                -2.851298e-02 1 1  ON 3
 uu_4                -6.142934e-02 1 1  ON 4
 uu_5                -8.452385e-02 1 1  ON 5
 uu_6                -1.021294e-01 1 1  ON 6
 uu_7                -1.105998e-01 1 1  ON 7
 uu_8                -1.006948e-01 1 1  ON 8
 uu_9                -6.728779e-02 1 1  ON 9
 ud_0                 3.611723e-01 1 1  ON 10
 ud_1                 1.342320e-01 1 1  ON 11
 ud_2                 3.276697e-02 1 1  ON 12
 ud_3                -2.304458e-02 1 1  ON 13
 ud_4                -6.528201e-02 1 1  ON 14
 ud_5                -9.399557e-02 1 1  ON 15
 ud_6                -1.107128e-01 1 1  ON 16
 ud_7                -1.173203e-01 1 1  ON 17
 ud_8                -1.086159e-01 1 1  ON 18
 ud_9                -7.967122e-02 1 1  ON 19
 eO_0                -6.076718e-01 1 1  ON 20
 eO_1                -3.401121e-01 1 1  ON 21
 eO_2                 2.105183e-02 1 1  ON 22
 eO_3                 2.704930e-01 1 1  ON 23
 eO_4                 4.047985e-01 1 1  ON 24
 eO_5                 3.550344e-01 1 1  ON 25
 eO_6                 1.667500e-01 1 1  ON 26
 eO_7                -4.520155e-02 1 1  ON 27
 eO_8                -1.680996e-01 1 1  ON 28
 eO_9                -6.158375e-02 1 1  ON 29
eH1_0                -2.312505e-01 1 1  ON 30
eH1_1                -1.165515e-01 1 1  ON 31
eH1_2                -6.460274e-02 1 1  ON 32
eH1_3                -2.656122e-02 1 1  ON 33
eH1_4                 3.190725e-03 1 1  ON 34
eH1_5                 2.414121e-02 1 1  ON 35
eH1_6                 7.371905e-02 1 1  ON 36
eH1_7                 1.278023e-01 1 1  ON 37
eH1_8                 1.555841e-01 1 1  ON 38
eH1_9                 5.867064e-02 1 1  ON 39
eH2_0                -2.246210e-01 1 1  ON 40
eH2_1                -1.076351e-01 1 1  ON 41
eH2_2                -5.765039e-02 1 1  ON 42
eH2_3                -2.112907e-02 1 1  ON 43
eH2_4                 6.544111e-03 1 1  ON 44
eH2_5                 2.312738e-02 1 1  ON 45
eH2_6                 7.101211e-02 1 1  ON 46
eH2_7                 1.295073e-01 1 1  ON 47
eH2_8                 1.557281e-01 1 1  ON 48
eH2_9                 4.358878e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 5
    time step          = 0.05
    reference energy   = -16.8945
    reference variance = 0.174121
====================================================
  Execution time = 2.0577e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s005
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6899e+01
  VMC Evar = 2.9394e-01
  Total weights = 2.0000e+06
  Execution time = 1.8830e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.294511916470
                                         uncertainty =       0.003061901810

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.294511916470
                                         uncertainty =       0.003061901810

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000383705047
  error estimate for blocks of size 2^( 2) =       0.000400555237
  error estimate for blocks of size 2^( 3) =       0.000417249232
  error estimate for blocks of size 2^( 4) =       0.000431721100
  error estimate for blocks of size 2^( 5) =       0.000443458633
  error estimate for blocks of size 2^( 6) =       0.000450853245
  error estimate for blocks of size 2^( 7) =       0.000454036851

      target function =      -0.921069862976
              le_mean =     -16.898589316642
             les_mean =     285.856779872032
             stat err =       0.000445017457
             autocorr =       1.345113934969
   target nu stat err =       0.000445017457
   target dn stat err =       0.003261388392
      target stat err =       0.005019739973
              std dev =       0.542640881923
             le_variance =       0.294459126734

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.293766569014
                                         uncertainty =       0.003019291186

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.293766569014
                                         uncertainty =       0.003019291186

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000383219891
  error estimate for blocks of size 2^( 2) =       0.000400516421
  error estimate for blocks of size 2^( 3) =       0.000417782647
  error estimate for blocks of size 2^( 4) =       0.000432755384
  error estimate for blocks of size 2^( 5) =       0.000444875542
  error estimate for blocks of size 2^( 6) =       0.000452379329
  error estimate for blocks of size 2^( 7) =       0.000455667235

      target function =      -0.922206666981
              le_mean =     -16.898628947276
             les_mean =     285.857375121191
             stat err =       0.000446419373
             autocorr =       1.357031656364
   target nu stat err =       0.000446419373
   target dn stat err =       0.003221755560
      target stat err =       0.004972868424
              std dev =       0.541954767787
             le_variance =       0.293714970327

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.293611534561
                                         uncertainty =       0.003017701269

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.293611534561
                                         uncertainty =       0.003017701269

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000383118679
  error estimate for blocks of size 2^( 2) =       0.000400359011
  error estimate for blocks of size 2^( 3) =       0.000417533890
  error estimate for blocks of size 2^( 4) =       0.000432405410
  error estimate for blocks of size 2^( 5) =       0.000444438604
  error estimate for blocks of size 2^( 6) =       0.000451910668
  error estimate for blocks of size 2^( 7) =       0.000455182393

      target function =      -0.922442772888
              le_mean =     -16.898612862939
             les_mean =     285.856676388966
             stat err =       0.000445984269
             autocorr =       1.355103374433
   target nu stat err =       0.000445984269
   target dn stat err =       0.003220665016
      target stat err =       0.004973489414
              std dev =       0.541811631706
             le_variance =       0.293559844252

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.294292584268
                                         uncertainty =       0.003053697175

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.294292584268
                                         uncertainty =       0.003053697175

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000383562242
  error estimate for blocks of size 2^( 2) =       0.000400470161
  error estimate for blocks of size 2^( 3) =       0.000417233437
  error estimate for blocks of size 2^( 4) =       0.000431758680
  error estimate for blocks of size 2^( 5) =       0.000443533390
  error estimate for blocks of size 2^( 6) =       0.000450933820
  error estimate for blocks of size 2^( 7) =       0.000454129256

      target function =      -0.921403150113
              le_mean =     -16.898576094656
             les_mean =     285.856113866112
             stat err =       0.000445088786
             autocorr =       1.346547287528
   target nu stat err =       0.000445088786
   target dn stat err =       0.003253884373
      target stat err =       0.005011922484
              std dev =       0.542438924065
             le_variance =       0.294239986340


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.921069862976        initial
     1.5625e-02     1.5625e-01             2.6357e-02        -0.922206666981
     6.2500e-02     6.2500e-01             9.4374e-03        -0.922442772888  <--
     2.5000e-01     2.5000e+00             2.7710e-03        -0.921403150113

*****************************************************************************
Applying the update for shift_i =   6.2500e-02     and shift_s =   6.2500e-01
*****************************************************************************

  Execution time = 3.0104e+01
  </log>
  <optVariables href="H2O.s005.opt.xml">
 uu_0                 2.597875e-01 1 1  ON 0
 uu_1                 1.077306e-01 1 1  ON 1
 uu_2                 2.142873e-02 1 1  ON 2
 uu_3                -2.851298e-02 1 1  ON 3
 uu_4                -6.142934e-02 1 1  ON 4
 uu_5                -8.452385e-02 1 1  ON 5
 uu_6                -1.021294e-01 1 1  ON 6
 uu_7                -1.105998e-01 1 1  ON 7
 uu_8                -1.006948e-01 1 1  ON 8
 uu_9                -6.728779e-02 1 1  ON 9
 ud_0                 3.611723e-01 1 1  ON 10
 ud_1                 1.342320e-01 1 1  ON 11
 ud_2                 3.276697e-02 1 1  ON 12
 ud_3                -2.304458e-02 1 1  ON 13
 ud_4                -6.528201e-02 1 1  ON 14
 ud_5                -9.399557e-02 1 1  ON 15
 ud_6                -1.107128e-01 1 1  ON 16
 ud_7                -1.173203e-01 1 1  ON 17
 ud_8                -1.086159e-01 1 1  ON 18
 ud_9                -7.967122e-02 1 1  ON 19
 eO_0                -6.076718e-01 1 1  ON 20
 eO_1                -3.401121e-01 1 1  ON 21
 eO_2                 2.105183e-02 1 1  ON 22
 eO_3                 2.704930e-01 1 1  ON 23
 eO_4                 4.047985e-01 1 1  ON 24
 eO_5                 3.550344e-01 1 1  ON 25
 eO_6                 1.667500e-01 1 1  ON 26
 eO_7                -4.520155e-02 1 1  ON 27
 eO_8                -1.680996e-01 1 1  ON 28
 eO_9                -6.158375e-02 1 1  ON 29
eH1_0                -2.312505e-01 1 1  ON 30
eH1_1                -1.165515e-01 1 1  ON 31
eH1_2                -6.460274e-02 1 1  ON 32
eH1_3                -2.656122e-02 1 1  ON 33
eH1_4                 3.190725e-03 1 1  ON 34
eH1_5                 2.414121e-02 1 1  ON 35
eH1_6                 7.371905e-02 1 1  ON 36
eH1_7                 1.278023e-01 1 1  ON 37
eH1_8                 1.555841e-01 1 1  ON 38
eH1_9                 5.867064e-02 1 1  ON 39
eH2_0                -2.246210e-01 1 1  ON 40
eH2_1                -1.076351e-01 1 1  ON 41
eH2_2                -5.765039e-02 1 1  ON 42
eH2_3                -2.112907e-02 1 1  ON 43
eH2_4                 6.544111e-03 1 1  ON 44
eH2_5                 2.312738e-02 1 1  ON 45
eH2_6                 7.101211e-02 1 1  ON 46
eH2_7                 1.295073e-01 1 1  ON 47
eH2_8                 1.557281e-01 1 1  ON 48
eH2_9                 4.358878e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.6450e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s006 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s006 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=6  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6894e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 6
    time step          = 0.05
    reference energy   = -16.8865
    reference variance = 0.339025
====================================================
  Execution time = 2.0883e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s006
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6899e+01
  VMC Evar = 3.0845e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.5105e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.308502535968
                                         uncertainty =       0.014346292780

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.308502535968
                                         uncertainty =       0.014346292780

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000392716823
  error estimate for blocks of size 2^( 2) =       0.000408617543
  error estimate for blocks of size 2^( 3) =       0.000425037836
  error estimate for blocks of size 2^( 4) =       0.000439818802
  error estimate for blocks of size 2^( 5) =       0.000450592160
  error estimate for blocks of size 2^( 6) =       0.000458187478
  error estimate for blocks of size 2^( 7) =       0.000459935136

      target function =      -0.899790518484
              le_mean =     -16.899187291272
             les_mean =     285.890983956678
             stat err =       0.000452133394
             autocorr =       1.325482988918
   target nu stat err =       0.000452133394
   target dn stat err =       0.014384596901
      target stat err =       0.020946523861
              std dev =       0.555385456626
             le_variance =       0.308453005432


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.689918729127e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.5625e-02, overlap shift 1.5625e-01 and omega -1.7456e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.900273615818       residual = 4.61e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.900532751905       residual = 3.43e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.900752677127       residual = 1.52e-03           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.900850497739       residual = 1.15e-03           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.900969843730       residual = 6.30e-04           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.901055792532       residual = 2.28e-04           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.901080994469       residual = 5.50e-04           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.901154293196       residual = 4.71e-04           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.901187237598       residual = 9.64e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.901229482857       residual = 1.99e-04           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.901274422927       residual = 1.43e-04           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.901318395690       residual = 1.08e-04           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.901353271803       residual = 1.90e-04           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.901396552252       residual = 7.40e-05           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.901430176494       residual = 1.20e-04           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.901475293691       residual = 4.89e-05           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.901501407995       residual = 5.13e-05           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.901521493990       residual = 2.32e-05           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.901536600765       residual = 2.91e-05           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.901542397590       residual = 1.58e-05           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.901561428156       residual = 3.92e-05           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.901567165097       residual = 7.66e-06           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.901571517178       residual = 1.45e-05           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.901574109144       residual = 3.62e-06           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.901585537934       residual = 2.12e-06           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =      -0.901587436898       residual = 3.43e-06           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   tar_fn =      -0.901590064575       residual = 1.60e-06           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   tar_fn =      -0.901593703737       residual = 4.31e-07           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   tar_fn =      -0.901593254350       residual = 2.57e-07           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   tar_fn =      -0.901594260618       residual = 1.00e-07           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   tar_fn =      -0.901596574490       residual = 5.64e-08           smallest_sin_value = 1.00e+00
davidson iteration   31:   krylov dim =  32   tar_fn =      -0.901598295154       residual = 6.21e-08           smallest_sin_value = 1.00e+00
davidson iteration   32:   krylov dim =  33   tar_fn =      -0.901597768275       residual = 3.91e-08           smallest_sin_value = 1.00e+00
davidson iteration   33:   krylov dim =  34   tar_fn =      -0.901597495645       residual = 6.98e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         33 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.5625e-02 is 3.486937e-02

solving harmonic davidson linear method for identity shift 6.2500e-02, overlap shift 6.2500e-01 and omega -1.7456e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.900273615818       residual = 4.61e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.900444189882       residual = 3.26e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.900579468826       residual = 1.32e-03           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.900636268171       residual = 1.02e-03           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.900704048063       residual = 5.27e-04           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.900750032387       residual = 1.81e-04           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.900766290204       residual = 4.41e-04           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.900796345695       residual = 3.40e-04           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.900816477944       residual = 7.54e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.900835458139       residual = 1.58e-04           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.900857198743       residual = 8.47e-05           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.900874652100       residual = 7.28e-05           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.900884617233       residual = 9.83e-05           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.900900543993       residual = 3.62e-05           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.900912501940       residual = 5.44e-05           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.900923227406       residual = 1.94e-05           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.900928820421       residual = 1.72e-05           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.900931524768       residual = 7.14e-06           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.900935417570       residual = 7.57e-06           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.900936192222       residual = 5.83e-06           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.900939662994       residual = 4.94e-06           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.900939669848       residual = 1.90e-06           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.900940178920       residual = 1.55e-06           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.900939396043       residual = 8.10e-07           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.900940548943       residual = 4.45e-07           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =      -0.900941683353       residual = 2.93e-07           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   tar_fn =      -0.900941300227       residual = 1.37e-07           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   tar_fn =      -0.900941377273       residual = 2.08e-08           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   tar_fn =      -0.900941419493       residual = 1.01e-08           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   tar_fn =      -0.900941484060       residual = 2.94e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         29 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 6.2500e-02 is 1.209228e-02

solving harmonic davidson linear method for identity shift 2.5000e-01, overlap shift 2.5000e+00 and omega -1.7456e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.900273615818       residual = 4.61e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.900345672502       residual = 3.08e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.900399023432       residual = 1.14e-03           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.900420571595       residual = 9.18e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.900445816267       residual = 4.75e-04           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.900461255131       residual = 2.28e-04           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.900466232877       residual = 2.18e-04           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.900477209881       residual = 2.38e-04           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.900484705657       residual = 6.42e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.900490385156       residual = 1.15e-04           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.900497286174       residual = 5.24e-05           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.900501476790       residual = 4.95e-05           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.900503846108       residual = 5.07e-05           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.900507681325       residual = 2.10e-05           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.900510410193       residual = 2.48e-05           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.900512045976       residual = 8.97e-06           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.900513450555       residual = 7.50e-06           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.900513439793       residual = 2.83e-06           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.900513906209       residual = 3.19e-06           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.900514473487       residual = 1.96e-06           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.900514949458       residual = 1.61e-06           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.900514747332       residual = 3.10e-07           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.900514610235       residual = 4.82e-07           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.900514668239       residual = 1.14e-07           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.900514753349       residual = 1.31e-07           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =      -0.900514894114       residual = 6.66e-08           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   tar_fn =      -0.900514757863       residual = 1.50e-08           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   tar_fn =      -0.900514788434       residual = 2.09e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         27 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.5000e-01 is 3.351850e-03

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.240165 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.6434e+01
  </log>
  <optVariables href="H2O.s006.opt.xml">
 uu_0                 2.614694e-01 1 1  ON 0
 uu_1                 1.096236e-01 1 1  ON 1
 uu_2                 2.266515e-02 1 1  ON 2
 uu_3                -2.812499e-02 1 1  ON 3
 uu_4                -6.229176e-02 1 1  ON 4
 uu_5                -8.575172e-02 1 1  ON 5
 uu_6                -1.036169e-01 1 1  ON 6
 uu_7                -1.123833e-01 1 1  ON 7
 uu_8                -1.013385e-01 1 1  ON 8
 uu_9                -6.830165e-02 1 1  ON 9
 ud_0                 3.565840e-01 1 1  ON 10
 ud_1                 1.310974e-01 1 1  ON 11
 ud_2                 3.116202e-02 1 1  ON 12
 ud_3                -2.383146e-02 1 1  ON 13
 ud_4                -6.462834e-02 1 1  ON 14
 ud_5                -9.332892e-02 1 1  ON 15
 ud_6                -1.097206e-01 1 1  ON 16
 ud_7                -1.154904e-01 1 1  ON 17
 ud_8                -1.054370e-01 1 1  ON 18
 ud_9                -7.616613e-02 1 1  ON 19
 eO_0                -5.970169e-01 1 1  ON 20
 eO_1                -3.317966e-01 1 1  ON 21
 eO_2                 2.819429e-02 1 1  ON 22
 eO_3                 2.762640e-01 1 1  ON 23
 eO_4                 4.007473e-01 1 1  ON 24
 eO_5                 3.440098e-01 1 1  ON 25
 eO_6                 1.546577e-01 1 1  ON 26
 eO_7                -5.344165e-02 1 1  ON 27
 eO_8                -1.643017e-01 1 1  ON 28
 eO_9                -6.207809e-02 1 1  ON 29
eH1_0                -2.289355e-01 1 1  ON 30
eH1_1                -1.114053e-01 1 1  ON 31
eH1_2                -6.129474e-02 1 1  ON 32
eH1_3                -2.324006e-02 1 1  ON 33
eH1_4                 4.000458e-03 1 1  ON 34
eH1_5                 2.076678e-02 1 1  ON 35
eH1_6                 6.796162e-02 1 1  ON 36
eH1_7                 1.214574e-01 1 1  ON 37
eH1_8                 1.530843e-01 1 1  ON 38
eH1_9                 6.120543e-02 1 1  ON 39
eH2_0                -2.244929e-01 1 1  ON 40
eH2_1                -1.100823e-01 1 1  ON 41
eH2_2                -6.055962e-02 1 1  ON 42
eH2_3                -2.351039e-02 1 1  ON 43
eH2_4                 4.700465e-03 1 1  ON 44
eH2_5                 2.719462e-02 1 1  ON 45
eH2_6                 7.371420e-02 1 1  ON 46
eH2_7                 1.292474e-01 1 1  ON 47
eH2_8                 1.550507e-01 1 1  ON 48
eH2_9                 4.675318e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 6
    time step          = 0.05
    reference energy   = -16.8214
    reference variance = 0.304819
====================================================
  Execution time = 2.2328e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s006
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6899e+01
  VMC Evar = 2.9628e-01
  Total weights = 2.0000e+06
  Execution time = 1.8837e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.296470659018
                                         uncertainty =       0.002970136350

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.296470659018
                                         uncertainty =       0.002970136350

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000384976528
  error estimate for blocks of size 2^( 2) =       0.000401919885
  error estimate for blocks of size 2^( 3) =       0.000419361067
  error estimate for blocks of size 2^( 4) =       0.000434463346
  error estimate for blocks of size 2^( 5) =       0.000447281209
  error estimate for blocks of size 2^( 6) =       0.000457938961
  error estimate for blocks of size 2^( 7) =       0.000462823660

      target function =      -0.918137629737
              le_mean =     -16.899401331301
             les_mean =     285.886179062680
             stat err =       0.000450626794
             autocorr =       1.370141808694
   target nu stat err =       0.000450626794
   target dn stat err =       0.002984629005
      target stat err =       0.004582588341
              std dev =       0.544439027371
             le_variance =       0.296413854524

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.296298595488
                                         uncertainty =       0.002956668453

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.296298595488
                                         uncertainty =       0.002956668453

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000384865923
  error estimate for blocks of size 2^( 2) =       0.000402183552
  error estimate for blocks of size 2^( 3) =       0.000420042535
  error estimate for blocks of size 2^( 4) =       0.000435589219
  error estimate for blocks of size 2^( 5) =       0.000448724046
  error estimate for blocks of size 2^( 6) =       0.000459592898
  error estimate for blocks of size 2^( 7) =       0.000464566667

      target function =      -0.918396881575
              le_mean =     -16.899429800388
             les_mean =     285.886970987020
             stat err =       0.000452118208
             autocorr =       1.380019033716
   target nu stat err =       0.000452118208
   target dn stat err =       0.002975135503
      target stat err =       0.004571576996
              std dev =       0.544282607558
             le_variance =       0.296243556890

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.296492872002
                                         uncertainty =       0.002952122639

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.296492872002
                                         uncertainty =       0.002952122639

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000384992198
  error estimate for blocks of size 2^( 2) =       0.000402394520
  error estimate for blocks of size 2^( 3) =       0.000420308783
  error estimate for blocks of size 2^( 4) =       0.000435888674
  error estimate for blocks of size 2^( 5) =       0.000449046578
  error estimate for blocks of size 2^( 6) =       0.000459926958
  error estimate for blocks of size 2^( 7) =       0.000464931519

      target function =      -0.918101975754
              le_mean =     -16.899421266708
             les_mean =     285.886876986522
             stat err =       0.000452448432
             autocorr =       1.381129234874
   target nu stat err =       0.000452448432
   target dn stat err =       0.002972439319
      target stat err =       0.004564669582
              std dev =       0.544461187849
             le_variance =       0.296437985074

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.296389013220
                                         uncertainty =       0.002965930005

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.296389013220
                                         uncertainty =       0.002965930005

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000384923740
  error estimate for blocks of size 2^( 2) =       0.000401945279
  error estimate for blocks of size 2^( 3) =       0.000419461376
  error estimate for blocks of size 2^( 4) =       0.000434637464
  error estimate for blocks of size 2^( 5) =       0.000447506061
  error estimate for blocks of size 2^( 6) =       0.000458197977
  error estimate for blocks of size 2^( 7) =       0.000463103825

      target function =      -0.918259587262
              le_mean =     -16.899366803093
             les_mean =     285.884930768216
             stat err =       0.000450861332
             autocorr =       1.371944634751
   target nu stat err =       0.000450861332
   target dn stat err =       0.002981708673
      target stat err =       0.004579201395
              std dev =       0.544364373278
             le_variance =       0.296332570895


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.918137629737        initial
     1.5625e-02     1.5625e-01             3.4869e-02        -0.918396881575  <--
     6.2500e-02     6.2500e-01             1.2092e-02        -0.918101975754
     2.5000e-01     2.5000e+00             3.3518e-03        -0.918259587262

*****************************************************************************
Applying the update for shift_i =   1.5625e-02     and shift_s =   1.5625e-01
*****************************************************************************

  Execution time = 3.1817e+01
  </log>
  <optVariables href="H2O.s006.opt.xml">
 uu_0                 2.614784e-01 1 1  ON 0
 uu_1                 1.097171e-01 1 1  ON 1
 uu_2                 2.254902e-02 1 1  ON 2
 uu_3                -2.848156e-02 1 1  ON 3
 uu_4                -6.289611e-02 1 1  ON 4
 uu_5                -8.616180e-02 1 1  ON 5
 uu_6                -1.037699e-01 1 1  ON 6
 uu_7                -1.126091e-01 1 1  ON 7
 uu_8                -1.017434e-01 1 1  ON 8
 uu_9                -6.979835e-02 1 1  ON 9
 ud_0                 3.531669e-01 1 1  ON 10
 ud_1                 1.282575e-01 1 1  ON 11
 ud_2                 2.906867e-02 1 1  ON 12
 ud_3                -2.526151e-02 1 1  ON 13
 ud_4                -6.498103e-02 1 1  ON 14
 ud_5                -9.296140e-02 1 1  ON 15
 ud_6                -1.084556e-01 1 1  ON 16
 ud_7                -1.132118e-01 1 1  ON 17
 ud_8                -1.023453e-01 1 1  ON 18
 ud_9                -7.264201e-02 1 1  ON 19
 eO_0                -5.802500e-01 1 1  ON 20
 eO_1                -3.161835e-01 1 1  ON 21
 eO_2                 4.224288e-02 1 1  ON 22
 eO_3                 2.865888e-01 1 1  ON 23
 eO_4                 3.990282e-01 1 1  ON 24
 eO_5                 3.290429e-01 1 1  ON 25
 eO_6                 1.318806e-01 1 1  ON 26
 eO_7                -7.366446e-02 1 1  ON 27
 eO_8                -1.614819e-01 1 1  ON 28
 eO_9                -6.260246e-02 1 1  ON 29
eH1_0                -2.246048e-01 1 1  ON 30
eH1_1                -1.061123e-01 1 1  ON 31
eH1_2                -5.696325e-02 1 1  ON 32
eH1_3                -1.925613e-02 1 1  ON 33
eH1_4                 6.238978e-03 1 1  ON 34
eH1_5                 1.916016e-02 1 1  ON 35
eH1_6                 6.186012e-02 1 1  ON 36
eH1_7                 1.115032e-01 1 1  ON 37
eH1_8                 1.451800e-01 1 1  ON 38
eH1_9                 6.501855e-02 1 1  ON 39
eH2_0                -2.279786e-01 1 1  ON 40
eH2_1                -1.143692e-01 1 1  ON 41
eH2_2                -6.509641e-02 1 1  ON 42
eH2_3                -2.780261e-02 1 1  ON 43
eH2_4                 1.791528e-03 1 1  ON 44
eH2_5                 3.011648e-02 1 1  ON 45
eH2_6                 7.876955e-02 1 1  ON 46
eH2_7                 1.323235e-01 1 1  ON 47
eH2_8                 1.559099e-01 1 1  ON 48
eH2_9                 5.315475e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.8257e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s007 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s007 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=7  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6888e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 7
    time step          = 0.05
    reference energy   = -16.8317
    reference variance = 0.5022
====================================================
  Execution time = 2.0931e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s007
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6898e+01
  VMC Evar = 2.9623e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.6514e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.296198449995
                                         uncertainty =       0.002792917727

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.296198449995
                                         uncertainty =       0.002792917727

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000384859328
  error estimate for blocks of size 2^( 2) =       0.000402399825
  error estimate for blocks of size 2^( 3) =       0.000420513926
  error estimate for blocks of size 2^( 4) =       0.000437219654
  error estimate for blocks of size 2^( 5) =       0.000450001855
  error estimate for blocks of size 2^( 6) =       0.000460193423
  error estimate for blocks of size 2^( 7) =       0.000463918658

      target function =      -0.918366613041
              le_mean =     -16.898136265113
             les_mean =     285.843242491151
             stat err =       0.000452833397
             autocorr =       1.384435937478
   target nu stat err =       0.000452833397
   target dn stat err =       0.002736196461
      target stat err =       0.004204767058
              std dev =       0.544273281489
             le_variance =       0.296233404943


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.689813626511e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 3.9062e-03, overlap shift 3.9062e-02 and omega -1.7456e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.918384441102       residual = 2.74e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.918603369669       residual = 2.99e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.918825158102       residual = 1.40e-03           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.918933384621       residual = 1.58e-03           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.919105001338       residual = 9.21e-04           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.919202271832       residual = 4.63e-04           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.919257820452       residual = 6.89e-04           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.919350977697       residual = 7.12e-04           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.919405771813       residual = 2.11e-04           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.919455044542       residual = 2.27e-04           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.919529895150       residual = 1.53e-04           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.919585377009       residual = 9.10e-05           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.919608357716       residual = 1.01e-04           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.919651606899       residual = 6.32e-05           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.919675719061       residual = 4.71e-05           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.919699947430       residual = 3.51e-05           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.919725704168       residual = 4.21e-05           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.919749959152       residual = 2.44e-05           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.919761750772       residual = 1.37e-05           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.919767981431       residual = 1.68e-05           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.919777962416       residual = 1.13e-05           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.919783479835       residual = 3.72e-06           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.919785536970       residual = 7.22e-06           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.919798696692       residual = 5.97e-06           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.919803965666       residual = 5.05e-06           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =      -0.919813147301       residual = 3.45e-06           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   tar_fn =      -0.919829718569       residual = 4.85e-06           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   tar_fn =      -0.919848351724       residual = 2.84e-06           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   tar_fn =      -0.919861858630       residual = 1.33e-06           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   tar_fn =      -0.919864379737       residual = 8.57e-07           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   tar_fn =      -0.919867082496       residual = 8.25e-07           smallest_sin_value = 1.00e+00
davidson iteration   31:   krylov dim =  32   tar_fn =      -0.919874943818       residual = 8.56e-07           smallest_sin_value = 1.00e+00
davidson iteration   32:   krylov dim =  33   tar_fn =      -0.919878185494       residual = 3.57e-07           smallest_sin_value = 1.00e+00
davidson iteration   33:   krylov dim =  34   tar_fn =      -0.919882455088       residual = 1.33e-07           smallest_sin_value = 1.00e+00
davidson iteration   34:   krylov dim =  35   tar_fn =      -0.919884241041       residual = 8.42e-08           smallest_sin_value = 1.00e+00
davidson iteration   35:   krylov dim =  36   tar_fn =      -0.919884014803       residual = 1.84e-08           smallest_sin_value = 1.00e+00
davidson iteration   36:   krylov dim =  37   tar_fn =      -0.919885159708       residual = 1.30e-08           smallest_sin_value = 1.00e+00
davidson iteration   37:   krylov dim =  38   tar_fn =      -0.919884859624       residual = 8.36e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         37 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.9062e-03 is 1.202032e-01

solving harmonic davidson linear method for identity shift 1.5625e-02, overlap shift 1.5625e-01 and omega -1.7456e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.918384441102       residual = 2.74e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.918573178040       residual = 2.90e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.918757365889       residual = 1.29e-03           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.918845703716       residual = 1.46e-03           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.918977754597       residual = 8.28e-04           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.919052484233       residual = 3.79e-04           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.919097622023       residual = 5.64e-04           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.919165739399       residual = 5.99e-04           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.919197856223       residual = 1.67e-04           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.919232007449       residual = 1.84e-04           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.919283783989       residual = 1.18e-04           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.919318753861       residual = 6.74e-05           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.919333057559       residual = 6.96e-05           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.919360994847       residual = 4.65e-05           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.919375395318       residual = 3.36e-05           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.919389662673       residual = 2.42e-05           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.919405917825       residual = 2.40e-05           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.919417943887       residual = 1.34e-05           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.919424141090       residual = 7.71e-06           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.919427011534       residual = 8.61e-06           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.919431789342       residual = 7.12e-06           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.919433150973       residual = 1.97e-06           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.919434791156       residual = 5.06e-06           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.919440998540       residual = 3.90e-06           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.919442297302       residual = 1.59e-06           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =      -0.919445278309       residual = 1.13e-06           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   tar_fn =      -0.919450106663       residual = 1.17e-06           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   tar_fn =      -0.919455009528       residual = 3.86e-07           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   tar_fn =      -0.919455778037       residual = 1.70e-07           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   tar_fn =      -0.919456166003       residual = 9.44e-08           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   tar_fn =      -0.919455776131       residual = 6.16e-08           smallest_sin_value = 1.00e+00
davidson iteration   31:   krylov dim =  32   tar_fn =      -0.919457189208       residual = 3.72e-08           smallest_sin_value = 1.00e+00
davidson iteration   32:   krylov dim =  33   tar_fn =      -0.919457151516       residual = 2.60e-08           smallest_sin_value = 1.00e+00
davidson iteration   33:   krylov dim =  34   tar_fn =      -0.919457528625       residual = 7.18e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         33 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.5625e-02 is 2.187474e-02

solving harmonic davidson linear method for identity shift 6.2500e-02, overlap shift 6.2500e-01 and omega -1.7456e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.918384441102       residual = 2.74e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.918506074408       residual = 2.71e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.918615792136       residual = 1.07e-03           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.918667637423       residual = 1.25e-03           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.918735461417       residual = 6.88e-04           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.918774319552       residual = 2.70e-04           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.918800698010       residual = 3.67e-04           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.918837924886       residual = 1.55e-04           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.918843303564       residual = 1.84e-04           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.918857930704       residual = 1.41e-04           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.918880177761       residual = 6.85e-05           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.918892302834       residual = 3.90e-05           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.918897896682       residual = 3.74e-05           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.918909481712       residual = 2.84e-05           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.918914203066       residual = 1.76e-05           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.918918809252       residual = 1.09e-05           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.918924198753       residual = 7.67e-06           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.918927175541       residual = 4.88e-06           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.918928889329       residual = 2.83e-06           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.918929144335       residual = 2.39e-06           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.918930350703       residual = 3.32e-06           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.918930138091       residual = 7.31e-07           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.918931303950       residual = 1.71e-06           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.918932129934       residual = 1.18e-06           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.918932330776       residual = 3.26e-07           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =      -0.918932429748       residual = 1.60e-07           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   tar_fn =      -0.918933027291       residual = 1.41e-07           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   tar_fn =      -0.918933648197       residual = 2.69e-08           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   tar_fn =      -0.918933546299       residual = 8.12e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         28 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 6.2500e-02 is 9.206221e-03

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.286963 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.6635e+01
  </log>
  <optVariables href="H2O.s007.opt.xml">
 uu_0                 2.429843e-01 1 1  ON 0
 uu_1                 9.122677e-02 1 1  ON 1
 uu_2                 6.232075e-03 1 1  ON 2
 uu_3                -4.159202e-02 1 1  ON 3
 uu_4                -6.962332e-02 1 1  ON 4
 uu_5                -8.700556e-02 1 1  ON 5
 uu_6                -9.818029e-02 1 1  ON 6
 uu_7                -1.011492e-01 1 1  ON 7
 uu_8                -9.025487e-02 1 1  ON 8
 uu_9                -5.619213e-02 1 1  ON 9
 ud_0                 3.469051e-01 1 1  ON 10
 ud_1                 1.197784e-01 1 1  ON 11
 ud_2                 1.953305e-02 1 1  ON 12
 ud_3                -3.635914e-02 1 1  ON 13
 ud_4                -7.712463e-02 1 1  ON 14
 ud_5                -1.023752e-01 1 1  ON 15
 ud_6                -1.162525e-01 1 1  ON 16
 ud_7                -1.152883e-01 1 1  ON 17
 ud_8                -9.638025e-02 1 1  ON 18
 ud_9                -5.076727e-02 1 1  ON 19
 eO_0                -5.745871e-01 1 1  ON 20
 eO_1                -3.090503e-01 1 1  ON 21
 eO_2                 4.620522e-02 1 1  ON 22
 eO_3                 2.850785e-01 1 1  ON 23
 eO_4                 3.931481e-01 1 1  ON 24
 eO_5                 3.194125e-01 1 1  ON 25
 eO_6                 1.152378e-01 1 1  ON 26
 eO_7                -8.580692e-02 1 1  ON 27
 eO_8                -1.411289e-01 1 1  ON 28
 eO_9                -5.474568e-02 1 1  ON 29
eH1_0                -2.370429e-01 1 1  ON 30
eH1_1                -1.203272e-01 1 1  ON 31
eH1_2                -6.997922e-02 1 1  ON 32
eH1_3                -3.216257e-02 1 1  ON 33
eH1_4                -8.670021e-04 1 1  ON 34
eH1_5                 2.082863e-02 1 1  ON 35
eH1_6                 7.125503e-02 1 1  ON 36
eH1_7                 1.284743e-01 1 1  ON 37
eH1_8                 1.591151e-01 1 1  ON 38
eH1_9                 8.241762e-02 1 1  ON 39
eH2_0                -2.311289e-01 1 1  ON 40
eH2_1                -1.125991e-01 1 1  ON 41
eH2_2                -6.391651e-02 1 1  ON 42
eH2_3                -2.883925e-02 1 1  ON 43
eH2_4                -1.591072e-03 1 1  ON 44
eH2_5                 1.554173e-02 1 1  ON 45
eH2_6                 6.959340e-02 1 1  ON 46
eH2_7                 1.345210e-01 1 1  ON 47
eH2_8                 1.659312e-01 1 1  ON 48
eH2_9                 6.747326e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 7
    time step          = 0.05
    reference energy   = -16.9534
    reference variance = 0.153536
====================================================
  Execution time = 2.0992e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s007
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6898e+01
  VMC Evar = 2.9648e-01
  Total weights = 2.0000e+06
  Execution time = 1.8847e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.296129383877
                                         uncertainty =       0.003466171234

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.296129383877
                                         uncertainty =       0.003466171234

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000384784349
  error estimate for blocks of size 2^( 2) =       0.000401132972
  error estimate for blocks of size 2^( 3) =       0.000417171700
  error estimate for blocks of size 2^( 4) =       0.000431006802
  error estimate for blocks of size 2^( 5) =       0.000441265136
  error estimate for blocks of size 2^( 6) =       0.000447216622
  error estimate for blocks of size 2^( 7) =       0.000450988532

      target function =      -0.918540426875
              le_mean =     -16.898295546530
             les_mean =     285.848510220947
             stat err =       0.000442619273
             autocorr =       1.323201067397
   target nu stat err =       0.000442619273
   target dn stat err =       0.003195416654
      target stat err =       0.004890542346
              std dev =       0.544167245543
             le_variance =       0.296117991122

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.301627632566
                                         uncertainty =       0.003523181656

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.301627632566
                                         uncertainty =       0.003523181656

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000388342120
  error estimate for blocks of size 2^( 2) =       0.000406757309
  error estimate for blocks of size 2^( 3) =       0.000425735344
  error estimate for blocks of size 2^( 4) =       0.000442629206
  error estimate for blocks of size 2^( 5) =       0.000455336843
  error estimate for blocks of size 2^( 6) =       0.000463165744
  error estimate for blocks of size 2^( 7) =       0.000467463612

      target function =      -0.910322144099
              le_mean =     -16.899761988404
             les_mean =     285.903574318449
             stat err =       0.000457148851
             autocorr =       1.385754414687
   target nu stat err =       0.000457148851
   target dn stat err =       0.003250502760
      target stat err =       0.004901816576
              std dev =       0.549198693151
             le_variance =       0.301619204559

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.298452292119
                                         uncertainty =       0.003502347679

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.298452292119
                                         uncertainty =       0.003502347679

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000386292289
  error estimate for blocks of size 2^( 2) =       0.000403589743
  error estimate for blocks of size 2^( 3) =       0.000421041236
  error estimate for blocks of size 2^( 4) =       0.000436248658
  error estimate for blocks of size 2^( 5) =       0.000447529886
  error estimate for blocks of size 2^( 6) =       0.000454312298
  error estimate for blocks of size 2^( 7) =       0.000458240066

      target function =      -0.915034255622
              le_mean =     -16.898297201741
             les_mean =     285.850891633940
             stat err =       0.000449082727
             autocorr =       1.351514237027
   target nu stat err =       0.000449082727
   target dn stat err =       0.003228830976
      target stat err =       0.004904915225
              std dev =       0.546299793869
             le_variance =       0.298443464782

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.296002847722
                                         uncertainty =       0.003465566772

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.296002847722
                                         uncertainty =       0.003465566772

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000384702636
  error estimate for blocks of size 2^( 2) =       0.000401087903
  error estimate for blocks of size 2^( 3) =       0.000417222963
  error estimate for blocks of size 2^( 4) =       0.000431129763
  error estimate for blocks of size 2^( 5) =       0.000441416139
  error estimate for blocks of size 2^( 6) =       0.000447426213
  error estimate for blocks of size 2^( 7) =       0.000451169025

      target function =      -0.918717683016
              le_mean =     -16.897973222607
             les_mean =     285.837491119962
             stat err =       0.000442785285
             autocorr =       1.324756427900
   target nu stat err =       0.000442785285
   target dn stat err =       0.003194124372
      target stat err =       0.004887689311
              std dev =       0.544051685064
             le_variance =       0.295992236021


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.918540426875        initial
     3.9062e-03     3.9062e-02             1.2020e-01        -0.910322144099
     1.5625e-02     1.5625e-01             2.1875e-02        -0.915034255622
     6.2500e-02     6.2500e-01             9.2062e-03        -0.918717683016  <--

*****************************************************************************
Applying the update for shift_i =   6.2500e-02     and shift_s =   6.2500e-01
*****************************************************************************

  Execution time = 3.0492e+01
  </log>
  <optVariables href="H2O.s007.opt.xml">
 uu_0                 2.545032e-01 1 1  ON 0
 uu_1                 1.026844e-01 1 1  ON 1
 uu_2                 1.655281e-02 1 1  ON 2
 uu_3                -3.302366e-02 1 1  ON 3
 uu_4                -6.445214e-02 1 1  ON 4
 uu_5                -8.522576e-02 1 1  ON 5
 uu_6                -1.002226e-01 1 1  ON 6
 uu_7                -1.068529e-01 1 1  ON 7
 uu_8                -9.680320e-02 1 1  ON 8
 uu_9                -6.462397e-02 1 1  ON 9
 ud_0                 3.523701e-01 1 1  ON 10
 ud_1                 1.262419e-01 1 1  ON 11
 ud_2                 2.646757e-02 1 1  ON 12
 ud_3                -2.875293e-02 1 1  ON 13
 ud_4                -6.916197e-02 1 1  ON 14
 ud_5                -9.595935e-02 1 1  ON 15
 ud_6                -1.110814e-01 1 1  ON 16
 ud_7                -1.134738e-01 1 1  ON 17
 ud_8                -9.929616e-02 1 1  ON 18
 ud_9                -6.343579e-02 1 1  ON 19
 eO_0                -5.784775e-01 1 1  ON 20
 eO_1                -3.133628e-01 1 1  ON 21
 eO_2                 4.397083e-02 1 1  ON 22
 eO_3                 2.864736e-01 1 1  ON 23
 eO_4                 3.973828e-01 1 1  ON 24
 eO_5                 3.261327e-01 1 1  ON 25
 eO_6                 1.262323e-01 1 1  ON 26
 eO_7                -7.690503e-02 1 1  ON 27
 eO_8                -1.558406e-01 1 1  ON 28
 eO_9                -6.112819e-02 1 1  ON 29
eH1_0                -2.275959e-01 1 1  ON 30
eH1_1                -1.101541e-01 1 1  ON 31
eH1_2                -6.032970e-02 1 1  ON 32
eH1_3                -2.257834e-02 1 1  ON 33
eH1_4                 5.338536e-03 1 1  ON 34
eH1_5                 2.074339e-02 1 1  ON 35
eH1_6                 6.483501e-02 1 1  ON 36
eH1_7                 1.156672e-01 1 1  ON 37
eH1_8                 1.471154e-01 1 1  ON 38
eH1_9                 6.894479e-02 1 1  ON 39
eH2_0                -2.291552e-01 1 1  ON 40
eH2_1                -1.127635e-01 1 1  ON 41
eH2_2                -6.366945e-02 1 1  ON 42
eH2_3                -2.732770e-02 1 1  ON 43
eH2_4                 1.509113e-03 1 1  ON 44
eH2_5                 2.466602e-02 1 1  ON 45
eH2_6                 7.579435e-02 1 1  ON 46
eH2_7                 1.327557e-01 1 1  ON 47
eH2_8                 1.583163e-01 1 1  ON 48
eH2_9                 5.637726e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.7133e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s008 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s008 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=8  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6889e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 8
    time step          = 0.05
    reference energy   = -16.9928
    reference variance = 0.481743
====================================================
  Execution time = 2.1075e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s008
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6898e+01
  VMC Evar = 2.8961e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.5736e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.289612315175
                                         uncertainty =       0.002472353753

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.289612315175
                                         uncertainty =       0.002472353753

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000380531023
  error estimate for blocks of size 2^( 2) =       0.000397923671
  error estimate for blocks of size 2^( 3) =       0.000415373825
  error estimate for blocks of size 2^( 4) =       0.000430746231
  error estimate for blocks of size 2^( 5) =       0.000441775525
  error estimate for blocks of size 2^( 6) =       0.000448449249
  error estimate for blocks of size 2^( 7) =       0.000450665449

      target function =      -0.928514530342
              le_mean =     -16.898451432680
             les_mean =     285.847268396245
             stat err =       0.000442909114
             autocorr =       1.354718610688
   target nu stat err =       0.000442909114
   target dn stat err =       0.002823582590
      target stat err =       0.004429527672
              std dev =       0.538152133145
             le_variance =       0.289607718409


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.689845143268e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.5625e-02, overlap shift 1.5625e-01 and omega -1.7456e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.928534149173       residual = 1.65e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.928621203803       residual = 1.28e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.928698258631       residual = 3.59e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.928758355994       residual = 3.34e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.928780562268       residual = 2.71e-04           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.928792807796       residual = 1.91e-04           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.928805379303       residual = 1.31e-04           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.928812999538       residual = 1.71e-04           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.928832286713       residual = 4.82e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.928836819169       residual = 3.23e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.928843707483       residual = 3.66e-05           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.928859851687       residual = 3.56e-05           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.928861231390       residual = 1.84e-05           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.928868142420       residual = 4.48e-06           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.928868560228       residual = 5.81e-06           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.928871467823       residual = 4.69e-06           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.928872623864       residual = 7.42e-06           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.928877107649       residual = 4.36e-06           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.928877415904       residual = 9.85e-07           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.928878182981       residual = 1.73e-06           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.928880847342       residual = 1.73e-06           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.928881252725       residual = 1.23e-06           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.928880035063       residual = 1.08e-06           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.928881697443       residual = 6.67e-07           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.928884672016       residual = 6.94e-07           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =      -0.928887326869       residual = 3.25e-07           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   tar_fn =      -0.928886750813       residual = 2.67e-07           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   tar_fn =      -0.928887444449       residual = 1.42e-07           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   tar_fn =      -0.928887886142       residual = 7.23e-08           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   tar_fn =      -0.928887959317       residual = 3.89e-08           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   tar_fn =      -0.928888337432       residual = 1.48e-08           smallest_sin_value = 1.00e+00
davidson iteration   31:   krylov dim =  32   tar_fn =      -0.928888378274       residual = 1.19e-08           smallest_sin_value = 1.00e+00
davidson iteration   32:   krylov dim =  33   tar_fn =      -0.928888001567       residual = 2.33e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         32 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.5625e-02 is 1.627354e-02

solving harmonic davidson linear method for identity shift 6.2500e-02, overlap shift 6.2500e-01 and omega -1.7456e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.928534149173       residual = 1.65e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.928592064771       residual = 1.20e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.928638950080       residual = 2.91e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.928667349380       residual = 3.16e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.928679364745       residual = 1.60e-04           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.928684972462       residual = 1.25e-04           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.928690676909       residual = 9.02e-05           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.928693644910       residual = 9.90e-05           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.928702048733       residual = 3.17e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.928702897005       residual = 2.11e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.928705998055       residual = 2.47e-05           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.928711740439       residual = 2.48e-05           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.928712174701       residual = 7.79e-06           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.928714501733       residual = 2.54e-06           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.928714595276       residual = 2.80e-06           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.928715687501       residual = 2.60e-06           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.928716135766       residual = 3.65e-06           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.928717260287       residual = 1.77e-06           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.928717041035       residual = 4.76e-07           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.928717654813       residual = 5.82e-07           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.928718521293       residual = 8.88e-07           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.928718285194       residual = 2.30e-07           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.928718044763       residual = 3.48e-07           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.928718531265       residual = 1.51e-07           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.928719254012       residual = 1.23e-07           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =      -0.928719586081       residual = 3.48e-08           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   tar_fn =      -0.928719244730       residual = 2.61e-08           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   tar_fn =      -0.928719275065       residual = 7.71e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         27 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 6.2500e-02 is 4.983659e-03

solving harmonic davidson linear method for identity shift 2.5000e-01, overlap shift 2.5000e+00 and omega -1.7456e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.928534149173       residual = 1.65e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.928558910602       residual = 1.12e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.928577084129       residual = 2.34e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.928585459942       residual = 3.02e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.928590195753       residual = 1.02e-04           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.928591845202       residual = 8.53e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.928593656667       residual = 6.74e-05           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.928594427471       residual = 6.55e-05           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.928596931967       residual = 2.29e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.928596879697       residual = 1.55e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.928597809092       residual = 1.87e-05           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.928599134532       residual = 1.50e-05           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.928599185494       residual = 3.89e-06           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.928599852237       residual = 1.68e-06           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.928599903245       residual = 1.62e-06           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.928600195388       residual = 1.44e-06           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.928600387892       residual = 1.71e-06           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.928600575129       residual = 8.17e-07           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.928600459690       residual = 2.56e-07           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.928600699290       residual = 2.64e-07           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.928600836358       residual = 3.23e-07           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.928600728776       residual = 6.23e-08           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.928600722487       residual = 8.93e-08           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.928600825575       residual = 4.86e-08           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.928600933043       residual = 2.83e-08           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =      -0.928600953678       residual = 5.15e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         25 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.5000e-01 is 1.734303e-03

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.317736 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.6685e+01
  </log>
  <optVariables href="H2O.s008.opt.xml">
 uu_0                 2.521753e-01 1 1  ON 0
 uu_1                 1.011624e-01 1 1  ON 1
 uu_2                 1.547026e-02 1 1  ON 2
 uu_3                -3.393938e-02 1 1  ON 3
 uu_4                -6.535124e-02 1 1  ON 4
 uu_5                -8.541618e-02 1 1  ON 5
 uu_6                -9.913514e-02 1 1  ON 6
 uu_7                -1.056305e-01 1 1  ON 7
 uu_8                -9.430515e-02 1 1  ON 8
 uu_9                -6.289109e-02 1 1  ON 9
 ud_0                 3.518603e-01 1 1  ON 10
 ud_1                 1.253384e-01 1 1  ON 11
 ud_2                 2.509531e-02 1 1  ON 12
 ud_3                -3.014074e-02 1 1  ON 13
 ud_4                -7.041299e-02 1 1  ON 14
 ud_5                -9.573323e-02 1 1  ON 15
 ud_6                -1.099853e-01 1 1  ON 16
 ud_7                -1.117484e-01 1 1  ON 17
 ud_8                -9.839594e-02 1 1  ON 18
 ud_9                -6.262191e-02 1 1  ON 19
 eO_0                -5.776966e-01 1 1  ON 20
 eO_1                -3.118372e-01 1 1  ON 21
 eO_2                 4.453390e-02 1 1  ON 22
 eO_3                 2.840289e-01 1 1  ON 23
 eO_4                 3.953202e-01 1 1  ON 24
 eO_5                 3.263726e-01 1 1  ON 25
 eO_6                 1.270827e-01 1 1  ON 26
 eO_7                -7.613452e-02 1 1  ON 27
 eO_8                -1.558967e-01 1 1  ON 28
 eO_9                -6.149540e-02 1 1  ON 29
eH1_0                -2.291980e-01 1 1  ON 30
eH1_1                -1.119128e-01 1 1  ON 31
eH1_2                -6.169946e-02 1 1  ON 32
eH1_3                -2.464047e-02 1 1  ON 33
eH1_4                 5.903925e-03 1 1  ON 34
eH1_5                 2.572705e-02 1 1  ON 35
eH1_6                 6.587334e-02 1 1  ON 36
eH1_7                 1.144596e-01 1 1  ON 37
eH1_8                 1.450156e-01 1 1  ON 38
eH1_9                 7.201157e-02 1 1  ON 39
eH2_0                -2.298218e-01 1 1  ON 40
eH2_1                -1.137947e-01 1 1  ON 41
eH2_2                -6.445113e-02 1 1  ON 42
eH2_3                -2.762337e-02 1 1  ON 43
eH2_4                 1.875786e-03 1 1  ON 44
eH2_5                 2.590392e-02 1 1  ON 45
eH2_6                 7.406346e-02 1 1  ON 46
eH2_7                 1.296266e-01 1 1  ON 47
eH2_8                 1.608197e-01 1 1  ON 48
eH2_9                 6.024648e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 8
    time step          = 0.05
    reference energy   = -16.9034
    reference variance = 0.148029
====================================================
  Execution time = 2.0639e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s008
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6898e+01
  VMC Evar = 2.9151e-01
  Total weights = 2.0000e+06
  Execution time = 1.8869e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.291697773748
                                         uncertainty =       0.002560867867

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.291697773748
                                         uncertainty =       0.002560867867

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000381880645
  error estimate for blocks of size 2^( 2) =       0.000399272540
  error estimate for blocks of size 2^( 3) =       0.000416765036
  error estimate for blocks of size 2^( 4) =       0.000431848036
  error estimate for blocks of size 2^( 5) =       0.000443839088
  error estimate for blocks of size 2^( 6) =       0.000450952720
  error estimate for blocks of size 2^( 7) =       0.000453466857

      target function =      -0.925301550507
              le_mean =     -16.897639795541
             les_mean =     285.821896168806
             stat err =       0.000445026675
             autocorr =       1.358053225770
   target nu stat err =       0.000445026675
   target dn stat err =       0.002606750504
      target stat err =       0.004066030618
              std dev =       0.540060788058
             le_variance =       0.291665654798

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.291610190216
                                         uncertainty =       0.002547455078

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.291610190216
                                         uncertainty =       0.002547455078

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000381823024
  error estimate for blocks of size 2^( 2) =       0.000399269740
  error estimate for blocks of size 2^( 3) =       0.000416889953
  error estimate for blocks of size 2^( 4) =       0.000432125136
  error estimate for blocks of size 2^( 5) =       0.000444311728
  error estimate for blocks of size 2^( 6) =       0.000451455050
  error estimate for blocks of size 2^( 7) =       0.000453915968

      target function =      -0.925438998620
              le_mean =     -16.897681152490
             les_mean =     285.823205829420
             stat err =       0.000445451970
             autocorr =       1.361060849965
   target nu stat err =       0.000445451970
   target dn stat err =       0.002594605395
      target stat err =       0.004049322177
              std dev =       0.539979299612
             le_variance =       0.291577644009

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.291502772822
                                         uncertainty =       0.002547299662

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.291502772822
                                         uncertainty =       0.002547299662

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000381752705
  error estimate for blocks of size 2^( 2) =       0.000399146718
  error estimate for blocks of size 2^( 3) =       0.000416710039
  error estimate for blocks of size 2^( 4) =       0.000431896460
  error estimate for blocks of size 2^( 5) =       0.000444043589
  error estimate for blocks of size 2^( 6) =       0.000451175160
  error estimate for blocks of size 2^( 7) =       0.000453637407

      target function =      -0.925603037631
              le_mean =     -16.897667144822
             les_mean =     285.822625046532
             stat err =       0.000445188154
             autocorr =       1.359950039324
   target nu stat err =       0.000445188154
   target dn stat err =       0.002594718446
      target stat err =       0.004050723174
              std dev =       0.539879852435
             le_variance =       0.291470255065

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.291617823719
                                         uncertainty =       0.002558451123

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.291617823719
                                         uncertainty =       0.002558451123

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000381828252
  error estimate for blocks of size 2^( 2) =       0.000399208077
  error estimate for blocks of size 2^( 3) =       0.000416699539
  error estimate for blocks of size 2^( 4) =       0.000431788658
  error estimate for blocks of size 2^( 5) =       0.000443797660
  error estimate for blocks of size 2^( 6) =       0.000450908489
  error estimate for blocks of size 2^( 7) =       0.000453410553

      target function =      -0.925423661193
              le_mean =     -16.897627303063
             les_mean =     285.821393954870
             stat err =       0.000444976340
             autocorr =       1.358118675922
   target nu stat err =       0.000444976340
   target dn stat err =       0.002604662803
      target stat err =       0.004063829974
              std dev =       0.539986691899
             le_variance =       0.291585627427


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.925301550507        initial
     1.5625e-02     1.5625e-01             1.6274e-02        -0.925438998620
     6.2500e-02     6.2500e-01             4.9837e-03        -0.925603037631  <--
     2.5000e-01     2.5000e+00             1.7343e-03        -0.925423661193

*****************************************************************************
Applying the update for shift_i =   6.2500e-02     and shift_s =   6.2500e-01
*****************************************************************************

  Execution time = 3.0156e+01
  </log>
  <optVariables href="H2O.s008.opt.xml">
 uu_0                 2.521753e-01 1 1  ON 0
 uu_1                 1.011624e-01 1 1  ON 1
 uu_2                 1.547026e-02 1 1  ON 2
 uu_3                -3.393938e-02 1 1  ON 3
 uu_4                -6.535124e-02 1 1  ON 4
 uu_5                -8.541618e-02 1 1  ON 5
 uu_6                -9.913514e-02 1 1  ON 6
 uu_7                -1.056305e-01 1 1  ON 7
 uu_8                -9.430515e-02 1 1  ON 8
 uu_9                -6.289109e-02 1 1  ON 9
 ud_0                 3.518603e-01 1 1  ON 10
 ud_1                 1.253384e-01 1 1  ON 11
 ud_2                 2.509531e-02 1 1  ON 12
 ud_3                -3.014074e-02 1 1  ON 13
 ud_4                -7.041299e-02 1 1  ON 14
 ud_5                -9.573323e-02 1 1  ON 15
 ud_6                -1.099853e-01 1 1  ON 16
 ud_7                -1.117484e-01 1 1  ON 17
 ud_8                -9.839594e-02 1 1  ON 18
 ud_9                -6.262191e-02 1 1  ON 19
 eO_0                -5.776966e-01 1 1  ON 20
 eO_1                -3.118372e-01 1 1  ON 21
 eO_2                 4.453390e-02 1 1  ON 22
 eO_3                 2.840289e-01 1 1  ON 23
 eO_4                 3.953202e-01 1 1  ON 24
 eO_5                 3.263726e-01 1 1  ON 25
 eO_6                 1.270827e-01 1 1  ON 26
 eO_7                -7.613452e-02 1 1  ON 27
 eO_8                -1.558967e-01 1 1  ON 28
 eO_9                -6.149540e-02 1 1  ON 29
eH1_0                -2.291980e-01 1 1  ON 30
eH1_1                -1.119128e-01 1 1  ON 31
eH1_2                -6.169946e-02 1 1  ON 32
eH1_3                -2.464047e-02 1 1  ON 33
eH1_4                 5.903925e-03 1 1  ON 34
eH1_5                 2.572705e-02 1 1  ON 35
eH1_6                 6.587334e-02 1 1  ON 36
eH1_7                 1.144596e-01 1 1  ON 37
eH1_8                 1.450156e-01 1 1  ON 38
eH1_9                 7.201157e-02 1 1  ON 39
eH2_0                -2.298218e-01 1 1  ON 40
eH2_1                -1.137947e-01 1 1  ON 41
eH2_2                -6.445113e-02 1 1  ON 42
eH2_3                -2.762337e-02 1 1  ON 43
eH2_4                 1.875786e-03 1 1  ON 44
eH2_5                 2.590392e-02 1 1  ON 45
eH2_6                 7.406346e-02 1 1  ON 46
eH2_7                 1.296266e-01 1 1  ON 47
eH2_8                 1.608197e-01 1 1  ON 48
eH2_9                 6.024648e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.6847e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s009 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s009 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=9  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6895e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 9
    time step          = 0.05
    reference energy   = -16.9817
    reference variance = 0.299655
====================================================
  Execution time = 2.1282e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s009
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6898e+01
  VMC Evar = 3.0585e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.5696e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.305252187812
                                         uncertainty =       0.006326419248

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.305252187812
                                         uncertainty =       0.006326419248

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000391055710
  error estimate for blocks of size 2^( 2) =       0.000407496354
  error estimate for blocks of size 2^( 3) =       0.000424416701
  error estimate for blocks of size 2^( 4) =       0.000439328586
  error estimate for blocks of size 2^( 5) =       0.000450411418
  error estimate for blocks of size 2^( 6) =       0.000456151010
  error estimate for blocks of size 2^( 7) =       0.000458581114

      target function =      -0.903960780179
              le_mean =     -16.897840428776
             les_mean =     285.842860140307
             stat err =       0.000451118032
             autocorr =       1.330770332389
   target nu stat err =       0.000451118032
   target dn stat err =       0.006618833098
      target stat err =       0.009721767132
              std dev =       0.553036288913
             le_variance =       0.305849136855


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.689784042878e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.5625e-02, overlap shift 1.5625e-01 and omega -1.7456e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.904064278346       residual = 1.65e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.904183248159       residual = 1.09e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.904251454750       residual = 6.22e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.904286021361       residual = 3.10e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.904302140799       residual = 3.16e-04           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.904330056387       residual = 1.27e-04           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.904345258460       residual = 8.66e-05           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.904354981823       residual = 1.23e-04           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.904371990124       residual = 9.06e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.904378309344       residual = 5.01e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.904390279448       residual = 3.09e-05           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.904397530062       residual = 2.88e-05           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.904404387452       residual = 2.70e-05           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.904409292695       residual = 2.37e-05           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.904414906208       residual = 3.70e-05           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.904427466278       residual = 1.52e-05           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.904429253959       residual = 1.14e-05           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.904435437141       residual = 1.01e-05           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.904439762460       residual = 3.13e-06           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.904439202813       residual = 1.90e-05           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.904448299119       residual = 2.02e-06           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.904452512043       residual = 3.86e-06           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.904452952962       residual = 1.80e-06           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.904454763960       residual = 9.34e-07           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.904457395895       residual = 9.40e-07           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =      -0.904458700174       residual = 6.44e-07           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   tar_fn =      -0.904462780814       residual = 2.67e-07           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   tar_fn =      -0.904463287007       residual = 1.40e-07           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   tar_fn =      -0.904463309345       residual = 5.55e-08           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   tar_fn =      -0.904463219379       residual = 5.23e-08           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   tar_fn =      -0.904464360850       residual = 2.58e-08           smallest_sin_value = 1.00e+00
davidson iteration   31:   krylov dim =  32   tar_fn =      -0.904464106958       residual = 2.61e-08           smallest_sin_value = 1.00e+00
davidson iteration   32:   krylov dim =  33   tar_fn =      -0.904464052721       residual = 7.99e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         32 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.5625e-02 is 1.916215e-02

solving harmonic davidson linear method for identity shift 6.2500e-02, overlap shift 6.2500e-01 and omega -1.7456e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.904064278346       residual = 1.65e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.904141488526       residual = 1.05e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.904185023350       residual = 5.24e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.904205734571       residual = 2.81e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.904214741077       residual = 3.06e-04           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.904231969582       residual = 1.14e-04           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.904239780492       residual = 8.22e-05           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.904245841906       residual = 1.08e-04           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.904254464622       residual = 8.12e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.904257462563       residual = 3.99e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.904264517748       residual = 2.57e-05           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.904267839306       residual = 2.33e-05           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.904269723417       residual = 1.98e-05           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.904272473453       residual = 1.39e-05           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.904275256084       residual = 2.25e-05           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.904280215150       residual = 7.33e-06           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.904280065166       residual = 4.46e-06           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.904282037420       residual = 3.69e-06           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.904282937174       residual = 1.46e-06           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.904281655563       residual = 3.58e-06           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.904284142846       residual = 2.00e-06           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.904284935378       residual = 6.75e-07           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.904284993301       residual = 3.56e-07           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.904285648241       residual = 1.29e-07           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.904285821542       residual = 2.18e-07           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =      -0.904286001634       residual = 6.97e-08           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   tar_fn =      -0.904286538341       residual = 2.46e-08           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   tar_fn =      -0.904286477488       residual = 5.83e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         27 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 6.2500e-02 is 8.407821e-03

solving harmonic davidson linear method for identity shift 2.5000e-01, overlap shift 2.5000e+00 and omega -1.7456e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.904064278346       residual = 1.65e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.904096393960       residual = 1.01e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.904114074325       residual = 4.43e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.904122373321       residual = 2.39e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.904125912356       residual = 3.39e-04           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.904132593375       residual = 1.06e-04           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.904135081479       residual = 7.54e-05           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.904137717903       residual = 1.02e-04           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.904140341445       residual = 7.26e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.904141421909       residual = 3.21e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.904144099446       residual = 2.12e-05           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.904145136004       residual = 1.82e-05           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.904145522176       residual = 1.43e-05           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.904146416735       residual = 9.85e-06           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.904147318123       residual = 1.34e-05           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.904148520693       residual = 3.71e-06           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.904148320668       residual = 2.00e-06           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.904148831683       residual = 1.70e-06           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.904148823377       residual = 6.68e-07           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.904148531168       residual = 1.21e-06           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.904149113117       residual = 6.61e-07           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.904149209991       residual = 1.83e-07           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.904149228562       residual = 8.60e-08           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.904149282323       residual = 3.63e-08           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.904149316433       residual = 5.79e-08           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =      -0.904149341664       residual = 8.94e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         25 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.5000e-01 is 2.873983e-03

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.348417 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.6890e+01
  </log>
  <optVariables href="H2O.s009.opt.xml">
 uu_0                 2.517234e-01 1 1  ON 0
 uu_1                 1.009441e-01 1 1  ON 1
 uu_2                 1.617093e-02 1 1  ON 2
 uu_3                -3.223671e-02 1 1  ON 3
 uu_4                -6.387119e-02 1 1  ON 4
 uu_5                -8.576630e-02 1 1  ON 5
 uu_6                -1.001313e-01 1 1  ON 6
 uu_7                -1.065674e-01 1 1  ON 7
 uu_8                -9.668736e-02 1 1  ON 8
 uu_9                -6.389514e-02 1 1  ON 9
 ud_0                 3.492133e-01 1 1  ON 10
 ud_1                 1.235408e-01 1 1  ON 11
 ud_2                 2.392773e-02 1 1  ON 12
 ud_3                -3.019580e-02 1 1  ON 13
 ud_4                -6.975611e-02 1 1  ON 14
 ud_5                -9.484109e-02 1 1  ON 15
 ud_6                -1.085597e-01 1 1  ON 16
 ud_7                -1.109505e-01 1 1  ON 17
 ud_8                -9.792102e-02 1 1  ON 18
 ud_9                -6.281974e-02 1 1  ON 19
 eO_0                -5.692888e-01 1 1  ON 20
 eO_1                -3.060845e-01 1 1  ON 21
 eO_2                 4.730119e-02 1 1  ON 22
 eO_3                 2.840621e-01 1 1  ON 23
 eO_4                 3.913446e-01 1 1  ON 24
 eO_5                 3.212387e-01 1 1  ON 25
 eO_6                 1.205696e-01 1 1  ON 26
 eO_7                -7.888695e-02 1 1  ON 27
 eO_8                -1.549102e-01 1 1  ON 28
 eO_9                -6.122097e-02 1 1  ON 29
eH1_0                -2.277697e-01 1 1  ON 30
eH1_1                -1.106400e-01 1 1  ON 31
eH1_2                -6.162960e-02 1 1  ON 32
eH1_3                -2.530664e-02 1 1  ON 33
eH1_4                 4.247617e-03 1 1  ON 34
eH1_5                 2.367087e-02 1 1  ON 35
eH1_6                 6.569464e-02 1 1  ON 36
eH1_7                 1.154364e-01 1 1  ON 37
eH1_8                 1.435220e-01 1 1  ON 38
eH1_9                 7.467402e-02 1 1  ON 39
eH2_0                -2.307044e-01 1 1  ON 40
eH2_1                -1.139386e-01 1 1  ON 41
eH2_2                -6.444547e-02 1 1  ON 42
eH2_3                -2.722676e-02 1 1  ON 43
eH2_4                 1.073413e-03 1 1  ON 44
eH2_5                 2.532960e-02 1 1  ON 45
eH2_6                 7.564495e-02 1 1  ON 46
eH2_7                 1.260030e-01 1 1  ON 47
eH2_8                 1.609125e-01 1 1  ON 48
eH2_9                 6.417207e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 9
    time step          = 0.05
    reference energy   = -16.9041
    reference variance = 0.231896
====================================================
  Execution time = 2.2497e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s009
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6898e+01
  VMC Evar = 2.9308e-01
  Total weights = 2.0000e+06
  Execution time = 1.8779e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.293591419973
                                         uncertainty =       0.003179780298

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.293591419973
                                         uncertainty =       0.003179780298

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000383093489
  error estimate for blocks of size 2^( 2) =       0.000400122083
  error estimate for blocks of size 2^( 3) =       0.000417588398
  error estimate for blocks of size 2^( 4) =       0.000432012324
  error estimate for blocks of size 2^( 5) =       0.000442987352
  error estimate for blocks of size 2^( 6) =       0.000448526954
  error estimate for blocks of size 2^( 7) =       0.000452807803

      target function =      -0.922453768340
              le_mean =     -16.897541693109
             les_mean =     285.820436365482
             stat err =       0.000444083608
             autocorr =       1.343754543383
   target nu stat err =       0.000444083608
   target dn stat err =       0.003018919959
      target stat err =       0.004659674230
              std dev =       0.541776007103
             le_variance =       0.293521241872

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.292911011458
                                         uncertainty =       0.003134458828

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.292911011458
                                         uncertainty =       0.003134458828

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000382649726
  error estimate for blocks of size 2^( 2) =       0.000400008695
  error estimate for blocks of size 2^( 3) =       0.000417796657
  error estimate for blocks of size 2^( 4) =       0.000432499917
  error estimate for blocks of size 2^( 5) =       0.000443629991
  error estimate for blocks of size 2^( 6) =       0.000449291913
  error estimate for blocks of size 2^( 7) =       0.000453652078

      target function =      -0.923490741507
              le_mean =     -16.897530395486
             les_mean =     285.819374945940
             stat err =       0.000444768475
             autocorr =       1.351030581381
   target nu stat err =       0.000444768475
   target dn stat err =       0.002983388635
      target stat err =       0.004616514814
              std dev =       0.541148432498
             le_variance =       0.292841625995

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.292832061136
                                         uncertainty =       0.003122854297

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.292832061136
                                         uncertainty =       0.003122854297

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000382598319
  error estimate for blocks of size 2^( 2) =       0.000400031000
  error estimate for blocks of size 2^( 3) =       0.000417873886
  error estimate for blocks of size 2^( 4) =       0.000432604449
  error estimate for blocks of size 2^( 5) =       0.000443741428
  error estimate for blocks of size 2^( 6) =       0.000449405209
  error estimate for blocks of size 2^( 7) =       0.000453741101

      target function =      -0.923610980460
              le_mean =     -16.897528391266
             les_mean =     285.819228534358
             stat err =       0.000444873047
             autocorr =       1.352029207955
   target nu stat err =       0.000444873047
   target dn stat err =       0.002974097393
      target stat err =       0.004603696922
              std dev =       0.541075731385
             le_variance =       0.292762947094

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.293396607759
                                         uncertainty =       0.003167961727

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.293396607759
                                         uncertainty =       0.003167961727

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000382966485
  error estimate for blocks of size 2^( 2) =       0.000400070715
  error estimate for blocks of size 2^( 3) =       0.000417605703
  error estimate for blocks of size 2^( 4) =       0.000432083359
  error estimate for blocks of size 2^( 5) =       0.000443085018
  error estimate for blocks of size 2^( 6) =       0.000448644496
  error estimate for blocks of size 2^( 7) =       0.000452930971

      target function =      -0.922749883152
              le_mean =     -16.897527642549
             les_mean =     285.819766940541
             stat err =       0.000444185961
             autocorr =       1.345265856078
   target nu stat err =       0.000444185961
   target dn stat err =       0.003009559797
      target stat err =       0.004648440602
              std dev =       0.541596396316
             le_variance =       0.293326656503


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.922453768340        initial
     1.5625e-02     1.5625e-01             1.9162e-02        -0.923490741507
     6.2500e-02     6.2500e-01             8.4078e-03        -0.923610980460  <--
     2.5000e-01     2.5000e+00             2.8740e-03        -0.922749883152

*****************************************************************************
Applying the update for shift_i =   6.2500e-02     and shift_s =   6.2500e-01
*****************************************************************************

  Execution time = 3.1979e+01
  </log>
  <optVariables href="H2O.s009.opt.xml">
 uu_0                 2.517234e-01 1 1  ON 0
 uu_1                 1.009441e-01 1 1  ON 1
 uu_2                 1.617093e-02 1 1  ON 2
 uu_3                -3.223671e-02 1 1  ON 3
 uu_4                -6.387119e-02 1 1  ON 4
 uu_5                -8.576630e-02 1 1  ON 5
 uu_6                -1.001313e-01 1 1  ON 6
 uu_7                -1.065674e-01 1 1  ON 7
 uu_8                -9.668736e-02 1 1  ON 8
 uu_9                -6.389514e-02 1 1  ON 9
 ud_0                 3.492133e-01 1 1  ON 10
 ud_1                 1.235408e-01 1 1  ON 11
 ud_2                 2.392773e-02 1 1  ON 12
 ud_3                -3.019580e-02 1 1  ON 13
 ud_4                -6.975611e-02 1 1  ON 14
 ud_5                -9.484109e-02 1 1  ON 15
 ud_6                -1.085597e-01 1 1  ON 16
 ud_7                -1.109505e-01 1 1  ON 17
 ud_8                -9.792102e-02 1 1  ON 18
 ud_9                -6.281974e-02 1 1  ON 19
 eO_0                -5.692888e-01 1 1  ON 20
 eO_1                -3.060845e-01 1 1  ON 21
 eO_2                 4.730119e-02 1 1  ON 22
 eO_3                 2.840621e-01 1 1  ON 23
 eO_4                 3.913446e-01 1 1  ON 24
 eO_5                 3.212387e-01 1 1  ON 25
 eO_6                 1.205696e-01 1 1  ON 26
 eO_7                -7.888695e-02 1 1  ON 27
 eO_8                -1.549102e-01 1 1  ON 28
 eO_9                -6.122097e-02 1 1  ON 29
eH1_0                -2.277697e-01 1 1  ON 30
eH1_1                -1.106400e-01 1 1  ON 31
eH1_2                -6.162960e-02 1 1  ON 32
eH1_3                -2.530664e-02 1 1  ON 33
eH1_4                 4.247617e-03 1 1  ON 34
eH1_5                 2.367087e-02 1 1  ON 35
eH1_6                 6.569464e-02 1 1  ON 36
eH1_7                 1.154364e-01 1 1  ON 37
eH1_8                 1.435220e-01 1 1  ON 38
eH1_9                 7.467402e-02 1 1  ON 39
eH2_0                -2.307044e-01 1 1  ON 40
eH2_1                -1.139386e-01 1 1  ON 41
eH2_2                -6.444547e-02 1 1  ON 42
eH2_3                -2.722676e-02 1 1  ON 43
eH2_4                 1.073413e-03 1 1  ON 44
eH2_5                 2.532960e-02 1 1  ON 45
eH2_6                 7.564495e-02 1 1  ON 46
eH2_7                 1.260030e-01 1 1  ON 47
eH2_8                 1.609125e-01 1 1  ON 48
eH2_9                 6.417207e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.8876e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s010 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s010 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=10  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6900e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 10
    time step          = 0.05
    reference energy   = -16.8585
    reference variance = 0.261386
====================================================
  Execution time = 2.0909e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s010
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6897e+01
  VMC Evar = 2.9437e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.4987e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.294366630398
                                         uncertainty =       0.003656447776

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.294366630398
                                         uncertainty =       0.003656447776

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000383645210
  error estimate for blocks of size 2^( 2) =       0.000400645432
  error estimate for blocks of size 2^( 3) =       0.000418269494
  error estimate for blocks of size 2^( 4) =       0.000433347050
  error estimate for blocks of size 2^( 5) =       0.000444405259
  error estimate for blocks of size 2^( 6) =       0.000452296703
  error estimate for blocks of size 2^( 7) =       0.000456666068

      target function =      -0.921154823267
              le_mean =     -16.897446768030
             les_mean =     285.818074425590
             stat err =       0.000446678770
             autocorr =       1.355598446720
   target nu stat err =       0.000446678770
   target dn stat err =       0.003425692514
      target stat err =       0.005257904675
              std dev =       0.542556259185
             le_variance =       0.294367294381


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.689744676803e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.5625e-02, overlap shift 1.5625e-01 and omega -1.7456e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.921183434848       residual = 1.45e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.921224791797       residual = 5.82e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.921270832395       residual = 5.05e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.921299491633       residual = 2.27e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.921316431563       residual = 1.47e-04           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.921336260027       residual = 8.74e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.921350489353       residual = 7.77e-05           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.921356997157       residual = 7.24e-05           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.921367680286       residual = 3.16e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.921378927566       residual = 2.23e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.921383408799       residual = 3.07e-05           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.921384974408       residual = 3.48e-05           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.921396012926       residual = 1.98e-05           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.921399070558       residual = 1.60e-05           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.921406885408       residual = 1.57e-05           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.921413005496       residual = 1.06e-05           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.921418354277       residual = 9.65e-06           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.921422176423       residual = 6.29e-06           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.921420592473       residual = 5.19e-06           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.921421875860       residual = 6.26e-06           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.921428575924       residual = 5.34e-06           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.921433276600       residual = 5.30e-06           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.921434418089       residual = 1.37e-06           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.921437388814       residual = 2.23e-06           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.921440262214       residual = 1.26e-06           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =      -0.921441361337       residual = 4.90e-07           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   tar_fn =      -0.921446058679       residual = 4.08e-07           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   tar_fn =      -0.921445365209       residual = 1.58e-07           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   tar_fn =      -0.921445649433       residual = 5.79e-08           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   tar_fn =      -0.921445687198       residual = 4.59e-08           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   tar_fn =      -0.921445538094       residual = 1.11e-08           smallest_sin_value = 1.00e+00
davidson iteration   31:   krylov dim =  32   tar_fn =      -0.921445507785       residual = 8.81e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         31 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.5625e-02 is 2.159697e-02

solving harmonic davidson linear method for identity shift 6.2500e-02, overlap shift 6.2500e-01 and omega -1.7456e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.921183434848       residual = 1.45e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.921211242045       residual = 5.72e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.921240661023       residual = 4.81e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.921259234472       residual = 2.13e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.921269754376       residual = 1.33e-04           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.921281159785       residual = 7.00e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.921290891511       residual = 4.07e-05           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.921294151961       residual = 1.20e-04           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.921298360732       residual = 2.93e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.921304429950       residual = 2.63e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.921305131013       residual = 2.02e-05           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.921307178269       residual = 1.91e-05           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.921310521366       residual = 1.42e-05           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.921313579780       residual = 7.48e-06           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.921316011866       residual = 7.85e-06           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.921318303670       residual = 4.91e-06           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.921319789488       residual = 3.95e-06           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.921320541214       residual = 2.34e-06           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.921319708335       residual = 1.94e-06           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.921320020058       residual = 2.15e-06           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.921321775288       residual = 1.51e-06           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.921322380966       residual = 5.48e-07           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.921322333829       residual = 3.66e-07           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.921322610228       residual = 3.40e-07           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.921323149993       residual = 1.60e-07           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =      -0.921323194945       residual = 5.16e-08           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   tar_fn =      -0.921323816269       residual = 3.70e-08           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   tar_fn =      -0.921323549443       residual = 1.11e-08           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   tar_fn =      -0.921323468785       residual = 4.34e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         28 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 6.2500e-02 is 5.301124e-03

solving harmonic davidson linear method for identity shift 2.5000e-01, overlap shift 2.5000e+00 and omega -1.7456e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.921183434848       residual = 1.45e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.921195469760       residual = 5.63e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.921207450788       residual = 4.56e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.921215280791       residual = 1.97e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.921219438618       residual = 1.20e-04           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.921223579676       residual = 6.04e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.921226876993       residual = 6.38e-05           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.921227732983       residual = 4.87e-05           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.921229448926       residual = 2.77e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.921231332986       residual = 2.03e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.921232042249       residual = 1.32e-05           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.921232521197       residual = 1.39e-05           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.921233407244       residual = 7.82e-06           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.921234454252       residual = 4.31e-06           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.921234913875       residual = 4.18e-06           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.921235442518       residual = 2.43e-06           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.921235709716       residual = 1.79e-06           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.921235825138       residual = 1.03e-06           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.921235582453       residual = 8.42e-07           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.921235680874       residual = 8.34e-07           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.921236032390       residual = 5.15e-07           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.921236073121       residual = 2.58e-07           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.921236032540       residual = 8.18e-08           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.921236042886       residual = 7.18e-08           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.921236129703       residual = 3.23e-08           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =      -0.921236122490       residual = 8.55e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         25 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.5000e-01 is 1.309960e-03

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.378898 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.6444e+01
  </log>
  <optVariables href="H2O.s010.opt.xml">
 uu_0                 2.501824e-01 1 1  ON 0
 uu_1                 9.926508e-02 1 1  ON 1
 uu_2                 1.402654e-02 1 1  ON 2
 uu_3                -3.430161e-02 1 1  ON 3
 uu_4                -6.492090e-02 1 1  ON 4
 uu_5                -8.506490e-02 1 1  ON 5
 uu_6                -9.906743e-02 1 1  ON 6
 uu_7                -1.046823e-01 1 1  ON 7
 uu_8                -9.570299e-02 1 1  ON 8
 uu_9                -6.282519e-02 1 1  ON 9
 ud_0                 3.497815e-01 1 1  ON 10
 ud_1                 1.234968e-01 1 1  ON 11
 ud_2                 2.412694e-02 1 1  ON 12
 ud_3                -3.040459e-02 1 1  ON 13
 ud_4                -7.062406e-02 1 1  ON 14
 ud_5                -9.643782e-02 1 1  ON 15
 ud_6                -1.103288e-01 1 1  ON 16
 ud_7                -1.120382e-01 1 1  ON 17
 ud_8                -9.873396e-02 1 1  ON 18
 ud_9                -6.166024e-02 1 1  ON 19
 eO_0                -5.717683e-01 1 1  ON 20
 eO_1                -3.066870e-01 1 1  ON 21
 eO_2                 4.799364e-02 1 1  ON 22
 eO_3                 2.850573e-01 1 1  ON 23
 eO_4                 3.935565e-01 1 1  ON 24
 eO_5                 3.208526e-01 1 1  ON 25
 eO_6                 1.184614e-01 1 1  ON 26
 eO_7                -8.029793e-02 1 1  ON 27
 eO_8                -1.522077e-01 1 1  ON 28
 eO_9                -6.133869e-02 1 1  ON 29
eH1_0                -2.298926e-01 1 1  ON 30
eH1_1                -1.129173e-01 1 1  ON 31
eH1_2                -6.319810e-02 1 1  ON 32
eH1_3                -2.784145e-02 1 1  ON 33
eH1_4                 7.755489e-05 1 1  ON 34
eH1_5                 2.236969e-02 1 1  ON 35
eH1_6                 6.919820e-02 1 1  ON 36
eH1_7                 1.189163e-01 1 1  ON 37
eH1_8                 1.488231e-01 1 1  ON 38
eH1_9                 7.696404e-02 1 1  ON 39
eH2_0                -2.313522e-01 1 1  ON 40
eH2_1                -1.141322e-01 1 1  ON 41
eH2_2                -6.301057e-02 1 1  ON 42
eH2_3                -2.651478e-02 1 1  ON 43
eH2_4                 1.991358e-03 1 1  ON 44
eH2_5                 2.345082e-02 1 1  ON 45
eH2_6                 7.203790e-02 1 1  ON 46
eH2_7                 1.240872e-01 1 1  ON 47
eH2_8                 1.598933e-01 1 1  ON 48
eH2_9                 6.936585e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 10
    time step          = 0.05
    reference energy   = -16.9159
    reference variance = 0.21652
====================================================
  Execution time = 2.0412e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s010
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6898e+01
  VMC Evar = 2.9460e-01
  Total weights = 2.0000e+06
  Execution time = 1.8770e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.294351070668
                                         uncertainty =       0.003365495841

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.294351070668
                                         uncertainty =       0.003365495841

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000383708599
  error estimate for blocks of size 2^( 2) =       0.000400705788
  error estimate for blocks of size 2^( 3) =       0.000418313347
  error estimate for blocks of size 2^( 4) =       0.000433815453
  error estimate for blocks of size 2^( 5) =       0.000445446271
  error estimate for blocks of size 2^( 6) =       0.000452216146
  error estimate for blocks of size 2^( 7) =       0.000456448504

      target function =      -0.921029286477
              le_mean =     -16.897898857245
             les_mean =     285.833450220620
             stat err =       0.000446981594
             autocorr =       1.356988649139
   target nu stat err =       0.000446981594
   target dn stat err =       0.003353106951
      target stat err =       0.005151555257
              std dev =       0.542645904973
             le_variance =       0.294464578184

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.294720769452
                                         uncertainty =       0.003358758720

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.294720769452
                                         uncertainty =       0.003358758720

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000383950034
  error estimate for blocks of size 2^( 2) =       0.000400992411
  error estimate for blocks of size 2^( 3) =       0.000418646783
  error estimate for blocks of size 2^( 4) =       0.000434165850
  error estimate for blocks of size 2^( 5) =       0.000445733974
  error estimate for blocks of size 2^( 6) =       0.000452397243
  error estimate for blocks of size 2^( 7) =       0.000456644543

      target function =      -0.920466912443
              le_mean =     -16.897913795602
             les_mean =     285.834325754110
             stat err =       0.000447235402
             autocorr =       1.356822156373
   target nu stat err =       0.000447235402
   target dn stat err =       0.003340357466
      target stat err =       0.005126365500
              std dev =       0.542987346023
             le_variance =       0.294835257942

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.294708578218
                                         uncertainty =       0.003357249158

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.294708578218
                                         uncertainty =       0.003357249158

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000383941880
  error estimate for blocks of size 2^( 2) =       0.000400967320
  error estimate for blocks of size 2^( 3) =       0.000418602134
  error estimate for blocks of size 2^( 4) =       0.000434105037
  error estimate for blocks of size 2^( 5) =       0.000445661594
  error estimate for blocks of size 2^( 6) =       0.000452317240
  error estimate for blocks of size 2^( 7) =       0.000456577730

      target function =      -0.920485771813
              le_mean =     -16.897909656029
             les_mean =     285.834173330546
             stat err =       0.000447165400
             autocorr =       1.356455060181
   target nu stat err =       0.000447165400
   target dn stat err =       0.003338808493
      target stat err =       0.005124190599
              std dev =       0.542975814045
             le_variance =       0.294822734638

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.294387078838
                                         uncertainty =       0.003363882940

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.294387078838
                                         uncertainty =       0.003363882940

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000383732108
  error estimate for blocks of size 2^( 2) =       0.000400729780
  error estimate for blocks of size 2^( 3) =       0.000418337917
  error estimate for blocks of size 2^( 4) =       0.000433837084
  error estimate for blocks of size 2^( 5) =       0.000445452656
  error estimate for blocks of size 2^( 6) =       0.000452200571
  error estimate for blocks of size 2^( 7) =       0.000456440095

      target function =      -0.920974160600
              le_mean =     -16.897892012150
             les_mean =     285.833254968271
             stat err =       0.000446982602
             autocorr =       1.356828506235
   target nu stat err =       0.000446982602
   target dn stat err =       0.003350347897
      target stat err =       0.005146730388
              std dev =       0.542679151270
             le_variance =       0.294500661223


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.921029286477        initial  <--
     1.5625e-02     1.5625e-01             2.1597e-02        -0.920466912443
     6.2500e-02     6.2500e-01             5.3011e-03        -0.920485771813
     2.5000e-01     2.5000e+00             1.3100e-03        -0.920974160600

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 29.9040
  </log>
  <optVariables href="H2O.s010.opt.xml">
 uu_0                 2.517234e-01 1 1  ON 0
 uu_1                 1.009441e-01 1 1  ON 1
 uu_2                 1.617093e-02 1 1  ON 2
 uu_3                -3.223671e-02 1 1  ON 3
 uu_4                -6.387119e-02 1 1  ON 4
 uu_5                -8.576630e-02 1 1  ON 5
 uu_6                -1.001313e-01 1 1  ON 6
 uu_7                -1.065674e-01 1 1  ON 7
 uu_8                -9.668736e-02 1 1  ON 8
 uu_9                -6.389514e-02 1 1  ON 9
 ud_0                 3.492133e-01 1 1  ON 10
 ud_1                 1.235408e-01 1 1  ON 11
 ud_2                 2.392773e-02 1 1  ON 12
 ud_3                -3.019580e-02 1 1  ON 13
 ud_4                -6.975611e-02 1 1  ON 14
 ud_5                -9.484109e-02 1 1  ON 15
 ud_6                -1.085597e-01 1 1  ON 16
 ud_7                -1.109505e-01 1 1  ON 17
 ud_8                -9.792102e-02 1 1  ON 18
 ud_9                -6.281974e-02 1 1  ON 19
 eO_0                -5.692888e-01 1 1  ON 20
 eO_1                -3.060845e-01 1 1  ON 21
 eO_2                 4.730119e-02 1 1  ON 22
 eO_3                 2.840621e-01 1 1  ON 23
 eO_4                 3.913446e-01 1 1  ON 24
 eO_5                 3.212387e-01 1 1  ON 25
 eO_6                 1.205696e-01 1 1  ON 26
 eO_7                -7.888695e-02 1 1  ON 27
 eO_8                -1.549102e-01 1 1  ON 28
 eO_9                -6.122097e-02 1 1  ON 29
eH1_0                -2.277697e-01 1 1  ON 30
eH1_1                -1.106400e-01 1 1  ON 31
eH1_2                -6.162960e-02 1 1  ON 32
eH1_3                -2.530664e-02 1 1  ON 33
eH1_4                 4.247617e-03 1 1  ON 34
eH1_5                 2.367087e-02 1 1  ON 35
eH1_6                 6.569464e-02 1 1  ON 36
eH1_7                 1.154364e-01 1 1  ON 37
eH1_8                 1.435220e-01 1 1  ON 38
eH1_9                 7.467402e-02 1 1  ON 39
eH2_0                -2.307044e-01 1 1  ON 40
eH2_1                -1.139386e-01 1 1  ON 41
eH2_2                -6.444547e-02 1 1  ON 42
eH2_3                -2.722676e-02 1 1  ON 43
eH2_4                 1.073413e-03 1 1  ON 44
eH2_5                 2.532960e-02 1 1  ON 45
eH2_6                 7.564495e-02 1 1  ON 46
eH2_7                 1.260030e-01 1 1  ON 47
eH2_8                 1.609125e-01 1 1  ON 48
eH2_9                 6.417207e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.6353e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s011 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s011 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=11  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6899e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 11
    time step          = 0.05
    reference energy   = -16.8439
    reference variance = 0.182399
====================================================
  Execution time = 2.1130e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s011
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6898e+01
  VMC Evar = 2.9034e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.5160e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.290361834790
                                         uncertainty =       0.002487460026

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.290361834790
                                         uncertainty =       0.002487460026

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000381010423
  error estimate for blocks of size 2^( 2) =       0.000398443512
  error estimate for blocks of size 2^( 3) =       0.000415765947
  error estimate for blocks of size 2^( 4) =       0.000431154008
  error estimate for blocks of size 2^( 5) =       0.000443675267
  error estimate for blocks of size 2^( 6) =       0.000450151386
  error estimate for blocks of size 2^( 7) =       0.000453892647

      target function =      -0.927389536212
              le_mean =     -16.898458985369
             les_mean =     285.848253819495
             stat err =       0.000444718327
             autocorr =       1.362373987511
   target nu stat err =       0.000444718327
   target dn stat err =       0.002631565433
      target stat err =       0.004127676298
              std dev =       0.538830107223
             le_variance =       0.290337884450


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.689845898537e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.5625e-01, overlap shift 1.5625e+00 and omega -1.7456e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.927406469641       residual = 1.24e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.927427404534       residual = 4.87e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.927446871262       residual = 1.62e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.927453170506       residual = 9.34e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.927456227078       residual = 8.98e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.927460034552       residual = 4.61e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.927461397390       residual = 5.07e-05           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.927462271380       residual = 4.81e-05           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.927463484373       residual = 4.51e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.927467707185       residual = 2.55e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.927469526417       residual = 1.58e-05           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.927472262014       residual = 2.09e-05           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.927472518135       residual = 1.40e-05           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.927473169966       residual = 5.87e-06           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.927474190744       residual = 4.05e-06           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.927476694633       residual = 5.40e-06           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.927476921955       residual = 1.39e-06           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.927476918389       residual = 8.46e-07           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.927477945375       residual = 7.30e-07           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.927477694444       residual = 7.00e-07           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.927477977804       residual = 6.93e-07           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.927478112477       residual = 1.97e-07           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.927478259241       residual = 1.55e-07           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.927478317003       residual = 9.53e-08           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.927478421846       residual = 4.72e-08           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =      -0.927478386302       residual = 1.57e-08           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   tar_fn =      -0.927478413059       residual = 7.61e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         26 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.5625e-01 is 2.639060e-03

solving harmonic davidson linear method for identity shift 6.2500e-01, overlap shift 6.2500e+00 and omega -1.7456e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.927406469641       residual = 1.24e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.927413323629       residual = 4.82e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.927419670657       residual = 1.62e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.927421440946       residual = 1.05e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.927422401089       residual = 7.23e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.927423317468       residual = 7.42e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.927423907469       residual = 2.90e-05           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.927424217477       residual = 4.14e-05           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.927424461733       residual = 3.81e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.927425803484       residual = 1.95e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.927426247862       residual = 1.42e-05           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.927426952354       residual = 1.36e-05           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.927426958698       residual = 1.03e-05           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.927427111716       residual = 4.28e-06           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.927427369297       residual = 2.85e-06           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.927427960049       residual = 2.98e-06           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.927427964933       residual = 7.70e-07           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.927427953129       residual = 5.66e-07           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.927428188403       residual = 4.04e-07           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.927428114103       residual = 3.80e-07           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.927428161701       residual = 2.52e-07           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.927428192993       residual = 1.00e-07           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.927428224736       residual = 5.59e-08           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.927428223396       residual = 3.93e-08           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.927428244263       residual = 1.55e-08           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =      -0.927428234388       residual = 5.14e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         25 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 6.2500e-01 is 7.249236e-04

solving harmonic davidson linear method for identity shift 2.5000e+00, overlap shift 2.5000e+01 and omega -1.7456e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.927406469641       residual = 1.24e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.927408326876       residual = 4.81e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.927410044927       residual = 1.64e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.927410502315       residual = 1.08e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.927410764242       residual = 6.85e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.927410988154       residual = 7.70e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.927411159812       residual = 2.68e-05           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.927411240052       residual = 3.94e-05           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.927411295806       residual = 3.63e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.927411654109       residual = 1.71e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.927411765093       residual = 1.38e-05           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.927411939204       residual = 1.18e-05           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.927411935827       residual = 9.19e-06           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.927411974497       residual = 3.85e-06           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.927412037842       residual = 2.52e-06           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.927412180723       residual = 2.42e-06           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.927412178237       residual = 6.40e-07           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.927412174300       residual = 4.98e-07           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.927412230906       residual = 3.29e-07           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.927412212693       residual = 3.07e-07           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.927412223031       residual = 1.80e-07           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.927412230604       residual = 7.49e-08           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.927412237804       residual = 3.88e-08           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.927412236524       residual = 3.14e-08           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.927412241432       residual = 1.07e-08           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =      -0.927412239052       residual = 3.58e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         25 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.5000e+00 is 1.859501e-04

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.401980 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.6675e+01
  </log>
  <optVariables href="H2O.s011.opt.xml">
 uu_0                 2.516905e-01 1 1  ON 0
 uu_1                 1.006824e-01 1 1  ON 1
 uu_2                 1.585689e-02 1 1  ON 2
 uu_3                -3.247605e-02 1 1  ON 3
 uu_4                -6.405041e-02 1 1  ON 4
 uu_5                -8.592476e-02 1 1  ON 5
 uu_6                -1.003157e-01 1 1  ON 6
 uu_7                -1.065923e-01 1 1  ON 7
 uu_8                -9.628926e-02 1 1  ON 8
 uu_9                -6.353106e-02 1 1  ON 9
 ud_0                 3.493491e-01 1 1  ON 10
 ud_1                 1.235634e-01 1 1  ON 11
 ud_2                 2.394722e-02 1 1  ON 12
 ud_3                -3.015366e-02 1 1  ON 13
 ud_4                -6.971837e-02 1 1  ON 14
 ud_5                -9.485641e-02 1 1  ON 15
 ud_6                -1.084830e-01 1 1  ON 16
 ud_7                -1.110663e-01 1 1  ON 17
 ud_8                -9.826680e-02 1 1  ON 18
 ud_9                -6.314718e-02 1 1  ON 19
 eO_0                -5.693382e-01 1 1  ON 20
 eO_1                -3.058565e-01 1 1  ON 21
 eO_2                 4.749873e-02 1 1  ON 22
 eO_3                 2.839250e-01 1 1  ON 23
 eO_4                 3.914382e-01 1 1  ON 24
 eO_5                 3.211812e-01 1 1  ON 25
 eO_6                 1.205966e-01 1 1  ON 26
 eO_7                -7.919068e-02 1 1  ON 27
 eO_8                -1.549669e-01 1 1  ON 28
 eO_9                -6.118791e-02 1 1  ON 29
eH1_0                -2.279854e-01 1 1  ON 30
eH1_1                -1.109676e-01 1 1  ON 31
eH1_2                -6.200748e-02 1 1  ON 32
eH1_3                -2.565838e-02 1 1  ON 33
eH1_4                 3.969260e-03 1 1  ON 34
eH1_5                 2.369787e-02 1 1  ON 35
eH1_6                 6.641956e-02 1 1  ON 36
eH1_7                 1.159333e-01 1 1  ON 37
eH1_8                 1.435688e-01 1 1  ON 38
eH1_9                 7.489263e-02 1 1  ON 39
eH2_0                -2.311302e-01 1 1  ON 40
eH2_1                -1.143302e-01 1 1  ON 41
eH2_2                -6.474208e-02 1 1  ON 42
eH2_3                -2.761479e-02 1 1  ON 43
eH2_4                 9.411434e-04 1 1  ON 44
eH2_5                 2.567645e-02 1 1  ON 45
eH2_6                 7.607582e-02 1 1  ON 46
eH2_7                 1.261409e-01 1 1  ON 47
eH2_8                 1.612490e-01 1 1  ON 48
eH2_9                 6.458080e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 11
    time step          = 0.05
    reference energy   = -16.8719
    reference variance = 0.470198
====================================================
  Execution time = 2.0541e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s011
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6898e+01
  VMC Evar = 2.9579e-01
  Total weights = 2.0000e+06
  Execution time = 1.8825e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.295830463931
                                         uncertainty =       0.003729838352

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.295830463931
                                         uncertainty =       0.003729838352

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000384554901
  error estimate for blocks of size 2^( 2) =       0.000401830878
  error estimate for blocks of size 2^( 3) =       0.000418861223
  error estimate for blocks of size 2^( 4) =       0.000434448204
  error estimate for blocks of size 2^( 5) =       0.000445043029
  error estimate for blocks of size 2^( 6) =       0.000451692481
  error estimate for blocks of size 2^( 7) =       0.000454686269

      target function =      -0.919077370249
              le_mean =     -16.898459186898
             les_mean =     285.853687686483
             stat err =       0.000446467496
             autocorr =       1.347916507289
   target nu stat err =       0.000446467496
   target dn stat err =       0.003446708908
      target stat err =       0.005275450548
              std dev =       0.543842755874
             le_variance =       0.295764943117

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.295925020332
                                         uncertainty =       0.003737513117

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.295925020332
                                         uncertainty =       0.003737513117

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000384616231
  error estimate for blocks of size 2^( 2) =       0.000401858296
  error estimate for blocks of size 2^( 3) =       0.000418857723
  error estimate for blocks of size 2^( 4) =       0.000434411142
  error estimate for blocks of size 2^( 5) =       0.000444984479
  error estimate for blocks of size 2^( 6) =       0.000451621021
  error estimate for blocks of size 2^( 7) =       0.000454601296

      target function =      -0.918934327655
              le_mean =     -16.898460133097
             les_mean =     285.853814012035
             stat err =       0.000446404484
             autocorr =       1.347106346683
   target nu stat err =       0.000446404484
   target dn stat err =       0.003453468694
      target stat err =       0.005283961545
              std dev =       0.543929490005
             le_variance =       0.295859290097

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.295889085582
                                         uncertainty =       0.003735110569

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.295889085582
                                         uncertainty =       0.003735110569

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000384592915
  error estimate for blocks of size 2^( 2) =       0.000401846354
  error estimate for blocks of size 2^( 3) =       0.000418856594
  error estimate for blocks of size 2^( 4) =       0.000434422514
  error estimate for blocks of size 2^( 5) =       0.000445005213
  error estimate for blocks of size 2^( 6) =       0.000451647955
  error estimate for blocks of size 2^( 7) =       0.000454634065

      target function =      -0.918988672811
              le_mean =     -16.898459141229
             les_mean =     285.853744620197
             stat err =       0.000446427437
             autocorr =       1.347408235056
   target nu stat err =       0.000446427437
   target dn stat err =       0.003451337953
      target stat err =       0.005281378921
              std dev =       0.543896516177
             le_variance =       0.295823420310

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.295837929505
                                         uncertainty =       0.003730563480

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.295837929505
                                         uncertainty =       0.003730563480

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000384559741
  error estimate for blocks of size 2^( 2) =       0.000401832616
  error estimate for blocks of size 2^( 3) =       0.000418860205
  error estimate for blocks of size 2^( 4) =       0.000434444334
  error estimate for blocks of size 2^( 5) =       0.000445037563
  error estimate for blocks of size 2^( 6) =       0.000451686150
  error estimate for blocks of size 2^( 7) =       0.000454678929

      target function =      -0.919066070154
              le_mean =     -16.898459060021
             les_mean =     285.853690844057
             stat err =       0.000446461744
             autocorr =       1.347847848082
   target nu stat err =       0.000446461744
   target dn stat err =       0.003447345016
      target stat err =       0.005276274251
              std dev =       0.543849601224
             le_variance =       0.295772388752


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.919077370249        initial  <--
     1.5625e-01     1.5625e+00             2.6391e-03        -0.918934327655
     6.2500e-01     6.2500e+00             7.2492e-04        -0.918988672811
     2.5000e+00     2.5000e+01             1.8595e-04        -0.919066070154

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 33.6541
  </log>
  <optVariables href="H2O.s011.opt.xml">
 uu_0                 2.517234e-01 1 1  ON 0
 uu_1                 1.009441e-01 1 1  ON 1
 uu_2                 1.617093e-02 1 1  ON 2
 uu_3                -3.223671e-02 1 1  ON 3
 uu_4                -6.387119e-02 1 1  ON 4
 uu_5                -8.576630e-02 1 1  ON 5
 uu_6                -1.001313e-01 1 1  ON 6
 uu_7                -1.065674e-01 1 1  ON 7
 uu_8                -9.668736e-02 1 1  ON 8
 uu_9                -6.389514e-02 1 1  ON 9
 ud_0                 3.492133e-01 1 1  ON 10
 ud_1                 1.235408e-01 1 1  ON 11
 ud_2                 2.392773e-02 1 1  ON 12
 ud_3                -3.019580e-02 1 1  ON 13
 ud_4                -6.975611e-02 1 1  ON 14
 ud_5                -9.484109e-02 1 1  ON 15
 ud_6                -1.085597e-01 1 1  ON 16
 ud_7                -1.109505e-01 1 1  ON 17
 ud_8                -9.792102e-02 1 1  ON 18
 ud_9                -6.281974e-02 1 1  ON 19
 eO_0                -5.692888e-01 1 1  ON 20
 eO_1                -3.060845e-01 1 1  ON 21
 eO_2                 4.730119e-02 1 1  ON 22
 eO_3                 2.840621e-01 1 1  ON 23
 eO_4                 3.913446e-01 1 1  ON 24
 eO_5                 3.212387e-01 1 1  ON 25
 eO_6                 1.205696e-01 1 1  ON 26
 eO_7                -7.888695e-02 1 1  ON 27
 eO_8                -1.549102e-01 1 1  ON 28
 eO_9                -6.122097e-02 1 1  ON 29
eH1_0                -2.277697e-01 1 1  ON 30
eH1_1                -1.106400e-01 1 1  ON 31
eH1_2                -6.162960e-02 1 1  ON 32
eH1_3                -2.530664e-02 1 1  ON 33
eH1_4                 4.247617e-03 1 1  ON 34
eH1_5                 2.367087e-02 1 1  ON 35
eH1_6                 6.569464e-02 1 1  ON 36
eH1_7                 1.154364e-01 1 1  ON 37
eH1_8                 1.435220e-01 1 1  ON 38
eH1_9                 7.467402e-02 1 1  ON 39
eH2_0                -2.307044e-01 1 1  ON 40
eH2_1                -1.139386e-01 1 1  ON 41
eH2_2                -6.444547e-02 1 1  ON 42
eH2_3                -2.722676e-02 1 1  ON 43
eH2_4                 1.073413e-03 1 1  ON 44
eH2_5                 2.532960e-02 1 1  ON 45
eH2_6                 7.564495e-02 1 1  ON 46
eH2_7                 1.260030e-01 1 1  ON 47
eH2_8                 1.609125e-01 1 1  ON 48
eH2_9                 6.417207e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 6.0335e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s012 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s012 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=12  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6895e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 12
    time step          = 0.05
    reference energy   = -16.9286
    reference variance = 0.278104
====================================================
  Execution time = 2.0866e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s012
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6898e+01
  VMC Evar = 2.9352e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.5565e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.293366685853
                                         uncertainty =       0.002956658256

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.293366685853
                                         uncertainty =       0.002956658256

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000383095413
  error estimate for blocks of size 2^( 2) =       0.000400072056
  error estimate for blocks of size 2^( 3) =       0.000417695959
  error estimate for blocks of size 2^( 4) =       0.000433271803
  error estimate for blocks of size 2^( 5) =       0.000445003096
  error estimate for blocks of size 2^( 6) =       0.000452439980
  error estimate for blocks of size 2^( 7) =       0.000453349099

      target function =      -0.922494496275
              le_mean =     -16.898477698859
             les_mean =     285.852072583295
             stat err =       0.000446015994
             autocorr =       1.355460797934
   target nu stat err =       0.000446015994
   target dn stat err =       0.002998290221
      target stat err =       0.004637309930
              std dev =       0.541778729035
             le_variance =       0.293524191235


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.689847769886e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.5625e+00, overlap shift 1.5625e+01 and omega -1.7456e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.922516353550       residual = 1.04e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.922518488195       residual = 5.10e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.922520027760       residual = 2.77e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.922521094796       residual = 1.83e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.922521849120       residual = 8.73e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.922522050645       residual = 5.24e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.922522447755       residual = 5.30e-05           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.922522792750       residual = 2.91e-05           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.922522803413       residual = 2.55e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.922522913234       residual = 1.27e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.922523087821       residual = 9.02e-06           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.922523232117       residual = 8.71e-06           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.922523420306       residual = 7.57e-06           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.922523423840       residual = 4.57e-06           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.922523385843       residual = 3.23e-06           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.922523553467       residual = 2.73e-06           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.922523652209       residual = 1.04e-06           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.922523624751       residual = 8.60e-07           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.922523649778       residual = 3.55e-07           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.922523648744       residual = 4.88e-07           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.922523663857       residual = 2.28e-07           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.922523660309       residual = 3.42e-08           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.922523688750       residual = 3.06e-08           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.922523682393       residual = 4.21e-08           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.922523680549       residual = 6.93e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         24 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.5625e+00 is 3.585351e-04

solving harmonic davidson linear method for identity shift 6.2500e+00, overlap shift 6.2500e+01 and omega -1.7456e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.922516353550       residual = 1.04e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.922516906556       residual = 5.07e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.922517305470       residual = 2.74e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.922517580773       residual = 1.83e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.922517774048       residual = 8.73e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.922517825548       residual = 5.18e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.922517926185       residual = 5.29e-05           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.922518017647       residual = 3.23e-05           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.922518012327       residual = 3.17e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.922518042798       residual = 1.09e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.922518091251       residual = 8.86e-06           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.922518126528       residual = 8.47e-06           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.922518174260       residual = 7.28e-06           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.922518175078       residual = 4.37e-06           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.922518164673       residual = 3.04e-06           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.922518207983       residual = 2.52e-06           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.922518231171       residual = 9.81e-07           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.922518223923       residual = 7.91e-07           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.922518229947       residual = 3.31e-07           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.922518229793       residual = 4.32e-07           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.922518233353       residual = 2.10e-07           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.922518232285       residual = 3.10e-08           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.922518239116       residual = 2.78e-08           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.922518237988       residual = 5.14e-08           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.922518237100       residual = 5.97e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         24 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 6.2500e+00 is 8.985337e-05

solving harmonic davidson linear method for identity shift 2.5000e+01, overlap shift 2.5000e+02 and omega -1.7456e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.922516353550       residual = 1.04e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.922516493066       residual = 5.06e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.922516593713       residual = 2.74e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.922516663097       residual = 1.83e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.922516711715       residual = 8.73e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.922516724663       residual = 5.16e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.922516749901       residual = 5.29e-05           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.922516773094       residual = 3.35e-05           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.922516771477       residual = 3.16e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.922516779187       residual = 1.07e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.922516791492       residual = 8.82e-06           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.922516800272       residual = 8.40e-06           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.922516812245       residual = 7.20e-06           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.922516812440       residual = 4.32e-06           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.922516809784       residual = 3.00e-06           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.922516820701       residual = 2.47e-06           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.922516826400       residual = 9.66e-07           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.922516824565       residual = 7.75e-07           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.922516826056       residual = 3.25e-07           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.922516826023       residual = 4.18e-07           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.922516826899       residual = 2.05e-07           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.922516826622       residual = 3.03e-08           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.922516828312       residual = 2.72e-08           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.922516828056       residual = 5.18e-08           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.922516827811       residual = 5.79e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         24 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.5000e+01 is 2.247720e-05

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.422071 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.6448e+01
  </log>
  <optVariables href="H2O.s012.opt.xml">
 uu_0                 2.516855e-01 1 1  ON 0
 uu_1                 1.009101e-01 1 1  ON 1
 uu_2                 1.613580e-02 1 1  ON 2
 uu_3                -3.226181e-02 1 1  ON 3
 uu_4                -6.388850e-02 1 1  ON 4
 uu_5                -8.576274e-02 1 1  ON 5
 uu_6                -1.001266e-01 1 1  ON 6
 uu_7                -1.065413e-01 1 1  ON 7
 uu_8                -9.665544e-02 1 1  ON 8
 uu_9                -6.385115e-02 1 1  ON 9
 ud_0                 3.492451e-01 1 1  ON 10
 ud_1                 1.235616e-01 1 1  ON 11
 ud_2                 2.392949e-02 1 1  ON 12
 ud_3                -3.020118e-02 1 1  ON 13
 ud_4                -6.976245e-02 1 1  ON 14
 ud_5                -9.484642e-02 1 1  ON 15
 ud_6                -1.085609e-01 1 1  ON 16
 ud_7                -1.109758e-01 1 1  ON 17
 ud_8                -9.793152e-02 1 1  ON 18
 ud_9                -6.282523e-02 1 1  ON 19
 eO_0                -5.693344e-01 1 1  ON 20
 eO_1                -3.061035e-01 1 1  ON 21
 eO_2                 4.731459e-02 1 1  ON 22
 eO_3                 2.840840e-01 1 1  ON 23
 eO_4                 3.913594e-01 1 1  ON 24
 eO_5                 3.212067e-01 1 1  ON 25
 eO_6                 1.205980e-01 1 1  ON 26
 eO_7                -7.887759e-02 1 1  ON 27
 eO_8                -1.549065e-01 1 1  ON 28
 eO_9                -6.121635e-02 1 1  ON 29
eH1_0                -2.278043e-01 1 1  ON 30
eH1_1                -1.106798e-01 1 1  ON 31
eH1_2                -6.163214e-02 1 1  ON 32
eH1_3                -2.531737e-02 1 1  ON 33
eH1_4                 4.228947e-03 1 1  ON 34
eH1_5                 2.363579e-02 1 1  ON 35
eH1_6                 6.567945e-02 1 1  ON 36
eH1_7                 1.154606e-01 1 1  ON 37
eH1_8                 1.436119e-01 1 1  ON 38
eH1_9                 7.470956e-02 1 1  ON 39
eH2_0                -2.307196e-01 1 1  ON 40
eH2_1                -1.139371e-01 1 1  ON 41
eH2_2                -6.443104e-02 1 1  ON 42
eH2_3                -2.720789e-02 1 1  ON 43
eH2_4                 1.076365e-03 1 1  ON 44
eH2_5                 2.532904e-02 1 1  ON 45
eH2_6                 7.562912e-02 1 1  ON 46
eH2_7                 1.260007e-01 1 1  ON 47
eH2_8                 1.608823e-01 1 1  ON 48
eH2_9                 6.419705e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 12
    time step          = 0.05
    reference energy   = -16.8831
    reference variance = 0.250386
====================================================
  Execution time = 2.0615e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s012
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6899e+01
  VMC Evar = 2.8992e-01
  Total weights = 2.0000e+06
  Execution time = 1.8854e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.289991168786
                                         uncertainty =       0.002376769474

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.289991168786
                                         uncertainty =       0.002376769474

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000380737320
  error estimate for blocks of size 2^( 2) =       0.000397836538
  error estimate for blocks of size 2^( 3) =       0.000416006932
  error estimate for blocks of size 2^( 4) =       0.000431804346
  error estimate for blocks of size 2^( 5) =       0.000443477211
  error estimate for blocks of size 2^( 6) =       0.000452207518
  error estimate for blocks of size 2^( 7) =       0.000452665161

      target function =      -0.928058611690
              le_mean =     -16.898898276743
             les_mean =     285.862684636037
             stat err =       0.000445038559
             autocorr =       1.366294703271
   target nu stat err =       0.000445038559
   target dn stat err =       0.002510869639
      target stat err =       0.003953390236
              std dev =       0.538443881269
             le_variance =       0.289921813276

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.289995030298
                                         uncertainty =       0.002376914147

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.289995030298
                                         uncertainty =       0.002376914147

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000380739837
  error estimate for blocks of size 2^( 2) =       0.000397835264
  error estimate for blocks of size 2^( 3) =       0.000416004529
  error estimate for blocks of size 2^( 4) =       0.000431801676
  error estimate for blocks of size 2^( 5) =       0.000443473894
  error estimate for blocks of size 2^( 6) =       0.000452204427
  error estimate for blocks of size 2^( 7) =       0.000452660221

      target function =      -0.928052660164
              le_mean =     -16.898897861852
             les_mean =     285.862674447233
             stat err =       0.000445035054
             autocorr =       1.366255118769
   target nu stat err =       0.000445035054
   target dn stat err =       0.002510819131
      target stat err =       0.003953259654
              std dev =       0.538447441149
             le_variance =       0.289925646880

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.289993084056
                                         uncertainty =       0.002376845180

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.289993084056
                                         uncertainty =       0.002376845180

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000380738568
  error estimate for blocks of size 2^( 2) =       0.000397835802
  error estimate for blocks of size 2^( 3) =       0.000416005586
  error estimate for blocks of size 2^( 4) =       0.000431802843
  error estimate for blocks of size 2^( 5) =       0.000443475363
  error estimate for blocks of size 2^( 6) =       0.000452205783
  error estimate for blocks of size 2^( 7) =       0.000452662476

      target function =      -0.928055659632
              le_mean =     -16.898898051781
             les_mean =     285.862678933629
             stat err =       0.000445036616
             autocorr =       1.366273816780
   target nu stat err =       0.000445036616
   target dn stat err =       0.002510844429
      target stat err =       0.003953325027
              std dev =       0.538445646379
             le_variance =       0.289923714105

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.289991403149
                                         uncertainty =       0.002376779040

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.289991403149
                                         uncertainty =       0.002376779040

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000380737472
  error estimate for blocks of size 2^( 2) =       0.000397836439
  error estimate for blocks of size 2^( 3) =       0.000416006755
  error estimate for blocks of size 2^( 4) =       0.000431804148
  error estimate for blocks of size 2^( 5) =       0.000443476970
  error estimate for blocks of size 2^( 6) =       0.000452207290
  error estimate for blocks of size 2^( 7) =       0.000452664814

      target function =      -0.928058250423
              le_mean =     -16.898898247080
             les_mean =     285.862683866006
             stat err =       0.000445038306
             autocorr =       1.366292052950
   target nu stat err =       0.000445038306
   target dn stat err =       0.002510866482
      target stat err =       0.003953382127
              std dev =       0.538444097208
             le_variance =       0.289922045818


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.928058611690        initial  <--
     1.5625e+00     1.5625e+01             3.5854e-04        -0.928052660164
     6.2500e+00     6.2500e+01             8.9853e-05        -0.928055659632
     2.5000e+01     2.5000e+02             2.2477e-05        -0.928058250423

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 30.1510
  </log>
  <optVariables href="H2O.s012.opt.xml">
 uu_0                 2.517234e-01 1 1  ON 0
 uu_1                 1.009441e-01 1 1  ON 1
 uu_2                 1.617093e-02 1 1  ON 2
 uu_3                -3.223671e-02 1 1  ON 3
 uu_4                -6.387119e-02 1 1  ON 4
 uu_5                -8.576630e-02 1 1  ON 5
 uu_6                -1.001313e-01 1 1  ON 6
 uu_7                -1.065674e-01 1 1  ON 7
 uu_8                -9.668736e-02 1 1  ON 8
 uu_9                -6.389514e-02 1 1  ON 9
 ud_0                 3.492133e-01 1 1  ON 10
 ud_1                 1.235408e-01 1 1  ON 11
 ud_2                 2.392773e-02 1 1  ON 12
 ud_3                -3.019580e-02 1 1  ON 13
 ud_4                -6.975611e-02 1 1  ON 14
 ud_5                -9.484109e-02 1 1  ON 15
 ud_6                -1.085597e-01 1 1  ON 16
 ud_7                -1.109505e-01 1 1  ON 17
 ud_8                -9.792102e-02 1 1  ON 18
 ud_9                -6.281974e-02 1 1  ON 19
 eO_0                -5.692888e-01 1 1  ON 20
 eO_1                -3.060845e-01 1 1  ON 21
 eO_2                 4.730119e-02 1 1  ON 22
 eO_3                 2.840621e-01 1 1  ON 23
 eO_4                 3.913446e-01 1 1  ON 24
 eO_5                 3.212387e-01 1 1  ON 25
 eO_6                 1.205696e-01 1 1  ON 26
 eO_7                -7.888695e-02 1 1  ON 27
 eO_8                -1.549102e-01 1 1  ON 28
 eO_9                -6.122097e-02 1 1  ON 29
eH1_0                -2.277697e-01 1 1  ON 30
eH1_1                -1.106400e-01 1 1  ON 31
eH1_2                -6.162960e-02 1 1  ON 32
eH1_3                -2.530664e-02 1 1  ON 33
eH1_4                 4.247617e-03 1 1  ON 34
eH1_5                 2.367087e-02 1 1  ON 35
eH1_6                 6.569464e-02 1 1  ON 36
eH1_7                 1.154364e-01 1 1  ON 37
eH1_8                 1.435220e-01 1 1  ON 38
eH1_9                 7.467402e-02 1 1  ON 39
eH2_0                -2.307044e-01 1 1  ON 40
eH2_1                -1.139386e-01 1 1  ON 41
eH2_2                -6.444547e-02 1 1  ON 42
eH2_3                -2.722676e-02 1 1  ON 43
eH2_4                 1.073413e-03 1 1  ON 44
eH2_5                 2.532960e-02 1 1  ON 45
eH2_6                 7.564495e-02 1 1  ON 46
eH2_7                 1.260030e-01 1 1  ON 47
eH2_8                 1.609125e-01 1 1  ON 48
eH2_9                 6.417207e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.6606e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s013 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s013 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=13  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6896e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 13
    time step          = 0.05
    reference energy   = -16.8744
    reference variance = 0.152691
====================================================
  Execution time = 2.0978e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s013
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6898e+01
  VMC Evar = 2.9264e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.5126e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.292707981595
                                         uncertainty =       0.002713326584

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.292707981595
                                         uncertainty =       0.002713326584

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000382515156
  error estimate for blocks of size 2^( 2) =       0.000399817709
  error estimate for blocks of size 2^( 3) =       0.000417822410
  error estimate for blocks of size 2^( 4) =       0.000433554736
  error estimate for blocks of size 2^( 5) =       0.000445479725
  error estimate for blocks of size 2^( 6) =       0.000452676982
  error estimate for blocks of size 2^( 7) =       0.000457627824

      target function =      -0.923833365331
              le_mean =     -16.897921668699
             les_mean =     285.832392264917
             stat err =       0.000447334817
             autocorr =       1.367628387034
   target nu stat err =       0.000447334817
   target dn stat err =       0.002420354748
      target stat err =       0.003776084081
              std dev =       0.540958121981
             le_variance =       0.292635689737


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.689792166870e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.5625e+01, overlap shift 1.5625e+02 and omega -1.7456e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.923847127333       residual = 7.78e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.923847270544       residual = 3.79e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.923847393934       residual = 1.99e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.923847465310       residual = 2.05e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.923847535636       residual = 6.52e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.923847596120       residual = 7.25e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.923847613612       residual = 6.19e-05           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.923847704016       residual = 7.28e-05           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.923847763572       residual = 7.49e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.923847816645       residual = 4.14e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.923847837815       residual = 2.21e-05           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.923847881663       residual = 1.47e-05           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.923847899588       residual = 8.65e-06           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.923847902263       residual = 6.51e-06           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.923847930943       residual = 6.47e-06           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.923847949041       residual = 3.07e-06           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.923847953767       residual = 1.25e-06           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.923847953412       residual = 1.23e-06           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.923847956753       residual = 7.12e-07           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.923847961208       residual = 5.70e-07           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.923847968525       residual = 4.10e-07           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.923847965154       residual = 1.33e-07           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.923847966804       residual = 8.09e-08           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.923847967008       residual = 5.66e-08           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.923847967439       residual = 3.33e-08           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =      -0.923847967387       residual = 6.02e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         25 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.5625e+01 is 3.954260e-05

solving harmonic davidson linear method for identity shift 6.2500e+01, overlap shift 6.2500e+02 and omega -1.7456e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.923847127333       residual = 7.78e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.923847163263       residual = 3.79e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.923847194229       residual = 1.99e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.923847212135       residual = 2.05e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.923847229743       residual = 6.52e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.923847244886       residual = 7.26e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.923847249274       residual = 6.17e-05           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.923847271942       residual = 7.26e-05           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.923847286830       residual = 7.48e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.923847300132       residual = 4.12e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.923847305415       residual = 2.20e-05           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.923847316374       residual = 1.46e-05           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.923847320850       residual = 8.61e-06           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.923847321510       residual = 6.48e-06           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.923847328687       residual = 6.43e-06           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.923847333192       residual = 3.04e-06           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.923847334365       residual = 1.24e-06           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.923847334270       residual = 1.22e-06           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.923847335104       residual = 7.06e-07           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.923847336216       residual = 5.64e-07           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.923847338038       residual = 4.06e-07           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.923847337196       residual = 1.32e-07           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.923847337607       residual = 8.00e-08           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.923847337651       residual = 6.05e-08           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.923847337760       residual = 3.14e-08           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =      -0.923847337749       residual = 5.92e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         25 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 6.2500e+01 is 9.884637e-06

solving harmonic davidson linear method for identity shift 2.5000e+02, overlap shift 2.5000e+03 and omega -1.7456e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.923847127333       residual = 7.78e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.923847136324       residual = 3.78e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.923847144073       residual = 1.99e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.923847148553       residual = 2.04e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.923847152957       residual = 6.52e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.923847156744       residual = 7.27e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.923847157842       residual = 6.16e-05           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.923847163513       residual = 7.26e-05           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.923847167235       residual = 7.48e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.923847170563       residual = 4.11e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.923847171883       residual = 2.20e-05           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.923847174622       residual = 1.46e-05           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.923847175741       residual = 8.59e-06           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.923847175905       residual = 6.48e-06           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.923847177700       residual = 6.42e-06           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.923847178824       residual = 3.04e-06           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.923847179118       residual = 1.24e-06           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.923847179093       residual = 1.22e-06           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.923847179302       residual = 7.05e-07           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.923847179579       residual = 5.63e-07           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.923847180035       residual = 4.04e-07           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.923847179825       residual = 1.31e-07           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.923847179926       residual = 7.98e-08           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.923847179937       residual = 6.14e-08           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.923847179965       residual = 3.10e-08           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =      -0.923847179962       residual = 5.89e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         25 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.5000e+02 is 2.471096e-06

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.444003 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.6521e+01
  </log>
  <optVariables href="H2O.s013.opt.xml">
 uu_0                 2.517215e-01 1 1  ON 0
 uu_1                 1.009414e-01 1 1  ON 1
 uu_2                 1.616801e-02 1 1  ON 2
 uu_3                -3.223954e-02 1 1  ON 3
 uu_4                -6.387311e-02 1 1  ON 4
 uu_5                -8.576810e-02 1 1  ON 5
 uu_6                -1.001353e-01 1 1  ON 6
 uu_7                -1.065706e-01 1 1  ON 7
 uu_8                -9.669112e-02 1 1  ON 8
 uu_9                -6.389193e-02 1 1  ON 9
 ud_0                 3.492110e-01 1 1  ON 10
 ud_1                 1.235373e-01 1 1  ON 11
 ud_2                 2.392301e-02 1 1  ON 12
 ud_3                -3.020066e-02 1 1  ON 13
 ud_4                -6.976077e-02 1 1  ON 14
 ud_5                -9.484595e-02 1 1  ON 15
 ud_6                -1.085624e-01 1 1  ON 16
 ud_7                -1.109497e-01 1 1  ON 17
 ud_8                -9.791637e-02 1 1  ON 18
 ud_9                -6.281304e-02 1 1  ON 19
 eO_0                -5.692944e-01 1 1  ON 20
 eO_1                -3.060873e-01 1 1  ON 21
 eO_2                 4.730099e-02 1 1  ON 22
 eO_3                 2.840618e-01 1 1  ON 23
 eO_4                 3.913481e-01 1 1  ON 24
 eO_5                 3.212396e-01 1 1  ON 25
 eO_6                 1.205663e-01 1 1  ON 26
 eO_7                -7.889274e-02 1 1  ON 27
 eO_8                -1.549050e-01 1 1  ON 28
 eO_9                -6.121350e-02 1 1  ON 29
eH1_0                -2.277720e-01 1 1  ON 30
eH1_1                -1.106428e-01 1 1  ON 31
eH1_2                -6.163179e-02 1 1  ON 32
eH1_3                -2.530870e-02 1 1  ON 33
eH1_4                 4.244555e-03 1 1  ON 34
eH1_5                 2.366596e-02 1 1  ON 35
eH1_6                 6.569609e-02 1 1  ON 36
eH1_7                 1.154426e-01 1 1  ON 37
eH1_8                 1.435268e-01 1 1  ON 38
eH1_9                 7.467763e-02 1 1  ON 39
eH2_0                -2.307054e-01 1 1  ON 40
eH2_1                -1.139398e-01 1 1  ON 41
eH2_2                -6.444623e-02 1 1  ON 42
eH2_3                -2.722855e-02 1 1  ON 43
eH2_4                 1.072501e-03 1 1  ON 44
eH2_5                 2.532506e-02 1 1  ON 45
eH2_6                 7.564308e-02 1 1  ON 46
eH2_7                 1.259996e-01 1 1  ON 47
eH2_8                 1.609104e-01 1 1  ON 48
eH2_9                 6.418196e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 13
    time step          = 0.05
    reference energy   = -16.931
    reference variance = 0.275128
====================================================
  Execution time = 2.0593e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s013
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6898e+01
  VMC Evar = 2.9613e-01
  Total weights = 2.0000e+06
  Execution time = 1.8784e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.296161622850
                                         uncertainty =       0.003191330027

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.296161622850
                                         uncertainty =       0.003191330027

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000384790397
  error estimate for blocks of size 2^( 2) =       0.000401777989
  error estimate for blocks of size 2^( 3) =       0.000419574436
  error estimate for blocks of size 2^( 4) =       0.000434988817
  error estimate for blocks of size 2^( 5) =       0.000446062691
  error estimate for blocks of size 2^( 6) =       0.000453397040
  error estimate for blocks of size 2^( 7) =       0.000459631800

      target function =      -0.918518025704
              le_mean =     -16.898047402876
             les_mean =     285.840133180454
             stat err =       0.000448520087
             autocorr =       1.358674254794
   target nu stat err =       0.000448520087
   target dn stat err =       0.003118617804
      target stat err =       0.004774777845
              std dev =       0.544175797587
             le_variance =       0.296127298680

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.296163579677
                                         uncertainty =       0.003191547295

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.296163579677
                                         uncertainty =       0.003191547295

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000384791667
  error estimate for blocks of size 2^( 2) =       0.000401778757
  error estimate for blocks of size 2^( 3) =       0.000419574835
  error estimate for blocks of size 2^( 4) =       0.000434989085
  error estimate for blocks of size 2^( 5) =       0.000446062803
  error estimate for blocks of size 2^( 6) =       0.000453397091
  error estimate for blocks of size 2^( 7) =       0.000459631795

      target function =      -0.918515066701
              le_mean =     -16.898047422167
             les_mean =     285.840135787191
             stat err =       0.000448520193
             autocorr =       1.358665930318
   target nu stat err =       0.000448520193
   target dn stat err =       0.003118817949
      target stat err =       0.004775046755
              std dev =       0.544177593672
             le_variance =       0.296129253455

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.296162602704
                                         uncertainty =       0.003191438977

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.296162602704
                                         uncertainty =       0.003191438977

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000384791033
  error estimate for blocks of size 2^( 2) =       0.000401778372
  error estimate for blocks of size 2^( 3) =       0.000419574635
  error estimate for blocks of size 2^( 4) =       0.000434988949
  error estimate for blocks of size 2^( 5) =       0.000446062745
  error estimate for blocks of size 2^( 6) =       0.000453397063
  error estimate for blocks of size 2^( 7) =       0.000459631795

      target function =      -0.918516544017
              le_mean =     -16.898047412389
             les_mean =     285.840134480778
             stat err =       0.000448520138
             autocorr =       1.358670073220
   target nu stat err =       0.000448520138
   target dn stat err =       0.003118718174
      target stat err =       0.004774912721
              std dev =       0.544176696951
             le_variance =       0.296128277505

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.296161745342
                                         uncertainty =       0.003191343655

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.296161745342
                                         uncertainty =       0.003191343655

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000384790476
  error estimate for blocks of size 2^( 2) =       0.000401778036
  error estimate for blocks of size 2^( 3) =       0.000419574461
  error estimate for blocks of size 2^( 4) =       0.000434988833
  error estimate for blocks of size 2^( 5) =       0.000446062698
  error estimate for blocks of size 2^( 6) =       0.000453397043
  error estimate for blocks of size 2^( 7) =       0.000459631799

      target function =      -0.918517840476
              le_mean =     -16.898047404051
             les_mean =     285.840133342519
             stat err =       0.000448520093
             autocorr =       1.358673731415
   target nu stat err =       0.000448520093
   target dn stat err =       0.003118630359
      target stat err =       0.004774794717
              std dev =       0.544175910018
             le_variance =       0.296127421043


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.918518025704        initial  <--
     1.5625e+01     1.5625e+02             3.9543e-05        -0.918515066701
     6.2500e+01     6.2500e+02             9.8846e-06        -0.918516544017
     2.5000e+02     2.5000e+03             2.4711e-06        -0.918517840476

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 30.0843
  </log>
  <optVariables href="H2O.s013.opt.xml">
 uu_0                 2.517234e-01 1 1  ON 0
 uu_1                 1.009441e-01 1 1  ON 1
 uu_2                 1.617093e-02 1 1  ON 2
 uu_3                -3.223671e-02 1 1  ON 3
 uu_4                -6.387119e-02 1 1  ON 4
 uu_5                -8.576630e-02 1 1  ON 5
 uu_6                -1.001313e-01 1 1  ON 6
 uu_7                -1.065674e-01 1 1  ON 7
 uu_8                -9.668736e-02 1 1  ON 8
 uu_9                -6.389514e-02 1 1  ON 9
 ud_0                 3.492133e-01 1 1  ON 10
 ud_1                 1.235408e-01 1 1  ON 11
 ud_2                 2.392773e-02 1 1  ON 12
 ud_3                -3.019580e-02 1 1  ON 13
 ud_4                -6.975611e-02 1 1  ON 14
 ud_5                -9.484109e-02 1 1  ON 15
 ud_6                -1.085597e-01 1 1  ON 16
 ud_7                -1.109505e-01 1 1  ON 17
 ud_8                -9.792102e-02 1 1  ON 18
 ud_9                -6.281974e-02 1 1  ON 19
 eO_0                -5.692888e-01 1 1  ON 20
 eO_1                -3.060845e-01 1 1  ON 21
 eO_2                 4.730119e-02 1 1  ON 22
 eO_3                 2.840621e-01 1 1  ON 23
 eO_4                 3.913446e-01 1 1  ON 24
 eO_5                 3.212387e-01 1 1  ON 25
 eO_6                 1.205696e-01 1 1  ON 26
 eO_7                -7.888695e-02 1 1  ON 27
 eO_8                -1.549102e-01 1 1  ON 28
 eO_9                -6.122097e-02 1 1  ON 29
eH1_0                -2.277697e-01 1 1  ON 30
eH1_1                -1.106400e-01 1 1  ON 31
eH1_2                -6.162960e-02 1 1  ON 32
eH1_3                -2.530664e-02 1 1  ON 33
eH1_4                 4.247617e-03 1 1  ON 34
eH1_5                 2.367087e-02 1 1  ON 35
eH1_6                 6.569464e-02 1 1  ON 36
eH1_7                 1.154364e-01 1 1  ON 37
eH1_8                 1.435220e-01 1 1  ON 38
eH1_9                 7.467402e-02 1 1  ON 39
eH2_0                -2.307044e-01 1 1  ON 40
eH2_1                -1.139386e-01 1 1  ON 41
eH2_2                -6.444547e-02 1 1  ON 42
eH2_3                -2.722676e-02 1 1  ON 43
eH2_4                 1.073413e-03 1 1  ON 44
eH2_5                 2.532960e-02 1 1  ON 45
eH2_6                 7.564495e-02 1 1  ON 46
eH2_7                 1.260030e-01 1 1  ON 47
eH2_8                 1.609125e-01 1 1  ON 48
eH2_9                 6.417207e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.6611e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s014 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s014 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=14  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6897e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 14
    time step          = 0.05
    reference energy   = -16.978
    reference variance = 0.45823
====================================================
  Execution time = 2.0942e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s014
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6899e+01
  VMC Evar = 2.9022e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.5307e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.290215259391
                                         uncertainty =       0.002260579303

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.290215259391
                                         uncertainty =       0.002260579303

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000380932925
  error estimate for blocks of size 2^( 2) =       0.000398027058
  error estimate for blocks of size 2^( 3) =       0.000415326687
  error estimate for blocks of size 2^( 4) =       0.000430603705
  error estimate for blocks of size 2^( 5) =       0.000441187881
  error estimate for blocks of size 2^( 6) =       0.000448338622
  error estimate for blocks of size 2^( 7) =       0.000450230420

      target function =      -0.927582562394
              le_mean =     -16.898549131368
             les_mean =     285.851182386477
             stat err =       0.000442590157
             autocorr =       1.349915176698
   target nu stat err =       0.000442590157
   target dn stat err =       0.002168799365
      target stat err =       0.003428700689
              std dev =       0.538720508540
             le_variance =       0.290219786322


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.689854913137e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.5625e+02, overlap shift 1.5625e+03 and omega -1.7456e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.927593836515       residual = 4.08e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.927593849430       residual = 3.99e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.927593861358       residual = 1.56e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.927593863515       residual = 9.80e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.927593868223       residual = 6.90e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.927593870466       residual = 3.04e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.927593874937       residual = 4.59e-05           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.927593876333       residual = 4.78e-05           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.927593877925       residual = 2.13e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.927593879582       residual = 1.33e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.927593877949       residual = 7.41e-06           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.927593878887       residual = 6.41e-06           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.927593881179       residual = 5.14e-06           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.927593882481       residual = 2.55e-06           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.927593883910       residual = 3.20e-06           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.927593884315       residual = 1.20e-06           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.927593884382       residual = 6.56e-07           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.927593884461       residual = 6.87e-07           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.927593884100       residual = 4.31e-07           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.927593884678       residual = 2.31e-07           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.927593884719       residual = 1.07e-07           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.927593884713       residual = 3.88e-08           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.927593884850       residual = 6.17e-08           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.927593884743       residual = 1.89e-08           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.927593884664       residual = 9.74e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         24 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.5625e+02 is 2.220405e-06

solving harmonic davidson linear method for identity shift 6.2500e+02, overlap shift 6.2500e+03 and omega -1.7456e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.927593836515       residual = 4.08e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.927593839745       residual = 3.99e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.927593842728       residual = 1.56e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.927593843267       residual = 9.79e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.927593844444       residual = 6.90e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.927593845006       residual = 3.04e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.927593846124       residual = 4.59e-05           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.927593846474       residual = 4.77e-05           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.927593846871       residual = 2.13e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.927593847286       residual = 1.33e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.927593846877       residual = 7.41e-06           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.927593847109       residual = 6.40e-06           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.927593847683       residual = 5.13e-06           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.927593848008       residual = 2.54e-06           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.927593848366       residual = 3.20e-06           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.927593848469       residual = 1.20e-06           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.927593848484       residual = 6.55e-07           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.927593848506       residual = 6.86e-07           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.927593848416       residual = 4.30e-07           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.927593848561       residual = 2.30e-07           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.927593848569       residual = 1.07e-07           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.927593848567       residual = 3.87e-08           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.927593848601       residual = 6.17e-08           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.927593848576       residual = 1.89e-08           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.927593848555       residual = 9.73e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         24 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 6.2500e+02 is 5.551122e-07

solving harmonic davidson linear method for identity shift 2.5000e+03, overlap shift 2.5000e+04 and omega -1.7456e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.927593836515       residual = 4.08e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.927593837323       residual = 3.99e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.927593838068       residual = 1.56e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.927593838203       residual = 9.79e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.927593838498       residual = 6.90e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.927593838639       residual = 3.04e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.927593838916       residual = 4.59e-05           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.927593839005       residual = 4.77e-05           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.927593839104       residual = 2.13e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.927593839208       residual = 1.33e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.927593839096       residual = 7.41e-06           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.927593839163       residual = 6.40e-06           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.927593839309       residual = 5.13e-06           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.927593839388       residual = 2.54e-06           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.927593839484       residual = 3.20e-06           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.927593839504       residual = 1.20e-06           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.927593839500       residual = 6.55e-07           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.927593839520       residual = 6.86e-07           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.927593839482       residual = 4.30e-07           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.927593839527       residual = 2.30e-07           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.927593839526       residual = 1.07e-07           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.927593839533       residual = 3.87e-08           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.927593839531       residual = 6.16e-08           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.927593839532       residual = 1.89e-08           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.927593839523       residual = 9.73e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         24 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.5000e+03 is 1.387787e-07

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.463867 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.6499e+01
  </log>
  <optVariables href="H2O.s014.opt.xml">
 uu_0                 2.517233e-01 1 1  ON 0
 uu_1                 1.009439e-01 1 1  ON 1
 uu_2                 1.617068e-02 1 1  ON 2
 uu_3                -3.223689e-02 1 1  ON 3
 uu_4                -6.387121e-02 1 1  ON 4
 uu_5                -8.576615e-02 1 1  ON 5
 uu_6                -1.001312e-01 1 1  ON 6
 uu_7                -1.065670e-01 1 1  ON 7
 uu_8                -9.668729e-02 1 1  ON 8
 uu_9                -6.389513e-02 1 1  ON 9
 ud_0                 3.492137e-01 1 1  ON 10
 ud_1                 1.235410e-01 1 1  ON 11
 ud_2                 2.392790e-02 1 1  ON 12
 ud_3                -3.019574e-02 1 1  ON 13
 ud_4                -6.975619e-02 1 1  ON 14
 ud_5                -9.484119e-02 1 1  ON 15
 ud_6                -1.085598e-01 1 1  ON 16
 ud_7                -1.109505e-01 1 1  ON 17
 ud_8                -9.792113e-02 1 1  ON 18
 ud_9                -6.282004e-02 1 1  ON 19
 eO_0                -5.692891e-01 1 1  ON 20
 eO_1                -3.060845e-01 1 1  ON 21
 eO_2                 4.730140e-02 1 1  ON 22
 eO_3                 2.840623e-01 1 1  ON 23
 eO_4                 3.913451e-01 1 1  ON 24
 eO_5                 3.212388e-01 1 1  ON 25
 eO_6                 1.205694e-01 1 1  ON 26
 eO_7                -7.888738e-02 1 1  ON 27
 eO_8                -1.549103e-01 1 1  ON 28
 eO_9                -6.122094e-02 1 1  ON 29
eH1_0                -2.277697e-01 1 1  ON 30
eH1_1                -1.106400e-01 1 1  ON 31
eH1_2                -6.162965e-02 1 1  ON 32
eH1_3                -2.530672e-02 1 1  ON 33
eH1_4                 4.247519e-03 1 1  ON 34
eH1_5                 2.367081e-02 1 1  ON 35
eH1_6                 6.569490e-02 1 1  ON 36
eH1_7                 1.154364e-01 1 1  ON 37
eH1_8                 1.435217e-01 1 1  ON 38
eH1_9                 7.467438e-02 1 1  ON 39
eH2_0                -2.307045e-01 1 1  ON 40
eH2_1                -1.139388e-01 1 1  ON 41
eH2_2                -6.444562e-02 1 1  ON 42
eH2_3                -2.722707e-02 1 1  ON 43
eH2_4                 1.073153e-03 1 1  ON 44
eH2_5                 2.532931e-02 1 1  ON 45
eH2_6                 7.564521e-02 1 1  ON 46
eH2_7                 1.260035e-01 1 1  ON 47
eH2_8                 1.609128e-01 1 1  ON 48
eH2_9                 6.417226e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 14
    time step          = 0.05
    reference energy   = -16.8566
    reference variance = 0.375294
====================================================
  Execution time = 2.0742e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s014
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6898e+01
  VMC Evar = 3.0058e-01
  Total weights = 2.0000e+06
  Execution time = 1.8839e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.300382153904
                                         uncertainty =       0.007140740679

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.300382153904
                                         uncertainty =       0.007140740679

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000387673201
  error estimate for blocks of size 2^( 2) =       0.000404718249
  error estimate for blocks of size 2^( 3) =       0.000422549030
  error estimate for blocks of size 2^( 4) =       0.000438711803
  error estimate for blocks of size 2^( 5) =       0.000450224137
  error estimate for blocks of size 2^( 6) =       0.000458920324
  error estimate for blocks of size 2^( 7) =       0.000461275895

      target function =      -0.911715442992
              le_mean =     -16.897988135920
             les_mean =     285.842583913477
             stat err =       0.000452283040
             autocorr =       1.361096895552
   target nu stat err =       0.000452283040
   target dn stat err =       0.007523264778
      target stat err =       0.011236496270
              std dev =       0.548252699101
             le_variance =       0.300581022071

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.300382324182
                                         uncertainty =       0.007140753355

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.300382324182
                                         uncertainty =       0.007140753355

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000387673312
  error estimate for blocks of size 2^( 2) =       0.000404718281
  error estimate for blocks of size 2^( 3) =       0.000422548990
  error estimate for blocks of size 2^( 4) =       0.000438711699
  error estimate for blocks of size 2^( 5) =       0.000450223993
  error estimate for blocks of size 2^( 6) =       0.000458920152
  error estimate for blocks of size 2^( 7) =       0.000461275709

      target function =      -0.911715186196
              le_mean =     -16.897988135546
             les_mean =     285.842584072827
             stat err =       0.000452282888
             autocorr =       1.361095206191
   target nu stat err =       0.000452282888
   target dn stat err =       0.007523278758
      target stat err =       0.011236510725
              std dev =       0.548252855971
             le_variance =       0.300581194081

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.300382239071
                                         uncertainty =       0.007140747019

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.300382239071
                                         uncertainty =       0.007140747019

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000387673257
  error estimate for blocks of size 2^( 2) =       0.000404718265
  error estimate for blocks of size 2^( 3) =       0.000422549010
  error estimate for blocks of size 2^( 4) =       0.000438711751
  error estimate for blocks of size 2^( 5) =       0.000450224065
  error estimate for blocks of size 2^( 6) =       0.000458920238
  error estimate for blocks of size 2^( 7) =       0.000461275802

      target function =      -0.911715314551
              le_mean =     -16.897988135732
             les_mean =     285.842583993156
             stat err =       0.000452282964
             autocorr =       1.361096050646
   target nu stat err =       0.000452282964
   target dn stat err =       0.007523271770
      target stat err =       0.011236503500
              std dev =       0.548252777562
             le_variance =       0.300581108104

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.300382164550
                                         uncertainty =       0.007140741471

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.300382164550
                                         uncertainty =       0.007140741471

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000387673208
  error estimate for blocks of size 2^( 2) =       0.000404718251
  error estimate for blocks of size 2^( 3) =       0.000422549027
  error estimate for blocks of size 2^( 4) =       0.000438711797
  error estimate for blocks of size 2^( 5) =       0.000450224128
  error estimate for blocks of size 2^( 6) =       0.000458920313
  error estimate for blocks of size 2^( 7) =       0.000461275883

      target function =      -0.911715426936
              le_mean =     -16.897988135896
             les_mean =     285.842583923434
             stat err =       0.000452283030
             autocorr =       1.361096789931
   target nu stat err =       0.000452283030
   target dn stat err =       0.007523265652
      target stat err =       0.011236497174
              std dev =       0.548252708909
             le_variance =       0.300581032826


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.911715442992        initial  <--
     1.5625e+02     1.5625e+03             2.2204e-06        -0.911715186196
     6.2500e+02     6.2500e+03             5.5511e-07        -0.911715314551
     2.5000e+03     2.5000e+04             1.3878e-07        -0.911715426936

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 33.0311
  </log>
  <optVariables href="H2O.s014.opt.xml">
 uu_0                 2.517234e-01 1 1  ON 0
 uu_1                 1.009441e-01 1 1  ON 1
 uu_2                 1.617093e-02 1 1  ON 2
 uu_3                -3.223671e-02 1 1  ON 3
 uu_4                -6.387119e-02 1 1  ON 4
 uu_5                -8.576630e-02 1 1  ON 5
 uu_6                -1.001313e-01 1 1  ON 6
 uu_7                -1.065674e-01 1 1  ON 7
 uu_8                -9.668736e-02 1 1  ON 8
 uu_9                -6.389514e-02 1 1  ON 9
 ud_0                 3.492133e-01 1 1  ON 10
 ud_1                 1.235408e-01 1 1  ON 11
 ud_2                 2.392773e-02 1 1  ON 12
 ud_3                -3.019580e-02 1 1  ON 13
 ud_4                -6.975611e-02 1 1  ON 14
 ud_5                -9.484109e-02 1 1  ON 15
 ud_6                -1.085597e-01 1 1  ON 16
 ud_7                -1.109505e-01 1 1  ON 17
 ud_8                -9.792102e-02 1 1  ON 18
 ud_9                -6.281974e-02 1 1  ON 19
 eO_0                -5.692888e-01 1 1  ON 20
 eO_1                -3.060845e-01 1 1  ON 21
 eO_2                 4.730119e-02 1 1  ON 22
 eO_3                 2.840621e-01 1 1  ON 23
 eO_4                 3.913446e-01 1 1  ON 24
 eO_5                 3.212387e-01 1 1  ON 25
 eO_6                 1.205696e-01 1 1  ON 26
 eO_7                -7.888695e-02 1 1  ON 27
 eO_8                -1.549102e-01 1 1  ON 28
 eO_9                -6.122097e-02 1 1  ON 29
eH1_0                -2.277697e-01 1 1  ON 30
eH1_1                -1.106400e-01 1 1  ON 31
eH1_2                -6.162960e-02 1 1  ON 32
eH1_3                -2.530664e-02 1 1  ON 33
eH1_4                 4.247617e-03 1 1  ON 34
eH1_5                 2.367087e-02 1 1  ON 35
eH1_6                 6.569464e-02 1 1  ON 36
eH1_7                 1.154364e-01 1 1  ON 37
eH1_8                 1.435220e-01 1 1  ON 38
eH1_9                 7.467402e-02 1 1  ON 39
eH2_0                -2.307044e-01 1 1  ON 40
eH2_1                -1.139386e-01 1 1  ON 41
eH2_2                -6.444547e-02 1 1  ON 42
eH2_3                -2.722676e-02 1 1  ON 43
eH2_4                 1.073413e-03 1 1  ON 44
eH2_5                 2.532960e-02 1 1  ON 45
eH2_6                 7.564495e-02 1 1  ON 46
eH2_7                 1.260030e-01 1 1  ON 47
eH2_8                 1.609125e-01 1 1  ON 48
eH2_9                 6.417207e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.9536e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s015 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s015 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=15  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6898e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 15
    time step          = 0.05
    reference energy   = -16.981
    reference variance = 0.277784
====================================================
  Execution time = 2.1136e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s015
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6898e+01
  VMC Evar = 3.0433e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.5202e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.304382107628
                                         uncertainty =       0.008194045429

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.304382107628
                                         uncertainty =       0.008194045429

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000390083682
  error estimate for blocks of size 2^( 2) =       0.000406869919
  error estimate for blocks of size 2^( 3) =       0.000423891222
  error estimate for blocks of size 2^( 4) =       0.000438833491
  error estimate for blocks of size 2^( 5) =       0.000450046412
  error estimate for blocks of size 2^( 6) =       0.000457680300
  error estimate for blocks of size 2^( 7) =       0.000460437097

      target function =      -0.906127067728
              le_mean =     -16.898293256399
             les_mean =     285.856645385623
             stat err =       0.000451749325
             autocorr =       1.341156494887
   target nu stat err =       0.000451749325
   target dn stat err =       0.008591683100
      target stat err =       0.012676719765
              std dev =       0.551661634092
             le_variance =       0.304330558529


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.689829325640e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.5625e+03, overlap shift 1.5625e+04 and omega -1.7456e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.906302276418       residual = 2.45e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.906302282292       residual = 1.01e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.906302288753       residual = 6.35e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.906302290980       residual = 4.01e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.906302292593       residual = 2.73e-04           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.906302294304       residual = 1.70e-04           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.906302295299       residual = 1.44e-04           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.906302295780       residual = 5.21e-05           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.906302296633       residual = 4.57e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.906302296797       residual = 1.97e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.906302297245       residual = 2.00e-05           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.906302297228       residual = 1.37e-05           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.906302297258       residual = 5.49e-06           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.906302297191       residual = 8.28e-06           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.906302297389       residual = 5.75e-06           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.906302297538       residual = 2.23e-06           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.906302297694       residual = 2.66e-06           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.906302297715       residual = 6.72e-07           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.906302297751       residual = 6.99e-07           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.906302297821       residual = 3.47e-07           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.906302297807       residual = 1.07e-07           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.906302297783       residual = 6.92e-08           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.906302297789       residual = 5.84e-08           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.906302297788       residual = 2.56e-08           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.906302297787       residual = 2.19e-08           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =      -0.906302297786       residual = 4.83e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         25 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.5625e+03 is 3.426685e-07

solving harmonic davidson linear method for identity shift 6.2500e+03, overlap shift 6.2500e+04 and omega -1.7456e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.906302276418       residual = 2.45e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.906302277887       residual = 1.01e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.906302279502       residual = 6.35e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.906302280058       residual = 4.01e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.906302280461       residual = 2.73e-04           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.906302280883       residual = 1.70e-04           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.906302281136       residual = 1.44e-04           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.906302281266       residual = 5.21e-05           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.906302281464       residual = 4.57e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.906302281513       residual = 1.97e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.906302281639       residual = 2.00e-05           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.906302281607       residual = 1.37e-05           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.906302281606       residual = 5.49e-06           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.906302281624       residual = 8.28e-06           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.906302281662       residual = 5.75e-06           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.906302281707       residual = 2.23e-06           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.906302281702       residual = 2.66e-06           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.906302281754       residual = 6.72e-07           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.906302281751       residual = 6.99e-07           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.906302281766       residual = 3.47e-07           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.906302281744       residual = 1.07e-07           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.906302281730       residual = 6.92e-08           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.906302281774       residual = 5.84e-08           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.906302281793       residual = 2.56e-08           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.906302281760       residual = 2.19e-08           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =      -0.906302281770       residual = 4.83e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         25 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 6.2500e+03 is 8.566772e-08

solving harmonic davidson linear method for identity shift 2.5000e+04, overlap shift 2.5000e+05 and omega -1.7456e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.906302276418       residual = 2.45e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.906302276785       residual = 1.01e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.906302277189       residual = 6.35e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.906302277328       residual = 4.01e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.906302277413       residual = 2.73e-04           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.906302277472       residual = 1.70e-04           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.906302277600       residual = 1.44e-04           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.906302277645       residual = 5.21e-05           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.906302277663       residual = 4.57e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.906302277721       residual = 1.97e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.906302277705       residual = 2.00e-05           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.906302277650       residual = 1.37e-05           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.906302277758       residual = 5.49e-06           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.906302277783       residual = 8.28e-06           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.906302277717       residual = 5.75e-06           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.906302277691       residual = 2.23e-06           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.906302277769       residual = 2.66e-06           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.906302277801       residual = 6.72e-07           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.906302277795       residual = 6.99e-07           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.906302277786       residual = 3.47e-07           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.906302277678       residual = 1.07e-07           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.906302277636       residual = 6.92e-08           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.906302277866       residual = 5.84e-08           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.906302277768       residual = 2.56e-08           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.906302277748       residual = 2.19e-08           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =      -0.906302277720       residual = 4.83e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         25 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.5000e+04 is 2.141697e-08

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.485611 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.6685e+01
  </log>
  <optVariables href="H2O.s015.opt.xml">
 uu_0                 2.517234e-01 1 1  ON 0
 uu_1                 1.009441e-01 1 1  ON 1
 uu_2                 1.617090e-02 1 1  ON 2
 uu_3                -3.223674e-02 1 1  ON 3
 uu_4                -6.387118e-02 1 1  ON 4
 uu_5                -8.576624e-02 1 1  ON 5
 uu_6                -1.001313e-01 1 1  ON 6
 uu_7                -1.065673e-01 1 1  ON 7
 uu_8                -9.668736e-02 1 1  ON 8
 uu_9                -6.389514e-02 1 1  ON 9
 ud_0                 3.492133e-01 1 1  ON 10
 ud_1                 1.235408e-01 1 1  ON 11
 ud_2                 2.392775e-02 1 1  ON 12
 ud_3                -3.019579e-02 1 1  ON 13
 ud_4                -6.975612e-02 1 1  ON 14
 ud_5                -9.484112e-02 1 1  ON 15
 ud_6                -1.085597e-01 1 1  ON 16
 ud_7                -1.109505e-01 1 1  ON 17
 ud_8                -9.792103e-02 1 1  ON 18
 ud_9                -6.281975e-02 1 1  ON 19
 eO_0                -5.692887e-01 1 1  ON 20
 eO_1                -3.060845e-01 1 1  ON 21
 eO_2                 4.730121e-02 1 1  ON 22
 eO_3                 2.840621e-01 1 1  ON 23
 eO_4                 3.913445e-01 1 1  ON 24
 eO_5                 3.212388e-01 1 1  ON 25
 eO_6                 1.205696e-01 1 1  ON 26
 eO_7                -7.888697e-02 1 1  ON 27
 eO_8                -1.549102e-01 1 1  ON 28
 eO_9                -6.122097e-02 1 1  ON 29
eH1_0                -2.277697e-01 1 1  ON 30
eH1_1                -1.106400e-01 1 1  ON 31
eH1_2                -6.162958e-02 1 1  ON 32
eH1_3                -2.530661e-02 1 1  ON 33
eH1_4                 4.247671e-03 1 1  ON 34
eH1_5                 2.367085e-02 1 1  ON 35
eH1_6                 6.569459e-02 1 1  ON 36
eH1_7                 1.154364e-01 1 1  ON 37
eH1_8                 1.435220e-01 1 1  ON 38
eH1_9                 7.467406e-02 1 1  ON 39
eH2_0                -2.307044e-01 1 1  ON 40
eH2_1                -1.139386e-01 1 1  ON 41
eH2_2                -6.444545e-02 1 1  ON 42
eH2_3                -2.722673e-02 1 1  ON 43
eH2_4                 1.073458e-03 1 1  ON 44
eH2_5                 2.532959e-02 1 1  ON 45
eH2_6                 7.564490e-02 1 1  ON 46
eH2_7                 1.260029e-01 1 1  ON 47
eH2_8                 1.609125e-01 1 1  ON 48
eH2_9                 6.417210e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 15
    time step          = 0.05
    reference energy   = -16.9077
    reference variance = 0.332269
====================================================
  Execution time = 2.0571e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s015
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6898e+01
  VMC Evar = 3.0564e-01
  Total weights = 2.0000e+06
  Execution time = 1.9571e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.305683665288
                                         uncertainty =       0.007435398673

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.305683665288
                                         uncertainty =       0.007435398673

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000390919283
  error estimate for blocks of size 2^( 2) =       0.000407574415
  error estimate for blocks of size 2^( 3) =       0.000425170993
  error estimate for blocks of size 2^( 4) =       0.000440182585
  error estimate for blocks of size 2^( 5) =       0.000451845951
  error estimate for blocks of size 2^( 6) =       0.000459012030
  error estimate for blocks of size 2^( 7) =       0.000460626088

      target function =      -0.904243810903
              le_mean =     -16.898041366698
             les_mean =     285.849437648872
             stat err =       0.000452916664
             autocorr =       1.342339631896
   target nu stat err =       0.000452916664
   target dn stat err =       0.007566676120
      target stat err =       0.011118120091
              std dev =       0.552843351290
             le_variance =       0.305635771065

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.305683661006
                                         uncertainty =       0.007435392293

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.305683661006
                                         uncertainty =       0.007435392293

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000390919280
  error estimate for blocks of size 2^( 2) =       0.000407574414
  error estimate for blocks of size 2^( 3) =       0.000425170994
  error estimate for blocks of size 2^( 4) =       0.000440182589
  error estimate for blocks of size 2^( 5) =       0.000451845960
  error estimate for blocks of size 2^( 6) =       0.000459012043
  error estimate for blocks of size 2^( 7) =       0.000460626099

      target function =      -0.904243817380
              le_mean =     -16.898041366243
             les_mean =     285.849437629261
             stat err =       0.000452916673
             autocorr =       1.342339704497
   target nu stat err =       0.000452916673
   target dn stat err =       0.007566669527
      target stat err =       0.011118110594
              std dev =       0.552843347436
             le_variance =       0.305635766805

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.305683663147
                                         uncertainty =       0.007435395483

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.305683663147
                                         uncertainty =       0.007435395483

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000390919281
  error estimate for blocks of size 2^( 2) =       0.000407574414
  error estimate for blocks of size 2^( 3) =       0.000425170994
  error estimate for blocks of size 2^( 4) =       0.000440182587
  error estimate for blocks of size 2^( 5) =       0.000451845955
  error estimate for blocks of size 2^( 6) =       0.000459012037
  error estimate for blocks of size 2^( 7) =       0.000460626094

      target function =      -0.904243814142
              le_mean =     -16.898041366470
             les_mean =     285.849437639065
             stat err =       0.000452916668
             autocorr =       1.342339668194
   target nu stat err =       0.000452916668
   target dn stat err =       0.007566672823
      target stat err =       0.011118115343
              std dev =       0.552843349363
             le_variance =       0.305635768935

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.305683665020
                                         uncertainty =       0.007435398274

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.305683665020
                                         uncertainty =       0.007435398274

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000390919282
  error estimate for blocks of size 2^( 2) =       0.000407574415
  error estimate for blocks of size 2^( 3) =       0.000425170993
  error estimate for blocks of size 2^( 4) =       0.000440182585
  error estimate for blocks of size 2^( 5) =       0.000451845951
  error estimate for blocks of size 2^( 6) =       0.000459012031
  error estimate for blocks of size 2^( 7) =       0.000460626089

      target function =      -0.904243811308
              le_mean =     -16.898041366669
             les_mean =     285.849437647646
             stat err =       0.000452916664
             autocorr =       1.342339636431
   target nu stat err =       0.000452916664
   target dn stat err =       0.007566675708
      target stat err =       0.011118119498
              std dev =       0.552843351049
             le_variance =       0.305635770799


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.904243810903        initial
     1.5625e+03     1.5625e+04             3.4267e-07        -0.904243817380  <--
     6.2500e+03     6.2500e+04             8.5668e-08        -0.904243814142
     2.5000e+04     2.5000e+05             2.1417e-08        -0.904243811308

*****************************************************************************
Applying the update for shift_i =   1.5625e+03     and shift_s =   1.5625e+04
*****************************************************************************

  Execution time = 3.0165e+01
  </log>
  <optVariables href="H2O.s015.opt.xml">
 uu_0                 2.517233e-01 1 1  ON 0
 uu_1                 1.009440e-01 1 1  ON 1
 uu_2                 1.617079e-02 1 1  ON 2
 uu_3                -3.223684e-02 1 1  ON 3
 uu_4                -6.387117e-02 1 1  ON 4
 uu_5                -8.576607e-02 1 1  ON 5
 uu_6                -1.001312e-01 1 1  ON 6
 uu_7                -1.065673e-01 1 1  ON 7
 uu_8                -9.668739e-02 1 1  ON 8
 uu_9                -6.389513e-02 1 1  ON 9
 ud_0                 3.492134e-01 1 1  ON 10
 ud_1                 1.235409e-01 1 1  ON 11
 ud_2                 2.392782e-02 1 1  ON 12
 ud_3                -3.019578e-02 1 1  ON 13
 ud_4                -6.975615e-02 1 1  ON 14
 ud_5                -9.484122e-02 1 1  ON 15
 ud_6                -1.085598e-01 1 1  ON 16
 ud_7                -1.109505e-01 1 1  ON 17
 ud_8                -9.792103e-02 1 1  ON 18
 ud_9                -6.281979e-02 1 1  ON 19
 eO_0                -5.692885e-01 1 1  ON 20
 eO_1                -3.060844e-01 1 1  ON 21
 eO_2                 4.730127e-02 1 1  ON 22
 eO_3                 2.840620e-01 1 1  ON 23
 eO_4                 3.913445e-01 1 1  ON 24
 eO_5                 3.212389e-01 1 1  ON 25
 eO_6                 1.205694e-01 1 1  ON 26
 eO_7                -7.888705e-02 1 1  ON 27
 eO_8                -1.549102e-01 1 1  ON 28
 eO_9                -6.122098e-02 1 1  ON 29
eH1_0                -2.277697e-01 1 1  ON 30
eH1_1                -1.106400e-01 1 1  ON 31
eH1_2                -6.162952e-02 1 1  ON 32
eH1_3                -2.530653e-02 1 1  ON 33
eH1_4                 4.247832e-03 1 1  ON 34
eH1_5                 2.367079e-02 1 1  ON 35
eH1_6                 6.569443e-02 1 1  ON 36
eH1_7                 1.154361e-01 1 1  ON 37
eH1_8                 1.435221e-01 1 1  ON 38
eH1_9                 7.467419e-02 1 1  ON 39
eH2_0                -2.307043e-01 1 1  ON 40
eH2_1                -1.139386e-01 1 1  ON 41
eH2_2                -6.444539e-02 1 1  ON 42
eH2_3                -2.722663e-02 1 1  ON 43
eH2_4                 1.073593e-03 1 1  ON 44
eH2_5                 2.532957e-02 1 1  ON 45
eH2_6                 7.564477e-02 1 1  ON 46
eH2_7                 1.260027e-01 1 1  ON 47
eH2_8                 1.609124e-01 1 1  ON 48
eH2_9                 6.417217e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.6856e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s016 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s016 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=16  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6901e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 16
    time step          = 0.05
    reference energy   = -16.8905
    reference variance = 0.260156
====================================================
  Execution time = 2.0987e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s016
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6898e+01
  VMC Evar = 2.9380e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.5093e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.293836939760
                                         uncertainty =       0.002588256607

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.293836939760
                                         uncertainty =       0.002588256607

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000383275876
  error estimate for blocks of size 2^( 2) =       0.000400588223
  error estimate for blocks of size 2^( 3) =       0.000418131538
  error estimate for blocks of size 2^( 4) =       0.000433586741
  error estimate for blocks of size 2^( 5) =       0.000445417167
  error estimate for blocks of size 2^( 6) =       0.000450893705
  error estimate for blocks of size 2^( 7) =       0.000454020942

      target function =      -0.922042907820
              le_mean =     -16.897828080270
             les_mean =     285.830394478226
             stat err =       0.000445979639
             autocorr =       1.353963921342
   target nu stat err =       0.000445979639
   target dn stat err =       0.002916874744
      target stat err =       0.004504997277
              std dev =       0.542033942450
             le_variance =       0.293800794768


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.689782808027e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 3.9062e+02, overlap shift 3.9062e+03 and omega -1.7456e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.922063656737       residual = 1.44e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.922063670227       residual = 5.93e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.922063685324       residual = 3.36e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.922063688914       residual = 1.43e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.922063692681       residual = 1.04e-04           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.922063694444       residual = 8.25e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.922063695641       residual = 3.60e-05           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.922063696210       residual = 3.42e-05           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.922063698477       residual = 1.95e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.922063699588       residual = 1.58e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.922063700262       residual = 1.06e-05           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.922063700891       residual = 7.43e-06           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.922063701471       residual = 4.01e-06           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.922063701274       residual = 3.35e-06           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.922063701564       residual = 2.70e-06           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.922063701612       residual = 1.46e-06           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.922063701551       residual = 5.44e-07           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.922063701621       residual = 6.35e-07           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.922063701579       residual = 3.12e-07           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.922063701580       residual = 2.35e-07           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.922063701530       residual = 1.87e-07           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.922063701676       residual = 8.76e-08           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.922063701740       residual = 3.35e-08           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.922063701707       residual = 1.68e-08           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.922063701741       residual = 1.10e-08           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =      -0.922063701732       residual = 4.81e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         25 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.9062e+02 is 1.302142e-06

solving harmonic davidson linear method for identity shift 1.5625e+03, overlap shift 1.5625e+04 and omega -1.7456e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.922063656737       residual = 1.44e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.922063660110       residual = 5.93e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.922063663885       residual = 3.36e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.922063664782       residual = 1.43e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.922063665720       residual = 1.04e-04           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.922063666167       residual = 8.25e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.922063666468       residual = 3.60e-05           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.922063666608       residual = 3.42e-05           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.922063667171       residual = 1.95e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.922063667450       residual = 1.58e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.922063667622       residual = 1.06e-05           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.922063667778       residual = 7.43e-06           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.922063667922       residual = 4.01e-06           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.922063667877       residual = 3.35e-06           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.922063667945       residual = 2.70e-06           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.922063667955       residual = 1.46e-06           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.922063667941       residual = 5.43e-07           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.922063667960       residual = 6.35e-07           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.922063667944       residual = 3.12e-07           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.922063667961       residual = 2.35e-07           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.922063667935       residual = 1.87e-07           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.922063667972       residual = 8.75e-08           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.922063667996       residual = 3.35e-08           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.922063667985       residual = 1.68e-08           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.922063667989       residual = 1.09e-08           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =      -0.922063667985       residual = 4.81e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         25 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.5625e+03 is 3.255510e-07

solving harmonic davidson linear method for identity shift 6.2500e+03, overlap shift 6.2500e+04 and omega -1.7456e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.922063656737       residual = 1.44e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.922063657580       residual = 5.93e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.922063658524       residual = 3.36e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.922063658748       residual = 1.43e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.922063658985       residual = 1.04e-04           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.922063659095       residual = 8.25e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.922063659164       residual = 3.60e-05           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.922063659204       residual = 3.42e-05           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.922063659339       residual = 1.95e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.922063659407       residual = 1.58e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.922063659462       residual = 1.06e-05           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.922063659494       residual = 7.43e-06           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.922063659546       residual = 4.01e-06           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.922063659515       residual = 3.35e-06           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.922063659552       residual = 2.70e-06           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.922063659548       residual = 1.46e-06           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.922063659533       residual = 5.43e-07           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.922063659547       residual = 6.35e-07           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.922063659552       residual = 3.12e-07           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.922063659536       residual = 2.35e-07           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.922063659537       residual = 1.87e-07           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.922063659550       residual = 8.75e-08           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.922063659527       residual = 3.35e-08           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.922063659568       residual = 1.68e-08           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.922063659549       residual = 1.09e-08           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =      -0.922063659527       residual = 4.81e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         25 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 6.2500e+03 is 8.138871e-08

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.507245 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.6524e+01
  </log>
  <optVariables href="H2O.s016.opt.xml">
 uu_0                 2.517234e-01 1 1  ON 0
 uu_1                 1.009440e-01 1 1  ON 1
 uu_2                 1.617077e-02 1 1  ON 2
 uu_3                -3.223692e-02 1 1  ON 3
 uu_4                -6.387125e-02 1 1  ON 4
 uu_5                -8.576616e-02 1 1  ON 5
 uu_6                -1.001313e-01 1 1  ON 6
 uu_7                -1.065672e-01 1 1  ON 7
 uu_8                -9.668741e-02 1 1  ON 8
 uu_9                -6.389502e-02 1 1  ON 9
 ud_0                 3.492136e-01 1 1  ON 10
 ud_1                 1.235410e-01 1 1  ON 11
 ud_2                 2.392783e-02 1 1  ON 12
 ud_3                -3.019579e-02 1 1  ON 13
 ud_4                -6.975619e-02 1 1  ON 14
 ud_5                -9.484131e-02 1 1  ON 15
 ud_6                -1.085599e-01 1 1  ON 16
 ud_7                -1.109505e-01 1 1  ON 17
 ud_8                -9.792105e-02 1 1  ON 18
 ud_9                -6.281987e-02 1 1  ON 19
 eO_0                -5.692887e-01 1 1  ON 20
 eO_1                -3.060843e-01 1 1  ON 21
 eO_2                 4.730144e-02 1 1  ON 22
 eO_3                 2.840621e-01 1 1  ON 23
 eO_4                 3.913445e-01 1 1  ON 24
 eO_5                 3.212389e-01 1 1  ON 25
 eO_6                 1.205693e-01 1 1  ON 26
 eO_7                -7.888722e-02 1 1  ON 27
 eO_8                -1.549102e-01 1 1  ON 28
 eO_9                -6.122098e-02 1 1  ON 29
eH1_0                -2.277699e-01 1 1  ON 30
eH1_1                -1.106403e-01 1 1  ON 31
eH1_2                -6.162964e-02 1 1  ON 32
eH1_3                -2.530662e-02 1 1  ON 33
eH1_4                 4.247814e-03 1 1  ON 34
eH1_5                 2.367094e-02 1 1  ON 35
eH1_6                 6.569475e-02 1 1  ON 36
eH1_7                 1.154362e-01 1 1  ON 37
eH1_8                 1.435221e-01 1 1  ON 38
eH1_9                 7.467420e-02 1 1  ON 39
eH2_0                -2.307043e-01 1 1  ON 40
eH2_1                -1.139386e-01 1 1  ON 41
eH2_2                -6.444535e-02 1 1  ON 42
eH2_3                -2.722668e-02 1 1  ON 43
eH2_4                 1.073614e-03 1 1  ON 44
eH2_5                 2.532959e-02 1 1  ON 45
eH2_6                 7.564475e-02 1 1  ON 46
eH2_7                 1.260027e-01 1 1  ON 47
eH2_8                 1.609123e-01 1 1  ON 48
eH2_9                 6.417230e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 16
    time step          = 0.05
    reference energy   = -16.9249
    reference variance = 0.200651
====================================================
  Execution time = 2.0357e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s016
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6897e+01
  VMC Evar = 3.0093e-01
  Total weights = 2.0000e+06
  Execution time = 1.8792e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.300984640938
                                         uncertainty =       0.006227249968

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.300984640938
                                         uncertainty =       0.006227249968

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000387896256
  error estimate for blocks of size 2^( 2) =       0.000405070979
  error estimate for blocks of size 2^( 3) =       0.000422926823
  error estimate for blocks of size 2^( 4) =       0.000438413602
  error estimate for blocks of size 2^( 5) =       0.000451020666
  error estimate for blocks of size 2^( 6) =       0.000458927058
  error estimate for blocks of size 2^( 7) =       0.000467319081

      target function =      -0.911221875960
              le_mean =     -16.897493524143
             les_mean =     285.826214259445
             stat err =       0.000453920102
             autocorr =       1.369391586078
   target nu stat err =       0.000453920102
   target dn stat err =       0.006493022901
      target stat err =       0.009685711179
              std dev =       0.548568146586
             le_variance =       0.300927011448

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.300984794086
                                         uncertainty =       0.006227254461

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.300984794086
                                         uncertainty =       0.006227254461

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000387896355
  error estimate for blocks of size 2^( 2) =       0.000405071044
  error estimate for blocks of size 2^( 3) =       0.000422926871
  error estimate for blocks of size 2^( 4) =       0.000438413649
  error estimate for blocks of size 2^( 5) =       0.000451020715
  error estimate for blocks of size 2^( 6) =       0.000458927112
  error estimate for blocks of size 2^( 7) =       0.000467319141

      target function =      -0.911221648267
              le_mean =     -16.897493529333
             les_mean =     285.826214587958
             stat err =       0.000453920154
             autocorr =       1.369391207101
   target nu stat err =       0.000453920154
   target dn stat err =       0.006493028013
      target stat err =       0.009685714031
              std dev =       0.548568286141
             le_variance =       0.300927164560

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.300984717521
                                         uncertainty =       0.006227252215

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.300984717521
                                         uncertainty =       0.006227252215

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000387896306
  error estimate for blocks of size 2^( 2) =       0.000405071011
  error estimate for blocks of size 2^( 3) =       0.000422926847
  error estimate for blocks of size 2^( 4) =       0.000438413625
  error estimate for blocks of size 2^( 5) =       0.000451020691
  error estimate for blocks of size 2^( 6) =       0.000458927085
  error estimate for blocks of size 2^( 7) =       0.000467319111

      target function =      -0.911221762101
              le_mean =     -16.897493526738
             les_mean =     285.826214423711
             stat err =       0.000453920128
             autocorr =       1.369391396572
   target nu stat err =       0.000453920128
   target dn stat err =       0.006493025458
      target stat err =       0.009685712606
              std dev =       0.548568216371
             le_variance =       0.300927088013

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.300984650511
                                         uncertainty =       0.006227250249

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.300984650511
                                         uncertainty =       0.006227250249

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000387896263
  error estimate for blocks of size 2^( 2) =       0.000405070983
  error estimate for blocks of size 2^( 3) =       0.000422926826
  error estimate for blocks of size 2^( 4) =       0.000438413605
  error estimate for blocks of size 2^( 5) =       0.000451020669
  error estimate for blocks of size 2^( 6) =       0.000458927061
  error estimate for blocks of size 2^( 7) =       0.000467319085

      target function =      -0.911221861727
              le_mean =     -16.897493524468
             les_mean =     285.826214279978
             stat err =       0.000453920105
             autocorr =       1.369391562392
   target nu stat err =       0.000453920105
   target dn stat err =       0.006493023221
      target stat err =       0.009685711358
              std dev =       0.548568155309
             le_variance =       0.300927021019


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.911221875960        initial  <--
     3.9062e+02     3.9062e+03             1.3021e-06        -0.911221648267
     1.5625e+03     1.5625e+04             3.2555e-07        -0.911221762101
     6.2500e+03     6.2500e+04             8.1389e-08        -0.911221861727

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 29.8951
  </log>
  <optVariables href="H2O.s016.opt.xml">
 uu_0                 2.517233e-01 1 1  ON 0
 uu_1                 1.009440e-01 1 1  ON 1
 uu_2                 1.617079e-02 1 1  ON 2
 uu_3                -3.223684e-02 1 1  ON 3
 uu_4                -6.387117e-02 1 1  ON 4
 uu_5                -8.576607e-02 1 1  ON 5
 uu_6                -1.001312e-01 1 1  ON 6
 uu_7                -1.065673e-01 1 1  ON 7
 uu_8                -9.668739e-02 1 1  ON 8
 uu_9                -6.389513e-02 1 1  ON 9
 ud_0                 3.492134e-01 1 1  ON 10
 ud_1                 1.235409e-01 1 1  ON 11
 ud_2                 2.392782e-02 1 1  ON 12
 ud_3                -3.019578e-02 1 1  ON 13
 ud_4                -6.975615e-02 1 1  ON 14
 ud_5                -9.484122e-02 1 1  ON 15
 ud_6                -1.085598e-01 1 1  ON 16
 ud_7                -1.109505e-01 1 1  ON 17
 ud_8                -9.792103e-02 1 1  ON 18
 ud_9                -6.281979e-02 1 1  ON 19
 eO_0                -5.692885e-01 1 1  ON 20
 eO_1                -3.060844e-01 1 1  ON 21
 eO_2                 4.730127e-02 1 1  ON 22
 eO_3                 2.840620e-01 1 1  ON 23
 eO_4                 3.913445e-01 1 1  ON 24
 eO_5                 3.212389e-01 1 1  ON 25
 eO_6                 1.205694e-01 1 1  ON 26
 eO_7                -7.888705e-02 1 1  ON 27
 eO_8                -1.549102e-01 1 1  ON 28
 eO_9                -6.122098e-02 1 1  ON 29
eH1_0                -2.277697e-01 1 1  ON 30
eH1_1                -1.106400e-01 1 1  ON 31
eH1_2                -6.162952e-02 1 1  ON 32
eH1_3                -2.530653e-02 1 1  ON 33
eH1_4                 4.247832e-03 1 1  ON 34
eH1_5                 2.367079e-02 1 1  ON 35
eH1_6                 6.569443e-02 1 1  ON 36
eH1_7                 1.154361e-01 1 1  ON 37
eH1_8                 1.435221e-01 1 1  ON 38
eH1_9                 7.467419e-02 1 1  ON 39
eH2_0                -2.307043e-01 1 1  ON 40
eH2_1                -1.139386e-01 1 1  ON 41
eH2_2                -6.444539e-02 1 1  ON 42
eH2_3                -2.722663e-02 1 1  ON 43
eH2_4                 1.073593e-03 1 1  ON 44
eH2_5                 2.532957e-02 1 1  ON 45
eH2_6                 7.564477e-02 1 1  ON 46
eH2_7                 1.260027e-01 1 1  ON 47
eH2_8                 1.609124e-01 1 1  ON 48
eH2_9                 6.417217e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.6425e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s017 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s017 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=17  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6901e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 17
    time step          = 0.05
    reference energy   = -16.8431
    reference variance = 0.192255
====================================================
  Execution time = 2.3069e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s017
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6898e+01
  VMC Evar = 2.9497e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.5203e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.294903681573
                                         uncertainty =       0.003020701138

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.294903681573
                                         uncertainty =       0.003020701138

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000384035208
  error estimate for blocks of size 2^( 2) =       0.000400921678
  error estimate for blocks of size 2^( 3) =       0.000417751670
  error estimate for blocks of size 2^( 4) =       0.000433270825
  error estimate for blocks of size 2^( 5) =       0.000444063072
  error estimate for blocks of size 2^( 6) =       0.000451307232
  error estimate for blocks of size 2^( 7) =       0.000453332223

      target function =      -0.920273484556
              le_mean =     -16.897937077229
             les_mean =     285.835243400543
             stat err =       0.000445493338
             autocorr =       1.345675496255
   target nu stat err =       0.000445493338
   target dn stat err =       0.003080429835
      target stat err =       0.004733829818
              std dev =       0.543107799638
             le_variance =       0.294966082027


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.689793707723e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 3.9062e+03, overlap shift 3.9062e+04 and omega -1.7456e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.920296375439       residual = 1.05e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.920296376419       residual = 4.92e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.920296377055       residual = 1.41e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.920296377296       residual = 1.05e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.920296377458       residual = 8.23e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.920296377735       residual = 5.62e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.920296377964       residual = 5.58e-05           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.920296378147       residual = 8.33e-05           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.920296378264       residual = 4.22e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.920296378505       residual = 3.23e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.920296378664       residual = 2.19e-05           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.920296378828       residual = 1.73e-05           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.920296378951       residual = 7.58e-06           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.920296379029       residual = 6.72e-06           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.920296379080       residual = 2.52e-06           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.920296379067       residual = 2.76e-06           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.920296379078       residual = 1.37e-06           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.920296379088       residual = 8.55e-07           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.920296379086       residual = 3.18e-07           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.920296379091       residual = 3.15e-07           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.920296379074       residual = 1.30e-07           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.920296379088       residual = 5.44e-08           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.920296379093       residual = 1.21e-07           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.920296379102       residual = 2.92e-08           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.920296379100       residual = 2.64e-08           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =      -0.920296379083       residual = 6.81e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         25 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.9062e+03 is 1.871558e-07

solving harmonic davidson linear method for identity shift 1.5625e+04, overlap shift 1.5625e+05 and omega -1.7456e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.920296375439       residual = 1.05e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.920296375684       residual = 4.92e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.920296375843       residual = 1.41e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.920296375903       residual = 1.05e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.920296375945       residual = 8.23e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.920296376013       residual = 5.62e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.920296376072       residual = 5.58e-05           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.920296376117       residual = 8.33e-05           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.920296376144       residual = 4.22e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.920296376234       residual = 3.23e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.920296376252       residual = 2.19e-05           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.920296376293       residual = 1.73e-05           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.920296376304       residual = 7.58e-06           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.920296376336       residual = 6.72e-06           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.920296376367       residual = 2.52e-06           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.920296376336       residual = 2.76e-06           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.920296376357       residual = 1.37e-06           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.920296376314       residual = 8.55e-07           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.920296376353       residual = 3.18e-07           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.920296376359       residual = 3.15e-07           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.920296376427       residual = 1.30e-07           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.920296376289       residual = 5.44e-08           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.920296376340       residual = 1.21e-07           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.920296376419       residual = 2.92e-08           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.920296376364       residual = 2.64e-08           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =      -0.920296376319       residual = 6.81e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         25 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.5625e+04 is 4.678904e-08

solving harmonic davidson linear method for identity shift 6.2500e+04, overlap shift 6.2500e+05 and omega -1.7456e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.920296375439       residual = 1.05e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.920296375500       residual = 4.92e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.920296375540       residual = 1.41e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.920296375534       residual = 1.05e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.920296375593       residual = 8.23e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.920296375550       residual = 5.62e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.920296375597       residual = 5.58e-05           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.920296375608       residual = 8.33e-05           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.920296375615       residual = 4.22e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.920296375631       residual = 3.23e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.920296375725       residual = 2.19e-05           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.920296375566       residual = 1.73e-05           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.920296375840       residual = 7.58e-06           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.920296375580       residual = 6.72e-06           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.920296375726       residual = 2.52e-06           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.920296375616       residual = 2.76e-06           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.920296375839       residual = 1.37e-06           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.920296375644       residual = 8.55e-07           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.920296375690       residual = 3.18e-07           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.920296375889       residual = 3.15e-07           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.920296375856       residual = 1.30e-07           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.920296375450       residual = 5.44e-08           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.920296375811       residual = 1.21e-07           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.920296375733       residual = 2.92e-08           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.920296375495       residual = 2.64e-08           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =      -0.920296375683       residual = 6.81e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         25 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 6.2500e+04 is 1.169727e-08

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.528873 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.8616e+01
  </log>
  <optVariables href="H2O.s017.opt.xml">
 uu_0                 2.517233e-01 1 1  ON 0
 uu_1                 1.009440e-01 1 1  ON 1
 uu_2                 1.617078e-02 1 1  ON 2
 uu_3                -3.223685e-02 1 1  ON 3
 uu_4                -6.387118e-02 1 1  ON 4
 uu_5                -8.576608e-02 1 1  ON 5
 uu_6                -1.001312e-01 1 1  ON 6
 uu_7                -1.065673e-01 1 1  ON 7
 uu_8                -9.668736e-02 1 1  ON 8
 uu_9                -6.389509e-02 1 1  ON 9
 ud_0                 3.492134e-01 1 1  ON 10
 ud_1                 1.235409e-01 1 1  ON 11
 ud_2                 2.392782e-02 1 1  ON 12
 ud_3                -3.019578e-02 1 1  ON 13
 ud_4                -6.975616e-02 1 1  ON 14
 ud_5                -9.484122e-02 1 1  ON 15
 ud_6                -1.085598e-01 1 1  ON 16
 ud_7                -1.109505e-01 1 1  ON 17
 ud_8                -9.792104e-02 1 1  ON 18
 ud_9                -6.281979e-02 1 1  ON 19
 eO_0                -5.692885e-01 1 1  ON 20
 eO_1                -3.060844e-01 1 1  ON 21
 eO_2                 4.730128e-02 1 1  ON 22
 eO_3                 2.840620e-01 1 1  ON 23
 eO_4                 3.913445e-01 1 1  ON 24
 eO_5                 3.212389e-01 1 1  ON 25
 eO_6                 1.205694e-01 1 1  ON 26
 eO_7                -7.888708e-02 1 1  ON 27
 eO_8                -1.549102e-01 1 1  ON 28
 eO_9                -6.122098e-02 1 1  ON 29
eH1_0                -2.277697e-01 1 1  ON 30
eH1_1                -1.106401e-01 1 1  ON 31
eH1_2                -6.162953e-02 1 1  ON 32
eH1_3                -2.530653e-02 1 1  ON 33
eH1_4                 4.247817e-03 1 1  ON 34
eH1_5                 2.367079e-02 1 1  ON 35
eH1_6                 6.569444e-02 1 1  ON 36
eH1_7                 1.154361e-01 1 1  ON 37
eH1_8                 1.435221e-01 1 1  ON 38
eH1_9                 7.467420e-02 1 1  ON 39
eH2_0                -2.307043e-01 1 1  ON 40
eH2_1                -1.139387e-01 1 1  ON 41
eH2_2                -6.444540e-02 1 1  ON 42
eH2_3                -2.722664e-02 1 1  ON 43
eH2_4                 1.073586e-03 1 1  ON 44
eH2_5                 2.532956e-02 1 1  ON 45
eH2_6                 7.564479e-02 1 1  ON 46
eH2_7                 1.260028e-01 1 1  ON 47
eH2_8                 1.609124e-01 1 1  ON 48
eH2_9                 6.417217e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 17
    time step          = 0.05
    reference energy   = -16.896
    reference variance = 0.183855
====================================================
  Execution time = 2.0555e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s017
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6898e+01
  VMC Evar = 2.9314e-01
  Total weights = 2.0000e+06
  Execution time = 1.8759e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.293070193848
                                         uncertainty =       0.002543140364

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.293070193848
                                         uncertainty =       0.002543140364

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000382846422
  error estimate for blocks of size 2^( 2) =       0.000400184302
  error estimate for blocks of size 2^( 3) =       0.000418198962
  error estimate for blocks of size 2^( 4) =       0.000434282478
  error estimate for blocks of size 2^( 5) =       0.000446083794
  error estimate for blocks of size 2^( 6) =       0.000453507948
  error estimate for blocks of size 2^( 7) =       0.000457257791

      target function =      -0.923033772617
              le_mean =     -16.897514089454
             les_mean =     285.819125022375
             stat err =       0.000447783003
             autocorr =       1.367999766469
   target nu stat err =       0.000447783003
   target dn stat err =       0.002714828526
      target stat err =       0.004208636040
              std dev =       0.541426602283
             le_variance =       0.293142765660

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.293070203954
                                         uncertainty =       0.002543140650

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.293070203954
                                         uncertainty =       0.002543140650

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000382846429
  error estimate for blocks of size 2^( 2) =       0.000400184306
  error estimate for blocks of size 2^( 3) =       0.000418198964
  error estimate for blocks of size 2^( 4) =       0.000434282478
  error estimate for blocks of size 2^( 5) =       0.000446083793
  error estimate for blocks of size 2^( 6) =       0.000453507947
  error estimate for blocks of size 2^( 7) =       0.000457257789

      target function =      -0.923033757190
              le_mean =     -16.897514089563
             les_mean =     285.819125036177
             stat err =       0.000447783002
             autocorr =       1.367999714176
   target nu stat err =       0.000447783002
   target dn stat err =       0.002714828747
      target stat err =       0.004208636235
              std dev =       0.541426611620
             le_variance =       0.293142775770

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.293070198901
                                         uncertainty =       0.002543140507

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.293070198901
                                         uncertainty =       0.002543140507

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000382846425
  error estimate for blocks of size 2^( 2) =       0.000400184304
  error estimate for blocks of size 2^( 3) =       0.000418198963
  error estimate for blocks of size 2^( 4) =       0.000434282478
  error estimate for blocks of size 2^( 5) =       0.000446083793
  error estimate for blocks of size 2^( 6) =       0.000453507947
  error estimate for blocks of size 2^( 7) =       0.000457257790

      target function =      -0.923033764903
              le_mean =     -16.897514089508
             les_mean =     285.819125029276
             stat err =       0.000447783002
             autocorr =       1.367999740328
   target nu stat err =       0.000447783002
   target dn stat err =       0.002714828637
      target stat err =       0.004208636138
              std dev =       0.541426606952
             le_variance =       0.293142770715

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.293070194480
                                         uncertainty =       0.002543140382

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.293070194480
                                         uncertainty =       0.002543140382

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000382846422
  error estimate for blocks of size 2^( 2) =       0.000400184303
  error estimate for blocks of size 2^( 3) =       0.000418198962
  error estimate for blocks of size 2^( 4) =       0.000434282478
  error estimate for blocks of size 2^( 5) =       0.000446083794
  error estimate for blocks of size 2^( 6) =       0.000453507948
  error estimate for blocks of size 2^( 7) =       0.000457257791

      target function =      -0.923033771652
              le_mean =     -16.897514089461
             les_mean =     285.819125023237
             stat err =       0.000447783003
             autocorr =       1.367999763204
   target nu stat err =       0.000447783003
   target dn stat err =       0.002714828540
      target stat err =       0.004208636053
              std dev =       0.541426602867
             le_variance =       0.293142766292


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.923033772617        initial  <--
     3.9062e+03     3.9062e+04             1.8716e-07        -0.923033757190
     1.5625e+04     1.5625e+05             4.6789e-08        -0.923033764903
     6.2500e+04     6.2500e+05             1.1697e-08        -0.923033771652

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 30.0347
  </log>
  <optVariables href="H2O.s017.opt.xml">
 uu_0                 2.517233e-01 1 1  ON 0
 uu_1                 1.009440e-01 1 1  ON 1
 uu_2                 1.617079e-02 1 1  ON 2
 uu_3                -3.223684e-02 1 1  ON 3
 uu_4                -6.387117e-02 1 1  ON 4
 uu_5                -8.576607e-02 1 1  ON 5
 uu_6                -1.001312e-01 1 1  ON 6
 uu_7                -1.065673e-01 1 1  ON 7
 uu_8                -9.668739e-02 1 1  ON 8
 uu_9                -6.389513e-02 1 1  ON 9
 ud_0                 3.492134e-01 1 1  ON 10
 ud_1                 1.235409e-01 1 1  ON 11
 ud_2                 2.392782e-02 1 1  ON 12
 ud_3                -3.019578e-02 1 1  ON 13
 ud_4                -6.975615e-02 1 1  ON 14
 ud_5                -9.484122e-02 1 1  ON 15
 ud_6                -1.085598e-01 1 1  ON 16
 ud_7                -1.109505e-01 1 1  ON 17
 ud_8                -9.792103e-02 1 1  ON 18
 ud_9                -6.281979e-02 1 1  ON 19
 eO_0                -5.692885e-01 1 1  ON 20
 eO_1                -3.060844e-01 1 1  ON 21
 eO_2                 4.730127e-02 1 1  ON 22
 eO_3                 2.840620e-01 1 1  ON 23
 eO_4                 3.913445e-01 1 1  ON 24
 eO_5                 3.212389e-01 1 1  ON 25
 eO_6                 1.205694e-01 1 1  ON 26
 eO_7                -7.888705e-02 1 1  ON 27
 eO_8                -1.549102e-01 1 1  ON 28
 eO_9                -6.122098e-02 1 1  ON 29
eH1_0                -2.277697e-01 1 1  ON 30
eH1_1                -1.106400e-01 1 1  ON 31
eH1_2                -6.162952e-02 1 1  ON 32
eH1_3                -2.530653e-02 1 1  ON 33
eH1_4                 4.247832e-03 1 1  ON 34
eH1_5                 2.367079e-02 1 1  ON 35
eH1_6                 6.569443e-02 1 1  ON 36
eH1_7                 1.154361e-01 1 1  ON 37
eH1_8                 1.435221e-01 1 1  ON 38
eH1_9                 7.467419e-02 1 1  ON 39
eH2_0                -2.307043e-01 1 1  ON 40
eH2_1                -1.139386e-01 1 1  ON 41
eH2_2                -6.444539e-02 1 1  ON 42
eH2_3                -2.722663e-02 1 1  ON 43
eH2_4                 1.073593e-03 1 1  ON 44
eH2_5                 2.532957e-02 1 1  ON 45
eH2_6                 7.564477e-02 1 1  ON 46
eH2_7                 1.260027e-01 1 1  ON 47
eH2_8                 1.609124e-01 1 1  ON 48
eH2_9                 6.417217e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.8657e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s018 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s018 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=18  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6900e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 18
    time step          = 0.05
    reference energy   = -16.9243
    reference variance = 0.248416
====================================================
  Execution time = 2.0896e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s018
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6898e+01
  VMC Evar = 2.9392e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.5779e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.293864598042
                                         uncertainty =       0.003698250236

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.293864598042
                                         uncertainty =       0.003698250236

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000383353503
  error estimate for blocks of size 2^( 2) =       0.000400885936
  error estimate for blocks of size 2^( 3) =       0.000418996036
  error estimate for blocks of size 2^( 4) =       0.000434767711
  error estimate for blocks of size 2^( 5) =       0.000446862578
  error estimate for blocks of size 2^( 6) =       0.000454236729
  error estimate for blocks of size 2^( 7) =       0.000459832237

      target function =      -0.921843854561
              le_mean =     -16.897714472343
             les_mean =     285.826674058182
             stat err =       0.000448924814
             autocorr =       1.371350125498
   target nu stat err =       0.000448924814
   target dn stat err =       0.003649802237
      target stat err =       0.005606830464
              std dev =       0.542143722917
             le_variance =       0.293919816298


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.689771447234e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 3.9062e+04, overlap shift 3.9062e+05 and omega -1.7456e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.921876916476       residual = 8.53e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.921876916590       residual = 4.40e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.921876916628       residual = 1.97e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.921876916673       residual = 7.15e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.921876916665       residual = 9.43e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.921876916646       residual = 6.63e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.921876916707       residual = 3.97e-05           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.921876916688       residual = 4.71e-05           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.921876916635       residual = 3.21e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.921876916820       residual = 1.49e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.921876916708       residual = 8.36e-06           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.921876916704       residual = 8.69e-06           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.921876916787       residual = 3.78e-06           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.921876916781       residual = 2.82e-06           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.921876916778       residual = 3.39e-06           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.921876916661       residual = 1.46e-06           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.921876916847       residual = 7.56e-07           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.921876916714       residual = 5.06e-07           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.921876916749       residual = 1.71e-07           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.921876916648       residual = 1.98e-07           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.921876916649       residual = 5.97e-08           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.921876916863       residual = 5.83e-08           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.921876916651       residual = 3.27e-08           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.921876916721       residual = 3.89e-08           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.921876916998       residual = 8.56e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         24 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.9062e+04 is 9.689370e-09

solving harmonic davidson linear method for identity shift 1.5625e+05, overlap shift 1.5625e+06 and omega -1.7456e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.921876916476       residual = 8.53e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.921876916505       residual = 4.40e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.921876916514       residual = 1.97e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.921876916526       residual = 7.15e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.921876916545       residual = 9.43e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.921876916294       residual = 6.63e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.921876916049       residual = 3.97e-05           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.921876916303       residual = 4.71e-05           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.921876916227       residual = 3.21e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.921876916388       residual = 1.49e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.921876916732       residual = 8.36e-06           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.921876916245       residual = 8.69e-06           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.921876916794       residual = 3.78e-06           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.921876917018       residual = 2.82e-06           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.921876916740       residual = 3.39e-06           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.921876916625       residual = 1.46e-06           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.921876916172       residual = 7.56e-07           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.921876914517       residual = 5.06e-07           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.921876915853       residual = 1.71e-07           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.921876916488       residual = 1.98e-07           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.921876916736       residual = 5.97e-08           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.921876916449       residual = 5.83e-08           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.921876916614       residual = 3.27e-08           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.921876916475       residual = 3.89e-08           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.921876917114       residual = 8.56e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         24 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.5625e+05 is 2.422343e-09

solving harmonic davidson linear method for identity shift 6.2500e+05, overlap shift 6.2500e+06 and omega -1.7456e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.921876916476       residual = 8.53e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.921876916483       residual = 4.40e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.921876916486       residual = 1.97e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.921876916475       residual = 7.15e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.921876916521       residual = 9.43e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.921876916838       residual = 6.63e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.921876916613       residual = 3.97e-05           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.921876916356       residual = 4.71e-05           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.921876917563       residual = 3.21e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.921876916545       residual = 1.49e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.921876914075       residual = 8.36e-06           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.921876915846       residual = 8.69e-06           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.921876916409       residual = 3.78e-06           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.921876915908       residual = 2.82e-06           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.921876916692       residual = 3.39e-06           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.921876915800       residual = 1.46e-06           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.921876917298       residual = 7.56e-07           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.921876914410       residual = 5.06e-07           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.921876916633       residual = 1.71e-07           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.921876914395       residual = 1.98e-07           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.921876915116       residual = 5.97e-08           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.921876916554       residual = 5.84e-08           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.921876915302       residual = 3.28e-08           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.921876913293       residual = 3.89e-08           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.921876916201       residual = 8.56e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         24 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 6.2500e+05 is 6.055852e-10

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.548843 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.6500e+01
  </log>
  <optVariables href="H2O.s018.opt.xml">
 uu_0                 2.517233e-01 1 1  ON 0
 uu_1                 1.009440e-01 1 1  ON 1
 uu_2                 1.617079e-02 1 1  ON 2
 uu_3                -3.223684e-02 1 1  ON 3
 uu_4                -6.387117e-02 1 1  ON 4
 uu_5                -8.576607e-02 1 1  ON 5
 uu_6                -1.001312e-01 1 1  ON 6
 uu_7                -1.065673e-01 1 1  ON 7
 uu_8                -9.668739e-02 1 1  ON 8
 uu_9                -6.389513e-02 1 1  ON 9
 ud_0                 3.492134e-01 1 1  ON 10
 ud_1                 1.235409e-01 1 1  ON 11
 ud_2                 2.392782e-02 1 1  ON 12
 ud_3                -3.019578e-02 1 1  ON 13
 ud_4                -6.975615e-02 1 1  ON 14
 ud_5                -9.484122e-02 1 1  ON 15
 ud_6                -1.085598e-01 1 1  ON 16
 ud_7                -1.109505e-01 1 1  ON 17
 ud_8                -9.792103e-02 1 1  ON 18
 ud_9                -6.281979e-02 1 1  ON 19
 eO_0                -5.692885e-01 1 1  ON 20
 eO_1                -3.060844e-01 1 1  ON 21
 eO_2                 4.730128e-02 1 1  ON 22
 eO_3                 2.840620e-01 1 1  ON 23
 eO_4                 3.913445e-01 1 1  ON 24
 eO_5                 3.212389e-01 1 1  ON 25
 eO_6                 1.205694e-01 1 1  ON 26
 eO_7                -7.888705e-02 1 1  ON 27
 eO_8                -1.549102e-01 1 1  ON 28
 eO_9                -6.122098e-02 1 1  ON 29
eH1_0                -2.277697e-01 1 1  ON 30
eH1_1                -1.106401e-01 1 1  ON 31
eH1_2                -6.162952e-02 1 1  ON 32
eH1_3                -2.530653e-02 1 1  ON 33
eH1_4                 4.247831e-03 1 1  ON 34
eH1_5                 2.367080e-02 1 1  ON 35
eH1_6                 6.569443e-02 1 1  ON 36
eH1_7                 1.154361e-01 1 1  ON 37
eH1_8                 1.435221e-01 1 1  ON 38
eH1_9                 7.467419e-02 1 1  ON 39
eH2_0                -2.307043e-01 1 1  ON 40
eH2_1                -1.139386e-01 1 1  ON 41
eH2_2                -6.444539e-02 1 1  ON 42
eH2_3                -2.722663e-02 1 1  ON 43
eH2_4                 1.073593e-03 1 1  ON 44
eH2_5                 2.532957e-02 1 1  ON 45
eH2_6                 7.564477e-02 1 1  ON 46
eH2_7                 1.260027e-01 1 1  ON 47
eH2_8                 1.609124e-01 1 1  ON 48
eH2_9                 6.417217e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 18
    time step          = 0.05
    reference energy   = -16.8416
    reference variance = 0.251431
====================================================
  Execution time = 2.0340e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s018
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6897e+01
  VMC Evar = 3.1087e-01
  Total weights = 2.0000e+06
  Execution time = 1.8804e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.310918053164
                                         uncertainty =       0.016971407920

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.310918053164
                                         uncertainty =       0.016971407920

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000394254915
  error estimate for blocks of size 2^( 2) =       0.000410515336
  error estimate for blocks of size 2^( 3) =       0.000427020906
  error estimate for blocks of size 2^( 4) =       0.000442405772
  error estimate for blocks of size 2^( 5) =       0.000452406024
  error estimate for blocks of size 2^( 6) =       0.000460571554
  error estimate for blocks of size 2^( 7) =       0.000465107766

      target function =      -0.896091558832
              le_mean =     -16.897475665849
             les_mean =     285.835557598989
             stat err =       0.000455122779
             autocorr =       1.332609521223
   target nu stat err =       0.000455122779
   target dn stat err =       0.017006880716
      target stat err =       0.024487718058
              std dev =       0.557560648233
             le_variance =       0.310873876458

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.310918053563
                                         uncertainty =       0.016971407678

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.310918053563
                                         uncertainty =       0.016971407678

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000394254916
  error estimate for blocks of size 2^( 2) =       0.000410515336
  error estimate for blocks of size 2^( 3) =       0.000427020906
  error estimate for blocks of size 2^( 4) =       0.000442405772
  error estimate for blocks of size 2^( 5) =       0.000452406024
  error estimate for blocks of size 2^( 6) =       0.000460571554
  error estimate for blocks of size 2^( 7) =       0.000465107766

      target function =      -0.896091558278
              le_mean =     -16.897475665881
             les_mean =     285.835557600451
             stat err =       0.000455122779
             autocorr =       1.332609520018
   target nu stat err =       0.000455122779
   target dn stat err =       0.017006880472
      target stat err =       0.024487717677
              std dev =       0.557560648590
             le_variance =       0.310873876856

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.310918053364
                                         uncertainty =       0.016971407799

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.310918053364
                                         uncertainty =       0.016971407799

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000394254915
  error estimate for blocks of size 2^( 2) =       0.000410515336
  error estimate for blocks of size 2^( 3) =       0.000427020906
  error estimate for blocks of size 2^( 4) =       0.000442405772
  error estimate for blocks of size 2^( 5) =       0.000452406024
  error estimate for blocks of size 2^( 6) =       0.000460571554
  error estimate for blocks of size 2^( 7) =       0.000465107766

      target function =      -0.896091558555
              le_mean =     -16.897475665865
             les_mean =     285.835557599720
             stat err =       0.000455122779
             autocorr =       1.332609520614
   target nu stat err =       0.000455122779
   target dn stat err =       0.017006880594
      target stat err =       0.024487717868
              std dev =       0.557560648411
             le_variance =       0.310873876657

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.310918053189
                                         uncertainty =       0.016971407905

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.310918053189
                                         uncertainty =       0.016971407905

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000394254915
  error estimate for blocks of size 2^( 2) =       0.000410515336
  error estimate for blocks of size 2^( 3) =       0.000427020906
  error estimate for blocks of size 2^( 4) =       0.000442405772
  error estimate for blocks of size 2^( 5) =       0.000452406024
  error estimate for blocks of size 2^( 6) =       0.000460571554
  error estimate for blocks of size 2^( 7) =       0.000465107766

      target function =      -0.896091558797
              le_mean =     -16.897475665851
             les_mean =     285.835557599080
             stat err =       0.000455122779
             autocorr =       1.332609521146
   target nu stat err =       0.000455122779
   target dn stat err =       0.017006880701
      target stat err =       0.024487718034
              std dev =       0.557560648255
             le_variance =       0.310873876482


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.896091558832        initial  <--
     3.9062e+04     3.9062e+05             9.6894e-09        -0.896091558278
     1.5625e+05     1.5625e+06             2.4223e-09        -0.896091558555
     6.2500e+05     6.2500e+06             6.0559e-10        -0.896091558797

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 29.8355
  </log>
  <optVariables href="H2O.s018.opt.xml">
 uu_0                 2.517233e-01 1 1  ON 0
 uu_1                 1.009440e-01 1 1  ON 1
 uu_2                 1.617079e-02 1 1  ON 2
 uu_3                -3.223684e-02 1 1  ON 3
 uu_4                -6.387117e-02 1 1  ON 4
 uu_5                -8.576607e-02 1 1  ON 5
 uu_6                -1.001312e-01 1 1  ON 6
 uu_7                -1.065673e-01 1 1  ON 7
 uu_8                -9.668739e-02 1 1  ON 8
 uu_9                -6.389513e-02 1 1  ON 9
 ud_0                 3.492134e-01 1 1  ON 10
 ud_1                 1.235409e-01 1 1  ON 11
 ud_2                 2.392782e-02 1 1  ON 12
 ud_3                -3.019578e-02 1 1  ON 13
 ud_4                -6.975615e-02 1 1  ON 14
 ud_5                -9.484122e-02 1 1  ON 15
 ud_6                -1.085598e-01 1 1  ON 16
 ud_7                -1.109505e-01 1 1  ON 17
 ud_8                -9.792103e-02 1 1  ON 18
 ud_9                -6.281979e-02 1 1  ON 19
 eO_0                -5.692885e-01 1 1  ON 20
 eO_1                -3.060844e-01 1 1  ON 21
 eO_2                 4.730127e-02 1 1  ON 22
 eO_3                 2.840620e-01 1 1  ON 23
 eO_4                 3.913445e-01 1 1  ON 24
 eO_5                 3.212389e-01 1 1  ON 25
 eO_6                 1.205694e-01 1 1  ON 26
 eO_7                -7.888705e-02 1 1  ON 27
 eO_8                -1.549102e-01 1 1  ON 28
 eO_9                -6.122098e-02 1 1  ON 29
eH1_0                -2.277697e-01 1 1  ON 30
eH1_1                -1.106400e-01 1 1  ON 31
eH1_2                -6.162952e-02 1 1  ON 32
eH1_3                -2.530653e-02 1 1  ON 33
eH1_4                 4.247832e-03 1 1  ON 34
eH1_5                 2.367079e-02 1 1  ON 35
eH1_6                 6.569443e-02 1 1  ON 36
eH1_7                 1.154361e-01 1 1  ON 37
eH1_8                 1.435221e-01 1 1  ON 38
eH1_9                 7.467419e-02 1 1  ON 39
eH2_0                -2.307043e-01 1 1  ON 40
eH2_1                -1.139386e-01 1 1  ON 41
eH2_2                -6.444539e-02 1 1  ON 42
eH2_3                -2.722663e-02 1 1  ON 43
eH2_4                 1.073593e-03 1 1  ON 44
eH2_5                 2.532957e-02 1 1  ON 45
eH2_6                 7.564477e-02 1 1  ON 46
eH2_7                 1.260027e-01 1 1  ON 47
eH2_8                 1.609124e-01 1 1  ON 48
eH2_9                 6.417217e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.6341e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s019 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s019 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=19  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6899e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 19
    time step          = 0.05
    reference energy   = -17.0159
    reference variance = 0.731398
====================================================
  Execution time = 2.0546e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s019
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6899e+01
  VMC Evar = 2.9187e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.5296e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.291895863088
                                         uncertainty =       0.002607446613

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.291895863088
                                         uncertainty =       0.002607446613

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000382016655
  error estimate for blocks of size 2^( 2) =       0.000399412331
  error estimate for blocks of size 2^( 3) =       0.000417737737
  error estimate for blocks of size 2^( 4) =       0.000433748971
  error estimate for blocks of size 2^( 5) =       0.000447010132
  error estimate for blocks of size 2^( 6) =       0.000454608740
  error estimate for blocks of size 2^( 7) =       0.000458679860

      target function =      -0.925028326741
              le_mean =     -16.898530656360
             les_mean =     285.852211647001
             stat err =       0.000448511926
             autocorr =       1.378425808224
   target nu stat err =       0.000448511926
   target dn stat err =       0.002770971682
      target stat err =       0.004319376654
              std dev =       0.540253134200
             le_variance =       0.291873449012


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.689853065636e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 3.9062e+05, overlap shift 3.9062e+06 and omega -1.7456e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.925046613308       residual = 1.15e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.925046613319       residual = 8.53e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.925046613330       residual = 2.41e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.925046613335       residual = 1.49e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.925046613051       residual = 1.04e-04           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.925046613385       residual = 4.61e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.925046613378       residual = 4.37e-05           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.925046613948       residual = 2.91e-05           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.925046613386       residual = 3.17e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.925046613019       residual = 3.02e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.925046613306       residual = 2.07e-05           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.925046613543       residual = 6.05e-06           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.925046612656       residual = 4.53e-06           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.925046614432       residual = 5.06e-06           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.925046613371       residual = 3.47e-06           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.925046614890       residual = 2.19e-06           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.925046613557       residual = 1.09e-06           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.925046614477       residual = 6.96e-07           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.925046612732       residual = 2.48e-07           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.925046613677       residual = 4.26e-07           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.925046613508       residual = 1.31e-07           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.925046612004       residual = 7.73e-08           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.925046613966       residual = 1.09e-07           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.925046612905       residual = 1.99e-08           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.925046613599       residual = 1.34e-08           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =      -0.925046614933       residual = 6.01e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         25 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.9062e+05 is 1.017949e-09

solving harmonic davidson linear method for identity shift 1.5625e+06, overlap shift 1.5625e+07 and omega -1.7456e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.925046613308       residual = 1.15e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.925046613310       residual = 8.53e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.925046613313       residual = 2.41e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.925046613314       residual = 1.49e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.925046613915       residual = 1.04e-04           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.925046616044       residual = 4.61e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.925046611899       residual = 4.37e-05           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.925046613925       residual = 2.91e-05           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.925046606866       residual = 3.17e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.925046612884       residual = 3.02e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.925046612697       residual = 2.07e-05           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.925046616973       residual = 6.05e-06           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.925046612916       residual = 4.53e-06           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.925046614744       residual = 5.06e-06           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.925046612808       residual = 3.47e-06           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.925046612960       residual = 2.19e-06           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.925046614610       residual = 1.09e-06           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.925046616776       residual = 6.96e-07           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.925046610212       residual = 2.48e-07           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.925046609140       residual = 4.26e-07           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.925046610527       residual = 1.31e-07           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.925046616695       residual = 7.73e-08           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.925046613802       residual = 1.09e-07           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.925046615036       residual = 1.99e-08           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.925046600573       residual = 1.34e-08           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =      -0.925046612858       residual = 6.01e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         25 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.5625e+06 is 2.544876e-10

solving harmonic davidson linear method for identity shift 6.2500e+06, overlap shift 6.2500e+07 and omega -1.7456e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.925046613308       residual = 1.15e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.925046613308       residual = 8.53e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.925046613309       residual = 2.41e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.925046613309       residual = 1.49e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.925046612478       residual = 1.04e-04           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.925046613559       residual = 4.61e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.925046596304       residual = 4.37e-05           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.925046628933       residual = 2.91e-05           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.925046619948       residual = 3.17e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.925046611303       residual = 3.02e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.925046621094       residual = 2.07e-05           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.925046609367       residual = 6.05e-06           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.925046609291       residual = 4.53e-06           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.925046607626       residual = 5.06e-06           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.925046607993       residual = 3.47e-06           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.925046606718       residual = 2.19e-06           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.925046608526       residual = 1.09e-06           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.925046607107       residual = 6.96e-07           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.925046620057       residual = 2.48e-07           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.925046589847       residual = 4.26e-07           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.925046609585       residual = 1.31e-07           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.925046610343       residual = 7.73e-08           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.925046632264       residual = 1.09e-07           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.925046622516       residual = 1.99e-08           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.925046608309       residual = 1.35e-08           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =      -0.925046579025       residual = 6.00e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         25 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 6.2500e+06 is 6.362178e-11

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.570618 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.6104e+01
  </log>
  <optVariables href="H2O.s019.opt.xml">
 uu_0                 2.517233e-01 1 1  ON 0
 uu_1                 1.009440e-01 1 1  ON 1
 uu_2                 1.617079e-02 1 1  ON 2
 uu_3                -3.223684e-02 1 1  ON 3
 uu_4                -6.387117e-02 1 1  ON 4
 uu_5                -8.576607e-02 1 1  ON 5
 uu_6                -1.001312e-01 1 1  ON 6
 uu_7                -1.065673e-01 1 1  ON 7
 uu_8                -9.668739e-02 1 1  ON 8
 uu_9                -6.389513e-02 1 1  ON 9
 ud_0                 3.492134e-01 1 1  ON 10
 ud_1                 1.235409e-01 1 1  ON 11
 ud_2                 2.392782e-02 1 1  ON 12
 ud_3                -3.019578e-02 1 1  ON 13
 ud_4                -6.975615e-02 1 1  ON 14
 ud_5                -9.484122e-02 1 1  ON 15
 ud_6                -1.085598e-01 1 1  ON 16
 ud_7                -1.109505e-01 1 1  ON 17
 ud_8                -9.792103e-02 1 1  ON 18
 ud_9                -6.281979e-02 1 1  ON 19
 eO_0                -5.692885e-01 1 1  ON 20
 eO_1                -3.060844e-01 1 1  ON 21
 eO_2                 4.730127e-02 1 1  ON 22
 eO_3                 2.840620e-01 1 1  ON 23
 eO_4                 3.913445e-01 1 1  ON 24
 eO_5                 3.212389e-01 1 1  ON 25
 eO_6                 1.205694e-01 1 1  ON 26
 eO_7                -7.888705e-02 1 1  ON 27
 eO_8                -1.549102e-01 1 1  ON 28
 eO_9                -6.122098e-02 1 1  ON 29
eH1_0                -2.277697e-01 1 1  ON 30
eH1_1                -1.106400e-01 1 1  ON 31
eH1_2                -6.162952e-02 1 1  ON 32
eH1_3                -2.530653e-02 1 1  ON 33
eH1_4                 4.247832e-03 1 1  ON 34
eH1_5                 2.367079e-02 1 1  ON 35
eH1_6                 6.569443e-02 1 1  ON 36
eH1_7                 1.154361e-01 1 1  ON 37
eH1_8                 1.435221e-01 1 1  ON 38
eH1_9                 7.467419e-02 1 1  ON 39
eH2_0                -2.307043e-01 1 1  ON 40
eH2_1                -1.139386e-01 1 1  ON 41
eH2_2                -6.444539e-02 1 1  ON 42
eH2_3                -2.722663e-02 1 1  ON 43
eH2_4                 1.073593e-03 1 1  ON 44
eH2_5                 2.532957e-02 1 1  ON 45
eH2_6                 7.564477e-02 1 1  ON 46
eH2_7                 1.260027e-01 1 1  ON 47
eH2_8                 1.609124e-01 1 1  ON 48
eH2_9                 6.417217e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 19
    time step          = 0.05
    reference energy   = -16.8291
    reference variance = 0.197888
====================================================
  Execution time = 2.0541e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s019
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6898e+01
  VMC Evar = 3.0298e-01
  Total weights = 2.0000e+06
  Execution time = 1.8833e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.302995682022
                                         uncertainty =       0.006431062256

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.302995682022
                                         uncertainty =       0.006431062256

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000389218310
  error estimate for blocks of size 2^( 2) =       0.000406391360
  error estimate for blocks of size 2^( 3) =       0.000423729378
  error estimate for blocks of size 2^( 4) =       0.000440240857
  error estimate for blocks of size 2^( 5) =       0.000450900304
  error estimate for blocks of size 2^( 6) =       0.000457580180
  error estimate for blocks of size 2^( 7) =       0.000463133986

      target function =      -0.908183175229
              le_mean =     -16.897862441944
             les_mean =     285.840736741712
             stat err =       0.000452963832
             autocorr =       1.354379981098
   target nu stat err =       0.000452963832
   target dn stat err =       0.006529744837
      target stat err =       0.009681794367
              std dev =       0.550437813314
             le_variance =       0.302981786325

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.302995682099
                                         uncertainty =       0.006431062263

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.302995682099
                                         uncertainty =       0.006431062263

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000389218310
  error estimate for blocks of size 2^( 2) =       0.000406391360
  error estimate for blocks of size 2^( 3) =       0.000423729378
  error estimate for blocks of size 2^( 4) =       0.000440240857
  error estimate for blocks of size 2^( 5) =       0.000450900304
  error estimate for blocks of size 2^( 6) =       0.000457580180
  error estimate for blocks of size 2^( 7) =       0.000463133986

      target function =      -0.908183175115
              le_mean =     -16.897862441941
             les_mean =     285.840736741661
             stat err =       0.000452963832
             autocorr =       1.354379980506
   target nu stat err =       0.000452963832
   target dn stat err =       0.006529744844
      target stat err =       0.009681794375
              std dev =       0.550437813384
             le_variance =       0.302981786403

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.302995682061
                                         uncertainty =       0.006431062259

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.302995682061
                                         uncertainty =       0.006431062259

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000389218310
  error estimate for blocks of size 2^( 2) =       0.000406391360
  error estimate for blocks of size 2^( 3) =       0.000423729378
  error estimate for blocks of size 2^( 4) =       0.000440240857
  error estimate for blocks of size 2^( 5) =       0.000450900304
  error estimate for blocks of size 2^( 6) =       0.000457580180
  error estimate for blocks of size 2^( 7) =       0.000463133986

      target function =      -0.908183175172
              le_mean =     -16.897862441943
             les_mean =     285.840736741686
             stat err =       0.000452963832
             autocorr =       1.354379980800
   target nu stat err =       0.000452963832
   target dn stat err =       0.006529744841
      target stat err =       0.009681794371
              std dev =       0.550437813349
             le_variance =       0.302981786364

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.302995682027
                                         uncertainty =       0.006431062256

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.302995682027
                                         uncertainty =       0.006431062256

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000389218310
  error estimate for blocks of size 2^( 2) =       0.000406391360
  error estimate for blocks of size 2^( 3) =       0.000423729378
  error estimate for blocks of size 2^( 4) =       0.000440240857
  error estimate for blocks of size 2^( 5) =       0.000450900304
  error estimate for blocks of size 2^( 6) =       0.000457580180
  error estimate for blocks of size 2^( 7) =       0.000463133986

      target function =      -0.908183175222
              le_mean =     -16.897862441944
             les_mean =     285.840736741709
             stat err =       0.000452963832
             autocorr =       1.354379981056
   target nu stat err =       0.000452963832
   target dn stat err =       0.006529744837
      target stat err =       0.009681794367
              std dev =       0.550437813318
             le_variance =       0.302981786330


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.908183175229        initial  <--
     3.9062e+05     3.9062e+06             1.0179e-09        -0.908183175115
     1.5625e+06     1.5625e+07             2.5449e-10        -0.908183175172
     6.2500e+06     6.2500e+07             6.3622e-11        -0.908183175222

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 30.0754
  </log>
  <optVariables href="H2O.s019.opt.xml">
 uu_0                 2.517233e-01 1 1  ON 0
 uu_1                 1.009440e-01 1 1  ON 1
 uu_2                 1.617079e-02 1 1  ON 2
 uu_3                -3.223684e-02 1 1  ON 3
 uu_4                -6.387117e-02 1 1  ON 4
 uu_5                -8.576607e-02 1 1  ON 5
 uu_6                -1.001312e-01 1 1  ON 6
 uu_7                -1.065673e-01 1 1  ON 7
 uu_8                -9.668739e-02 1 1  ON 8
 uu_9                -6.389513e-02 1 1  ON 9
 ud_0                 3.492134e-01 1 1  ON 10
 ud_1                 1.235409e-01 1 1  ON 11
 ud_2                 2.392782e-02 1 1  ON 12
 ud_3                -3.019578e-02 1 1  ON 13
 ud_4                -6.975615e-02 1 1  ON 14
 ud_5                -9.484122e-02 1 1  ON 15
 ud_6                -1.085598e-01 1 1  ON 16
 ud_7                -1.109505e-01 1 1  ON 17
 ud_8                -9.792103e-02 1 1  ON 18
 ud_9                -6.281979e-02 1 1  ON 19
 eO_0                -5.692885e-01 1 1  ON 20
 eO_1                -3.060844e-01 1 1  ON 21
 eO_2                 4.730127e-02 1 1  ON 22
 eO_3                 2.840620e-01 1 1  ON 23
 eO_4                 3.913445e-01 1 1  ON 24
 eO_5                 3.212389e-01 1 1  ON 25
 eO_6                 1.205694e-01 1 1  ON 26
 eO_7                -7.888705e-02 1 1  ON 27
 eO_8                -1.549102e-01 1 1  ON 28
 eO_9                -6.122098e-02 1 1  ON 29
eH1_0                -2.277697e-01 1 1  ON 30
eH1_1                -1.106400e-01 1 1  ON 31
eH1_2                -6.162952e-02 1 1  ON 32
eH1_3                -2.530653e-02 1 1  ON 33
eH1_4                 4.247832e-03 1 1  ON 34
eH1_5                 2.367079e-02 1 1  ON 35
eH1_6                 6.569443e-02 1 1  ON 36
eH1_7                 1.154361e-01 1 1  ON 37
eH1_8                 1.435221e-01 1 1  ON 38
eH1_9                 7.467419e-02 1 1  ON 39
eH2_0                -2.307043e-01 1 1  ON 40
eH2_1                -1.139386e-01 1 1  ON 41
eH2_2                -6.444539e-02 1 1  ON 42
eH2_3                -2.722663e-02 1 1  ON 43
eH2_4                 1.073593e-03 1 1  ON 44
eH2_5                 2.532957e-02 1 1  ON 45
eH2_6                 7.564477e-02 1 1  ON 46
eH2_7                 1.260027e-01 1 1  ON 47
eH2_8                 1.609124e-01 1 1  ON 48
eH2_9                 6.417217e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.6186e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s020 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s020 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=20  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6900e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 20
    time step          = 0.05
    reference energy   = -16.8527
    reference variance = 0.256755
====================================================
  Execution time = 2.2854e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s020
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6898e+01
  VMC Evar = 3.0667e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.5850e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.306638819593
                                         uncertainty =       0.009534011382

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.306638819593
                                         uncertainty =       0.009534011382

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000391579990
  error estimate for blocks of size 2^( 2) =       0.000408492592
  error estimate for blocks of size 2^( 3) =       0.000425304796
  error estimate for blocks of size 2^( 4) =       0.000439870361
  error estimate for blocks of size 2^( 5) =       0.000450642733
  error estimate for blocks of size 2^( 6) =       0.000456347563
  error estimate for blocks of size 2^( 7) =       0.000460897371

      target function =      -0.902650625980
              le_mean =     -16.898407072339
             les_mean =     285.862831206425
             stat err =       0.000451939507
             autocorr =       1.332047259071
   target nu stat err =       0.000451939507
   target dn stat err =       0.009692664017
      target stat err =       0.014190314854
              std dev =       0.553777732745
             le_variance =       0.306669777284


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.689840707234e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 3.9062e+06, overlap shift 3.9062e+07 and omega -1.7456e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.902870251638       residual = 6.98e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.902870251646       residual = 4.23e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.902870251653       residual = 2.47e-03           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.902870251784       residual = 2.07e-03           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.902870251987       residual = 1.50e-03           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.902870254900       residual = 1.25e-03           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.902870245237       residual = 4.80e-04           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.902870239515       residual = 7.86e-04           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.902870258700       residual = 3.08e-04           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.902870255542       residual = 3.02e-04           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.902870244902       residual = 1.94e-04           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.902870253683       residual = 7.23e-05           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.902870248068       residual = 5.84e-05           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.902870261259       residual = 4.20e-05           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.902870256900       residual = 5.43e-05           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.902870264831       residual = 1.67e-05           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.902870249542       residual = 1.17e-05           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.902870250400       residual = 1.20e-05           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.902870247551       residual = 7.76e-06           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.902870247049       residual = 4.60e-06           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.902870263532       residual = 2.30e-06           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.902870260209       residual = 1.45e-06           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.902870246413       residual = 1.08e-06           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.902870236331       residual = 2.49e-07           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.902870261965       residual = 9.64e-08           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =      -0.902870259869       residual = 2.54e-08           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   tar_fn =      -0.902870258688       residual = 2.28e-08           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   tar_fn =      -0.902870249397       residual = 4.96e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         27 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.9062e+06 is 5.522403e-10

solving harmonic davidson linear method for identity shift 1.5625e+07, overlap shift 1.5625e+08 and omega -1.7456e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.902870251638       residual = 6.98e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.902870251640       residual = 4.23e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.902870251642       residual = 2.47e-03           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.902870251643       residual = 2.07e-03           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.902870260231       residual = 1.50e-03           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.902870262072       residual = 1.25e-03           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.902870239541       residual = 4.80e-04           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.902870226525       residual = 7.86e-04           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.902870256077       residual = 3.08e-04           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.902870226756       residual = 3.02e-04           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.902870249276       residual = 1.94e-04           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.902870278070       residual = 7.23e-05           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.902870225362       residual = 5.84e-05           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.902870240478       residual = 4.20e-05           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.902870285790       residual = 5.43e-05           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.902870201392       residual = 1.67e-05           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.902870239050       residual = 1.17e-05           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.902870189069       residual = 1.20e-05           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.902870227225       residual = 7.76e-06           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.902870191266       residual = 4.60e-06           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.902870285484       residual = 2.30e-06           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.902870266144       residual = 1.45e-06           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.902870229973       residual = 1.08e-06           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.902870238068       residual = 2.49e-07           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.902870321166       residual = 9.64e-08           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =      -0.902870310453       residual = 2.54e-08           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   tar_fn =      -0.902870356629       residual = 2.28e-08           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   tar_fn =      -0.902870248019       residual = 4.96e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         27 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.5625e+07 is 1.380609e-10

solving harmonic davidson linear method for identity shift 6.2500e+07, overlap shift 6.2500e+08 and omega -1.7456e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.902870251638       residual = 6.98e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.902870251639       residual = 4.23e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.902870251639       residual = 2.47e-03           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.902870251639       residual = 2.07e-03           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.902870251640       residual = 1.50e-03           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.902870251687       residual = 1.25e-03           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.902870133438       residual = 4.80e-04           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.902870320365       residual = 7.86e-04           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.902870161286       residual = 3.08e-04           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.902870132074       residual = 3.02e-04           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.902870119714       residual = 1.94e-04           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.902870305823       residual = 7.23e-05           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.902870316091       residual = 5.84e-05           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.902870285616       residual = 4.20e-05           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.902870236344       residual = 5.43e-05           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.902870380398       residual = 1.67e-05           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.902870177853       residual = 1.17e-05           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.902869930494       residual = 1.20e-05           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.902870381568       residual = 7.76e-06           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.902870082582       residual = 4.60e-06           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.902870012310       residual = 2.30e-06           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.902870235570       residual = 1.45e-06           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.902870324660       residual = 1.08e-06           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.902870147608       residual = 2.49e-07           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.902870294706       residual = 9.63e-08           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =      -0.902870148881       residual = 2.55e-08           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   tar_fn =      -0.902870136365       residual = 2.28e-08           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   tar_fn =      -0.902870125477       residual = 4.97e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         27 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 6.2500e+07 is 3.451467e-11

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.596499 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.8470e+01
  </log>
  <optVariables href="H2O.s020.opt.xml">
 uu_0                 2.517233e-01 1 1  ON 0
 uu_1                 1.009440e-01 1 1  ON 1
 uu_2                 1.617079e-02 1 1  ON 2
 uu_3                -3.223684e-02 1 1  ON 3
 uu_4                -6.387117e-02 1 1  ON 4
 uu_5                -8.576607e-02 1 1  ON 5
 uu_6                -1.001312e-01 1 1  ON 6
 uu_7                -1.065673e-01 1 1  ON 7
 uu_8                -9.668739e-02 1 1  ON 8
 uu_9                -6.389513e-02 1 1  ON 9
 ud_0                 3.492134e-01 1 1  ON 10
 ud_1                 1.235409e-01 1 1  ON 11
 ud_2                 2.392782e-02 1 1  ON 12
 ud_3                -3.019578e-02 1 1  ON 13
 ud_4                -6.975615e-02 1 1  ON 14
 ud_5                -9.484122e-02 1 1  ON 15
 ud_6                -1.085598e-01 1 1  ON 16
 ud_7                -1.109505e-01 1 1  ON 17
 ud_8                -9.792103e-02 1 1  ON 18
 ud_9                -6.281979e-02 1 1  ON 19
 eO_0                -5.692885e-01 1 1  ON 20
 eO_1                -3.060844e-01 1 1  ON 21
 eO_2                 4.730127e-02 1 1  ON 22
 eO_3                 2.840620e-01 1 1  ON 23
 eO_4                 3.913445e-01 1 1  ON 24
 eO_5                 3.212389e-01 1 1  ON 25
 eO_6                 1.205694e-01 1 1  ON 26
 eO_7                -7.888705e-02 1 1  ON 27
 eO_8                -1.549102e-01 1 1  ON 28
 eO_9                -6.122098e-02 1 1  ON 29
eH1_0                -2.277697e-01 1 1  ON 30
eH1_1                -1.106400e-01 1 1  ON 31
eH1_2                -6.162952e-02 1 1  ON 32
eH1_3                -2.530653e-02 1 1  ON 33
eH1_4                 4.247832e-03 1 1  ON 34
eH1_5                 2.367079e-02 1 1  ON 35
eH1_6                 6.569443e-02 1 1  ON 36
eH1_7                 1.154361e-01 1 1  ON 37
eH1_8                 1.435221e-01 1 1  ON 38
eH1_9                 7.467419e-02 1 1  ON 39
eH2_0                -2.307043e-01 1 1  ON 40
eH2_1                -1.139386e-01 1 1  ON 41
eH2_2                -6.444539e-02 1 1  ON 42
eH2_3                -2.722663e-02 1 1  ON 43
eH2_4                 1.073593e-03 1 1  ON 44
eH2_5                 2.532957e-02 1 1  ON 45
eH2_6                 7.564477e-02 1 1  ON 46
eH2_7                 1.260027e-01 1 1  ON 47
eH2_8                 1.609124e-01 1 1  ON 48
eH2_9                 6.417217e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 20
    time step          = 0.05
    reference energy   = -16.9461
    reference variance = 0.269224
====================================================
  Execution time = 2.0350e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s020
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6899e+01
  VMC Evar = 2.9869e-01
  Total weights = 2.0000e+06
  Execution time = 1.8833e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.298722259963
                                         uncertainty =       0.004560269729

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.298722259963
                                         uncertainty =       0.004560269729

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000386454034
  error estimate for blocks of size 2^( 2) =       0.000403489392
  error estimate for blocks of size 2^( 3) =       0.000420685453
  error estimate for blocks of size 2^( 4) =       0.000436336427
  error estimate for blocks of size 2^( 5) =       0.000447268803
  error estimate for blocks of size 2^( 6) =       0.000454761904
  error estimate for blocks of size 2^( 7) =       0.000459097499

      target function =      -0.914648655786
              le_mean =     -16.898791110913
             les_mean =     285.867834302262
             stat err =       0.000449366158
             autocorr =       1.352088234987
   target nu stat err =       0.000449366158
   target dn stat err =       0.004558442722
      target stat err =       0.006886235301
              std dev =       0.546528536615
             le_variance =       0.298693441334

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.298722259983
                                         uncertainty =       0.004560269730

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.298722259983
                                         uncertainty =       0.004560269730

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000386454034
  error estimate for blocks of size 2^( 2) =       0.000403489392
  error estimate for blocks of size 2^( 3) =       0.000420685453
  error estimate for blocks of size 2^( 4) =       0.000436336427
  error estimate for blocks of size 2^( 5) =       0.000447268803
  error estimate for blocks of size 2^( 6) =       0.000454761904
  error estimate for blocks of size 2^( 7) =       0.000459097499

      target function =      -0.914648655756
              le_mean =     -16.898791110912
             les_mean =     285.867834302255
             stat err =       0.000449366158
             autocorr =       1.352088235017
   target nu stat err =       0.000449366158
   target dn stat err =       0.004558442723
      target stat err =       0.006886235301
              std dev =       0.546528536633
             le_variance =       0.298693441354

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.298722259973
                                         uncertainty =       0.004560269729

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.298722259973
                                         uncertainty =       0.004560269729

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000386454034
  error estimate for blocks of size 2^( 2) =       0.000403489392
  error estimate for blocks of size 2^( 3) =       0.000420685453
  error estimate for blocks of size 2^( 4) =       0.000436336427
  error estimate for blocks of size 2^( 5) =       0.000447268803
  error estimate for blocks of size 2^( 6) =       0.000454761904
  error estimate for blocks of size 2^( 7) =       0.000459097499

      target function =      -0.914648655771
              le_mean =     -16.898791110913
             les_mean =     285.867834302258
             stat err =       0.000449366158
             autocorr =       1.352088235008
   target nu stat err =       0.000449366158
   target dn stat err =       0.004558442722
      target stat err =       0.006886235301
              std dev =       0.546528536624
             le_variance =       0.298693441344

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.298722259964
                                         uncertainty =       0.004560269729

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.298722259964
                                         uncertainty =       0.004560269729

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000386454034
  error estimate for blocks of size 2^( 2) =       0.000403489392
  error estimate for blocks of size 2^( 3) =       0.000420685453
  error estimate for blocks of size 2^( 4) =       0.000436336427
  error estimate for blocks of size 2^( 5) =       0.000447268803
  error estimate for blocks of size 2^( 6) =       0.000454761904
  error estimate for blocks of size 2^( 7) =       0.000459097499

      target function =      -0.914648655784
              le_mean =     -16.898791110913
             les_mean =     285.867834302262
             stat err =       0.000449366158
             autocorr =       1.352088234994
   target nu stat err =       0.000449366158
   target dn stat err =       0.004558442722
      target stat err =       0.006886235301
              std dev =       0.546528536616
             le_variance =       0.298693441336


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.914648655786        initial  <--
     3.9062e+06     3.9062e+07             5.5224e-10        -0.914648655756
     1.5625e+07     1.5625e+08             1.3806e-10        -0.914648655771
     6.2500e+07     6.2500e+08             3.4515e-11        -0.914648655784

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 29.8764
  </log>
  <optVariables href="H2O.s020.opt.xml">
 uu_0                 2.517233e-01 1 1  ON 0
 uu_1                 1.009440e-01 1 1  ON 1
 uu_2                 1.617079e-02 1 1  ON 2
 uu_3                -3.223684e-02 1 1  ON 3
 uu_4                -6.387117e-02 1 1  ON 4
 uu_5                -8.576607e-02 1 1  ON 5
 uu_6                -1.001312e-01 1 1  ON 6
 uu_7                -1.065673e-01 1 1  ON 7
 uu_8                -9.668739e-02 1 1  ON 8
 uu_9                -6.389513e-02 1 1  ON 9
 ud_0                 3.492134e-01 1 1  ON 10
 ud_1                 1.235409e-01 1 1  ON 11
 ud_2                 2.392782e-02 1 1  ON 12
 ud_3                -3.019578e-02 1 1  ON 13
 ud_4                -6.975615e-02 1 1  ON 14
 ud_5                -9.484122e-02 1 1  ON 15
 ud_6                -1.085598e-01 1 1  ON 16
 ud_7                -1.109505e-01 1 1  ON 17
 ud_8                -9.792103e-02 1 1  ON 18
 ud_9                -6.281979e-02 1 1  ON 19
 eO_0                -5.692885e-01 1 1  ON 20
 eO_1                -3.060844e-01 1 1  ON 21
 eO_2                 4.730127e-02 1 1  ON 22
 eO_3                 2.840620e-01 1 1  ON 23
 eO_4                 3.913445e-01 1 1  ON 24
 eO_5                 3.212389e-01 1 1  ON 25
 eO_6                 1.205694e-01 1 1  ON 26
 eO_7                -7.888705e-02 1 1  ON 27
 eO_8                -1.549102e-01 1 1  ON 28
 eO_9                -6.122098e-02 1 1  ON 29
eH1_0                -2.277697e-01 1 1  ON 30
eH1_1                -1.106400e-01 1 1  ON 31
eH1_2                -6.162952e-02 1 1  ON 32
eH1_3                -2.530653e-02 1 1  ON 33
eH1_4                 4.247832e-03 1 1  ON 34
eH1_5                 2.367079e-02 1 1  ON 35
eH1_6                 6.569443e-02 1 1  ON 36
eH1_7                 1.154361e-01 1 1  ON 37
eH1_8                 1.435221e-01 1 1  ON 38
eH1_9                 7.467419e-02 1 1  ON 39
eH2_0                -2.307043e-01 1 1  ON 40
eH2_1                -1.139386e-01 1 1  ON 41
eH2_2                -6.444539e-02 1 1  ON 42
eH2_3                -2.722663e-02 1 1  ON 43
eH2_4                 1.073593e-03 1 1  ON 44
eH2_5                 2.532957e-02 1 1  ON 45
eH2_6                 7.564477e-02 1 1  ON 46
eH2_7                 1.260027e-01 1 1  ON 47
eH2_8                 1.609124e-01 1 1  ON 48
eH2_9                 6.417217e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.8352e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s021 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s021 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=21  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6900e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 21
    time step          = 0.05
    reference energy   = -16.918
    reference variance = 0.163282
====================================================
  Execution time = 2.0899e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s021
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6899e+01
  VMC Evar = 2.9472e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.5035e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.294756080312
                                         uncertainty =       0.003365517249

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.294756080312
                                         uncertainty =       0.003365517249

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000383872076
  error estimate for blocks of size 2^( 2) =       0.000401248941
  error estimate for blocks of size 2^( 3) =       0.000418676274
  error estimate for blocks of size 2^( 4) =       0.000435092639
  error estimate for blocks of size 2^( 5) =       0.000446832003
  error estimate for blocks of size 2^( 6) =       0.000456116543
  error estimate for blocks of size 2^( 7) =       0.000459676263

      target function =      -0.920703354380
              le_mean =     -16.899219961081
             les_mean =     285.878350687754
             stat err =       0.000449429362
             autocorr =       1.370723444572
   target nu stat err =       0.000449429362
   target dn stat err =       0.003436725242
      target stat err =       0.005286814122
              std dev =       0.542877096684
             le_variance =       0.294715542104


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.689921996108e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 3.9062e+07, overlap shift 3.9062e+08 and omega -1.7456e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.920732220664       residual = 1.05e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.920732220664       residual = 6.08e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.920732220664       residual = 6.03e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.920732220664       residual = 2.31e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.920732220664       residual = 2.85e-04           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.920732220664       residual = 2.53e-04           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.920732220664       residual = 1.19e-04           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.920732260283       residual = 6.16e-05           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.920732293599       residual = 4.36e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.920732180466       residual = 3.01e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.920732306728       residual = 4.78e-05           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.920732059985       residual = 1.75e-05           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.920732260935       residual = 7.33e-06           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.920732128288       residual = 4.76e-06           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.920732237189       residual = 4.00e-06           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.920732187573       residual = 2.91e-06           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.920732180196       residual = 1.46e-06           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.920732229307       residual = 1.23e-06           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.920732224673       residual = 5.14e-07           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.920732188808       residual = 6.59e-07           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.920732157691       residual = 1.83e-07           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.920732165284       residual = 2.10e-07           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.920732287404       residual = 8.92e-08           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.920732151702       residual = 3.36e-08           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.920732224372       residual = 1.33e-08           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =      -0.920732348133       residual = 3.60e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         25 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.9062e+07 is 1.794832e-11

solving harmonic davidson linear method for identity shift 1.5625e+08, overlap shift 1.5625e+09 and omega -1.7456e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.920732220664       residual = 1.05e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.920732220664       residual = 6.08e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.920732220664       residual = 6.03e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.920732220664       residual = 2.31e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.920732229556       residual = 2.85e-04           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.920732223730       residual = 2.53e-04           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.920732017984       residual = 1.19e-04           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.920732459492       residual = 6.16e-05           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.920732525566       residual = 4.36e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.920732272305       residual = 3.01e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.920732598667       residual = 4.99e-05           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.920731996195       residual = 1.73e-05           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.920732013056       residual = 7.32e-06           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.920732600775       residual = 4.76e-06           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.920732294883       residual = 4.00e-06           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.920732056771       residual = 2.91e-06           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.920732480178       residual = 1.46e-06           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.920732261567       residual = 1.23e-06           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.920732099847       residual = 5.14e-07           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.920731852852       residual = 6.59e-07           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.920732334119       residual = 1.82e-07           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.920731370658       residual = 2.06e-07           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.920731808086       residual = 9.01e-08           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.920732512028       residual = 3.40e-08           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.920732033246       residual = 1.34e-08           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =      -0.920731892014       residual = 3.58e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         25 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.5625e+08 is 4.486751e-12

solving harmonic davidson linear method for identity shift 6.2500e+08, overlap shift 6.2500e+09 and omega -1.7456e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.920732220664       residual = 1.05e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.920732220664       residual = 6.08e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.920732220664       residual = 6.03e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.920732176886       residual = 2.31e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.920732743132       residual = 2.85e-04           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.920732254983       residual = 2.53e-04           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.920732717326       residual = 1.19e-04           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.920732897840       residual = 6.16e-05           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.920733186583       residual = 4.36e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.920731563244       residual = 2.97e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.920732184163       residual = 3.43e-05           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.920731621262       residual = 2.03e-05           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.920731911403       residual = 7.38e-06           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.920732317710       residual = 4.76e-06           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.920734528752       residual = 4.00e-06           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.920732641297       residual = 2.92e-06           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.920731758551       residual = 1.46e-06           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.920733381607       residual = 1.23e-06           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.920733054034       residual = 5.16e-07           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.920731705879       residual = 6.60e-07           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.920733999658       residual = 1.81e-07           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.920732117926       residual = 2.18e-07           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.920733442192       residual = 8.64e-08           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.920731648513       residual = 3.28e-08           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.920730874755       residual = 1.34e-08           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =      -0.920733526745       residual = 3.83e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         25 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 6.2500e+08 is 1.122252e-12

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.618349 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.6430e+01
  </log>
  <optVariables href="H2O.s021.opt.xml">
 uu_0                 2.517233e-01 1 1  ON 0
 uu_1                 1.009440e-01 1 1  ON 1
 uu_2                 1.617079e-02 1 1  ON 2
 uu_3                -3.223684e-02 1 1  ON 3
 uu_4                -6.387117e-02 1 1  ON 4
 uu_5                -8.576607e-02 1 1  ON 5
 uu_6                -1.001312e-01 1 1  ON 6
 uu_7                -1.065673e-01 1 1  ON 7
 uu_8                -9.668739e-02 1 1  ON 8
 uu_9                -6.389513e-02 1 1  ON 9
 ud_0                 3.492134e-01 1 1  ON 10
 ud_1                 1.235409e-01 1 1  ON 11
 ud_2                 2.392782e-02 1 1  ON 12
 ud_3                -3.019578e-02 1 1  ON 13
 ud_4                -6.975615e-02 1 1  ON 14
 ud_5                -9.484122e-02 1 1  ON 15
 ud_6                -1.085598e-01 1 1  ON 16
 ud_7                -1.109505e-01 1 1  ON 17
 ud_8                -9.792103e-02 1 1  ON 18
 ud_9                -6.281979e-02 1 1  ON 19
 eO_0                -5.692885e-01 1 1  ON 20
 eO_1                -3.060844e-01 1 1  ON 21
 eO_2                 4.730127e-02 1 1  ON 22
 eO_3                 2.840620e-01 1 1  ON 23
 eO_4                 3.913445e-01 1 1  ON 24
 eO_5                 3.212389e-01 1 1  ON 25
 eO_6                 1.205694e-01 1 1  ON 26
 eO_7                -7.888705e-02 1 1  ON 27
 eO_8                -1.549102e-01 1 1  ON 28
 eO_9                -6.122098e-02 1 1  ON 29
eH1_0                -2.277697e-01 1 1  ON 30
eH1_1                -1.106400e-01 1 1  ON 31
eH1_2                -6.162952e-02 1 1  ON 32
eH1_3                -2.530653e-02 1 1  ON 33
eH1_4                 4.247832e-03 1 1  ON 34
eH1_5                 2.367079e-02 1 1  ON 35
eH1_6                 6.569443e-02 1 1  ON 36
eH1_7                 1.154361e-01 1 1  ON 37
eH1_8                 1.435221e-01 1 1  ON 38
eH1_9                 7.467419e-02 1 1  ON 39
eH2_0                -2.307043e-01 1 1  ON 40
eH2_1                -1.139386e-01 1 1  ON 41
eH2_2                -6.444539e-02 1 1  ON 42
eH2_3                -2.722663e-02 1 1  ON 43
eH2_4                 1.073593e-03 1 1  ON 44
eH2_5                 2.532957e-02 1 1  ON 45
eH2_6                 7.564477e-02 1 1  ON 46
eH2_7                 1.260027e-01 1 1  ON 47
eH2_8                 1.609124e-01 1 1  ON 48
eH2_9                 6.417217e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 21
    time step          = 0.05
    reference energy   = -16.8429
    reference variance = 0.21039
====================================================
  Execution time = 2.0273e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s021
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6898e+01
  VMC Evar = 2.9586e-01
  Total weights = 2.0000e+06
  Execution time = 1.8730e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.295863425255
                                         uncertainty =       0.003801828767

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.295863425255
                                         uncertainty =       0.003801828767

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000384615107
  error estimate for blocks of size 2^( 2) =       0.000401707177
  error estimate for blocks of size 2^( 3) =       0.000419216297
  error estimate for blocks of size 2^( 4) =       0.000434851836
  error estimate for blocks of size 2^( 5) =       0.000445752408
  error estimate for blocks of size 2^( 6) =       0.000453441636
  error estimate for blocks of size 2^( 7) =       0.000458352804

      target function =      -0.918891873448
              le_mean =     -16.897581197621
             les_mean =     285.824107742755
             stat err =       0.000448099671
             autocorr =       1.357364771745
   target nu stat err =       0.000448099671
   target dn stat err =       0.003973350180
      target stat err =       0.006055253694
              std dev =       0.543927900094
             le_variance =       0.295857560500

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.295863425257
                                         uncertainty =       0.003801828767

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.295863425257
                                         uncertainty =       0.003801828767

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000384615107
  error estimate for blocks of size 2^( 2) =       0.000401707177
  error estimate for blocks of size 2^( 3) =       0.000419216297
  error estimate for blocks of size 2^( 4) =       0.000434851836
  error estimate for blocks of size 2^( 5) =       0.000445752408
  error estimate for blocks of size 2^( 6) =       0.000453441636
  error estimate for blocks of size 2^( 7) =       0.000458352804

      target function =      -0.918891873445
              le_mean =     -16.897581197621
             les_mean =     285.824107742756
             stat err =       0.000448099671
             autocorr =       1.357364771746
   target nu stat err =       0.000448099671
   target dn stat err =       0.003973350180
      target stat err =       0.006055253694
              std dev =       0.543927900095
             le_variance =       0.295857560502

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.295863425256
                                         uncertainty =       0.003801828767

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.295863425256
                                         uncertainty =       0.003801828767

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000384615107
  error estimate for blocks of size 2^( 2) =       0.000401707177
  error estimate for blocks of size 2^( 3) =       0.000419216297
  error estimate for blocks of size 2^( 4) =       0.000434851836
  error estimate for blocks of size 2^( 5) =       0.000445752408
  error estimate for blocks of size 2^( 6) =       0.000453441636
  error estimate for blocks of size 2^( 7) =       0.000458352804

      target function =      -0.918891873447
              le_mean =     -16.897581197621
             les_mean =     285.824107742756
             stat err =       0.000448099671
             autocorr =       1.357364771748
   target nu stat err =       0.000448099671
   target dn stat err =       0.003973350180
      target stat err =       0.006055253694
              std dev =       0.543927900095
             le_variance =       0.295857560501

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.295863425255
                                         uncertainty =       0.003801828767

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.295863425255
                                         uncertainty =       0.003801828767

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000384615107
  error estimate for blocks of size 2^( 2) =       0.000401707177
  error estimate for blocks of size 2^( 3) =       0.000419216297
  error estimate for blocks of size 2^( 4) =       0.000434851836
  error estimate for blocks of size 2^( 5) =       0.000445752408
  error estimate for blocks of size 2^( 6) =       0.000453441636
  error estimate for blocks of size 2^( 7) =       0.000458352804

      target function =      -0.918891873448
              le_mean =     -16.897581197621
             les_mean =     285.824107742755
             stat err =       0.000448099671
             autocorr =       1.357364771746
   target nu stat err =       0.000448099671
   target dn stat err =       0.003973350180
      target stat err =       0.006055253694
              std dev =       0.543927900094
             le_variance =       0.295857560501


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.918891873448        initial  <--
     3.9062e+07     3.9062e+08             1.7948e-11        -0.918891873445
     1.5625e+08     1.5625e+09             4.4868e-12        -0.918891873447
     6.2500e+08     6.2500e+09             1.1223e-12        -0.918891873448

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 29.7437
  </log>
  <optVariables href="H2O.s021.opt.xml">
 uu_0                 2.517233e-01 1 1  ON 0
 uu_1                 1.009440e-01 1 1  ON 1
 uu_2                 1.617079e-02 1 1  ON 2
 uu_3                -3.223684e-02 1 1  ON 3
 uu_4                -6.387117e-02 1 1  ON 4
 uu_5                -8.576607e-02 1 1  ON 5
 uu_6                -1.001312e-01 1 1  ON 6
 uu_7                -1.065673e-01 1 1  ON 7
 uu_8                -9.668739e-02 1 1  ON 8
 uu_9                -6.389513e-02 1 1  ON 9
 ud_0                 3.492134e-01 1 1  ON 10
 ud_1                 1.235409e-01 1 1  ON 11
 ud_2                 2.392782e-02 1 1  ON 12
 ud_3                -3.019578e-02 1 1  ON 13
 ud_4                -6.975615e-02 1 1  ON 14
 ud_5                -9.484122e-02 1 1  ON 15
 ud_6                -1.085598e-01 1 1  ON 16
 ud_7                -1.109505e-01 1 1  ON 17
 ud_8                -9.792103e-02 1 1  ON 18
 ud_9                -6.281979e-02 1 1  ON 19
 eO_0                -5.692885e-01 1 1  ON 20
 eO_1                -3.060844e-01 1 1  ON 21
 eO_2                 4.730127e-02 1 1  ON 22
 eO_3                 2.840620e-01 1 1  ON 23
 eO_4                 3.913445e-01 1 1  ON 24
 eO_5                 3.212389e-01 1 1  ON 25
 eO_6                 1.205694e-01 1 1  ON 26
 eO_7                -7.888705e-02 1 1  ON 27
 eO_8                -1.549102e-01 1 1  ON 28
 eO_9                -6.122098e-02 1 1  ON 29
eH1_0                -2.277697e-01 1 1  ON 30
eH1_1                -1.106400e-01 1 1  ON 31
eH1_2                -6.162952e-02 1 1  ON 32
eH1_3                -2.530653e-02 1 1  ON 33
eH1_4                 4.247832e-03 1 1  ON 34
eH1_5                 2.367079e-02 1 1  ON 35
eH1_6                 6.569443e-02 1 1  ON 36
eH1_7                 1.154361e-01 1 1  ON 37
eH1_8                 1.435221e-01 1 1  ON 38
eH1_9                 7.467419e-02 1 1  ON 39
eH2_0                -2.307043e-01 1 1  ON 40
eH2_1                -1.139386e-01 1 1  ON 41
eH2_2                -6.444539e-02 1 1  ON 42
eH2_3                -2.722663e-02 1 1  ON 43
eH2_4                 1.073593e-03 1 1  ON 44
eH2_5                 2.532957e-02 1 1  ON 45
eH2_6                 7.564477e-02 1 1  ON 46
eH2_7                 1.260027e-01 1 1  ON 47
eH2_8                 1.609124e-01 1 1  ON 48
eH2_9                 6.417217e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.6180e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s022 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s022 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=22  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6899e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 22
    time step          = 0.05
    reference energy   = -17.0174
    reference variance = 0.176788
====================================================
  Execution time = 2.1052e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s022
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6898e+01
  VMC Evar = 2.9452e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.9415e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.294560175585
                                         uncertainty =       0.002788757938

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.294560175585
                                         uncertainty =       0.002788757938

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000383744204
  error estimate for blocks of size 2^( 2) =       0.000400875659
  error estimate for blocks of size 2^( 3) =       0.000418358129
  error estimate for blocks of size 2^( 4) =       0.000434004740
  error estimate for blocks of size 2^( 5) =       0.000446724519
  error estimate for blocks of size 2^( 6) =       0.000455402529
  error estimate for blocks of size 2^( 7) =       0.000459642412

      target function =      -0.920966494836
              le_mean =     -16.898132906193
             les_mean =     285.841414795886
             stat err =       0.000448943550
             autocorr =       1.368673363096
   target nu stat err =       0.000448943550
   target dn stat err =       0.002699117166
      target stat err =       0.004171566204
              std dev =       0.542696257396
             le_variance =       0.294519227792


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.689813290619e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 3.9062e+08, overlap shift 3.9062e+09 and omega -1.7456e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.920984130854       residual = 7.08e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.920984130854       residual = 2.93e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.920984130854       residual = 1.53e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.920984130854       residual = 1.88e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.920984130854       residual = 6.77e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.920984130854       residual = 1.00e-04           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.920984349783       residual = 4.67e-05           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.920982972575       residual = 1.70e-05           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.920983675006       residual = 1.71e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.920982985272       residual = 1.05e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.920985106485       residual = 3.71e-06           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.920983415195       residual = 3.23e-06           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.920984130854       residual = 2.24e-06           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.920984645186       residual = 4.60e-06           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.920984130854       residual = 1.56e-06           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.920985172554       residual = 6.62e-07           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.920983453153       residual = 5.39e-07           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.920984850386       residual = 3.20e-07           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.920983281844       residual = 1.88e-07           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.920984308250       residual = 3.37e-07           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.920982970156       residual = 9.60e-08           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.920984407093       residual = 2.15e-08           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.920984469304       residual = 2.46e-08           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.920984738942       residual = 7.45e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         23 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.9062e+08 is 6.331430e-13

solving harmonic davidson linear method for identity shift 1.5625e+09, overlap shift 1.5625e+10 and omega -1.7456e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.920984130854       residual = 7.08e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.920984130854       residual = 2.93e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.920984130854       residual = 1.53e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.920984130854       residual = 1.87e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.920984130854       residual = 6.77e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.920984130854       residual = 1.00e-04           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.920984130854       residual = 4.66e-05           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.920983477749       residual = 1.70e-05           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.920984130854       residual = 1.72e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.920982472187       residual = 1.05e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.920984130854       residual = 3.70e-06           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.920982893629       residual = 3.23e-06           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.920984130854       residual = 2.23e-06           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.920984130854       residual = 4.46e-06           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.920982350632       residual = 1.59e-06           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.920982172016       residual = 6.67e-07           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.920985707129       residual = 5.48e-07           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.920982503872       residual = 3.26e-07           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.920981232767       residual = 1.93e-07           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.920984097971       residual = 3.42e-07           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.920995329441       residual = 1.07e-07           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.920991290461       residual = 1.91e-08           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.921001628570       residual = 3.35e-08           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.920983428718       residual = 8.00e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         23 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.5625e+09 is 1.583480e-13

solving harmonic davidson linear method for identity shift 6.2500e+09, overlap shift 6.2500e+10 and omega -1.7456e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.920984130854       residual = 7.08e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.920984130854       residual = 2.93e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.920984130854       residual = 1.53e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.920984130854       residual = 1.87e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.920984130854       residual = 6.74e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.920986987439       residual = 1.01e-04           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.920984754708       residual = 4.68e-05           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.920990041961       residual = 1.71e-05           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.920994541748       residual = 1.70e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.921000014419       residual = 1.05e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.920989150496       residual = 3.73e-06           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.920985546772       residual = 3.13e-06           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.920995244482       residual = 2.26e-06           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.920984130854       residual = 4.60e-06           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.920995433944       residual = 1.70e-06           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.920985423080       residual = 6.68e-07           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.920989640407       residual = 6.20e-07           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.920965171612       residual = 3.81e-07           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.920966644879       residual = 1.90e-07           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.921010207883       residual = 4.82e-07           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.920981018740       residual = 1.10e-07           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.920990223265       residual = 4.51e-08           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.920972555810       residual = 3.95e-08           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.920945651338       residual = 1.14e-07           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.920993878167       residual = 2.24e-08           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =      -0.920960838593       residual = 4.23e-08           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   tar_fn =      -0.920972533599       residual = 2.11e-08           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   tar_fn =      -0.920986748357       residual = 1.24e-08           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   tar_fn =      -0.920983159074       residual = 6.61e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         28 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 6.2500e+09 is 3.913140e-14

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.639978 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.8293e+01
  </log>
  <optVariables href="H2O.s022.opt.xml">
 uu_0                 2.517233e-01 1 1  ON 0
 uu_1                 1.009440e-01 1 1  ON 1
 uu_2                 1.617079e-02 1 1  ON 2
 uu_3                -3.223684e-02 1 1  ON 3
 uu_4                -6.387117e-02 1 1  ON 4
 uu_5                -8.576607e-02 1 1  ON 5
 uu_6                -1.001312e-01 1 1  ON 6
 uu_7                -1.065673e-01 1 1  ON 7
 uu_8                -9.668739e-02 1 1  ON 8
 uu_9                -6.389513e-02 1 1  ON 9
 ud_0                 3.492134e-01 1 1  ON 10
 ud_1                 1.235409e-01 1 1  ON 11
 ud_2                 2.392782e-02 1 1  ON 12
 ud_3                -3.019578e-02 1 1  ON 13
 ud_4                -6.975615e-02 1 1  ON 14
 ud_5                -9.484122e-02 1 1  ON 15
 ud_6                -1.085598e-01 1 1  ON 16
 ud_7                -1.109505e-01 1 1  ON 17
 ud_8                -9.792103e-02 1 1  ON 18
 ud_9                -6.281979e-02 1 1  ON 19
 eO_0                -5.692885e-01 1 1  ON 20
 eO_1                -3.060844e-01 1 1  ON 21
 eO_2                 4.730127e-02 1 1  ON 22
 eO_3                 2.840620e-01 1 1  ON 23
 eO_4                 3.913445e-01 1 1  ON 24
 eO_5                 3.212389e-01 1 1  ON 25
 eO_6                 1.205694e-01 1 1  ON 26
 eO_7                -7.888705e-02 1 1  ON 27
 eO_8                -1.549102e-01 1 1  ON 28
 eO_9                -6.122098e-02 1 1  ON 29
eH1_0                -2.277697e-01 1 1  ON 30
eH1_1                -1.106400e-01 1 1  ON 31
eH1_2                -6.162952e-02 1 1  ON 32
eH1_3                -2.530653e-02 1 1  ON 33
eH1_4                 4.247832e-03 1 1  ON 34
eH1_5                 2.367079e-02 1 1  ON 35
eH1_6                 6.569443e-02 1 1  ON 36
eH1_7                 1.154361e-01 1 1  ON 37
eH1_8                 1.435221e-01 1 1  ON 38
eH1_9                 7.467419e-02 1 1  ON 39
eH2_0                -2.307043e-01 1 1  ON 40
eH2_1                -1.139386e-01 1 1  ON 41
eH2_2                -6.444539e-02 1 1  ON 42
eH2_3                -2.722663e-02 1 1  ON 43
eH2_4                 1.073593e-03 1 1  ON 44
eH2_5                 2.532957e-02 1 1  ON 45
eH2_6                 7.564477e-02 1 1  ON 46
eH2_7                 1.260027e-01 1 1  ON 47
eH2_8                 1.609124e-01 1 1  ON 48
eH2_9                 6.417217e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 22
    time step          = 0.05
    reference energy   = -16.9933
    reference variance = 0.216389
====================================================
  Execution time = 2.0794e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s022
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6897e+01
  VMC Evar = 3.0242e-01
  Total weights = 2.0000e+06
  Execution time = 1.8784e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.302525204009
                                         uncertainty =       0.006531179015

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.302525204009
                                         uncertainty =       0.006531179015

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000388857531
  error estimate for blocks of size 2^( 2) =       0.000405793393
  error estimate for blocks of size 2^( 3) =       0.000423183271
  error estimate for blocks of size 2^( 4) =       0.000437592551
  error estimate for blocks of size 2^( 5) =       0.000449124036
  error estimate for blocks of size 2^( 6) =       0.000453942118
  error estimate for blocks of size 2^( 7) =       0.000457512880

      target function =      -0.908996143023
              le_mean =     -16.897437071451
             les_mean =     285.825799791152
             stat err =       0.000449542896
             autocorr =       1.336476263855
   target nu stat err =       0.000449542896
   target dn stat err =       0.006780488188
      target stat err =       0.010061420810
              std dev =       0.549927594055
             le_variance =       0.302420358703

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.302525204010
                                         uncertainty =       0.006531179015

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.302525204010
                                         uncertainty =       0.006531179015

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000388857531
  error estimate for blocks of size 2^( 2) =       0.000405793393
  error estimate for blocks of size 2^( 3) =       0.000423183271
  error estimate for blocks of size 2^( 4) =       0.000437592551
  error estimate for blocks of size 2^( 5) =       0.000449124036
  error estimate for blocks of size 2^( 6) =       0.000453942118
  error estimate for blocks of size 2^( 7) =       0.000457512880

      target function =      -0.908996143023
              le_mean =     -16.897437071451
             les_mean =     285.825799791152
             stat err =       0.000449542896
             autocorr =       1.336476263853
   target nu stat err =       0.000449542896
   target dn stat err =       0.006780488188
      target stat err =       0.010061420810
              std dev =       0.549927594055
             le_variance =       0.302420358703

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.302525204010
                                         uncertainty =       0.006531179015

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.302525204010
                                         uncertainty =       0.006531179015

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000388857531
  error estimate for blocks of size 2^( 2) =       0.000405793393
  error estimate for blocks of size 2^( 3) =       0.000423183271
  error estimate for blocks of size 2^( 4) =       0.000437592551
  error estimate for blocks of size 2^( 5) =       0.000449124036
  error estimate for blocks of size 2^( 6) =       0.000453942118
  error estimate for blocks of size 2^( 7) =       0.000457512880

      target function =      -0.908996143023
              le_mean =     -16.897437071451
             les_mean =     285.825799791152
             stat err =       0.000449542896
             autocorr =       1.336476263854
   target nu stat err =       0.000449542896
   target dn stat err =       0.006780488188
      target stat err =       0.010061420810
              std dev =       0.549927594055
             le_variance =       0.302420358703

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.302525204009
                                         uncertainty =       0.006531179015

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.302525204009
                                         uncertainty =       0.006531179015

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000388857531
  error estimate for blocks of size 2^( 2) =       0.000405793393
  error estimate for blocks of size 2^( 3) =       0.000423183271
  error estimate for blocks of size 2^( 4) =       0.000437592551
  error estimate for blocks of size 2^( 5) =       0.000449124036
  error estimate for blocks of size 2^( 6) =       0.000453942118
  error estimate for blocks of size 2^( 7) =       0.000457512880

      target function =      -0.908996143023
              le_mean =     -16.897437071451
             les_mean =     285.825799791152
             stat err =       0.000449542896
             autocorr =       1.336476263857
   target nu stat err =       0.000449542896
   target dn stat err =       0.006780488188
      target stat err =       0.010061420810
              std dev =       0.549927594055
             le_variance =       0.302420358703


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.908996143023        initial  <--
     3.9062e+08     3.9062e+09             6.3314e-13        -0.908996143023
     1.5625e+09     1.5625e+10             1.5835e-13        -0.908996143023
     6.2500e+09     6.2500e+10             3.9131e-14        -0.908996143023

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 30.2931
  </log>
  <optVariables href="H2O.s022.opt.xml">
 uu_0                 2.517233e-01 1 1  ON 0
 uu_1                 1.009440e-01 1 1  ON 1
 uu_2                 1.617079e-02 1 1  ON 2
 uu_3                -3.223684e-02 1 1  ON 3
 uu_4                -6.387117e-02 1 1  ON 4
 uu_5                -8.576607e-02 1 1  ON 5
 uu_6                -1.001312e-01 1 1  ON 6
 uu_7                -1.065673e-01 1 1  ON 7
 uu_8                -9.668739e-02 1 1  ON 8
 uu_9                -6.389513e-02 1 1  ON 9
 ud_0                 3.492134e-01 1 1  ON 10
 ud_1                 1.235409e-01 1 1  ON 11
 ud_2                 2.392782e-02 1 1  ON 12
 ud_3                -3.019578e-02 1 1  ON 13
 ud_4                -6.975615e-02 1 1  ON 14
 ud_5                -9.484122e-02 1 1  ON 15
 ud_6                -1.085598e-01 1 1  ON 16
 ud_7                -1.109505e-01 1 1  ON 17
 ud_8                -9.792103e-02 1 1  ON 18
 ud_9                -6.281979e-02 1 1  ON 19
 eO_0                -5.692885e-01 1 1  ON 20
 eO_1                -3.060844e-01 1 1  ON 21
 eO_2                 4.730127e-02 1 1  ON 22
 eO_3                 2.840620e-01 1 1  ON 23
 eO_4                 3.913445e-01 1 1  ON 24
 eO_5                 3.212389e-01 1 1  ON 25
 eO_6                 1.205694e-01 1 1  ON 26
 eO_7                -7.888705e-02 1 1  ON 27
 eO_8                -1.549102e-01 1 1  ON 28
 eO_9                -6.122098e-02 1 1  ON 29
eH1_0                -2.277697e-01 1 1  ON 30
eH1_1                -1.106400e-01 1 1  ON 31
eH1_2                -6.162952e-02 1 1  ON 32
eH1_3                -2.530653e-02 1 1  ON 33
eH1_4                 4.247832e-03 1 1  ON 34
eH1_5                 2.367079e-02 1 1  ON 35
eH1_6                 6.569443e-02 1 1  ON 36
eH1_7                 1.154361e-01 1 1  ON 37
eH1_8                 1.435221e-01 1 1  ON 38
eH1_9                 7.467419e-02 1 1  ON 39
eH2_0                -2.307043e-01 1 1  ON 40
eH2_1                -1.139386e-01 1 1  ON 41
eH2_2                -6.444539e-02 1 1  ON 42
eH2_3                -2.722663e-02 1 1  ON 43
eH2_4                 1.073593e-03 1 1  ON 44
eH2_5                 2.532957e-02 1 1  ON 45
eH2_6                 7.564477e-02 1 1  ON 46
eH2_7                 1.260027e-01 1 1  ON 47
eH2_8                 1.609124e-01 1 1  ON 48
eH2_9                 6.417217e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.8592e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s023 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s023 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=23  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6904e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 23
    time step          = 0.05
    reference energy   = -16.8573
    reference variance = 0.258869
====================================================
  Execution time = 2.1118e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s023
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6898e+01
  VMC Evar = 2.9401e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.5321e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.294052222358
                                         uncertainty =       0.004083391109

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.294052222358
                                         uncertainty =       0.004083391109

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000383413113
  error estimate for blocks of size 2^( 2) =       0.000400802464
  error estimate for blocks of size 2^( 3) =       0.000418168163
  error estimate for blocks of size 2^( 4) =       0.000432378850
  error estimate for blocks of size 2^( 5) =       0.000443764437
  error estimate for blocks of size 2^( 6) =       0.000450333773
  error estimate for blocks of size 2^( 7) =       0.000455518275

      target function =      -0.921696000360
              le_mean =     -16.897673287756
             les_mean =     285.825373622416
             stat err =       0.000445498834
             autocorr =       1.350079118251
   target nu stat err =       0.000445498834
   target dn stat err =       0.004017575849
      target stat err =       0.006159317233
              std dev =       0.542228023703
             le_variance =       0.294011229688


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.689767328776e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 3.9062e+09, overlap shift 3.9062e+10 and omega -1.7456e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.921735772082       residual = 1.61e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.921735772082       residual = 7.27e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.921735772082       residual = 1.91e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.921735772082       residual = 1.70e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.921735772082       residual = 6.89e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.921736455533       residual = 5.99e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.921740784361       residual = 3.63e-05           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.921736957736       residual = 2.43e-05           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.921731621867       residual = 2.32e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.921740100561       residual = 1.19e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.921737241421       residual = 9.35e-06           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.921736958973       residual = 6.99e-06           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.921742452661       residual = 6.92e-06           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.921733136062       residual = 5.59e-06           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.921737157682       residual = 4.47e-06           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.921746674249       residual = 1.31e-06           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.921723557029       residual = 7.67e-07           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.921718674961       residual = 4.41e-07           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.921744952740       residual = 1.73e-07           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.921732752320       residual = 1.13e-07           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.921730001783       residual = 1.13e-07           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.921733906875       residual = 1.14e-07           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.921734553247       residual = 4.51e-08           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.921737706966       residual = 2.30e-08           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.921736252761       residual = 1.46e-08           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =      -0.921729430379       residual = 9.39e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         25 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.9062e+09 is 1.624704e-13

solving harmonic davidson linear method for identity shift 1.5625e+10, overlap shift 1.5625e+11 and omega -1.7456e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.921735772082       residual = 1.61e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.921735772082       residual = 7.27e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.921735772082       residual = 1.92e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.921735772082       residual = 1.71e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.921735772082       residual = 6.83e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.921739342085       residual = 6.03e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.921736970958       residual = 3.58e-05           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.921724470043       residual = 2.35e-05           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.921724976581       residual = 2.34e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.921754721739       residual = 1.18e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.921736385875       residual = 9.16e-06           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.921738357557       residual = 7.06e-06           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.921728967756       residual = 8.20e-06           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.921735772082       residual = 5.66e-06           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.921734664446       residual = 4.18e-06           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.921674913444       residual = 1.58e-06           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.921743217541       residual = 8.31e-07           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.921785618295       residual = 7.83e-07           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.921717687159       residual = 2.23e-07           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.921652600509       residual = 7.54e-07           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.921751585411       residual = 2.01e-07           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.921685312272       residual = 4.31e-07           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.921807218455       residual = 6.18e-07           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.921759140355       residual = 1.00e-07           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.921758439263       residual = 1.41e-07           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =      -0.921864897509       residual = 1.29e-06           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   tar_fn =      -0.921625163802       residual = 1.15e-06           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   tar_fn =      -0.921599333324       residual = 1.81e-06           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   tar_fn =      -0.921764816293       residual = 1.63e-07           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   tar_fn =      -0.921775256348       residual = 2.13e-07           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   tar_fn =      -0.921845804239       residual = 1.49e-06           smallest_sin_value = 1.00e+00
davidson iteration   31:   krylov dim =  32   tar_fn =      -0.921735083474       residual = 1.13e-07           smallest_sin_value = 1.00e+00
davidson iteration   32:   krylov dim =  33   tar_fn =      -0.921891388109       residual = 1.93e-06           smallest_sin_value = 1.00e+00
davidson iteration   33:   krylov dim =  34   tar_fn =      -0.921599463895       residual = 2.12e-06           smallest_sin_value = 1.00e+00
davidson iteration   34:   krylov dim =  35   tar_fn =      -0.922101674301       residual = 1.37e-05           smallest_sin_value = 1.00e+00
davidson iteration   35:   krylov dim =  36   tar_fn =      -0.921945139646       residual = 4.21e-06           smallest_sin_value = 1.00e+00
davidson iteration   36:   krylov dim =  37   tar_fn =      -0.921670012785       residual = 7.40e-07           smallest_sin_value = 1.00e+00
davidson iteration   37:   krylov dim =  38   tar_fn =      -0.921518956000       residual = 1.06e-05           smallest_sin_value = 1.00e+00
davidson iteration   38:   krylov dim =  39   tar_fn =      -0.921196404974       residual = 3.02e-05           smallest_sin_value = 1.00e+00
davidson iteration   39:   krylov dim =  40   tar_fn =      -0.921769240244       residual = 1.61e-05           smallest_sin_value = 1.00e+00
davidson iteration   40:   krylov dim =  41   tar_fn =      -0.921260133329       residual = 6.04e-05           smallest_sin_value = 1.00e+00
davidson iteration   41:   krylov dim =  42   tar_fn =      -0.920400106445       residual = 1.52e-04           smallest_sin_value = 1.00e+00
davidson iteration   42:   krylov dim =  43   tar_fn =      -0.920846294924       residual = 6.50e-05           smallest_sin_value = 1.00e+00
davidson iteration   43:   krylov dim =  44   tar_fn =      -0.920697292885       residual = 9.58e-05           smallest_sin_value = 1.00e+00
davidson iteration   44:   krylov dim =  45   tar_fn =      -0.921595130768       residual = 1.23e-05           smallest_sin_value = 1.00e+00
davidson iteration   45:   krylov dim =  46   tar_fn =      -0.929296834047       residual = 6.40e-03           smallest_sin_value = 1.00e+00
davidson iteration   46:   krylov dim =  47   tar_fn =      -0.928060617857       residual = 3.31e-03           smallest_sin_value = 1.00e+00
davidson iteration   47 stopping due to small subspace S singular value of 9.89e-01
davidson solver did not converge after         47 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.5625e+10 is 4.086281e-14

solving harmonic davidson linear method for identity shift 6.2500e+10, overlap shift 6.2500e+11 and omega -1.7456e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.921735772082       residual = 1.61e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.921735772082       residual = 7.27e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.921735772082       residual = 1.94e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.921735772082       residual = 1.78e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.921735772082       residual = 6.83e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.921735772082       residual = 5.87e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.921735772082       residual = 3.54e-05           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.921735772082       residual = 2.36e-05           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.921735772082       residual = 2.18e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.921735772082       residual = 1.11e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.921735772082       residual = 8.60e-06           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.921720114006       residual = 1.03e-05           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.921970081300       residual = 1.28e-05           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.921648412630       residual = 7.58e-06           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.921753216049       residual = 5.17e-06           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.921781034936       residual = 4.01e-06           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.921422141852       residual = 1.12e-05           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.921609650612       residual = 4.23e-06           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.921418658517       residual = 1.10e-05           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.921692390934       residual = 8.50e-07           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.922106478775       residual = 1.09e-05           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.921798135960       residual = 1.33e-06           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.921763738568       residual = 3.07e-06           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.921743596736       residual = 1.12e-06           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.921690180015       residual = 1.83e-06           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =      -0.921318085264       residual = 1.67e-05           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   tar_fn =      -0.921384713993       residual = 1.28e-05           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   tar_fn =      -0.922202200598       residual = 2.11e-05           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   tar_fn =      -0.921847448515       residual = 2.80e-06           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   tar_fn =      -0.921488494139       residual = 4.64e-06           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   tar_fn =      -0.921794321800       residual = 5.09e-06           smallest_sin_value = 1.00e+00
davidson iteration   31:   krylov dim =  32   tar_fn =      -0.922920852199       residual = 1.29e-04           smallest_sin_value = 1.00e+00
davidson iteration   32:   krylov dim =  33   tar_fn =      -0.920670122807       residual = 8.46e-05           smallest_sin_value = 1.00e+00
davidson iteration   33:   krylov dim =  34   tar_fn =      -0.921136671292       residual = 3.88e-05           smallest_sin_value = 1.00e+00
davidson iteration   34:   krylov dim =  35   tar_fn =      -0.923223255600       residual = 2.19e-04           smallest_sin_value = 1.00e+00
davidson iteration   35:   krylov dim =  36   tar_fn =      -0.921478998260       residual = 2.17e-05           smallest_sin_value = 1.00e+00
davidson iteration   36:   krylov dim =  37   tar_fn =      -0.923672481828       residual = 2.87e-04           smallest_sin_value = 1.00e+00
davidson iteration   37:   krylov dim =  38   tar_fn =      -0.923292547599       residual = 1.91e-04           smallest_sin_value = 1.00e+00
davidson iteration   38:   krylov dim =  39   tar_fn =      -0.922140696744       residual = 2.12e-05           smallest_sin_value = 1.00e+00
davidson iteration   39:   krylov dim =  40   tar_fn =      -0.923257331445       residual = 2.74e-04           smallest_sin_value = 1.00e+00
davidson iteration   40:   krylov dim =  41   tar_fn =      -0.920636177599       residual = 2.53e-04           smallest_sin_value = 1.00e+00
davidson iteration   41:   krylov dim =  42   tar_fn =      -0.919509908966       residual = 7.02e-04           smallest_sin_value = 1.00e+00
davidson iteration   42:   krylov dim =  43   tar_fn =      -0.926040806276       residual = 1.45e-03           smallest_sin_value = 1.00e+00
davidson iteration   43:   krylov dim =  44   tar_fn =      -0.923229907535       residual = 5.27e-04           smallest_sin_value = 1.00e+00
davidson iteration   44:   krylov dim =  45   tar_fn =      -0.922273354527       residual = 4.91e-04           smallest_sin_value = 1.00e+00
davidson iteration   45:   krylov dim =  46   tar_fn =      -0.879297380814       residual = 1.30e-01           smallest_sin_value = 1.00e+00
davidson iteration   46:   krylov dim =  47   tar_fn =      -0.863680094432       residual = 2.51e-01           smallest_sin_value = 1.00e+00
davidson iteration   47 stopping due to small subspace S singular value of 9.54e-01
davidson solver did not converge after         47 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 6.2500e+10 is 1.027301e-14

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.724639 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.6742e+01
  </log>
  <optVariables href="H2O.s023.opt.xml">
 uu_0                 2.517233e-01 1 1  ON 0
 uu_1                 1.009440e-01 1 1  ON 1
 uu_2                 1.617079e-02 1 1  ON 2
 uu_3                -3.223684e-02 1 1  ON 3
 uu_4                -6.387117e-02 1 1  ON 4
 uu_5                -8.576607e-02 1 1  ON 5
 uu_6                -1.001312e-01 1 1  ON 6
 uu_7                -1.065673e-01 1 1  ON 7
 uu_8                -9.668739e-02 1 1  ON 8
 uu_9                -6.389513e-02 1 1  ON 9
 ud_0                 3.492134e-01 1 1  ON 10
 ud_1                 1.235409e-01 1 1  ON 11
 ud_2                 2.392782e-02 1 1  ON 12
 ud_3                -3.019578e-02 1 1  ON 13
 ud_4                -6.975615e-02 1 1  ON 14
 ud_5                -9.484122e-02 1 1  ON 15
 ud_6                -1.085598e-01 1 1  ON 16
 ud_7                -1.109505e-01 1 1  ON 17
 ud_8                -9.792103e-02 1 1  ON 18
 ud_9                -6.281979e-02 1 1  ON 19
 eO_0                -5.692885e-01 1 1  ON 20
 eO_1                -3.060844e-01 1 1  ON 21
 eO_2                 4.730127e-02 1 1  ON 22
 eO_3                 2.840620e-01 1 1  ON 23
 eO_4                 3.913445e-01 1 1  ON 24
 eO_5                 3.212389e-01 1 1  ON 25
 eO_6                 1.205694e-01 1 1  ON 26
 eO_7                -7.888705e-02 1 1  ON 27
 eO_8                -1.549102e-01 1 1  ON 28
 eO_9                -6.122098e-02 1 1  ON 29
eH1_0                -2.277697e-01 1 1  ON 30
eH1_1                -1.106400e-01 1 1  ON 31
eH1_2                -6.162952e-02 1 1  ON 32
eH1_3                -2.530653e-02 1 1  ON 33
eH1_4                 4.247832e-03 1 1  ON 34
eH1_5                 2.367079e-02 1 1  ON 35
eH1_6                 6.569443e-02 1 1  ON 36
eH1_7                 1.154361e-01 1 1  ON 37
eH1_8                 1.435221e-01 1 1  ON 38
eH1_9                 7.467419e-02 1 1  ON 39
eH2_0                -2.307043e-01 1 1  ON 40
eH2_1                -1.139386e-01 1 1  ON 41
eH2_2                -6.444539e-02 1 1  ON 42
eH2_3                -2.722663e-02 1 1  ON 43
eH2_4                 1.073593e-03 1 1  ON 44
eH2_5                 2.532957e-02 1 1  ON 45
eH2_6                 7.564477e-02 1 1  ON 46
eH2_7                 1.260027e-01 1 1  ON 47
eH2_8                 1.609124e-01 1 1  ON 48
eH2_9                 6.417217e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 23
    time step          = 0.05
    reference energy   = -16.8688
    reference variance = 0.226183
====================================================
  Execution time = 2.0630e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s023
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6898e+01
  VMC Evar = 2.9237e-01
  Total weights = 2.0000e+06
  Execution time = 1.8827e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.292366003616
                                         uncertainty =       0.003017103571

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.292366003616
                                         uncertainty =       0.003017103571

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000382339005
  error estimate for blocks of size 2^( 2) =       0.000399926749
  error estimate for blocks of size 2^( 3) =       0.000417566460
  error estimate for blocks of size 2^( 4) =       0.000432289896
  error estimate for blocks of size 2^( 5) =       0.000443381946
  error estimate for blocks of size 2^( 6) =       0.000450771926
  error estimate for blocks of size 2^( 7) =       0.000456678491

      target function =      -0.924247035918
              le_mean =     -16.898215931144
             les_mean =     285.842067739055
             stat err =       0.000445780565
             autocorr =       1.359393061861
   target nu stat err =       0.000445780565
   target dn stat err =       0.003351780632
      target stat err =       0.005187899400
              std dev =       0.540709006471
             le_variance =       0.292366229679

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.292366003616
                                         uncertainty =       0.003017103571

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.292366003616
                                         uncertainty =       0.003017103571

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000382339005
  error estimate for blocks of size 2^( 2) =       0.000399926749
  error estimate for blocks of size 2^( 3) =       0.000417566460
  error estimate for blocks of size 2^( 4) =       0.000432289896
  error estimate for blocks of size 2^( 5) =       0.000443381946
  error estimate for blocks of size 2^( 6) =       0.000450771926
  error estimate for blocks of size 2^( 7) =       0.000456678491

      target function =      -0.924247035918
              le_mean =     -16.898215931144
             les_mean =     285.842067739055
             stat err =       0.000445780565
             autocorr =       1.359393061858
   target nu stat err =       0.000445780565
   target dn stat err =       0.003351780632
      target stat err =       0.005187899400
              std dev =       0.540709006471
             le_variance =       0.292366229679

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.292366003616
                                         uncertainty =       0.003017103571

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.292366003616
                                         uncertainty =       0.003017103571

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000382339005
  error estimate for blocks of size 2^( 2) =       0.000399926749
  error estimate for blocks of size 2^( 3) =       0.000417566460
  error estimate for blocks of size 2^( 4) =       0.000432289896
  error estimate for blocks of size 2^( 5) =       0.000443381946
  error estimate for blocks of size 2^( 6) =       0.000450771926
  error estimate for blocks of size 2^( 7) =       0.000456678491

      target function =      -0.924247035918
              le_mean =     -16.898215931144
             les_mean =     285.842067739055
             stat err =       0.000445780565
             autocorr =       1.359393061857
   target nu stat err =       0.000445780565
   target dn stat err =       0.003351780632
      target stat err =       0.005187899400
              std dev =       0.540709006471
             le_variance =       0.292366229679

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.292366003616
                                         uncertainty =       0.003017103571

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.292366003616
                                         uncertainty =       0.003017103571

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000382339005
  error estimate for blocks of size 2^( 2) =       0.000399926749
  error estimate for blocks of size 2^( 3) =       0.000417566460
  error estimate for blocks of size 2^( 4) =       0.000432289896
  error estimate for blocks of size 2^( 5) =       0.000443381946
  error estimate for blocks of size 2^( 6) =       0.000450771926
  error estimate for blocks of size 2^( 7) =       0.000456678491

      target function =      -0.924247035918
              le_mean =     -16.898215931144
             les_mean =     285.842067739055
             stat err =       0.000445780565
             autocorr =       1.359393061858
   target nu stat err =       0.000445780565
   target dn stat err =       0.003351780632
      target stat err =       0.005187899400
              std dev =       0.540709006471
             le_variance =       0.292366229679


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.924247035918        initial  <--
     3.9062e+09     3.9062e+10             1.6247e-13        -0.924247035918
     1.5625e+10     1.5625e+11             4.0863e-14        -0.924247035918
     6.2500e+10     6.2500e+11             1.0273e-14        -0.924247035918

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 30.1334
  </log>
  <optVariables href="H2O.s023.opt.xml">
 uu_0                 2.517233e-01 1 1  ON 0
 uu_1                 1.009440e-01 1 1  ON 1
 uu_2                 1.617079e-02 1 1  ON 2
 uu_3                -3.223684e-02 1 1  ON 3
 uu_4                -6.387117e-02 1 1  ON 4
 uu_5                -8.576607e-02 1 1  ON 5
 uu_6                -1.001312e-01 1 1  ON 6
 uu_7                -1.065673e-01 1 1  ON 7
 uu_8                -9.668739e-02 1 1  ON 8
 uu_9                -6.389513e-02 1 1  ON 9
 ud_0                 3.492134e-01 1 1  ON 10
 ud_1                 1.235409e-01 1 1  ON 11
 ud_2                 2.392782e-02 1 1  ON 12
 ud_3                -3.019578e-02 1 1  ON 13
 ud_4                -6.975615e-02 1 1  ON 14
 ud_5                -9.484122e-02 1 1  ON 15
 ud_6                -1.085598e-01 1 1  ON 16
 ud_7                -1.109505e-01 1 1  ON 17
 ud_8                -9.792103e-02 1 1  ON 18
 ud_9                -6.281979e-02 1 1  ON 19
 eO_0                -5.692885e-01 1 1  ON 20
 eO_1                -3.060844e-01 1 1  ON 21
 eO_2                 4.730127e-02 1 1  ON 22
 eO_3                 2.840620e-01 1 1  ON 23
 eO_4                 3.913445e-01 1 1  ON 24
 eO_5                 3.212389e-01 1 1  ON 25
 eO_6                 1.205694e-01 1 1  ON 26
 eO_7                -7.888705e-02 1 1  ON 27
 eO_8                -1.549102e-01 1 1  ON 28
 eO_9                -6.122098e-02 1 1  ON 29
eH1_0                -2.277697e-01 1 1  ON 30
eH1_1                -1.106400e-01 1 1  ON 31
eH1_2                -6.162952e-02 1 1  ON 32
eH1_3                -2.530653e-02 1 1  ON 33
eH1_4                 4.247832e-03 1 1  ON 34
eH1_5                 2.367079e-02 1 1  ON 35
eH1_6                 6.569443e-02 1 1  ON 36
eH1_7                 1.154361e-01 1 1  ON 37
eH1_8                 1.435221e-01 1 1  ON 38
eH1_9                 7.467419e-02 1 1  ON 39
eH2_0                -2.307043e-01 1 1  ON 40
eH2_1                -1.139386e-01 1 1  ON 41
eH2_2                -6.444539e-02 1 1  ON 42
eH2_3                -2.722663e-02 1 1  ON 43
eH2_4                 1.073593e-03 1 1  ON 44
eH2_5                 2.532957e-02 1 1  ON 45
eH2_6                 7.564477e-02 1 1  ON 46
eH2_7                 1.260027e-01 1 1  ON 47
eH2_8                 1.609124e-01 1 1  ON 48
eH2_9                 6.417217e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.6882e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s024 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s024 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=24  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6902e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 24
    time step          = 0.05
    reference energy   = -16.9585
    reference variance = 0.415376
====================================================
  Execution time = 2.0724e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s024
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6898e+01
  VMC Evar = 3.0889e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.4426e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.308960461956
                                         uncertainty =       0.014162799109

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.308960461956
                                         uncertainty =       0.014162799109

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000392996111
  error estimate for blocks of size 2^( 2) =       0.000409839127
  error estimate for blocks of size 2^( 3) =       0.000426969385
  error estimate for blocks of size 2^( 4) =       0.000441919020
  error estimate for blocks of size 2^( 5) =       0.000452638756
  error estimate for blocks of size 2^( 6) =       0.000458683332
  error estimate for blocks of size 2^( 7) =       0.000464556419

      target function =      -0.899149851324
              le_mean =     -16.898257494286
             les_mean =     285.859998075306
             stat err =       0.000454449381
             autocorr =       1.337194334059
   target nu stat err =       0.000454449381
   target dn stat err =       0.014409548187
      target stat err =       0.020918124490
              std dev =       0.555780430168
             le_variance =       0.308891886557


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.689825749429e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 3.9062e+10, overlap shift 3.9062e+11 and omega -1.7456e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.899631481501       residual = 1.45e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.899631481501       residual = 7.64e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.899631481501       residual = 4.14e-03           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.899631481501       residual = 2.55e-03           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.899631196153       residual = 1.83e-03           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.899614398796       residual = 7.85e-04           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.899671032993       residual = 8.12e-04           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.899638492643       residual = 4.13e-04           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.899662442343       residual = 2.32e-04           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.899687798771       residual = 1.14e-04           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.899628269934       residual = 5.99e-05           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.899602986639       residual = 9.02e-05           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.899610507710       residual = 5.84e-05           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.899578017854       residual = 1.37e-05           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.899722784041       residual = 2.05e-05           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.899648830032       residual = 6.49e-06           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.899591341646       residual = 4.71e-06           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.899445655390       residual = 6.50e-06           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.899707937538       residual = 2.95e-06           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.899537593244       residual = 2.58e-06           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.899627534595       residual = 1.43e-06           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.899792646480       residual = 3.22e-06           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.899499630192       residual = 1.83e-06           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.899527116054       residual = 9.85e-07           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.899731323810       residual = 1.40e-06           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =      -0.899675210370       residual = 3.61e-07           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   tar_fn =      -0.899623533369       residual = 2.27e-07           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   tar_fn =      -0.899623013101       residual = 5.72e-07           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   tar_fn =      -0.899228946127       residual = 1.93e-05           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   tar_fn =      -0.900387188867       residual = 4.12e-05           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   tar_fn =      -0.900155692341       residual = 2.36e-05           smallest_sin_value = 1.00e+00
davidson iteration   31:   krylov dim =  32   tar_fn =      -0.898595336994       residual = 8.12e-05           smallest_sin_value = 1.00e+00
davidson iteration   32:   krylov dim =  33   tar_fn =      -0.900104160242       residual = 1.92e-05           smallest_sin_value = 1.00e+00
davidson iteration   33:   krylov dim =  34   tar_fn =      -0.898396039740       residual = 1.31e-04           smallest_sin_value = 1.00e+00
davidson iteration   34:   krylov dim =  35   tar_fn =      -0.898465973505       residual = 1.36e-04           smallest_sin_value = 1.00e+00
davidson iteration   35:   krylov dim =  36   tar_fn =      -0.900159918514       residual = 4.60e-05           smallest_sin_value = 1.00e+00
davidson iteration   36:   krylov dim =  37   tar_fn =      -0.899666261729       residual = 1.11e-05           smallest_sin_value = 1.00e+00
davidson iteration   37:   krylov dim =  38   tar_fn =      -0.899998686074       residual = 1.49e-05           smallest_sin_value = 1.00e+00
davidson iteration   38:   krylov dim =  39   tar_fn =      -0.900168710602       residual = 2.37e-05           smallest_sin_value = 1.00e+00
davidson iteration   39:   krylov dim =  40   tar_fn =      -0.899942425946       residual = 4.60e-05           smallest_sin_value = 1.00e+00
davidson iteration   40:   krylov dim =  41   tar_fn =      -0.900055247665       residual = 3.49e-05           smallest_sin_value = 1.00e+00
davidson iteration   41:   krylov dim =  42   tar_fn =      -0.899652013706       residual = 2.22e-05           smallest_sin_value = 1.00e+00
davidson iteration   42:   krylov dim =  43   tar_fn =      -0.896172351253       residual = 1.25e-03           smallest_sin_value = 1.00e+00
davidson iteration   43:   krylov dim =  44   tar_fn =      -0.898473501523       residual = 1.58e-04           smallest_sin_value = 1.00e+00
davidson iteration   44:   krylov dim =  45   tar_fn =      -0.900237885822       residual = 1.14e-03           smallest_sin_value = 1.00e+00
davidson iteration   45:   krylov dim =  46   tar_fn =      -0.892603952643       residual = 4.52e-03           smallest_sin_value = 1.00e+00
davidson iteration   46:   krylov dim =  47   tar_fn =      -0.899444684661       residual = 7.96e-04           smallest_sin_value = 1.00e+00
davidson iteration   47:   krylov dim =  48   tar_fn =      -0.854269549764       residual = 1.70e-01           smallest_sin_value = 9.95e-01
davidson iteration   48 stopping due to small subspace S singular value of 6.53e-01
davidson solver did not converge after         48 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.9062e+10 is 4.564781e-14

solving harmonic davidson linear method for identity shift 1.5625e+11, overlap shift 1.5625e+12 and omega -1.7456e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.899631481501       residual = 1.45e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.899631481501       residual = 7.64e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.899631481501       residual = 4.07e-03           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.899631481501       residual = 2.54e-03           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.899631481545       residual = 1.81e-03           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.899631481507       residual = 7.70e-04           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.899631481501       residual = 7.91e-04           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.899482726580       residual = 4.47e-04           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.899853785817       residual = 2.43e-04           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.899797271968       residual = 1.20e-04           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.899780192457       residual = 6.25e-05           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.899667863468       residual = 1.02e-04           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.899884316400       residual = 6.92e-05           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.899559922316       residual = 2.00e-05           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.899726053350       residual = 2.32e-05           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.899656082290       residual = 1.24e-05           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.899711153041       residual = 1.18e-05           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.899705336825       residual = 8.35e-06           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.899725530580       residual = 8.47e-06           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.899334612465       residual = 2.20e-05           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.899891720269       residual = 2.23e-05           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.899189563285       residual = 2.53e-05           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.899175292236       residual = 2.29e-05           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.899593557205       residual = 9.39e-06           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.898110346016       residual = 1.83e-04           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =      -0.899825037200       residual = 8.56e-06           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   tar_fn =      -0.898651366518       residual = 8.02e-05           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   tar_fn =      -0.899999079153       residual = 2.61e-05           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   tar_fn =      -0.899380556874       residual = 9.40e-06           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   tar_fn =      -0.900208659814       residual = 6.53e-05           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   tar_fn =      -0.902848251109       residual = 1.58e-03           smallest_sin_value = 1.00e+00
davidson iteration   31:   krylov dim =  32   tar_fn =      -0.900404051451       residual = 2.79e-04           smallest_sin_value = 1.00e+00
davidson iteration   32:   krylov dim =  33   tar_fn =      -0.899372017298       residual = 3.64e-05           smallest_sin_value = 1.00e+00
davidson iteration   33:   krylov dim =  34   tar_fn =      -0.900935854319       residual = 2.84e-04           smallest_sin_value = 1.00e+00
davidson iteration   34:   krylov dim =  35   tar_fn =      -0.904282664626       residual = 2.46e-03           smallest_sin_value = 1.00e+00
davidson iteration   35:   krylov dim =  36   tar_fn =      -0.896489974591       residual = 8.02e-04           smallest_sin_value = 1.00e+00
davidson iteration   36:   krylov dim =  37   tar_fn =      -0.896640013010       residual = 9.74e-04           smallest_sin_value = 1.00e+00
davidson iteration   37:   krylov dim =  38   tar_fn =      -0.900610454523       residual = 8.71e-04           smallest_sin_value = 1.00e+00
davidson iteration   38:   krylov dim =  39   tar_fn =      -0.907722376078       residual = 7.84e-03           smallest_sin_value = 1.00e+00
davidson iteration   39:   krylov dim =  40   tar_fn =      -0.901347380651       residual = 4.19e-03           smallest_sin_value = 1.00e+00
davidson iteration   40:   krylov dim =  41   tar_fn =      -0.889490925746       residual = 1.25e-02           smallest_sin_value = 1.00e+00
davidson iteration   41:   krylov dim =  42   tar_fn =      -0.899507611896       residual = 6.76e-04           smallest_sin_value = 1.00e+00
davidson iteration   42:   krylov dim =  43   tar_fn =      -0.908686020016       residual = 7.54e-03           smallest_sin_value = 1.00e+00
davidson iteration   43:   krylov dim =  44   tar_fn =      -0.886021335261       residual = 1.91e-02           smallest_sin_value = 1.00e+00
davidson iteration   44:   krylov dim =  45   tar_fn =      -0.899908977644       residual = 1.11e-02           smallest_sin_value = 1.00e+00
davidson iteration   45:   krylov dim =  46   tar_fn =      -0.874268453302       residual = 1.28e-01           smallest_sin_value = 1.00e+00
davidson iteration   46:   krylov dim =  47   tar_fn =      -0.967937254001       residual = 4.27e-01           smallest_sin_value = 9.98e-01
davidson iteration   47:   krylov dim =  48   tar_fn =      -0.912698948831       residual = 1.48e-01           smallest_sin_value = 9.94e-01
davidson iteration   48 stopping due to small subspace S singular value of 6.84e-01
davidson solver did not converge after         48 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.5625e+11 is 1.170048e-14

solving harmonic davidson linear method for identity shift 6.2500e+11, overlap shift 6.2500e+12 and omega -1.7456e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.899631481501       residual = 1.45e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.899631481501       residual = 7.64e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.899631481501       residual = 4.02e-03           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.899357685874       residual = 2.61e-03           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.899572403358       residual = 1.80e-03           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.899618139644       residual = 7.87e-04           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.898678802952       residual = 1.08e-03           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.899828466587       residual = 5.07e-04           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.901521828174       residual = 6.20e-04           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.901605994802       residual = 4.78e-04           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.899591766864       residual = 2.23e-04           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.898249499093       residual = 3.67e-04           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.899260549247       residual = 3.46e-04           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.901626488479       residual = 6.87e-04           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.900378954366       residual = 3.05e-04           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.899590361051       residual = 1.07e-04           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.899969474501       residual = 5.79e-05           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.899559618296       residual = 1.12e-04           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.899492232019       residual = 4.90e-05           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.905691049632       residual = 2.99e-03           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.889195308347       residual = 8.57e-03           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.893727454391       residual = 3.15e-03           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.893487796096       residual = 3.34e-03           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.905096128597       residual = 2.33e-03           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.898764960672       residual = 2.58e-04           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =      -0.909068573635       residual = 7.31e-03           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   tar_fn =      -0.895911263389       residual = 1.09e-03           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   tar_fn =      -0.900748293517       residual = 1.36e-04           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   tar_fn =      -0.905996899263       residual = 3.01e-03           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   tar_fn =      -0.908529534603       residual = 6.25e-03           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   tar_fn =      -0.892089056544       residual = 6.13e-03           smallest_sin_value = 1.00e+00
davidson iteration   31:   krylov dim =  32   tar_fn =      -0.917384741320       residual = 2.86e-02           smallest_sin_value = 1.00e+00
davidson iteration   32:   krylov dim =  33   tar_fn =      -0.917341031343       residual = 2.59e-02           smallest_sin_value = 1.00e+00
davidson iteration   33:   krylov dim =  34   tar_fn =      -0.871513427916       residual = 6.34e-02           smallest_sin_value = 1.00e+00
davidson iteration   34:   krylov dim =  35   tar_fn =      -0.925209260292       residual = 5.43e-02           smallest_sin_value = 1.00e+00
davidson iteration   35:   krylov dim =  36   tar_fn =      -0.897087686181       residual = 7.13e-03           smallest_sin_value = 1.00e+00
davidson iteration   36:   krylov dim =  37   tar_fn =      -0.890522506320       residual = 1.68e-02           smallest_sin_value = 1.00e+00
davidson iteration   37:   krylov dim =  38   tar_fn =      -0.870101209054       residual = 1.24e-01           smallest_sin_value = 1.00e+00
davidson iteration   38:   krylov dim =  39   tar_fn =      -0.928671591570       residual = 6.96e-02           smallest_sin_value = 1.00e+00
davidson iteration   39:   krylov dim =  40   tar_fn =      -0.887070546033       residual = 1.70e-02           smallest_sin_value = 1.00e+00
davidson iteration   40:   krylov dim =  41   tar_fn =      -0.864744963608       residual = 1.21e-01           smallest_sin_value = 1.00e+00
davidson iteration   41:   krylov dim =  42   tar_fn =      -0.869056598829       residual = 2.23e-01           smallest_sin_value = 1.00e+00
davidson iteration   42:   krylov dim =  43   tar_fn =      -0.939260698377       residual = 1.27e-01           smallest_sin_value = 1.00e+00
davidson iteration   43:   krylov dim =  44   tar_fn =      -0.850689239766       residual = 2.25e-01           smallest_sin_value = 1.00e+00
davidson iteration   44:   krylov dim =  45   tar_fn =      -1.057736175628       residual = 2.39e+00           smallest_sin_value = 1.00e+00
davidson iteration   45:   krylov dim =  46   tar_fn =      -1.014181221736       residual = 2.66e+00           smallest_sin_value = 9.99e-01
davidson iteration   46:   krylov dim =  47   tar_fn =      -0.734505445237       residual = 4.06e+00           smallest_sin_value = 9.90e-01
davidson iteration   47 stopping due to small subspace S singular value of 6.24e-01
davidson solver did not converge after         47 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 6.2500e+11 is 2.802698e-15

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.844808 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.6292e+01
  </log>
  <optVariables href="H2O.s024.opt.xml">
 uu_0                 2.517233e-01 1 1  ON 0
 uu_1                 1.009440e-01 1 1  ON 1
 uu_2                 1.617079e-02 1 1  ON 2
 uu_3                -3.223684e-02 1 1  ON 3
 uu_4                -6.387117e-02 1 1  ON 4
 uu_5                -8.576607e-02 1 1  ON 5
 uu_6                -1.001312e-01 1 1  ON 6
 uu_7                -1.065673e-01 1 1  ON 7
 uu_8                -9.668739e-02 1 1  ON 8
 uu_9                -6.389513e-02 1 1  ON 9
 ud_0                 3.492134e-01 1 1  ON 10
 ud_1                 1.235409e-01 1 1  ON 11
 ud_2                 2.392782e-02 1 1  ON 12
 ud_3                -3.019578e-02 1 1  ON 13
 ud_4                -6.975615e-02 1 1  ON 14
 ud_5                -9.484122e-02 1 1  ON 15
 ud_6                -1.085598e-01 1 1  ON 16
 ud_7                -1.109505e-01 1 1  ON 17
 ud_8                -9.792103e-02 1 1  ON 18
 ud_9                -6.281979e-02 1 1  ON 19
 eO_0                -5.692885e-01 1 1  ON 20
 eO_1                -3.060844e-01 1 1  ON 21
 eO_2                 4.730127e-02 1 1  ON 22
 eO_3                 2.840620e-01 1 1  ON 23
 eO_4                 3.913445e-01 1 1  ON 24
 eO_5                 3.212389e-01 1 1  ON 25
 eO_6                 1.205694e-01 1 1  ON 26
 eO_7                -7.888705e-02 1 1  ON 27
 eO_8                -1.549102e-01 1 1  ON 28
 eO_9                -6.122098e-02 1 1  ON 29
eH1_0                -2.277697e-01 1 1  ON 30
eH1_1                -1.106400e-01 1 1  ON 31
eH1_2                -6.162952e-02 1 1  ON 32
eH1_3                -2.530653e-02 1 1  ON 33
eH1_4                 4.247832e-03 1 1  ON 34
eH1_5                 2.367079e-02 1 1  ON 35
eH1_6                 6.569443e-02 1 1  ON 36
eH1_7                 1.154361e-01 1 1  ON 37
eH1_8                 1.435221e-01 1 1  ON 38
eH1_9                 7.467419e-02 1 1  ON 39
eH2_0                -2.307043e-01 1 1  ON 40
eH2_1                -1.139386e-01 1 1  ON 41
eH2_2                -6.444539e-02 1 1  ON 42
eH2_3                -2.722663e-02 1 1  ON 43
eH2_4                 1.073593e-03 1 1  ON 44
eH2_5                 2.532957e-02 1 1  ON 45
eH2_6                 7.564477e-02 1 1  ON 46
eH2_7                 1.260027e-01 1 1  ON 47
eH2_8                 1.609124e-01 1 1  ON 48
eH2_9                 6.417217e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 24
    time step          = 0.05
    reference energy   = -16.8897
    reference variance = 0.198532
====================================================
  Execution time = 2.0614e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s024
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6899e+01
  VMC Evar = 3.0211e-01
  Total weights = 2.0000e+06
  Execution time = 1.8709e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.302029432509
                                         uncertainty =       0.004600414272

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.302029432509
                                         uncertainty =       0.004600414272

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000388656810
  error estimate for blocks of size 2^( 2) =       0.000405596318
  error estimate for blocks of size 2^( 3) =       0.000422960509
  error estimate for blocks of size 2^( 4) =       0.000438177813
  error estimate for blocks of size 2^( 5) =       0.000449205322
  error estimate for blocks of size 2^( 6) =       0.000455943118
  error estimate for blocks of size 2^( 7) =       0.000461623512

      target function =      -0.909547404750
              le_mean =     -16.898553058667
             les_mean =     285.863203556685
             stat err =       0.000451237441
             autocorr =       1.347962136586
   target nu stat err =       0.000451237441
   target dn stat err =       0.004443313188
      target stat err =       0.006637571851
              std dev =       0.549643731124
             le_variance =       0.302108231164

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.302029432509
                                         uncertainty =       0.004600414272

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.302029432509
                                         uncertainty =       0.004600414272

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000388656810
  error estimate for blocks of size 2^( 2) =       0.000405596318
  error estimate for blocks of size 2^( 3) =       0.000422960509
  error estimate for blocks of size 2^( 4) =       0.000438177813
  error estimate for blocks of size 2^( 5) =       0.000449205322
  error estimate for blocks of size 2^( 6) =       0.000455943118
  error estimate for blocks of size 2^( 7) =       0.000461623512

      target function =      -0.909547404750
              le_mean =     -16.898553058667
             les_mean =     285.863203556685
             stat err =       0.000451237441
             autocorr =       1.347962136595
   target nu stat err =       0.000451237441
   target dn stat err =       0.004443313188
      target stat err =       0.006637571851
              std dev =       0.549643731124
             le_variance =       0.302108231164

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.302029432509
                                         uncertainty =       0.004600414272

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.302029432509
                                         uncertainty =       0.004600414272

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000388656810
  error estimate for blocks of size 2^( 2) =       0.000405596318
  error estimate for blocks of size 2^( 3) =       0.000422960509
  error estimate for blocks of size 2^( 4) =       0.000438177813
  error estimate for blocks of size 2^( 5) =       0.000449205322
  error estimate for blocks of size 2^( 6) =       0.000455943118
  error estimate for blocks of size 2^( 7) =       0.000461623512

      target function =      -0.909547404750
              le_mean =     -16.898553058667
             les_mean =     285.863203556685
             stat err =       0.000451237441
             autocorr =       1.347962136596
   target nu stat err =       0.000451237441
   target dn stat err =       0.004443313188
      target stat err =       0.006637571851
              std dev =       0.549643731124
             le_variance =       0.302108231164

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.302029432509
                                         uncertainty =       0.004600414272

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.302029432509
                                         uncertainty =       0.004600414272

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000388656810
  error estimate for blocks of size 2^( 2) =       0.000405596318
  error estimate for blocks of size 2^( 3) =       0.000422960509
  error estimate for blocks of size 2^( 4) =       0.000438177813
  error estimate for blocks of size 2^( 5) =       0.000449205322
  error estimate for blocks of size 2^( 6) =       0.000455943118
  error estimate for blocks of size 2^( 7) =       0.000461623512

      target function =      -0.909547404750
              le_mean =     -16.898553058667
             les_mean =     285.863203556685
             stat err =       0.000451237441
             autocorr =       1.347962136583
   target nu stat err =       0.000451237441
   target dn stat err =       0.004443313188
      target stat err =       0.006637571851
              std dev =       0.549643731124
             le_variance =       0.302108231164


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.909547404750        initial
     3.9062e+10     3.9062e+11             4.5648e-14        -0.909547404750
     1.5625e+11     1.5625e+12             1.1700e-14        -0.909547404750  <--
     6.2500e+11     6.2500e+12             2.8027e-15        -0.909547404750

*****************************************************************************
Applying the update for shift_i =   1.5625e+11     and shift_s =   1.5625e+12
*****************************************************************************

  Execution time = 3.0070e+01
  </log>
  <optVariables href="H2O.s024.opt.xml">
 uu_0                 2.517233e-01 1 1  ON 0
 uu_1                 1.009440e-01 1 1  ON 1
 uu_2                 1.617079e-02 1 1  ON 2
 uu_3                -3.223684e-02 1 1  ON 3
 uu_4                -6.387117e-02 1 1  ON 4
 uu_5                -8.576607e-02 1 1  ON 5
 uu_6                -1.001312e-01 1 1  ON 6
 uu_7                -1.065673e-01 1 1  ON 7
 uu_8                -9.668739e-02 1 1  ON 8
 uu_9                -6.389513e-02 1 1  ON 9
 ud_0                 3.492134e-01 1 1  ON 10
 ud_1                 1.235409e-01 1 1  ON 11
 ud_2                 2.392782e-02 1 1  ON 12
 ud_3                -3.019578e-02 1 1  ON 13
 ud_4                -6.975615e-02 1 1  ON 14
 ud_5                -9.484122e-02 1 1  ON 15
 ud_6                -1.085598e-01 1 1  ON 16
 ud_7                -1.109505e-01 1 1  ON 17
 ud_8                -9.792103e-02 1 1  ON 18
 ud_9                -6.281979e-02 1 1  ON 19
 eO_0                -5.692885e-01 1 1  ON 20
 eO_1                -3.060844e-01 1 1  ON 21
 eO_2                 4.730127e-02 1 1  ON 22
 eO_3                 2.840620e-01 1 1  ON 23
 eO_4                 3.913445e-01 1 1  ON 24
 eO_5                 3.212389e-01 1 1  ON 25
 eO_6                 1.205694e-01 1 1  ON 26
 eO_7                -7.888705e-02 1 1  ON 27
 eO_8                -1.549102e-01 1 1  ON 28
 eO_9                -6.122098e-02 1 1  ON 29
eH1_0                -2.277697e-01 1 1  ON 30
eH1_1                -1.106400e-01 1 1  ON 31
eH1_2                -6.162952e-02 1 1  ON 32
eH1_3                -2.530653e-02 1 1  ON 33
eH1_4                 4.247832e-03 1 1  ON 34
eH1_5                 2.367079e-02 1 1  ON 35
eH1_6                 6.569443e-02 1 1  ON 36
eH1_7                 1.154361e-01 1 1  ON 37
eH1_8                 1.435221e-01 1 1  ON 38
eH1_9                 7.467419e-02 1 1  ON 39
eH2_0                -2.307043e-01 1 1  ON 40
eH2_1                -1.139386e-01 1 1  ON 41
eH2_2                -6.444539e-02 1 1  ON 42
eH2_3                -2.722663e-02 1 1  ON 43
eH2_4                 1.073593e-03 1 1  ON 44
eH2_5                 2.532957e-02 1 1  ON 45
eH2_6                 7.564477e-02 1 1  ON 46
eH2_7                 1.260027e-01 1 1  ON 47
eH2_8                 1.609124e-01 1 1  ON 48
eH2_9                 6.417217e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.6368e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s025 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s025 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=25  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6903e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 25
    time step          = 0.05
    reference energy   = -16.9426
    reference variance = 0.6208
====================================================
  Execution time = 2.0977e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s025
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6897e+01
  VMC Evar = 2.8997e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.7549e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.289906522140
                                         uncertainty =       0.002325192259

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.289906522140
                                         uncertainty =       0.002325192259

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000380768296
  error estimate for blocks of size 2^( 2) =       0.000398357486
  error estimate for blocks of size 2^( 3) =       0.000416432649
  error estimate for blocks of size 2^( 4) =       0.000432610236
  error estimate for blocks of size 2^( 5) =       0.000444840558
  error estimate for blocks of size 2^( 6) =       0.000452972525
  error estimate for blocks of size 2^( 7) =       0.000457313186

      target function =      -0.927870252122
              le_mean =     -16.896893022747
             les_mean =     285.794962667980
             stat err =       0.000446934126
             autocorr =       1.377734306656
   target nu stat err =       0.000446934126
   target dn stat err =       0.002295431758
      target stat err =       0.003612843727
              std dev =       0.538487688630
             le_variance =       0.289968990806


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.689689302275e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 3.9062e+10, overlap shift 3.9062e+11 and omega -1.7456e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.927882791029       residual = 7.73e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.927882791029       residual = 3.08e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.927882791029       residual = 1.96e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.927882791029       residual = 9.04e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.927882791029       residual = 1.04e-04           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.927882791139       residual = 3.67e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.927882750773       residual = 5.26e-05           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.927897676235       residual = 2.84e-05           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.927942671806       residual = 1.75e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.927800303709       residual = 1.47e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.927873656754       residual = 9.42e-06           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.927985583411       residual = 5.22e-06           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.927836961175       residual = 4.38e-06           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.927817650112       residual = 6.03e-06           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.927851550873       residual = 4.90e-06           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.927844208778       residual = 2.35e-06           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.927744401983       residual = 2.49e-06           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.927863128349       residual = 1.20e-06           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.927896632625       residual = 7.90e-07           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.927976269692       residual = 1.71e-06           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.928007969892       residual = 2.31e-06           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.927738189912       residual = 2.09e-06           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.927916482049       residual = 4.19e-07           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.927891917292       residual = 2.63e-07           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.927843673037       residual = 6.87e-07           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =      -0.927825567376       residual = 8.89e-07           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   tar_fn =      -0.927970611011       residual = 1.18e-06           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   tar_fn =      -0.927917075604       residual = 9.77e-07           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   tar_fn =      -0.928115542262       residual = 6.09e-06           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   tar_fn =      -0.928367184460       residual = 2.01e-05           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   tar_fn =      -0.928241547859       residual = 1.25e-05           smallest_sin_value = 1.00e+00
davidson iteration   31:   krylov dim =  32   tar_fn =      -0.927704044842       residual = 5.61e-06           smallest_sin_value = 1.00e+00
davidson iteration   32:   krylov dim =  33   tar_fn =      -0.927847523001       residual = 5.03e-06           smallest_sin_value = 1.00e+00
davidson iteration   33:   krylov dim =  34   tar_fn =      -0.927849378361       residual = 1.89e-06           smallest_sin_value = 1.00e+00
davidson iteration   34:   krylov dim =  35   tar_fn =      -0.927804227599       residual = 6.19e-06           smallest_sin_value = 1.00e+00
davidson iteration   35:   krylov dim =  36   tar_fn =      -0.927642365084       residual = 9.45e-06           smallest_sin_value = 1.00e+00
davidson iteration   36:   krylov dim =  37   tar_fn =      -0.928725999024       residual = 7.54e-05           smallest_sin_value = 1.00e+00
davidson iteration   37:   krylov dim =  38   tar_fn =      -0.926566201518       residual = 1.36e-04           smallest_sin_value = 1.00e+00
davidson iteration   38:   krylov dim =  39   tar_fn =      -0.929156899834       residual = 2.37e-04           smallest_sin_value = 1.00e+00
davidson iteration   39:   krylov dim =  40   tar_fn =      -0.928091144078       residual = 4.50e-05           smallest_sin_value = 1.00e+00
davidson iteration   40:   krylov dim =  41   tar_fn =      -0.928379882208       residual = 8.02e-05           smallest_sin_value = 1.00e+00
davidson iteration   41:   krylov dim =  42   tar_fn =      -0.928349665624       residual = 1.11e-04           smallest_sin_value = 1.00e+00
davidson iteration   42:   krylov dim =  43   tar_fn =      -0.929182517123       residual = 1.90e-04           smallest_sin_value = 1.00e+00
davidson iteration   43:   krylov dim =  44   tar_fn =      -0.925741101827       residual = 4.39e-04           smallest_sin_value = 1.00e+00
davidson iteration   44:   krylov dim =  45   tar_fn =      -0.926156536995       residual = 3.08e-04           smallest_sin_value = 1.00e+00
davidson iteration   45:   krylov dim =  46   tar_fn =      -0.916451764395       residual = 1.02e-02           smallest_sin_value = 9.99e-01
davidson iteration   46 stopping due to small subspace S singular value of 9.34e-01
davidson solver did not converge after         46 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.9062e+10 is 1.174546e-14

solving harmonic davidson linear method for identity shift 1.5625e+11, overlap shift 1.5625e+12 and omega -1.7456e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.927882791029       residual = 7.73e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.927882791029       residual = 3.08e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.927882791029       residual = 1.96e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.927882791029       residual = 9.19e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.927911448101       residual = 9.77e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.927885325965       residual = 3.83e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.927938294016       residual = 5.91e-05           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.928177673880       residual = 3.78e-05           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.927832522062       residual = 3.02e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.927575906803       residual = 2.10e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.928130036677       residual = 3.96e-05           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.927408125973       residual = 2.96e-05           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.927841293186       residual = 1.03e-05           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.927338741820       residual = 3.00e-05           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.927885046856       residual = 8.03e-06           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.927769024323       residual = 5.99e-06           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.927706967863       residual = 1.53e-05           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.927537431064       residual = 1.62e-05           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.927654425085       residual = 7.98e-06           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.928136654866       residual = 1.16e-05           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.928185892815       residual = 1.67e-05           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.927924531416       residual = 4.34e-06           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.927898198781       residual = 2.54e-06           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.927979741281       residual = 8.36e-06           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.928749891606       residual = 6.34e-05           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =      -0.927584119064       residual = 1.32e-05           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   tar_fn =      -0.927818079863       residual = 9.88e-06           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   tar_fn =      -0.927909550908       residual = 1.74e-05           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   tar_fn =      -0.927512440395       residual = 3.53e-05           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   tar_fn =      -0.927554345963       residual = 5.76e-05           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   tar_fn =      -0.928451505195       residual = 5.15e-05           smallest_sin_value = 1.00e+00
davidson iteration   31:   krylov dim =  32   tar_fn =      -0.927348539301       residual = 2.46e-05           smallest_sin_value = 1.00e+00
davidson iteration   32:   krylov dim =  33   tar_fn =      -0.927885557978       residual = 2.58e-05           smallest_sin_value = 1.00e+00
davidson iteration   33:   krylov dim =  34   tar_fn =      -0.928608319032       residual = 2.65e-04           smallest_sin_value = 1.00e+00
davidson iteration   34:   krylov dim =  35   tar_fn =      -0.928406582982       residual = 3.34e-04           smallest_sin_value = 1.00e+00
davidson iteration   35:   krylov dim =  36   tar_fn =      -0.927486137168       residual = 8.23e-05           smallest_sin_value = 1.00e+00
davidson iteration   36:   krylov dim =  37   tar_fn =      -0.927709463603       residual = 1.17e-04           smallest_sin_value = 1.00e+00
davidson iteration   37:   krylov dim =  38   tar_fn =      -0.930334441957       residual = 7.89e-04           smallest_sin_value = 1.00e+00
davidson iteration   38:   krylov dim =  39   tar_fn =      -0.925554004395       residual = 4.70e-04           smallest_sin_value = 1.00e+00
davidson iteration   39:   krylov dim =  40   tar_fn =      -0.922266667545       residual = 3.56e-03           smallest_sin_value = 1.00e+00
davidson iteration   40:   krylov dim =  41   tar_fn =      -0.926162375945       residual = 3.60e-04           smallest_sin_value = 1.00e+00
davidson iteration   41:   krylov dim =  42   tar_fn =      -0.925868823316       residual = 1.06e-03           smallest_sin_value = 1.00e+00
davidson iteration   42:   krylov dim =  43   tar_fn =      -0.930439161743       residual = 4.74e-03           smallest_sin_value = 1.00e+00
davidson iteration   43:   krylov dim =  44   tar_fn =      -0.925893631264       residual = 6.99e-04           smallest_sin_value = 1.00e+00
davidson iteration   44:   krylov dim =  45   tar_fn =      -0.929713101997       residual = 2.65e-03           smallest_sin_value = 1.00e+00
davidson iteration   45:   krylov dim =  46   tar_fn =      -0.943832561224       residual = 6.71e-02           smallest_sin_value = 1.00e+00
davidson iteration   46:   krylov dim =  47   tar_fn =      -0.966582867633       residual = 1.66e-01           smallest_sin_value = 9.95e-01
davidson iteration   47 stopping due to small subspace S singular value of 9.73e-01
davidson solver did not converge after         47 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.5625e+11 is 2.612339e-15

solving harmonic davidson linear method for identity shift 6.2500e+11, overlap shift 6.2500e+12 and omega -1.7456e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.927882791029       residual = 7.73e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.927882791029       residual = 3.08e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.927882791029       residual = 1.87e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.927882791029       residual = 9.03e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.927841467056       residual = 1.37e-04           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.927882791219       residual = 5.57e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.927881321212       residual = 5.34e-05           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.926994327545       residual = 1.33e-04           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.928894526657       residual = 4.29e-04           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.926959740238       residual = 3.77e-04           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.930487414828       residual = 6.79e-04           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.927114823708       residual = 2.57e-04           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.926876247648       residual = 1.30e-04           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.928835112552       residual = 1.30e-04           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.930132979879       residual = 6.57e-04           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.929301618355       residual = 2.21e-04           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.929405229939       residual = 2.24e-04           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.928020672069       residual = 1.83e-04           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.927673344403       residual = 3.83e-05           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.926528677060       residual = 3.41e-04           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.927237467554       residual = 7.15e-05           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.929221363452       residual = 3.13e-04           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.922828987460       residual = 2.56e-03           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.935325240589       residual = 4.91e-03           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.930740104219       residual = 7.87e-04           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =      -0.931259903160       residual = 1.45e-03           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   tar_fn =      -0.927485227940       residual = 2.07e-03           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   tar_fn =      -0.920266942132       residual = 1.42e-02           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   tar_fn =      -0.926782604547       residual = 3.66e-03           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   tar_fn =      -0.939925905282       residual = 1.17e-02           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   tar_fn =      -0.930523296573       residual = 1.38e-03           smallest_sin_value = 1.00e+00
davidson iteration   31:   krylov dim =  32   tar_fn =      -0.906191267013       residual = 4.16e-02           smallest_sin_value = 1.00e+00
davidson iteration   32:   krylov dim =  33   tar_fn =      -0.922282737624       residual = 9.01e-03           smallest_sin_value = 1.00e+00
davidson iteration   33:   krylov dim =  34   tar_fn =      -0.960860823198       residual = 9.96e-02           smallest_sin_value = 1.00e+00
davidson iteration   34:   krylov dim =  35   tar_fn =      -0.948631462900       residual = 4.71e-02           smallest_sin_value = 1.00e+00
davidson iteration   35:   krylov dim =  36   tar_fn =      -0.872470315206       residual = 2.66e-01           smallest_sin_value = 1.00e+00
davidson iteration   36:   krylov dim =  37   tar_fn =      -0.919892717964       residual = 8.33e-03           smallest_sin_value = 1.00e+00
davidson iteration   37:   krylov dim =  38   tar_fn =      -0.933702529627       residual = 9.91e-03           smallest_sin_value = 1.00e+00
davidson iteration   38:   krylov dim =  39   tar_fn =      -0.901201161633       residual = 8.90e-02           smallest_sin_value = 1.00e+00
davidson iteration   39:   krylov dim =  40   tar_fn =      -0.939197648724       residual = 1.38e-02           smallest_sin_value = 1.00e+00
davidson iteration   40:   krylov dim =  41   tar_fn =      -0.944887113089       residual = 3.41e-02           smallest_sin_value = 1.00e+00
davidson iteration   41:   krylov dim =  42   tar_fn =      -0.954322600236       residual = 7.37e-02           smallest_sin_value = 1.00e+00
davidson iteration   42:   krylov dim =  43   tar_fn =      -0.929740538773       residual = 3.97e-03           smallest_sin_value = 1.00e+00
davidson iteration   43:   krylov dim =  44   tar_fn =      -0.935376034720       residual = 1.13e-01           smallest_sin_value = 1.00e+00
davidson iteration   44:   krylov dim =  45   tar_fn =      -0.872401732792       residual = 9.44e-01           smallest_sin_value = 1.00e+00
davidson iteration   45:   krylov dim =  46   tar_fn =      -0.890564209177       residual = 2.44e+00           smallest_sin_value = 1.00e+00
davidson iteration   46:   krylov dim =  47   tar_fn =      -1.376200567361       residual = 1.63e+01           smallest_sin_value = 9.99e-01
davidson iteration   47 stopping due to small subspace S singular value of 9.30e-01
davidson solver did not converge after         47 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 6.2500e+11 is 4.137761e-16

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.957208 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.9975e+01
  </log>
  <optVariables href="H2O.s025.opt.xml">
 uu_0                 2.517233e-01 1 1  ON 0
 uu_1                 1.009440e-01 1 1  ON 1
 uu_2                 1.617079e-02 1 1  ON 2
 uu_3                -3.223684e-02 1 1  ON 3
 uu_4                -6.387117e-02 1 1  ON 4
 uu_5                -8.576607e-02 1 1  ON 5
 uu_6                -1.001312e-01 1 1  ON 6
 uu_7                -1.065673e-01 1 1  ON 7
 uu_8                -9.668739e-02 1 1  ON 8
 uu_9                -6.389513e-02 1 1  ON 9
 ud_0                 3.492134e-01 1 1  ON 10
 ud_1                 1.235409e-01 1 1  ON 11
 ud_2                 2.392782e-02 1 1  ON 12
 ud_3                -3.019578e-02 1 1  ON 13
 ud_4                -6.975615e-02 1 1  ON 14
 ud_5                -9.484122e-02 1 1  ON 15
 ud_6                -1.085598e-01 1 1  ON 16
 ud_7                -1.109505e-01 1 1  ON 17
 ud_8                -9.792103e-02 1 1  ON 18
 ud_9                -6.281979e-02 1 1  ON 19
 eO_0                -5.692885e-01 1 1  ON 20
 eO_1                -3.060844e-01 1 1  ON 21
 eO_2                 4.730127e-02 1 1  ON 22
 eO_3                 2.840620e-01 1 1  ON 23
 eO_4                 3.913445e-01 1 1  ON 24
 eO_5                 3.212389e-01 1 1  ON 25
 eO_6                 1.205694e-01 1 1  ON 26
 eO_7                -7.888705e-02 1 1  ON 27
 eO_8                -1.549102e-01 1 1  ON 28
 eO_9                -6.122098e-02 1 1  ON 29
eH1_0                -2.277697e-01 1 1  ON 30
eH1_1                -1.106400e-01 1 1  ON 31
eH1_2                -6.162952e-02 1 1  ON 32
eH1_3                -2.530653e-02 1 1  ON 33
eH1_4                 4.247832e-03 1 1  ON 34
eH1_5                 2.367079e-02 1 1  ON 35
eH1_6                 6.569443e-02 1 1  ON 36
eH1_7                 1.154361e-01 1 1  ON 37
eH1_8                 1.435221e-01 1 1  ON 38
eH1_9                 7.467419e-02 1 1  ON 39
eH2_0                -2.307043e-01 1 1  ON 40
eH2_1                -1.139386e-01 1 1  ON 41
eH2_2                -6.444539e-02 1 1  ON 42
eH2_3                -2.722663e-02 1 1  ON 43
eH2_4                 1.073593e-03 1 1  ON 44
eH2_5                 2.532957e-02 1 1  ON 45
eH2_6                 7.564477e-02 1 1  ON 46
eH2_7                 1.260027e-01 1 1  ON 47
eH2_8                 1.609124e-01 1 1  ON 48
eH2_9                 6.417217e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 25
    time step          = 0.05
    reference energy   = -16.8843
    reference variance = 0.315847
====================================================
  Execution time = 2.0813e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s025
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6897e+01
  VMC Evar = 2.9903e-01
  Total weights = 2.0000e+06
  Execution time = 1.8741e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.299112574661
                                         uncertainty =       0.004314801029

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.299112574661
                                         uncertainty =       0.004314801029

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000386674924
  error estimate for blocks of size 2^( 2) =       0.000403833331
  error estimate for blocks of size 2^( 3) =       0.000421730174
  error estimate for blocks of size 2^( 4) =       0.000437457425
  error estimate for blocks of size 2^( 5) =       0.000449562548
  error estimate for blocks of size 2^( 6) =       0.000457770154
  error estimate for blocks of size 2^( 7) =       0.000461351470

      target function =      -0.914082268456
              le_mean =     -16.897094347897
             les_mean =     285.810832245413
             stat err =       0.000451535399
             autocorr =       1.363614436081
   target nu stat err =       0.000451535399
   target dn stat err =       0.004535869972
      target stat err =       0.006823678312
              std dev =       0.546840921280
             le_variance =       0.299034993187

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.299112574661
                                         uncertainty =       0.004314801029

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.299112574661
                                         uncertainty =       0.004314801029

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000386674924
  error estimate for blocks of size 2^( 2) =       0.000403833331
  error estimate for blocks of size 2^( 3) =       0.000421730174
  error estimate for blocks of size 2^( 4) =       0.000437457425
  error estimate for blocks of size 2^( 5) =       0.000449562548
  error estimate for blocks of size 2^( 6) =       0.000457770154
  error estimate for blocks of size 2^( 7) =       0.000461351470

      target function =      -0.914082268456
              le_mean =     -16.897094347897
             les_mean =     285.810832245413
             stat err =       0.000451535399
             autocorr =       1.363614436078
   target nu stat err =       0.000451535399
   target dn stat err =       0.004535869972
      target stat err =       0.006823678312
              std dev =       0.546840921280
             le_variance =       0.299034993187

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.299112574661
                                         uncertainty =       0.004314801029

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.299112574661
                                         uncertainty =       0.004314801029

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000386674924
  error estimate for blocks of size 2^( 2) =       0.000403833331
  error estimate for blocks of size 2^( 3) =       0.000421730174
  error estimate for blocks of size 2^( 4) =       0.000437457425
  error estimate for blocks of size 2^( 5) =       0.000449562548
  error estimate for blocks of size 2^( 6) =       0.000457770154
  error estimate for blocks of size 2^( 7) =       0.000461351470

      target function =      -0.914082268456
              le_mean =     -16.897094347897
             les_mean =     285.810832245413
             stat err =       0.000451535399
             autocorr =       1.363614436079
   target nu stat err =       0.000451535399
   target dn stat err =       0.004535869972
      target stat err =       0.006823678312
              std dev =       0.546840921280
             le_variance =       0.299034993187

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.299112574661
                                         uncertainty =       0.004314801029

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.299112574661
                                         uncertainty =       0.004314801029

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000386674924
  error estimate for blocks of size 2^( 2) =       0.000403833331
  error estimate for blocks of size 2^( 3) =       0.000421730174
  error estimate for blocks of size 2^( 4) =       0.000437457425
  error estimate for blocks of size 2^( 5) =       0.000449562548
  error estimate for blocks of size 2^( 6) =       0.000457770154
  error estimate for blocks of size 2^( 7) =       0.000461351470

      target function =      -0.914082268456
              le_mean =     -16.897094347897
             les_mean =     285.810832245413
             stat err =       0.000451535399
             autocorr =       1.363614436078
   target nu stat err =       0.000451535399
   target dn stat err =       0.004535869972
      target stat err =       0.006823678312
              std dev =       0.546840921280
             le_variance =       0.299034993187


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.914082268456        initial  <--
     3.9062e+10     3.9062e+11             1.1745e-14        -0.914082268456
     1.5625e+11     1.5625e+12             2.6123e-15        -0.914082268456
     6.2500e+11     6.2500e+12             4.1378e-16        -0.914082268456

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 30.2709
  </log>
  <optVariables href="H2O.s025.opt.xml">
 uu_0                 2.517233e-01 1 1  ON 0
 uu_1                 1.009440e-01 1 1  ON 1
 uu_2                 1.617079e-02 1 1  ON 2
 uu_3                -3.223684e-02 1 1  ON 3
 uu_4                -6.387117e-02 1 1  ON 4
 uu_5                -8.576607e-02 1 1  ON 5
 uu_6                -1.001312e-01 1 1  ON 6
 uu_7                -1.065673e-01 1 1  ON 7
 uu_8                -9.668739e-02 1 1  ON 8
 uu_9                -6.389513e-02 1 1  ON 9
 ud_0                 3.492134e-01 1 1  ON 10
 ud_1                 1.235409e-01 1 1  ON 11
 ud_2                 2.392782e-02 1 1  ON 12
 ud_3                -3.019578e-02 1 1  ON 13
 ud_4                -6.975615e-02 1 1  ON 14
 ud_5                -9.484122e-02 1 1  ON 15
 ud_6                -1.085598e-01 1 1  ON 16
 ud_7                -1.109505e-01 1 1  ON 17
 ud_8                -9.792103e-02 1 1  ON 18
 ud_9                -6.281979e-02 1 1  ON 19
 eO_0                -5.692885e-01 1 1  ON 20
 eO_1                -3.060844e-01 1 1  ON 21
 eO_2                 4.730127e-02 1 1  ON 22
 eO_3                 2.840620e-01 1 1  ON 23
 eO_4                 3.913445e-01 1 1  ON 24
 eO_5                 3.212389e-01 1 1  ON 25
 eO_6                 1.205694e-01 1 1  ON 26
 eO_7                -7.888705e-02 1 1  ON 27
 eO_8                -1.549102e-01 1 1  ON 28
 eO_9                -6.122098e-02 1 1  ON 29
eH1_0                -2.277697e-01 1 1  ON 30
eH1_1                -1.106400e-01 1 1  ON 31
eH1_2                -6.162952e-02 1 1  ON 32
eH1_3                -2.530653e-02 1 1  ON 33
eH1_4                 4.247832e-03 1 1  ON 34
eH1_5                 2.367079e-02 1 1  ON 35
eH1_6                 6.569443e-02 1 1  ON 36
eH1_7                 1.154361e-01 1 1  ON 37
eH1_8                 1.435221e-01 1 1  ON 38
eH1_9                 7.467419e-02 1 1  ON 39
eH2_0                -2.307043e-01 1 1  ON 40
eH2_1                -1.139386e-01 1 1  ON 41
eH2_2                -6.444539e-02 1 1  ON 42
eH2_3                -2.722663e-02 1 1  ON 43
eH2_4                 1.073593e-03 1 1  ON 44
eH2_5                 2.532957e-02 1 1  ON 45
eH2_6                 7.564477e-02 1 1  ON 46
eH2_7                 1.260027e-01 1 1  ON 47
eH2_8                 1.609124e-01 1 1  ON 48
eH2_9                 6.417217e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 6.0252e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s026 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s026 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=26  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6903e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 26
    time step          = 0.05
    reference energy   = -16.9004
    reference variance = 0.132188
====================================================
  Execution time = 2.1070e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s026
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6898e+01
  VMC Evar = 3.0024e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.4842e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.300233851982
                                         uncertainty =       0.005224747480

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.300233851982
                                         uncertainty =       0.005224747480

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000387454462
  error estimate for blocks of size 2^( 2) =       0.000404180584
  error estimate for blocks of size 2^( 3) =       0.000421560084
  error estimate for blocks of size 2^( 4) =       0.000436576233
  error estimate for blocks of size 2^( 5) =       0.000447150009
  error estimate for blocks of size 2^( 6) =       0.000455110895
  error estimate for blocks of size 2^( 7) =       0.000461683146

      target function =      -0.912291356573
              le_mean =     -16.898065099093
             les_mean =     285.844845863120
             stat err =       0.000450130071
             autocorr =       1.349692146751
   target nu stat err =       0.000450130071
   target dn stat err =       0.005338590943
      target stat err =       0.008000776254
              std dev =       0.547943354789
             le_variance =       0.300241920058


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.689806509909e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 3.9062e+11, overlap shift 3.9062e+12 and omega -1.7456e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.912359708042       residual = 3.41e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.912359708042       residual = 8.32e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.912359708042       residual = 4.92e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.912359708042       residual = 3.71e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.912340659257       residual = 1.42e-04           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.912359708042       residual = 1.48e-04           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.912359708042       residual = 1.24e-04           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.912122825884       residual = 1.94e-04           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.911244086590       residual = 3.02e-04           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.912319638881       residual = 1.38e-04           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.912305847800       residual = 1.01e-04           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.913173126601       residual = 8.69e-05           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.912151313499       residual = 2.29e-04           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.912439025024       residual = 3.60e-05           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.911463372766       residual = 1.27e-04           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.911935505822       residual = 8.83e-05           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.912863689542       residual = 4.29e-05           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.915156060354       residual = 6.10e-04           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.910811737082       residual = 2.13e-04           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.912985990788       residual = 7.93e-05           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.912193809469       residual = 3.74e-05           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.910391680091       residual = 3.65e-04           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.912341861967       residual = 2.09e-05           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.911674639582       residual = 6.20e-05           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.913144108103       residual = 3.55e-04           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =      -0.912139861236       residual = 1.41e-04           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   tar_fn =      -0.911298145040       residual = 5.75e-04           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   tar_fn =      -0.911887660837       residual = 3.37e-04           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   tar_fn =      -0.911924046814       residual = 1.06e-04           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   tar_fn =      -0.911288751419       residual = 2.13e-04           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   tar_fn =      -0.906436747326       residual = 4.03e-03           smallest_sin_value = 1.00e+00
davidson iteration   31:   krylov dim =  32   tar_fn =      -0.913067161993       residual = 1.55e-03           smallest_sin_value = 1.00e+00
davidson iteration   32:   krylov dim =  33   tar_fn =      -0.919648439658       residual = 4.42e-03           smallest_sin_value = 1.00e+00
davidson iteration   33:   krylov dim =  34   tar_fn =      -0.913716475162       residual = 4.24e-04           smallest_sin_value = 1.00e+00
davidson iteration   34:   krylov dim =  35   tar_fn =      -0.905875526001       residual = 5.95e-03           smallest_sin_value = 1.00e+00
davidson iteration   35:   krylov dim =  36   tar_fn =      -0.906032300579       residual = 4.16e-03           smallest_sin_value = 1.00e+00
davidson iteration   36:   krylov dim =  37   tar_fn =      -0.905519993367       residual = 4.76e-03           smallest_sin_value = 1.00e+00
davidson iteration   37:   krylov dim =  38   tar_fn =      -0.916769502070       residual = 4.99e-03           smallest_sin_value = 1.00e+00
davidson iteration   38:   krylov dim =  39   tar_fn =      -0.922675456669       residual = 3.26e-02           smallest_sin_value = 1.00e+00
davidson iteration   39:   krylov dim =  40   tar_fn =      -0.914894718359       residual = 2.54e-03           smallest_sin_value = 1.00e+00
davidson iteration   40:   krylov dim =  41   tar_fn =      -0.918324354487       residual = 1.57e-02           smallest_sin_value = 1.00e+00
davidson iteration   41:   krylov dim =  42   tar_fn =      -0.925174618498       residual = 3.45e-02           smallest_sin_value = 1.00e+00
davidson iteration   42:   krylov dim =  43   tar_fn =      -0.898150324786       residual = 2.27e-02           smallest_sin_value = 1.00e+00
davidson iteration   43:   krylov dim =  44   tar_fn =      -0.928119266283       residual = 7.61e-02           smallest_sin_value = 1.00e+00
davidson iteration   44:   krylov dim =  45   tar_fn =      -0.898425169969       residual = 1.84e-02           smallest_sin_value = 1.00e+00
davidson iteration   45:   krylov dim =  46   tar_fn =      -0.896843144697       residual = 2.74e-02           smallest_sin_value = 1.00e+00
davidson iteration   46:   krylov dim =  47   tar_fn =      -0.904176259302       residual = 8.42e-02           smallest_sin_value = 9.97e-01
davidson iteration   47 stopping due to small subspace S singular value of 9.90e-01
davidson solver did not converge after         47 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.9062e+11 is 2.013139e-15

solving harmonic davidson linear method for identity shift 1.5625e+12, overlap shift 1.5625e+13 and omega -1.7456e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.912359708042       residual = 3.41e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.912359708042       residual = 8.32e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.912359708042       residual = 4.92e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.912359708042       residual = 3.71e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.912359708042       residual = 1.45e-04           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.912359708042       residual = 1.48e-04           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.912359708042       residual = 1.22e-04           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.912359708042       residual = 1.58e-04           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.912359708042       residual = 1.75e-04           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.912359708042       residual = 7.05e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.915179678952       residual = 1.83e-03           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.910442918060       residual = 6.18e-04           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.913174278073       residual = 1.09e-04           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.912707961679       residual = 2.99e-04           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.910503040855       residual = 4.01e-04           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.906025245776       residual = 3.27e-03           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.905973055373       residual = 4.42e-03           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.911158292868       residual = 8.23e-04           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.910123403336       residual = 1.88e-03           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.908559264997       residual = 1.72e-03           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.912250638514       residual = 8.66e-04           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.918050780890       residual = 3.97e-03           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.900237829212       residual = 1.29e-02           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.914795424961       residual = 1.13e-03           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.905142101932       residual = 5.71e-03           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =      -0.923001971093       residual = 9.86e-03           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   tar_fn =      -0.923668047481       residual = 1.27e-02           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   tar_fn =      -0.921816252026       residual = 1.31e-02           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   tar_fn =      -0.895902414826       residual = 2.08e-02           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   tar_fn =      -0.900313377915       residual = 1.27e-02           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   tar_fn =      -0.935867189961       residual = 5.33e-02           smallest_sin_value = 1.00e+00
davidson iteration   31:   krylov dim =  32   tar_fn =      -0.922223946289       residual = 1.45e-02           smallest_sin_value = 1.00e+00
davidson iteration   32:   krylov dim =  33   tar_fn =      -0.884040055664       residual = 8.14e-02           smallest_sin_value = 1.00e+00
davidson iteration   33:   krylov dim =  34   tar_fn =      -0.923473944476       residual = 2.73e-02           smallest_sin_value = 1.00e+00
davidson iteration   34:   krylov dim =  35   tar_fn =      -0.938836133445       residual = 7.76e-02           smallest_sin_value = 1.00e+00
davidson iteration   35:   krylov dim =  36   tar_fn =      -0.942222989118       residual = 8.66e-02           smallest_sin_value = 1.00e+00
davidson iteration   36:   krylov dim =  37   tar_fn =      -0.867247430547       residual = 2.96e-01           smallest_sin_value = 1.00e+00
davidson iteration   37:   krylov dim =  38   tar_fn =      -0.889408898670       residual = 7.06e-02           smallest_sin_value = 1.00e+00
davidson iteration   38:   krylov dim =  39   tar_fn =      -0.871407103514       residual = 1.60e-01           smallest_sin_value = 1.00e+00
davidson iteration   39:   krylov dim =  40   tar_fn =      -0.941908183794       residual = 6.88e-01           smallest_sin_value = 1.00e+00
davidson iteration   40:   krylov dim =  41   tar_fn =      -0.869287782162       residual = 2.88e-01           smallest_sin_value = 1.00e+00
davidson iteration   41:   krylov dim =  42   tar_fn =      -0.878195162454       residual = 2.11e-01           smallest_sin_value = 1.00e+00
davidson iteration   42:   krylov dim =  43   tar_fn =      -0.820539235544       residual = 6.73e-01           smallest_sin_value = 1.00e+00
davidson iteration   43:   krylov dim =  44   tar_fn =      -0.850543859045       residual = 4.47e-01           smallest_sin_value = 1.00e+00
davidson iteration   44:   krylov dim =  45   tar_fn =      -0.907900752217       residual = 6.07e-01           smallest_sin_value = 1.00e+00
davidson iteration   45:   krylov dim =  46   tar_fn =      -0.981977788597       residual = 1.27e+00           smallest_sin_value = 9.99e-01
davidson iteration   46 stopping due to small subspace S singular value of 9.88e-01
davidson solver did not converge after         46 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.5625e+12 is 4.078858e-16

solving harmonic davidson linear method for identity shift 6.2500e+12, overlap shift 6.2500e+13 and omega -1.7456e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.912359708042       residual = 3.41e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.912359708042       residual = 3.41e-03           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to small subspace S singular value of 7.11e-01
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 6.2500e+12 is 0.000000e+00

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               1.033189 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.6637e+01
  </log>
  <optVariables href="H2O.s026.opt.xml">
 uu_0                 2.517233e-01 1 1  ON 0
 uu_1                 1.009440e-01 1 1  ON 1
 uu_2                 1.617079e-02 1 1  ON 2
 uu_3                -3.223684e-02 1 1  ON 3
 uu_4                -6.387117e-02 1 1  ON 4
 uu_5                -8.576607e-02 1 1  ON 5
 uu_6                -1.001312e-01 1 1  ON 6
 uu_7                -1.065673e-01 1 1  ON 7
 uu_8                -9.668739e-02 1 1  ON 8
 uu_9                -6.389513e-02 1 1  ON 9
 ud_0                 3.492134e-01 1 1  ON 10
 ud_1                 1.235409e-01 1 1  ON 11
 ud_2                 2.392782e-02 1 1  ON 12
 ud_3                -3.019578e-02 1 1  ON 13
 ud_4                -6.975615e-02 1 1  ON 14
 ud_5                -9.484122e-02 1 1  ON 15
 ud_6                -1.085598e-01 1 1  ON 16
 ud_7                -1.109505e-01 1 1  ON 17
 ud_8                -9.792103e-02 1 1  ON 18
 ud_9                -6.281979e-02 1 1  ON 19
 eO_0                -5.692885e-01 1 1  ON 20
 eO_1                -3.060844e-01 1 1  ON 21
 eO_2                 4.730127e-02 1 1  ON 22
 eO_3                 2.840620e-01 1 1  ON 23
 eO_4                 3.913445e-01 1 1  ON 24
 eO_5                 3.212389e-01 1 1  ON 25
 eO_6                 1.205694e-01 1 1  ON 26
 eO_7                -7.888705e-02 1 1  ON 27
 eO_8                -1.549102e-01 1 1  ON 28
 eO_9                -6.122098e-02 1 1  ON 29
eH1_0                -2.277697e-01 1 1  ON 30
eH1_1                -1.106400e-01 1 1  ON 31
eH1_2                -6.162952e-02 1 1  ON 32
eH1_3                -2.530653e-02 1 1  ON 33
eH1_4                 4.247832e-03 1 1  ON 34
eH1_5                 2.367079e-02 1 1  ON 35
eH1_6                 6.569443e-02 1 1  ON 36
eH1_7                 1.154361e-01 1 1  ON 37
eH1_8                 1.435221e-01 1 1  ON 38
eH1_9                 7.467419e-02 1 1  ON 39
eH2_0                -2.307043e-01 1 1  ON 40
eH2_1                -1.139386e-01 1 1  ON 41
eH2_2                -6.444539e-02 1 1  ON 42
eH2_3                -2.722663e-02 1 1  ON 43
eH2_4                 1.073593e-03 1 1  ON 44
eH2_5                 2.532957e-02 1 1  ON 45
eH2_6                 7.564477e-02 1 1  ON 46
eH2_7                 1.260027e-01 1 1  ON 47
eH2_8                 1.609124e-01 1 1  ON 48
eH2_9                 6.417217e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 26
    time step          = 0.05
    reference energy   = -16.9482
    reference variance = 0.185666
====================================================
  Execution time = 2.0880e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s026
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6897e+01
  VMC Evar = 2.9561e-01
  Total weights = 2.0000e+06
  Execution time = 1.8806e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.295568892390
                                         uncertainty =       0.002755664605

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.295568892390
                                         uncertainty =       0.002755664605

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000384455291
  error estimate for blocks of size 2^( 2) =       0.000401487450
  error estimate for blocks of size 2^( 3) =       0.000419412708
  error estimate for blocks of size 2^( 4) =       0.000434356948
  error estimate for blocks of size 2^( 5) =       0.000446144320
  error estimate for blocks of size 2^( 6) =       0.000454496191
  error estimate for blocks of size 2^( 7) =       0.000458905962

      target function =      -0.919254203177
              le_mean =     -16.896927160148
             les_mean =     285.801759049255
             stat err =       0.000448475855
             autocorr =       1.360775397713
   target nu stat err =       0.000448475855
   target dn stat err =       0.002817755948
      target stat err =       0.004323854872
              std dev =       0.543701886791
             le_variance =       0.295611741700

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.295568892390
                                         uncertainty =       0.002755664605

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.295568892390
                                         uncertainty =       0.002755664605

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000384455291
  error estimate for blocks of size 2^( 2) =       0.000401487450
  error estimate for blocks of size 2^( 3) =       0.000419412708
  error estimate for blocks of size 2^( 4) =       0.000434356948
  error estimate for blocks of size 2^( 5) =       0.000446144320
  error estimate for blocks of size 2^( 6) =       0.000454496191
  error estimate for blocks of size 2^( 7) =       0.000458905962

      target function =      -0.919254203177
              le_mean =     -16.896927160148
             les_mean =     285.801759049255
             stat err =       0.000448475855
             autocorr =       1.360775397716
   target nu stat err =       0.000448475855
   target dn stat err =       0.002817755948
      target stat err =       0.004323854872
              std dev =       0.543701886791
             le_variance =       0.295611741700

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.295568892390
                                         uncertainty =       0.002755664605

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.295568892390
                                         uncertainty =       0.002755664605

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000384455291
  error estimate for blocks of size 2^( 2) =       0.000401487450
  error estimate for blocks of size 2^( 3) =       0.000419412708
  error estimate for blocks of size 2^( 4) =       0.000434356948
  error estimate for blocks of size 2^( 5) =       0.000446144320
  error estimate for blocks of size 2^( 6) =       0.000454496191
  error estimate for blocks of size 2^( 7) =       0.000458905962

      target function =      -0.919254203177
              le_mean =     -16.896927160148
             les_mean =     285.801759049255
             stat err =       0.000448475855
             autocorr =       1.360775397714
   target nu stat err =       0.000448475855
   target dn stat err =       0.002817755948
      target stat err =       0.004323854872
              std dev =       0.543701886791
             le_variance =       0.295611741700

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.295568892390
                                         uncertainty =       0.002755664605

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.295568892390
                                         uncertainty =       0.002755664605

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000384455291
  error estimate for blocks of size 2^( 2) =       0.000401487450
  error estimate for blocks of size 2^( 3) =       0.000419412708
  error estimate for blocks of size 2^( 4) =       0.000434356948
  error estimate for blocks of size 2^( 5) =       0.000446144320
  error estimate for blocks of size 2^( 6) =       0.000454496191
  error estimate for blocks of size 2^( 7) =       0.000458905962

      target function =      -0.919254203177
              le_mean =     -16.896927160148
             les_mean =     285.801759049255
             stat err =       0.000448475855
             autocorr =       1.360775397713
   target nu stat err =       0.000448475855
   target dn stat err =       0.002817755948
      target stat err =       0.004323854872
              std dev =       0.543701886791
             le_variance =       0.295611741700


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.919254203177        initial
     3.9062e+11     3.9062e+12             2.0131e-15        -0.919254203177
     1.5625e+12     1.5625e+13             4.0789e-16        -0.919254203177  <--
     6.2500e+12     6.2500e+13             0.0000e+00        -0.919254203177

*****************************************************************************
Applying the update for shift_i =   1.5625e+12     and shift_s =   1.5625e+13
*****************************************************************************

  Execution time = 3.0376e+01
  </log>
  <optVariables href="H2O.s026.opt.xml">
 uu_0                 2.517233e-01 1 1  ON 0
 uu_1                 1.009440e-01 1 1  ON 1
 uu_2                 1.617079e-02 1 1  ON 2
 uu_3                -3.223684e-02 1 1  ON 3
 uu_4                -6.387117e-02 1 1  ON 4
 uu_5                -8.576607e-02 1 1  ON 5
 uu_6                -1.001312e-01 1 1  ON 6
 uu_7                -1.065673e-01 1 1  ON 7
 uu_8                -9.668739e-02 1 1  ON 8
 uu_9                -6.389513e-02 1 1  ON 9
 ud_0                 3.492134e-01 1 1  ON 10
 ud_1                 1.235409e-01 1 1  ON 11
 ud_2                 2.392782e-02 1 1  ON 12
 ud_3                -3.019578e-02 1 1  ON 13
 ud_4                -6.975615e-02 1 1  ON 14
 ud_5                -9.484122e-02 1 1  ON 15
 ud_6                -1.085598e-01 1 1  ON 16
 ud_7                -1.109505e-01 1 1  ON 17
 ud_8                -9.792103e-02 1 1  ON 18
 ud_9                -6.281979e-02 1 1  ON 19
 eO_0                -5.692885e-01 1 1  ON 20
 eO_1                -3.060844e-01 1 1  ON 21
 eO_2                 4.730127e-02 1 1  ON 22
 eO_3                 2.840620e-01 1 1  ON 23
 eO_4                 3.913445e-01 1 1  ON 24
 eO_5                 3.212389e-01 1 1  ON 25
 eO_6                 1.205694e-01 1 1  ON 26
 eO_7                -7.888705e-02 1 1  ON 27
 eO_8                -1.549102e-01 1 1  ON 28
 eO_9                -6.122098e-02 1 1  ON 29
eH1_0                -2.277697e-01 1 1  ON 30
eH1_1                -1.106400e-01 1 1  ON 31
eH1_2                -6.162952e-02 1 1  ON 32
eH1_3                -2.530653e-02 1 1  ON 33
eH1_4                 4.247832e-03 1 1  ON 34
eH1_5                 2.367079e-02 1 1  ON 35
eH1_6                 6.569443e-02 1 1  ON 36
eH1_7                 1.154361e-01 1 1  ON 37
eH1_8                 1.435221e-01 1 1  ON 38
eH1_9                 7.467419e-02 1 1  ON 39
eH2_0                -2.307043e-01 1 1  ON 40
eH2_1                -1.139386e-01 1 1  ON 41
eH2_2                -6.444539e-02 1 1  ON 42
eH2_3                -2.722663e-02 1 1  ON 43
eH2_4                 1.073593e-03 1 1  ON 44
eH2_5                 2.532957e-02 1 1  ON 45
eH2_6                 7.564477e-02 1 1  ON 46
eH2_7                 1.260027e-01 1 1  ON 47
eH2_8                 1.609124e-01 1 1  ON 48
eH2_9                 6.417217e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.7018e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s027 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s027 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=27  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6904e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 27
    time step          = 0.05
    reference energy   = -16.853
    reference variance = 0.243024
====================================================
  Execution time = 2.0957e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s027
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6897e+01
  VMC Evar = 2.9695e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.4828e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.296948279476
                                         uncertainty =       0.002910690601

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.296948279476
                                         uncertainty =       0.002910690601

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000385323790
  error estimate for blocks of size 2^( 2) =       0.000402578919
  error estimate for blocks of size 2^( 3) =       0.000420127397
  error estimate for blocks of size 2^( 4) =       0.000435045011
  error estimate for blocks of size 2^( 5) =       0.000446971819
  error estimate for blocks of size 2^( 6) =       0.000454575985
  error estimate for blocks of size 2^( 7) =       0.000458011985

      target function =      -0.917242219589
              le_mean =     -16.897151399418
             les_mean =     285.810674112751
             stat err =       0.000448651200
             autocorr =       1.355707566824
   target nu stat err =       0.000448651200
   target dn stat err =       0.003078431881
      target stat err =       0.004694294471
              std dev =       0.544930129814
             le_variance =       0.296948846380


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.689715139942e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 3.9062e+11, overlap shift 3.9062e+12 and omega -1.7456e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.917264834577       residual = 1.82e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.917264834577       residual = 4.75e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.917264834577       residual = 5.22e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.917264834577       residual = 2.32e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.917264834577       residual = 1.59e-04           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.917264834577       residual = 1.33e-04           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.917155243243       residual = 5.57e-05           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.916846157526       residual = 8.35e-05           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.917625149053       residual = 6.18e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.917274143105       residual = 5.71e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.918180084601       residual = 1.57e-04           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.917564819378       residual = 5.65e-05           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.917181470305       residual = 4.86e-05           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.916922891744       residual = 4.43e-05           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.917630377662       residual = 5.19e-05           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.916565728704       residual = 8.64e-05           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.916757638391       residual = 6.18e-05           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.917540703874       residual = 3.66e-05           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.916630979491       residual = 8.88e-05           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.919671489446       residual = 6.41e-04           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.915956558363       residual = 2.32e-04           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.916334712611       residual = 1.21e-04           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.917048358379       residual = 8.21e-05           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.917108524308       residual = 2.15e-05           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.912924936094       residual = 1.69e-03           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =      -0.913394867948       residual = 1.23e-03           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   tar_fn =      -0.918104797131       residual = 1.37e-04           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   tar_fn =      -0.915267007794       residual = 4.77e-04           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   tar_fn =      -0.916029914126       residual = 3.83e-04           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   tar_fn =      -0.917921051979       residual = 2.87e-04           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   tar_fn =      -0.918226668839       residual = 7.90e-04           smallest_sin_value = 1.00e+00
davidson iteration   31:   krylov dim =  32   tar_fn =      -0.919622362320       residual = 8.44e-04           smallest_sin_value = 1.00e+00
davidson iteration   32:   krylov dim =  33   tar_fn =      -0.918950916651       residual = 3.85e-04           smallest_sin_value = 1.00e+00
davidson iteration   33:   krylov dim =  34   tar_fn =      -0.925529719462       residual = 8.63e-03           smallest_sin_value = 1.00e+00
davidson iteration   34:   krylov dim =  35   tar_fn =      -0.912889156396       residual = 8.80e-03           smallest_sin_value = 1.00e+00
davidson iteration   35:   krylov dim =  36   tar_fn =      -0.925995748738       residual = 1.24e-02           smallest_sin_value = 1.00e+00
davidson iteration   36:   krylov dim =  37   tar_fn =      -0.911735968429       residual = 4.54e-03           smallest_sin_value = 1.00e+00
davidson iteration   37:   krylov dim =  38   tar_fn =      -0.925275348418       residual = 1.53e-02           smallest_sin_value = 1.00e+00
davidson iteration   38:   krylov dim =  39   tar_fn =      -0.913850018527       residual = 1.36e-03           smallest_sin_value = 1.00e+00
davidson iteration   39:   krylov dim =  40   tar_fn =      -0.914140444817       residual = 9.33e-03           smallest_sin_value = 1.00e+00
davidson iteration   40:   krylov dim =  41   tar_fn =      -0.924831076684       residual = 7.07e-03           smallest_sin_value = 1.00e+00
davidson iteration   41:   krylov dim =  42   tar_fn =      -0.918125328396       residual = 1.84e-02           smallest_sin_value = 1.00e+00
davidson iteration   42:   krylov dim =  43   tar_fn =      -0.932946044001       residual = 5.89e-02           smallest_sin_value = 1.00e+00
davidson iteration   43:   krylov dim =  44   tar_fn =      -0.908368681196       residual = 2.59e-02           smallest_sin_value = 1.00e+00
davidson iteration   44:   krylov dim =  45   tar_fn =      -0.899317506843       residual = 4.62e-01           smallest_sin_value = 1.00e+00
davidson iteration   45:   krylov dim =  46   tar_fn =      -0.853256899085       residual = 1.30e+00           smallest_sin_value = 1.00e+00
davidson iteration   46:   krylov dim =  47   tar_fn =      -0.293353940434       residual = 4.16e+01           smallest_sin_value = 1.00e+00
davidson iteration   47:   krylov dim =  48   tar_fn =      -0.838722958957       residual = 7.18e+00           smallest_sin_value = 9.95e-01
davidson iteration   48 stopping due to small subspace S singular value of 6.23e-01
davidson solver did not converge after         48 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.9062e+11 is 1.125849e-15

solving harmonic davidson linear method for identity shift 1.5625e+12, overlap shift 1.5625e+13 and omega -1.7456e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.917264834577       residual = 1.82e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.917264834577       residual = 4.75e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.917264834577       residual = 5.22e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.917264834577       residual = 2.07e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.917264834577       residual = 1.59e-04           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.917264847692       residual = 1.26e-04           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.917264787820       residual = 4.55e-05           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.918948030152       residual = 1.60e-03           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.916631545885       residual = 2.11e-03           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.916414818628       residual = 1.73e-04           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.919573839838       residual = 5.36e-04           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.913274543928       residual = 1.95e-03           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.914849090053       residual = 7.06e-04           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.913180442429       residual = 1.96e-03           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.909196964252       residual = 5.28e-03           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.918110628253       residual = 1.02e-03           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.922864168738       residual = 5.20e-03           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.923939418694       residual = 4.96e-03           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.922195236468       residual = 4.41e-03           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.921855116417       residual = 2.36e-03           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.920232795129       residual = 1.13e-03           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.917871104574       residual = 1.57e-03           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.915289631604       residual = 1.49e-03           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.925344984002       residual = 6.89e-03           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.910452217257       residual = 5.91e-03           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =      -0.921488937584       residual = 3.95e-03           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   tar_fn =      -0.915899196627       residual = 9.64e-03           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   tar_fn =      -0.914634026912       residual = 2.35e-02           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   tar_fn =      -0.914435025867       residual = 1.28e-02           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   tar_fn =      -0.903142023742       residual = 2.44e-02           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   tar_fn =      -0.918061539951       residual = 3.09e-03           smallest_sin_value = 1.00e+00
davidson iteration   31:   krylov dim =  32   tar_fn =      -0.855281608228       residual = 3.45e-01           smallest_sin_value = 1.00e+00
davidson iteration   32:   krylov dim =  33   tar_fn =      -0.876430071830       residual = 1.69e-01           smallest_sin_value = 1.00e+00
davidson iteration   33:   krylov dim =  34   tar_fn =      -0.931530249235       residual = 9.79e-02           smallest_sin_value = 1.00e+00
davidson iteration   34:   krylov dim =  35   tar_fn =      -0.936596733168       residual = 2.12e-01           smallest_sin_value = 1.00e+00
davidson iteration   35:   krylov dim =  36   tar_fn =      -0.920304447491       residual = 4.97e-02           smallest_sin_value = 1.00e+00
davidson iteration   36:   krylov dim =  37   tar_fn =      -0.900808571156       residual = 9.56e-02           smallest_sin_value = 1.00e+00
davidson iteration   37:   krylov dim =  38   tar_fn =      -0.920880925497       residual = 2.16e-02           smallest_sin_value = 1.00e+00
davidson iteration   38:   krylov dim =  39   tar_fn =      -0.897832789703       residual = 1.68e-01           smallest_sin_value = 1.00e+00
davidson iteration   39:   krylov dim =  40   tar_fn =      -0.928161448358       residual = 5.77e-01           smallest_sin_value = 1.00e+00
davidson iteration   40:   krylov dim =  41   tar_fn =      -0.898943989046       residual = 2.73e-01           smallest_sin_value = 1.00e+00
davidson iteration   41:   krylov dim =  42   tar_fn =      -0.913848446052       residual = 3.32e-01           smallest_sin_value = 1.00e+00
davidson iteration   42:   krylov dim =  43   tar_fn =      -0.951853696847       residual = 2.79e-01           smallest_sin_value = 1.00e+00
davidson iteration   43:   krylov dim =  44   tar_fn =      -0.956399416587       residual = 3.86e-01           smallest_sin_value = 1.00e+00
davidson iteration   44:   krylov dim =  45   tar_fn =      -0.939353578219       residual = 4.50e+00           smallest_sin_value = 1.00e+00
davidson iteration   45:   krylov dim =  46   tar_fn =      -0.892077567646       residual = 3.40e-01           smallest_sin_value = 9.93e-01
davidson iteration   46 stopping due to small subspace S singular value of 7.59e-01
davidson solver did not converge after         46 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.5625e+12 is 1.795902e-16

solving harmonic davidson linear method for identity shift 6.2500e+12, overlap shift 6.2500e+13 and omega -1.7456e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.917264834577       residual = 1.82e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.917264834577       residual = 4.75e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.917264834577       residual = 5.22e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.917264834577       residual = 2.32e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.917264834577       residual = 1.59e-04           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.917265141933       residual = 1.36e-04           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.916235211498       residual = 7.95e-04           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.916916427302       residual = 2.95e-04           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.925983884632       residual = 1.57e-02           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.924920857674       residual = 8.39e-03           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.925772211478       residual = 1.81e-02           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.905658400803       residual = 1.87e-02           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.903045084742       residual = 2.89e-02           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.904793145744       residual = 2.03e-02           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.917445656885       residual = 6.32e-03           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.925307000038       residual = 2.73e-02           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.908322877760       residual = 1.30e-02           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.919232732553       residual = 1.84e-02           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.927075148642       residual = 1.35e-02           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.922824282898       residual = 1.53e-02           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.915721816057       residual = 8.04e-03           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.970743538877       residual = 2.68e-01           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.887228237826       residual = 2.24e-01           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.919609952870       residual = 2.61e-02           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.932263952539       residual = 3.12e-02           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =      -0.855999570903       residual = 3.85e-01           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   tar_fn =      -0.880586858371       residual = 1.92e-01           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   tar_fn =      -0.915548819977       residual = 3.80e-02           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   tar_fn =      -0.903120826792       residual = 1.41e-01           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   tar_fn =      -1.058039998988       residual = 2.05e+00           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   tar_fn =      -0.832560002400       residual = 1.61e+00           smallest_sin_value = 1.00e+00
davidson iteration   31:   krylov dim =  32   tar_fn =      -0.944455515893       residual = 1.73e-01           smallest_sin_value = 1.00e+00
davidson iteration   32:   krylov dim =  33   tar_fn =      -0.958683525625       residual = 1.35e+00           smallest_sin_value = 1.00e+00
davidson iteration   33:   krylov dim =  34   tar_fn =      -1.004135077683       residual = 6.89e-01           smallest_sin_value = 1.00e+00
davidson iteration   34:   krylov dim =  35   tar_fn =      -0.646577551615       residual = 6.28e+00           smallest_sin_value = 1.00e+00
davidson iteration   35:   krylov dim =  36   tar_fn =      -0.798299907659       residual = 1.72e+00           smallest_sin_value = 1.00e+00
davidson iteration   36:   krylov dim =  37   tar_fn =      -1.140474873017       residual = 4.09e+00           smallest_sin_value = 1.00e+00
davidson iteration   37:   krylov dim =  38   tar_fn =      -0.956949572870       residual = 2.23e+00           smallest_sin_value = 1.00e+00
davidson iteration   38:   krylov dim =  39   tar_fn =      -1.129333764065       residual = 4.66e+00           smallest_sin_value = 1.00e+00
davidson iteration   39:   krylov dim =  40   tar_fn =      -0.911363994431       residual = 9.70e-01           smallest_sin_value = 1.00e+00
davidson iteration   40:   krylov dim =  41   tar_fn =      -1.227943771982       residual = 9.04e+00           smallest_sin_value = 1.00e+00
davidson iteration   41:   krylov dim =  42   tar_fn =      -1.135464267983       residual = 6.37e+00           smallest_sin_value = 1.00e+00
davidson iteration   42:   krylov dim =  43   tar_fn =      -0.898180152000       residual = 2.65e+00           smallest_sin_value = 1.00e+00
davidson iteration   43:   krylov dim =  44   tar_fn =      -0.901467481779       residual = 1.31e+02           smallest_sin_value = 1.00e+00
davidson iteration   44:   krylov dim =  45   tar_fn =      -0.011926077751       residual = 7.28e+01           smallest_sin_value = 1.00e+00
davidson iteration   45:   krylov dim =  46   tar_fn =      -0.069215417265       residual = 2.51e+02           smallest_sin_value = 9.99e-01
davidson iteration   46 stopping due to small subspace S singular value of 9.29e-01
davidson solver did not converge after         46 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 6.2500e+12 is 4.034399e-17

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               1.148283 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.6560e+01
  </log>
  <optVariables href="H2O.s027.opt.xml">
 uu_0                 2.517233e-01 1 1  ON 0
 uu_1                 1.009440e-01 1 1  ON 1
 uu_2                 1.617079e-02 1 1  ON 2
 uu_3                -3.223684e-02 1 1  ON 3
 uu_4                -6.387117e-02 1 1  ON 4
 uu_5                -8.576607e-02 1 1  ON 5
 uu_6                -1.001312e-01 1 1  ON 6
 uu_7                -1.065673e-01 1 1  ON 7
 uu_8                -9.668739e-02 1 1  ON 8
 uu_9                -6.389513e-02 1 1  ON 9
 ud_0                 3.492134e-01 1 1  ON 10
 ud_1                 1.235409e-01 1 1  ON 11
 ud_2                 2.392782e-02 1 1  ON 12
 ud_3                -3.019578e-02 1 1  ON 13
 ud_4                -6.975615e-02 1 1  ON 14
 ud_5                -9.484122e-02 1 1  ON 15
 ud_6                -1.085598e-01 1 1  ON 16
 ud_7                -1.109505e-01 1 1  ON 17
 ud_8                -9.792103e-02 1 1  ON 18
 ud_9                -6.281979e-02 1 1  ON 19
 eO_0                -5.692885e-01 1 1  ON 20
 eO_1                -3.060844e-01 1 1  ON 21
 eO_2                 4.730127e-02 1 1  ON 22
 eO_3                 2.840620e-01 1 1  ON 23
 eO_4                 3.913445e-01 1 1  ON 24
 eO_5                 3.212389e-01 1 1  ON 25
 eO_6                 1.205694e-01 1 1  ON 26
 eO_7                -7.888705e-02 1 1  ON 27
 eO_8                -1.549102e-01 1 1  ON 28
 eO_9                -6.122098e-02 1 1  ON 29
eH1_0                -2.277697e-01 1 1  ON 30
eH1_1                -1.106400e-01 1 1  ON 31
eH1_2                -6.162952e-02 1 1  ON 32
eH1_3                -2.530653e-02 1 1  ON 33
eH1_4                 4.247832e-03 1 1  ON 34
eH1_5                 2.367079e-02 1 1  ON 35
eH1_6                 6.569443e-02 1 1  ON 36
eH1_7                 1.154361e-01 1 1  ON 37
eH1_8                 1.435221e-01 1 1  ON 38
eH1_9                 7.467419e-02 1 1  ON 39
eH2_0                -2.307043e-01 1 1  ON 40
eH2_1                -1.139386e-01 1 1  ON 41
eH2_2                -6.444539e-02 1 1  ON 42
eH2_3                -2.722663e-02 1 1  ON 43
eH2_4                 1.073593e-03 1 1  ON 44
eH2_5                 2.532957e-02 1 1  ON 45
eH2_6                 7.564477e-02 1 1  ON 46
eH2_7                 1.260027e-01 1 1  ON 47
eH2_8                 1.609124e-01 1 1  ON 48
eH2_9                 6.417217e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 27
    time step          = 0.05
    reference energy   = -16.9731
    reference variance = 0.290362
====================================================
  Execution time = 2.2514e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s027
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6898e+01
  VMC Evar = 2.9434e-01
  Total weights = 2.0000e+06
  Execution time = 1.8804e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.294388327143
                                         uncertainty =       0.003608650181

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.294388327143
                                         uncertainty =       0.003608650181

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000383630465
  error estimate for blocks of size 2^( 2) =       0.000400715251
  error estimate for blocks of size 2^( 3) =       0.000418281032
  error estimate for blocks of size 2^( 4) =       0.000433687382
  error estimate for blocks of size 2^( 5) =       0.000445692074
  error estimate for blocks of size 2^( 6) =       0.000456368520
  error estimate for blocks of size 2^( 7) =       0.000463063795

      target function =      -0.921224207307
              le_mean =     -16.898182931484
             les_mean =     285.842930906375
             stat err =       0.000449702943
             autocorr =       1.374121965673
   target nu stat err =       0.000449702943
   target dn stat err =       0.003381812366
      target stat err =       0.005200222899
              std dev =       0.542535406827
             le_variance =       0.294344667661

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.294388327143
                                         uncertainty =       0.003608650181

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.294388327143
                                         uncertainty =       0.003608650181

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000383630465
  error estimate for blocks of size 2^( 2) =       0.000400715251
  error estimate for blocks of size 2^( 3) =       0.000418281032
  error estimate for blocks of size 2^( 4) =       0.000433687382
  error estimate for blocks of size 2^( 5) =       0.000445692074
  error estimate for blocks of size 2^( 6) =       0.000456368520
  error estimate for blocks of size 2^( 7) =       0.000463063795

      target function =      -0.921224207307
              le_mean =     -16.898182931484
             les_mean =     285.842930906375
             stat err =       0.000449702943
             autocorr =       1.374121965674
   target nu stat err =       0.000449702943
   target dn stat err =       0.003381812366
      target stat err =       0.005200222899
              std dev =       0.542535406827
             le_variance =       0.294344667661

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.294388327143
                                         uncertainty =       0.003608650181

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.294388327143
                                         uncertainty =       0.003608650181

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000383630465
  error estimate for blocks of size 2^( 2) =       0.000400715251
  error estimate for blocks of size 2^( 3) =       0.000418281032
  error estimate for blocks of size 2^( 4) =       0.000433687382
  error estimate for blocks of size 2^( 5) =       0.000445692074
  error estimate for blocks of size 2^( 6) =       0.000456368520
  error estimate for blocks of size 2^( 7) =       0.000463063795

      target function =      -0.921224207307
              le_mean =     -16.898182931484
             les_mean =     285.842930906375
             stat err =       0.000449702943
             autocorr =       1.374121965672
   target nu stat err =       0.000449702943
   target dn stat err =       0.003381812366
      target stat err =       0.005200222899
              std dev =       0.542535406827
             le_variance =       0.294344667661

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.294388327143
                                         uncertainty =       0.003608650181

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.294388327143
                                         uncertainty =       0.003608650181

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000383630465
  error estimate for blocks of size 2^( 2) =       0.000400715251
  error estimate for blocks of size 2^( 3) =       0.000418281032
  error estimate for blocks of size 2^( 4) =       0.000433687382
  error estimate for blocks of size 2^( 5) =       0.000445692074
  error estimate for blocks of size 2^( 6) =       0.000456368520
  error estimate for blocks of size 2^( 7) =       0.000463063795

      target function =      -0.921224207307
              le_mean =     -16.898182931484
             les_mean =     285.842930906375
             stat err =       0.000449702943
             autocorr =       1.374121965672
   target nu stat err =       0.000449702943
   target dn stat err =       0.003381812366
      target stat err =       0.005200222899
              std dev =       0.542535406827
             le_variance =       0.294344667661


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.921224207307        initial  <--
     3.9062e+11     3.9062e+12             1.1258e-15        -0.921224207307
     1.5625e+12     1.5625e+13             1.7959e-16        -0.921224207307
     6.2500e+12     6.2500e+13             4.0344e-17        -0.921224207307

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 32.0042
  </log>
  <optVariables href="H2O.s027.opt.xml">
 uu_0                 2.517233e-01 1 1  ON 0
 uu_1                 1.009440e-01 1 1  ON 1
 uu_2                 1.617079e-02 1 1  ON 2
 uu_3                -3.223684e-02 1 1  ON 3
 uu_4                -6.387117e-02 1 1  ON 4
 uu_5                -8.576607e-02 1 1  ON 5
 uu_6                -1.001312e-01 1 1  ON 6
 uu_7                -1.065673e-01 1 1  ON 7
 uu_8                -9.668739e-02 1 1  ON 8
 uu_9                -6.389513e-02 1 1  ON 9
 ud_0                 3.492134e-01 1 1  ON 10
 ud_1                 1.235409e-01 1 1  ON 11
 ud_2                 2.392782e-02 1 1  ON 12
 ud_3                -3.019578e-02 1 1  ON 13
 ud_4                -6.975615e-02 1 1  ON 14
 ud_5                -9.484122e-02 1 1  ON 15
 ud_6                -1.085598e-01 1 1  ON 16
 ud_7                -1.109505e-01 1 1  ON 17
 ud_8                -9.792103e-02 1 1  ON 18
 ud_9                -6.281979e-02 1 1  ON 19
 eO_0                -5.692885e-01 1 1  ON 20
 eO_1                -3.060844e-01 1 1  ON 21
 eO_2                 4.730127e-02 1 1  ON 22
 eO_3                 2.840620e-01 1 1  ON 23
 eO_4                 3.913445e-01 1 1  ON 24
 eO_5                 3.212389e-01 1 1  ON 25
 eO_6                 1.205694e-01 1 1  ON 26
 eO_7                -7.888705e-02 1 1  ON 27
 eO_8                -1.549102e-01 1 1  ON 28
 eO_9                -6.122098e-02 1 1  ON 29
eH1_0                -2.277697e-01 1 1  ON 30
eH1_1                -1.106400e-01 1 1  ON 31
eH1_2                -6.162952e-02 1 1  ON 32
eH1_3                -2.530653e-02 1 1  ON 33
eH1_4                 4.247832e-03 1 1  ON 34
eH1_5                 2.367079e-02 1 1  ON 35
eH1_6                 6.569443e-02 1 1  ON 36
eH1_7                 1.154361e-01 1 1  ON 37
eH1_8                 1.435221e-01 1 1  ON 38
eH1_9                 7.467419e-02 1 1  ON 39
eH2_0                -2.307043e-01 1 1  ON 40
eH2_1                -1.139386e-01 1 1  ON 41
eH2_2                -6.444539e-02 1 1  ON 42
eH2_3                -2.722663e-02 1 1  ON 43
eH2_4                 1.073593e-03 1 1  ON 44
eH2_5                 2.532957e-02 1 1  ON 45
eH2_6                 7.564477e-02 1 1  ON 46
eH2_7                 1.260027e-01 1 1  ON 47
eH2_8                 1.609124e-01 1 1  ON 48
eH2_9                 6.417217e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.8570e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s028 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s028 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=28  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6904e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 28
    time step          = 0.05
    reference energy   = -16.8483
    reference variance = 0.277102
====================================================
  Execution time = 2.0831e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s028
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6898e+01
  VMC Evar = 2.9959e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.4766e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.299645454690
                                         uncertainty =       0.004971782777

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.299645454690
                                         uncertainty =       0.004971782777

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000387032397
  error estimate for blocks of size 2^( 2) =       0.000403905722
  error estimate for blocks of size 2^( 3) =       0.000421637195
  error estimate for blocks of size 2^( 4) =       0.000437182613
  error estimate for blocks of size 2^( 5) =       0.000449065894
  error estimate for blocks of size 2^( 6) =       0.000456691620
  error estimate for blocks of size 2^( 7) =       0.000461308245

      target function =      -0.913261448989
              le_mean =     -16.897757889216
             les_mean =     285.833809685386
             stat err =       0.000451062093
             autocorr =       1.358244709547
   target nu stat err =       0.000451062093
   target dn stat err =       0.005203489291
      target stat err =       0.007812378986
              std dev =       0.547346464868
             le_variance =       0.299588152604


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.689775788922e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 3.9062e+12, overlap shift 3.9062e+13 and omega -1.7456e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.913326839870       residual = 1.30e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.913326839870       residual = 5.57e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.913326839870       residual = 3.96e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.913326839873       residual = 4.42e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.913326839908       residual = 3.37e-04           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.912087308500       residual = 8.50e-04           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.914123481616       residual = 4.56e-04           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.909654209187       residual = 5.34e-03           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.913364942203       residual = 4.35e-03           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.910978212895       residual = 8.02e-03           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.921322247963       residual = 7.45e-03           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.907450904080       residual = 5.80e-03           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.899754636117       residual = 2.45e-02           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.909703632682       residual = 2.57e-03           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.912288256239       residual = 4.95e-03           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.904099221865       residual = 1.68e-02           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.914138191847       residual = 1.38e-02           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.912701152554       residual = 1.27e-02           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.914140478520       residual = 2.16e-03           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.920760388885       residual = 1.72e-02           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.914004959120       residual = 7.00e-03           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.912938832239       residual = 4.91e-03           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.925487459996       residual = 1.54e-02           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.914167042878       residual = 4.49e-03           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.930928565320       residual = 2.85e-02           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =      -0.919347139967       residual = 7.63e-03           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   tar_fn =      -0.901499992742       residual = 4.13e-02           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   tar_fn =      -0.906900232863       residual = 1.64e-02           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   tar_fn =      -0.907978500375       residual = 1.57e-02           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   tar_fn =      -0.952040080045       residual = 1.60e-01           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   tar_fn =      -0.936415104579       residual = 6.65e-02           smallest_sin_value = 1.00e+00
davidson iteration   31:   krylov dim =  32   tar_fn =      -0.918091239257       residual = 2.06e-01           smallest_sin_value = 1.00e+00
davidson iteration   32:   krylov dim =  33   tar_fn =      -0.790470892985       residual = 1.69e+00           smallest_sin_value = 1.00e+00
davidson iteration   33:   krylov dim =  34   tar_fn =      -0.901039560760       residual = 2.62e-01           smallest_sin_value = 1.00e+00
davidson iteration   34:   krylov dim =  35   tar_fn =      -1.044156524449       residual = 1.71e+00           smallest_sin_value = 1.00e+00
davidson iteration   35:   krylov dim =  36   tar_fn =      -0.874272552928       residual = 4.77e-01           smallest_sin_value = 1.00e+00
davidson iteration   36:   krylov dim =  37   tar_fn =      -0.993693163348       residual = 6.33e-01           smallest_sin_value = 1.00e+00
davidson iteration   37:   krylov dim =  38   tar_fn =      -0.935516718273       residual = 2.54e-01           smallest_sin_value = 1.00e+00
davidson iteration   38:   krylov dim =  39   tar_fn =      -0.913788013708       residual = 1.33e-01           smallest_sin_value = 1.00e+00
davidson iteration   39:   krylov dim =  40   tar_fn =      -0.992114983425       residual = 1.32e+00           smallest_sin_value = 1.00e+00
davidson iteration   40:   krylov dim =  41   tar_fn =      -1.174082294098       residual = 5.51e+00           smallest_sin_value = 1.00e+00
davidson iteration   41:   krylov dim =  42   tar_fn =      -1.520983343912       residual = 4.50e+01           smallest_sin_value = 1.00e+00
davidson iteration   42:   krylov dim =  43   tar_fn =      -0.957688786382       residual = 1.07e+00           smallest_sin_value = 1.00e+00
davidson iteration   43:   krylov dim =  44   tar_fn =      -0.938781158355       residual = 1.77e+01           smallest_sin_value = 1.00e+00
davidson iteration   44:   krylov dim =  45   tar_fn =      -1.107537099308       residual = 8.58e+01           smallest_sin_value = 1.00e+00
davidson iteration   45:   krylov dim =  46   tar_fn =      -1.125741759633       residual = 6.60e+00           smallest_sin_value = 9.98e-01
davidson iteration   46 stopping due to small subspace S singular value of 9.50e-01
davidson solver did not converge after         46 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.9062e+12 is 6.957096e-17

solving harmonic davidson linear method for identity shift 1.5625e+13, overlap shift 1.5625e+14 and omega -1.7456e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.913326839870       residual = 1.30e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.913326839870       residual = 5.57e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.913326839870       residual = 3.96e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.915532678722       residual = 1.45e-02           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.904609836786       residual = 6.35e-02           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.913779637933       residual = 1.97e-03           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.910984876992       residual = 1.13e-02           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.903706458905       residual = 2.25e-02           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.906895870834       residual = 5.90e-02           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.915095984251       residual = 6.33e-02           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.911499886979       residual = 1.37e-02           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.918305263667       residual = 1.38e-02           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.900549098286       residual = 3.67e-02           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.907373837746       residual = 2.04e-02           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.808114130600       residual = 9.25e-01           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.861355458696       residual = 4.18e-01           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -1.034799602230       residual = 1.17e+00           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.894384739177       residual = 2.18e-01           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.877744505454       residual = 1.60e-01           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.934959513865       residual = 9.60e-02           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.880331867165       residual = 2.24e-01           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.925792598673       residual = 3.54e-01           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.964284520400       residual = 2.55e-01           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.863567616960       residual = 2.70e-01           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.841693542827       residual = 5.88e-01           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =      -0.732319532117       residual = 2.77e+00           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   tar_fn =      -0.704345756299       residual = 3.88e+00           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   tar_fn =      -0.906317945064       residual = 2.94e-01           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   tar_fn =      -0.783013340844       residual = 1.53e+00           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   tar_fn =      -0.819992040318       residual = 1.61e+00           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   tar_fn =      -0.947225719309       residual = 5.74e-01           smallest_sin_value = 1.00e+00
davidson iteration   31:   krylov dim =  32   tar_fn =      -1.041418017700       residual = 1.96e+00           smallest_sin_value = 1.00e+00
davidson iteration   32:   krylov dim =  33   tar_fn =      -0.293799131734       residual = 3.37e+01           smallest_sin_value = 1.00e+00
davidson iteration   33:   krylov dim =  34   tar_fn =       0.313717215329       residual = 1.39e+02           smallest_sin_value = 1.00e+00
davidson iteration   34:   krylov dim =  35   tar_fn =      -2.006355609815       residual = 1.06e+02           smallest_sin_value = 1.00e+00
davidson iteration   35:   krylov dim =  36   tar_fn =      -0.722943580696       residual = 3.49e+01           smallest_sin_value = 1.00e+00
davidson iteration   36:   krylov dim =  37   tar_fn =      -0.686237014259       residual = 1.01e+01           smallest_sin_value = 1.00e+00
davidson iteration   37:   krylov dim =  38   tar_fn =      -1.055609278141       residual = 4.38e+01           smallest_sin_value = 1.00e+00
davidson iteration   38:   krylov dim =  39   tar_fn =      -0.859209310965       residual = 9.39e+00           smallest_sin_value = 1.00e+00
davidson iteration   39:   krylov dim =  40   tar_fn =      -0.699870855497       residual = 1.05e+01           smallest_sin_value = 1.00e+00
davidson iteration   40:   krylov dim =  41   tar_fn =      -1.112161139916       residual = 3.74e+01           smallest_sin_value = 1.00e+00
davidson iteration   41:   krylov dim =  42   tar_fn =      -1.110022428356       residual = 1.69e+01           smallest_sin_value = 1.00e+00
davidson iteration   42:   krylov dim =  43   tar_fn =      -1.124807676005       residual = 2.24e+01           smallest_sin_value = 1.00e+00
davidson iteration   43:   krylov dim =  44   tar_fn =      -1.090298390632       residual = 4.45e+01           smallest_sin_value = 1.00e+00
davidson iteration   44:   krylov dim =  45   tar_fn =       0.827798042970       residual = 5.72e+02           smallest_sin_value = 1.00e+00
davidson iteration   45:   krylov dim =  46   tar_fn =      -1.761294552330       residual = 1.99e+02           smallest_sin_value = 9.93e-01
davidson iteration   46 stopping due to small subspace S singular value of 9.49e-01
davidson solver did not converge after         46 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.5625e+13 is 6.956454e-18

solving harmonic davidson linear method for identity shift 6.2500e+13, overlap shift 6.2500e+14 and omega -1.7456e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.913326839870       residual = 1.30e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.913326839870       residual = 5.57e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.913326839870       residual = 3.96e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.908450001037       residual = 3.67e-02           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.913326839873       residual = 2.81e-02           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.913327063316       residual = 1.51e-01           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.924522476325       residual = 1.12e-01           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.909815894965       residual = 2.85e-02           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.918537091873       residual = 2.89e+00           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.874202676738       residual = 4.25e-01           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.901999083887       residual = 5.31e-01           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.897370235087       residual = 1.39e+00           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.668901993759       residual = 5.08e+00           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -1.058626221157       residual = 2.74e+00           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -1.000539368959       residual = 2.49e+00           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -1.070253241801       residual = 4.27e+00           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.986922641362       residual = 2.15e+00           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.775496453511       residual = 2.56e+00           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.919388958989       residual = 5.78e+00           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.802168388365       residual = 2.07e+00           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.668062138612       residual = 9.27e+00           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.860402220776       residual = 2.45e+00           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -1.040606201207       residual = 5.03e+00           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -1.196750566155       residual = 1.44e+01           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.882256672588       residual = 5.81e+00           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =      -0.950817277142       residual = 2.95e+01           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   tar_fn =      -0.974135117060       residual = 2.41e+01           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   tar_fn =      -1.858059895536       residual = 1.43e+02           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   tar_fn =       0.379329134457       residual = 1.32e+02           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   tar_fn =      -0.977720387085       residual = 2.03e+01           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   tar_fn =       0.368248377926       residual = 1.84e+02           smallest_sin_value = 1.00e+00
davidson iteration   31:   krylov dim =  32   tar_fn =      -0.772551609289       residual = 7.34e+01           smallest_sin_value = 1.00e+00
davidson iteration   32:   krylov dim =  33   tar_fn =      -1.150736786333       residual = 8.23e+01           smallest_sin_value = 1.00e+00
davidson iteration   33:   krylov dim =  34   tar_fn =      -0.504482134868       residual = 5.38e+01           smallest_sin_value = 1.00e+00
davidson iteration   34:   krylov dim =  35   tar_fn =       3.268246903251       residual = 2.30e+03           smallest_sin_value = 1.00e+00
davidson iteration   35:   krylov dim =  36   tar_fn =      -3.086125721354       residual = 6.78e+02           smallest_sin_value = 1.00e+00
davidson iteration   36:   krylov dim =  37   tar_fn =      -3.485725937361       residual = 5.79e+02           smallest_sin_value = 1.00e+00
davidson iteration   37:   krylov dim =  38   tar_fn =       1.519740055986       residual = 7.63e+02           smallest_sin_value = 1.00e+00
davidson iteration   38:   krylov dim =  39   tar_fn =      -0.081829987625       residual = 8.79e+01           smallest_sin_value = 1.00e+00
davidson iteration   39:   krylov dim =  40   tar_fn =      -1.246701533202       residual = 5.50e+02           smallest_sin_value = 1.00e+00
davidson iteration   40:   krylov dim =  41   tar_fn =      -1.678449517571       residual = 1.11e+03           smallest_sin_value = 1.00e+00
davidson iteration   41:   krylov dim =  42   tar_fn =       5.272300409050       residual = 3.61e+03           smallest_sin_value = 1.00e+00
davidson iteration   42:   krylov dim =  43   tar_fn =      -4.235372013194       residual = 1.33e+03           smallest_sin_value = 1.00e+00
davidson iteration   43:   krylov dim =  44   tar_fn =      -2.345408200298       residual = 1.36e+03           smallest_sin_value = 1.00e+00
davidson iteration   44:   krylov dim =  45   tar_fn =      -6.098331080490       residual = 7.44e+03           smallest_sin_value = 9.97e-01
davidson iteration   45:   krylov dim =  46   tar_fn =       0.267603977340       residual = 6.93e+03           smallest_sin_value = 9.94e-01
davidson iteration   46 stopping due to too large eigenvalue change
davidson solver did not converge after         46 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 6.2500e+13 is 1.739114e-18

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               1.258963 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.6424e+01
  </log>
  <optVariables href="H2O.s028.opt.xml">
 uu_0                 2.517233e-01 1 1  ON 0
 uu_1                 1.009440e-01 1 1  ON 1
 uu_2                 1.617079e-02 1 1  ON 2
 uu_3                -3.223684e-02 1 1  ON 3
 uu_4                -6.387117e-02 1 1  ON 4
 uu_5                -8.576607e-02 1 1  ON 5
 uu_6                -1.001312e-01 1 1  ON 6
 uu_7                -1.065673e-01 1 1  ON 7
 uu_8                -9.668739e-02 1 1  ON 8
 uu_9                -6.389513e-02 1 1  ON 9
 ud_0                 3.492134e-01 1 1  ON 10
 ud_1                 1.235409e-01 1 1  ON 11
 ud_2                 2.392782e-02 1 1  ON 12
 ud_3                -3.019578e-02 1 1  ON 13
 ud_4                -6.975615e-02 1 1  ON 14
 ud_5                -9.484122e-02 1 1  ON 15
 ud_6                -1.085598e-01 1 1  ON 16
 ud_7                -1.109505e-01 1 1  ON 17
 ud_8                -9.792103e-02 1 1  ON 18
 ud_9                -6.281979e-02 1 1  ON 19
 eO_0                -5.692885e-01 1 1  ON 20
 eO_1                -3.060844e-01 1 1  ON 21
 eO_2                 4.730127e-02 1 1  ON 22
 eO_3                 2.840620e-01 1 1  ON 23
 eO_4                 3.913445e-01 1 1  ON 24
 eO_5                 3.212389e-01 1 1  ON 25
 eO_6                 1.205694e-01 1 1  ON 26
 eO_7                -7.888705e-02 1 1  ON 27
 eO_8                -1.549102e-01 1 1  ON 28
 eO_9                -6.122098e-02 1 1  ON 29
eH1_0                -2.277697e-01 1 1  ON 30
eH1_1                -1.106400e-01 1 1  ON 31
eH1_2                -6.162952e-02 1 1  ON 32
eH1_3                -2.530653e-02 1 1  ON 33
eH1_4                 4.247832e-03 1 1  ON 34
eH1_5                 2.367079e-02 1 1  ON 35
eH1_6                 6.569443e-02 1 1  ON 36
eH1_7                 1.154361e-01 1 1  ON 37
eH1_8                 1.435221e-01 1 1  ON 38
eH1_9                 7.467419e-02 1 1  ON 39
eH2_0                -2.307043e-01 1 1  ON 40
eH2_1                -1.139386e-01 1 1  ON 41
eH2_2                -6.444539e-02 1 1  ON 42
eH2_3                -2.722663e-02 1 1  ON 43
eH2_4                 1.073593e-03 1 1  ON 44
eH2_5                 2.532957e-02 1 1  ON 45
eH2_6                 7.564477e-02 1 1  ON 46
eH2_7                 1.260027e-01 1 1  ON 47
eH2_8                 1.609124e-01 1 1  ON 48
eH2_9                 6.417217e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 28
    time step          = 0.05
    reference energy   = -16.8664
    reference variance = 0.237681
====================================================
  Execution time = 2.0405e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s028
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6897e+01
  VMC Evar = 3.0243e-01
  Total weights = 2.0000e+06
  Execution time = 1.8801e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.302442982391
                                         uncertainty =       0.006239284954

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.302442982391
                                         uncertainty =       0.006239284954

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000388861254
  error estimate for blocks of size 2^( 2) =       0.000405740016
  error estimate for blocks of size 2^( 3) =       0.000423204844
  error estimate for blocks of size 2^( 4) =       0.000437850344
  error estimate for blocks of size 2^( 5) =       0.000448592682
  error estimate for blocks of size 2^( 6) =       0.000455278671
  error estimate for blocks of size 2^( 7) =       0.000458391645

      target function =      -0.909000542034
              le_mean =     -16.897422069997
             les_mean =     285.825298609513
             stat err =       0.000450028336
             autocorr =       1.339338568568
   target nu stat err =       0.000450028336
   target dn stat err =       0.006329086227
      target stat err =       0.009395027218
              std dev =       0.549932858730
             le_variance =       0.302426149111

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.302442982391
                                         uncertainty =       0.006239284954

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.302442982391
                                         uncertainty =       0.006239284954

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000388861254
  error estimate for blocks of size 2^( 2) =       0.000405740016
  error estimate for blocks of size 2^( 3) =       0.000423204844
  error estimate for blocks of size 2^( 4) =       0.000437850344
  error estimate for blocks of size 2^( 5) =       0.000448592682
  error estimate for blocks of size 2^( 6) =       0.000455278671
  error estimate for blocks of size 2^( 7) =       0.000458391645

      target function =      -0.909000542034
              le_mean =     -16.897422069997
             les_mean =     285.825298609513
             stat err =       0.000450028336
             autocorr =       1.339338568569
   target nu stat err =       0.000450028336
   target dn stat err =       0.006329086227
      target stat err =       0.009395027218
              std dev =       0.549932858730
             le_variance =       0.302426149111

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.302442982391
                                         uncertainty =       0.006239284954

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.302442982391
                                         uncertainty =       0.006239284954

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000388861254
  error estimate for blocks of size 2^( 2) =       0.000405740016
  error estimate for blocks of size 2^( 3) =       0.000423204844
  error estimate for blocks of size 2^( 4) =       0.000437850344
  error estimate for blocks of size 2^( 5) =       0.000448592682
  error estimate for blocks of size 2^( 6) =       0.000455278671
  error estimate for blocks of size 2^( 7) =       0.000458391645

      target function =      -0.909000542034
              le_mean =     -16.897422069997
             les_mean =     285.825298609513
             stat err =       0.000450028336
             autocorr =       1.339338568568
   target nu stat err =       0.000450028336
   target dn stat err =       0.006329086227
      target stat err =       0.009395027218
              std dev =       0.549932858730
             le_variance =       0.302426149111

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.302442982391
                                         uncertainty =       0.006239284954

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.302442982391
                                         uncertainty =       0.006239284954

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000388861254
  error estimate for blocks of size 2^( 2) =       0.000405740016
  error estimate for blocks of size 2^( 3) =       0.000423204844
  error estimate for blocks of size 2^( 4) =       0.000437850344
  error estimate for blocks of size 2^( 5) =       0.000448592682
  error estimate for blocks of size 2^( 6) =       0.000455278671
  error estimate for blocks of size 2^( 7) =       0.000458391645

      target function =      -0.909000542034
              le_mean =     -16.897422069997
             les_mean =     285.825298609513
             stat err =       0.000450028336
             autocorr =       1.339338568568
   target nu stat err =       0.000450028336
   target dn stat err =       0.006329086227
      target stat err =       0.009395027218
              std dev =       0.549932858730
             le_variance =       0.302426149111


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.909000542034        initial
     3.9062e+12     3.9062e+13             6.9571e-17        -0.909000542034  <--
     1.5625e+13     1.5625e+14             6.9565e-18        -0.909000542034
     6.2500e+13     6.2500e+14             1.7391e-18        -0.909000542034

*****************************************************************************
Applying the update for shift_i =   3.9062e+12     and shift_s =   3.9062e+13
*****************************************************************************

  Execution time = 3.0114e+01
  </log>
  <optVariables href="H2O.s028.opt.xml">
 uu_0                 2.517233e-01 1 1  ON 0
 uu_1                 1.009440e-01 1 1  ON 1
 uu_2                 1.617079e-02 1 1  ON 2
 uu_3                -3.223684e-02 1 1  ON 3
 uu_4                -6.387117e-02 1 1  ON 4
 uu_5                -8.576607e-02 1 1  ON 5
 uu_6                -1.001312e-01 1 1  ON 6
 uu_7                -1.065673e-01 1 1  ON 7
 uu_8                -9.668739e-02 1 1  ON 8
 uu_9                -6.389513e-02 1 1  ON 9
 ud_0                 3.492134e-01 1 1  ON 10
 ud_1                 1.235409e-01 1 1  ON 11
 ud_2                 2.392782e-02 1 1  ON 12
 ud_3                -3.019578e-02 1 1  ON 13
 ud_4                -6.975615e-02 1 1  ON 14
 ud_5                -9.484122e-02 1 1  ON 15
 ud_6                -1.085598e-01 1 1  ON 16
 ud_7                -1.109505e-01 1 1  ON 17
 ud_8                -9.792103e-02 1 1  ON 18
 ud_9                -6.281979e-02 1 1  ON 19
 eO_0                -5.692885e-01 1 1  ON 20
 eO_1                -3.060844e-01 1 1  ON 21
 eO_2                 4.730127e-02 1 1  ON 22
 eO_3                 2.840620e-01 1 1  ON 23
 eO_4                 3.913445e-01 1 1  ON 24
 eO_5                 3.212389e-01 1 1  ON 25
 eO_6                 1.205694e-01 1 1  ON 26
 eO_7                -7.888705e-02 1 1  ON 27
 eO_8                -1.549102e-01 1 1  ON 28
 eO_9                -6.122098e-02 1 1  ON 29
eH1_0                -2.277697e-01 1 1  ON 30
eH1_1                -1.106400e-01 1 1  ON 31
eH1_2                -6.162952e-02 1 1  ON 32
eH1_3                -2.530653e-02 1 1  ON 33
eH1_4                 4.247832e-03 1 1  ON 34
eH1_5                 2.367079e-02 1 1  ON 35
eH1_6                 6.569443e-02 1 1  ON 36
eH1_7                 1.154361e-01 1 1  ON 37
eH1_8                 1.435221e-01 1 1  ON 38
eH1_9                 7.467419e-02 1 1  ON 39
eH2_0                -2.307043e-01 1 1  ON 40
eH2_1                -1.139386e-01 1 1  ON 41
eH2_2                -6.444539e-02 1 1  ON 42
eH2_3                -2.722663e-02 1 1  ON 43
eH2_4                 1.073593e-03 1 1  ON 44
eH2_5                 2.532957e-02 1 1  ON 45
eH2_6                 7.564477e-02 1 1  ON 46
eH2_7                 1.260027e-01 1 1  ON 47
eH2_8                 1.609124e-01 1 1  ON 48
eH2_9                 6.417217e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.6544e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s029 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s029 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=29  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6903e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 29
    time step          = 0.05
    reference energy   = -16.948
    reference variance = 0.206845
====================================================
  Execution time = 2.0727e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s029
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6898e+01
  VMC Evar = 2.9574e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.4398e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.295713301961
                                         uncertainty =       0.003244287803

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.295713301961
                                         uncertainty =       0.003244287803

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000384540980
  error estimate for blocks of size 2^( 2) =       0.000401540234
  error estimate for blocks of size 2^( 3) =       0.000418306091
  error estimate for blocks of size 2^( 4) =       0.000433898798
  error estimate for blocks of size 2^( 5) =       0.000445937776
  error estimate for blocks of size 2^( 6) =       0.000453592426
  error estimate for blocks of size 2^( 7) =       0.000458739756

      target function =      -0.919081591676
              le_mean =     -16.897724811179
             les_mean =     285.828847177788
             stat err =       0.000448042189
             autocorr =       1.357539772388
   target nu stat err =       0.000448042189
   target dn stat err =       0.003314097892
      target stat err =       0.005070240140
              std dev =       0.543823069868
             le_variance =       0.295743531321


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.689772481118e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 9.7656e+11, overlap shift 9.7656e+12 and omega -1.7456e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.919108615345       residual = 1.44e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.919108615345       residual = 4.20e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.919108615345       residual = 2.71e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.919108615345       residual = 1.40e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.919838525492       residual = 3.82e-04           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.918389923808       residual = 1.62e-04           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.918476500778       residual = 1.53e-04           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.919205748483       residual = 8.81e-05           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.917885796707       residual = 4.96e-04           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.919259158000       residual = 8.38e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.918997335084       residual = 3.81e-05           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.916554968923       residual = 1.06e-03           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.921136709819       residual = 5.29e-04           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.918096002354       residual = 1.02e-03           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.922071298624       residual = 9.06e-04           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.920163919815       residual = 3.22e-04           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.918201428801       residual = 1.83e-04           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.918953976266       residual = 2.36e-04           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.919225385708       residual = 5.85e-04           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.913716431996       residual = 3.29e-03           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.919876957682       residual = 3.05e-04           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.920419744934       residual = 1.27e-03           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.918716828579       residual = 5.58e-04           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.918353901890       residual = 2.85e-04           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.920556230375       residual = 1.01e-03           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =      -0.919026091189       residual = 3.69e-04           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   tar_fn =      -0.923240867694       residual = 2.06e-03           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   tar_fn =      -0.921035117213       residual = 8.43e-04           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   tar_fn =      -0.911281980466       residual = 8.01e-03           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   tar_fn =      -0.912541934053       residual = 5.99e-03           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   tar_fn =      -0.914044324033       residual = 5.23e-03           smallest_sin_value = 1.00e+00
davidson iteration   31:   krylov dim =  32   tar_fn =      -0.907495787647       residual = 2.73e-02           smallest_sin_value = 1.00e+00
davidson iteration   32:   krylov dim =  33   tar_fn =      -0.909932172341       residual = 1.36e-02           smallest_sin_value = 1.00e+00
davidson iteration   33:   krylov dim =  34   tar_fn =      -0.912423726250       residual = 2.56e-02           smallest_sin_value = 1.00e+00
davidson iteration   34:   krylov dim =  35   tar_fn =      -0.870604408129       residual = 2.01e-01           smallest_sin_value = 1.00e+00
davidson iteration   35:   krylov dim =  36   tar_fn =      -0.917605803632       residual = 5.94e-03           smallest_sin_value = 1.00e+00
davidson iteration   36:   krylov dim =  37   tar_fn =      -0.922146867014       residual = 2.45e-03           smallest_sin_value = 1.00e+00
davidson iteration   37:   krylov dim =  38   tar_fn =      -0.900972995207       residual = 1.15e-01           smallest_sin_value = 1.00e+00
davidson iteration   38:   krylov dim =  39   tar_fn =      -0.936581126508       residual = 3.56e-02           smallest_sin_value = 1.00e+00
davidson iteration   39:   krylov dim =  40   tar_fn =      -0.888080126706       residual = 1.07e-01           smallest_sin_value = 1.00e+00
davidson iteration   40:   krylov dim =  41   tar_fn =      -0.902024235342       residual = 7.86e-02           smallest_sin_value = 1.00e+00
davidson iteration   41:   krylov dim =  42   tar_fn =      -0.876959957379       residual = 1.68e-01           smallest_sin_value = 1.00e+00
davidson iteration   42:   krylov dim =  43   tar_fn =      -0.925265486122       residual = 3.41e-02           smallest_sin_value = 1.00e+00
davidson iteration   43:   krylov dim =  44   tar_fn =      -0.872748037927       residual = 4.34e-01           smallest_sin_value = 1.00e+00
davidson iteration   44:   krylov dim =  45   tar_fn =      -0.969899851155       residual = 3.15e-01           smallest_sin_value = 1.00e+00
davidson iteration   45:   krylov dim =  46   tar_fn =      -0.859033600140       residual = 5.76e-01           smallest_sin_value = 1.00e+00
davidson iteration   46:   krylov dim =  47   tar_fn =      -0.994601893454       residual = 6.78e-01           smallest_sin_value = 9.99e-01
davidson iteration   47 stopping due to small subspace S singular value of 8.42e-01
davidson solver did not converge after         47 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.7656e+11 is 2.791015e-16

solving harmonic davidson linear method for identity shift 3.9062e+12, overlap shift 3.9062e+13 and omega -1.7456e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.919108615345       residual = 1.44e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.919108615345       residual = 1.44e-03           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to small subspace S singular value of 7.90e-01
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.9062e+12 is 0.000000e+00

solving harmonic davidson linear method for identity shift 1.5625e+13, overlap shift 1.5625e+14 and omega -1.7456e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.919108615345       residual = 1.44e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.919108615345       residual = 1.44e-03           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to small subspace S singular value of 7.90e-01
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.5625e+13 is 0.000000e+00

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               1.299012 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.6212e+01
  </log>
  <optVariables href="H2O.s029.opt.xml">
 uu_0                 2.517233e-01 1 1  ON 0
 uu_1                 1.009440e-01 1 1  ON 1
 uu_2                 1.617079e-02 1 1  ON 2
 uu_3                -3.223684e-02 1 1  ON 3
 uu_4                -6.387117e-02 1 1  ON 4
 uu_5                -8.576607e-02 1 1  ON 5
 uu_6                -1.001312e-01 1 1  ON 6
 uu_7                -1.065673e-01 1 1  ON 7
 uu_8                -9.668739e-02 1 1  ON 8
 uu_9                -6.389513e-02 1 1  ON 9
 ud_0                 3.492134e-01 1 1  ON 10
 ud_1                 1.235409e-01 1 1  ON 11
 ud_2                 2.392782e-02 1 1  ON 12
 ud_3                -3.019578e-02 1 1  ON 13
 ud_4                -6.975615e-02 1 1  ON 14
 ud_5                -9.484122e-02 1 1  ON 15
 ud_6                -1.085598e-01 1 1  ON 16
 ud_7                -1.109505e-01 1 1  ON 17
 ud_8                -9.792103e-02 1 1  ON 18
 ud_9                -6.281979e-02 1 1  ON 19
 eO_0                -5.692885e-01 1 1  ON 20
 eO_1                -3.060844e-01 1 1  ON 21
 eO_2                 4.730127e-02 1 1  ON 22
 eO_3                 2.840620e-01 1 1  ON 23
 eO_4                 3.913445e-01 1 1  ON 24
 eO_5                 3.212389e-01 1 1  ON 25
 eO_6                 1.205694e-01 1 1  ON 26
 eO_7                -7.888705e-02 1 1  ON 27
 eO_8                -1.549102e-01 1 1  ON 28
 eO_9                -6.122098e-02 1 1  ON 29
eH1_0                -2.277697e-01 1 1  ON 30
eH1_1                -1.106400e-01 1 1  ON 31
eH1_2                -6.162952e-02 1 1  ON 32
eH1_3                -2.530653e-02 1 1  ON 33
eH1_4                 4.247832e-03 1 1  ON 34
eH1_5                 2.367079e-02 1 1  ON 35
eH1_6                 6.569443e-02 1 1  ON 36
eH1_7                 1.154361e-01 1 1  ON 37
eH1_8                 1.435221e-01 1 1  ON 38
eH1_9                 7.467419e-02 1 1  ON 39
eH2_0                -2.307043e-01 1 1  ON 40
eH2_1                -1.139386e-01 1 1  ON 41
eH2_2                -6.444539e-02 1 1  ON 42
eH2_3                -2.722663e-02 1 1  ON 43
eH2_4                 1.073593e-03 1 1  ON 44
eH2_5                 2.532957e-02 1 1  ON 45
eH2_6                 7.564477e-02 1 1  ON 46
eH2_7                 1.260027e-01 1 1  ON 47
eH2_8                 1.609124e-01 1 1  ON 48
eH2_9                 6.417217e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 29
    time step          = 0.05
    reference energy   = -16.872
    reference variance = 0.18742
====================================================
  Execution time = 2.0363e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s029
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6899e+01
  VMC Evar = 2.9731e-01
  Total weights = 2.0000e+06
  Execution time = 1.8843e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.297361760328
                                         uncertainty =       0.003197561616

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.297361760328
                                         uncertainty =       0.003197561616

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000385560237
  error estimate for blocks of size 2^( 2) =       0.000402678491
  error estimate for blocks of size 2^( 3) =       0.000420183092
  error estimate for blocks of size 2^( 4) =       0.000436236884
  error estimate for blocks of size 2^( 5) =       0.000448084624
  error estimate for blocks of size 2^( 6) =       0.000455766010
  error estimate for blocks of size 2^( 7) =       0.000460349128

      target function =      -0.916767217103
              le_mean =     -16.899310149475
             les_mean =     285.883996771767
             stat err =       0.000450109161
             autocorr =       1.362859947734
   target nu stat err =       0.000450109161
   target dn stat err =       0.003421991829
      target stat err =       0.005221130622
              std dev =       0.545264515885
             le_variance =       0.297313392284

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.297361760328
                                         uncertainty =       0.003197561616

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.297361760328
                                         uncertainty =       0.003197561616

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000385560237
  error estimate for blocks of size 2^( 2) =       0.000402678491
  error estimate for blocks of size 2^( 3) =       0.000420183092
  error estimate for blocks of size 2^( 4) =       0.000436236884
  error estimate for blocks of size 2^( 5) =       0.000448084624
  error estimate for blocks of size 2^( 6) =       0.000455766010
  error estimate for blocks of size 2^( 7) =       0.000460349128

      target function =      -0.916767217103
              le_mean =     -16.899310149475
             les_mean =     285.883996771767
             stat err =       0.000450109161
             autocorr =       1.362859947734
   target nu stat err =       0.000450109161
   target dn stat err =       0.003421991829
      target stat err =       0.005221130622
              std dev =       0.545264515885
             le_variance =       0.297313392284

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.297361760328
                                         uncertainty =       0.003197561616

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.297361760328
                                         uncertainty =       0.003197561616

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000385560237
  error estimate for blocks of size 2^( 2) =       0.000402678491
  error estimate for blocks of size 2^( 3) =       0.000420183092
  error estimate for blocks of size 2^( 4) =       0.000436236884
  error estimate for blocks of size 2^( 5) =       0.000448084624
  error estimate for blocks of size 2^( 6) =       0.000455766010
  error estimate for blocks of size 2^( 7) =       0.000460349128

      target function =      -0.916767217103
              le_mean =     -16.899310149475
             les_mean =     285.883996771767
             stat err =       0.000450109161
             autocorr =       1.362859947734
   target nu stat err =       0.000450109161
   target dn stat err =       0.003421991829
      target stat err =       0.005221130622
              std dev =       0.545264515885
             le_variance =       0.297313392284

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.297361760328
                                         uncertainty =       0.003197561616

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.297361760328
                                         uncertainty =       0.003197561616

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000385560237
  error estimate for blocks of size 2^( 2) =       0.000402678491
  error estimate for blocks of size 2^( 3) =       0.000420183092
  error estimate for blocks of size 2^( 4) =       0.000436236884
  error estimate for blocks of size 2^( 5) =       0.000448084624
  error estimate for blocks of size 2^( 6) =       0.000455766010
  error estimate for blocks of size 2^( 7) =       0.000460349128

      target function =      -0.916767217103
              le_mean =     -16.899310149475
             les_mean =     285.883996771767
             stat err =       0.000450109161
             autocorr =       1.362859947734
   target nu stat err =       0.000450109161
   target dn stat err =       0.003421991829
      target stat err =       0.005221130622
              std dev =       0.545264515885
             le_variance =       0.297313392284


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.916767217103        initial  <--
     9.7656e+11     9.7656e+12             2.7910e-16        -0.916767217103
     3.9062e+12     3.9062e+13             0.0000e+00        -0.916767217103
     1.5625e+13     1.5625e+14             0.0000e+00        -0.916767217103

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 29.9122
  </log>
  <optVariables href="H2O.s029.opt.xml">
 uu_0                 2.517233e-01 1 1  ON 0
 uu_1                 1.009440e-01 1 1  ON 1
 uu_2                 1.617079e-02 1 1  ON 2
 uu_3                -3.223684e-02 1 1  ON 3
 uu_4                -6.387117e-02 1 1  ON 4
 uu_5                -8.576607e-02 1 1  ON 5
 uu_6                -1.001312e-01 1 1  ON 6
 uu_7                -1.065673e-01 1 1  ON 7
 uu_8                -9.668739e-02 1 1  ON 8
 uu_9                -6.389513e-02 1 1  ON 9
 ud_0                 3.492134e-01 1 1  ON 10
 ud_1                 1.235409e-01 1 1  ON 11
 ud_2                 2.392782e-02 1 1  ON 12
 ud_3                -3.019578e-02 1 1  ON 13
 ud_4                -6.975615e-02 1 1  ON 14
 ud_5                -9.484122e-02 1 1  ON 15
 ud_6                -1.085598e-01 1 1  ON 16
 ud_7                -1.109505e-01 1 1  ON 17
 ud_8                -9.792103e-02 1 1  ON 18
 ud_9                -6.281979e-02 1 1  ON 19
 eO_0                -5.692885e-01 1 1  ON 20
 eO_1                -3.060844e-01 1 1  ON 21
 eO_2                 4.730127e-02 1 1  ON 22
 eO_3                 2.840620e-01 1 1  ON 23
 eO_4                 3.913445e-01 1 1  ON 24
 eO_5                 3.212389e-01 1 1  ON 25
 eO_6                 1.205694e-01 1 1  ON 26
 eO_7                -7.888705e-02 1 1  ON 27
 eO_8                -1.549102e-01 1 1  ON 28
 eO_9                -6.122098e-02 1 1  ON 29
eH1_0                -2.277697e-01 1 1  ON 30
eH1_1                -1.106400e-01 1 1  ON 31
eH1_2                -6.162952e-02 1 1  ON 32
eH1_3                -2.530653e-02 1 1  ON 33
eH1_4                 4.247832e-03 1 1  ON 34
eH1_5                 2.367079e-02 1 1  ON 35
eH1_6                 6.569443e-02 1 1  ON 36
eH1_7                 1.154361e-01 1 1  ON 37
eH1_8                 1.435221e-01 1 1  ON 38
eH1_9                 7.467419e-02 1 1  ON 39
eH2_0                -2.307043e-01 1 1  ON 40
eH2_1                -1.139386e-01 1 1  ON 41
eH2_2                -6.444539e-02 1 1  ON 42
eH2_3                -2.722663e-02 1 1  ON 43
eH2_4                 1.073593e-03 1 1  ON 44
eH2_5                 2.532957e-02 1 1  ON 45
eH2_6                 7.564477e-02 1 1  ON 46
eH2_7                 1.260027e-01 1 1  ON 47
eH2_8                 1.609124e-01 1 1  ON 48
eH2_9                 6.417217e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.6130e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s030 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s030 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=30  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6903e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 30
    time step          = 0.05
    reference energy   = -16.904
    reference variance = 0.500704
====================================================
  Execution time = 2.0829e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s030
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6897e+01
  VMC Evar = 2.9903e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.5127e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.299067197790
                                         uncertainty =       0.005082652074

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.299067197790
                                         uncertainty =       0.005082652074

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000386668781
  error estimate for blocks of size 2^( 2) =       0.000403769564
  error estimate for blocks of size 2^( 3) =       0.000421291767
  error estimate for blocks of size 2^( 4) =       0.000437446039
  error estimate for blocks of size 2^( 5) =       0.000448518549
  error estimate for blocks of size 2^( 6) =       0.000455842122
  error estimate for blocks of size 2^( 7) =       0.000457920620

      target function =      -0.914082097698
              le_mean =     -16.897160902381
             les_mean =     285.813071903767
             stat err =       0.000449931832
             autocorr =       1.353989269105
   target nu stat err =       0.000449931832
   target dn stat err =       0.005252040249
      target stat err =       0.007890131424
              std dev =       0.546832234155
             le_variance =       0.299025492311


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.689716090238e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 9.7656e+12, overlap shift 9.7656e+13 and omega -1.7456e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.914148275569       residual = 1.36e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.914148275569       residual = 7.93e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.914148275569       residual = 2.80e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.914148275569       residual = 2.42e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.914707014822       residual = 2.17e-03           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.914148275569       residual = 7.52e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.916805697598       residual = 4.78e-03           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.906277344811       residual = 6.10e-02           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.906736979286       residual = 9.61e-03           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.927140517204       residual = 4.04e-02           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.911566250409       residual = 8.84e-03           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.907451713419       residual = 8.06e-03           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.926919156846       residual = 3.83e-02           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.858670076665       residual = 2.64e-01           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.906024045190       residual = 7.31e-02           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.912921264624       residual = 6.99e-03           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.906129993126       residual = 2.37e-02           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.908086404885       residual = 3.18e-02           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.910308786561       residual = 7.10e-03           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.930428751663       residual = 3.96e-02           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.893240356268       residual = 1.63e-01           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.830860964017       residual = 6.28e-01           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.886807750182       residual = 1.42e-01           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.914178982958       residual = 4.79e-02           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -1.027884948947       residual = 1.05e+00           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =      -0.841944779004       residual = 4.54e-01           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   tar_fn =      -1.002818804042       residual = 6.46e-01           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   tar_fn =      -0.911912335641       residual = 8.51e-02           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   tar_fn =      -1.051370202635       residual = 2.16e+00           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   tar_fn =      -1.031025536459       residual = 1.36e+00           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   tar_fn =      -0.768466456765       residual = 3.75e+00           smallest_sin_value = 1.00e+00
davidson iteration   31:   krylov dim =  32   tar_fn =      -0.967494841703       residual = 3.20e+00           smallest_sin_value = 1.00e+00
davidson iteration   32:   krylov dim =  33   tar_fn =      -0.804255272367       residual = 5.93e+00           smallest_sin_value = 1.00e+00
davidson iteration   33:   krylov dim =  34   tar_fn =      -1.435489625290       residual = 4.06e+01           smallest_sin_value = 1.00e+00
davidson iteration   34:   krylov dim =  35   tar_fn =      -1.036247841622       residual = 1.39e+01           smallest_sin_value = 1.00e+00
davidson iteration   35:   krylov dim =  36   tar_fn =      -0.641926385095       residual = 8.27e+00           smallest_sin_value = 1.00e+00
davidson iteration   36:   krylov dim =  37   tar_fn =      -0.836073949721       residual = 1.04e+00           smallest_sin_value = 1.00e+00
davidson iteration   37:   krylov dim =  38   tar_fn =      -0.918401665852       residual = 2.98e+00           smallest_sin_value = 1.00e+00
davidson iteration   38:   krylov dim =  39   tar_fn =      -0.675089160109       residual = 1.07e+01           smallest_sin_value = 1.00e+00
davidson iteration   39:   krylov dim =  40   tar_fn =      -1.243898981318       residual = 2.19e+01           smallest_sin_value = 1.00e+00
davidson iteration   40:   krylov dim =  41   tar_fn =      -0.910528820232       residual = 1.11e+01           smallest_sin_value = 1.00e+00
davidson iteration   41:   krylov dim =  42   tar_fn =      -0.493061362007       residual = 3.17e+01           smallest_sin_value = 1.00e+00
davidson iteration   42:   krylov dim =  43   tar_fn =      -0.998447189866       residual = 2.23e+01           smallest_sin_value = 1.00e+00
davidson iteration   43:   krylov dim =  44   tar_fn =      -0.716377621951       residual = 3.89e+01           smallest_sin_value = 1.00e+00
davidson iteration   44:   krylov dim =  45   tar_fn =       1.269562146747       residual = 3.90e+02           smallest_sin_value = 1.00e+00
davidson iteration   45:   krylov dim =  46   tar_fn =       0.609087800118       residual = 8.57e+02           smallest_sin_value = 1.00e+00
davidson iteration   46 stopping due to small subspace S singular value of 9.86e-01
davidson solver did not converge after         46 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.7656e+12 is 1.789572e-17

solving harmonic davidson linear method for identity shift 3.9062e+13, overlap shift 3.9062e+14 and omega -1.7456e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.914148275569       residual = 1.36e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.914148275569       residual = 7.93e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.914148275569       residual = 2.80e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.914148275569       residual = 2.42e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.914148275569       residual = 9.34e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.914148275569       residual = 7.04e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.923875467186       residual = 3.95e-02           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.900312660715       residual = 3.65e-02           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.900287114638       residual = 4.51e-02           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.970339031167       residual = 5.49e-01           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -1.006768525068       residual = 8.93e-01           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.843129999294       residual = 5.47e-01           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.823554377334       residual = 7.15e-01           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.770054671562       residual = 1.69e+00           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -1.118032733153       residual = 4.18e+00           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.993136092860       residual = 1.92e+00           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.909677181363       residual = 2.95e-01           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.857636763565       residual = 8.64e-01           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.846792664240       residual = 1.06e+00           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.856850402127       residual = 8.87e-01           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.783729993412       residual = 1.66e+00           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -1.354672632346       residual = 1.65e+01           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.583415282073       residual = 9.66e+00           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.639530120261       residual = 9.31e+00           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.852301754217       residual = 2.92e+00           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =      -0.709719353687       residual = 6.88e+00           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   tar_fn =      -1.217524619829       residual = 8.61e+00           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   tar_fn =      -3.018982127573       residual = 3.27e+02           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   tar_fn =      -1.171350898110       residual = 4.21e+01           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   tar_fn =      -1.608485376166       residual = 4.66e+01           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   tar_fn =      -1.530332837280       residual = 3.58e+01           smallest_sin_value = 1.00e+00
davidson iteration   31:   krylov dim =  32   tar_fn =      -2.152318315899       residual = 1.70e+02           smallest_sin_value = 1.00e+00
davidson iteration   32:   krylov dim =  33   tar_fn =      -1.064999436343       residual = 1.24e+01           smallest_sin_value = 1.00e+00
davidson iteration   33:   krylov dim =  34   tar_fn =      -0.884371320499       residual = 1.33e+01           smallest_sin_value = 1.00e+00
davidson iteration   34:   krylov dim =  35   tar_fn =      -0.738574519775       residual = 9.90e+00           smallest_sin_value = 1.00e+00
davidson iteration   35:   krylov dim =  36   tar_fn =      -1.279152902898       residual = 3.92e+01           smallest_sin_value = 1.00e+00
davidson iteration   36:   krylov dim =  37   tar_fn =      -1.702397459339       residual = 1.65e+02           smallest_sin_value = 1.00e+00
davidson iteration   37:   krylov dim =  38   tar_fn =      -1.144473887474       residual = 2.78e+01           smallest_sin_value = 1.00e+00
davidson iteration   38:   krylov dim =  39   tar_fn =      -2.121178446207       residual = 1.53e+02           smallest_sin_value = 1.00e+00
davidson iteration   39:   krylov dim =  40   tar_fn =      -0.127042273301       residual = 3.05e+02           smallest_sin_value = 1.00e+00
davidson iteration   40:   krylov dim =  41   tar_fn =      -0.221934916072       residual = 1.55e+02           smallest_sin_value = 1.00e+00
davidson iteration   41:   krylov dim =  42   tar_fn =      -0.591396013111       residual = 3.45e+02           smallest_sin_value = 1.00e+00
davidson iteration   42:   krylov dim =  43   tar_fn =      -3.719008564984       residual = 7.03e+02           smallest_sin_value = 1.00e+00
davidson iteration   43:   krylov dim =  44   tar_fn =       0.278076334298       residual = 2.80e+02           smallest_sin_value = 1.00e+00
davidson iteration   44:   krylov dim =  45   tar_fn =      -8.498334774819       residual = 4.87e+03           smallest_sin_value = 1.00e+00
davidson iteration   45 stopping due to too large eigenvalue change
davidson solver did not converge after         45 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.9062e+13 is 4.315727e-18

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 1.5625e+14, overlap shift 1.5625e+15 and omega -1.7456e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.914148275569       residual = 1.36e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.914148275569       residual = 7.93e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.914148275569       residual = 1.68e-02           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.914148275569       residual = 2.42e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.901054105602       residual = 9.43e-02           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.897089399563       residual = 2.56e-01           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -1.016653873480       residual = 9.08e-01           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.914774667713       residual = 6.35e-03           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -1.030180094015       residual = 5.86e+01           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.837714321439       residual = 1.13e+00           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -1.084524581170       residual = 7.18e+00           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.681959205747       residual = 2.48e+01           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.906194315603       residual = 7.88e+00           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -1.136178229628       residual = 5.21e+00           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.628656148245       residual = 9.53e+01           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.739425200095       residual = 2.50e+01           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.637627997094       residual = 1.06e+01           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -1.386767291706       residual = 2.89e+01           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -1.056731787132       residual = 6.45e+00           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.938110722146       residual = 5.27e+01           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.758120888214       residual = 6.85e+01           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.739400469109       residual = 1.91e+01           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.368098731748       residual = 5.46e+01           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.055091988359       residual = 1.79e+02           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.782562021527       residual = 1.22e+02           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =      -0.007766288678       residual = 1.12e+02           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   tar_fn =      -1.859925962867       residual = 5.31e+02           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   tar_fn =      -2.145588948836       residual = 6.54e+02           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   tar_fn =      -2.698298857162       residual = 3.08e+02           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   tar_fn =      -4.221093615248       residual = 1.86e+03           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   tar_fn =      -0.688676554077       residual = 8.94e+01           smallest_sin_value = 1.00e+00
davidson iteration   31:   krylov dim =  32   tar_fn =      -0.395135493382       residual = 1.28e+02           smallest_sin_value = 1.00e+00
davidson iteration   32:   krylov dim =  33   tar_fn =      -2.954022543964       residual = 1.30e+03           smallest_sin_value = 1.00e+00
davidson iteration   33:   krylov dim =  34   tar_fn =      -3.362384243162       residual = 1.24e+03           smallest_sin_value = 1.00e+00
davidson iteration   34:   krylov dim =  35   tar_fn =       1.509125501577       residual = 8.05e+02           smallest_sin_value = 1.00e+00
davidson iteration   35:   krylov dim =  36   tar_fn =       1.621904513577       residual = 6.23e+03           smallest_sin_value = 1.00e+00
davidson iteration   36:   krylov dim =  37   tar_fn =       2.280884885361       residual = 1.42e+03           smallest_sin_value = 1.00e+00
davidson iteration   37:   krylov dim =  38   tar_fn =       1.318761871686       residual = 6.40e+02           smallest_sin_value = 1.00e+00
davidson iteration   38:   krylov dim =  39   tar_fn =       2.668300283707       residual = 3.39e+03           smallest_sin_value = 1.00e+00
davidson iteration   39:   krylov dim =  40   tar_fn =       0.871272753797       residual = 1.16e+03           smallest_sin_value = 1.00e+00
davidson iteration   40:   krylov dim =  41   tar_fn =      -0.029069669047       residual = 7.01e+02           smallest_sin_value = 1.00e+00
davidson iteration   41:   krylov dim =  42   tar_fn =       0.164357542823       residual = 1.06e+04           smallest_sin_value = 1.00e+00
davidson iteration   42 stopping due to too large eigenvalue change
davidson solver did not converge after         42 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.5625e+14 is 8.187385e-19

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               1.397798 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.6446e+01
  </log>
  <optVariables href="H2O.s030.opt.xml">
 uu_0                 2.517233e-01 1 1  ON 0
 uu_1                 1.009440e-01 1 1  ON 1
 uu_2                 1.617079e-02 1 1  ON 2
 uu_3                -3.223684e-02 1 1  ON 3
 uu_4                -6.387117e-02 1 1  ON 4
 uu_5                -8.576607e-02 1 1  ON 5
 uu_6                -1.001312e-01 1 1  ON 6
 uu_7                -1.065673e-01 1 1  ON 7
 uu_8                -9.668739e-02 1 1  ON 8
 uu_9                -6.389513e-02 1 1  ON 9
 ud_0                 3.492134e-01 1 1  ON 10
 ud_1                 1.235409e-01 1 1  ON 11
 ud_2                 2.392782e-02 1 1  ON 12
 ud_3                -3.019578e-02 1 1  ON 13
 ud_4                -6.975615e-02 1 1  ON 14
 ud_5                -9.484122e-02 1 1  ON 15
 ud_6                -1.085598e-01 1 1  ON 16
 ud_7                -1.109505e-01 1 1  ON 17
 ud_8                -9.792103e-02 1 1  ON 18
 ud_9                -6.281979e-02 1 1  ON 19
 eO_0                -5.692885e-01 1 1  ON 20
 eO_1                -3.060844e-01 1 1  ON 21
 eO_2                 4.730127e-02 1 1  ON 22
 eO_3                 2.840620e-01 1 1  ON 23
 eO_4                 3.913445e-01 1 1  ON 24
 eO_5                 3.212389e-01 1 1  ON 25
 eO_6                 1.205694e-01 1 1  ON 26
 eO_7                -7.888705e-02 1 1  ON 27
 eO_8                -1.549102e-01 1 1  ON 28
 eO_9                -6.122098e-02 1 1  ON 29
eH1_0                -2.277697e-01 1 1  ON 30
eH1_1                -1.106400e-01 1 1  ON 31
eH1_2                -6.162952e-02 1 1  ON 32
eH1_3                -2.530653e-02 1 1  ON 33
eH1_4                 4.247832e-03 1 1  ON 34
eH1_5                 2.367079e-02 1 1  ON 35
eH1_6                 6.569443e-02 1 1  ON 36
eH1_7                 1.154361e-01 1 1  ON 37
eH1_8                 1.435221e-01 1 1  ON 38
eH1_9                 7.467419e-02 1 1  ON 39
eH2_0                -2.307043e-01 1 1  ON 40
eH2_1                -1.139386e-01 1 1  ON 41
eH2_2                -6.444539e-02 1 1  ON 42
eH2_3                -2.722663e-02 1 1  ON 43
eH2_4                 1.073593e-03 1 1  ON 44
eH2_5                 2.532957e-02 1 1  ON 45
eH2_6                 7.564477e-02 1 1  ON 46
eH2_7                 1.260027e-01 1 1  ON 47
eH2_8                 1.609124e-01 1 1  ON 48
eH2_9                 6.417217e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 30
    time step          = 0.05
    reference energy   = -16.9179
    reference variance = 0.222123
====================================================
  Execution time = 2.2446e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s030
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6898e+01
  VMC Evar = 2.9756e-01
  Total weights = 2.0000e+06
  Execution time = 1.9076e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.297564593220
                                         uncertainty =       0.005563884268

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.297564593220
                                         uncertainty =       0.005563884268

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000385718038
  error estimate for blocks of size 2^( 2) =       0.000402666583
  error estimate for blocks of size 2^( 3) =       0.000420482020
  error estimate for blocks of size 2^( 4) =       0.000436204200
  error estimate for blocks of size 2^( 5) =       0.000447768674
  error estimate for blocks of size 2^( 6) =       0.000454454706
  error estimate for blocks of size 2^( 7) =       0.000460864995

      target function =      -0.916314180829
              le_mean =     -16.897910339267
             les_mean =     285.836930494889
             stat err =       0.000449823144
             autocorr =       1.360014988133
   target nu stat err =       0.000449823144
   target dn stat err =       0.005148166079
      target stat err =       0.007783518541
              std dev =       0.545487680684
             le_variance =       0.297556809778

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.297564593220
                                         uncertainty =       0.005563884268

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.297564593220
                                         uncertainty =       0.005563884268

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000385718038
  error estimate for blocks of size 2^( 2) =       0.000402666583
  error estimate for blocks of size 2^( 3) =       0.000420482020
  error estimate for blocks of size 2^( 4) =       0.000436204200
  error estimate for blocks of size 2^( 5) =       0.000447768674
  error estimate for blocks of size 2^( 6) =       0.000454454706
  error estimate for blocks of size 2^( 7) =       0.000460864995

      target function =      -0.916314180829
              le_mean =     -16.897910339267
             les_mean =     285.836930494889
             stat err =       0.000449823144
             autocorr =       1.360014988133
   target nu stat err =       0.000449823144
   target dn stat err =       0.005148166079
      target stat err =       0.007783518541
              std dev =       0.545487680684
             le_variance =       0.297556809778

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.297564593220
                                         uncertainty =       0.005563884268

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.297564593220
                                         uncertainty =       0.005563884268

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000385718038
  error estimate for blocks of size 2^( 2) =       0.000402666583
  error estimate for blocks of size 2^( 3) =       0.000420482020
  error estimate for blocks of size 2^( 4) =       0.000436204200
  error estimate for blocks of size 2^( 5) =       0.000447768674
  error estimate for blocks of size 2^( 6) =       0.000454454706
  error estimate for blocks of size 2^( 7) =       0.000460864995

      target function =      -0.916314180829
              le_mean =     -16.897910339267
             les_mean =     285.836930494889
             stat err =       0.000449823144
             autocorr =       1.360014988133
   target nu stat err =       0.000449823144
   target dn stat err =       0.005148166079
      target stat err =       0.007783518541
              std dev =       0.545487680684
             le_variance =       0.297556809778

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.297564593220
                                         uncertainty =       0.005563884268

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.297564593220
                                         uncertainty =       0.005563884268

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000385718038
  error estimate for blocks of size 2^( 2) =       0.000402666583
  error estimate for blocks of size 2^( 3) =       0.000420482020
  error estimate for blocks of size 2^( 4) =       0.000436204200
  error estimate for blocks of size 2^( 5) =       0.000447768674
  error estimate for blocks of size 2^( 6) =       0.000454454706
  error estimate for blocks of size 2^( 7) =       0.000460864995

      target function =      -0.916314180829
              le_mean =     -16.897910339267
             les_mean =     285.836930494889
             stat err =       0.000449823144
             autocorr =       1.360014988135
   target nu stat err =       0.000449823144
   target dn stat err =       0.005148166079
      target stat err =       0.007783518541
              std dev =       0.545487680684
             le_variance =       0.297556809778


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.916314180829        initial
     9.7656e+12     9.7656e+13             1.7896e-17        -0.916314180829
     3.9062e+13     3.9062e+14             4.3157e-18        -0.916314180829
     1.5625e+14     1.5625e+15             8.1874e-19        -0.916314180829  <--

*****************************************************************************
Applying the update for shift_i =   1.5625e+14     and shift_s =   1.5625e+15
*****************************************************************************

  Execution time = 3.1987e+01
  </log>
  <optVariables href="H2O.s030.opt.xml">
 uu_0                 2.517233e-01 1 1  ON 0
 uu_1                 1.009440e-01 1 1  ON 1
 uu_2                 1.617079e-02 1 1  ON 2
 uu_3                -3.223684e-02 1 1  ON 3
 uu_4                -6.387117e-02 1 1  ON 4
 uu_5                -8.576607e-02 1 1  ON 5
 uu_6                -1.001312e-01 1 1  ON 6
 uu_7                -1.065673e-01 1 1  ON 7
 uu_8                -9.668739e-02 1 1  ON 8
 uu_9                -6.389513e-02 1 1  ON 9
 ud_0                 3.492134e-01 1 1  ON 10
 ud_1                 1.235409e-01 1 1  ON 11
 ud_2                 2.392782e-02 1 1  ON 12
 ud_3                -3.019578e-02 1 1  ON 13
 ud_4                -6.975615e-02 1 1  ON 14
 ud_5                -9.484122e-02 1 1  ON 15
 ud_6                -1.085598e-01 1 1  ON 16
 ud_7                -1.109505e-01 1 1  ON 17
 ud_8                -9.792103e-02 1 1  ON 18
 ud_9                -6.281979e-02 1 1  ON 19
 eO_0                -5.692885e-01 1 1  ON 20
 eO_1                -3.060844e-01 1 1  ON 21
 eO_2                 4.730127e-02 1 1  ON 22
 eO_3                 2.840620e-01 1 1  ON 23
 eO_4                 3.913445e-01 1 1  ON 24
 eO_5                 3.212389e-01 1 1  ON 25
 eO_6                 1.205694e-01 1 1  ON 26
 eO_7                -7.888705e-02 1 1  ON 27
 eO_8                -1.549102e-01 1 1  ON 28
 eO_9                -6.122098e-02 1 1  ON 29
eH1_0                -2.277697e-01 1 1  ON 30
eH1_1                -1.106400e-01 1 1  ON 31
eH1_2                -6.162952e-02 1 1  ON 32
eH1_3                -2.530653e-02 1 1  ON 33
eH1_4                 4.247832e-03 1 1  ON 34
eH1_5                 2.367079e-02 1 1  ON 35
eH1_6                 6.569443e-02 1 1  ON 36
eH1_7                 1.154361e-01 1 1  ON 37
eH1_8                 1.435221e-01 1 1  ON 38
eH1_9                 7.467419e-02 1 1  ON 39
eH2_0                -2.307043e-01 1 1  ON 40
eH2_1                -1.139386e-01 1 1  ON 41
eH2_2                -6.444539e-02 1 1  ON 42
eH2_3                -2.722663e-02 1 1  ON 43
eH2_4                 1.073593e-03 1 1  ON 44
eH2_5                 2.532957e-02 1 1  ON 45
eH2_6                 7.564477e-02 1 1  ON 46
eH2_7                 1.260027e-01 1 1  ON 47
eH2_8                 1.609124e-01 1 1  ON 48
eH2_9                 6.417217e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.8439e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s031 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s031 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=31  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6903e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 31
    time step          = 0.05
    reference energy   = -16.9071
    reference variance = 0.474751
====================================================
  Execution time = 2.0599e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s031
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6898e+01
  VMC Evar = 3.1259e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.4843e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.312648357630
                                         uncertainty =       0.019126791632

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.312648357630
                                         uncertainty =       0.019126791632

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000395341826
  error estimate for blocks of size 2^( 2) =       0.000412040683
  error estimate for blocks of size 2^( 3) =       0.000429799465
  error estimate for blocks of size 2^( 4) =       0.000446024909
  error estimate for blocks of size 2^( 5) =       0.000458385023
  error estimate for blocks of size 2^( 6) =       0.000466944697
  error estimate for blocks of size 2^( 7) =       0.000473636066

      target function =      -0.893434805539
              le_mean =     -16.897730464567
             les_mean =     285.845885016075
             stat err =       0.000461247674
             autocorr =       1.361202848640
   target nu stat err =       0.000461247674
   target dn stat err =       0.019461366560
      target stat err =       0.027872051449
              std dev =       0.559097772501
             le_variance =       0.312590319215


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.689773046457e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 3.9062e+13, overlap shift 3.9062e+14 and omega -1.7456e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.894296722543       residual = 1.09e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.894296722543       residual = 6.99e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.894296722543       residual = 4.81e-03           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.894296722543       residual = 1.09e-02           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.894296722538       residual = 4.85e-03           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.888925414170       residual = 7.62e-03           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.894297289418       residual = 7.41e-03           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.894434377155       residual = 1.12e-03           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.805451249001       residual = 8.42e-01           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.845504003976       residual = 2.54e-01           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.914108737112       residual = 1.28e-01           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.804145008445       residual = 8.53e-01           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -1.046433362828       residual = 2.00e+00           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.914549005943       residual = 6.42e-01           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.901770701134       residual = 1.19e-01           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.868282628863       residual = 2.38e-01           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.896333975793       residual = 1.44e+00           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -1.060021347197       residual = 1.82e+00           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.927147573151       residual = 1.23e+00           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.845728527193       residual = 8.29e-01           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.879736819513       residual = 2.83e-01           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.839902907970       residual = 1.35e+00           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.878979827251       residual = 4.83e-01           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.812798533870       residual = 5.63e+00           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.786578372452       residual = 1.12e+00           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =      -0.959240455879       residual = 5.44e-01           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   tar_fn =      -0.812246882776       residual = 1.03e+00           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   tar_fn =      -0.533481924706       residual = 1.36e+01           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   tar_fn =      -0.946165025658       residual = 6.03e+00           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   tar_fn =      -0.132077179066       residual = 7.63e+01           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   tar_fn =      -0.808270985541       residual = 4.51e+01           smallest_sin_value = 1.00e+00
davidson iteration   31:   krylov dim =  32   tar_fn =      -1.375530065327       residual = 1.95e+01           smallest_sin_value = 1.00e+00
davidson iteration   32:   krylov dim =  33   tar_fn =      -1.431851774852       residual = 3.42e+01           smallest_sin_value = 1.00e+00
davidson iteration   33:   krylov dim =  34   tar_fn =      -0.516875390889       residual = 2.05e+01           smallest_sin_value = 1.00e+00
davidson iteration   34:   krylov dim =  35   tar_fn =      -0.581705551643       residual = 2.22e+01           smallest_sin_value = 1.00e+00
davidson iteration   35:   krylov dim =  36   tar_fn =      -1.575937999195       residual = 1.72e+02           smallest_sin_value = 1.00e+00
davidson iteration   36:   krylov dim =  37   tar_fn =      -0.555636805560       residual = 3.69e+01           smallest_sin_value = 1.00e+00
davidson iteration   37:   krylov dim =  38   tar_fn =      -0.576950064352       residual = 1.23e+01           smallest_sin_value = 1.00e+00
davidson iteration   38:   krylov dim =  39   tar_fn =      -0.873107707151       residual = 6.40e+00           smallest_sin_value = 1.00e+00
davidson iteration   39:   krylov dim =  40   tar_fn =      -1.682816171917       residual = 7.56e+01           smallest_sin_value = 1.00e+00
davidson iteration   40:   krylov dim =  41   tar_fn =      -2.148824278768       residual = 2.05e+02           smallest_sin_value = 1.00e+00
davidson iteration   41:   krylov dim =  42   tar_fn =      -0.401885700053       residual = 8.76e+01           smallest_sin_value = 1.00e+00
davidson iteration   42:   krylov dim =  43   tar_fn =       0.252929568582       residual = 6.29e+02           smallest_sin_value = 1.00e+00
davidson iteration   43:   krylov dim =  44   tar_fn =      -0.914424162012       residual = 1.61e+02           smallest_sin_value = 1.00e+00
davidson iteration   44:   krylov dim =  45   tar_fn =      -0.197088834214       residual = 4.82e+02           smallest_sin_value = 1.00e+00
davidson iteration   45:   krylov dim =  46   tar_fn =       1.342946423393       residual = 6.31e+02           smallest_sin_value = 9.98e-01
davidson iteration   46 stopping due to too large eigenvalue change
davidson solver did not converge after         46 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.9062e+13 is 3.967993e-17

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 1.5625e+14, overlap shift 1.5625e+15 and omega -1.7456e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.894296722543       residual = 1.09e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.894296722543       residual = 6.99e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.894296722543       residual = 4.81e-03           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.894296722543       residual = 8.63e-02           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.894296722542       residual = 1.15e-01           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.802921834217       residual = 8.22e-01           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.909414054619       residual = 9.55e+00           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -1.018651302034       residual = 1.28e+00           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.938718916982       residual = 8.87e+00           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.979036877527       residual = 6.28e+00           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.532891725008       residual = 1.24e+01           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -1.055663222519       residual = 4.95e+00           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.890109297954       residual = 2.57e+00           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.742899585128       residual = 1.32e+01           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.934200841783       residual = 3.59e+00           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -1.066983316229       residual = 6.44e+00           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.844188096477       residual = 6.03e+00           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.423485363667       residual = 2.39e+01           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -2.044476612095       residual = 1.03e+02           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -2.488919732863       residual = 2.48e+02           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =       1.952551907947       residual = 6.80e+02           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =       1.411672500874       residual = 4.68e+02           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -1.976467956905       residual = 9.86e+01           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =       0.310485345609       residual = 1.28e+02           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -2.090826042850       residual = 1.48e+02           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =       0.404266737273       residual = 1.40e+02           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   tar_fn =       2.540645158870       residual = 1.20e+03           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   tar_fn =      -7.882249027142       residual = 4.14e+03           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   tar_fn =      -1.777551439252       residual = 7.83e+01           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   tar_fn =      -2.316060504311       residual = 1.49e+02           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   tar_fn =      -0.966275408932       residual = 2.85e+01           smallest_sin_value = 1.00e+00
davidson iteration   31:   krylov dim =  32   tar_fn =       0.696215588915       residual = 2.05e+02           smallest_sin_value = 1.00e+00
davidson iteration   32:   krylov dim =  33   tar_fn =      -2.053229382022       residual = 3.71e+03           smallest_sin_value = 1.00e+00
davidson iteration   33:   krylov dim =  34   tar_fn =      -0.487353648411       residual = 8.99e+02           smallest_sin_value = 1.00e+00
davidson iteration   34:   krylov dim =  35   tar_fn =      -4.292497712340       residual = 9.26e+03           smallest_sin_value = 1.00e+00
davidson iteration   35:   krylov dim =  36   tar_fn =       0.610972962657       residual = 3.52e+02           smallest_sin_value = 1.00e+00
davidson iteration   36 stopping due to too large eigenvalue change
davidson solver did not converge after         36 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.5625e+14 is 2.094536e-18

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 6.2500e+14, overlap shift 6.2500e+15 and omega -1.7456e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.894296722543       residual = 1.09e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.894296722543       residual = 6.99e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.894296722543       residual = 1.09e-02           smallest_sin_value = 1.00e+00
davidson iteration    3 stopping due to too large eigenvalue change
davidson solver did not converge after          3 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 6.2500e+14 is 4.266876e-19

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               1.454650 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.6146e+01
  </log>
  <optVariables href="H2O.s031.opt.xml">
 uu_0                 2.517233e-01 1 1  ON 0
 uu_1                 1.009440e-01 1 1  ON 1
 uu_2                 1.617079e-02 1 1  ON 2
 uu_3                -3.223684e-02 1 1  ON 3
 uu_4                -6.387117e-02 1 1  ON 4
 uu_5                -8.576607e-02 1 1  ON 5
 uu_6                -1.001312e-01 1 1  ON 6
 uu_7                -1.065673e-01 1 1  ON 7
 uu_8                -9.668739e-02 1 1  ON 8
 uu_9                -6.389513e-02 1 1  ON 9
 ud_0                 3.492134e-01 1 1  ON 10
 ud_1                 1.235409e-01 1 1  ON 11
 ud_2                 2.392782e-02 1 1  ON 12
 ud_3                -3.019578e-02 1 1  ON 13
 ud_4                -6.975615e-02 1 1  ON 14
 ud_5                -9.484122e-02 1 1  ON 15
 ud_6                -1.085598e-01 1 1  ON 16
 ud_7                -1.109505e-01 1 1  ON 17
 ud_8                -9.792103e-02 1 1  ON 18
 ud_9                -6.281979e-02 1 1  ON 19
 eO_0                -5.692885e-01 1 1  ON 20
 eO_1                -3.060844e-01 1 1  ON 21
 eO_2                 4.730127e-02 1 1  ON 22
 eO_3                 2.840620e-01 1 1  ON 23
 eO_4                 3.913445e-01 1 1  ON 24
 eO_5                 3.212389e-01 1 1  ON 25
 eO_6                 1.205694e-01 1 1  ON 26
 eO_7                -7.888705e-02 1 1  ON 27
 eO_8                -1.549102e-01 1 1  ON 28
 eO_9                -6.122098e-02 1 1  ON 29
eH1_0                -2.277697e-01 1 1  ON 30
eH1_1                -1.106400e-01 1 1  ON 31
eH1_2                -6.162952e-02 1 1  ON 32
eH1_3                -2.530653e-02 1 1  ON 33
eH1_4                 4.247832e-03 1 1  ON 34
eH1_5                 2.367079e-02 1 1  ON 35
eH1_6                 6.569443e-02 1 1  ON 36
eH1_7                 1.154361e-01 1 1  ON 37
eH1_8                 1.435221e-01 1 1  ON 38
eH1_9                 7.467419e-02 1 1  ON 39
eH2_0                -2.307043e-01 1 1  ON 40
eH2_1                -1.139386e-01 1 1  ON 41
eH2_2                -6.444539e-02 1 1  ON 42
eH2_3                -2.722663e-02 1 1  ON 43
eH2_4                 1.073593e-03 1 1  ON 44
eH2_5                 2.532957e-02 1 1  ON 45
eH2_6                 7.564477e-02 1 1  ON 46
eH2_7                 1.260027e-01 1 1  ON 47
eH2_8                 1.609124e-01 1 1  ON 48
eH2_9                 6.417217e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 31
    time step          = 0.05
    reference energy   = -16.8973
    reference variance = 0.117394
====================================================
  Execution time = 2.0516e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s031
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6898e+01
  VMC Evar = 3.0188e-01
  Total weights = 2.0000e+06
  Execution time = 1.8854e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.301934587231
                                         uncertainty =       0.006693378721

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.301934587231
                                         uncertainty =       0.006693378721

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000388510513
  error estimate for blocks of size 2^( 2) =       0.000405395934
  error estimate for blocks of size 2^( 3) =       0.000422872577
  error estimate for blocks of size 2^( 4) =       0.000438312421
  error estimate for blocks of size 2^( 5) =       0.000449411133
  error estimate for blocks of size 2^( 6) =       0.000456399324
  error estimate for blocks of size 2^( 7) =       0.000459391643

      target function =      -0.909828089372
              le_mean =     -16.898306620504
             les_mean =     285.854647326701
             stat err =       0.000450878630
             autocorr =       1.346833016166
   target nu stat err =       0.000450878630
   target dn stat err =       0.006381896380
      target stat err =       0.009505338430
              std dev =       0.549436836291
             le_variance =       0.301880837073

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.301934587231
                                         uncertainty =       0.006693378721

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.301934587231
                                         uncertainty =       0.006693378721

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000388510513
  error estimate for blocks of size 2^( 2) =       0.000405395934
  error estimate for blocks of size 2^( 3) =       0.000422872577
  error estimate for blocks of size 2^( 4) =       0.000438312421
  error estimate for blocks of size 2^( 5) =       0.000449411133
  error estimate for blocks of size 2^( 6) =       0.000456399324
  error estimate for blocks of size 2^( 7) =       0.000459391643

      target function =      -0.909828089372
              le_mean =     -16.898306620504
             les_mean =     285.854647326701
             stat err =       0.000450878630
             autocorr =       1.346833016166
   target nu stat err =       0.000450878630
   target dn stat err =       0.006381896380
      target stat err =       0.009505338430
              std dev =       0.549436836291
             le_variance =       0.301880837073

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.301934587231
                                         uncertainty =       0.006693378721

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.301934587231
                                         uncertainty =       0.006693378721

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000388510513
  error estimate for blocks of size 2^( 2) =       0.000405395934
  error estimate for blocks of size 2^( 3) =       0.000422872577
  error estimate for blocks of size 2^( 4) =       0.000438312421
  error estimate for blocks of size 2^( 5) =       0.000449411133
  error estimate for blocks of size 2^( 6) =       0.000456399324
  error estimate for blocks of size 2^( 7) =       0.000459391643

      target function =      -0.909828089372
              le_mean =     -16.898306620504
             les_mean =     285.854647326701
             stat err =       0.000450878630
             autocorr =       1.346833016166
   target nu stat err =       0.000450878630
   target dn stat err =       0.006381896380
      target stat err =       0.009505338430
              std dev =       0.549436836291
             le_variance =       0.301880837073

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.301934587231
                                         uncertainty =       0.006693378721

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.301934587231
                                         uncertainty =       0.006693378721

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000388510513
  error estimate for blocks of size 2^( 2) =       0.000405395934
  error estimate for blocks of size 2^( 3) =       0.000422872577
  error estimate for blocks of size 2^( 4) =       0.000438312421
  error estimate for blocks of size 2^( 5) =       0.000449411133
  error estimate for blocks of size 2^( 6) =       0.000456399324
  error estimate for blocks of size 2^( 7) =       0.000459391643

      target function =      -0.909828089372
              le_mean =     -16.898306620504
             les_mean =     285.854647326701
             stat err =       0.000450878630
             autocorr =       1.346833016166
   target nu stat err =       0.000450878630
   target dn stat err =       0.006381896380
      target stat err =       0.009505338430
              std dev =       0.549436836291
             le_variance =       0.301880837073


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.909828089372        initial
     3.9062e+13     3.9062e+14             3.9680e-17        -0.909828089372
     1.5625e+14     1.5625e+15             2.0945e-18        -0.909828089372  <--
     6.2500e+14     6.2500e+15             4.2669e-19        -0.909828089372

*****************************************************************************
Applying the update for shift_i =   1.5625e+14     and shift_s =   1.5625e+15
*****************************************************************************

  Execution time = 3.0080e+01
  </log>
  <optVariables href="H2O.s031.opt.xml">
 uu_0                 2.517233e-01 1 1  ON 0
 uu_1                 1.009440e-01 1 1  ON 1
 uu_2                 1.617079e-02 1 1  ON 2
 uu_3                -3.223684e-02 1 1  ON 3
 uu_4                -6.387117e-02 1 1  ON 4
 uu_5                -8.576607e-02 1 1  ON 5
 uu_6                -1.001312e-01 1 1  ON 6
 uu_7                -1.065673e-01 1 1  ON 7
 uu_8                -9.668739e-02 1 1  ON 8
 uu_9                -6.389513e-02 1 1  ON 9
 ud_0                 3.492134e-01 1 1  ON 10
 ud_1                 1.235409e-01 1 1  ON 11
 ud_2                 2.392782e-02 1 1  ON 12
 ud_3                -3.019578e-02 1 1  ON 13
 ud_4                -6.975615e-02 1 1  ON 14
 ud_5                -9.484122e-02 1 1  ON 15
 ud_6                -1.085598e-01 1 1  ON 16
 ud_7                -1.109505e-01 1 1  ON 17
 ud_8                -9.792103e-02 1 1  ON 18
 ud_9                -6.281979e-02 1 1  ON 19
 eO_0                -5.692885e-01 1 1  ON 20
 eO_1                -3.060844e-01 1 1  ON 21
 eO_2                 4.730127e-02 1 1  ON 22
 eO_3                 2.840620e-01 1 1  ON 23
 eO_4                 3.913445e-01 1 1  ON 24
 eO_5                 3.212389e-01 1 1  ON 25
 eO_6                 1.205694e-01 1 1  ON 26
 eO_7                -7.888705e-02 1 1  ON 27
 eO_8                -1.549102e-01 1 1  ON 28
 eO_9                -6.122098e-02 1 1  ON 29
eH1_0                -2.277697e-01 1 1  ON 30
eH1_1                -1.106400e-01 1 1  ON 31
eH1_2                -6.162952e-02 1 1  ON 32
eH1_3                -2.530653e-02 1 1  ON 33
eH1_4                 4.247832e-03 1 1  ON 34
eH1_5                 2.367079e-02 1 1  ON 35
eH1_6                 6.569443e-02 1 1  ON 36
eH1_7                 1.154361e-01 1 1  ON 37
eH1_8                 1.435221e-01 1 1  ON 38
eH1_9                 7.467419e-02 1 1  ON 39
eH2_0                -2.307043e-01 1 1  ON 40
eH2_1                -1.139386e-01 1 1  ON 41
eH2_2                -6.444539e-02 1 1  ON 42
eH2_3                -2.722663e-02 1 1  ON 43
eH2_4                 1.073593e-03 1 1  ON 44
eH2_5                 2.532957e-02 1 1  ON 45
eH2_6                 7.564477e-02 1 1  ON 46
eH2_7                 1.260027e-01 1 1  ON 47
eH2_8                 1.609124e-01 1 1  ON 48
eH2_9                 6.417217e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.6233e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s032 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s032 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=32  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6903e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 32
    time step          = 0.05
    reference energy   = -16.9037
    reference variance = 0.16518
====================================================
  Execution time = 2.0608e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s032
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6898e+01
  VMC Evar = 2.9206e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.4752e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.292104699630
                                         uncertainty =       0.002906118099

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.292104699630
                                         uncertainty =       0.002906118099

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000382141637
  error estimate for blocks of size 2^( 2) =       0.000399142151
  error estimate for blocks of size 2^( 3) =       0.000416074665
  error estimate for blocks of size 2^( 4) =       0.000431525834
  error estimate for blocks of size 2^( 5) =       0.000443610200
  error estimate for blocks of size 2^( 6) =       0.000451627789
  error estimate for blocks of size 2^( 7) =       0.000456417035

      target function =      -0.924693112557
              le_mean =     -16.897687889891
             les_mean =     285.823920338881
             stat err =       0.000445795215
             autocorr =       1.360887065596
   target nu stat err =       0.000445795215
   target dn stat err =       0.002589455799
      target stat err =       0.004035301599
              std dev =       0.540429885124
             le_variance =       0.292064460735


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.689768788989e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 3.9062e+13, overlap shift 3.9062e+14 and omega -1.7456e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.924709447679       residual = 6.55e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.924709447679       residual = 6.55e-04           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to small subspace S singular value of 6.73e-01
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.9062e+13 is 0.000000e+00

solving harmonic davidson linear method for identity shift 1.5625e+14, overlap shift 1.5625e+15 and omega -1.7456e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.924709447679       residual = 6.55e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.924709447679       residual = 6.55e-04           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to small subspace S singular value of 6.73e-01
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.5625e+14 is 0.000000e+00

solving harmonic davidson linear method for identity shift 6.2500e+14, overlap shift 6.2500e+15 and omega -1.7456e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.924709447679       residual = 6.55e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.924709447679       residual = 6.55e-04           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to small subspace S singular value of 6.73e-01
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 6.2500e+14 is 0.000000e+00

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               1.455698 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.6089e+01
  </log>
  <optVariables href="H2O.s032.opt.xml">
 uu_0                 2.517233e-01 1 1  ON 0
 uu_1                 1.009440e-01 1 1  ON 1
 uu_2                 1.617079e-02 1 1  ON 2
 uu_3                -3.223684e-02 1 1  ON 3
 uu_4                -6.387117e-02 1 1  ON 4
 uu_5                -8.576607e-02 1 1  ON 5
 uu_6                -1.001312e-01 1 1  ON 6
 uu_7                -1.065673e-01 1 1  ON 7
 uu_8                -9.668739e-02 1 1  ON 8
 uu_9                -6.389513e-02 1 1  ON 9
 ud_0                 3.492134e-01 1 1  ON 10
 ud_1                 1.235409e-01 1 1  ON 11
 ud_2                 2.392782e-02 1 1  ON 12
 ud_3                -3.019578e-02 1 1  ON 13
 ud_4                -6.975615e-02 1 1  ON 14
 ud_5                -9.484122e-02 1 1  ON 15
 ud_6                -1.085598e-01 1 1  ON 16
 ud_7                -1.109505e-01 1 1  ON 17
 ud_8                -9.792103e-02 1 1  ON 18
 ud_9                -6.281979e-02 1 1  ON 19
 eO_0                -5.692885e-01 1 1  ON 20
 eO_1                -3.060844e-01 1 1  ON 21
 eO_2                 4.730127e-02 1 1  ON 22
 eO_3                 2.840620e-01 1 1  ON 23
 eO_4                 3.913445e-01 1 1  ON 24
 eO_5                 3.212389e-01 1 1  ON 25
 eO_6                 1.205694e-01 1 1  ON 26
 eO_7                -7.888705e-02 1 1  ON 27
 eO_8                -1.549102e-01 1 1  ON 28
 eO_9                -6.122098e-02 1 1  ON 29
eH1_0                -2.277697e-01 1 1  ON 30
eH1_1                -1.106400e-01 1 1  ON 31
eH1_2                -6.162952e-02 1 1  ON 32
eH1_3                -2.530653e-02 1 1  ON 33
eH1_4                 4.247832e-03 1 1  ON 34
eH1_5                 2.367079e-02 1 1  ON 35
eH1_6                 6.569443e-02 1 1  ON 36
eH1_7                 1.154361e-01 1 1  ON 37
eH1_8                 1.435221e-01 1 1  ON 38
eH1_9                 7.467419e-02 1 1  ON 39
eH2_0                -2.307043e-01 1 1  ON 40
eH2_1                -1.139386e-01 1 1  ON 41
eH2_2                -6.444539e-02 1 1  ON 42
eH2_3                -2.722663e-02 1 1  ON 43
eH2_4                 1.073593e-03 1 1  ON 44
eH2_5                 2.532957e-02 1 1  ON 45
eH2_6                 7.564477e-02 1 1  ON 46
eH2_7                 1.260027e-01 1 1  ON 47
eH2_8                 1.609124e-01 1 1  ON 48
eH2_9                 6.417217e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 32
    time step          = 0.05
    reference energy   = -16.9738
    reference variance = 0.543846
====================================================
  Execution time = 2.0446e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s032
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6897e+01
  VMC Evar = 3.0932e-01
  Total weights = 2.0000e+06
  Execution time = 1.8758e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.309359703830
                                         uncertainty =       0.007433768588

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.309359703830
                                         uncertainty =       0.007433768588

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000393269162
  error estimate for blocks of size 2^( 2) =       0.000410103112
  error estimate for blocks of size 2^( 3) =       0.000426596248
  error estimate for blocks of size 2^( 4) =       0.000441965790
  error estimate for blocks of size 2^( 5) =       0.000453114594
  error estimate for blocks of size 2^( 6) =       0.000460412847
  error estimate for blocks of size 2^( 7) =       0.000463593592

      target function =      -0.898864649225
              le_mean =     -16.897082296265
             les_mean =     285.820711239431
             stat err =       0.000454771706
             autocorr =       1.337233007253
   target nu stat err =       0.000454771706
   target dn stat err =       0.007746644169
      target stat err =       0.011227602978
              std dev =       0.556166582376
             le_variance =       0.309321267352

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.309359703830
                                         uncertainty =       0.007433768588

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.309359703830
                                         uncertainty =       0.007433768588

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000393269162
  error estimate for blocks of size 2^( 2) =       0.000410103112
  error estimate for blocks of size 2^( 3) =       0.000426596248
  error estimate for blocks of size 2^( 4) =       0.000441965790
  error estimate for blocks of size 2^( 5) =       0.000453114594
  error estimate for blocks of size 2^( 6) =       0.000460412847
  error estimate for blocks of size 2^( 7) =       0.000463593592

      target function =      -0.898864649225
              le_mean =     -16.897082296265
             les_mean =     285.820711239431
             stat err =       0.000454771706
             autocorr =       1.337233007253
   target nu stat err =       0.000454771706
   target dn stat err =       0.007746644169
      target stat err =       0.011227602978
              std dev =       0.556166582376
             le_variance =       0.309321267352

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.309359703830
                                         uncertainty =       0.007433768588

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.309359703830
                                         uncertainty =       0.007433768588

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000393269162
  error estimate for blocks of size 2^( 2) =       0.000410103112
  error estimate for blocks of size 2^( 3) =       0.000426596248
  error estimate for blocks of size 2^( 4) =       0.000441965790
  error estimate for blocks of size 2^( 5) =       0.000453114594
  error estimate for blocks of size 2^( 6) =       0.000460412847
  error estimate for blocks of size 2^( 7) =       0.000463593592

      target function =      -0.898864649225
              le_mean =     -16.897082296265
             les_mean =     285.820711239431
             stat err =       0.000454771706
             autocorr =       1.337233007253
   target nu stat err =       0.000454771706
   target dn stat err =       0.007746644169
      target stat err =       0.011227602978
              std dev =       0.556166582376
             le_variance =       0.309321267352

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.309359703830
                                         uncertainty =       0.007433768588

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.309359703830
                                         uncertainty =       0.007433768588

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000393269162
  error estimate for blocks of size 2^( 2) =       0.000410103112
  error estimate for blocks of size 2^( 3) =       0.000426596248
  error estimate for blocks of size 2^( 4) =       0.000441965790
  error estimate for blocks of size 2^( 5) =       0.000453114594
  error estimate for blocks of size 2^( 6) =       0.000460412847
  error estimate for blocks of size 2^( 7) =       0.000463593592

      target function =      -0.898864649225
              le_mean =     -16.897082296265
             les_mean =     285.820711239431
             stat err =       0.000454771706
             autocorr =       1.337233007253
   target nu stat err =       0.000454771706
   target dn stat err =       0.007746644169
      target stat err =       0.011227602978
              std dev =       0.556166582376
             le_variance =       0.309321267352


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.898864649225        initial  <--
     3.9062e+13     3.9062e+14             0.0000e+00        -0.898864649225
     1.5625e+14     1.5625e+15             0.0000e+00        -0.898864649225
     6.2500e+14     6.2500e+15             0.0000e+00        -0.898864649225

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 32.8884
  </log>
  <optVariables href="H2O.s032.opt.xml">
 uu_0                 2.517233e-01 1 1  ON 0
 uu_1                 1.009440e-01 1 1  ON 1
 uu_2                 1.617079e-02 1 1  ON 2
 uu_3                -3.223684e-02 1 1  ON 3
 uu_4                -6.387117e-02 1 1  ON 4
 uu_5                -8.576607e-02 1 1  ON 5
 uu_6                -1.001312e-01 1 1  ON 6
 uu_7                -1.065673e-01 1 1  ON 7
 uu_8                -9.668739e-02 1 1  ON 8
 uu_9                -6.389513e-02 1 1  ON 9
 ud_0                 3.492134e-01 1 1  ON 10
 ud_1                 1.235409e-01 1 1  ON 11
 ud_2                 2.392782e-02 1 1  ON 12
 ud_3                -3.019578e-02 1 1  ON 13
 ud_4                -6.975615e-02 1 1  ON 14
 ud_5                -9.484122e-02 1 1  ON 15
 ud_6                -1.085598e-01 1 1  ON 16
 ud_7                -1.109505e-01 1 1  ON 17
 ud_8                -9.792103e-02 1 1  ON 18
 ud_9                -6.281979e-02 1 1  ON 19
 eO_0                -5.692885e-01 1 1  ON 20
 eO_1                -3.060844e-01 1 1  ON 21
 eO_2                 4.730127e-02 1 1  ON 22
 eO_3                 2.840620e-01 1 1  ON 23
 eO_4                 3.913445e-01 1 1  ON 24
 eO_5                 3.212389e-01 1 1  ON 25
 eO_6                 1.205694e-01 1 1  ON 26
 eO_7                -7.888705e-02 1 1  ON 27
 eO_8                -1.549102e-01 1 1  ON 28
 eO_9                -6.122098e-02 1 1  ON 29
eH1_0                -2.277697e-01 1 1  ON 30
eH1_1                -1.106400e-01 1 1  ON 31
eH1_2                -6.162952e-02 1 1  ON 32
eH1_3                -2.530653e-02 1 1  ON 33
eH1_4                 4.247832e-03 1 1  ON 34
eH1_5                 2.367079e-02 1 1  ON 35
eH1_6                 6.569443e-02 1 1  ON 36
eH1_7                 1.154361e-01 1 1  ON 37
eH1_8                 1.435221e-01 1 1  ON 38
eH1_9                 7.467419e-02 1 1  ON 39
eH2_0                -2.307043e-01 1 1  ON 40
eH2_1                -1.139386e-01 1 1  ON 41
eH2_2                -6.444539e-02 1 1  ON 42
eH2_3                -2.722663e-02 1 1  ON 43
eH2_4                 1.073593e-03 1 1  ON 44
eH2_5                 2.532957e-02 1 1  ON 45
eH2_6                 7.564477e-02 1 1  ON 46
eH2_7                 1.260027e-01 1 1  ON 47
eH2_8                 1.609124e-01 1 1  ON 48
eH2_9                 6.417217e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.8984e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s033 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s033 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=33  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6904e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 33
    time step          = 0.05
    reference energy   = -16.8441
    reference variance = 0.231414
====================================================
  Execution time = 2.0637e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s033
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6899e+01
  VMC Evar = 2.9732e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.5488e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.297345164176
                                         uncertainty =       0.003609214520

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.297345164176
                                         uncertainty =       0.003609214520

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000385564859
  error estimate for blocks of size 2^( 2) =       0.000402643752
  error estimate for blocks of size 2^( 3) =       0.000419903361
  error estimate for blocks of size 2^( 4) =       0.000435625268
  error estimate for blocks of size 2^( 5) =       0.000447807028
  error estimate for blocks of size 2^( 6) =       0.000454246537
  error estimate for blocks of size 2^( 7) =       0.000457450208

      target function =      -0.916719937859
              le_mean =     -16.898566974459
             les_mean =     285.858886163036
             stat err =       0.000448782260
             autocorr =       1.354804008368
   target nu stat err =       0.000448782260
   target dn stat err =       0.004009846413
      target stat err =       0.006092311979
              std dev =       0.545271053173
             le_variance =       0.297320521428


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.689856697446e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 3.9062e+14, overlap shift 3.9062e+15 and omega -1.7456e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.916758899900       residual = 2.04e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.916758899900       residual = 2.04e-03           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to small subspace S singular value of 7.03e-01
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.9062e+14 is 0.000000e+00

solving harmonic davidson linear method for identity shift 1.5625e+15, overlap shift 1.5625e+16 and omega -1.7456e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.916758899900       residual = 2.04e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.916758899900       residual = 2.04e-03           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to small subspace S singular value of 7.03e-01
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.5625e+15 is 0.000000e+00

solving harmonic davidson linear method for identity shift 6.2500e+15, overlap shift 6.2500e+16 and omega -1.7456e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.916758899900       residual = 2.04e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.916758899900       residual = 2.04e-03           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to small subspace S singular value of 7.03e-01
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 6.2500e+15 is 0.000000e+00

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               1.456767 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.6192e+01
  </log>
  <optVariables href="H2O.s033.opt.xml">
 uu_0                 2.517233e-01 1 1  ON 0
 uu_1                 1.009440e-01 1 1  ON 1
 uu_2                 1.617079e-02 1 1  ON 2
 uu_3                -3.223684e-02 1 1  ON 3
 uu_4                -6.387117e-02 1 1  ON 4
 uu_5                -8.576607e-02 1 1  ON 5
 uu_6                -1.001312e-01 1 1  ON 6
 uu_7                -1.065673e-01 1 1  ON 7
 uu_8                -9.668739e-02 1 1  ON 8
 uu_9                -6.389513e-02 1 1  ON 9
 ud_0                 3.492134e-01 1 1  ON 10
 ud_1                 1.235409e-01 1 1  ON 11
 ud_2                 2.392782e-02 1 1  ON 12
 ud_3                -3.019578e-02 1 1  ON 13
 ud_4                -6.975615e-02 1 1  ON 14
 ud_5                -9.484122e-02 1 1  ON 15
 ud_6                -1.085598e-01 1 1  ON 16
 ud_7                -1.109505e-01 1 1  ON 17
 ud_8                -9.792103e-02 1 1  ON 18
 ud_9                -6.281979e-02 1 1  ON 19
 eO_0                -5.692885e-01 1 1  ON 20
 eO_1                -3.060844e-01 1 1  ON 21
 eO_2                 4.730127e-02 1 1  ON 22
 eO_3                 2.840620e-01 1 1  ON 23
 eO_4                 3.913445e-01 1 1  ON 24
 eO_5                 3.212389e-01 1 1  ON 25
 eO_6                 1.205694e-01 1 1  ON 26
 eO_7                -7.888705e-02 1 1  ON 27
 eO_8                -1.549102e-01 1 1  ON 28
 eO_9                -6.122098e-02 1 1  ON 29
eH1_0                -2.277697e-01 1 1  ON 30
eH1_1                -1.106400e-01 1 1  ON 31
eH1_2                -6.162952e-02 1 1  ON 32
eH1_3                -2.530653e-02 1 1  ON 33
eH1_4                 4.247832e-03 1 1  ON 34
eH1_5                 2.367079e-02 1 1  ON 35
eH1_6                 6.569443e-02 1 1  ON 36
eH1_7                 1.154361e-01 1 1  ON 37
eH1_8                 1.435221e-01 1 1  ON 38
eH1_9                 7.467419e-02 1 1  ON 39
eH2_0                -2.307043e-01 1 1  ON 40
eH2_1                -1.139386e-01 1 1  ON 41
eH2_2                -6.444539e-02 1 1  ON 42
eH2_3                -2.722663e-02 1 1  ON 43
eH2_4                 1.073593e-03 1 1  ON 44
eH2_5                 2.532957e-02 1 1  ON 45
eH2_6                 7.564477e-02 1 1  ON 46
eH2_7                 1.260027e-01 1 1  ON 47
eH2_8                 1.609124e-01 1 1  ON 48
eH2_9                 6.417217e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 33
    time step          = 0.05
    reference energy   = -16.8637
    reference variance = 0.801967
====================================================
  Execution time = 2.0718e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s033
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6898e+01
  VMC Evar = 2.9957e-01
  Total weights = 2.0000e+06
  Execution time = 1.8706e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.299523469678
                                         uncertainty =       0.005368869329

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.299523469678
                                         uncertainty =       0.005368869329

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000387023489
  error estimate for blocks of size 2^( 2) =       0.000404082812
  error estimate for blocks of size 2^( 3) =       0.000421512712
  error estimate for blocks of size 2^( 4) =       0.000436585900
  error estimate for blocks of size 2^( 5) =       0.000447645112
  error estimate for blocks of size 2^( 6) =       0.000455160757
  error estimate for blocks of size 2^( 7) =       0.000460227927

      target function =      -0.913283288435
              le_mean =     -16.897974796919
             les_mean =     285.841126449337
             stat err =       0.000449904924
             autocorr =       1.351346886225
   target nu stat err =       0.000449904924
   target dn stat err =       0.005385264232
      target stat err =       0.008086299659
              std dev =       0.547333866868
             le_variance =       0.299574361821

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.299523469678
                                         uncertainty =       0.005368869329

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.299523469678
                                         uncertainty =       0.005368869329

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000387023489
  error estimate for blocks of size 2^( 2) =       0.000404082812
  error estimate for blocks of size 2^( 3) =       0.000421512712
  error estimate for blocks of size 2^( 4) =       0.000436585900
  error estimate for blocks of size 2^( 5) =       0.000447645112
  error estimate for blocks of size 2^( 6) =       0.000455160757
  error estimate for blocks of size 2^( 7) =       0.000460227927

      target function =      -0.913283288435
              le_mean =     -16.897974796919
             les_mean =     285.841126449337
             stat err =       0.000449904924
             autocorr =       1.351346886225
   target nu stat err =       0.000449904924
   target dn stat err =       0.005385264232
      target stat err =       0.008086299659
              std dev =       0.547333866868
             le_variance =       0.299574361821

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.299523469678
                                         uncertainty =       0.005368869329

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.299523469678
                                         uncertainty =       0.005368869329

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000387023489
  error estimate for blocks of size 2^( 2) =       0.000404082812
  error estimate for blocks of size 2^( 3) =       0.000421512712
  error estimate for blocks of size 2^( 4) =       0.000436585900
  error estimate for blocks of size 2^( 5) =       0.000447645112
  error estimate for blocks of size 2^( 6) =       0.000455160757
  error estimate for blocks of size 2^( 7) =       0.000460227927

      target function =      -0.913283288435
              le_mean =     -16.897974796919
             les_mean =     285.841126449337
             stat err =       0.000449904924
             autocorr =       1.351346886225
   target nu stat err =       0.000449904924
   target dn stat err =       0.005385264232
      target stat err =       0.008086299659
              std dev =       0.547333866868
             le_variance =       0.299574361821

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.299523469678
                                         uncertainty =       0.005368869329

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.299523469678
                                         uncertainty =       0.005368869329

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000387023489
  error estimate for blocks of size 2^( 2) =       0.000404082812
  error estimate for blocks of size 2^( 3) =       0.000421512712
  error estimate for blocks of size 2^( 4) =       0.000436585900
  error estimate for blocks of size 2^( 5) =       0.000447645112
  error estimate for blocks of size 2^( 6) =       0.000455160757
  error estimate for blocks of size 2^( 7) =       0.000460227927

      target function =      -0.913283288435
              le_mean =     -16.897974796919
             les_mean =     285.841126449337
             stat err =       0.000449904924
             autocorr =       1.351346886225
   target nu stat err =       0.000449904924
   target dn stat err =       0.005385264232
      target stat err =       0.008086299659
              std dev =       0.547333866868
             le_variance =       0.299574361821


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.913283288435        initial  <--
     3.9062e+14     3.9062e+15             0.0000e+00        -0.913283288435
     1.5625e+15     1.5625e+16             0.0000e+00        -0.913283288435
     6.2500e+15     6.2500e+16             0.0000e+00        -0.913283288435

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 30.1760
  </log>
  <optVariables href="H2O.s033.opt.xml">
 uu_0                 2.517233e-01 1 1  ON 0
 uu_1                 1.009440e-01 1 1  ON 1
 uu_2                 1.617079e-02 1 1  ON 2
 uu_3                -3.223684e-02 1 1  ON 3
 uu_4                -6.387117e-02 1 1  ON 4
 uu_5                -8.576607e-02 1 1  ON 5
 uu_6                -1.001312e-01 1 1  ON 6
 uu_7                -1.065673e-01 1 1  ON 7
 uu_8                -9.668739e-02 1 1  ON 8
 uu_9                -6.389513e-02 1 1  ON 9
 ud_0                 3.492134e-01 1 1  ON 10
 ud_1                 1.235409e-01 1 1  ON 11
 ud_2                 2.392782e-02 1 1  ON 12
 ud_3                -3.019578e-02 1 1  ON 13
 ud_4                -6.975615e-02 1 1  ON 14
 ud_5                -9.484122e-02 1 1  ON 15
 ud_6                -1.085598e-01 1 1  ON 16
 ud_7                -1.109505e-01 1 1  ON 17
 ud_8                -9.792103e-02 1 1  ON 18
 ud_9                -6.281979e-02 1 1  ON 19
 eO_0                -5.692885e-01 1 1  ON 20
 eO_1                -3.060844e-01 1 1  ON 21
 eO_2                 4.730127e-02 1 1  ON 22
 eO_3                 2.840620e-01 1 1  ON 23
 eO_4                 3.913445e-01 1 1  ON 24
 eO_5                 3.212389e-01 1 1  ON 25
 eO_6                 1.205694e-01 1 1  ON 26
 eO_7                -7.888705e-02 1 1  ON 27
 eO_8                -1.549102e-01 1 1  ON 28
 eO_9                -6.122098e-02 1 1  ON 29
eH1_0                -2.277697e-01 1 1  ON 30
eH1_1                -1.106400e-01 1 1  ON 31
eH1_2                -6.162952e-02 1 1  ON 32
eH1_3                -2.530653e-02 1 1  ON 33
eH1_4                 4.247832e-03 1 1  ON 34
eH1_5                 2.367079e-02 1 1  ON 35
eH1_6                 6.569443e-02 1 1  ON 36
eH1_7                 1.154361e-01 1 1  ON 37
eH1_8                 1.435221e-01 1 1  ON 38
eH1_9                 7.467419e-02 1 1  ON 39
eH2_0                -2.307043e-01 1 1  ON 40
eH2_1                -1.139386e-01 1 1  ON 41
eH2_2                -6.444539e-02 1 1  ON 42
eH2_3                -2.722663e-02 1 1  ON 43
eH2_4                 1.073593e-03 1 1  ON 44
eH2_5                 2.532957e-02 1 1  ON 45
eH2_6                 7.564477e-02 1 1  ON 46
eH2_7                 1.260027e-01 1 1  ON 47
eH2_8                 1.609124e-01 1 1  ON 48
eH2_9                 6.417217e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.6374e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s034 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s034 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=34  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6903e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 34
    time step          = 0.05
    reference energy   = -16.8841
    reference variance = 0.300422
====================================================
  Execution time = 2.0870e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s034
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6898e+01
  VMC Evar = 2.9357e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.5426e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.293609128815
                                         uncertainty =       0.003208160836

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.293609128815
                                         uncertainty =       0.003208160836

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000383123732
  error estimate for blocks of size 2^( 2) =       0.000400167528
  error estimate for blocks of size 2^( 3) =       0.000417932102
  error estimate for blocks of size 2^( 4) =       0.000433700656
  error estimate for blocks of size 2^( 5) =       0.000445836590
  error estimate for blocks of size 2^( 6) =       0.000452423105
  error estimate for blocks of size 2^( 7) =       0.000456751572

      target function =      -0.922395195118
              le_mean =     -16.897886581543
             les_mean =     285.832138364564
             stat err =       0.000447177981
             autocorr =       1.362331224944
   target nu stat err =       0.000447177981
   target dn stat err =       0.003317173726
      target stat err =       0.005112391087
              std dev =       0.541818778442
             le_variance =       0.293567588672


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.689788658154e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 3.9062e+15, overlap shift 3.9062e+16 and omega -1.7456e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.922421965407       residual = 1.66e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.922421965407       residual = 7.01e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.922421965407       residual = 6.84e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.922421965407       residual = 5.87e-03           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -1.071713495391       residual = 2.03e+00           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -1.021690614856       residual = 1.18e+00           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -1.880969347815       residual = 1.02e+03           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =       0.916188267641       residual = 3.60e+03           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =       0.527744487957       residual = 3.25e+03           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -1.167148114209       residual = 1.02e+04           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =       6.374837923146       residual = 1.65e+04           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -4.690609289466       residual = 9.48e+03           smallest_sin_value = 1.00e+00
davidson iteration   12 stopping due to too large eigenvalue change
davidson solver did not converge after         12 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.9062e+15 is 1.804766e-20

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 1.5625e+16, overlap shift 1.5625e+17 and omega -1.7456e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.922421965407       residual = 1.66e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.922421965407       residual = 7.01e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.922421965407       residual = 6.84e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.922421965407       residual = 6.77e-02           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =       4.260824438696       residual = 2.12e+03           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -1.953782117268       residual = 8.54e+01           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.753613862567       residual = 5.27e+04           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -2.479577685642       residual = 2.31e+04           smallest_sin_value = 1.00e+00
davidson iteration    8 stopping due to too large eigenvalue change
davidson solver did not converge after          8 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.5625e+16 is 4.511916e-21

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 6.2500e+16, overlap shift 6.2500e+17 and omega -1.7456e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.922421965407       residual = 1.66e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.922421965407       residual = 7.01e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.922421965407       residual = 5.16e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.922421965407       residual = 1.18e-01           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =       1.966482197021       residual = 6.50e+02           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -4.264941537113       residual = 8.88e+02           smallest_sin_value = 1.00e+00
davidson iteration    6 stopping due to too large eigenvalue change
davidson solver did not converge after          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 6.2500e+16 is 1.002648e-21

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               1.460410 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.6422e+01
  </log>
  <optVariables href="H2O.s034.opt.xml">
 uu_0                 2.517233e-01 1 1  ON 0
 uu_1                 1.009440e-01 1 1  ON 1
 uu_2                 1.617079e-02 1 1  ON 2
 uu_3                -3.223684e-02 1 1  ON 3
 uu_4                -6.387117e-02 1 1  ON 4
 uu_5                -8.576607e-02 1 1  ON 5
 uu_6                -1.001312e-01 1 1  ON 6
 uu_7                -1.065673e-01 1 1  ON 7
 uu_8                -9.668739e-02 1 1  ON 8
 uu_9                -6.389513e-02 1 1  ON 9
 ud_0                 3.492134e-01 1 1  ON 10
 ud_1                 1.235409e-01 1 1  ON 11
 ud_2                 2.392782e-02 1 1  ON 12
 ud_3                -3.019578e-02 1 1  ON 13
 ud_4                -6.975615e-02 1 1  ON 14
 ud_5                -9.484122e-02 1 1  ON 15
 ud_6                -1.085598e-01 1 1  ON 16
 ud_7                -1.109505e-01 1 1  ON 17
 ud_8                -9.792103e-02 1 1  ON 18
 ud_9                -6.281979e-02 1 1  ON 19
 eO_0                -5.692885e-01 1 1  ON 20
 eO_1                -3.060844e-01 1 1  ON 21
 eO_2                 4.730127e-02 1 1  ON 22
 eO_3                 2.840620e-01 1 1  ON 23
 eO_4                 3.913445e-01 1 1  ON 24
 eO_5                 3.212389e-01 1 1  ON 25
 eO_6                 1.205694e-01 1 1  ON 26
 eO_7                -7.888705e-02 1 1  ON 27
 eO_8                -1.549102e-01 1 1  ON 28
 eO_9                -6.122098e-02 1 1  ON 29
eH1_0                -2.277697e-01 1 1  ON 30
eH1_1                -1.106400e-01 1 1  ON 31
eH1_2                -6.162952e-02 1 1  ON 32
eH1_3                -2.530653e-02 1 1  ON 33
eH1_4                 4.247832e-03 1 1  ON 34
eH1_5                 2.367079e-02 1 1  ON 35
eH1_6                 6.569443e-02 1 1  ON 36
eH1_7                 1.154361e-01 1 1  ON 37
eH1_8                 1.435221e-01 1 1  ON 38
eH1_9                 7.467419e-02 1 1  ON 39
eH2_0                -2.307043e-01 1 1  ON 40
eH2_1                -1.139386e-01 1 1  ON 41
eH2_2                -6.444539e-02 1 1  ON 42
eH2_3                -2.722663e-02 1 1  ON 43
eH2_4                 1.073593e-03 1 1  ON 44
eH2_5                 2.532957e-02 1 1  ON 45
eH2_6                 7.564477e-02 1 1  ON 46
eH2_7                 1.260027e-01 1 1  ON 47
eH2_8                 1.609124e-01 1 1  ON 48
eH2_9                 6.417217e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 34
    time step          = 0.05
    reference energy   = -16.9951
    reference variance = 0.49089
====================================================
  Execution time = 2.0261e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s034
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6898e+01
  VMC Evar = 2.9585e-01
  Total weights = 2.0000e+06
  Execution time = 1.8766e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.295908216625
                                         uncertainty =       0.003909498373

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.295908216625
                                         uncertainty =       0.003909498373

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000384608066
  error estimate for blocks of size 2^( 2) =       0.000401464950
  error estimate for blocks of size 2^( 3) =       0.000419446606
  error estimate for blocks of size 2^( 4) =       0.000434696631
  error estimate for blocks of size 2^( 5) =       0.000445810382
  error estimate for blocks of size 2^( 6) =       0.000453943684
  error estimate for blocks of size 2^( 7) =       0.000459151540

      target function =      -0.918943672477
              le_mean =     -16.898364473566
             les_mean =     285.850568462115
             stat err =       0.000448400560
             autocorr =       1.359238026971
   target nu stat err =       0.000448400560
   target dn stat err =       0.003824015255
      target stat err =       0.005840005649
              std dev =       0.543917942855
             le_variance =       0.295846728560

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.295908216625
                                         uncertainty =       0.003909498373

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.295908216625
                                         uncertainty =       0.003909498373

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000384608066
  error estimate for blocks of size 2^( 2) =       0.000401464950
  error estimate for blocks of size 2^( 3) =       0.000419446606
  error estimate for blocks of size 2^( 4) =       0.000434696631
  error estimate for blocks of size 2^( 5) =       0.000445810382
  error estimate for blocks of size 2^( 6) =       0.000453943684
  error estimate for blocks of size 2^( 7) =       0.000459151540

      target function =      -0.918943672477
              le_mean =     -16.898364473566
             les_mean =     285.850568462115
             stat err =       0.000448400560
             autocorr =       1.359238026971
   target nu stat err =       0.000448400560
   target dn stat err =       0.003824015255
      target stat err =       0.005840005649
              std dev =       0.543917942855
             le_variance =       0.295846728560

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.295908216625
                                         uncertainty =       0.003909498373

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.295908216625
                                         uncertainty =       0.003909498373

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000384608066
  error estimate for blocks of size 2^( 2) =       0.000401464950
  error estimate for blocks of size 2^( 3) =       0.000419446606
  error estimate for blocks of size 2^( 4) =       0.000434696631
  error estimate for blocks of size 2^( 5) =       0.000445810382
  error estimate for blocks of size 2^( 6) =       0.000453943684
  error estimate for blocks of size 2^( 7) =       0.000459151540

      target function =      -0.918943672477
              le_mean =     -16.898364473566
             les_mean =     285.850568462115
             stat err =       0.000448400560
             autocorr =       1.359238026971
   target nu stat err =       0.000448400560
   target dn stat err =       0.003824015255
      target stat err =       0.005840005649
              std dev =       0.543917942855
             le_variance =       0.295846728560

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.295908216625
                                         uncertainty =       0.003909498373

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.295908216625
                                         uncertainty =       0.003909498373

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000384608066
  error estimate for blocks of size 2^( 2) =       0.000401464950
  error estimate for blocks of size 2^( 3) =       0.000419446606
  error estimate for blocks of size 2^( 4) =       0.000434696631
  error estimate for blocks of size 2^( 5) =       0.000445810382
  error estimate for blocks of size 2^( 6) =       0.000453943684
  error estimate for blocks of size 2^( 7) =       0.000459151540

      target function =      -0.918943672477
              le_mean =     -16.898364473566
             les_mean =     285.850568462115
             stat err =       0.000448400560
             autocorr =       1.359238026971
   target nu stat err =       0.000448400560
   target dn stat err =       0.003824015255
      target stat err =       0.005840005649
              std dev =       0.543917942855
             le_variance =       0.295846728560


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.918943672477        initial  <--
     3.9062e+15     3.9062e+16             1.8048e-20        -0.918943672477
     1.5625e+16     1.5625e+17             4.5119e-21        -0.918943672477
     6.2500e+16     6.2500e+17             1.0026e-21        -0.918943672477

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 29.7360
  </log>
  <optVariables href="H2O.s034.opt.xml">
 uu_0                 2.517233e-01 1 1  ON 0
 uu_1                 1.009440e-01 1 1  ON 1
 uu_2                 1.617079e-02 1 1  ON 2
 uu_3                -3.223684e-02 1 1  ON 3
 uu_4                -6.387117e-02 1 1  ON 4
 uu_5                -8.576607e-02 1 1  ON 5
 uu_6                -1.001312e-01 1 1  ON 6
 uu_7                -1.065673e-01 1 1  ON 7
 uu_8                -9.668739e-02 1 1  ON 8
 uu_9                -6.389513e-02 1 1  ON 9
 ud_0                 3.492134e-01 1 1  ON 10
 ud_1                 1.235409e-01 1 1  ON 11
 ud_2                 2.392782e-02 1 1  ON 12
 ud_3                -3.019578e-02 1 1  ON 13
 ud_4                -6.975615e-02 1 1  ON 14
 ud_5                -9.484122e-02 1 1  ON 15
 ud_6                -1.085598e-01 1 1  ON 16
 ud_7                -1.109505e-01 1 1  ON 17
 ud_8                -9.792103e-02 1 1  ON 18
 ud_9                -6.281979e-02 1 1  ON 19
 eO_0                -5.692885e-01 1 1  ON 20
 eO_1                -3.060844e-01 1 1  ON 21
 eO_2                 4.730127e-02 1 1  ON 22
 eO_3                 2.840620e-01 1 1  ON 23
 eO_4                 3.913445e-01 1 1  ON 24
 eO_5                 3.212389e-01 1 1  ON 25
 eO_6                 1.205694e-01 1 1  ON 26
 eO_7                -7.888705e-02 1 1  ON 27
 eO_8                -1.549102e-01 1 1  ON 28
 eO_9                -6.122098e-02 1 1  ON 29
eH1_0                -2.277697e-01 1 1  ON 30
eH1_1                -1.106400e-01 1 1  ON 31
eH1_2                -6.162952e-02 1 1  ON 32
eH1_3                -2.530653e-02 1 1  ON 33
eH1_4                 4.247832e-03 1 1  ON 34
eH1_5                 2.367079e-02 1 1  ON 35
eH1_6                 6.569443e-02 1 1  ON 36
eH1_7                 1.154361e-01 1 1  ON 37
eH1_8                 1.435221e-01 1 1  ON 38
eH1_9                 7.467419e-02 1 1  ON 39
eH2_0                -2.307043e-01 1 1  ON 40
eH2_1                -1.139386e-01 1 1  ON 41
eH2_2                -6.444539e-02 1 1  ON 42
eH2_3                -2.722663e-02 1 1  ON 43
eH2_4                 1.073593e-03 1 1  ON 44
eH2_5                 2.532957e-02 1 1  ON 45
eH2_6                 7.564477e-02 1 1  ON 46
eH2_7                 1.260027e-01 1 1  ON 47
eH2_8                 1.609124e-01 1 1  ON 48
eH2_9                 6.417217e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.6163e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s035 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s035 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=35  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6904e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 35
    time step          = 0.05
    reference energy   = -16.8849
    reference variance = 0.195774
====================================================
  Execution time = 2.0758e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s035
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6898e+01
  VMC Evar = 2.9632e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.5378e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.296312613096
                                         uncertainty =       0.002757255922

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.296312613096
                                         uncertainty =       0.002757255922

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000384914034
  error estimate for blocks of size 2^( 2) =       0.000401798924
  error estimate for blocks of size 2^( 3) =       0.000419224055
  error estimate for blocks of size 2^( 4) =       0.000433897740
  error estimate for blocks of size 2^( 5) =       0.000446000647
  error estimate for blocks of size 2^( 6) =       0.000453089234
  error estimate for blocks of size 2^( 7) =       0.000458193245

      target function =      -0.918222537021
              le_mean =     -16.897780541420
             les_mean =     285.831304705270
             stat err =       0.000447795216
             autocorr =       1.353416316298
   target nu stat err =       0.000447795216
   target dn stat err =       0.002909790583
      target stat err =       0.004457793293
              std dev =       0.544350647506
             le_variance =       0.296317627441


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.689778054142e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 3.9062e+16, overlap shift 3.9062e+17 and omega -1.7456e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.918242732155       residual = 1.82e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.918242732155       residual = 1.82e-03           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to small subspace S singular value of 6.22e-01
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.9062e+16 is 0.000000e+00

solving harmonic davidson linear method for identity shift 1.5625e+17, overlap shift 1.5625e+18 and omega -1.7456e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.918242732155       residual = 1.82e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.918242732155       residual = 1.82e-03           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.5625e+17 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 6.2500e+17, overlap shift 6.2500e+18 and omega -1.7456e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.918242732155       residual = 1.82e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.918242732155       residual = 1.82e-03           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 6.2500e+17 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               1.461491 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.6303e+01
  </log>
  <optVariables href="H2O.s035.opt.xml">
 uu_0                 2.517233e-01 1 1  ON 0
 uu_1                 1.009440e-01 1 1  ON 1
 uu_2                 1.617079e-02 1 1  ON 2
 uu_3                -3.223684e-02 1 1  ON 3
 uu_4                -6.387117e-02 1 1  ON 4
 uu_5                -8.576607e-02 1 1  ON 5
 uu_6                -1.001312e-01 1 1  ON 6
 uu_7                -1.065673e-01 1 1  ON 7
 uu_8                -9.668739e-02 1 1  ON 8
 uu_9                -6.389513e-02 1 1  ON 9
 ud_0                 3.492134e-01 1 1  ON 10
 ud_1                 1.235409e-01 1 1  ON 11
 ud_2                 2.392782e-02 1 1  ON 12
 ud_3                -3.019578e-02 1 1  ON 13
 ud_4                -6.975615e-02 1 1  ON 14
 ud_5                -9.484122e-02 1 1  ON 15
 ud_6                -1.085598e-01 1 1  ON 16
 ud_7                -1.109505e-01 1 1  ON 17
 ud_8                -9.792103e-02 1 1  ON 18
 ud_9                -6.281979e-02 1 1  ON 19
 eO_0                -5.692885e-01 1 1  ON 20
 eO_1                -3.060844e-01 1 1  ON 21
 eO_2                 4.730127e-02 1 1  ON 22
 eO_3                 2.840620e-01 1 1  ON 23
 eO_4                 3.913445e-01 1 1  ON 24
 eO_5                 3.212389e-01 1 1  ON 25
 eO_6                 1.205694e-01 1 1  ON 26
 eO_7                -7.888705e-02 1 1  ON 27
 eO_8                -1.549102e-01 1 1  ON 28
 eO_9                -6.122098e-02 1 1  ON 29
eH1_0                -2.277697e-01 1 1  ON 30
eH1_1                -1.106400e-01 1 1  ON 31
eH1_2                -6.162952e-02 1 1  ON 32
eH1_3                -2.530653e-02 1 1  ON 33
eH1_4                 4.247832e-03 1 1  ON 34
eH1_5                 2.367079e-02 1 1  ON 35
eH1_6                 6.569443e-02 1 1  ON 36
eH1_7                 1.154361e-01 1 1  ON 37
eH1_8                 1.435221e-01 1 1  ON 38
eH1_9                 7.467419e-02 1 1  ON 39
eH2_0                -2.307043e-01 1 1  ON 40
eH2_1                -1.139386e-01 1 1  ON 41
eH2_2                -6.444539e-02 1 1  ON 42
eH2_3                -2.722663e-02 1 1  ON 43
eH2_4                 1.073593e-03 1 1  ON 44
eH2_5                 2.532957e-02 1 1  ON 45
eH2_6                 7.564477e-02 1 1  ON 46
eH2_7                 1.260027e-01 1 1  ON 47
eH2_8                 1.609124e-01 1 1  ON 48
eH2_9                 6.417217e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 35
    time step          = 0.05
    reference energy   = -16.8998
    reference variance = 0.22307
====================================================
  Execution time = 2.0750e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s035
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6898e+01
  VMC Evar = 2.9260e-01
  Total weights = 2.0000e+06
  Execution time = 1.8815e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.292597775062
                                         uncertainty =       0.002247375249

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.292597775062
                                         uncertainty =       0.002247375249

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000382489044
  error estimate for blocks of size 2^( 2) =       0.000399850414
  error estimate for blocks of size 2^( 3) =       0.000417167863
  error estimate for blocks of size 2^( 4) =       0.000431765670
  error estimate for blocks of size 2^( 5) =       0.000442543236
  error estimate for blocks of size 2^( 6) =       0.000450218230
  error estimate for blocks of size 2^( 7) =       0.000453433682

      target function =      -0.923910434567
              le_mean =     -16.898179231890
             les_mean =     285.841056944348
             stat err =       0.000444490204
             autocorr =       1.350474503998
   target nu stat err =       0.000444490204
   target dn stat err =       0.002133466579
      target stat err =       0.003347872221
              std dev =       0.540921193481
             le_variance =       0.292595737557

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.292597775062
                                         uncertainty =       0.002247375249

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.292597775062
                                         uncertainty =       0.002247375249

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000382489044
  error estimate for blocks of size 2^( 2) =       0.000399850414
  error estimate for blocks of size 2^( 3) =       0.000417167863
  error estimate for blocks of size 2^( 4) =       0.000431765670
  error estimate for blocks of size 2^( 5) =       0.000442543236
  error estimate for blocks of size 2^( 6) =       0.000450218230
  error estimate for blocks of size 2^( 7) =       0.000453433682

      target function =      -0.923910434567
              le_mean =     -16.898179231890
             les_mean =     285.841056944348
             stat err =       0.000444490204
             autocorr =       1.350474503998
   target nu stat err =       0.000444490204
   target dn stat err =       0.002133466579
      target stat err =       0.003347872221
              std dev =       0.540921193481
             le_variance =       0.292595737557

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.292597775062
                                         uncertainty =       0.002247375249

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.292597775062
                                         uncertainty =       0.002247375249

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000382489044
  error estimate for blocks of size 2^( 2) =       0.000399850414
  error estimate for blocks of size 2^( 3) =       0.000417167863
  error estimate for blocks of size 2^( 4) =       0.000431765670
  error estimate for blocks of size 2^( 5) =       0.000442543236
  error estimate for blocks of size 2^( 6) =       0.000450218230
  error estimate for blocks of size 2^( 7) =       0.000453433682

      target function =      -0.923910434567
              le_mean =     -16.898179231890
             les_mean =     285.841056944348
             stat err =       0.000444490204
             autocorr =       1.350474503998
   target nu stat err =       0.000444490204
   target dn stat err =       0.002133466579
      target stat err =       0.003347872221
              std dev =       0.540921193481
             le_variance =       0.292595737557

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.292597775062
                                         uncertainty =       0.002247375249

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.292597775062
                                         uncertainty =       0.002247375249

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000382489044
  error estimate for blocks of size 2^( 2) =       0.000399850414
  error estimate for blocks of size 2^( 3) =       0.000417167863
  error estimate for blocks of size 2^( 4) =       0.000431765670
  error estimate for blocks of size 2^( 5) =       0.000442543236
  error estimate for blocks of size 2^( 6) =       0.000450218230
  error estimate for blocks of size 2^( 7) =       0.000453433682

      target function =      -0.923910434567
              le_mean =     -16.898179231890
             les_mean =     285.841056944348
             stat err =       0.000444490204
             autocorr =       1.350474503998
   target nu stat err =       0.000444490204
   target dn stat err =       0.002133466579
      target stat err =       0.003347872221
              std dev =       0.540921193481
             le_variance =       0.292595737557


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.923910434567        initial  <--
     3.9062e+16     3.9062e+17             0.0000e+00        -0.923910434567
     1.5625e+17     1.5625e+18             0.0000e+00        -0.923910434567
     6.2500e+17     6.2500e+18             0.0000e+00        -0.923910434567

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 33.8958
  </log>
  <optVariables href="H2O.s035.opt.xml">
 uu_0                 2.517233e-01 1 1  ON 0
 uu_1                 1.009440e-01 1 1  ON 1
 uu_2                 1.617079e-02 1 1  ON 2
 uu_3                -3.223684e-02 1 1  ON 3
 uu_4                -6.387117e-02 1 1  ON 4
 uu_5                -8.576607e-02 1 1  ON 5
 uu_6                -1.001312e-01 1 1  ON 6
 uu_7                -1.065673e-01 1 1  ON 7
 uu_8                -9.668739e-02 1 1  ON 8
 uu_9                -6.389513e-02 1 1  ON 9
 ud_0                 3.492134e-01 1 1  ON 10
 ud_1                 1.235409e-01 1 1  ON 11
 ud_2                 2.392782e-02 1 1  ON 12
 ud_3                -3.019578e-02 1 1  ON 13
 ud_4                -6.975615e-02 1 1  ON 14
 ud_5                -9.484122e-02 1 1  ON 15
 ud_6                -1.085598e-01 1 1  ON 16
 ud_7                -1.109505e-01 1 1  ON 17
 ud_8                -9.792103e-02 1 1  ON 18
 ud_9                -6.281979e-02 1 1  ON 19
 eO_0                -5.692885e-01 1 1  ON 20
 eO_1                -3.060844e-01 1 1  ON 21
 eO_2                 4.730127e-02 1 1  ON 22
 eO_3                 2.840620e-01 1 1  ON 23
 eO_4                 3.913445e-01 1 1  ON 24
 eO_5                 3.212389e-01 1 1  ON 25
 eO_6                 1.205694e-01 1 1  ON 26
 eO_7                -7.888705e-02 1 1  ON 27
 eO_8                -1.549102e-01 1 1  ON 28
 eO_9                -6.122098e-02 1 1  ON 29
eH1_0                -2.277697e-01 1 1  ON 30
eH1_1                -1.106400e-01 1 1  ON 31
eH1_2                -6.162952e-02 1 1  ON 32
eH1_3                -2.530653e-02 1 1  ON 33
eH1_4                 4.247832e-03 1 1  ON 34
eH1_5                 2.367079e-02 1 1  ON 35
eH1_6                 6.569443e-02 1 1  ON 36
eH1_7                 1.154361e-01 1 1  ON 37
eH1_8                 1.435221e-01 1 1  ON 38
eH1_9                 7.467419e-02 1 1  ON 39
eH2_0                -2.307043e-01 1 1  ON 40
eH2_1                -1.139386e-01 1 1  ON 41
eH2_2                -6.444539e-02 1 1  ON 42
eH2_3                -2.722663e-02 1 1  ON 43
eH2_4                 1.073593e-03 1 1  ON 44
eH2_5                 2.532957e-02 1 1  ON 45
eH2_6                 7.564477e-02 1 1  ON 46
eH2_7                 1.260027e-01 1 1  ON 47
eH2_8                 1.609124e-01 1 1  ON 48
eH2_9                 6.417217e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 6.0205e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s036 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s036 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=36  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6904e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 36
    time step          = 0.05
    reference energy   = -16.9071
    reference variance = 0.4735
====================================================
  Execution time = 2.0884e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s036
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6898e+01
  VMC Evar = 2.9342e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.4758e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.293415188013
                                         uncertainty =       0.002595836801

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.293415188013
                                         uncertainty =       0.002595836801

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000383027721
  error estimate for blocks of size 2^( 2) =       0.000400299102
  error estimate for blocks of size 2^( 3) =       0.000418030440
  error estimate for blocks of size 2^( 4) =       0.000433569189
  error estimate for blocks of size 2^( 5) =       0.000446106715
  error estimate for blocks of size 2^( 6) =       0.000454841307
  error estimate for blocks of size 2^( 7) =       0.000457830509

      target function =      -0.922650425476
              le_mean =     -16.898343089372
             les_mean =     285.847419490050
             stat err =       0.000448086930
             autocorr =       1.368560935395
   target nu stat err =       0.000448086930
   target dn stat err =       0.002729006153
      target stat err =       0.004232851258
              std dev =       0.541682998287
             le_variance =       0.293420470634


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.689834308937e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 3.9062e+17, overlap shift 3.9062e+18 and omega -1.7456e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.922668384290       residual = 1.73e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.922668384290       residual = 1.73e-03           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.9062e+17 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 1.5625e+18, overlap shift 1.5625e+19 and omega -1.7456e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.922668384290       residual = 1.73e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.922668384290       residual = 1.73e-03           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.5625e+18 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 6.2500e+18, overlap shift 6.2500e+19 and omega -1.7456e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.922668384290       residual = 1.73e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.922668384290       residual = 1.73e-03           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 6.2500e+18 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               1.462582 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.6369e+01
  </log>
  <optVariables href="H2O.s036.opt.xml">
 uu_0                 2.517233e-01 1 1  ON 0
 uu_1                 1.009440e-01 1 1  ON 1
 uu_2                 1.617079e-02 1 1  ON 2
 uu_3                -3.223684e-02 1 1  ON 3
 uu_4                -6.387117e-02 1 1  ON 4
 uu_5                -8.576607e-02 1 1  ON 5
 uu_6                -1.001312e-01 1 1  ON 6
 uu_7                -1.065673e-01 1 1  ON 7
 uu_8                -9.668739e-02 1 1  ON 8
 uu_9                -6.389513e-02 1 1  ON 9
 ud_0                 3.492134e-01 1 1  ON 10
 ud_1                 1.235409e-01 1 1  ON 11
 ud_2                 2.392782e-02 1 1  ON 12
 ud_3                -3.019578e-02 1 1  ON 13
 ud_4                -6.975615e-02 1 1  ON 14
 ud_5                -9.484122e-02 1 1  ON 15
 ud_6                -1.085598e-01 1 1  ON 16
 ud_7                -1.109505e-01 1 1  ON 17
 ud_8                -9.792103e-02 1 1  ON 18
 ud_9                -6.281979e-02 1 1  ON 19
 eO_0                -5.692885e-01 1 1  ON 20
 eO_1                -3.060844e-01 1 1  ON 21
 eO_2                 4.730127e-02 1 1  ON 22
 eO_3                 2.840620e-01 1 1  ON 23
 eO_4                 3.913445e-01 1 1  ON 24
 eO_5                 3.212389e-01 1 1  ON 25
 eO_6                 1.205694e-01 1 1  ON 26
 eO_7                -7.888705e-02 1 1  ON 27
 eO_8                -1.549102e-01 1 1  ON 28
 eO_9                -6.122098e-02 1 1  ON 29
eH1_0                -2.277697e-01 1 1  ON 30
eH1_1                -1.106400e-01 1 1  ON 31
eH1_2                -6.162952e-02 1 1  ON 32
eH1_3                -2.530653e-02 1 1  ON 33
eH1_4                 4.247832e-03 1 1  ON 34
eH1_5                 2.367079e-02 1 1  ON 35
eH1_6                 6.569443e-02 1 1  ON 36
eH1_7                 1.154361e-01 1 1  ON 37
eH1_8                 1.435221e-01 1 1  ON 38
eH1_9                 7.467419e-02 1 1  ON 39
eH2_0                -2.307043e-01 1 1  ON 40
eH2_1                -1.139386e-01 1 1  ON 41
eH2_2                -6.444539e-02 1 1  ON 42
eH2_3                -2.722663e-02 1 1  ON 43
eH2_4                 1.073593e-03 1 1  ON 44
eH2_5                 2.532957e-02 1 1  ON 45
eH2_6                 7.564477e-02 1 1  ON 46
eH2_7                 1.260027e-01 1 1  ON 47
eH2_8                 1.609124e-01 1 1  ON 48
eH2_9                 6.417217e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 36
    time step          = 0.05
    reference energy   = -16.8978
    reference variance = 0.165964
====================================================
  Execution time = 2.0777e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s036
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6898e+01
  VMC Evar = 3.0462e-01
  Total weights = 2.0000e+06
  Execution time = 1.8803e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.304651448554
                                         uncertainty =       0.007530850361

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.304651448554
                                         uncertainty =       0.007530850361

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000390268093
  error estimate for blocks of size 2^( 2) =       0.000406671109
  error estimate for blocks of size 2^( 3) =       0.000423954728
  error estimate for blocks of size 2^( 4) =       0.000438554766
  error estimate for blocks of size 2^( 5) =       0.000449349781
  error estimate for blocks of size 2^( 6) =       0.000456981290
  error estimate for blocks of size 2^( 7) =       0.000460361737

      target function =      -0.905738283003
              le_mean =     -16.898474418817
             les_mean =     285.863055899929
             stat err =       0.000451311894
             autocorr =       1.337295751546
   target nu stat err =       0.000451311894
   target dn stat err =       0.007744244564
      target stat err =       0.011424255303
              std dev =       0.551922430092
             le_variance =       0.304618368839

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.304651448554
                                         uncertainty =       0.007530850361

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.304651448554
                                         uncertainty =       0.007530850361

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000390268093
  error estimate for blocks of size 2^( 2) =       0.000406671109
  error estimate for blocks of size 2^( 3) =       0.000423954728
  error estimate for blocks of size 2^( 4) =       0.000438554766
  error estimate for blocks of size 2^( 5) =       0.000449349781
  error estimate for blocks of size 2^( 6) =       0.000456981290
  error estimate for blocks of size 2^( 7) =       0.000460361737

      target function =      -0.905738283003
              le_mean =     -16.898474418817
             les_mean =     285.863055899929
             stat err =       0.000451311894
             autocorr =       1.337295751546
   target nu stat err =       0.000451311894
   target dn stat err =       0.007744244564
      target stat err =       0.011424255303
              std dev =       0.551922430092
             le_variance =       0.304618368839

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.304651448554
                                         uncertainty =       0.007530850361

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.304651448554
                                         uncertainty =       0.007530850361

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000390268093
  error estimate for blocks of size 2^( 2) =       0.000406671109
  error estimate for blocks of size 2^( 3) =       0.000423954728
  error estimate for blocks of size 2^( 4) =       0.000438554766
  error estimate for blocks of size 2^( 5) =       0.000449349781
  error estimate for blocks of size 2^( 6) =       0.000456981290
  error estimate for blocks of size 2^( 7) =       0.000460361737

      target function =      -0.905738283003
              le_mean =     -16.898474418817
             les_mean =     285.863055899929
             stat err =       0.000451311894
             autocorr =       1.337295751546
   target nu stat err =       0.000451311894
   target dn stat err =       0.007744244564
      target stat err =       0.011424255303
              std dev =       0.551922430092
             le_variance =       0.304618368839

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.304651448554
                                         uncertainty =       0.007530850361

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.304651448554
                                         uncertainty =       0.007530850361

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000390268093
  error estimate for blocks of size 2^( 2) =       0.000406671109
  error estimate for blocks of size 2^( 3) =       0.000423954728
  error estimate for blocks of size 2^( 4) =       0.000438554766
  error estimate for blocks of size 2^( 5) =       0.000449349781
  error estimate for blocks of size 2^( 6) =       0.000456981290
  error estimate for blocks of size 2^( 7) =       0.000460361737

      target function =      -0.905738283003
              le_mean =     -16.898474418817
             les_mean =     285.863055899929
             stat err =       0.000451311894
             autocorr =       1.337295751546
   target nu stat err =       0.000451311894
   target dn stat err =       0.007744244564
      target stat err =       0.011424255303
              std dev =       0.551922430092
             le_variance =       0.304618368839


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.905738283003        initial  <--
     3.9062e+17     3.9062e+18             0.0000e+00        -0.905738283003
     1.5625e+18     1.5625e+19             0.0000e+00        -0.905738283003
     6.2500e+18     6.2500e+19             0.0000e+00        -0.905738283003

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 30.3104
  </log>
  <optVariables href="H2O.s036.opt.xml">
 uu_0                 2.517233e-01 1 1  ON 0
 uu_1                 1.009440e-01 1 1  ON 1
 uu_2                 1.617079e-02 1 1  ON 2
 uu_3                -3.223684e-02 1 1  ON 3
 uu_4                -6.387117e-02 1 1  ON 4
 uu_5                -8.576607e-02 1 1  ON 5
 uu_6                -1.001312e-01 1 1  ON 6
 uu_7                -1.065673e-01 1 1  ON 7
 uu_8                -9.668739e-02 1 1  ON 8
 uu_9                -6.389513e-02 1 1  ON 9
 ud_0                 3.492134e-01 1 1  ON 10
 ud_1                 1.235409e-01 1 1  ON 11
 ud_2                 2.392782e-02 1 1  ON 12
 ud_3                -3.019578e-02 1 1  ON 13
 ud_4                -6.975615e-02 1 1  ON 14
 ud_5                -9.484122e-02 1 1  ON 15
 ud_6                -1.085598e-01 1 1  ON 16
 ud_7                -1.109505e-01 1 1  ON 17
 ud_8                -9.792103e-02 1 1  ON 18
 ud_9                -6.281979e-02 1 1  ON 19
 eO_0                -5.692885e-01 1 1  ON 20
 eO_1                -3.060844e-01 1 1  ON 21
 eO_2                 4.730127e-02 1 1  ON 22
 eO_3                 2.840620e-01 1 1  ON 23
 eO_4                 3.913445e-01 1 1  ON 24
 eO_5                 3.212389e-01 1 1  ON 25
 eO_6                 1.205694e-01 1 1  ON 26
 eO_7                -7.888705e-02 1 1  ON 27
 eO_8                -1.549102e-01 1 1  ON 28
 eO_9                -6.122098e-02 1 1  ON 29
eH1_0                -2.277697e-01 1 1  ON 30
eH1_1                -1.106400e-01 1 1  ON 31
eH1_2                -6.162952e-02 1 1  ON 32
eH1_3                -2.530653e-02 1 1  ON 33
eH1_4                 4.247832e-03 1 1  ON 34
eH1_5                 2.367079e-02 1 1  ON 35
eH1_6                 6.569443e-02 1 1  ON 36
eH1_7                 1.154361e-01 1 1  ON 37
eH1_8                 1.435221e-01 1 1  ON 38
eH1_9                 7.467419e-02 1 1  ON 39
eH2_0                -2.307043e-01 1 1  ON 40
eH2_1                -1.139386e-01 1 1  ON 41
eH2_2                -6.444539e-02 1 1  ON 42
eH2_3                -2.722663e-02 1 1  ON 43
eH2_4                 1.073593e-03 1 1  ON 44
eH2_5                 2.532957e-02 1 1  ON 45
eH2_6                 7.564477e-02 1 1  ON 46
eH2_7                 1.260027e-01 1 1  ON 47
eH2_8                 1.609124e-01 1 1  ON 48
eH2_9                 6.417217e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.6685e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s037 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s037 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=37  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6904e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 37
    time step          = 0.05
    reference energy   = -16.8457
    reference variance = 0.218103
====================================================
  Execution time = 2.0637e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s037
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6898e+01
  VMC Evar = 3.0554e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.5095e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.305463792706
                                         uncertainty =       0.007967437771

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.305463792706
                                         uncertainty =       0.007967437771

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000390855230
  error estimate for blocks of size 2^( 2) =       0.000407614086
  error estimate for blocks of size 2^( 3) =       0.000424694978
  error estimate for blocks of size 2^( 4) =       0.000439521802
  error estimate for blocks of size 2^( 5) =       0.000450831674
  error estimate for blocks of size 2^( 6) =       0.000457344042
  error estimate for blocks of size 2^( 7) =       0.000462743318

      target function =      -0.904372794810
              le_mean =     -16.897875174533
             les_mean =     285.843720882355
             stat err =       0.000452610209
             autocorr =       1.340963131048
   target nu stat err =       0.000452610209
   target dn stat err =       0.008025392946
      target stat err =       0.011789294563
              std dev =       0.552752766646
             le_variance =       0.305535621035


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.689787517453e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 3.9062e+18, overlap shift 3.9062e+19 and omega -1.7456e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.904524282299       residual = 2.34e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.904524282299       residual = 1.48e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.904524282299       residual = 7.54e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.904524282299       residual = 3.40e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.904524282319       residual = 3.87e+01           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.904524282299       residual = 1.99e-04           smallest_sin_value = 1.00e+00
davidson iteration    6 stopping due to too large eigenvalue change
davidson solver did not converge after          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.9062e+18 is 1.138333e-22

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 1.5625e+19, overlap shift 1.5625e+20 and omega -1.7456e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.904524282299       residual = 2.34e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.904524282299       residual = 1.48e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.904524282299       residual = 7.54e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.904524282299       residual = 2.44e-03           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.904524282299       residual = 4.62e-04           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.904524282297       residual = 1.99e-04           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.904524282299       residual = 8.87e-05           smallest_sin_value = 1.00e+00
davidson iteration    7 stopping due to too large eigenvalue change
davidson solver did not converge after          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.5625e+19 is 3.387638e-23

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 6.2500e+19, overlap shift 6.2500e+20 and omega -1.7456e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.904524282299       residual = 2.34e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.904524282299       residual = 1.48e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.904524282299       residual = 2.34e-03           smallest_sin_value = 1.00e+00
davidson iteration    3 stopping due to too large eigenvalue change
davidson solver did not converge after          3 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 6.2500e+19 is 1.349811e-24

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               1.464690 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.6154e+01
  </log>
  <optVariables href="H2O.s037.opt.xml">
 uu_0                 2.517233e-01 1 1  ON 0
 uu_1                 1.009440e-01 1 1  ON 1
 uu_2                 1.617079e-02 1 1  ON 2
 uu_3                -3.223684e-02 1 1  ON 3
 uu_4                -6.387117e-02 1 1  ON 4
 uu_5                -8.576607e-02 1 1  ON 5
 uu_6                -1.001312e-01 1 1  ON 6
 uu_7                -1.065673e-01 1 1  ON 7
 uu_8                -9.668739e-02 1 1  ON 8
 uu_9                -6.389513e-02 1 1  ON 9
 ud_0                 3.492134e-01 1 1  ON 10
 ud_1                 1.235409e-01 1 1  ON 11
 ud_2                 2.392782e-02 1 1  ON 12
 ud_3                -3.019578e-02 1 1  ON 13
 ud_4                -6.975615e-02 1 1  ON 14
 ud_5                -9.484122e-02 1 1  ON 15
 ud_6                -1.085598e-01 1 1  ON 16
 ud_7                -1.109505e-01 1 1  ON 17
 ud_8                -9.792103e-02 1 1  ON 18
 ud_9                -6.281979e-02 1 1  ON 19
 eO_0                -5.692885e-01 1 1  ON 20
 eO_1                -3.060844e-01 1 1  ON 21
 eO_2                 4.730127e-02 1 1  ON 22
 eO_3                 2.840620e-01 1 1  ON 23
 eO_4                 3.913445e-01 1 1  ON 24
 eO_5                 3.212389e-01 1 1  ON 25
 eO_6                 1.205694e-01 1 1  ON 26
 eO_7                -7.888705e-02 1 1  ON 27
 eO_8                -1.549102e-01 1 1  ON 28
 eO_9                -6.122098e-02 1 1  ON 29
eH1_0                -2.277697e-01 1 1  ON 30
eH1_1                -1.106400e-01 1 1  ON 31
eH1_2                -6.162952e-02 1 1  ON 32
eH1_3                -2.530653e-02 1 1  ON 33
eH1_4                 4.247832e-03 1 1  ON 34
eH1_5                 2.367079e-02 1 1  ON 35
eH1_6                 6.569443e-02 1 1  ON 36
eH1_7                 1.154361e-01 1 1  ON 37
eH1_8                 1.435221e-01 1 1  ON 38
eH1_9                 7.467419e-02 1 1  ON 39
eH2_0                -2.307043e-01 1 1  ON 40
eH2_1                -1.139386e-01 1 1  ON 41
eH2_2                -6.444539e-02 1 1  ON 42
eH2_3                -2.722663e-02 1 1  ON 43
eH2_4                 1.073593e-03 1 1  ON 44
eH2_5                 2.532957e-02 1 1  ON 45
eH2_6                 7.564477e-02 1 1  ON 46
eH2_7                 1.260027e-01 1 1  ON 47
eH2_8                 1.609124e-01 1 1  ON 48
eH2_9                 6.417217e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 37
    time step          = 0.05
    reference energy   = -16.8743
    reference variance = 0.277635
====================================================
  Execution time = 2.0378e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s037
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6898e+01
  VMC Evar = 2.9284e-01
  Total weights = 2.0000e+06
  Execution time = 1.8781e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.292814884164
                                         uncertainty =       0.003864586836

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.292814884164
                                         uncertainty =       0.003864586836

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000382647192
  error estimate for blocks of size 2^( 2) =       0.000399902438
  error estimate for blocks of size 2^( 3) =       0.000417568609
  error estimate for blocks of size 2^( 4) =       0.000433153665
  error estimate for blocks of size 2^( 5) =       0.000445655442
  error estimate for blocks of size 2^( 6) =       0.000452762264
  error estimate for blocks of size 2^( 7) =       0.000455821414

      target function =      -0.923501659988
              le_mean =     -16.897788735736
             les_mean =     285.828101758941
             stat err =       0.000446848196
             autocorr =       1.363712924392
   target nu stat err =       0.000446848196
   target dn stat err =       0.003455595786
      target stat err =       0.005333008459
              std dev =       0.541144849184
             le_variance =       0.292837747798

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.292814884164
                                         uncertainty =       0.003864586836

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.292814884164
                                         uncertainty =       0.003864586836

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000382647192
  error estimate for blocks of size 2^( 2) =       0.000399902438
  error estimate for blocks of size 2^( 3) =       0.000417568609
  error estimate for blocks of size 2^( 4) =       0.000433153665
  error estimate for blocks of size 2^( 5) =       0.000445655442
  error estimate for blocks of size 2^( 6) =       0.000452762264
  error estimate for blocks of size 2^( 7) =       0.000455821414

      target function =      -0.923501659988
              le_mean =     -16.897788735736
             les_mean =     285.828101758941
             stat err =       0.000446848196
             autocorr =       1.363712924392
   target nu stat err =       0.000446848196
   target dn stat err =       0.003455595786
      target stat err =       0.005333008459
              std dev =       0.541144849184
             le_variance =       0.292837747798

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.292814884164
                                         uncertainty =       0.003864586836

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.292814884164
                                         uncertainty =       0.003864586836

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000382647192
  error estimate for blocks of size 2^( 2) =       0.000399902438
  error estimate for blocks of size 2^( 3) =       0.000417568609
  error estimate for blocks of size 2^( 4) =       0.000433153665
  error estimate for blocks of size 2^( 5) =       0.000445655442
  error estimate for blocks of size 2^( 6) =       0.000452762264
  error estimate for blocks of size 2^( 7) =       0.000455821414

      target function =      -0.923501659988
              le_mean =     -16.897788735736
             les_mean =     285.828101758941
             stat err =       0.000446848196
             autocorr =       1.363712924392
   target nu stat err =       0.000446848196
   target dn stat err =       0.003455595786
      target stat err =       0.005333008459
              std dev =       0.541144849184
             le_variance =       0.292837747798

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.292814884164
                                         uncertainty =       0.003864586836

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.292814884164
                                         uncertainty =       0.003864586836

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000382647192
  error estimate for blocks of size 2^( 2) =       0.000399902438
  error estimate for blocks of size 2^( 3) =       0.000417568609
  error estimate for blocks of size 2^( 4) =       0.000433153665
  error estimate for blocks of size 2^( 5) =       0.000445655442
  error estimate for blocks of size 2^( 6) =       0.000452762264
  error estimate for blocks of size 2^( 7) =       0.000455821414

      target function =      -0.923501659988
              le_mean =     -16.897788735736
             les_mean =     285.828101758941
             stat err =       0.000446848196
             autocorr =       1.363712924392
   target nu stat err =       0.000446848196
   target dn stat err =       0.003455595786
      target stat err =       0.005333008459
              std dev =       0.541144849184
             le_variance =       0.292837747798


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.923501659988        initial  <--
     3.9062e+18     3.9062e+19             1.1383e-22        -0.923501659988
     1.5625e+19     1.5625e+20             3.3876e-23        -0.923501659988
     6.2500e+19     6.2500e+20             1.3498e-24        -0.923501659988

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 29.8716
  </log>
  <optVariables href="H2O.s037.opt.xml">
 uu_0                 2.517233e-01 1 1  ON 0
 uu_1                 1.009440e-01 1 1  ON 1
 uu_2                 1.617079e-02 1 1  ON 2
 uu_3                -3.223684e-02 1 1  ON 3
 uu_4                -6.387117e-02 1 1  ON 4
 uu_5                -8.576607e-02 1 1  ON 5
 uu_6                -1.001312e-01 1 1  ON 6
 uu_7                -1.065673e-01 1 1  ON 7
 uu_8                -9.668739e-02 1 1  ON 8
 uu_9                -6.389513e-02 1 1  ON 9
 ud_0                 3.492134e-01 1 1  ON 10
 ud_1                 1.235409e-01 1 1  ON 11
 ud_2                 2.392782e-02 1 1  ON 12
 ud_3                -3.019578e-02 1 1  ON 13
 ud_4                -6.975615e-02 1 1  ON 14
 ud_5                -9.484122e-02 1 1  ON 15
 ud_6                -1.085598e-01 1 1  ON 16
 ud_7                -1.109505e-01 1 1  ON 17
 ud_8                -9.792103e-02 1 1  ON 18
 ud_9                -6.281979e-02 1 1  ON 19
 eO_0                -5.692885e-01 1 1  ON 20
 eO_1                -3.060844e-01 1 1  ON 21
 eO_2                 4.730127e-02 1 1  ON 22
 eO_3                 2.840620e-01 1 1  ON 23
 eO_4                 3.913445e-01 1 1  ON 24
 eO_5                 3.212389e-01 1 1  ON 25
 eO_6                 1.205694e-01 1 1  ON 26
 eO_7                -7.888705e-02 1 1  ON 27
 eO_8                -1.549102e-01 1 1  ON 28
 eO_9                -6.122098e-02 1 1  ON 29
eH1_0                -2.277697e-01 1 1  ON 30
eH1_1                -1.106400e-01 1 1  ON 31
eH1_2                -6.162952e-02 1 1  ON 32
eH1_3                -2.530653e-02 1 1  ON 33
eH1_4                 4.247832e-03 1 1  ON 34
eH1_5                 2.367079e-02 1 1  ON 35
eH1_6                 6.569443e-02 1 1  ON 36
eH1_7                 1.154361e-01 1 1  ON 37
eH1_8                 1.435221e-01 1 1  ON 38
eH1_9                 7.467419e-02 1 1  ON 39
eH2_0                -2.307043e-01 1 1  ON 40
eH2_1                -1.139386e-01 1 1  ON 41
eH2_2                -6.444539e-02 1 1  ON 42
eH2_3                -2.722663e-02 1 1  ON 43
eH2_4                 1.073593e-03 1 1  ON 44
eH2_5                 2.532957e-02 1 1  ON 45
eH2_6                 7.564477e-02 1 1  ON 46
eH2_7                 1.260027e-01 1 1  ON 47
eH2_8                 1.609124e-01 1 1  ON 48
eH2_9                 6.417217e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.6032e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s038 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s038 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=38  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6902e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 38
    time step          = 0.05
    reference energy   = -16.7896
    reference variance = 0.549133
====================================================
  Execution time = 2.2809e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s038
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6898e+01
  VMC Evar = 2.9513e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.5151e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.295080795361
                                         uncertainty =       0.003557674479

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.295080795361
                                         uncertainty =       0.003557674479

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000384139141
  error estimate for blocks of size 2^( 2) =       0.000400980960
  error estimate for blocks of size 2^( 3) =       0.000418470497
  error estimate for blocks of size 2^( 4) =       0.000435004901
  error estimate for blocks of size 2^( 5) =       0.000447056610
  error estimate for blocks of size 2^( 6) =       0.000454737393
  error estimate for blocks of size 2^( 7) =       0.000459597649

      target function =      -0.920016770828
              le_mean =     -16.897733161612
             les_mean =     285.828511612589
             stat err =       0.000449099138
             autocorr =       1.366807401748
   target nu stat err =       0.000449099138
   target dn stat err =       0.003417732607
      target stat err =       0.005236347612
              std dev =       0.543254782863
             le_variance =       0.295125759103


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.689773316161e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 3.9062e+19, overlap shift 3.9062e+20 and omega -1.7456e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.920045034132       residual = 2.61e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.920045034132       residual = 2.61e-03           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.9062e+19 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 1.5625e+20, overlap shift 1.5625e+21 and omega -1.7456e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.920045034132       residual = 2.61e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.920045034132       residual = 2.61e-03           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.5625e+20 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 6.2500e+20, overlap shift 6.2500e+21 and omega -1.7456e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.920045034132       residual = 2.61e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.920045034132       residual = 2.61e-03           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 6.2500e+20 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               1.465801 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.8330e+01
  </log>
  <optVariables href="H2O.s038.opt.xml">
 uu_0                 2.517233e-01 1 1  ON 0
 uu_1                 1.009440e-01 1 1  ON 1
 uu_2                 1.617079e-02 1 1  ON 2
 uu_3                -3.223684e-02 1 1  ON 3
 uu_4                -6.387117e-02 1 1  ON 4
 uu_5                -8.576607e-02 1 1  ON 5
 uu_6                -1.001312e-01 1 1  ON 6
 uu_7                -1.065673e-01 1 1  ON 7
 uu_8                -9.668739e-02 1 1  ON 8
 uu_9                -6.389513e-02 1 1  ON 9
 ud_0                 3.492134e-01 1 1  ON 10
 ud_1                 1.235409e-01 1 1  ON 11
 ud_2                 2.392782e-02 1 1  ON 12
 ud_3                -3.019578e-02 1 1  ON 13
 ud_4                -6.975615e-02 1 1  ON 14
 ud_5                -9.484122e-02 1 1  ON 15
 ud_6                -1.085598e-01 1 1  ON 16
 ud_7                -1.109505e-01 1 1  ON 17
 ud_8                -9.792103e-02 1 1  ON 18
 ud_9                -6.281979e-02 1 1  ON 19
 eO_0                -5.692885e-01 1 1  ON 20
 eO_1                -3.060844e-01 1 1  ON 21
 eO_2                 4.730127e-02 1 1  ON 22
 eO_3                 2.840620e-01 1 1  ON 23
 eO_4                 3.913445e-01 1 1  ON 24
 eO_5                 3.212389e-01 1 1  ON 25
 eO_6                 1.205694e-01 1 1  ON 26
 eO_7                -7.888705e-02 1 1  ON 27
 eO_8                -1.549102e-01 1 1  ON 28
 eO_9                -6.122098e-02 1 1  ON 29
eH1_0                -2.277697e-01 1 1  ON 30
eH1_1                -1.106400e-01 1 1  ON 31
eH1_2                -6.162952e-02 1 1  ON 32
eH1_3                -2.530653e-02 1 1  ON 33
eH1_4                 4.247832e-03 1 1  ON 34
eH1_5                 2.367079e-02 1 1  ON 35
eH1_6                 6.569443e-02 1 1  ON 36
eH1_7                 1.154361e-01 1 1  ON 37
eH1_8                 1.435221e-01 1 1  ON 38
eH1_9                 7.467419e-02 1 1  ON 39
eH2_0                -2.307043e-01 1 1  ON 40
eH2_1                -1.139386e-01 1 1  ON 41
eH2_2                -6.444539e-02 1 1  ON 42
eH2_3                -2.722663e-02 1 1  ON 43
eH2_4                 1.073593e-03 1 1  ON 44
eH2_5                 2.532957e-02 1 1  ON 45
eH2_6                 7.564477e-02 1 1  ON 46
eH2_7                 1.260027e-01 1 1  ON 47
eH2_8                 1.609124e-01 1 1  ON 48
eH2_9                 6.417217e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 38
    time step          = 0.05
    reference energy   = -16.9968
    reference variance = 0.371213
====================================================
  Execution time = 2.0445e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s038
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6898e+01
  VMC Evar = 2.9369e-01
  Total weights = 2.0000e+06
  Execution time = 1.8800e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.293607542340
                                         uncertainty =       0.002508617333

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.293607542340
                                         uncertainty =       0.002508617333

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000383206488
  error estimate for blocks of size 2^( 2) =       0.000400549205
  error estimate for blocks of size 2^( 3) =       0.000418057041
  error estimate for blocks of size 2^( 4) =       0.000433420485
  error estimate for blocks of size 2^( 5) =       0.000444167281
  error estimate for blocks of size 2^( 6) =       0.000451973554
  error estimate for blocks of size 2^( 7) =       0.000456012923

      target function =      -0.922216485600
              le_mean =     -16.897953053633
             les_mean =     285.834511680564
             stat err =       0.000446393561
             autocorr =       1.356969656998
   target nu stat err =       0.000446393561
   target dn stat err =       0.002521189805
      target stat err =       0.003913904772
              std dev =       0.541935812283
             le_variance =       0.293694424634

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.293607542340
                                         uncertainty =       0.002508617333

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.293607542340
                                         uncertainty =       0.002508617333

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000383206488
  error estimate for blocks of size 2^( 2) =       0.000400549205
  error estimate for blocks of size 2^( 3) =       0.000418057041
  error estimate for blocks of size 2^( 4) =       0.000433420485
  error estimate for blocks of size 2^( 5) =       0.000444167281
  error estimate for blocks of size 2^( 6) =       0.000451973554
  error estimate for blocks of size 2^( 7) =       0.000456012923

      target function =      -0.922216485600
              le_mean =     -16.897953053633
             les_mean =     285.834511680564
             stat err =       0.000446393561
             autocorr =       1.356969656998
   target nu stat err =       0.000446393561
   target dn stat err =       0.002521189805
      target stat err =       0.003913904772
              std dev =       0.541935812283
             le_variance =       0.293694424634

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.293607542340
                                         uncertainty =       0.002508617333

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.293607542340
                                         uncertainty =       0.002508617333

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000383206488
  error estimate for blocks of size 2^( 2) =       0.000400549205
  error estimate for blocks of size 2^( 3) =       0.000418057041
  error estimate for blocks of size 2^( 4) =       0.000433420485
  error estimate for blocks of size 2^( 5) =       0.000444167281
  error estimate for blocks of size 2^( 6) =       0.000451973554
  error estimate for blocks of size 2^( 7) =       0.000456012923

      target function =      -0.922216485600
              le_mean =     -16.897953053633
             les_mean =     285.834511680564
             stat err =       0.000446393561
             autocorr =       1.356969656998
   target nu stat err =       0.000446393561
   target dn stat err =       0.002521189805
      target stat err =       0.003913904772
              std dev =       0.541935812283
             le_variance =       0.293694424634

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.293607542340
                                         uncertainty =       0.002508617333

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.293607542340
                                         uncertainty =       0.002508617333

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000383206488
  error estimate for blocks of size 2^( 2) =       0.000400549205
  error estimate for blocks of size 2^( 3) =       0.000418057041
  error estimate for blocks of size 2^( 4) =       0.000433420485
  error estimate for blocks of size 2^( 5) =       0.000444167281
  error estimate for blocks of size 2^( 6) =       0.000451973554
  error estimate for blocks of size 2^( 7) =       0.000456012923

      target function =      -0.922216485600
              le_mean =     -16.897953053633
             les_mean =     285.834511680564
             stat err =       0.000446393561
             autocorr =       1.356969656998
   target nu stat err =       0.000446393561
   target dn stat err =       0.002521189805
      target stat err =       0.003913904772
              std dev =       0.541935812283
             le_variance =       0.293694424634


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.922216485600        initial  <--
     3.9062e+19     3.9062e+20             0.0000e+00        -0.922216485600
     1.5625e+20     1.5625e+21             0.0000e+00        -0.922216485600
     6.2500e+20     6.2500e+21             0.0000e+00        -0.922216485600

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 29.9602
  </log>
  <optVariables href="H2O.s038.opt.xml">
 uu_0                 2.517233e-01 1 1  ON 0
 uu_1                 1.009440e-01 1 1  ON 1
 uu_2                 1.617079e-02 1 1  ON 2
 uu_3                -3.223684e-02 1 1  ON 3
 uu_4                -6.387117e-02 1 1  ON 4
 uu_5                -8.576607e-02 1 1  ON 5
 uu_6                -1.001312e-01 1 1  ON 6
 uu_7                -1.065673e-01 1 1  ON 7
 uu_8                -9.668739e-02 1 1  ON 8
 uu_9                -6.389513e-02 1 1  ON 9
 ud_0                 3.492134e-01 1 1  ON 10
 ud_1                 1.235409e-01 1 1  ON 11
 ud_2                 2.392782e-02 1 1  ON 12
 ud_3                -3.019578e-02 1 1  ON 13
 ud_4                -6.975615e-02 1 1  ON 14
 ud_5                -9.484122e-02 1 1  ON 15
 ud_6                -1.085598e-01 1 1  ON 16
 ud_7                -1.109505e-01 1 1  ON 17
 ud_8                -9.792103e-02 1 1  ON 18
 ud_9                -6.281979e-02 1 1  ON 19
 eO_0                -5.692885e-01 1 1  ON 20
 eO_1                -3.060844e-01 1 1  ON 21
 eO_2                 4.730127e-02 1 1  ON 22
 eO_3                 2.840620e-01 1 1  ON 23
 eO_4                 3.913445e-01 1 1  ON 24
 eO_5                 3.212389e-01 1 1  ON 25
 eO_6                 1.205694e-01 1 1  ON 26
 eO_7                -7.888705e-02 1 1  ON 27
 eO_8                -1.549102e-01 1 1  ON 28
 eO_9                -6.122098e-02 1 1  ON 29
eH1_0                -2.277697e-01 1 1  ON 30
eH1_1                -1.106400e-01 1 1  ON 31
eH1_2                -6.162952e-02 1 1  ON 32
eH1_3                -2.530653e-02 1 1  ON 33
eH1_4                 4.247832e-03 1 1  ON 34
eH1_5                 2.367079e-02 1 1  ON 35
eH1_6                 6.569443e-02 1 1  ON 36
eH1_7                 1.154361e-01 1 1  ON 37
eH1_8                 1.435221e-01 1 1  ON 38
eH1_9                 7.467419e-02 1 1  ON 39
eH2_0                -2.307043e-01 1 1  ON 40
eH2_1                -1.139386e-01 1 1  ON 41
eH2_2                -6.444539e-02 1 1  ON 42
eH2_3                -2.722663e-02 1 1  ON 43
eH2_4                 1.073593e-03 1 1  ON 44
eH2_5                 2.532957e-02 1 1  ON 45
eH2_6                 7.564477e-02 1 1  ON 46
eH2_7                 1.260027e-01 1 1  ON 47
eH2_8                 1.609124e-01 1 1  ON 48
eH2_9                 6.417217e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.8296e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s039 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s039 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=39  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6902e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 39
    time step          = 0.05
    reference energy   = -16.8672
    reference variance = 0.234505
====================================================
  Execution time = 2.0717e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s039
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6898e+01
  VMC Evar = 2.9218e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.6657e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.292229264957
                                         uncertainty =       0.002230447986

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.292229264957
                                         uncertainty =       0.002230447986

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000382218410
  error estimate for blocks of size 2^( 2) =       0.000399530938
  error estimate for blocks of size 2^( 3) =       0.000417310279
  error estimate for blocks of size 2^( 4) =       0.000433218634
  error estimate for blocks of size 2^( 5) =       0.000446088209
  error estimate for blocks of size 2^( 6) =       0.000453133683
  error estimate for blocks of size 2^( 7) =       0.000456002857

      target function =      -0.924526775005
              le_mean =     -16.897877055376
             les_mean =     285.830430659019
             stat err =       0.000447110846
             autocorr =       1.368381536721
   target nu stat err =       0.000447110846
   target dn stat err =       0.002313551984
      target stat err =       0.003620958886
              std dev =       0.540538459788
             le_variance =       0.292181826510


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.689787705538e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 3.9062e+20, overlap shift 3.9062e+21 and omega -1.7456e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.924539651247       residual = 1.21e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.924539651247       residual = 3.20e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.924539651247       residual = 1.21e-03           smallest_sin_value = 1.00e+00
davidson iteration    3 stopping due to too large eigenvalue change
davidson solver did not converge after          3 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.9062e+20 is 1.622309e-25

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 1.5625e+21, overlap shift 1.5625e+22 and omega -1.7456e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.924539651247       residual = 1.21e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.924539651247       residual = 3.20e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.924539651247       residual = 1.21e-03           smallest_sin_value = 1.00e+00
davidson iteration    3: stopping due to imaginary component in cost function
davidson solver did not converge after          3 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.5625e+21 is 4.055772e-26

solving harmonic davidson linear method for identity shift 6.2500e+21, overlap shift 6.2500e+22 and omega -1.7456e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.924539651247       residual = 1.21e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.924539651247       residual = 3.20e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.924539651906       residual = 9.04e+03           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.924539625645       residual = 1.24e+05           smallest_sin_value = 1.00e+00
davidson iteration    4 stopping due to too large eigenvalue change
davidson solver did not converge after          4 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 6.2500e+21 is 1.013943e-26

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               1.467235 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.6389e+01
  </log>
  <optVariables href="H2O.s039.opt.xml">
 uu_0                 2.517233e-01 1 1  ON 0
 uu_1                 1.009440e-01 1 1  ON 1
 uu_2                 1.617079e-02 1 1  ON 2
 uu_3                -3.223684e-02 1 1  ON 3
 uu_4                -6.387117e-02 1 1  ON 4
 uu_5                -8.576607e-02 1 1  ON 5
 uu_6                -1.001312e-01 1 1  ON 6
 uu_7                -1.065673e-01 1 1  ON 7
 uu_8                -9.668739e-02 1 1  ON 8
 uu_9                -6.389513e-02 1 1  ON 9
 ud_0                 3.492134e-01 1 1  ON 10
 ud_1                 1.235409e-01 1 1  ON 11
 ud_2                 2.392782e-02 1 1  ON 12
 ud_3                -3.019578e-02 1 1  ON 13
 ud_4                -6.975615e-02 1 1  ON 14
 ud_5                -9.484122e-02 1 1  ON 15
 ud_6                -1.085598e-01 1 1  ON 16
 ud_7                -1.109505e-01 1 1  ON 17
 ud_8                -9.792103e-02 1 1  ON 18
 ud_9                -6.281979e-02 1 1  ON 19
 eO_0                -5.692885e-01 1 1  ON 20
 eO_1                -3.060844e-01 1 1  ON 21
 eO_2                 4.730127e-02 1 1  ON 22
 eO_3                 2.840620e-01 1 1  ON 23
 eO_4                 3.913445e-01 1 1  ON 24
 eO_5                 3.212389e-01 1 1  ON 25
 eO_6                 1.205694e-01 1 1  ON 26
 eO_7                -7.888705e-02 1 1  ON 27
 eO_8                -1.549102e-01 1 1  ON 28
 eO_9                -6.122098e-02 1 1  ON 29
eH1_0                -2.277697e-01 1 1  ON 30
eH1_1                -1.106400e-01 1 1  ON 31
eH1_2                -6.162952e-02 1 1  ON 32
eH1_3                -2.530653e-02 1 1  ON 33
eH1_4                 4.247832e-03 1 1  ON 34
eH1_5                 2.367079e-02 1 1  ON 35
eH1_6                 6.569443e-02 1 1  ON 36
eH1_7                 1.154361e-01 1 1  ON 37
eH1_8                 1.435221e-01 1 1  ON 38
eH1_9                 7.467419e-02 1 1  ON 39
eH2_0                -2.307043e-01 1 1  ON 40
eH2_1                -1.139386e-01 1 1  ON 41
eH2_2                -6.444539e-02 1 1  ON 42
eH2_3                -2.722663e-02 1 1  ON 43
eH2_4                 1.073593e-03 1 1  ON 44
eH2_5                 2.532957e-02 1 1  ON 45
eH2_6                 7.564477e-02 1 1  ON 46
eH2_7                 1.260027e-01 1 1  ON 47
eH2_8                 1.609124e-01 1 1  ON 48
eH2_9                 6.417217e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 39
    time step          = 0.05
    reference energy   = -16.8739
    reference variance = 0.253146
====================================================
  Execution time = 2.0302e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s039
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6898e+01
  VMC Evar = 2.9683e-01
  Total weights = 2.0000e+06
  Execution time = 1.8849e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.296411422099
                                         uncertainty =       0.002616641995

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.296411422099
                                         uncertainty =       0.002616641995

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000385243976
  error estimate for blocks of size 2^( 2) =       0.000402141746
  error estimate for blocks of size 2^( 3) =       0.000420084960
  error estimate for blocks of size 2^( 4) =       0.000435719355
  error estimate for blocks of size 2^( 5) =       0.000448064623
  error estimate for blocks of size 2^( 6) =       0.000458147586
  error estimate for blocks of size 2^( 7) =       0.000465225361

      target function =      -0.917476925831
              le_mean =     -16.898260463834
             les_mean =     285.848032397241
             stat err =       0.000451789231
             autocorr =       1.375308215175
   target nu stat err =       0.000451789231
   target dn stat err =       0.002671864889
      target stat err =       0.004101825397
              std dev =       0.544817255663
             le_variance =       0.296825842068

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.296411422099
                                         uncertainty =       0.002616641995

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.296411422099
                                         uncertainty =       0.002616641995

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000385243976
  error estimate for blocks of size 2^( 2) =       0.000402141746
  error estimate for blocks of size 2^( 3) =       0.000420084960
  error estimate for blocks of size 2^( 4) =       0.000435719355
  error estimate for blocks of size 2^( 5) =       0.000448064623
  error estimate for blocks of size 2^( 6) =       0.000458147586
  error estimate for blocks of size 2^( 7) =       0.000465225361

      target function =      -0.917476925831
              le_mean =     -16.898260463834
             les_mean =     285.848032397241
             stat err =       0.000451789231
             autocorr =       1.375308215175
   target nu stat err =       0.000451789231
   target dn stat err =       0.002671864889
      target stat err =       0.004101825397
              std dev =       0.544817255663
             le_variance =       0.296825842068

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.296411422099
                                         uncertainty =       0.002616641995

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.296411422099
                                         uncertainty =       0.002616641995

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000385243976
  error estimate for blocks of size 2^( 2) =       0.000402141746
  error estimate for blocks of size 2^( 3) =       0.000420084960
  error estimate for blocks of size 2^( 4) =       0.000435719355
  error estimate for blocks of size 2^( 5) =       0.000448064623
  error estimate for blocks of size 2^( 6) =       0.000458147586
  error estimate for blocks of size 2^( 7) =       0.000465225361

      target function =      -0.917476925831
              le_mean =     -16.898260463834
             les_mean =     285.848032397241
             stat err =       0.000451789231
             autocorr =       1.375308215175
   target nu stat err =       0.000451789231
   target dn stat err =       0.002671864889
      target stat err =       0.004101825397
              std dev =       0.544817255663
             le_variance =       0.296825842068

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.296411422099
                                         uncertainty =       0.002616641995

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.296411422099
                                         uncertainty =       0.002616641995

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000385243976
  error estimate for blocks of size 2^( 2) =       0.000402141746
  error estimate for blocks of size 2^( 3) =       0.000420084960
  error estimate for blocks of size 2^( 4) =       0.000435719355
  error estimate for blocks of size 2^( 5) =       0.000448064623
  error estimate for blocks of size 2^( 6) =       0.000458147586
  error estimate for blocks of size 2^( 7) =       0.000465225361

      target function =      -0.917476925831
              le_mean =     -16.898260463834
             les_mean =     285.848032397241
             stat err =       0.000451789231
             autocorr =       1.375308215175
   target nu stat err =       0.000451789231
   target dn stat err =       0.002671864889
      target stat err =       0.004101825397
              std dev =       0.544817255663
             le_variance =       0.296825842068


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.917476925831        initial  <--
     3.9062e+20     3.9062e+21             1.6223e-25        -0.917476925831
     1.5625e+21     1.5625e+22             4.0558e-26        -0.917476925831
     6.2500e+21     6.2500e+22             1.0139e-26        -0.917476925831

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 29.8148
  </log>
  <optVariables href="H2O.s039.opt.xml">
 uu_0                 2.517233e-01 1 1  ON 0
 uu_1                 1.009440e-01 1 1  ON 1
 uu_2                 1.617079e-02 1 1  ON 2
 uu_3                -3.223684e-02 1 1  ON 3
 uu_4                -6.387117e-02 1 1  ON 4
 uu_5                -8.576607e-02 1 1  ON 5
 uu_6                -1.001312e-01 1 1  ON 6
 uu_7                -1.065673e-01 1 1  ON 7
 uu_8                -9.668739e-02 1 1  ON 8
 uu_9                -6.389513e-02 1 1  ON 9
 ud_0                 3.492134e-01 1 1  ON 10
 ud_1                 1.235409e-01 1 1  ON 11
 ud_2                 2.392782e-02 1 1  ON 12
 ud_3                -3.019578e-02 1 1  ON 13
 ud_4                -6.975615e-02 1 1  ON 14
 ud_5                -9.484122e-02 1 1  ON 15
 ud_6                -1.085598e-01 1 1  ON 16
 ud_7                -1.109505e-01 1 1  ON 17
 ud_8                -9.792103e-02 1 1  ON 18
 ud_9                -6.281979e-02 1 1  ON 19
 eO_0                -5.692885e-01 1 1  ON 20
 eO_1                -3.060844e-01 1 1  ON 21
 eO_2                 4.730127e-02 1 1  ON 22
 eO_3                 2.840620e-01 1 1  ON 23
 eO_4                 3.913445e-01 1 1  ON 24
 eO_5                 3.212389e-01 1 1  ON 25
 eO_6                 1.205694e-01 1 1  ON 26
 eO_7                -7.888705e-02 1 1  ON 27
 eO_8                -1.549102e-01 1 1  ON 28
 eO_9                -6.122098e-02 1 1  ON 29
eH1_0                -2.277697e-01 1 1  ON 30
eH1_1                -1.106400e-01 1 1  ON 31
eH1_2                -6.162952e-02 1 1  ON 32
eH1_3                -2.530653e-02 1 1  ON 33
eH1_4                 4.247832e-03 1 1  ON 34
eH1_5                 2.367079e-02 1 1  ON 35
eH1_6                 6.569443e-02 1 1  ON 36
eH1_7                 1.154361e-01 1 1  ON 37
eH1_8                 1.435221e-01 1 1  ON 38
eH1_9                 7.467419e-02 1 1  ON 39
eH2_0                -2.307043e-01 1 1  ON 40
eH2_1                -1.139386e-01 1 1  ON 41
eH2_2                -6.444539e-02 1 1  ON 42
eH2_3                -2.722663e-02 1 1  ON 43
eH2_4                 1.073593e-03 1 1  ON 44
eH2_5                 2.532957e-02 1 1  ON 45
eH2_6                 7.564477e-02 1 1  ON 46
eH2_7                 1.260027e-01 1 1  ON 47
eH2_8                 1.609124e-01 1 1  ON 48
eH2_9                 6.417217e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.6210e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s040 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s040 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=40  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6901e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 40
    time step          = 0.05
    reference energy   = -16.8704
    reference variance = 0.193293
====================================================
  Execution time = 2.0850e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s040
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6898e+01
  VMC Evar = 2.9029e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.5214e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.290301833053
                                         uncertainty =       0.002480757920

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.290301833053
                                         uncertainty =       0.002480757920

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000380980879
  error estimate for blocks of size 2^( 2) =       0.000398387834
  error estimate for blocks of size 2^( 3) =       0.000416363325
  error estimate for blocks of size 2^( 4) =       0.000432774475
  error estimate for blocks of size 2^( 5) =       0.000445490688
  error estimate for blocks of size 2^( 6) =       0.000453312280
  error estimate for blocks of size 2^( 7) =       0.000459593777

      target function =      -0.927411736972
              le_mean =     -16.897561322670
             les_mean =     285.817871369066
             stat err =       0.000447792805
             autocorr =       1.381490372772
   target nu stat err =       0.000447792805
   target dn stat err =       0.002287780925
      target stat err =       0.003602428787
              std dev =       0.538788326539
             le_variance =       0.290292860815


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.689756132267e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 3.9062e+21, overlap shift 3.9062e+22 and omega -1.7456e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.927424198739       residual = 9.86e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.927424198739       residual = 2.90e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.927424198739       residual = 9.86e-04           smallest_sin_value = 1.00e+00
davidson iteration    3 stopping due to too large eigenvalue change
davidson solver did not converge after          3 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.9062e+21 is 1.778509e-26

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 1.5625e+22, overlap shift 1.5625e+23 and omega -1.7456e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.927424198739       residual = 9.86e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.927424198739       residual = 2.90e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.927424198739       residual = 9.86e-04           smallest_sin_value = 1.00e+00
davidson iteration    3 stopping due to too large eigenvalue change
davidson solver did not converge after          3 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.5625e+22 is 4.446273e-27

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 6.2500e+22, overlap shift 6.2500e+23 and omega -1.7456e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.927424198739       residual = 9.86e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.927424198739       residual = 2.90e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.927424198739       residual = 9.86e-04           smallest_sin_value = 1.00e+00
davidson iteration    3 stopping due to too large eigenvalue change
davidson solver did not converge after          3 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 6.2500e+22 is 1.111568e-27

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               1.468590 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.6378e+01
  </log>
  <optVariables href="H2O.s040.opt.xml">
 uu_0                 2.517233e-01 1 1  ON 0
 uu_1                 1.009440e-01 1 1  ON 1
 uu_2                 1.617079e-02 1 1  ON 2
 uu_3                -3.223684e-02 1 1  ON 3
 uu_4                -6.387117e-02 1 1  ON 4
 uu_5                -8.576607e-02 1 1  ON 5
 uu_6                -1.001312e-01 1 1  ON 6
 uu_7                -1.065673e-01 1 1  ON 7
 uu_8                -9.668739e-02 1 1  ON 8
 uu_9                -6.389513e-02 1 1  ON 9
 ud_0                 3.492134e-01 1 1  ON 10
 ud_1                 1.235409e-01 1 1  ON 11
 ud_2                 2.392782e-02 1 1  ON 12
 ud_3                -3.019578e-02 1 1  ON 13
 ud_4                -6.975615e-02 1 1  ON 14
 ud_5                -9.484122e-02 1 1  ON 15
 ud_6                -1.085598e-01 1 1  ON 16
 ud_7                -1.109505e-01 1 1  ON 17
 ud_8                -9.792103e-02 1 1  ON 18
 ud_9                -6.281979e-02 1 1  ON 19
 eO_0                -5.692885e-01 1 1  ON 20
 eO_1                -3.060844e-01 1 1  ON 21
 eO_2                 4.730127e-02 1 1  ON 22
 eO_3                 2.840620e-01 1 1  ON 23
 eO_4                 3.913445e-01 1 1  ON 24
 eO_5                 3.212389e-01 1 1  ON 25
 eO_6                 1.205694e-01 1 1  ON 26
 eO_7                -7.888705e-02 1 1  ON 27
 eO_8                -1.549102e-01 1 1  ON 28
 eO_9                -6.122098e-02 1 1  ON 29
eH1_0                -2.277697e-01 1 1  ON 30
eH1_1                -1.106400e-01 1 1  ON 31
eH1_2                -6.162952e-02 1 1  ON 32
eH1_3                -2.530653e-02 1 1  ON 33
eH1_4                 4.247832e-03 1 1  ON 34
eH1_5                 2.367079e-02 1 1  ON 35
eH1_6                 6.569443e-02 1 1  ON 36
eH1_7                 1.154361e-01 1 1  ON 37
eH1_8                 1.435221e-01 1 1  ON 38
eH1_9                 7.467419e-02 1 1  ON 39
eH2_0                -2.307043e-01 1 1  ON 40
eH2_1                -1.139386e-01 1 1  ON 41
eH2_2                -6.444539e-02 1 1  ON 42
eH2_3                -2.722663e-02 1 1  ON 43
eH2_4                 1.073593e-03 1 1  ON 44
eH2_5                 2.532957e-02 1 1  ON 45
eH2_6                 7.564477e-02 1 1  ON 46
eH2_7                 1.260027e-01 1 1  ON 47
eH2_8                 1.609124e-01 1 1  ON 48
eH2_9                 6.417217e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 40
    time step          = 0.05
    reference energy   = -16.8899
    reference variance = 0.221574
====================================================
  Execution time = 2.0815e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s040
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6899e+01
  VMC Evar = 2.9232e-01
  Total weights = 2.0000e+06
  Execution time = 1.8798e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.292348121329
                                         uncertainty =       0.004618421165

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.292348121329
                                         uncertainty =       0.004618421165

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000382307002
  error estimate for blocks of size 2^( 2) =       0.000399516799
  error estimate for blocks of size 2^( 3) =       0.000416933177
  error estimate for blocks of size 2^( 4) =       0.000432190693
  error estimate for blocks of size 2^( 5) =       0.000443306864
  error estimate for blocks of size 2^( 6) =       0.000450346768
  error estimate for blocks of size 2^( 7) =       0.000455403884

      target function =      -0.924333012648
              le_mean =     -16.898978606573
             les_mean =     285.867795087498
             stat err =       0.000445312052
             autocorr =       1.356764254864
   target nu stat err =       0.000445312052
   target dn stat err =       0.004655225201
      target stat err =       0.007181371416
              std dev =       0.540663747864
             le_variance =       0.292317288254

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.292348121329
                                         uncertainty =       0.004618421165

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.292348121329
                                         uncertainty =       0.004618421165

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000382307002
  error estimate for blocks of size 2^( 2) =       0.000399516799
  error estimate for blocks of size 2^( 3) =       0.000416933177
  error estimate for blocks of size 2^( 4) =       0.000432190693
  error estimate for blocks of size 2^( 5) =       0.000443306864
  error estimate for blocks of size 2^( 6) =       0.000450346768
  error estimate for blocks of size 2^( 7) =       0.000455403884

      target function =      -0.924333012648
              le_mean =     -16.898978606573
             les_mean =     285.867795087498
             stat err =       0.000445312052
             autocorr =       1.356764254864
   target nu stat err =       0.000445312052
   target dn stat err =       0.004655225201
      target stat err =       0.007181371416
              std dev =       0.540663747864
             le_variance =       0.292317288254

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.292348121329
                                         uncertainty =       0.004618421165

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.292348121329
                                         uncertainty =       0.004618421165

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000382307002
  error estimate for blocks of size 2^( 2) =       0.000399516799
  error estimate for blocks of size 2^( 3) =       0.000416933177
  error estimate for blocks of size 2^( 4) =       0.000432190693
  error estimate for blocks of size 2^( 5) =       0.000443306864
  error estimate for blocks of size 2^( 6) =       0.000450346768
  error estimate for blocks of size 2^( 7) =       0.000455403884

      target function =      -0.924333012648
              le_mean =     -16.898978606573
             les_mean =     285.867795087498
             stat err =       0.000445312052
             autocorr =       1.356764254864
   target nu stat err =       0.000445312052
   target dn stat err =       0.004655225201
      target stat err =       0.007181371416
              std dev =       0.540663747864
             le_variance =       0.292317288254

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.292348121329
                                         uncertainty =       0.004618421165

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.292348121329
                                         uncertainty =       0.004618421165

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000382307002
  error estimate for blocks of size 2^( 2) =       0.000399516799
  error estimate for blocks of size 2^( 3) =       0.000416933177
  error estimate for blocks of size 2^( 4) =       0.000432190693
  error estimate for blocks of size 2^( 5) =       0.000443306864
  error estimate for blocks of size 2^( 6) =       0.000450346768
  error estimate for blocks of size 2^( 7) =       0.000455403884

      target function =      -0.924333012648
              le_mean =     -16.898978606573
             les_mean =     285.867795087498
             stat err =       0.000445312052
             autocorr =       1.356764254864
   target nu stat err =       0.000445312052
   target dn stat err =       0.004655225201
      target stat err =       0.007181371416
              std dev =       0.540663747864
             le_variance =       0.292317288254


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.924333012648        initial  <--
     3.9062e+21     3.9062e+22             1.7785e-26        -0.924333012648
     1.5625e+22     1.5625e+23             4.4463e-27        -0.924333012648
     6.2500e+22     6.2500e+23             1.1116e-27        -0.924333012648

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 30.3469
  </log>
  <optVariables href="H2O.s040.opt.xml">
 uu_0                 2.517233e-01 1 1  ON 0
 uu_1                 1.009440e-01 1 1  ON 1
 uu_2                 1.617079e-02 1 1  ON 2
 uu_3                -3.223684e-02 1 1  ON 3
 uu_4                -6.387117e-02 1 1  ON 4
 uu_5                -8.576607e-02 1 1  ON 5
 uu_6                -1.001312e-01 1 1  ON 6
 uu_7                -1.065673e-01 1 1  ON 7
 uu_8                -9.668739e-02 1 1  ON 8
 uu_9                -6.389513e-02 1 1  ON 9
 ud_0                 3.492134e-01 1 1  ON 10
 ud_1                 1.235409e-01 1 1  ON 11
 ud_2                 2.392782e-02 1 1  ON 12
 ud_3                -3.019578e-02 1 1  ON 13
 ud_4                -6.975615e-02 1 1  ON 14
 ud_5                -9.484122e-02 1 1  ON 15
 ud_6                -1.085598e-01 1 1  ON 16
 ud_7                -1.109505e-01 1 1  ON 17
 ud_8                -9.792103e-02 1 1  ON 18
 ud_9                -6.281979e-02 1 1  ON 19
 eO_0                -5.692885e-01 1 1  ON 20
 eO_1                -3.060844e-01 1 1  ON 21
 eO_2                 4.730127e-02 1 1  ON 22
 eO_3                 2.840620e-01 1 1  ON 23
 eO_4                 3.913445e-01 1 1  ON 24
 eO_5                 3.212389e-01 1 1  ON 25
 eO_6                 1.205694e-01 1 1  ON 26
 eO_7                -7.888705e-02 1 1  ON 27
 eO_8                -1.549102e-01 1 1  ON 28
 eO_9                -6.122098e-02 1 1  ON 29
eH1_0                -2.277697e-01 1 1  ON 30
eH1_1                -1.106400e-01 1 1  ON 31
eH1_2                -6.162952e-02 1 1  ON 32
eH1_3                -2.530653e-02 1 1  ON 33
eH1_4                 4.247832e-03 1 1  ON 34
eH1_5                 2.367079e-02 1 1  ON 35
eH1_6                 6.569443e-02 1 1  ON 36
eH1_7                 1.154361e-01 1 1  ON 37
eH1_8                 1.435221e-01 1 1  ON 38
eH1_9                 7.467419e-02 1 1  ON 39
eH2_0                -2.307043e-01 1 1  ON 40
eH2_1                -1.139386e-01 1 1  ON 41
eH2_2                -6.444539e-02 1 1  ON 42
eH2_3                -2.722663e-02 1 1  ON 43
eH2_4                 1.073593e-03 1 1  ON 44
eH2_5                 2.532957e-02 1 1  ON 45
eH2_6                 7.564477e-02 1 1  ON 46
eH2_7                 1.260027e-01 1 1  ON 47
eH2_8                 1.609124e-01 1 1  ON 48
eH2_9                 6.417217e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.6731e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s041 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s041 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=41  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6901e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 41
    time step          = 0.05
    reference energy   = -16.8562
    reference variance = 0.340935
====================================================
  Execution time = 2.2909e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s041
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6897e+01
  VMC Evar = 3.0082e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.5502e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.300861036978
                                         uncertainty =       0.003988279376

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.300861036978
                                         uncertainty =       0.003988279376

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000387824225
  error estimate for blocks of size 2^( 2) =       0.000405190298
  error estimate for blocks of size 2^( 3) =       0.000423500182
  error estimate for blocks of size 2^( 4) =       0.000440129001
  error estimate for blocks of size 2^( 5) =       0.000453550443
  error estimate for blocks of size 2^( 6) =       0.000463128422
  error estimate for blocks of size 2^( 7) =       0.000470187059

      target function =      -0.911435290828
              le_mean =     -16.897264907681
             les_mean =     285.818376468989
             stat err =       0.000456748731
             autocorr =       1.387026736998
   target nu stat err =       0.000456748731
   target dn stat err =       0.004404666663
      target stat err =       0.006593499171
              std dev =       0.548466278860
             le_variance =       0.300815259046


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.689726490768e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 3.9062e+22, overlap shift 3.9062e+23 and omega -1.7456e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.911481974537       residual = 2.51e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.911481974537       residual = 2.51e-03           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.9062e+22 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 1.5625e+23, overlap shift 1.5625e+24 and omega -1.7456e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.911481974537       residual = 2.51e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.911481974537       residual = 2.51e-03           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.5625e+23 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 6.2500e+23, overlap shift 6.2500e+24 and omega -1.7456e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.911481974537       residual = 2.51e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.911481974537       residual = 2.51e-03           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 6.2500e+23 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               1.469691 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.8466e+01
  </log>
  <optVariables href="H2O.s041.opt.xml">
 uu_0                 2.517233e-01 1 1  ON 0
 uu_1                 1.009440e-01 1 1  ON 1
 uu_2                 1.617079e-02 1 1  ON 2
 uu_3                -3.223684e-02 1 1  ON 3
 uu_4                -6.387117e-02 1 1  ON 4
 uu_5                -8.576607e-02 1 1  ON 5
 uu_6                -1.001312e-01 1 1  ON 6
 uu_7                -1.065673e-01 1 1  ON 7
 uu_8                -9.668739e-02 1 1  ON 8
 uu_9                -6.389513e-02 1 1  ON 9
 ud_0                 3.492134e-01 1 1  ON 10
 ud_1                 1.235409e-01 1 1  ON 11
 ud_2                 2.392782e-02 1 1  ON 12
 ud_3                -3.019578e-02 1 1  ON 13
 ud_4                -6.975615e-02 1 1  ON 14
 ud_5                -9.484122e-02 1 1  ON 15
 ud_6                -1.085598e-01 1 1  ON 16
 ud_7                -1.109505e-01 1 1  ON 17
 ud_8                -9.792103e-02 1 1  ON 18
 ud_9                -6.281979e-02 1 1  ON 19
 eO_0                -5.692885e-01 1 1  ON 20
 eO_1                -3.060844e-01 1 1  ON 21
 eO_2                 4.730127e-02 1 1  ON 22
 eO_3                 2.840620e-01 1 1  ON 23
 eO_4                 3.913445e-01 1 1  ON 24
 eO_5                 3.212389e-01 1 1  ON 25
 eO_6                 1.205694e-01 1 1  ON 26
 eO_7                -7.888705e-02 1 1  ON 27
 eO_8                -1.549102e-01 1 1  ON 28
 eO_9                -6.122098e-02 1 1  ON 29
eH1_0                -2.277697e-01 1 1  ON 30
eH1_1                -1.106400e-01 1 1  ON 31
eH1_2                -6.162952e-02 1 1  ON 32
eH1_3                -2.530653e-02 1 1  ON 33
eH1_4                 4.247832e-03 1 1  ON 34
eH1_5                 2.367079e-02 1 1  ON 35
eH1_6                 6.569443e-02 1 1  ON 36
eH1_7                 1.154361e-01 1 1  ON 37
eH1_8                 1.435221e-01 1 1  ON 38
eH1_9                 7.467419e-02 1 1  ON 39
eH2_0                -2.307043e-01 1 1  ON 40
eH2_1                -1.139386e-01 1 1  ON 41
eH2_2                -6.444539e-02 1 1  ON 42
eH2_3                -2.722663e-02 1 1  ON 43
eH2_4                 1.073593e-03 1 1  ON 44
eH2_5                 2.532957e-02 1 1  ON 45
eH2_6                 7.564477e-02 1 1  ON 46
eH2_7                 1.260027e-01 1 1  ON 47
eH2_8                 1.609124e-01 1 1  ON 48
eH2_9                 6.417217e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 41
    time step          = 0.05
    reference energy   = -16.893
    reference variance = 0.219224
====================================================
  Execution time = 2.0750e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s041
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6898e+01
  VMC Evar = 2.9093e-01
  Total weights = 2.0000e+06
  Execution time = 1.8756e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.290854530710
                                         uncertainty =       0.002383601590

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.290854530710
                                         uncertainty =       0.002383601590

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000381398171
  error estimate for blocks of size 2^( 2) =       0.000398550695
  error estimate for blocks of size 2^( 3) =       0.000415726709
  error estimate for blocks of size 2^( 4) =       0.000431425258
  error estimate for blocks of size 2^( 5) =       0.000443132826
  error estimate for blocks of size 2^( 6) =       0.000449690306
  error estimate for blocks of size 2^( 7) =       0.000453579698

      target function =      -0.926466769263
              le_mean =     -16.898252721077
             les_mean =     285.841874010014
             stat err =       0.000444457022
             autocorr =       1.358008009126
   target nu stat err =       0.000444457022
   target dn stat err =       0.002625830989
      target stat err =       0.004109311634
              std dev =       0.539378466479
             le_variance =       0.290929130101

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.290854530710
                                         uncertainty =       0.002383601590

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.290854530710
                                         uncertainty =       0.002383601590

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000381398171
  error estimate for blocks of size 2^( 2) =       0.000398550695
  error estimate for blocks of size 2^( 3) =       0.000415726709
  error estimate for blocks of size 2^( 4) =       0.000431425258
  error estimate for blocks of size 2^( 5) =       0.000443132826
  error estimate for blocks of size 2^( 6) =       0.000449690306
  error estimate for blocks of size 2^( 7) =       0.000453579698

      target function =      -0.926466769263
              le_mean =     -16.898252721077
             les_mean =     285.841874010014
             stat err =       0.000444457022
             autocorr =       1.358008009126
   target nu stat err =       0.000444457022
   target dn stat err =       0.002625830989
      target stat err =       0.004109311634
              std dev =       0.539378466479
             le_variance =       0.290929130101

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.290854530710
                                         uncertainty =       0.002383601590

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.290854530710
                                         uncertainty =       0.002383601590

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000381398171
  error estimate for blocks of size 2^( 2) =       0.000398550695
  error estimate for blocks of size 2^( 3) =       0.000415726709
  error estimate for blocks of size 2^( 4) =       0.000431425258
  error estimate for blocks of size 2^( 5) =       0.000443132826
  error estimate for blocks of size 2^( 6) =       0.000449690306
  error estimate for blocks of size 2^( 7) =       0.000453579698

      target function =      -0.926466769263
              le_mean =     -16.898252721077
             les_mean =     285.841874010014
             stat err =       0.000444457022
             autocorr =       1.358008009126
   target nu stat err =       0.000444457022
   target dn stat err =       0.002625830989
      target stat err =       0.004109311634
              std dev =       0.539378466479
             le_variance =       0.290929130101

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.290854530710
                                         uncertainty =       0.002383601590

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.290854530710
                                         uncertainty =       0.002383601590

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000381398171
  error estimate for blocks of size 2^( 2) =       0.000398550695
  error estimate for blocks of size 2^( 3) =       0.000415726709
  error estimate for blocks of size 2^( 4) =       0.000431425258
  error estimate for blocks of size 2^( 5) =       0.000443132826
  error estimate for blocks of size 2^( 6) =       0.000449690306
  error estimate for blocks of size 2^( 7) =       0.000453579698

      target function =      -0.926466769263
              le_mean =     -16.898252721077
             les_mean =     285.841874010014
             stat err =       0.000444457022
             autocorr =       1.358008009126
   target nu stat err =       0.000444457022
   target dn stat err =       0.002625830989
      target stat err =       0.004109311634
              std dev =       0.539378466479
             le_variance =       0.290929130101


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.926466769263        initial  <--
     3.9062e+22     3.9062e+23             0.0000e+00        -0.926466769263
     1.5625e+23     1.5625e+24             0.0000e+00        -0.926466769263
     6.2500e+23     6.2500e+24             0.0000e+00        -0.926466769263

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 30.2255
  </log>
  <optVariables href="H2O.s041.opt.xml">
 uu_0                 2.517233e-01 1 1  ON 0
 uu_1                 1.009440e-01 1 1  ON 1
 uu_2                 1.617079e-02 1 1  ON 2
 uu_3                -3.223684e-02 1 1  ON 3
 uu_4                -6.387117e-02 1 1  ON 4
 uu_5                -8.576607e-02 1 1  ON 5
 uu_6                -1.001312e-01 1 1  ON 6
 uu_7                -1.065673e-01 1 1  ON 7
 uu_8                -9.668739e-02 1 1  ON 8
 uu_9                -6.389513e-02 1 1  ON 9
 ud_0                 3.492134e-01 1 1  ON 10
 ud_1                 1.235409e-01 1 1  ON 11
 ud_2                 2.392782e-02 1 1  ON 12
 ud_3                -3.019578e-02 1 1  ON 13
 ud_4                -6.975615e-02 1 1  ON 14
 ud_5                -9.484122e-02 1 1  ON 15
 ud_6                -1.085598e-01 1 1  ON 16
 ud_7                -1.109505e-01 1 1  ON 17
 ud_8                -9.792103e-02 1 1  ON 18
 ud_9                -6.281979e-02 1 1  ON 19
 eO_0                -5.692885e-01 1 1  ON 20
 eO_1                -3.060844e-01 1 1  ON 21
 eO_2                 4.730127e-02 1 1  ON 22
 eO_3                 2.840620e-01 1 1  ON 23
 eO_4                 3.913445e-01 1 1  ON 24
 eO_5                 3.212389e-01 1 1  ON 25
 eO_6                 1.205694e-01 1 1  ON 26
 eO_7                -7.888705e-02 1 1  ON 27
 eO_8                -1.549102e-01 1 1  ON 28
 eO_9                -6.122098e-02 1 1  ON 29
eH1_0                -2.277697e-01 1 1  ON 30
eH1_1                -1.106400e-01 1 1  ON 31
eH1_2                -6.162952e-02 1 1  ON 32
eH1_3                -2.530653e-02 1 1  ON 33
eH1_4                 4.247832e-03 1 1  ON 34
eH1_5                 2.367079e-02 1 1  ON 35
eH1_6                 6.569443e-02 1 1  ON 36
eH1_7                 1.154361e-01 1 1  ON 37
eH1_8                 1.435221e-01 1 1  ON 38
eH1_9                 7.467419e-02 1 1  ON 39
eH2_0                -2.307043e-01 1 1  ON 40
eH2_1                -1.139386e-01 1 1  ON 41
eH2_2                -6.444539e-02 1 1  ON 42
eH2_3                -2.722663e-02 1 1  ON 43
eH2_4                 1.073593e-03 1 1  ON 44
eH2_5                 2.532957e-02 1 1  ON 45
eH2_6                 7.564477e-02 1 1  ON 46
eH2_7                 1.260027e-01 1 1  ON 47
eH2_8                 1.609124e-01 1 1  ON 48
eH2_9                 6.417217e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.8708e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s042 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s042 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=42  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6900e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 42
    time step          = 0.05
    reference energy   = -16.9222
    reference variance = 0.160103
====================================================
  Execution time = 2.0907e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s042
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6898e+01
  VMC Evar = 2.9452e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.5605e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.294591327734
                                         uncertainty =       0.003231078308

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.294591327734
                                         uncertainty =       0.003231078308

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000383747644
  error estimate for blocks of size 2^( 2) =       0.000400728029
  error estimate for blocks of size 2^( 3) =       0.000418608671
  error estimate for blocks of size 2^( 4) =       0.000433504988
  error estimate for blocks of size 2^( 5) =       0.000446069717
  error estimate for blocks of size 2^( 6) =       0.000454481664
  error estimate for blocks of size 2^( 7) =       0.000460182285

      target function =      -0.920955738255
              le_mean =     -16.898247245778
             les_mean =     285.845284340012
             stat err =       0.000448559663
             autocorr =       1.366309194803
   target nu stat err =       0.000448559663
   target dn stat err =       0.003236115710
      target stat err =       0.004978268419
              std dev =       0.542701122015
             le_variance =       0.294524507836


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.689824724578e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 3.9062e+23, overlap shift 3.9062e+24 and omega -1.7456e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.920981222527       residual = 1.26e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.920981222527       residual = 1.26e-03           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.9062e+23 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 1.5625e+24, overlap shift 1.5625e+25 and omega -1.7456e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.920981222527       residual = 1.26e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.920981222527       residual = 1.26e-03           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.5625e+24 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 6.2500e+24, overlap shift 6.2500e+25 and omega -1.7456e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.920981222527       residual = 1.26e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.920981222527       residual = 1.26e-03           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 6.2500e+24 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               1.470792 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.6475e+01
  </log>
  <optVariables href="H2O.s042.opt.xml">
 uu_0                 2.517233e-01 1 1  ON 0
 uu_1                 1.009440e-01 1 1  ON 1
 uu_2                 1.617079e-02 1 1  ON 2
 uu_3                -3.223684e-02 1 1  ON 3
 uu_4                -6.387117e-02 1 1  ON 4
 uu_5                -8.576607e-02 1 1  ON 5
 uu_6                -1.001312e-01 1 1  ON 6
 uu_7                -1.065673e-01 1 1  ON 7
 uu_8                -9.668739e-02 1 1  ON 8
 uu_9                -6.389513e-02 1 1  ON 9
 ud_0                 3.492134e-01 1 1  ON 10
 ud_1                 1.235409e-01 1 1  ON 11
 ud_2                 2.392782e-02 1 1  ON 12
 ud_3                -3.019578e-02 1 1  ON 13
 ud_4                -6.975615e-02 1 1  ON 14
 ud_5                -9.484122e-02 1 1  ON 15
 ud_6                -1.085598e-01 1 1  ON 16
 ud_7                -1.109505e-01 1 1  ON 17
 ud_8                -9.792103e-02 1 1  ON 18
 ud_9                -6.281979e-02 1 1  ON 19
 eO_0                -5.692885e-01 1 1  ON 20
 eO_1                -3.060844e-01 1 1  ON 21
 eO_2                 4.730127e-02 1 1  ON 22
 eO_3                 2.840620e-01 1 1  ON 23
 eO_4                 3.913445e-01 1 1  ON 24
 eO_5                 3.212389e-01 1 1  ON 25
 eO_6                 1.205694e-01 1 1  ON 26
 eO_7                -7.888705e-02 1 1  ON 27
 eO_8                -1.549102e-01 1 1  ON 28
 eO_9                -6.122098e-02 1 1  ON 29
eH1_0                -2.277697e-01 1 1  ON 30
eH1_1                -1.106400e-01 1 1  ON 31
eH1_2                -6.162952e-02 1 1  ON 32
eH1_3                -2.530653e-02 1 1  ON 33
eH1_4                 4.247832e-03 1 1  ON 34
eH1_5                 2.367079e-02 1 1  ON 35
eH1_6                 6.569443e-02 1 1  ON 36
eH1_7                 1.154361e-01 1 1  ON 37
eH1_8                 1.435221e-01 1 1  ON 38
eH1_9                 7.467419e-02 1 1  ON 39
eH2_0                -2.307043e-01 1 1  ON 40
eH2_1                -1.139386e-01 1 1  ON 41
eH2_2                -6.444539e-02 1 1  ON 42
eH2_3                -2.722663e-02 1 1  ON 43
eH2_4                 1.073593e-03 1 1  ON 44
eH2_5                 2.532957e-02 1 1  ON 45
eH2_6                 7.564477e-02 1 1  ON 46
eH2_7                 1.260027e-01 1 1  ON 47
eH2_8                 1.609124e-01 1 1  ON 48
eH2_9                 6.417217e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 42
    time step          = 0.05
    reference energy   = -16.928
    reference variance = 0.219696
====================================================
  Execution time = 2.0340e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s042
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6898e+01
  VMC Evar = 2.9359e-01
  Total weights = 2.0000e+06
  Execution time = 1.8842e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.293549563219
                                         uncertainty =       0.002771312161

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.293549563219
                                         uncertainty =       0.002771312161

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000383137526
  error estimate for blocks of size 2^( 2) =       0.000400607576
  error estimate for blocks of size 2^( 3) =       0.000418971045
  error estimate for blocks of size 2^( 4) =       0.000435960430
  error estimate for blocks of size 2^( 5) =       0.000448748647
  error estimate for blocks of size 2^( 6) =       0.000458557614
  error estimate for blocks of size 2^( 7) =       0.000467377599

      target function =      -0.922357268101
              le_mean =     -16.897665472308
             les_mean =     285.824686995436
             stat err =       0.000452661073
             autocorr =       1.395844097247
   target nu stat err =       0.000452661073
   target dn stat err =       0.003017550555
      target stat err =       0.004659936358
              std dev =       0.541838286009
             le_variance =       0.293588728185

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.293549563219
                                         uncertainty =       0.002771312161

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.293549563219
                                         uncertainty =       0.002771312161

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000383137526
  error estimate for blocks of size 2^( 2) =       0.000400607576
  error estimate for blocks of size 2^( 3) =       0.000418971045
  error estimate for blocks of size 2^( 4) =       0.000435960430
  error estimate for blocks of size 2^( 5) =       0.000448748647
  error estimate for blocks of size 2^( 6) =       0.000458557614
  error estimate for blocks of size 2^( 7) =       0.000467377599

      target function =      -0.922357268101
              le_mean =     -16.897665472308
             les_mean =     285.824686995436
             stat err =       0.000452661073
             autocorr =       1.395844097247
   target nu stat err =       0.000452661073
   target dn stat err =       0.003017550555
      target stat err =       0.004659936358
              std dev =       0.541838286009
             le_variance =       0.293588728185

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.293549563219
                                         uncertainty =       0.002771312161

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.293549563219
                                         uncertainty =       0.002771312161

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000383137526
  error estimate for blocks of size 2^( 2) =       0.000400607576
  error estimate for blocks of size 2^( 3) =       0.000418971045
  error estimate for blocks of size 2^( 4) =       0.000435960430
  error estimate for blocks of size 2^( 5) =       0.000448748647
  error estimate for blocks of size 2^( 6) =       0.000458557614
  error estimate for blocks of size 2^( 7) =       0.000467377599

      target function =      -0.922357268101
              le_mean =     -16.897665472308
             les_mean =     285.824686995436
             stat err =       0.000452661073
             autocorr =       1.395844097247
   target nu stat err =       0.000452661073
   target dn stat err =       0.003017550555
      target stat err =       0.004659936358
              std dev =       0.541838286009
             le_variance =       0.293588728185

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.293549563219
                                         uncertainty =       0.002771312161

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.293549563219
                                         uncertainty =       0.002771312161

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000383137526
  error estimate for blocks of size 2^( 2) =       0.000400607576
  error estimate for blocks of size 2^( 3) =       0.000418971045
  error estimate for blocks of size 2^( 4) =       0.000435960430
  error estimate for blocks of size 2^( 5) =       0.000448748647
  error estimate for blocks of size 2^( 6) =       0.000458557614
  error estimate for blocks of size 2^( 7) =       0.000467377599

      target function =      -0.922357268101
              le_mean =     -16.897665472308
             les_mean =     285.824686995436
             stat err =       0.000452661073
             autocorr =       1.395844097247
   target nu stat err =       0.000452661073
   target dn stat err =       0.003017550555
      target stat err =       0.004659936358
              std dev =       0.541838286009
             le_variance =       0.293588728185


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.922357268101        initial  <--
     3.9062e+23     3.9062e+24             0.0000e+00        -0.922357268101
     1.5625e+24     1.5625e+25             0.0000e+00        -0.922357268101
     6.2500e+24     6.2500e+25             0.0000e+00        -0.922357268101

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 29.8458
  </log>
  <optVariables href="H2O.s042.opt.xml">
 uu_0                 2.517233e-01 1 1  ON 0
 uu_1                 1.009440e-01 1 1  ON 1
 uu_2                 1.617079e-02 1 1  ON 2
 uu_3                -3.223684e-02 1 1  ON 3
 uu_4                -6.387117e-02 1 1  ON 4
 uu_5                -8.576607e-02 1 1  ON 5
 uu_6                -1.001312e-01 1 1  ON 6
 uu_7                -1.065673e-01 1 1  ON 7
 uu_8                -9.668739e-02 1 1  ON 8
 uu_9                -6.389513e-02 1 1  ON 9
 ud_0                 3.492134e-01 1 1  ON 10
 ud_1                 1.235409e-01 1 1  ON 11
 ud_2                 2.392782e-02 1 1  ON 12
 ud_3                -3.019578e-02 1 1  ON 13
 ud_4                -6.975615e-02 1 1  ON 14
 ud_5                -9.484122e-02 1 1  ON 15
 ud_6                -1.085598e-01 1 1  ON 16
 ud_7                -1.109505e-01 1 1  ON 17
 ud_8                -9.792103e-02 1 1  ON 18
 ud_9                -6.281979e-02 1 1  ON 19
 eO_0                -5.692885e-01 1 1  ON 20
 eO_1                -3.060844e-01 1 1  ON 21
 eO_2                 4.730127e-02 1 1  ON 22
 eO_3                 2.840620e-01 1 1  ON 23
 eO_4                 3.913445e-01 1 1  ON 24
 eO_5                 3.212389e-01 1 1  ON 25
 eO_6                 1.205694e-01 1 1  ON 26
 eO_7                -7.888705e-02 1 1  ON 27
 eO_8                -1.549102e-01 1 1  ON 28
 eO_9                -6.122098e-02 1 1  ON 29
eH1_0                -2.277697e-01 1 1  ON 30
eH1_1                -1.106400e-01 1 1  ON 31
eH1_2                -6.162952e-02 1 1  ON 32
eH1_3                -2.530653e-02 1 1  ON 33
eH1_4                 4.247832e-03 1 1  ON 34
eH1_5                 2.367079e-02 1 1  ON 35
eH1_6                 6.569443e-02 1 1  ON 36
eH1_7                 1.154361e-01 1 1  ON 37
eH1_8                 1.435221e-01 1 1  ON 38
eH1_9                 7.467419e-02 1 1  ON 39
eH2_0                -2.307043e-01 1 1  ON 40
eH2_1                -1.139386e-01 1 1  ON 41
eH2_2                -6.444539e-02 1 1  ON 42
eH2_3                -2.722663e-02 1 1  ON 43
eH2_4                 1.073593e-03 1 1  ON 44
eH2_5                 2.532957e-02 1 1  ON 45
eH2_6                 7.564477e-02 1 1  ON 46
eH2_7                 1.260027e-01 1 1  ON 47
eH2_8                 1.609124e-01 1 1  ON 48
eH2_9                 6.417217e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.6327e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s043 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s043 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=43  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6901e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 43
    time step          = 0.05
    reference energy   = -16.882
    reference variance = 0.146544
====================================================
  Execution time = 2.2777e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s043
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6898e+01
  VMC Evar = 2.9205e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.5800e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.292064526205
                                         uncertainty =       0.002661882339

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.292064526205
                                         uncertainty =       0.002661882339

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000382131111
  error estimate for blocks of size 2^( 2) =       0.000399210297
  error estimate for blocks of size 2^( 3) =       0.000416749047
  error estimate for blocks of size 2^( 4) =       0.000431640478
  error estimate for blocks of size 2^( 5) =       0.000443045538
  error estimate for blocks of size 2^( 6) =       0.000449844318
  error estimate for blocks of size 2^( 7) =       0.000452809652

      target function =      -0.924736055883
              le_mean =     -16.898117029286
             les_mean =     285.838407361543
             stat err =       0.000444334996
             autocorr =       1.352060876354
   target nu stat err =       0.000444334996
   target dn stat err =       0.002910387191
      target stat err =       0.004523087683
              std dev =       0.540414999915
             le_variance =       0.292048372133


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.689811702929e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 3.9062e+24, overlap shift 3.9062e+25 and omega -1.7456e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.924756757238       residual = 9.17e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.924756757238       residual = 9.17e-04           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.9062e+24 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 1.5625e+25, overlap shift 1.5625e+26 and omega -1.7456e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.924756757238       residual = 9.17e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.924756757238       residual = 9.17e-04           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.5625e+25 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 6.2500e+25, overlap shift 6.2500e+26 and omega -1.7456e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.924756757238       residual = 9.17e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.924756757238       residual = 9.17e-04           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 6.2500e+25 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               1.471919 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.8364e+01
  </log>
  <optVariables href="H2O.s043.opt.xml">
 uu_0                 2.517233e-01 1 1  ON 0
 uu_1                 1.009440e-01 1 1  ON 1
 uu_2                 1.617079e-02 1 1  ON 2
 uu_3                -3.223684e-02 1 1  ON 3
 uu_4                -6.387117e-02 1 1  ON 4
 uu_5                -8.576607e-02 1 1  ON 5
 uu_6                -1.001312e-01 1 1  ON 6
 uu_7                -1.065673e-01 1 1  ON 7
 uu_8                -9.668739e-02 1 1  ON 8
 uu_9                -6.389513e-02 1 1  ON 9
 ud_0                 3.492134e-01 1 1  ON 10
 ud_1                 1.235409e-01 1 1  ON 11
 ud_2                 2.392782e-02 1 1  ON 12
 ud_3                -3.019578e-02 1 1  ON 13
 ud_4                -6.975615e-02 1 1  ON 14
 ud_5                -9.484122e-02 1 1  ON 15
 ud_6                -1.085598e-01 1 1  ON 16
 ud_7                -1.109505e-01 1 1  ON 17
 ud_8                -9.792103e-02 1 1  ON 18
 ud_9                -6.281979e-02 1 1  ON 19
 eO_0                -5.692885e-01 1 1  ON 20
 eO_1                -3.060844e-01 1 1  ON 21
 eO_2                 4.730127e-02 1 1  ON 22
 eO_3                 2.840620e-01 1 1  ON 23
 eO_4                 3.913445e-01 1 1  ON 24
 eO_5                 3.212389e-01 1 1  ON 25
 eO_6                 1.205694e-01 1 1  ON 26
 eO_7                -7.888705e-02 1 1  ON 27
 eO_8                -1.549102e-01 1 1  ON 28
 eO_9                -6.122098e-02 1 1  ON 29
eH1_0                -2.277697e-01 1 1  ON 30
eH1_1                -1.106400e-01 1 1  ON 31
eH1_2                -6.162952e-02 1 1  ON 32
eH1_3                -2.530653e-02 1 1  ON 33
eH1_4                 4.247832e-03 1 1  ON 34
eH1_5                 2.367079e-02 1 1  ON 35
eH1_6                 6.569443e-02 1 1  ON 36
eH1_7                 1.154361e-01 1 1  ON 37
eH1_8                 1.435221e-01 1 1  ON 38
eH1_9                 7.467419e-02 1 1  ON 39
eH2_0                -2.307043e-01 1 1  ON 40
eH2_1                -1.139386e-01 1 1  ON 41
eH2_2                -6.444539e-02 1 1  ON 42
eH2_3                -2.722663e-02 1 1  ON 43
eH2_4                 1.073593e-03 1 1  ON 44
eH2_5                 2.532957e-02 1 1  ON 45
eH2_6                 7.564477e-02 1 1  ON 46
eH2_7                 1.260027e-01 1 1  ON 47
eH2_8                 1.609124e-01 1 1  ON 48
eH2_9                 6.417217e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 43
    time step          = 0.05
    reference energy   = -16.833
    reference variance = 0.243129
====================================================
  Execution time = 2.0552e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s043
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6898e+01
  VMC Evar = 2.9595e-01
  Total weights = 2.0000e+06
  Execution time = 1.8834e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.295950820313
                                         uncertainty =       0.003011410442

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.295950820313
                                         uncertainty =       0.003011410442

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000384674494
  error estimate for blocks of size 2^( 2) =       0.000401915955
  error estimate for blocks of size 2^( 3) =       0.000419291654
  error estimate for blocks of size 2^( 4) =       0.000435402015
  error estimate for blocks of size 2^( 5) =       0.000447770230
  error estimate for blocks of size 2^( 6) =       0.000454810006
  error estimate for blocks of size 2^( 7) =       0.000457110603

      target function =      -0.918792674899
              le_mean =     -16.898161422553
             les_mean =     285.843808247376
             stat err =       0.000448773213
             autocorr =       1.361028034026
   target nu stat err =       0.000448773213
   target dn stat err =       0.003093672266
      target stat err =       0.004741335229
              std dev =       0.544011886523
             le_variance =       0.295948932678

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.295950820313
                                         uncertainty =       0.003011410442

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.295950820313
                                         uncertainty =       0.003011410442

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000384674494
  error estimate for blocks of size 2^( 2) =       0.000401915955
  error estimate for blocks of size 2^( 3) =       0.000419291654
  error estimate for blocks of size 2^( 4) =       0.000435402015
  error estimate for blocks of size 2^( 5) =       0.000447770230
  error estimate for blocks of size 2^( 6) =       0.000454810006
  error estimate for blocks of size 2^( 7) =       0.000457110603

      target function =      -0.918792674899
              le_mean =     -16.898161422553
             les_mean =     285.843808247376
             stat err =       0.000448773213
             autocorr =       1.361028034026
   target nu stat err =       0.000448773213
   target dn stat err =       0.003093672266
      target stat err =       0.004741335229
              std dev =       0.544011886523
             le_variance =       0.295948932678

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.295950820313
                                         uncertainty =       0.003011410442

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.295950820313
                                         uncertainty =       0.003011410442

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000384674494
  error estimate for blocks of size 2^( 2) =       0.000401915955
  error estimate for blocks of size 2^( 3) =       0.000419291654
  error estimate for blocks of size 2^( 4) =       0.000435402015
  error estimate for blocks of size 2^( 5) =       0.000447770230
  error estimate for blocks of size 2^( 6) =       0.000454810006
  error estimate for blocks of size 2^( 7) =       0.000457110603

      target function =      -0.918792674899
              le_mean =     -16.898161422553
             les_mean =     285.843808247376
             stat err =       0.000448773213
             autocorr =       1.361028034026
   target nu stat err =       0.000448773213
   target dn stat err =       0.003093672266
      target stat err =       0.004741335229
              std dev =       0.544011886523
             le_variance =       0.295948932678

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.295950820313
                                         uncertainty =       0.003011410442

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.295950820313
                                         uncertainty =       0.003011410442

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000384674494
  error estimate for blocks of size 2^( 2) =       0.000401915955
  error estimate for blocks of size 2^( 3) =       0.000419291654
  error estimate for blocks of size 2^( 4) =       0.000435402015
  error estimate for blocks of size 2^( 5) =       0.000447770230
  error estimate for blocks of size 2^( 6) =       0.000454810006
  error estimate for blocks of size 2^( 7) =       0.000457110603

      target function =      -0.918792674899
              le_mean =     -16.898161422553
             les_mean =     285.843808247376
             stat err =       0.000448773213
             autocorr =       1.361028034026
   target nu stat err =       0.000448773213
   target dn stat err =       0.003093672266
      target stat err =       0.004741335229
              std dev =       0.544011886523
             le_variance =       0.295948932678


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.918792674899        initial  <--
     3.9062e+24     3.9062e+25             0.0000e+00        -0.918792674899
     1.5625e+25     1.5625e+26             0.0000e+00        -0.918792674899
     6.2500e+25     6.2500e+26             0.0000e+00        -0.918792674899

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 30.0748
  </log>
  <optVariables href="H2O.s043.opt.xml">
 uu_0                 2.517233e-01 1 1  ON 0
 uu_1                 1.009440e-01 1 1  ON 1
 uu_2                 1.617079e-02 1 1  ON 2
 uu_3                -3.223684e-02 1 1  ON 3
 uu_4                -6.387117e-02 1 1  ON 4
 uu_5                -8.576607e-02 1 1  ON 5
 uu_6                -1.001312e-01 1 1  ON 6
 uu_7                -1.065673e-01 1 1  ON 7
 uu_8                -9.668739e-02 1 1  ON 8
 uu_9                -6.389513e-02 1 1  ON 9
 ud_0                 3.492134e-01 1 1  ON 10
 ud_1                 1.235409e-01 1 1  ON 11
 ud_2                 2.392782e-02 1 1  ON 12
 ud_3                -3.019578e-02 1 1  ON 13
 ud_4                -6.975615e-02 1 1  ON 14
 ud_5                -9.484122e-02 1 1  ON 15
 ud_6                -1.085598e-01 1 1  ON 16
 ud_7                -1.109505e-01 1 1  ON 17
 ud_8                -9.792103e-02 1 1  ON 18
 ud_9                -6.281979e-02 1 1  ON 19
 eO_0                -5.692885e-01 1 1  ON 20
 eO_1                -3.060844e-01 1 1  ON 21
 eO_2                 4.730127e-02 1 1  ON 22
 eO_3                 2.840620e-01 1 1  ON 23
 eO_4                 3.913445e-01 1 1  ON 24
 eO_5                 3.212389e-01 1 1  ON 25
 eO_6                 1.205694e-01 1 1  ON 26
 eO_7                -7.888705e-02 1 1  ON 27
 eO_8                -1.549102e-01 1 1  ON 28
 eO_9                -6.122098e-02 1 1  ON 29
eH1_0                -2.277697e-01 1 1  ON 30
eH1_1                -1.106400e-01 1 1  ON 31
eH1_2                -6.162952e-02 1 1  ON 32
eH1_3                -2.530653e-02 1 1  ON 33
eH1_4                 4.247832e-03 1 1  ON 34
eH1_5                 2.367079e-02 1 1  ON 35
eH1_6                 6.569443e-02 1 1  ON 36
eH1_7                 1.154361e-01 1 1  ON 37
eH1_8                 1.435221e-01 1 1  ON 38
eH1_9                 7.467419e-02 1 1  ON 39
eH2_0                -2.307043e-01 1 1  ON 40
eH2_1                -1.139386e-01 1 1  ON 41
eH2_2                -6.444539e-02 1 1  ON 42
eH2_3                -2.722663e-02 1 1  ON 43
eH2_4                 1.073593e-03 1 1  ON 44
eH2_5                 2.532957e-02 1 1  ON 45
eH2_6                 7.564477e-02 1 1  ON 46
eH2_7                 1.260027e-01 1 1  ON 47
eH2_8                 1.609124e-01 1 1  ON 48
eH2_9                 6.417217e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.8444e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s044 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s044 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=44  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6900e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 44
    time step          = 0.05
    reference energy   = -16.9938
    reference variance = 0.256245
====================================================
  Execution time = 2.0738e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s044
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6898e+01
  VMC Evar = 2.9542e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.5839e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.295523289589
                                         uncertainty =       0.002979558985

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.295523289589
                                         uncertainty =       0.002979558985

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000384331501
  error estimate for blocks of size 2^( 2) =       0.000401542177
  error estimate for blocks of size 2^( 3) =       0.000419418696
  error estimate for blocks of size 2^( 4) =       0.000435042944
  error estimate for blocks of size 2^( 5) =       0.000446829692
  error estimate for blocks of size 2^( 6) =       0.000455135904
  error estimate for blocks of size 2^( 7) =       0.000458897673

      target function =      -0.919586495461
              le_mean =     -16.897994143415
             les_mean =     285.837627328502
             stat err =       0.000448976553
             autocorr =       1.364694241631
   target nu stat err =       0.000448976553
   target dn stat err =       0.002991880009
      target stat err =       0.004595684009
              std dev =       0.543526821167
             le_variance =       0.295421405328


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.689799414341e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 3.9062e+25, overlap shift 3.9062e+26 and omega -1.7456e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.919608091829       residual = 1.39e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.919608091829       residual = 1.39e-03           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.9062e+25 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 1.5625e+26, overlap shift 1.5625e+27 and omega -1.7456e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.919608091829       residual = 1.39e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.919608091829       residual = 1.39e-03           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.5625e+26 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 6.2500e+26, overlap shift 6.2500e+27 and omega -1.7456e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.919608091829       residual = 1.39e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.919608091829       residual = 1.39e-03           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 6.2500e+26 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               1.473002 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.6328e+01
  </log>
  <optVariables href="H2O.s044.opt.xml">
 uu_0                 2.517233e-01 1 1  ON 0
 uu_1                 1.009440e-01 1 1  ON 1
 uu_2                 1.617079e-02 1 1  ON 2
 uu_3                -3.223684e-02 1 1  ON 3
 uu_4                -6.387117e-02 1 1  ON 4
 uu_5                -8.576607e-02 1 1  ON 5
 uu_6                -1.001312e-01 1 1  ON 6
 uu_7                -1.065673e-01 1 1  ON 7
 uu_8                -9.668739e-02 1 1  ON 8
 uu_9                -6.389513e-02 1 1  ON 9
 ud_0                 3.492134e-01 1 1  ON 10
 ud_1                 1.235409e-01 1 1  ON 11
 ud_2                 2.392782e-02 1 1  ON 12
 ud_3                -3.019578e-02 1 1  ON 13
 ud_4                -6.975615e-02 1 1  ON 14
 ud_5                -9.484122e-02 1 1  ON 15
 ud_6                -1.085598e-01 1 1  ON 16
 ud_7                -1.109505e-01 1 1  ON 17
 ud_8                -9.792103e-02 1 1  ON 18
 ud_9                -6.281979e-02 1 1  ON 19
 eO_0                -5.692885e-01 1 1  ON 20
 eO_1                -3.060844e-01 1 1  ON 21
 eO_2                 4.730127e-02 1 1  ON 22
 eO_3                 2.840620e-01 1 1  ON 23
 eO_4                 3.913445e-01 1 1  ON 24
 eO_5                 3.212389e-01 1 1  ON 25
 eO_6                 1.205694e-01 1 1  ON 26
 eO_7                -7.888705e-02 1 1  ON 27
 eO_8                -1.549102e-01 1 1  ON 28
 eO_9                -6.122098e-02 1 1  ON 29
eH1_0                -2.277697e-01 1 1  ON 30
eH1_1                -1.106400e-01 1 1  ON 31
eH1_2                -6.162952e-02 1 1  ON 32
eH1_3                -2.530653e-02 1 1  ON 33
eH1_4                 4.247832e-03 1 1  ON 34
eH1_5                 2.367079e-02 1 1  ON 35
eH1_6                 6.569443e-02 1 1  ON 36
eH1_7                 1.154361e-01 1 1  ON 37
eH1_8                 1.435221e-01 1 1  ON 38
eH1_9                 7.467419e-02 1 1  ON 39
eH2_0                -2.307043e-01 1 1  ON 40
eH2_1                -1.139386e-01 1 1  ON 41
eH2_2                -6.444539e-02 1 1  ON 42
eH2_3                -2.722663e-02 1 1  ON 43
eH2_4                 1.073593e-03 1 1  ON 44
eH2_5                 2.532957e-02 1 1  ON 45
eH2_6                 7.564477e-02 1 1  ON 46
eH2_7                 1.260027e-01 1 1  ON 47
eH2_8                 1.609124e-01 1 1  ON 48
eH2_9                 6.417217e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 44
    time step          = 0.05
    reference energy   = -16.9216
    reference variance = 0.376674
====================================================
  Execution time = 2.0356e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s044
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6897e+01
  VMC Evar = 2.9615e-01
  Total weights = 2.0000e+06
  Execution time = 1.8758e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.296188219392
                                         uncertainty =       0.004597993046

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.296188219392
                                         uncertainty =       0.004597993046

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000384802401
  error estimate for blocks of size 2^( 2) =       0.000401292301
  error estimate for blocks of size 2^( 3) =       0.000418772428
  error estimate for blocks of size 2^( 4) =       0.000433557020
  error estimate for blocks of size 2^( 5) =       0.000445325155
  error estimate for blocks of size 2^( 6) =       0.000451836270
  error estimate for blocks of size 2^( 7) =       0.000457229444

      target function =      -0.918444851545
              le_mean =     -16.897498315722
             les_mean =     285.821594958012
             stat err =       0.000446986972
             autocorr =       1.349317595786
   target nu stat err =       0.000446986972
   target dn stat err =       0.004358772058
      target stat err =       0.006626743266
              std dev =       0.544192774891
             le_variance =       0.296145776244

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.296188219392
                                         uncertainty =       0.004597993046

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.296188219392
                                         uncertainty =       0.004597993046

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000384802401
  error estimate for blocks of size 2^( 2) =       0.000401292301
  error estimate for blocks of size 2^( 3) =       0.000418772428
  error estimate for blocks of size 2^( 4) =       0.000433557020
  error estimate for blocks of size 2^( 5) =       0.000445325155
  error estimate for blocks of size 2^( 6) =       0.000451836270
  error estimate for blocks of size 2^( 7) =       0.000457229444

      target function =      -0.918444851545
              le_mean =     -16.897498315722
             les_mean =     285.821594958012
             stat err =       0.000446986972
             autocorr =       1.349317595786
   target nu stat err =       0.000446986972
   target dn stat err =       0.004358772058
      target stat err =       0.006626743266
              std dev =       0.544192774891
             le_variance =       0.296145776244

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.296188219392
                                         uncertainty =       0.004597993046

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.296188219392
                                         uncertainty =       0.004597993046

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000384802401
  error estimate for blocks of size 2^( 2) =       0.000401292301
  error estimate for blocks of size 2^( 3) =       0.000418772428
  error estimate for blocks of size 2^( 4) =       0.000433557020
  error estimate for blocks of size 2^( 5) =       0.000445325155
  error estimate for blocks of size 2^( 6) =       0.000451836270
  error estimate for blocks of size 2^( 7) =       0.000457229444

      target function =      -0.918444851545
              le_mean =     -16.897498315722
             les_mean =     285.821594958012
             stat err =       0.000446986972
             autocorr =       1.349317595786
   target nu stat err =       0.000446986972
   target dn stat err =       0.004358772058
      target stat err =       0.006626743266
              std dev =       0.544192774891
             le_variance =       0.296145776244

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.296188219392
                                         uncertainty =       0.004597993046

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.296188219392
                                         uncertainty =       0.004597993046

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000384802401
  error estimate for blocks of size 2^( 2) =       0.000401292301
  error estimate for blocks of size 2^( 3) =       0.000418772428
  error estimate for blocks of size 2^( 4) =       0.000433557020
  error estimate for blocks of size 2^( 5) =       0.000445325155
  error estimate for blocks of size 2^( 6) =       0.000451836270
  error estimate for blocks of size 2^( 7) =       0.000457229444

      target function =      -0.918444851545
              le_mean =     -16.897498315722
             les_mean =     285.821594958012
             stat err =       0.000446986972
             autocorr =       1.349317595786
   target nu stat err =       0.000446986972
   target dn stat err =       0.004358772058
      target stat err =       0.006626743266
              std dev =       0.544192774891
             le_variance =       0.296145776244


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.918444851545        initial  <--
     3.9062e+25     3.9062e+26             0.0000e+00        -0.918444851545
     1.5625e+26     1.5625e+27             0.0000e+00        -0.918444851545
     6.2500e+26     6.2500e+27             0.0000e+00        -0.918444851545

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 29.9158
  </log>
  <optVariables href="H2O.s044.opt.xml">
 uu_0                 2.517233e-01 1 1  ON 0
 uu_1                 1.009440e-01 1 1  ON 1
 uu_2                 1.617079e-02 1 1  ON 2
 uu_3                -3.223684e-02 1 1  ON 3
 uu_4                -6.387117e-02 1 1  ON 4
 uu_5                -8.576607e-02 1 1  ON 5
 uu_6                -1.001312e-01 1 1  ON 6
 uu_7                -1.065673e-01 1 1  ON 7
 uu_8                -9.668739e-02 1 1  ON 8
 uu_9                -6.389513e-02 1 1  ON 9
 ud_0                 3.492134e-01 1 1  ON 10
 ud_1                 1.235409e-01 1 1  ON 11
 ud_2                 2.392782e-02 1 1  ON 12
 ud_3                -3.019578e-02 1 1  ON 13
 ud_4                -6.975615e-02 1 1  ON 14
 ud_5                -9.484122e-02 1 1  ON 15
 ud_6                -1.085598e-01 1 1  ON 16
 ud_7                -1.109505e-01 1 1  ON 17
 ud_8                -9.792103e-02 1 1  ON 18
 ud_9                -6.281979e-02 1 1  ON 19
 eO_0                -5.692885e-01 1 1  ON 20
 eO_1                -3.060844e-01 1 1  ON 21
 eO_2                 4.730127e-02 1 1  ON 22
 eO_3                 2.840620e-01 1 1  ON 23
 eO_4                 3.913445e-01 1 1  ON 24
 eO_5                 3.212389e-01 1 1  ON 25
 eO_6                 1.205694e-01 1 1  ON 26
 eO_7                -7.888705e-02 1 1  ON 27
 eO_8                -1.549102e-01 1 1  ON 28
 eO_9                -6.122098e-02 1 1  ON 29
eH1_0                -2.277697e-01 1 1  ON 30
eH1_1                -1.106400e-01 1 1  ON 31
eH1_2                -6.162952e-02 1 1  ON 32
eH1_3                -2.530653e-02 1 1  ON 33
eH1_4                 4.247832e-03 1 1  ON 34
eH1_5                 2.367079e-02 1 1  ON 35
eH1_6                 6.569443e-02 1 1  ON 36
eH1_7                 1.154361e-01 1 1  ON 37
eH1_8                 1.435221e-01 1 1  ON 38
eH1_9                 7.467419e-02 1 1  ON 39
eH2_0                -2.307043e-01 1 1  ON 40
eH2_1                -1.139386e-01 1 1  ON 41
eH2_2                -6.444539e-02 1 1  ON 42
eH2_3                -2.722663e-02 1 1  ON 43
eH2_4                 1.073593e-03 1 1  ON 44
eH2_5                 2.532957e-02 1 1  ON 45
eH2_6                 7.564477e-02 1 1  ON 46
eH2_7                 1.260027e-01 1 1  ON 47
eH2_8                 1.609124e-01 1 1  ON 48
eH2_9                 6.417217e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.6250e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s045 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s045 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=45  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6901e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 45
    time step          = 0.05
    reference energy   = -16.9077
    reference variance = 0.270844
====================================================
  Execution time = 2.0768e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s045
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6898e+01
  VMC Evar = 2.9088e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.5492e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.290900847141
                                         uncertainty =       0.002516404691

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.290900847141
                                         uncertainty =       0.002516404691

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000381368291
  error estimate for blocks of size 2^( 2) =       0.000398248392
  error estimate for blocks of size 2^( 3) =       0.000415676030
  error estimate for blocks of size 2^( 4) =       0.000430635001
  error estimate for blocks of size 2^( 5) =       0.000442783484
  error estimate for blocks of size 2^( 6) =       0.000451775464
  error estimate for blocks of size 2^( 7) =       0.000454482553

      target function =      -0.926536338690
              le_mean =     -16.898192437945
             les_mean =     285.839791070833
             stat err =       0.000444919126
             autocorr =       1.361046581481
   target nu stat err =       0.000444919126
   target dn stat err =       0.002424810727
      target stat err =       0.003805578665
              std dev =       0.539336209118
             le_variance =       0.290883546465


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.689819243794e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 3.9062e+26, overlap shift 3.9062e+27 and omega -1.7456e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.926550537904       residual = 9.61e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.926550537904       residual = 9.61e-04           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.9062e+26 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 1.5625e+27, overlap shift 1.5625e+28 and omega -1.7456e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.926550537904       residual = 9.61e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.926550537904       residual = 9.61e-04           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.5625e+27 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 6.2500e+27, overlap shift 6.2500e+28 and omega -1.7456e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.926550537904       residual = 9.61e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.926550537904       residual = 9.61e-04           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 6.2500e+27 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               1.474118 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.6325e+01
  </log>
  <optVariables href="H2O.s045.opt.xml">
 uu_0                 2.517233e-01 1 1  ON 0
 uu_1                 1.009440e-01 1 1  ON 1
 uu_2                 1.617079e-02 1 1  ON 2
 uu_3                -3.223684e-02 1 1  ON 3
 uu_4                -6.387117e-02 1 1  ON 4
 uu_5                -8.576607e-02 1 1  ON 5
 uu_6                -1.001312e-01 1 1  ON 6
 uu_7                -1.065673e-01 1 1  ON 7
 uu_8                -9.668739e-02 1 1  ON 8
 uu_9                -6.389513e-02 1 1  ON 9
 ud_0                 3.492134e-01 1 1  ON 10
 ud_1                 1.235409e-01 1 1  ON 11
 ud_2                 2.392782e-02 1 1  ON 12
 ud_3                -3.019578e-02 1 1  ON 13
 ud_4                -6.975615e-02 1 1  ON 14
 ud_5                -9.484122e-02 1 1  ON 15
 ud_6                -1.085598e-01 1 1  ON 16
 ud_7                -1.109505e-01 1 1  ON 17
 ud_8                -9.792103e-02 1 1  ON 18
 ud_9                -6.281979e-02 1 1  ON 19
 eO_0                -5.692885e-01 1 1  ON 20
 eO_1                -3.060844e-01 1 1  ON 21
 eO_2                 4.730127e-02 1 1  ON 22
 eO_3                 2.840620e-01 1 1  ON 23
 eO_4                 3.913445e-01 1 1  ON 24
 eO_5                 3.212389e-01 1 1  ON 25
 eO_6                 1.205694e-01 1 1  ON 26
 eO_7                -7.888705e-02 1 1  ON 27
 eO_8                -1.549102e-01 1 1  ON 28
 eO_9                -6.122098e-02 1 1  ON 29
eH1_0                -2.277697e-01 1 1  ON 30
eH1_1                -1.106400e-01 1 1  ON 31
eH1_2                -6.162952e-02 1 1  ON 32
eH1_3                -2.530653e-02 1 1  ON 33
eH1_4                 4.247832e-03 1 1  ON 34
eH1_5                 2.367079e-02 1 1  ON 35
eH1_6                 6.569443e-02 1 1  ON 36
eH1_7                 1.154361e-01 1 1  ON 37
eH1_8                 1.435221e-01 1 1  ON 38
eH1_9                 7.467419e-02 1 1  ON 39
eH2_0                -2.307043e-01 1 1  ON 40
eH2_1                -1.139386e-01 1 1  ON 41
eH2_2                -6.444539e-02 1 1  ON 42
eH2_3                -2.722663e-02 1 1  ON 43
eH2_4                 1.073593e-03 1 1  ON 44
eH2_5                 2.532957e-02 1 1  ON 45
eH2_6                 7.564477e-02 1 1  ON 46
eH2_7                 1.260027e-01 1 1  ON 47
eH2_8                 1.609124e-01 1 1  ON 48
eH2_9                 6.417217e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 45
    time step          = 0.05
    reference energy   = -16.8077
    reference variance = 0.198881
====================================================
  Execution time = 2.0519e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s045
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6899e+01
  VMC Evar = 2.9930e-01
  Total weights = 2.0000e+06
  Execution time = 1.8792e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.299336475496
                                         uncertainty =       0.003634714784

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.299336475496
                                         uncertainty =       0.003634714784

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000386844328
  error estimate for blocks of size 2^( 2) =       0.000403988625
  error estimate for blocks of size 2^( 3) =       0.000421199040
  error estimate for blocks of size 2^( 4) =       0.000436969011
  error estimate for blocks of size 2^( 5) =       0.000448216734
  error estimate for blocks of size 2^( 6) =       0.000457118854
  error estimate for blocks of size 2^( 7) =       0.000460834430

      target function =      -0.913755920258
              le_mean =     -16.898653966104
             les_mean =     285.863802785003
             stat err =       0.000450784757
             autocorr =       1.357894338393
   target nu stat err =       0.000450784757
   target dn stat err =       0.003784846409
      target stat err =       0.005720062677
              std dev =       0.547080495485
             le_variance =       0.299297068540

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.299336475496
                                         uncertainty =       0.003634714784

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.299336475496
                                         uncertainty =       0.003634714784

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000386844328
  error estimate for blocks of size 2^( 2) =       0.000403988625
  error estimate for blocks of size 2^( 3) =       0.000421199040
  error estimate for blocks of size 2^( 4) =       0.000436969011
  error estimate for blocks of size 2^( 5) =       0.000448216734
  error estimate for blocks of size 2^( 6) =       0.000457118854
  error estimate for blocks of size 2^( 7) =       0.000460834430

      target function =      -0.913755920258
              le_mean =     -16.898653966104
             les_mean =     285.863802785003
             stat err =       0.000450784757
             autocorr =       1.357894338393
   target nu stat err =       0.000450784757
   target dn stat err =       0.003784846409
      target stat err =       0.005720062677
              std dev =       0.547080495485
             le_variance =       0.299297068540

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.299336475496
                                         uncertainty =       0.003634714784

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.299336475496
                                         uncertainty =       0.003634714784

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000386844328
  error estimate for blocks of size 2^( 2) =       0.000403988625
  error estimate for blocks of size 2^( 3) =       0.000421199040
  error estimate for blocks of size 2^( 4) =       0.000436969011
  error estimate for blocks of size 2^( 5) =       0.000448216734
  error estimate for blocks of size 2^( 6) =       0.000457118854
  error estimate for blocks of size 2^( 7) =       0.000460834430

      target function =      -0.913755920258
              le_mean =     -16.898653966104
             les_mean =     285.863802785003
             stat err =       0.000450784757
             autocorr =       1.357894338393
   target nu stat err =       0.000450784757
   target dn stat err =       0.003784846409
      target stat err =       0.005720062677
              std dev =       0.547080495485
             le_variance =       0.299297068540

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.299336475496
                                         uncertainty =       0.003634714784

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.299336475496
                                         uncertainty =       0.003634714784

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000386844328
  error estimate for blocks of size 2^( 2) =       0.000403988625
  error estimate for blocks of size 2^( 3) =       0.000421199040
  error estimate for blocks of size 2^( 4) =       0.000436969011
  error estimate for blocks of size 2^( 5) =       0.000448216734
  error estimate for blocks of size 2^( 6) =       0.000457118854
  error estimate for blocks of size 2^( 7) =       0.000460834430

      target function =      -0.913755920258
              le_mean =     -16.898653966104
             les_mean =     285.863802785003
             stat err =       0.000450784757
             autocorr =       1.357894338393
   target nu stat err =       0.000450784757
   target dn stat err =       0.003784846409
      target stat err =       0.005720062677
              std dev =       0.547080495485
             le_variance =       0.299297068540


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.913755920258        initial  <--
     3.9062e+26     3.9062e+27             0.0000e+00        -0.913755920258
     1.5625e+27     1.5625e+28             0.0000e+00        -0.913755920258
     6.2500e+27     6.2500e+28             0.0000e+00        -0.913755920258

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 30.0290
  </log>
  <optVariables href="H2O.s045.opt.xml">
 uu_0                 2.517233e-01 1 1  ON 0
 uu_1                 1.009440e-01 1 1  ON 1
 uu_2                 1.617079e-02 1 1  ON 2
 uu_3                -3.223684e-02 1 1  ON 3
 uu_4                -6.387117e-02 1 1  ON 4
 uu_5                -8.576607e-02 1 1  ON 5
 uu_6                -1.001312e-01 1 1  ON 6
 uu_7                -1.065673e-01 1 1  ON 7
 uu_8                -9.668739e-02 1 1  ON 8
 uu_9                -6.389513e-02 1 1  ON 9
 ud_0                 3.492134e-01 1 1  ON 10
 ud_1                 1.235409e-01 1 1  ON 11
 ud_2                 2.392782e-02 1 1  ON 12
 ud_3                -3.019578e-02 1 1  ON 13
 ud_4                -6.975615e-02 1 1  ON 14
 ud_5                -9.484122e-02 1 1  ON 15
 ud_6                -1.085598e-01 1 1  ON 16
 ud_7                -1.109505e-01 1 1  ON 17
 ud_8                -9.792103e-02 1 1  ON 18
 ud_9                -6.281979e-02 1 1  ON 19
 eO_0                -5.692885e-01 1 1  ON 20
 eO_1                -3.060844e-01 1 1  ON 21
 eO_2                 4.730127e-02 1 1  ON 22
 eO_3                 2.840620e-01 1 1  ON 23
 eO_4                 3.913445e-01 1 1  ON 24
 eO_5                 3.212389e-01 1 1  ON 25
 eO_6                 1.205694e-01 1 1  ON 26
 eO_7                -7.888705e-02 1 1  ON 27
 eO_8                -1.549102e-01 1 1  ON 28
 eO_9                -6.122098e-02 1 1  ON 29
eH1_0                -2.277697e-01 1 1  ON 30
eH1_1                -1.106400e-01 1 1  ON 31
eH1_2                -6.162952e-02 1 1  ON 32
eH1_3                -2.530653e-02 1 1  ON 33
eH1_4                 4.247832e-03 1 1  ON 34
eH1_5                 2.367079e-02 1 1  ON 35
eH1_6                 6.569443e-02 1 1  ON 36
eH1_7                 1.154361e-01 1 1  ON 37
eH1_8                 1.435221e-01 1 1  ON 38
eH1_9                 7.467419e-02 1 1  ON 39
eH2_0                -2.307043e-01 1 1  ON 40
eH2_1                -1.139386e-01 1 1  ON 41
eH2_2                -6.444539e-02 1 1  ON 42
eH2_3                -2.722663e-02 1 1  ON 43
eH2_4                 1.073593e-03 1 1  ON 44
eH2_5                 2.532957e-02 1 1  ON 45
eH2_6                 7.564477e-02 1 1  ON 46
eH2_7                 1.260027e-01 1 1  ON 47
eH2_8                 1.609124e-01 1 1  ON 48
eH2_9                 6.417217e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.6360e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s046 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s046 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=46  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6900e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 46
    time step          = 0.05
    reference energy   = -16.9512
    reference variance = 0.268964
====================================================
  Execution time = 2.1656e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s046
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6898e+01
  VMC Evar = 2.9761e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 6.0190e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.297659518356
                                         uncertainty =       0.003849403696

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.297659518356
                                         uncertainty =       0.003849403696

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000385752351
  error estimate for blocks of size 2^( 2) =       0.000402773923
  error estimate for blocks of size 2^( 3) =       0.000420042684
  error estimate for blocks of size 2^( 4) =       0.000435665113
  error estimate for blocks of size 2^( 5) =       0.000447982257
  error estimate for blocks of size 2^( 6) =       0.000455540824
  error estimate for blocks of size 2^( 7) =       0.000460739509

      target function =      -0.916277589636
              le_mean =     -16.898382521925
             les_mean =     285.852941460754
             stat err =       0.000449981926
             autocorr =       1.360733188522
   target nu stat err =       0.000449981926
   target dn stat err =       0.004025697220
      target stat err =       0.006108399498
              std dev =       0.545536206182
             le_variance =       0.297609752256


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.689838252193e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 3.9062e+27, overlap shift 3.9062e+28 and omega -1.7456e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.916316396456       residual = 9.66e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.916316396456       residual = 9.66e-04           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.9062e+27 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 1.5625e+28, overlap shift 1.5625e+29 and omega -1.7456e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.916316396456       residual = 9.66e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.916316396456       residual = 9.66e-04           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.5625e+28 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 6.2500e+28, overlap shift 6.2500e+29 and omega -1.7456e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.916316396456       residual = 9.66e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.916316396456       residual = 9.66e-04           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 6.2500e+28 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               1.475241 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.7682e+01
  </log>
  <optVariables href="H2O.s046.opt.xml">
 uu_0                 2.517233e-01 1 1  ON 0
 uu_1                 1.009440e-01 1 1  ON 1
 uu_2                 1.617079e-02 1 1  ON 2
 uu_3                -3.223684e-02 1 1  ON 3
 uu_4                -6.387117e-02 1 1  ON 4
 uu_5                -8.576607e-02 1 1  ON 5
 uu_6                -1.001312e-01 1 1  ON 6
 uu_7                -1.065673e-01 1 1  ON 7
 uu_8                -9.668739e-02 1 1  ON 8
 uu_9                -6.389513e-02 1 1  ON 9
 ud_0                 3.492134e-01 1 1  ON 10
 ud_1                 1.235409e-01 1 1  ON 11
 ud_2                 2.392782e-02 1 1  ON 12
 ud_3                -3.019578e-02 1 1  ON 13
 ud_4                -6.975615e-02 1 1  ON 14
 ud_5                -9.484122e-02 1 1  ON 15
 ud_6                -1.085598e-01 1 1  ON 16
 ud_7                -1.109505e-01 1 1  ON 17
 ud_8                -9.792103e-02 1 1  ON 18
 ud_9                -6.281979e-02 1 1  ON 19
 eO_0                -5.692885e-01 1 1  ON 20
 eO_1                -3.060844e-01 1 1  ON 21
 eO_2                 4.730127e-02 1 1  ON 22
 eO_3                 2.840620e-01 1 1  ON 23
 eO_4                 3.913445e-01 1 1  ON 24
 eO_5                 3.212389e-01 1 1  ON 25
 eO_6                 1.205694e-01 1 1  ON 26
 eO_7                -7.888705e-02 1 1  ON 27
 eO_8                -1.549102e-01 1 1  ON 28
 eO_9                -6.122098e-02 1 1  ON 29
eH1_0                -2.277697e-01 1 1  ON 30
eH1_1                -1.106400e-01 1 1  ON 31
eH1_2                -6.162952e-02 1 1  ON 32
eH1_3                -2.530653e-02 1 1  ON 33
eH1_4                 4.247832e-03 1 1  ON 34
eH1_5                 2.367079e-02 1 1  ON 35
eH1_6                 6.569443e-02 1 1  ON 36
eH1_7                 1.154361e-01 1 1  ON 37
eH1_8                 1.435221e-01 1 1  ON 38
eH1_9                 7.467419e-02 1 1  ON 39
eH2_0                -2.307043e-01 1 1  ON 40
eH2_1                -1.139386e-01 1 1  ON 41
eH2_2                -6.444539e-02 1 1  ON 42
eH2_3                -2.722663e-02 1 1  ON 43
eH2_4                 1.073593e-03 1 1  ON 44
eH2_5                 2.532957e-02 1 1  ON 45
eH2_6                 7.564477e-02 1 1  ON 46
eH2_7                 1.260027e-01 1 1  ON 47
eH2_8                 1.609124e-01 1 1  ON 48
eH2_9                 6.417217e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 46
    time step          = 0.05
    reference energy   = -16.9591
    reference variance = 0.211732
====================================================
  Execution time = 2.0533e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s046
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6898e+01
  VMC Evar = 3.0221e-01
  Total weights = 2.0000e+06
  Execution time = 1.8770e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.302238178885
                                         uncertainty =       0.005305891001

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.302238178885
                                         uncertainty =       0.005305891001

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000388719717
  error estimate for blocks of size 2^( 2) =       0.000405572695
  error estimate for blocks of size 2^( 3) =       0.000423426581
  error estimate for blocks of size 2^( 4) =       0.000438890675
  error estimate for blocks of size 2^( 5) =       0.000450980308
  error estimate for blocks of size 2^( 6) =       0.000459706832
  error estimate for blocks of size 2^( 7) =       0.000463119998

      target function =      -0.909371420067
              le_mean =     -16.898166113329
             les_mean =     285.850223879786
             stat err =       0.000453174453
             autocorr =       1.359119669974
   target nu stat err =       0.000453174453
   target dn stat err =       0.005357858238
      target stat err =       0.007980215447
              std dev =       0.549732696158
             le_variance =       0.302206037225

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.302238178885
                                         uncertainty =       0.005305891001

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.302238178885
                                         uncertainty =       0.005305891001

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000388719717
  error estimate for blocks of size 2^( 2) =       0.000405572695
  error estimate for blocks of size 2^( 3) =       0.000423426581
  error estimate for blocks of size 2^( 4) =       0.000438890675
  error estimate for blocks of size 2^( 5) =       0.000450980308
  error estimate for blocks of size 2^( 6) =       0.000459706832
  error estimate for blocks of size 2^( 7) =       0.000463119998

      target function =      -0.909371420067
              le_mean =     -16.898166113329
             les_mean =     285.850223879786
             stat err =       0.000453174453
             autocorr =       1.359119669974
   target nu stat err =       0.000453174453
   target dn stat err =       0.005357858238
      target stat err =       0.007980215447
              std dev =       0.549732696158
             le_variance =       0.302206037225

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.302238178885
                                         uncertainty =       0.005305891001

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.302238178885
                                         uncertainty =       0.005305891001

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000388719717
  error estimate for blocks of size 2^( 2) =       0.000405572695
  error estimate for blocks of size 2^( 3) =       0.000423426581
  error estimate for blocks of size 2^( 4) =       0.000438890675
  error estimate for blocks of size 2^( 5) =       0.000450980308
  error estimate for blocks of size 2^( 6) =       0.000459706832
  error estimate for blocks of size 2^( 7) =       0.000463119998

      target function =      -0.909371420067
              le_mean =     -16.898166113329
             les_mean =     285.850223879786
             stat err =       0.000453174453
             autocorr =       1.359119669974
   target nu stat err =       0.000453174453
   target dn stat err =       0.005357858238
      target stat err =       0.007980215447
              std dev =       0.549732696158
             le_variance =       0.302206037225

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.302238178885
                                         uncertainty =       0.005305891001

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.302238178885
                                         uncertainty =       0.005305891001

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000388719717
  error estimate for blocks of size 2^( 2) =       0.000405572695
  error estimate for blocks of size 2^( 3) =       0.000423426581
  error estimate for blocks of size 2^( 4) =       0.000438890675
  error estimate for blocks of size 2^( 5) =       0.000450980308
  error estimate for blocks of size 2^( 6) =       0.000459706832
  error estimate for blocks of size 2^( 7) =       0.000463119998

      target function =      -0.909371420067
              le_mean =     -16.898166113329
             les_mean =     285.850223879786
             stat err =       0.000453174453
             autocorr =       1.359119669974
   target nu stat err =       0.000453174453
   target dn stat err =       0.005357858238
      target stat err =       0.007980215447
              std dev =       0.549732696158
             le_variance =       0.302206037225


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.909371420067        initial  <--
     3.9062e+27     3.9062e+28             0.0000e+00        -0.909371420067
     1.5625e+28     1.5625e+29             0.0000e+00        -0.909371420067
     6.2500e+28     6.2500e+29             0.0000e+00        -0.909371420067

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 30.0083
  </log>
  <optVariables href="H2O.s046.opt.xml">
 uu_0                 2.517233e-01 1 1  ON 0
 uu_1                 1.009440e-01 1 1  ON 1
 uu_2                 1.617079e-02 1 1  ON 2
 uu_3                -3.223684e-02 1 1  ON 3
 uu_4                -6.387117e-02 1 1  ON 4
 uu_5                -8.576607e-02 1 1  ON 5
 uu_6                -1.001312e-01 1 1  ON 6
 uu_7                -1.065673e-01 1 1  ON 7
 uu_8                -9.668739e-02 1 1  ON 8
 uu_9                -6.389513e-02 1 1  ON 9
 ud_0                 3.492134e-01 1 1  ON 10
 ud_1                 1.235409e-01 1 1  ON 11
 ud_2                 2.392782e-02 1 1  ON 12
 ud_3                -3.019578e-02 1 1  ON 13
 ud_4                -6.975615e-02 1 1  ON 14
 ud_5                -9.484122e-02 1 1  ON 15
 ud_6                -1.085598e-01 1 1  ON 16
 ud_7                -1.109505e-01 1 1  ON 17
 ud_8                -9.792103e-02 1 1  ON 18
 ud_9                -6.281979e-02 1 1  ON 19
 eO_0                -5.692885e-01 1 1  ON 20
 eO_1                -3.060844e-01 1 1  ON 21
 eO_2                 4.730127e-02 1 1  ON 22
 eO_3                 2.840620e-01 1 1  ON 23
 eO_4                 3.913445e-01 1 1  ON 24
 eO_5                 3.212389e-01 1 1  ON 25
 eO_6                 1.205694e-01 1 1  ON 26
 eO_7                -7.888705e-02 1 1  ON 27
 eO_8                -1.549102e-01 1 1  ON 28
 eO_9                -6.122098e-02 1 1  ON 29
eH1_0                -2.277697e-01 1 1  ON 30
eH1_1                -1.106400e-01 1 1  ON 31
eH1_2                -6.162952e-02 1 1  ON 32
eH1_3                -2.530653e-02 1 1  ON 33
eH1_4                 4.247832e-03 1 1  ON 34
eH1_5                 2.367079e-02 1 1  ON 35
eH1_6                 6.569443e-02 1 1  ON 36
eH1_7                 1.154361e-01 1 1  ON 37
eH1_8                 1.435221e-01 1 1  ON 38
eH1_9                 7.467419e-02 1 1  ON 39
eH2_0                -2.307043e-01 1 1  ON 40
eH2_1                -1.139386e-01 1 1  ON 41
eH2_2                -6.444539e-02 1 1  ON 42
eH2_3                -2.722663e-02 1 1  ON 43
eH2_4                 1.073593e-03 1 1  ON 44
eH2_5                 2.532957e-02 1 1  ON 45
eH2_6                 7.564477e-02 1 1  ON 46
eH2_7                 1.260027e-01 1 1  ON 47
eH2_8                 1.609124e-01 1 1  ON 48
eH2_9                 6.417217e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.7696e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s047 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s047 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=47  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6901e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 47
    time step          = 0.05
    reference energy   = -16.9294
    reference variance = 0.291008
====================================================
  Execution time = 2.0674e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s047
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6898e+01
  VMC Evar = 2.9790e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.4729e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.297854637364
                                         uncertainty =       0.003467924236

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.297854637364
                                         uncertainty =       0.003467924236

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000385943529
  error estimate for blocks of size 2^( 2) =       0.000402975624
  error estimate for blocks of size 2^( 3) =       0.000420951376
  error estimate for blocks of size 2^( 4) =       0.000436504109
  error estimate for blocks of size 2^( 5) =       0.000449430920
  error estimate for blocks of size 2^( 6) =       0.000458773896
  error estimate for blocks of size 2^( 7) =       0.000465187698

      target function =      -0.915813304357
              le_mean =     -16.897597152409
             les_mean =     285.826694191934
             stat err =       0.000452474156
             autocorr =       1.374485075066
   target nu stat err =       0.000452474156
   target dn stat err =       0.003584793571
      target stat err =       0.005437175639
              std dev =       0.545806573611
             le_variance =       0.297904815797


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.689759715241e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 3.9062e+28, overlap shift 3.9062e+29 and omega -1.7456e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.915844087505       residual = 2.68e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.915844087505       residual = 2.68e-03           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.9062e+28 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 1.5625e+29, overlap shift 1.5625e+30 and omega -1.7456e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.915844087505       residual = 2.68e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.915844087505       residual = 2.68e-03           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.5625e+29 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 6.2500e+29, overlap shift 6.2500e+30 and omega -1.7456e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.915844087505       residual = 2.68e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.915844087505       residual = 2.68e-03           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 6.2500e+29 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               1.476374 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.6153e+01
  </log>
  <optVariables href="H2O.s047.opt.xml">
 uu_0                 2.517233e-01 1 1  ON 0
 uu_1                 1.009440e-01 1 1  ON 1
 uu_2                 1.617079e-02 1 1  ON 2
 uu_3                -3.223684e-02 1 1  ON 3
 uu_4                -6.387117e-02 1 1  ON 4
 uu_5                -8.576607e-02 1 1  ON 5
 uu_6                -1.001312e-01 1 1  ON 6
 uu_7                -1.065673e-01 1 1  ON 7
 uu_8                -9.668739e-02 1 1  ON 8
 uu_9                -6.389513e-02 1 1  ON 9
 ud_0                 3.492134e-01 1 1  ON 10
 ud_1                 1.235409e-01 1 1  ON 11
 ud_2                 2.392782e-02 1 1  ON 12
 ud_3                -3.019578e-02 1 1  ON 13
 ud_4                -6.975615e-02 1 1  ON 14
 ud_5                -9.484122e-02 1 1  ON 15
 ud_6                -1.085598e-01 1 1  ON 16
 ud_7                -1.109505e-01 1 1  ON 17
 ud_8                -9.792103e-02 1 1  ON 18
 ud_9                -6.281979e-02 1 1  ON 19
 eO_0                -5.692885e-01 1 1  ON 20
 eO_1                -3.060844e-01 1 1  ON 21
 eO_2                 4.730127e-02 1 1  ON 22
 eO_3                 2.840620e-01 1 1  ON 23
 eO_4                 3.913445e-01 1 1  ON 24
 eO_5                 3.212389e-01 1 1  ON 25
 eO_6                 1.205694e-01 1 1  ON 26
 eO_7                -7.888705e-02 1 1  ON 27
 eO_8                -1.549102e-01 1 1  ON 28
 eO_9                -6.122098e-02 1 1  ON 29
eH1_0                -2.277697e-01 1 1  ON 30
eH1_1                -1.106400e-01 1 1  ON 31
eH1_2                -6.162952e-02 1 1  ON 32
eH1_3                -2.530653e-02 1 1  ON 33
eH1_4                 4.247832e-03 1 1  ON 34
eH1_5                 2.367079e-02 1 1  ON 35
eH1_6                 6.569443e-02 1 1  ON 36
eH1_7                 1.154361e-01 1 1  ON 37
eH1_8                 1.435221e-01 1 1  ON 38
eH1_9                 7.467419e-02 1 1  ON 39
eH2_0                -2.307043e-01 1 1  ON 40
eH2_1                -1.139386e-01 1 1  ON 41
eH2_2                -6.444539e-02 1 1  ON 42
eH2_3                -2.722663e-02 1 1  ON 43
eH2_4                 1.073593e-03 1 1  ON 44
eH2_5                 2.532957e-02 1 1  ON 45
eH2_6                 7.564477e-02 1 1  ON 46
eH2_7                 1.260027e-01 1 1  ON 47
eH2_8                 1.609124e-01 1 1  ON 48
eH2_9                 6.417217e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 47
    time step          = 0.05
    reference energy   = -16.9286
    reference variance = 0.180828
====================================================
  Execution time = 2.0322e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s047
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6898e+01
  VMC Evar = 2.9944e-01
  Total weights = 2.0000e+06
  Execution time = 1.8808e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.299534990581
                                         uncertainty =       0.005310207375

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.299534990581
                                         uncertainty =       0.005310207375

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000386938995
  error estimate for blocks of size 2^( 2) =       0.000403814263
  error estimate for blocks of size 2^( 3) =       0.000421610666
  error estimate for blocks of size 2^( 4) =       0.000437118226
  error estimate for blocks of size 2^( 5) =       0.000448750656
  error estimate for blocks of size 2^( 6) =       0.000456464460
  error estimate for blocks of size 2^( 7) =       0.000459650195

      target function =      -0.913493594509
              le_mean =     -16.898494222198
             les_mean =     285.858550400037
             stat err =       0.000450495884
             autocorr =       1.355491054212
   target nu stat err =       0.000450495884
   target dn stat err =       0.005468034812
      target stat err =       0.008221080525
              std dev =       0.547214374900
             le_variance =       0.299443572097

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.299534990581
                                         uncertainty =       0.005310207375

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.299534990581
                                         uncertainty =       0.005310207375

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000386938995
  error estimate for blocks of size 2^( 2) =       0.000403814263
  error estimate for blocks of size 2^( 3) =       0.000421610666
  error estimate for blocks of size 2^( 4) =       0.000437118226
  error estimate for blocks of size 2^( 5) =       0.000448750656
  error estimate for blocks of size 2^( 6) =       0.000456464460
  error estimate for blocks of size 2^( 7) =       0.000459650195

      target function =      -0.913493594509
              le_mean =     -16.898494222198
             les_mean =     285.858550400037
             stat err =       0.000450495884
             autocorr =       1.355491054212
   target nu stat err =       0.000450495884
   target dn stat err =       0.005468034812
      target stat err =       0.008221080525
              std dev =       0.547214374900
             le_variance =       0.299443572097

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.299534990581
                                         uncertainty =       0.005310207375

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.299534990581
                                         uncertainty =       0.005310207375

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000386938995
  error estimate for blocks of size 2^( 2) =       0.000403814263
  error estimate for blocks of size 2^( 3) =       0.000421610666
  error estimate for blocks of size 2^( 4) =       0.000437118226
  error estimate for blocks of size 2^( 5) =       0.000448750656
  error estimate for blocks of size 2^( 6) =       0.000456464460
  error estimate for blocks of size 2^( 7) =       0.000459650195

      target function =      -0.913493594509
              le_mean =     -16.898494222198
             les_mean =     285.858550400037
             stat err =       0.000450495884
             autocorr =       1.355491054212
   target nu stat err =       0.000450495884
   target dn stat err =       0.005468034812
      target stat err =       0.008221080525
              std dev =       0.547214374900
             le_variance =       0.299443572097

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.299534990581
                                         uncertainty =       0.005310207375

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.299534990581
                                         uncertainty =       0.005310207375

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000386938995
  error estimate for blocks of size 2^( 2) =       0.000403814263
  error estimate for blocks of size 2^( 3) =       0.000421610666
  error estimate for blocks of size 2^( 4) =       0.000437118226
  error estimate for blocks of size 2^( 5) =       0.000448750656
  error estimate for blocks of size 2^( 6) =       0.000456464460
  error estimate for blocks of size 2^( 7) =       0.000459650195

      target function =      -0.913493594509
              le_mean =     -16.898494222198
             les_mean =     285.858550400037
             stat err =       0.000450495884
             autocorr =       1.355491054212
   target nu stat err =       0.000450495884
   target dn stat err =       0.005468034812
      target stat err =       0.008221080525
              std dev =       0.547214374900
             le_variance =       0.299443572097


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.913493594509        initial  <--
     3.9062e+28     3.9062e+29             0.0000e+00        -0.913493594509
     1.5625e+29     1.5625e+30             0.0000e+00        -0.913493594509
     6.2500e+29     6.2500e+30             0.0000e+00        -0.913493594509

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 29.8167
  </log>
  <optVariables href="H2O.s047.opt.xml">
 uu_0                 2.517233e-01 1 1  ON 0
 uu_1                 1.009440e-01 1 1  ON 1
 uu_2                 1.617079e-02 1 1  ON 2
 uu_3                -3.223684e-02 1 1  ON 3
 uu_4                -6.387117e-02 1 1  ON 4
 uu_5                -8.576607e-02 1 1  ON 5
 uu_6                -1.001312e-01 1 1  ON 6
 uu_7                -1.065673e-01 1 1  ON 7
 uu_8                -9.668739e-02 1 1  ON 8
 uu_9                -6.389513e-02 1 1  ON 9
 ud_0                 3.492134e-01 1 1  ON 10
 ud_1                 1.235409e-01 1 1  ON 11
 ud_2                 2.392782e-02 1 1  ON 12
 ud_3                -3.019578e-02 1 1  ON 13
 ud_4                -6.975615e-02 1 1  ON 14
 ud_5                -9.484122e-02 1 1  ON 15
 ud_6                -1.085598e-01 1 1  ON 16
 ud_7                -1.109505e-01 1 1  ON 17
 ud_8                -9.792103e-02 1 1  ON 18
 ud_9                -6.281979e-02 1 1  ON 19
 eO_0                -5.692885e-01 1 1  ON 20
 eO_1                -3.060844e-01 1 1  ON 21
 eO_2                 4.730127e-02 1 1  ON 22
 eO_3                 2.840620e-01 1 1  ON 23
 eO_4                 3.913445e-01 1 1  ON 24
 eO_5                 3.212389e-01 1 1  ON 25
 eO_6                 1.205694e-01 1 1  ON 26
 eO_7                -7.888705e-02 1 1  ON 27
 eO_8                -1.549102e-01 1 1  ON 28
 eO_9                -6.122098e-02 1 1  ON 29
eH1_0                -2.277697e-01 1 1  ON 30
eH1_1                -1.106400e-01 1 1  ON 31
eH1_2                -6.162952e-02 1 1  ON 32
eH1_3                -2.530653e-02 1 1  ON 33
eH1_4                 4.247832e-03 1 1  ON 34
eH1_5                 2.367079e-02 1 1  ON 35
eH1_6                 6.569443e-02 1 1  ON 36
eH1_7                 1.154361e-01 1 1  ON 37
eH1_8                 1.435221e-01 1 1  ON 38
eH1_9                 7.467419e-02 1 1  ON 39
eH2_0                -2.307043e-01 1 1  ON 40
eH2_1                -1.139386e-01 1 1  ON 41
eH2_2                -6.444539e-02 1 1  ON 42
eH2_3                -2.722663e-02 1 1  ON 43
eH2_4                 1.073593e-03 1 1  ON 44
eH2_5                 2.532957e-02 1 1  ON 45
eH2_6                 7.564477e-02 1 1  ON 46
eH2_7                 1.260027e-01 1 1  ON 47
eH2_8                 1.609124e-01 1 1  ON 48
eH2_9                 6.417217e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.5976e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s048 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s048 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=48  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6902e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 48
    time step          = 0.05
    reference energy   = -16.934
    reference variance = 0.260773
====================================================
  Execution time = 2.0747e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s048
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6898e+01
  VMC Evar = 2.9519e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.6588e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.295181889259
                                         uncertainty =       0.002463387564

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.295181889259
                                         uncertainty =       0.002463387564

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000384181450
  error estimate for blocks of size 2^( 2) =       0.000400992384
  error estimate for blocks of size 2^( 3) =       0.000418858270
  error estimate for blocks of size 2^( 4) =       0.000434768436
  error estimate for blocks of size 2^( 5) =       0.000446710490
  error estimate for blocks of size 2^( 6) =       0.000454758818
  error estimate for blocks of size 2^( 7) =       0.000457398021

      target function =      -0.919944926078
              le_mean =     -16.898078918843
             les_mean =     285.840261772375
             stat err =       0.000448408941
             autocorr =       1.362309376768
   target nu stat err =       0.000448408941
   target dn stat err =       0.002651868434
      target stat err =       0.004091364429
              std dev =       0.543314616534
             le_variance =       0.295190772539


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.689807891884e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 3.9062e+29, overlap shift 3.9062e+30 and omega -1.7456e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.919961545420       residual = 1.24e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.919961545420       residual = 3.64e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.919961545420       residual = 9.50e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.919961545420       residual = 6.76e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.919961545616       residual = 1.01e+00           smallest_sin_value = 1.00e+00
davidson iteration    5 stopping due to too large eigenvalue change
davidson solver did not converge after          5 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.9062e+29 is 3.032136e-34

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 1.5625e+30, overlap shift 1.5625e+31 and omega -1.7456e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.919961545420       residual = 1.24e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.919961545420       residual = 3.64e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.919961545616       residual = 1.24e-03           smallest_sin_value = 1.00e+00
davidson iteration    3 stopping due to too large eigenvalue change
davidson solver did not converge after          3 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.5625e+30 is 2.724925e-35

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 6.2500e+30, overlap shift 6.2500e+31 and omega -1.7456e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.919961545420       residual = 1.24e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.919961545420       residual = 3.64e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.919961545616       residual = 1.24e-03           smallest_sin_value = 1.00e+00
davidson iteration    3 stopping due to too large eigenvalue change
davidson solver did not converge after          3 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 6.2500e+30 is 6.812313e-36

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               1.477929 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.6414e+01
  </log>
  <optVariables href="H2O.s048.opt.xml">
 uu_0                 2.517233e-01 1 1  ON 0
 uu_1                 1.009440e-01 1 1  ON 1
 uu_2                 1.617079e-02 1 1  ON 2
 uu_3                -3.223684e-02 1 1  ON 3
 uu_4                -6.387117e-02 1 1  ON 4
 uu_5                -8.576607e-02 1 1  ON 5
 uu_6                -1.001312e-01 1 1  ON 6
 uu_7                -1.065673e-01 1 1  ON 7
 uu_8                -9.668739e-02 1 1  ON 8
 uu_9                -6.389513e-02 1 1  ON 9
 ud_0                 3.492134e-01 1 1  ON 10
 ud_1                 1.235409e-01 1 1  ON 11
 ud_2                 2.392782e-02 1 1  ON 12
 ud_3                -3.019578e-02 1 1  ON 13
 ud_4                -6.975615e-02 1 1  ON 14
 ud_5                -9.484122e-02 1 1  ON 15
 ud_6                -1.085598e-01 1 1  ON 16
 ud_7                -1.109505e-01 1 1  ON 17
 ud_8                -9.792103e-02 1 1  ON 18
 ud_9                -6.281979e-02 1 1  ON 19
 eO_0                -5.692885e-01 1 1  ON 20
 eO_1                -3.060844e-01 1 1  ON 21
 eO_2                 4.730127e-02 1 1  ON 22
 eO_3                 2.840620e-01 1 1  ON 23
 eO_4                 3.913445e-01 1 1  ON 24
 eO_5                 3.212389e-01 1 1  ON 25
 eO_6                 1.205694e-01 1 1  ON 26
 eO_7                -7.888705e-02 1 1  ON 27
 eO_8                -1.549102e-01 1 1  ON 28
 eO_9                -6.122098e-02 1 1  ON 29
eH1_0                -2.277697e-01 1 1  ON 30
eH1_1                -1.106400e-01 1 1  ON 31
eH1_2                -6.162952e-02 1 1  ON 32
eH1_3                -2.530653e-02 1 1  ON 33
eH1_4                 4.247832e-03 1 1  ON 34
eH1_5                 2.367079e-02 1 1  ON 35
eH1_6                 6.569443e-02 1 1  ON 36
eH1_7                 1.154361e-01 1 1  ON 37
eH1_8                 1.435221e-01 1 1  ON 38
eH1_9                 7.467419e-02 1 1  ON 39
eH2_0                -2.307043e-01 1 1  ON 40
eH2_1                -1.139386e-01 1 1  ON 41
eH2_2                -6.444539e-02 1 1  ON 42
eH2_3                -2.722663e-02 1 1  ON 43
eH2_4                 1.073593e-03 1 1  ON 44
eH2_5                 2.532957e-02 1 1  ON 45
eH2_6                 7.564477e-02 1 1  ON 46
eH2_7                 1.260027e-01 1 1  ON 47
eH2_8                 1.609124e-01 1 1  ON 48
eH2_9                 6.417217e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 48
    time step          = 0.05
    reference energy   = -16.8818
    reference variance = 0.165154
====================================================
  Execution time = 2.2588e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s048
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6898e+01
  VMC Evar = 2.9160e-01
  Total weights = 2.0000e+06
  Execution time = 1.8827e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.291666699495
                                         uncertainty =       0.003709349391

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.291666699495
                                         uncertainty =       0.003709349391

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000381834989
  error estimate for blocks of size 2^( 2) =       0.000398677716
  error estimate for blocks of size 2^( 3) =       0.000416371433
  error estimate for blocks of size 2^( 4) =       0.000431331842
  error estimate for blocks of size 2^( 5) =       0.000441608973
  error estimate for blocks of size 2^( 6) =       0.000449655973
  error estimate for blocks of size 2^( 7) =       0.000454457337

      target function =      -0.925428050730
              le_mean =     -16.898210837526
             les_mean =     285.841125281719
             stat err =       0.000444263531
             autocorr =       1.353723236947
   target nu stat err =       0.000444263531
   target dn stat err =       0.003357493451
      target stat err =       0.005209314551
              std dev =       0.539996220376
             le_variance =       0.291595918020

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.291666699495
                                         uncertainty =       0.003709349391

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.291666699495
                                         uncertainty =       0.003709349391

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000381834989
  error estimate for blocks of size 2^( 2) =       0.000398677716
  error estimate for blocks of size 2^( 3) =       0.000416371433
  error estimate for blocks of size 2^( 4) =       0.000431331842
  error estimate for blocks of size 2^( 5) =       0.000441608973
  error estimate for blocks of size 2^( 6) =       0.000449655973
  error estimate for blocks of size 2^( 7) =       0.000454457337

      target function =      -0.925428050730
              le_mean =     -16.898210837526
             les_mean =     285.841125281719
             stat err =       0.000444263531
             autocorr =       1.353723236947
   target nu stat err =       0.000444263531
   target dn stat err =       0.003357493451
      target stat err =       0.005209314551
              std dev =       0.539996220376
             le_variance =       0.291595918020

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.291666699495
                                         uncertainty =       0.003709349391

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.291666699495
                                         uncertainty =       0.003709349391

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000381834989
  error estimate for blocks of size 2^( 2) =       0.000398677716
  error estimate for blocks of size 2^( 3) =       0.000416371433
  error estimate for blocks of size 2^( 4) =       0.000431331842
  error estimate for blocks of size 2^( 5) =       0.000441608973
  error estimate for blocks of size 2^( 6) =       0.000449655973
  error estimate for blocks of size 2^( 7) =       0.000454457337

      target function =      -0.925428050730
              le_mean =     -16.898210837526
             les_mean =     285.841125281719
             stat err =       0.000444263531
             autocorr =       1.353723236947
   target nu stat err =       0.000444263531
   target dn stat err =       0.003357493451
      target stat err =       0.005209314551
              std dev =       0.539996220376
             le_variance =       0.291595918020

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.291666699495
                                         uncertainty =       0.003709349391

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.291666699495
                                         uncertainty =       0.003709349391

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000381834989
  error estimate for blocks of size 2^( 2) =       0.000398677716
  error estimate for blocks of size 2^( 3) =       0.000416371433
  error estimate for blocks of size 2^( 4) =       0.000431331842
  error estimate for blocks of size 2^( 5) =       0.000441608973
  error estimate for blocks of size 2^( 6) =       0.000449655973
  error estimate for blocks of size 2^( 7) =       0.000454457337

      target function =      -0.925428050730
              le_mean =     -16.898210837526
             les_mean =     285.841125281719
             stat err =       0.000444263531
             autocorr =       1.353723236947
   target nu stat err =       0.000444263531
   target dn stat err =       0.003357493451
      target stat err =       0.005209314551
              std dev =       0.539996220376
             le_variance =       0.291595918020


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.925428050730        initial  <--
     3.9062e+29     3.9062e+30             3.0321e-34        -0.925428050730
     1.5625e+30     1.5625e+31             2.7249e-35        -0.925428050730
     6.2500e+30     6.2500e+31             6.8123e-36        -0.925428050730

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 32.0868
  </log>
  <optVariables href="H2O.s048.opt.xml">
 uu_0                 2.517233e-01 1 1  ON 0
 uu_1                 1.009440e-01 1 1  ON 1
 uu_2                 1.617079e-02 1 1  ON 2
 uu_3                -3.223684e-02 1 1  ON 3
 uu_4                -6.387117e-02 1 1  ON 4
 uu_5                -8.576607e-02 1 1  ON 5
 uu_6                -1.001312e-01 1 1  ON 6
 uu_7                -1.065673e-01 1 1  ON 7
 uu_8                -9.668739e-02 1 1  ON 8
 uu_9                -6.389513e-02 1 1  ON 9
 ud_0                 3.492134e-01 1 1  ON 10
 ud_1                 1.235409e-01 1 1  ON 11
 ud_2                 2.392782e-02 1 1  ON 12
 ud_3                -3.019578e-02 1 1  ON 13
 ud_4                -6.975615e-02 1 1  ON 14
 ud_5                -9.484122e-02 1 1  ON 15
 ud_6                -1.085598e-01 1 1  ON 16
 ud_7                -1.109505e-01 1 1  ON 17
 ud_8                -9.792103e-02 1 1  ON 18
 ud_9                -6.281979e-02 1 1  ON 19
 eO_0                -5.692885e-01 1 1  ON 20
 eO_1                -3.060844e-01 1 1  ON 21
 eO_2                 4.730127e-02 1 1  ON 22
 eO_3                 2.840620e-01 1 1  ON 23
 eO_4                 3.913445e-01 1 1  ON 24
 eO_5                 3.212389e-01 1 1  ON 25
 eO_6                 1.205694e-01 1 1  ON 26
 eO_7                -7.888705e-02 1 1  ON 27
 eO_8                -1.549102e-01 1 1  ON 28
 eO_9                -6.122098e-02 1 1  ON 29
eH1_0                -2.277697e-01 1 1  ON 30
eH1_1                -1.106400e-01 1 1  ON 31
eH1_2                -6.162952e-02 1 1  ON 32
eH1_3                -2.530653e-02 1 1  ON 33
eH1_4                 4.247832e-03 1 1  ON 34
eH1_5                 2.367079e-02 1 1  ON 35
eH1_6                 6.569443e-02 1 1  ON 36
eH1_7                 1.154361e-01 1 1  ON 37
eH1_8                 1.435221e-01 1 1  ON 38
eH1_9                 7.467419e-02 1 1  ON 39
eH2_0                -2.307043e-01 1 1  ON 40
eH2_1                -1.139386e-01 1 1  ON 41
eH2_2                -6.444539e-02 1 1  ON 42
eH2_3                -2.722663e-02 1 1  ON 43
eH2_4                 1.073593e-03 1 1  ON 44
eH2_5                 2.532957e-02 1 1  ON 45
eH2_6                 7.564477e-02 1 1  ON 46
eH2_7                 1.260027e-01 1 1  ON 47
eH2_8                 1.609124e-01 1 1  ON 48
eH2_9                 6.417217e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.8507e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s049 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s049 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=49  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6902e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 49
    time step          = 0.05
    reference energy   = -16.8857
    reference variance = 0.267761
====================================================
  Execution time = 2.0743e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s049
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6898e+01
  VMC Evar = 2.8906e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.5126e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.289130567384
                                         uncertainty =       0.001987928593

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.289130567384
                                         uncertainty =       0.001987928593

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000380172682
  error estimate for blocks of size 2^( 2) =       0.000397031420
  error estimate for blocks of size 2^( 3) =       0.000413848290
  error estimate for blocks of size 2^( 4) =       0.000429006510
  error estimate for blocks of size 2^( 5) =       0.000440428814
  error estimate for blocks of size 2^( 6) =       0.000449062101
  error estimate for blocks of size 2^( 7) =       0.000452361814

      target function =      -0.929360956555
              le_mean =     -16.898327321348
             les_mean =     285.842528651250
             stat err =       0.000442714810
             autocorr =       1.356083047714
   target nu stat err =       0.000442714810
   target dn stat err =       0.002039302298
      target stat err =       0.003244553037
              std dev =       0.537645362995
             le_variance =       0.289062536350


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.689832732135e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 3.9062e+30, overlap shift 3.9062e+31 and omega -1.7456e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.929370771368       residual = 8.26e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.929370771368       residual = 8.26e-04           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.9062e+30 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 1.5625e+31, overlap shift 1.5625e+32 and omega -1.7456e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.929370771368       residual = 8.26e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.929370771368       residual = 8.26e-04           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.5625e+31 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 6.2500e+31, overlap shift 6.2500e+32 and omega -1.7456e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.929370771368       residual = 8.26e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.929370771368       residual = 8.26e-04           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 6.2500e+31 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               1.479048 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.6262e+01
  </log>
  <optVariables href="H2O.s049.opt.xml">
 uu_0                 2.517233e-01 1 1  ON 0
 uu_1                 1.009440e-01 1 1  ON 1
 uu_2                 1.617079e-02 1 1  ON 2
 uu_3                -3.223684e-02 1 1  ON 3
 uu_4                -6.387117e-02 1 1  ON 4
 uu_5                -8.576607e-02 1 1  ON 5
 uu_6                -1.001312e-01 1 1  ON 6
 uu_7                -1.065673e-01 1 1  ON 7
 uu_8                -9.668739e-02 1 1  ON 8
 uu_9                -6.389513e-02 1 1  ON 9
 ud_0                 3.492134e-01 1 1  ON 10
 ud_1                 1.235409e-01 1 1  ON 11
 ud_2                 2.392782e-02 1 1  ON 12
 ud_3                -3.019578e-02 1 1  ON 13
 ud_4                -6.975615e-02 1 1  ON 14
 ud_5                -9.484122e-02 1 1  ON 15
 ud_6                -1.085598e-01 1 1  ON 16
 ud_7                -1.109505e-01 1 1  ON 17
 ud_8                -9.792103e-02 1 1  ON 18
 ud_9                -6.281979e-02 1 1  ON 19
 eO_0                -5.692885e-01 1 1  ON 20
 eO_1                -3.060844e-01 1 1  ON 21
 eO_2                 4.730127e-02 1 1  ON 22
 eO_3                 2.840620e-01 1 1  ON 23
 eO_4                 3.913445e-01 1 1  ON 24
 eO_5                 3.212389e-01 1 1  ON 25
 eO_6                 1.205694e-01 1 1  ON 26
 eO_7                -7.888705e-02 1 1  ON 27
 eO_8                -1.549102e-01 1 1  ON 28
 eO_9                -6.122098e-02 1 1  ON 29
eH1_0                -2.277697e-01 1 1  ON 30
eH1_1                -1.106400e-01 1 1  ON 31
eH1_2                -6.162952e-02 1 1  ON 32
eH1_3                -2.530653e-02 1 1  ON 33
eH1_4                 4.247832e-03 1 1  ON 34
eH1_5                 2.367079e-02 1 1  ON 35
eH1_6                 6.569443e-02 1 1  ON 36
eH1_7                 1.154361e-01 1 1  ON 37
eH1_8                 1.435221e-01 1 1  ON 38
eH1_9                 7.467419e-02 1 1  ON 39
eH2_0                -2.307043e-01 1 1  ON 40
eH2_1                -1.139386e-01 1 1  ON 41
eH2_2                -6.444539e-02 1 1  ON 42
eH2_3                -2.722663e-02 1 1  ON 43
eH2_4                 1.073593e-03 1 1  ON 44
eH2_5                 2.532957e-02 1 1  ON 45
eH2_6                 7.564477e-02 1 1  ON 46
eH2_7                 1.260027e-01 1 1  ON 47
eH2_8                 1.609124e-01 1 1  ON 48
eH2_9                 6.417217e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 49
    time step          = 0.05
    reference energy   = -16.8321
    reference variance = 0.415939
====================================================
  Execution time = 2.0927e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s049
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6897e+01
  VMC Evar = 2.9246e-01
  Total weights = 2.0000e+06
  Execution time = 1.8713e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.292040241388
                                         uncertainty =       0.002214988866

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.292040241388
                                         uncertainty =       0.002214988866

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000382397534
  error estimate for blocks of size 2^( 2) =       0.000399509832
  error estimate for blocks of size 2^( 3) =       0.000417117865
  error estimate for blocks of size 2^( 4) =       0.000432901672
  error estimate for blocks of size 2^( 5) =       0.000445419936
  error estimate for blocks of size 2^( 6) =       0.000453399038
  error estimate for blocks of size 2^( 7) =       0.000459685274

      target function =      -0.924085150856
              le_mean =     -16.897441831819
             les_mean =     285.815996061009
             stat err =       0.000447851480
             autocorr =       1.371632802005
   target nu stat err =       0.000447851480
   target dn stat err =       0.002271870379
      target stat err =       0.003552634887
              std dev =       0.540791778349
             le_variance =       0.292455747530

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.292040241388
                                         uncertainty =       0.002214988866

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.292040241388
                                         uncertainty =       0.002214988866

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000382397534
  error estimate for blocks of size 2^( 2) =       0.000399509832
  error estimate for blocks of size 2^( 3) =       0.000417117865
  error estimate for blocks of size 2^( 4) =       0.000432901672
  error estimate for blocks of size 2^( 5) =       0.000445419936
  error estimate for blocks of size 2^( 6) =       0.000453399038
  error estimate for blocks of size 2^( 7) =       0.000459685274

      target function =      -0.924085150856
              le_mean =     -16.897441831819
             les_mean =     285.815996061009
             stat err =       0.000447851480
             autocorr =       1.371632802005
   target nu stat err =       0.000447851480
   target dn stat err =       0.002271870379
      target stat err =       0.003552634887
              std dev =       0.540791778349
             le_variance =       0.292455747530

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.292040241388
                                         uncertainty =       0.002214988866

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.292040241388
                                         uncertainty =       0.002214988866

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000382397534
  error estimate for blocks of size 2^( 2) =       0.000399509832
  error estimate for blocks of size 2^( 3) =       0.000417117865
  error estimate for blocks of size 2^( 4) =       0.000432901672
  error estimate for blocks of size 2^( 5) =       0.000445419936
  error estimate for blocks of size 2^( 6) =       0.000453399038
  error estimate for blocks of size 2^( 7) =       0.000459685274

      target function =      -0.924085150856
              le_mean =     -16.897441831819
             les_mean =     285.815996061009
             stat err =       0.000447851480
             autocorr =       1.371632802005
   target nu stat err =       0.000447851480
   target dn stat err =       0.002271870379
      target stat err =       0.003552634887
              std dev =       0.540791778349
             le_variance =       0.292455747530

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.292040241388
                                         uncertainty =       0.002214988866

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.292040241388
                                         uncertainty =       0.002214988866

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000382397534
  error estimate for blocks of size 2^( 2) =       0.000399509832
  error estimate for blocks of size 2^( 3) =       0.000417117865
  error estimate for blocks of size 2^( 4) =       0.000432901672
  error estimate for blocks of size 2^( 5) =       0.000445419936
  error estimate for blocks of size 2^( 6) =       0.000453399038
  error estimate for blocks of size 2^( 7) =       0.000459685274

      target function =      -0.924085150856
              le_mean =     -16.897441831819
             les_mean =     285.815996061009
             stat err =       0.000447851480
             autocorr =       1.371632802005
   target nu stat err =       0.000447851480
   target dn stat err =       0.002271870379
      target stat err =       0.003552634887
              std dev =       0.540791778349
             le_variance =       0.292455747530


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.924085150856        initial  <--
     3.9062e+30     3.9062e+31             0.0000e+00        -0.924085150856
     1.5625e+31     1.5625e+32             0.0000e+00        -0.924085150856
     6.2500e+31     6.2500e+32             0.0000e+00        -0.924085150856

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 30.3885
  </log>
  <optVariables href="H2O.s049.opt.xml">
 uu_0                 2.517233e-01 1 1  ON 0
 uu_1                 1.009440e-01 1 1  ON 1
 uu_2                 1.617079e-02 1 1  ON 2
 uu_3                -3.223684e-02 1 1  ON 3
 uu_4                -6.387117e-02 1 1  ON 4
 uu_5                -8.576607e-02 1 1  ON 5
 uu_6                -1.001312e-01 1 1  ON 6
 uu_7                -1.065673e-01 1 1  ON 7
 uu_8                -9.668739e-02 1 1  ON 8
 uu_9                -6.389513e-02 1 1  ON 9
 ud_0                 3.492134e-01 1 1  ON 10
 ud_1                 1.235409e-01 1 1  ON 11
 ud_2                 2.392782e-02 1 1  ON 12
 ud_3                -3.019578e-02 1 1  ON 13
 ud_4                -6.975615e-02 1 1  ON 14
 ud_5                -9.484122e-02 1 1  ON 15
 ud_6                -1.085598e-01 1 1  ON 16
 ud_7                -1.109505e-01 1 1  ON 17
 ud_8                -9.792103e-02 1 1  ON 18
 ud_9                -6.281979e-02 1 1  ON 19
 eO_0                -5.692885e-01 1 1  ON 20
 eO_1                -3.060844e-01 1 1  ON 21
 eO_2                 4.730127e-02 1 1  ON 22
 eO_3                 2.840620e-01 1 1  ON 23
 eO_4                 3.913445e-01 1 1  ON 24
 eO_5                 3.212389e-01 1 1  ON 25
 eO_6                 1.205694e-01 1 1  ON 26
 eO_7                -7.888705e-02 1 1  ON 27
 eO_8                -1.549102e-01 1 1  ON 28
 eO_9                -6.122098e-02 1 1  ON 29
eH1_0                -2.277697e-01 1 1  ON 30
eH1_1                -1.106400e-01 1 1  ON 31
eH1_2                -6.162952e-02 1 1  ON 32
eH1_3                -2.530653e-02 1 1  ON 33
eH1_4                 4.247832e-03 1 1  ON 34
eH1_5                 2.367079e-02 1 1  ON 35
eH1_6                 6.569443e-02 1 1  ON 36
eH1_7                 1.154361e-01 1 1  ON 37
eH1_8                 1.435221e-01 1 1  ON 38
eH1_9                 7.467419e-02 1 1  ON 39
eH2_0                -2.307043e-01 1 1  ON 40
eH2_1                -1.139386e-01 1 1  ON 41
eH2_2                -6.444539e-02 1 1  ON 42
eH2_3                -2.722663e-02 1 1  ON 43
eH2_4                 1.073593e-03 1 1  ON 44
eH2_5                 2.532957e-02 1 1  ON 45
eH2_6                 7.564477e-02 1 1  ON 46
eH2_7                 1.260027e-01 1 1  ON 47
eH2_8                 1.609124e-01 1 1  ON 48
eH2_9                 6.417217e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.6657e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s050 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s050 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=50  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6901e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 50
    time step          = 0.05
    reference energy   = -16.8157
    reference variance = 0.279866
====================================================
  Execution time = 2.0742e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s050
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6897e+01
  VMC Evar = 2.9300e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.5105e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.293006684542
                                         uncertainty =       0.003116425569

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.293006684542
                                         uncertainty =       0.003116425569

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000382754618
  error estimate for blocks of size 2^( 2) =       0.000399707049
  error estimate for blocks of size 2^( 3) =       0.000417207960
  error estimate for blocks of size 2^( 4) =       0.000432525406
  error estimate for blocks of size 2^( 5) =       0.000444151073
  error estimate for blocks of size 2^( 6) =       0.000453713946
  error estimate for blocks of size 2^( 7) =       0.000459262540

      target function =      -0.923218792164
              le_mean =     -16.897049666881
             les_mean =     285.803289493960
             stat err =       0.000447413241
             autocorr =       1.366396645660
   target nu stat err =       0.000447413241
   target dn stat err =       0.003077310295
      target stat err =       0.004752040830
              std dev =       0.541296772047
             le_variance =       0.293002195429


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.689704966688e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 3.9062e+31, overlap shift 3.9062e+32 and omega -1.7456e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.923242106650       residual = 7.21e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.923242106650       residual = 3.62e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.923242106650       residual = 1.87e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.923242106650       residual = 1.11e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.923217773438       residual = 6.24e+06           smallest_sin_value = 1.00e+00
davidson iteration    5 stopping due to too large eigenvalue change
davidson solver did not converge after          5 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.9062e+31 is 2.617633e-36

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 1.5625e+32, overlap shift 1.5625e+33 and omega -1.7456e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.923242106650       residual = 7.21e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.923242106650       residual = 3.62e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.923242106650       residual = 1.87e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.923242106650       residual = 1.11e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.923242092133       residual = 7.20e+00           smallest_sin_value = 1.00e+00
davidson iteration    5 stopping due to too large eigenvalue change
davidson solver did not converge after          5 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.5625e+32 is 6.544083e-37

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 6.2500e+32, overlap shift 6.2500e+33 and omega -1.7456e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.923242106650       residual = 7.21e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.923242106650       residual = 3.62e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.923242106650       residual = 1.87e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.923242106650       residual = 1.11e-04           smallest_sin_value = 1.00e+00
davidson iteration    4 stopping due to too large eigenvalue change
davidson solver did not converge after          4 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 6.2500e+32 is 1.636021e-37

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               1.480886 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.6260e+01
  </log>
  <optVariables href="H2O.s050.opt.xml">
 uu_0                 2.517233e-01 1 1  ON 0
 uu_1                 1.009440e-01 1 1  ON 1
 uu_2                 1.617079e-02 1 1  ON 2
 uu_3                -3.223684e-02 1 1  ON 3
 uu_4                -6.387117e-02 1 1  ON 4
 uu_5                -8.576607e-02 1 1  ON 5
 uu_6                -1.001312e-01 1 1  ON 6
 uu_7                -1.065673e-01 1 1  ON 7
 uu_8                -9.668739e-02 1 1  ON 8
 uu_9                -6.389513e-02 1 1  ON 9
 ud_0                 3.492134e-01 1 1  ON 10
 ud_1                 1.235409e-01 1 1  ON 11
 ud_2                 2.392782e-02 1 1  ON 12
 ud_3                -3.019578e-02 1 1  ON 13
 ud_4                -6.975615e-02 1 1  ON 14
 ud_5                -9.484122e-02 1 1  ON 15
 ud_6                -1.085598e-01 1 1  ON 16
 ud_7                -1.109505e-01 1 1  ON 17
 ud_8                -9.792103e-02 1 1  ON 18
 ud_9                -6.281979e-02 1 1  ON 19
 eO_0                -5.692885e-01 1 1  ON 20
 eO_1                -3.060844e-01 1 1  ON 21
 eO_2                 4.730127e-02 1 1  ON 22
 eO_3                 2.840620e-01 1 1  ON 23
 eO_4                 3.913445e-01 1 1  ON 24
 eO_5                 3.212389e-01 1 1  ON 25
 eO_6                 1.205694e-01 1 1  ON 26
 eO_7                -7.888705e-02 1 1  ON 27
 eO_8                -1.549102e-01 1 1  ON 28
 eO_9                -6.122098e-02 1 1  ON 29
eH1_0                -2.277697e-01 1 1  ON 30
eH1_1                -1.106400e-01 1 1  ON 31
eH1_2                -6.162952e-02 1 1  ON 32
eH1_3                -2.530653e-02 1 1  ON 33
eH1_4                 4.247832e-03 1 1  ON 34
eH1_5                 2.367079e-02 1 1  ON 35
eH1_6                 6.569443e-02 1 1  ON 36
eH1_7                 1.154361e-01 1 1  ON 37
eH1_8                 1.435221e-01 1 1  ON 38
eH1_9                 7.467419e-02 1 1  ON 39
eH2_0                -2.307043e-01 1 1  ON 40
eH2_1                -1.139386e-01 1 1  ON 41
eH2_2                -6.444539e-02 1 1  ON 42
eH2_3                -2.722663e-02 1 1  ON 43
eH2_4                 1.073593e-03 1 1  ON 44
eH2_5                 2.532957e-02 1 1  ON 45
eH2_6                 7.564477e-02 1 1  ON 46
eH2_7                 1.260027e-01 1 1  ON 47
eH2_8                 1.609124e-01 1 1  ON 48
eH2_9                 6.417217e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 50
    time step          = 0.05
    reference energy   = -16.887
    reference variance = 0.181485
====================================================
  Execution time = 2.0322e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s050
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6898e+01
  VMC Evar = 2.9703e-01
  Total weights = 2.0000e+06
  Execution time = 1.8797e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.297124731724
                                         uncertainty =       0.004097802882

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.297124731724
                                         uncertainty =       0.004097802882

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000385378754
  error estimate for blocks of size 2^( 2) =       0.000402605397
  error estimate for blocks of size 2^( 3) =       0.000420529758
  error estimate for blocks of size 2^( 4) =       0.000436087354
  error estimate for blocks of size 2^( 5) =       0.000448103845
  error estimate for blocks of size 2^( 6) =       0.000456861402
  error estimate for blocks of size 2^( 7) =       0.000458344008

      target function =      -0.917129204176
              le_mean =     -16.898135774597
             les_mean =     285.844026075773
             stat err =       0.000449849152
             autocorr =       1.362568288128
   target nu stat err =       0.000449849152
   target dn stat err =       0.004381886310
      target stat err =       0.006650619043
              std dev =       0.545007860101
             le_variance =       0.297033567572

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.297124731724
                                         uncertainty =       0.004097802882

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.297124731724
                                         uncertainty =       0.004097802882

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000385378754
  error estimate for blocks of size 2^( 2) =       0.000402605397
  error estimate for blocks of size 2^( 3) =       0.000420529758
  error estimate for blocks of size 2^( 4) =       0.000436087354
  error estimate for blocks of size 2^( 5) =       0.000448103845
  error estimate for blocks of size 2^( 6) =       0.000456861402
  error estimate for blocks of size 2^( 7) =       0.000458344008

      target function =      -0.917129204176
              le_mean =     -16.898135774597
             les_mean =     285.844026075773
             stat err =       0.000449849152
             autocorr =       1.362568288131
   target nu stat err =       0.000449849152
   target dn stat err =       0.004381886310
      target stat err =       0.006650619043
              std dev =       0.545007860101
             le_variance =       0.297033567572

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.297124731724
                                         uncertainty =       0.004097802882

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.297124731724
                                         uncertainty =       0.004097802882

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000385378754
  error estimate for blocks of size 2^( 2) =       0.000402605397
  error estimate for blocks of size 2^( 3) =       0.000420529758
  error estimate for blocks of size 2^( 4) =       0.000436087354
  error estimate for blocks of size 2^( 5) =       0.000448103845
  error estimate for blocks of size 2^( 6) =       0.000456861402
  error estimate for blocks of size 2^( 7) =       0.000458344008

      target function =      -0.917129204176
              le_mean =     -16.898135774597
             les_mean =     285.844026075773
             stat err =       0.000449849152
             autocorr =       1.362568288131
   target nu stat err =       0.000449849152
   target dn stat err =       0.004381886310
      target stat err =       0.006650619043
              std dev =       0.545007860101
             le_variance =       0.297033567572

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.297124731724
                                         uncertainty =       0.004097802882

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.297124731724
                                         uncertainty =       0.004097802882

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000385378754
  error estimate for blocks of size 2^( 2) =       0.000402605397
  error estimate for blocks of size 2^( 3) =       0.000420529758
  error estimate for blocks of size 2^( 4) =       0.000436087354
  error estimate for blocks of size 2^( 5) =       0.000448103845
  error estimate for blocks of size 2^( 6) =       0.000456861402
  error estimate for blocks of size 2^( 7) =       0.000458344008

      target function =      -0.917129204176
              le_mean =     -16.898135774597
             les_mean =     285.844026075773
             stat err =       0.000449849152
             autocorr =       1.362568288131
   target nu stat err =       0.000449849152
   target dn stat err =       0.004381886310
      target stat err =       0.006650619043
              std dev =       0.545007860101
             le_variance =       0.297033567572


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.917129204176        initial  <--
     3.9062e+31     3.9062e+32             2.6176e-36        -0.917129204176
     1.5625e+32     1.5625e+33             6.5441e-37        -0.917129204176
     6.2500e+32     6.2500e+33             1.6360e-37        -0.917129204176

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 29.8245
  </log>
  <optVariables href="H2O.s050.opt.xml">
 uu_0                 2.517233e-01 1 1  ON 0
 uu_1                 1.009440e-01 1 1  ON 1
 uu_2                 1.617079e-02 1 1  ON 2
 uu_3                -3.223684e-02 1 1  ON 3
 uu_4                -6.387117e-02 1 1  ON 4
 uu_5                -8.576607e-02 1 1  ON 5
 uu_6                -1.001312e-01 1 1  ON 6
 uu_7                -1.065673e-01 1 1  ON 7
 uu_8                -9.668739e-02 1 1  ON 8
 uu_9                -6.389513e-02 1 1  ON 9
 ud_0                 3.492134e-01 1 1  ON 10
 ud_1                 1.235409e-01 1 1  ON 11
 ud_2                 2.392782e-02 1 1  ON 12
 ud_3                -3.019578e-02 1 1  ON 13
 ud_4                -6.975615e-02 1 1  ON 14
 ud_5                -9.484122e-02 1 1  ON 15
 ud_6                -1.085598e-01 1 1  ON 16
 ud_7                -1.109505e-01 1 1  ON 17
 ud_8                -9.792103e-02 1 1  ON 18
 ud_9                -6.281979e-02 1 1  ON 19
 eO_0                -5.692885e-01 1 1  ON 20
 eO_1                -3.060844e-01 1 1  ON 21
 eO_2                 4.730127e-02 1 1  ON 22
 eO_3                 2.840620e-01 1 1  ON 23
 eO_4                 3.913445e-01 1 1  ON 24
 eO_5                 3.212389e-01 1 1  ON 25
 eO_6                 1.205694e-01 1 1  ON 26
 eO_7                -7.888705e-02 1 1  ON 27
 eO_8                -1.549102e-01 1 1  ON 28
 eO_9                -6.122098e-02 1 1  ON 29
eH1_0                -2.277697e-01 1 1  ON 30
eH1_1                -1.106400e-01 1 1  ON 31
eH1_2                -6.162952e-02 1 1  ON 32
eH1_3                -2.530653e-02 1 1  ON 33
eH1_4                 4.247832e-03 1 1  ON 34
eH1_5                 2.367079e-02 1 1  ON 35
eH1_6                 6.569443e-02 1 1  ON 36
eH1_7                 1.154361e-01 1 1  ON 37
eH1_8                 1.435221e-01 1 1  ON 38
eH1_9                 7.467419e-02 1 1  ON 39
eH2_0                -2.307043e-01 1 1  ON 40
eH2_1                -1.139386e-01 1 1  ON 41
eH2_2                -6.444539e-02 1 1  ON 42
eH2_3                -2.722663e-02 1 1  ON 43
eH2_4                 1.073593e-03 1 1  ON 44
eH2_5                 2.532957e-02 1 1  ON 45
eH2_6                 7.564477e-02 1 1  ON 46
eH2_7                 1.260027e-01 1 1  ON 47
eH2_8                 1.609124e-01 1 1  ON 48
eH2_9                 6.417217e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.6091e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s051 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s051 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=51  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6900e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 51
    time step          = 0.05
    reference energy   = -16.9412
    reference variance = 0.269563
====================================================
  Execution time = 2.0987e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s051
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6898e+01
  VMC Evar = 2.9697e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.4930e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.296963138954
                                         uncertainty =       0.003508824040

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.296963138954
                                         uncertainty =       0.003508824040

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000385336337
  error estimate for blocks of size 2^( 2) =       0.000402468706
  error estimate for blocks of size 2^( 3) =       0.000419814618
  error estimate for blocks of size 2^( 4) =       0.000435182889
  error estimate for blocks of size 2^( 5) =       0.000445795139
  error estimate for blocks of size 2^( 6) =       0.000450610853
  error estimate for blocks of size 2^( 7) =       0.000456107210

      target function =      -0.917229080139
              le_mean =     -16.897909951954
             les_mean =     285.836328780627
             stat err =       0.000446924023
             autocorr =       1.345201892183
   target nu stat err =       0.000446924023
   target dn stat err =       0.003915151585
      target stat err =       0.005949729598
              std dev =       0.544947873449
             le_variance =       0.296968184777


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.689790995195e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 3.9062e+32, overlap shift 3.9062e+33 and omega -1.7456e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.917265842072       residual = 2.89e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.917265842072       residual = 2.89e-03           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.9062e+32 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 1.5625e+33, overlap shift 1.5625e+34 and omega -1.7456e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.917265842072       residual = 2.89e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.917265842072       residual = 2.89e-03           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.5625e+33 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 6.2500e+33, overlap shift 6.2500e+34 and omega -1.7456e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.917265842072       residual = 2.89e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.917265842072       residual = 2.89e-03           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 6.2500e+33 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               1.482026 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.6487e+01
  </log>
  <optVariables href="H2O.s051.opt.xml">
 uu_0                 2.517233e-01 1 1  ON 0
 uu_1                 1.009440e-01 1 1  ON 1
 uu_2                 1.617079e-02 1 1  ON 2
 uu_3                -3.223684e-02 1 1  ON 3
 uu_4                -6.387117e-02 1 1  ON 4
 uu_5                -8.576607e-02 1 1  ON 5
 uu_6                -1.001312e-01 1 1  ON 6
 uu_7                -1.065673e-01 1 1  ON 7
 uu_8                -9.668739e-02 1 1  ON 8
 uu_9                -6.389513e-02 1 1  ON 9
 ud_0                 3.492134e-01 1 1  ON 10
 ud_1                 1.235409e-01 1 1  ON 11
 ud_2                 2.392782e-02 1 1  ON 12
 ud_3                -3.019578e-02 1 1  ON 13
 ud_4                -6.975615e-02 1 1  ON 14
 ud_5                -9.484122e-02 1 1  ON 15
 ud_6                -1.085598e-01 1 1  ON 16
 ud_7                -1.109505e-01 1 1  ON 17
 ud_8                -9.792103e-02 1 1  ON 18
 ud_9                -6.281979e-02 1 1  ON 19
 eO_0                -5.692885e-01 1 1  ON 20
 eO_1                -3.060844e-01 1 1  ON 21
 eO_2                 4.730127e-02 1 1  ON 22
 eO_3                 2.840620e-01 1 1  ON 23
 eO_4                 3.913445e-01 1 1  ON 24
 eO_5                 3.212389e-01 1 1  ON 25
 eO_6                 1.205694e-01 1 1  ON 26
 eO_7                -7.888705e-02 1 1  ON 27
 eO_8                -1.549102e-01 1 1  ON 28
 eO_9                -6.122098e-02 1 1  ON 29
eH1_0                -2.277697e-01 1 1  ON 30
eH1_1                -1.106400e-01 1 1  ON 31
eH1_2                -6.162952e-02 1 1  ON 32
eH1_3                -2.530653e-02 1 1  ON 33
eH1_4                 4.247832e-03 1 1  ON 34
eH1_5                 2.367079e-02 1 1  ON 35
eH1_6                 6.569443e-02 1 1  ON 36
eH1_7                 1.154361e-01 1 1  ON 37
eH1_8                 1.435221e-01 1 1  ON 38
eH1_9                 7.467419e-02 1 1  ON 39
eH2_0                -2.307043e-01 1 1  ON 40
eH2_1                -1.139386e-01 1 1  ON 41
eH2_2                -6.444539e-02 1 1  ON 42
eH2_3                -2.722663e-02 1 1  ON 43
eH2_4                 1.073593e-03 1 1  ON 44
eH2_5                 2.532957e-02 1 1  ON 45
eH2_6                 7.564477e-02 1 1  ON 46
eH2_7                 1.260027e-01 1 1  ON 47
eH2_8                 1.609124e-01 1 1  ON 48
eH2_9                 6.417217e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 51
    time step          = 0.05
    reference energy   = -16.7394
    reference variance = 0.261228
====================================================
  Execution time = 2.2643e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s051
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6898e+01
  VMC Evar = 2.9661e-01
  Total weights = 2.0000e+06
  Execution time = 1.8822e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.296670210393
                                         uncertainty =       0.003049400377

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.296670210393
                                         uncertainty =       0.003049400377

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000385104149
  error estimate for blocks of size 2^( 2) =       0.000401983308
  error estimate for blocks of size 2^( 3) =       0.000419104927
  error estimate for blocks of size 2^( 4) =       0.000433558686
  error estimate for blocks of size 2^( 5) =       0.000444912138
  error estimate for blocks of size 2^( 6) =       0.000452710219
  error estimate for blocks of size 2^( 7) =       0.000456835023

      target function =      -0.917764445525
              le_mean =     -16.897535691738
             les_mean =     285.823322716161
             stat err =       0.000447004017
             autocorr =       1.347306659297
   target nu stat err =       0.000447004017
   target dn stat err =       0.003310881458
      target stat err =       0.005049105477
              std dev =       0.544619510204
             le_variance =       0.296610410895

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.296670210393
                                         uncertainty =       0.003049400377

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.296670210393
                                         uncertainty =       0.003049400377

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000385104149
  error estimate for blocks of size 2^( 2) =       0.000401983308
  error estimate for blocks of size 2^( 3) =       0.000419104927
  error estimate for blocks of size 2^( 4) =       0.000433558686
  error estimate for blocks of size 2^( 5) =       0.000444912138
  error estimate for blocks of size 2^( 6) =       0.000452710219
  error estimate for blocks of size 2^( 7) =       0.000456835023

      target function =      -0.917764445525
              le_mean =     -16.897535691738
             les_mean =     285.823322716161
             stat err =       0.000447004017
             autocorr =       1.347306659297
   target nu stat err =       0.000447004017
   target dn stat err =       0.003310881458
      target stat err =       0.005049105477
              std dev =       0.544619510204
             le_variance =       0.296610410895

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.296670210393
                                         uncertainty =       0.003049400377

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.296670210393
                                         uncertainty =       0.003049400377

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000385104149
  error estimate for blocks of size 2^( 2) =       0.000401983308
  error estimate for blocks of size 2^( 3) =       0.000419104927
  error estimate for blocks of size 2^( 4) =       0.000433558686
  error estimate for blocks of size 2^( 5) =       0.000444912138
  error estimate for blocks of size 2^( 6) =       0.000452710219
  error estimate for blocks of size 2^( 7) =       0.000456835023

      target function =      -0.917764445525
              le_mean =     -16.897535691738
             les_mean =     285.823322716161
             stat err =       0.000447004017
             autocorr =       1.347306659297
   target nu stat err =       0.000447004017
   target dn stat err =       0.003310881458
      target stat err =       0.005049105477
              std dev =       0.544619510204
             le_variance =       0.296610410895

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.296670210393
                                         uncertainty =       0.003049400377

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.296670210393
                                         uncertainty =       0.003049400377

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000385104149
  error estimate for blocks of size 2^( 2) =       0.000401983308
  error estimate for blocks of size 2^( 3) =       0.000419104927
  error estimate for blocks of size 2^( 4) =       0.000433558686
  error estimate for blocks of size 2^( 5) =       0.000444912138
  error estimate for blocks of size 2^( 6) =       0.000452710219
  error estimate for blocks of size 2^( 7) =       0.000456835023

      target function =      -0.917764445525
              le_mean =     -16.897535691738
             les_mean =     285.823322716161
             stat err =       0.000447004017
             autocorr =       1.347306659297
   target nu stat err =       0.000447004017
   target dn stat err =       0.003310881458
      target stat err =       0.005049105477
              std dev =       0.544619510204
             le_variance =       0.296610410895


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.917764445525        initial  <--
     3.9062e+32     3.9062e+33             0.0000e+00        -0.917764445525
     1.5625e+33     1.5625e+34             0.0000e+00        -0.917764445525
     6.2500e+33     6.2500e+34             0.0000e+00        -0.917764445525

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 32.1583
  </log>
  <optVariables href="H2O.s051.opt.xml">
 uu_0                 2.517233e-01 1 1  ON 0
 uu_1                 1.009440e-01 1 1  ON 1
 uu_2                 1.617079e-02 1 1  ON 2
 uu_3                -3.223684e-02 1 1  ON 3
 uu_4                -6.387117e-02 1 1  ON 4
 uu_5                -8.576607e-02 1 1  ON 5
 uu_6                -1.001312e-01 1 1  ON 6
 uu_7                -1.065673e-01 1 1  ON 7
 uu_8                -9.668739e-02 1 1  ON 8
 uu_9                -6.389513e-02 1 1  ON 9
 ud_0                 3.492134e-01 1 1  ON 10
 ud_1                 1.235409e-01 1 1  ON 11
 ud_2                 2.392782e-02 1 1  ON 12
 ud_3                -3.019578e-02 1 1  ON 13
 ud_4                -6.975615e-02 1 1  ON 14
 ud_5                -9.484122e-02 1 1  ON 15
 ud_6                -1.085598e-01 1 1  ON 16
 ud_7                -1.109505e-01 1 1  ON 17
 ud_8                -9.792103e-02 1 1  ON 18
 ud_9                -6.281979e-02 1 1  ON 19
 eO_0                -5.692885e-01 1 1  ON 20
 eO_1                -3.060844e-01 1 1  ON 21
 eO_2                 4.730127e-02 1 1  ON 22
 eO_3                 2.840620e-01 1 1  ON 23
 eO_4                 3.913445e-01 1 1  ON 24
 eO_5                 3.212389e-01 1 1  ON 25
 eO_6                 1.205694e-01 1 1  ON 26
 eO_7                -7.888705e-02 1 1  ON 27
 eO_8                -1.549102e-01 1 1  ON 28
 eO_9                -6.122098e-02 1 1  ON 29
eH1_0                -2.277697e-01 1 1  ON 30
eH1_1                -1.106400e-01 1 1  ON 31
eH1_2                -6.162952e-02 1 1  ON 32
eH1_3                -2.530653e-02 1 1  ON 33
eH1_4                 4.247832e-03 1 1  ON 34
eH1_5                 2.367079e-02 1 1  ON 35
eH1_6                 6.569443e-02 1 1  ON 36
eH1_7                 1.154361e-01 1 1  ON 37
eH1_8                 1.435221e-01 1 1  ON 38
eH1_9                 7.467419e-02 1 1  ON 39
eH2_0                -2.307043e-01 1 1  ON 40
eH2_1                -1.139386e-01 1 1  ON 41
eH2_2                -6.444539e-02 1 1  ON 42
eH2_3                -2.722663e-02 1 1  ON 43
eH2_4                 1.073593e-03 1 1  ON 44
eH2_5                 2.532957e-02 1 1  ON 45
eH2_6                 7.564477e-02 1 1  ON 46
eH2_7                 1.260027e-01 1 1  ON 47
eH2_8                 1.609124e-01 1 1  ON 48
eH2_9                 6.417217e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.8651e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s052 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s052 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=52  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6899e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 52
    time step          = 0.05
    reference energy   = -16.933
    reference variance = 0.246294
====================================================
  Execution time = 2.0791e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s052
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6898e+01
  VMC Evar = 2.9569e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.5157e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.295790664465
                                         uncertainty =       0.002897108830

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.295790664465
                                         uncertainty =       0.002897108830

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000384506087
  error estimate for blocks of size 2^( 2) =       0.000401543496
  error estimate for blocks of size 2^( 3) =       0.000418609459
  error estimate for blocks of size 2^( 4) =       0.000433961200
  error estimate for blocks of size 2^( 5) =       0.000445330883
  error estimate for blocks of size 2^( 6) =       0.000452465710
  error estimate for blocks of size 2^( 7) =       0.000456150313

      target function =      -0.919200455587
              le_mean =     -16.898448881531
             les_mean =     285.853264315814
             stat err =       0.000446977027
             autocorr =       1.351337925607
   target nu stat err =       0.000446977027
   target dn stat err =       0.002843463792
      target stat err =       0.004373152875
              std dev =       0.543773723111
             le_variance =       0.295689861946


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.689844888153e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 3.9062e+33, overlap shift 3.9062e+34 and omega -1.7456e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.919220094691       residual = 1.45e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.919220094691       residual = 8.56e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.919220089912       residual = 1.45e-03           smallest_sin_value = 1.00e+00
davidson iteration    3 stopping due to too large eigenvalue change
davidson solver did not converge after          3 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.9062e+33 is 1.451493e-38

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 1.5625e+34, overlap shift 1.5625e+35 and omega -1.7456e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.919220094691       residual = 1.45e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.919220094691       residual = 8.56e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.919220089912       residual = 1.45e-03           smallest_sin_value = 1.00e+00
davidson iteration    3 stopping due to too large eigenvalue change
davidson solver did not converge after          3 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.5625e+34 is 3.628731e-39

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 6.2500e+34, overlap shift 6.2500e+35 and omega -1.7456e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.919220094691       residual = 1.45e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.919220094691       residual = 8.56e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.919220089912       residual = 1.45e-03           smallest_sin_value = 1.00e+00
davidson iteration    3 stopping due to too large eigenvalue change
davidson solver did not converge after          3 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 6.2500e+34 is 9.071829e-40

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               1.483390 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.6314e+01
  </log>
  <optVariables href="H2O.s052.opt.xml">
 uu_0                 2.517233e-01 1 1  ON 0
 uu_1                 1.009440e-01 1 1  ON 1
 uu_2                 1.617079e-02 1 1  ON 2
 uu_3                -3.223684e-02 1 1  ON 3
 uu_4                -6.387117e-02 1 1  ON 4
 uu_5                -8.576607e-02 1 1  ON 5
 uu_6                -1.001312e-01 1 1  ON 6
 uu_7                -1.065673e-01 1 1  ON 7
 uu_8                -9.668739e-02 1 1  ON 8
 uu_9                -6.389513e-02 1 1  ON 9
 ud_0                 3.492134e-01 1 1  ON 10
 ud_1                 1.235409e-01 1 1  ON 11
 ud_2                 2.392782e-02 1 1  ON 12
 ud_3                -3.019578e-02 1 1  ON 13
 ud_4                -6.975615e-02 1 1  ON 14
 ud_5                -9.484122e-02 1 1  ON 15
 ud_6                -1.085598e-01 1 1  ON 16
 ud_7                -1.109505e-01 1 1  ON 17
 ud_8                -9.792103e-02 1 1  ON 18
 ud_9                -6.281979e-02 1 1  ON 19
 eO_0                -5.692885e-01 1 1  ON 20
 eO_1                -3.060844e-01 1 1  ON 21
 eO_2                 4.730127e-02 1 1  ON 22
 eO_3                 2.840620e-01 1 1  ON 23
 eO_4                 3.913445e-01 1 1  ON 24
 eO_5                 3.212389e-01 1 1  ON 25
 eO_6                 1.205694e-01 1 1  ON 26
 eO_7                -7.888705e-02 1 1  ON 27
 eO_8                -1.549102e-01 1 1  ON 28
 eO_9                -6.122098e-02 1 1  ON 29
eH1_0                -2.277697e-01 1 1  ON 30
eH1_1                -1.106400e-01 1 1  ON 31
eH1_2                -6.162952e-02 1 1  ON 32
eH1_3                -2.530653e-02 1 1  ON 33
eH1_4                 4.247832e-03 1 1  ON 34
eH1_5                 2.367079e-02 1 1  ON 35
eH1_6                 6.569443e-02 1 1  ON 36
eH1_7                 1.154361e-01 1 1  ON 37
eH1_8                 1.435221e-01 1 1  ON 38
eH1_9                 7.467419e-02 1 1  ON 39
eH2_0                -2.307043e-01 1 1  ON 40
eH2_1                -1.139386e-01 1 1  ON 41
eH2_2                -6.444539e-02 1 1  ON 42
eH2_3                -2.722663e-02 1 1  ON 43
eH2_4                 1.073593e-03 1 1  ON 44
eH2_5                 2.532957e-02 1 1  ON 45
eH2_6                 7.564477e-02 1 1  ON 46
eH2_7                 1.260027e-01 1 1  ON 47
eH2_8                 1.609124e-01 1 1  ON 48
eH2_9                 6.417217e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 52
    time step          = 0.05
    reference energy   = -16.8352
    reference variance = 0.294006
====================================================
  Execution time = 2.0332e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s052
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6897e+01
  VMC Evar = 3.0458e-01
  Total weights = 2.0000e+06
  Execution time = 1.8773e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.304509644005
                                         uncertainty =       0.010604618368

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.304509644005
                                         uncertainty =       0.010604618368

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000390246586
  error estimate for blocks of size 2^( 2) =       0.000406996830
  error estimate for blocks of size 2^( 3) =       0.000423894746
  error estimate for blocks of size 2^( 4) =       0.000439570965
  error estimate for blocks of size 2^( 5) =       0.000451728500
  error estimate for blocks of size 2^( 6) =       0.000460338862
  error estimate for blocks of size 2^( 7) =       0.000466724686

      target function =      -0.905627052144
              le_mean =     -16.897453710861
             les_mean =     285.828526553596
             stat err =       0.000454590753
             autocorr =       1.356947269016
   target nu stat err =       0.000454590753
   target dn stat err =       0.010933387679
      target stat err =       0.016081660469
              std dev =       0.551892014059
             le_variance =       0.304584795183

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.304509644005
                                         uncertainty =       0.010604618368

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.304509644005
                                         uncertainty =       0.010604618368

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000390246586
  error estimate for blocks of size 2^( 2) =       0.000406996830
  error estimate for blocks of size 2^( 3) =       0.000423894746
  error estimate for blocks of size 2^( 4) =       0.000439570965
  error estimate for blocks of size 2^( 5) =       0.000451728500
  error estimate for blocks of size 2^( 6) =       0.000460338862
  error estimate for blocks of size 2^( 7) =       0.000466724686

      target function =      -0.905627052144
              le_mean =     -16.897453710861
             les_mean =     285.828526553596
             stat err =       0.000454590753
             autocorr =       1.356947269016
   target nu stat err =       0.000454590753
   target dn stat err =       0.010933387679
      target stat err =       0.016081660469
              std dev =       0.551892014059
             le_variance =       0.304584795183

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.304509644005
                                         uncertainty =       0.010604618368

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.304509644005
                                         uncertainty =       0.010604618368

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000390246586
  error estimate for blocks of size 2^( 2) =       0.000406996830
  error estimate for blocks of size 2^( 3) =       0.000423894746
  error estimate for blocks of size 2^( 4) =       0.000439570965
  error estimate for blocks of size 2^( 5) =       0.000451728500
  error estimate for blocks of size 2^( 6) =       0.000460338862
  error estimate for blocks of size 2^( 7) =       0.000466724686

      target function =      -0.905627052144
              le_mean =     -16.897453710861
             les_mean =     285.828526553596
             stat err =       0.000454590753
             autocorr =       1.356947269016
   target nu stat err =       0.000454590753
   target dn stat err =       0.010933387679
      target stat err =       0.016081660469
              std dev =       0.551892014059
             le_variance =       0.304584795183

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.304509644005
                                         uncertainty =       0.010604618368

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.304509644005
                                         uncertainty =       0.010604618368

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000390246586
  error estimate for blocks of size 2^( 2) =       0.000406996830
  error estimate for blocks of size 2^( 3) =       0.000423894746
  error estimate for blocks of size 2^( 4) =       0.000439570965
  error estimate for blocks of size 2^( 5) =       0.000451728500
  error estimate for blocks of size 2^( 6) =       0.000460338862
  error estimate for blocks of size 2^( 7) =       0.000466724686

      target function =      -0.905627052144
              le_mean =     -16.897453710861
             les_mean =     285.828526553596
             stat err =       0.000454590753
             autocorr =       1.356947269016
   target nu stat err =       0.000454590753
   target dn stat err =       0.010933387679
      target stat err =       0.016081660469
              std dev =       0.551892014059
             le_variance =       0.304584795183


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.905627052144        initial  <--
     3.9062e+33     3.9062e+34             1.4515e-38        -0.905627052144
     1.5625e+34     1.5625e+35             3.6287e-39        -0.905627052144
     6.2500e+34     6.2500e+35             9.0718e-40        -0.905627052144

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 29.8273
  </log>
  <optVariables href="H2O.s052.opt.xml">
 uu_0                 2.517233e-01 1 1  ON 0
 uu_1                 1.009440e-01 1 1  ON 1
 uu_2                 1.617079e-02 1 1  ON 2
 uu_3                -3.223684e-02 1 1  ON 3
 uu_4                -6.387117e-02 1 1  ON 4
 uu_5                -8.576607e-02 1 1  ON 5
 uu_6                -1.001312e-01 1 1  ON 6
 uu_7                -1.065673e-01 1 1  ON 7
 uu_8                -9.668739e-02 1 1  ON 8
 uu_9                -6.389513e-02 1 1  ON 9
 ud_0                 3.492134e-01 1 1  ON 10
 ud_1                 1.235409e-01 1 1  ON 11
 ud_2                 2.392782e-02 1 1  ON 12
 ud_3                -3.019578e-02 1 1  ON 13
 ud_4                -6.975615e-02 1 1  ON 14
 ud_5                -9.484122e-02 1 1  ON 15
 ud_6                -1.085598e-01 1 1  ON 16
 ud_7                -1.109505e-01 1 1  ON 17
 ud_8                -9.792103e-02 1 1  ON 18
 ud_9                -6.281979e-02 1 1  ON 19
 eO_0                -5.692885e-01 1 1  ON 20
 eO_1                -3.060844e-01 1 1  ON 21
 eO_2                 4.730127e-02 1 1  ON 22
 eO_3                 2.840620e-01 1 1  ON 23
 eO_4                 3.913445e-01 1 1  ON 24
 eO_5                 3.212389e-01 1 1  ON 25
 eO_6                 1.205694e-01 1 1  ON 26
 eO_7                -7.888705e-02 1 1  ON 27
 eO_8                -1.549102e-01 1 1  ON 28
 eO_9                -6.122098e-02 1 1  ON 29
eH1_0                -2.277697e-01 1 1  ON 30
eH1_1                -1.106400e-01 1 1  ON 31
eH1_2                -6.162952e-02 1 1  ON 32
eH1_3                -2.530653e-02 1 1  ON 33
eH1_4                 4.247832e-03 1 1  ON 34
eH1_5                 2.367079e-02 1 1  ON 35
eH1_6                 6.569443e-02 1 1  ON 36
eH1_7                 1.154361e-01 1 1  ON 37
eH1_8                 1.435221e-01 1 1  ON 38
eH1_9                 7.467419e-02 1 1  ON 39
eH2_0                -2.307043e-01 1 1  ON 40
eH2_1                -1.139386e-01 1 1  ON 41
eH2_2                -6.444539e-02 1 1  ON 42
eH2_3                -2.722663e-02 1 1  ON 43
eH2_4                 1.073593e-03 1 1  ON 44
eH2_5                 2.532957e-02 1 1  ON 45
eH2_6                 7.564477e-02 1 1  ON 46
eH2_7                 1.260027e-01 1 1  ON 47
eH2_8                 1.609124e-01 1 1  ON 48
eH2_9                 6.417217e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.6147e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s053 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s053 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=53  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6899e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 53
    time step          = 0.05
    reference energy   = -16.9544
    reference variance = 0.23435
====================================================
  Execution time = 2.0696e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s053
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6898e+01
  VMC Evar = 2.9243e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.6238e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.292438408174
                                         uncertainty =       0.002323063002

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.292438408174
                                         uncertainty =       0.002323063002

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000382379689
  error estimate for blocks of size 2^( 2) =       0.000399248168
  error estimate for blocks of size 2^( 3) =       0.000417173795
  error estimate for blocks of size 2^( 4) =       0.000432343768
  error estimate for blocks of size 2^( 5) =       0.000444128131
  error estimate for blocks of size 2^( 6) =       0.000450577044
  error estimate for blocks of size 2^( 7) =       0.000455767890

      target function =      -0.924160657620
              le_mean =     -16.898132409456
             les_mean =     285.839307234244
             stat err =       0.000445704208
             autocorr =       1.358638252092
   target nu stat err =       0.000445704208
   target dn stat err =       0.002452880142
      target stat err =       0.003828474442
              std dev =       0.540766542001
             le_variance =       0.292428452948


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.689813240946e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 3.9062e+34, overlap shift 3.9062e+35 and omega -1.7456e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.924175095114       residual = 1.51e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.924175095114       residual = 1.16e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.924175095279       residual = 1.51e-03           smallest_sin_value = 1.00e+00
davidson iteration    3 stopping due to too large eigenvalue change
davidson solver did not converge after          3 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.9062e+34 is 2.314198e-39

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 1.5625e+35, overlap shift 1.5625e+36 and omega -1.7456e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.924175095114       residual = 1.51e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.924175095114       residual = 1.16e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.924175094813       residual = 1.51e-03           smallest_sin_value = 1.00e+00
davidson iteration    3 stopping due to too large eigenvalue change
davidson solver did not converge after          3 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.5625e+35 is 5.785495e-40

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 6.2500e+35, overlap shift 6.2500e+36 and omega -1.7456e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.924175095114       residual = 1.51e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.924175095114       residual = 1.16e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.924175094813       residual = 1.51e-03           smallest_sin_value = 1.00e+00
davidson iteration    3 stopping due to too large eigenvalue change
davidson solver did not converge after          3 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 6.2500e+35 is 1.446374e-40

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               1.484748 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.6327e+01
  </log>
  <optVariables href="H2O.s053.opt.xml">
 uu_0                 2.517233e-01 1 1  ON 0
 uu_1                 1.009440e-01 1 1  ON 1
 uu_2                 1.617079e-02 1 1  ON 2
 uu_3                -3.223684e-02 1 1  ON 3
 uu_4                -6.387117e-02 1 1  ON 4
 uu_5                -8.576607e-02 1 1  ON 5
 uu_6                -1.001312e-01 1 1  ON 6
 uu_7                -1.065673e-01 1 1  ON 7
 uu_8                -9.668739e-02 1 1  ON 8
 uu_9                -6.389513e-02 1 1  ON 9
 ud_0                 3.492134e-01 1 1  ON 10
 ud_1                 1.235409e-01 1 1  ON 11
 ud_2                 2.392782e-02 1 1  ON 12
 ud_3                -3.019578e-02 1 1  ON 13
 ud_4                -6.975615e-02 1 1  ON 14
 ud_5                -9.484122e-02 1 1  ON 15
 ud_6                -1.085598e-01 1 1  ON 16
 ud_7                -1.109505e-01 1 1  ON 17
 ud_8                -9.792103e-02 1 1  ON 18
 ud_9                -6.281979e-02 1 1  ON 19
 eO_0                -5.692885e-01 1 1  ON 20
 eO_1                -3.060844e-01 1 1  ON 21
 eO_2                 4.730127e-02 1 1  ON 22
 eO_3                 2.840620e-01 1 1  ON 23
 eO_4                 3.913445e-01 1 1  ON 24
 eO_5                 3.212389e-01 1 1  ON 25
 eO_6                 1.205694e-01 1 1  ON 26
 eO_7                -7.888705e-02 1 1  ON 27
 eO_8                -1.549102e-01 1 1  ON 28
 eO_9                -6.122098e-02 1 1  ON 29
eH1_0                -2.277697e-01 1 1  ON 30
eH1_1                -1.106400e-01 1 1  ON 31
eH1_2                -6.162952e-02 1 1  ON 32
eH1_3                -2.530653e-02 1 1  ON 33
eH1_4                 4.247832e-03 1 1  ON 34
eH1_5                 2.367079e-02 1 1  ON 35
eH1_6                 6.569443e-02 1 1  ON 36
eH1_7                 1.154361e-01 1 1  ON 37
eH1_8                 1.435221e-01 1 1  ON 38
eH1_9                 7.467419e-02 1 1  ON 39
eH2_0                -2.307043e-01 1 1  ON 40
eH2_1                -1.139386e-01 1 1  ON 41
eH2_2                -6.444539e-02 1 1  ON 42
eH2_3                -2.722663e-02 1 1  ON 43
eH2_4                 1.073593e-03 1 1  ON 44
eH2_5                 2.532957e-02 1 1  ON 45
eH2_6                 7.564477e-02 1 1  ON 46
eH2_7                 1.260027e-01 1 1  ON 47
eH2_8                 1.609124e-01 1 1  ON 48
eH2_9                 6.417217e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 53
    time step          = 0.05
    reference energy   = -16.9168
    reference variance = 0.314643
====================================================
  Execution time = 2.0615e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s053
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6899e+01
  VMC Evar = 2.9881e-01
  Total weights = 2.0000e+06
  Execution time = 1.8779e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.298799479694
                                         uncertainty =       0.005691580300

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.298799479694
                                         uncertainty =       0.005691580300

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000386530390
  error estimate for blocks of size 2^( 2) =       0.000403267115
  error estimate for blocks of size 2^( 3) =       0.000420382839
  error estimate for blocks of size 2^( 4) =       0.000435536666
  error estimate for blocks of size 2^( 5) =       0.000447447269
  error estimate for blocks of size 2^( 6) =       0.000454722920
  error estimate for blocks of size 2^( 7) =       0.000456658629

      target function =      -0.914428627386
              le_mean =     -16.898607096558
             les_mean =     285.861733139731
             stat err =       0.000448591371
             autocorr =       1.346897479745
   target nu stat err =       0.000448591371
   target dn stat err =       0.006049419831
      target stat err =       0.009108769727
              std dev =       0.546636520263
             le_variance =       0.298811485285

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.298799479694
                                         uncertainty =       0.005691580300

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.298799479694
                                         uncertainty =       0.005691580300

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000386530390
  error estimate for blocks of size 2^( 2) =       0.000403267115
  error estimate for blocks of size 2^( 3) =       0.000420382839
  error estimate for blocks of size 2^( 4) =       0.000435536666
  error estimate for blocks of size 2^( 5) =       0.000447447269
  error estimate for blocks of size 2^( 6) =       0.000454722920
  error estimate for blocks of size 2^( 7) =       0.000456658629

      target function =      -0.914428627386
              le_mean =     -16.898607096558
             les_mean =     285.861733139731
             stat err =       0.000448591371
             autocorr =       1.346897479745
   target nu stat err =       0.000448591371
   target dn stat err =       0.006049419831
      target stat err =       0.009108769727
              std dev =       0.546636520263
             le_variance =       0.298811485285

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.298799479694
                                         uncertainty =       0.005691580300

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.298799479694
                                         uncertainty =       0.005691580300

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000386530390
  error estimate for blocks of size 2^( 2) =       0.000403267115
  error estimate for blocks of size 2^( 3) =       0.000420382839
  error estimate for blocks of size 2^( 4) =       0.000435536666
  error estimate for blocks of size 2^( 5) =       0.000447447269
  error estimate for blocks of size 2^( 6) =       0.000454722920
  error estimate for blocks of size 2^( 7) =       0.000456658629

      target function =      -0.914428627386
              le_mean =     -16.898607096558
             les_mean =     285.861733139731
             stat err =       0.000448591371
             autocorr =       1.346897479745
   target nu stat err =       0.000448591371
   target dn stat err =       0.006049419831
      target stat err =       0.009108769727
              std dev =       0.546636520263
             le_variance =       0.298811485285

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.298799479694
                                         uncertainty =       0.005691580300

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.298799479694
                                         uncertainty =       0.005691580300

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000386530390
  error estimate for blocks of size 2^( 2) =       0.000403267115
  error estimate for blocks of size 2^( 3) =       0.000420382839
  error estimate for blocks of size 2^( 4) =       0.000435536666
  error estimate for blocks of size 2^( 5) =       0.000447447269
  error estimate for blocks of size 2^( 6) =       0.000454722920
  error estimate for blocks of size 2^( 7) =       0.000456658629

      target function =      -0.914428627386
              le_mean =     -16.898607096558
             les_mean =     285.861733139731
             stat err =       0.000448591371
             autocorr =       1.346897479745
   target nu stat err =       0.000448591371
   target dn stat err =       0.006049419831
      target stat err =       0.009108769727
              std dev =       0.546636520263
             le_variance =       0.298811485285


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.914428627386        initial  <--
     3.9062e+34     3.9062e+35             2.3142e-39        -0.914428627386
     1.5625e+35     1.5625e+36             5.7855e-40        -0.914428627386
     6.2500e+35     6.2500e+36             1.4464e-40        -0.914428627386

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 33.0521
  </log>
  <optVariables href="H2O.s053.opt.xml">
 uu_0                 2.517233e-01 1 1  ON 0
 uu_1                 1.009440e-01 1 1  ON 1
 uu_2                 1.617079e-02 1 1  ON 2
 uu_3                -3.223684e-02 1 1  ON 3
 uu_4                -6.387117e-02 1 1  ON 4
 uu_5                -8.576607e-02 1 1  ON 5
 uu_6                -1.001312e-01 1 1  ON 6
 uu_7                -1.065673e-01 1 1  ON 7
 uu_8                -9.668739e-02 1 1  ON 8
 uu_9                -6.389513e-02 1 1  ON 9
 ud_0                 3.492134e-01 1 1  ON 10
 ud_1                 1.235409e-01 1 1  ON 11
 ud_2                 2.392782e-02 1 1  ON 12
 ud_3                -3.019578e-02 1 1  ON 13
 ud_4                -6.975615e-02 1 1  ON 14
 ud_5                -9.484122e-02 1 1  ON 15
 ud_6                -1.085598e-01 1 1  ON 16
 ud_7                -1.109505e-01 1 1  ON 17
 ud_8                -9.792103e-02 1 1  ON 18
 ud_9                -6.281979e-02 1 1  ON 19
 eO_0                -5.692885e-01 1 1  ON 20
 eO_1                -3.060844e-01 1 1  ON 21
 eO_2                 4.730127e-02 1 1  ON 22
 eO_3                 2.840620e-01 1 1  ON 23
 eO_4                 3.913445e-01 1 1  ON 24
 eO_5                 3.212389e-01 1 1  ON 25
 eO_6                 1.205694e-01 1 1  ON 26
 eO_7                -7.888705e-02 1 1  ON 27
 eO_8                -1.549102e-01 1 1  ON 28
 eO_9                -6.122098e-02 1 1  ON 29
eH1_0                -2.277697e-01 1 1  ON 30
eH1_1                -1.106400e-01 1 1  ON 31
eH1_2                -6.162952e-02 1 1  ON 32
eH1_3                -2.530653e-02 1 1  ON 33
eH1_4                 4.247832e-03 1 1  ON 34
eH1_5                 2.367079e-02 1 1  ON 35
eH1_6                 6.569443e-02 1 1  ON 36
eH1_7                 1.154361e-01 1 1  ON 37
eH1_8                 1.435221e-01 1 1  ON 38
eH1_9                 7.467419e-02 1 1  ON 39
eH2_0                -2.307043e-01 1 1  ON 40
eH2_1                -1.139386e-01 1 1  ON 41
eH2_2                -6.444539e-02 1 1  ON 42
eH2_3                -2.722663e-02 1 1  ON 43
eH2_4                 1.073593e-03 1 1  ON 44
eH2_5                 2.532957e-02 1 1  ON 45
eH2_6                 7.564477e-02 1 1  ON 46
eH2_7                 1.260027e-01 1 1  ON 47
eH2_8                 1.609124e-01 1 1  ON 48
eH2_9                 6.417217e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.9385e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s054 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s054 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=54  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6899e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 54
    time step          = 0.05
    reference energy   = -16.9494
    reference variance = 0.164013
====================================================
  Execution time = 2.0888e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s054
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6898e+01
  VMC Evar = 2.9462e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.5349e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.294557927412
                                         uncertainty =       0.003500727392

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.294557927412
                                         uncertainty =       0.003500727392

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000383808661
  error estimate for blocks of size 2^( 2) =       0.000401182554
  error estimate for blocks of size 2^( 3) =       0.000418676467
  error estimate for blocks of size 2^( 4) =       0.000434920365
  error estimate for blocks of size 2^( 5) =       0.000446404946
  error estimate for blocks of size 2^( 6) =       0.000455305738
  error estimate for blocks of size 2^( 7) =       0.000458914897

      target function =      -0.920784688453
              le_mean =     -16.897790071530
             les_mean =     285.829927331467
             stat err =       0.000448886486
             autocorr =       1.367865890613
   target nu stat err =       0.000448886486
   target dn stat err =       0.003709483437
      target stat err =       0.005684713685
              std dev =       0.542787414443
             le_variance =       0.294618177277


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.689779007153e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 3.9062e+35, overlap shift 3.9062e+36 and omega -1.7456e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.920818166196       residual = 6.39e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.920818166196       residual = 6.39e-04           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.9062e+35 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 1.5625e+36, overlap shift 1.5625e+37 and omega -1.7456e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.920818166196       residual = 6.39e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.920818166196       residual = 6.39e-04           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.5625e+36 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 6.2500e+36, overlap shift 6.2500e+37 and omega -1.7456e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.920818166196       residual = 6.39e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.920818166196       residual = 6.39e-04           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 6.2500e+36 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               1.485864 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.6429e+01
  </log>
  <optVariables href="H2O.s054.opt.xml">
 uu_0                 2.517233e-01 1 1  ON 0
 uu_1                 1.009440e-01 1 1  ON 1
 uu_2                 1.617079e-02 1 1  ON 2
 uu_3                -3.223684e-02 1 1  ON 3
 uu_4                -6.387117e-02 1 1  ON 4
 uu_5                -8.576607e-02 1 1  ON 5
 uu_6                -1.001312e-01 1 1  ON 6
 uu_7                -1.065673e-01 1 1  ON 7
 uu_8                -9.668739e-02 1 1  ON 8
 uu_9                -6.389513e-02 1 1  ON 9
 ud_0                 3.492134e-01 1 1  ON 10
 ud_1                 1.235409e-01 1 1  ON 11
 ud_2                 2.392782e-02 1 1  ON 12
 ud_3                -3.019578e-02 1 1  ON 13
 ud_4                -6.975615e-02 1 1  ON 14
 ud_5                -9.484122e-02 1 1  ON 15
 ud_6                -1.085598e-01 1 1  ON 16
 ud_7                -1.109505e-01 1 1  ON 17
 ud_8                -9.792103e-02 1 1  ON 18
 ud_9                -6.281979e-02 1 1  ON 19
 eO_0                -5.692885e-01 1 1  ON 20
 eO_1                -3.060844e-01 1 1  ON 21
 eO_2                 4.730127e-02 1 1  ON 22
 eO_3                 2.840620e-01 1 1  ON 23
 eO_4                 3.913445e-01 1 1  ON 24
 eO_5                 3.212389e-01 1 1  ON 25
 eO_6                 1.205694e-01 1 1  ON 26
 eO_7                -7.888705e-02 1 1  ON 27
 eO_8                -1.549102e-01 1 1  ON 28
 eO_9                -6.122098e-02 1 1  ON 29
eH1_0                -2.277697e-01 1 1  ON 30
eH1_1                -1.106400e-01 1 1  ON 31
eH1_2                -6.162952e-02 1 1  ON 32
eH1_3                -2.530653e-02 1 1  ON 33
eH1_4                 4.247832e-03 1 1  ON 34
eH1_5                 2.367079e-02 1 1  ON 35
eH1_6                 6.569443e-02 1 1  ON 36
eH1_7                 1.154361e-01 1 1  ON 37
eH1_8                 1.435221e-01 1 1  ON 38
eH1_9                 7.467419e-02 1 1  ON 39
eH2_0                -2.307043e-01 1 1  ON 40
eH2_1                -1.139386e-01 1 1  ON 41
eH2_2                -6.444539e-02 1 1  ON 42
eH2_3                -2.722663e-02 1 1  ON 43
eH2_4                 1.073593e-03 1 1  ON 44
eH2_5                 2.532957e-02 1 1  ON 45
eH2_6                 7.564477e-02 1 1  ON 46
eH2_7                 1.260027e-01 1 1  ON 47
eH2_8                 1.609124e-01 1 1  ON 48
eH2_9                 6.417217e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 54
    time step          = 0.05
    reference energy   = -16.8202
    reference variance = 0.159202
====================================================
  Execution time = 2.0581e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s054
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6897e+01
  VMC Evar = 2.9876e-01
  Total weights = 2.0000e+06
  Execution time = 1.8813e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.298814530802
                                         uncertainty =       0.003646244115

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.298814530802
                                         uncertainty =       0.003646244115

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000386498839
  error estimate for blocks of size 2^( 2) =       0.000403553785
  error estimate for blocks of size 2^( 3) =       0.000421460143
  error estimate for blocks of size 2^( 4) =       0.000437107287
  error estimate for blocks of size 2^( 5) =       0.000449035364
  error estimate for blocks of size 2^( 6) =       0.000455387029
  error estimate for blocks of size 2^( 7) =       0.000460667260

      target function =      -0.914507134913
              le_mean =     -16.897168363846
             les_mean =     285.813061271442
             stat err =       0.000450549235
             autocorr =       1.358901964582
   target nu stat err =       0.000450549235
   target dn stat err =       0.003807803447
      target stat err =       0.005748193111
              std dev =       0.546591899554
             le_variance =       0.298762704658

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.298814530802
                                         uncertainty =       0.003646244115

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.298814530802
                                         uncertainty =       0.003646244115

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000386498839
  error estimate for blocks of size 2^( 2) =       0.000403553785
  error estimate for blocks of size 2^( 3) =       0.000421460143
  error estimate for blocks of size 2^( 4) =       0.000437107287
  error estimate for blocks of size 2^( 5) =       0.000449035364
  error estimate for blocks of size 2^( 6) =       0.000455387029
  error estimate for blocks of size 2^( 7) =       0.000460667260

      target function =      -0.914507134913
              le_mean =     -16.897168363846
             les_mean =     285.813061271442
             stat err =       0.000450549235
             autocorr =       1.358901964582
   target nu stat err =       0.000450549235
   target dn stat err =       0.003807803447
      target stat err =       0.005748193111
              std dev =       0.546591899554
             le_variance =       0.298762704658

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.298814530802
                                         uncertainty =       0.003646244115

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.298814530802
                                         uncertainty =       0.003646244115

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000386498839
  error estimate for blocks of size 2^( 2) =       0.000403553785
  error estimate for blocks of size 2^( 3) =       0.000421460143
  error estimate for blocks of size 2^( 4) =       0.000437107287
  error estimate for blocks of size 2^( 5) =       0.000449035364
  error estimate for blocks of size 2^( 6) =       0.000455387029
  error estimate for blocks of size 2^( 7) =       0.000460667260

      target function =      -0.914507134913
              le_mean =     -16.897168363846
             les_mean =     285.813061271442
             stat err =       0.000450549235
             autocorr =       1.358901964582
   target nu stat err =       0.000450549235
   target dn stat err =       0.003807803447
      target stat err =       0.005748193111
              std dev =       0.546591899554
             le_variance =       0.298762704658

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.298814530802
                                         uncertainty =       0.003646244115

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.298814530802
                                         uncertainty =       0.003646244115

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000386498839
  error estimate for blocks of size 2^( 2) =       0.000403553785
  error estimate for blocks of size 2^( 3) =       0.000421460143
  error estimate for blocks of size 2^( 4) =       0.000437107287
  error estimate for blocks of size 2^( 5) =       0.000449035364
  error estimate for blocks of size 2^( 6) =       0.000455387029
  error estimate for blocks of size 2^( 7) =       0.000460667260

      target function =      -0.914507134913
              le_mean =     -16.897168363846
             les_mean =     285.813061271442
             stat err =       0.000450549235
             autocorr =       1.358901964582
   target nu stat err =       0.000450549235
   target dn stat err =       0.003807803447
      target stat err =       0.005748193111
              std dev =       0.546591899554
             le_variance =       0.298762704658


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.914507134913        initial  <--
     3.9062e+35     3.9062e+36             0.0000e+00        -0.914507134913
     1.5625e+36     1.5625e+37             0.0000e+00        -0.914507134913
     6.2500e+36     6.2500e+37             0.0000e+00        -0.914507134913

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 30.1072
  </log>
  <optVariables href="H2O.s054.opt.xml">
 uu_0                 2.517233e-01 1 1  ON 0
 uu_1                 1.009440e-01 1 1  ON 1
 uu_2                 1.617079e-02 1 1  ON 2
 uu_3                -3.223684e-02 1 1  ON 3
 uu_4                -6.387117e-02 1 1  ON 4
 uu_5                -8.576607e-02 1 1  ON 5
 uu_6                -1.001312e-01 1 1  ON 6
 uu_7                -1.065673e-01 1 1  ON 7
 uu_8                -9.668739e-02 1 1  ON 8
 uu_9                -6.389513e-02 1 1  ON 9
 ud_0                 3.492134e-01 1 1  ON 10
 ud_1                 1.235409e-01 1 1  ON 11
 ud_2                 2.392782e-02 1 1  ON 12
 ud_3                -3.019578e-02 1 1  ON 13
 ud_4                -6.975615e-02 1 1  ON 14
 ud_5                -9.484122e-02 1 1  ON 15
 ud_6                -1.085598e-01 1 1  ON 16
 ud_7                -1.109505e-01 1 1  ON 17
 ud_8                -9.792103e-02 1 1  ON 18
 ud_9                -6.281979e-02 1 1  ON 19
 eO_0                -5.692885e-01 1 1  ON 20
 eO_1                -3.060844e-01 1 1  ON 21
 eO_2                 4.730127e-02 1 1  ON 22
 eO_3                 2.840620e-01 1 1  ON 23
 eO_4                 3.913445e-01 1 1  ON 24
 eO_5                 3.212389e-01 1 1  ON 25
 eO_6                 1.205694e-01 1 1  ON 26
 eO_7                -7.888705e-02 1 1  ON 27
 eO_8                -1.549102e-01 1 1  ON 28
 eO_9                -6.122098e-02 1 1  ON 29
eH1_0                -2.277697e-01 1 1  ON 30
eH1_1                -1.106400e-01 1 1  ON 31
eH1_2                -6.162952e-02 1 1  ON 32
eH1_3                -2.530653e-02 1 1  ON 33
eH1_4                 4.247832e-03 1 1  ON 34
eH1_5                 2.367079e-02 1 1  ON 35
eH1_6                 6.569443e-02 1 1  ON 36
eH1_7                 1.154361e-01 1 1  ON 37
eH1_8                 1.435221e-01 1 1  ON 38
eH1_9                 7.467419e-02 1 1  ON 39
eH2_0                -2.307043e-01 1 1  ON 40
eH2_1                -1.139386e-01 1 1  ON 41
eH2_2                -6.444539e-02 1 1  ON 42
eH2_3                -2.722663e-02 1 1  ON 43
eH2_4                 1.073593e-03 1 1  ON 44
eH2_5                 2.532957e-02 1 1  ON 45
eH2_6                 7.564477e-02 1 1  ON 46
eH2_7                 1.260027e-01 1 1  ON 47
eH2_8                 1.609124e-01 1 1  ON 48
eH2_9                 6.417217e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.6542e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s055 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s055 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=55  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6899e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 55
    time step          = 0.05
    reference energy   = -16.8768
    reference variance = 0.315839
====================================================
  Execution time = 2.0789e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s055
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6898e+01
  VMC Evar = 2.9703e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.5361e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.296974266870
                                         uncertainty =       0.002778414757

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.296974266870
                                         uncertainty =       0.002778414757

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000385376637
  error estimate for blocks of size 2^( 2) =       0.000402949160
  error estimate for blocks of size 2^( 3) =       0.000421082170
  error estimate for blocks of size 2^( 4) =       0.000436728498
  error estimate for blocks of size 2^( 5) =       0.000449243958
  error estimate for blocks of size 2^( 6) =       0.000457479931
  error estimate for blocks of size 2^( 7) =       0.000464051586

      target function =      -0.917169349803
              le_mean =     -16.898305208787
             les_mean =     285.849749085871
             stat err =       0.000451875993
             autocorr =       1.374889427752
   target nu stat err =       0.000451875993
   target dn stat err =       0.002734750690
      target stat err =       0.004192827617
              std dev =       0.545004866998
             le_variance =       0.297030305052


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.689830520879e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 3.9062e+36, overlap shift 3.9062e+37 and omega -1.7456e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.917187144210       residual = 8.83e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.917187144210       residual = 5.10e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.917187144210       residual = 2.30e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.917186737061       residual = 4.44e-04           smallest_sin_value = 1.00e+00
davidson iteration    4 stopping due to too large eigenvalue change
davidson solver did not converge after          4 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.9062e+36 is 2.383737e-41

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 1.5625e+37, overlap shift 1.5625e+38 and omega -1.7456e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.917187144210       residual = 8.83e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.917187144210       residual = 5.10e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.917187144210       residual = 2.30e-04           smallest_sin_value = 1.00e+00
davidson iteration    3 stopping due to too large eigenvalue change
davidson solver did not converge after          3 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.5625e+37 is 5.959344e-42

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 6.2500e+37, overlap shift 6.2500e+38 and omega -1.7456e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.917187144210       residual = 8.83e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.917187144210       residual = 5.10e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.917187144210       residual = 2.30e-04           smallest_sin_value = 1.00e+00
davidson iteration    3 stopping due to too large eigenvalue change
davidson solver did not converge after          3 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 6.2500e+37 is 1.489836e-42

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               1.487286 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.6332e+01
  </log>
  <optVariables href="H2O.s055.opt.xml">
 uu_0                 2.517233e-01 1 1  ON 0
 uu_1                 1.009440e-01 1 1  ON 1
 uu_2                 1.617079e-02 1 1  ON 2
 uu_3                -3.223684e-02 1 1  ON 3
 uu_4                -6.387117e-02 1 1  ON 4
 uu_5                -8.576607e-02 1 1  ON 5
 uu_6                -1.001312e-01 1 1  ON 6
 uu_7                -1.065673e-01 1 1  ON 7
 uu_8                -9.668739e-02 1 1  ON 8
 uu_9                -6.389513e-02 1 1  ON 9
 ud_0                 3.492134e-01 1 1  ON 10
 ud_1                 1.235409e-01 1 1  ON 11
 ud_2                 2.392782e-02 1 1  ON 12
 ud_3                -3.019578e-02 1 1  ON 13
 ud_4                -6.975615e-02 1 1  ON 14
 ud_5                -9.484122e-02 1 1  ON 15
 ud_6                -1.085598e-01 1 1  ON 16
 ud_7                -1.109505e-01 1 1  ON 17
 ud_8                -9.792103e-02 1 1  ON 18
 ud_9                -6.281979e-02 1 1  ON 19
 eO_0                -5.692885e-01 1 1  ON 20
 eO_1                -3.060844e-01 1 1  ON 21
 eO_2                 4.730127e-02 1 1  ON 22
 eO_3                 2.840620e-01 1 1  ON 23
 eO_4                 3.913445e-01 1 1  ON 24
 eO_5                 3.212389e-01 1 1  ON 25
 eO_6                 1.205694e-01 1 1  ON 26
 eO_7                -7.888705e-02 1 1  ON 27
 eO_8                -1.549102e-01 1 1  ON 28
 eO_9                -6.122098e-02 1 1  ON 29
eH1_0                -2.277697e-01 1 1  ON 30
eH1_1                -1.106400e-01 1 1  ON 31
eH1_2                -6.162952e-02 1 1  ON 32
eH1_3                -2.530653e-02 1 1  ON 33
eH1_4                 4.247832e-03 1 1  ON 34
eH1_5                 2.367079e-02 1 1  ON 35
eH1_6                 6.569443e-02 1 1  ON 36
eH1_7                 1.154361e-01 1 1  ON 37
eH1_8                 1.435221e-01 1 1  ON 38
eH1_9                 7.467419e-02 1 1  ON 39
eH2_0                -2.307043e-01 1 1  ON 40
eH2_1                -1.139386e-01 1 1  ON 41
eH2_2                -6.444539e-02 1 1  ON 42
eH2_3                -2.722663e-02 1 1  ON 43
eH2_4                 1.073593e-03 1 1  ON 44
eH2_5                 2.532957e-02 1 1  ON 45
eH2_6                 7.564477e-02 1 1  ON 46
eH2_7                 1.260027e-01 1 1  ON 47
eH2_8                 1.609124e-01 1 1  ON 48
eH2_9                 6.417217e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 55
    time step          = 0.05
    reference energy   = -16.9465
    reference variance = 0.335961
====================================================
  Execution time = 2.0484e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s055
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6898e+01
  VMC Evar = 2.9738e-01
  Total weights = 2.0000e+06
  Execution time = 1.8548e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.297398848116
                                         uncertainty =       0.004739034738

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.297398848116
                                         uncertainty =       0.004739034738

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000385603385
  error estimate for blocks of size 2^( 2) =       0.000402771977
  error estimate for blocks of size 2^( 3) =       0.000420791461
  error estimate for blocks of size 2^( 4) =       0.000435873407
  error estimate for blocks of size 2^( 5) =       0.000448100054
  error estimate for blocks of size 2^( 6) =       0.000455102363
  error estimate for blocks of size 2^( 7) =       0.000458563254

      target function =      -0.916595353489
              le_mean =     -16.898085147538
             les_mean =     285.842661446259
             stat err =       0.000449409769
             autocorr =       1.358323897919
   target nu stat err =       0.000449409769
   target dn stat err =       0.004813486356
      target stat err =       0.007288827375
              std dev =       0.545325537185
             le_variance =       0.297379941506

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.297398848116
                                         uncertainty =       0.004739034738

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.297398848116
                                         uncertainty =       0.004739034738

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000385603385
  error estimate for blocks of size 2^( 2) =       0.000402771977
  error estimate for blocks of size 2^( 3) =       0.000420791461
  error estimate for blocks of size 2^( 4) =       0.000435873407
  error estimate for blocks of size 2^( 5) =       0.000448100054
  error estimate for blocks of size 2^( 6) =       0.000455102363
  error estimate for blocks of size 2^( 7) =       0.000458563254

      target function =      -0.916595353489
              le_mean =     -16.898085147538
             les_mean =     285.842661446259
             stat err =       0.000449409769
             autocorr =       1.358323897919
   target nu stat err =       0.000449409769
   target dn stat err =       0.004813486356
      target stat err =       0.007288827375
              std dev =       0.545325537185
             le_variance =       0.297379941506

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.297398848116
                                         uncertainty =       0.004739034738

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.297398848116
                                         uncertainty =       0.004739034738

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000385603385
  error estimate for blocks of size 2^( 2) =       0.000402771977
  error estimate for blocks of size 2^( 3) =       0.000420791461
  error estimate for blocks of size 2^( 4) =       0.000435873407
  error estimate for blocks of size 2^( 5) =       0.000448100054
  error estimate for blocks of size 2^( 6) =       0.000455102363
  error estimate for blocks of size 2^( 7) =       0.000458563254

      target function =      -0.916595353489
              le_mean =     -16.898085147538
             les_mean =     285.842661446259
             stat err =       0.000449409769
             autocorr =       1.358323897919
   target nu stat err =       0.000449409769
   target dn stat err =       0.004813486356
      target stat err =       0.007288827375
              std dev =       0.545325537185
             le_variance =       0.297379941506

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.297398848116
                                         uncertainty =       0.004739034738

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.297398848116
                                         uncertainty =       0.004739034738

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000385603385
  error estimate for blocks of size 2^( 2) =       0.000402771977
  error estimate for blocks of size 2^( 3) =       0.000420791461
  error estimate for blocks of size 2^( 4) =       0.000435873407
  error estimate for blocks of size 2^( 5) =       0.000448100054
  error estimate for blocks of size 2^( 6) =       0.000455102363
  error estimate for blocks of size 2^( 7) =       0.000458563254

      target function =      -0.916595353489
              le_mean =     -16.898085147538
             les_mean =     285.842661446259
             stat err =       0.000449409769
             autocorr =       1.358323897919
   target nu stat err =       0.000449409769
   target dn stat err =       0.004813486356
      target stat err =       0.007288827375
              std dev =       0.545325537185
             le_variance =       0.297379941506


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.916595353489        initial  <--
     3.9062e+36     3.9062e+37             2.3837e-41        -0.916595353489
     1.5625e+37     1.5625e+38             5.9593e-42        -0.916595353489
     6.2500e+37     6.2500e+38             1.4898e-42        -0.916595353489

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 29.8723
  </log>
  <optVariables href="H2O.s055.opt.xml">
 uu_0                 2.517233e-01 1 1  ON 0
 uu_1                 1.009440e-01 1 1  ON 1
 uu_2                 1.617079e-02 1 1  ON 2
 uu_3                -3.223684e-02 1 1  ON 3
 uu_4                -6.387117e-02 1 1  ON 4
 uu_5                -8.576607e-02 1 1  ON 5
 uu_6                -1.001312e-01 1 1  ON 6
 uu_7                -1.065673e-01 1 1  ON 7
 uu_8                -9.668739e-02 1 1  ON 8
 uu_9                -6.389513e-02 1 1  ON 9
 ud_0                 3.492134e-01 1 1  ON 10
 ud_1                 1.235409e-01 1 1  ON 11
 ud_2                 2.392782e-02 1 1  ON 12
 ud_3                -3.019578e-02 1 1  ON 13
 ud_4                -6.975615e-02 1 1  ON 14
 ud_5                -9.484122e-02 1 1  ON 15
 ud_6                -1.085598e-01 1 1  ON 16
 ud_7                -1.109505e-01 1 1  ON 17
 ud_8                -9.792103e-02 1 1  ON 18
 ud_9                -6.281979e-02 1 1  ON 19
 eO_0                -5.692885e-01 1 1  ON 20
 eO_1                -3.060844e-01 1 1  ON 21
 eO_2                 4.730127e-02 1 1  ON 22
 eO_3                 2.840620e-01 1 1  ON 23
 eO_4                 3.913445e-01 1 1  ON 24
 eO_5                 3.212389e-01 1 1  ON 25
 eO_6                 1.205694e-01 1 1  ON 26
 eO_7                -7.888705e-02 1 1  ON 27
 eO_8                -1.549102e-01 1 1  ON 28
 eO_9                -6.122098e-02 1 1  ON 29
eH1_0                -2.277697e-01 1 1  ON 30
eH1_1                -1.106400e-01 1 1  ON 31
eH1_2                -6.162952e-02 1 1  ON 32
eH1_3                -2.530653e-02 1 1  ON 33
eH1_4                 4.247832e-03 1 1  ON 34
eH1_5                 2.367079e-02 1 1  ON 35
eH1_6                 6.569443e-02 1 1  ON 36
eH1_7                 1.154361e-01 1 1  ON 37
eH1_8                 1.435221e-01 1 1  ON 38
eH1_9                 7.467419e-02 1 1  ON 39
eH2_0                -2.307043e-01 1 1  ON 40
eH2_1                -1.139386e-01 1 1  ON 41
eH2_2                -6.444539e-02 1 1  ON 42
eH2_3                -2.722663e-02 1 1  ON 43
eH2_4                 1.073593e-03 1 1  ON 44
eH2_5                 2.532957e-02 1 1  ON 45
eH2_6                 7.564477e-02 1 1  ON 46
eH2_7                 1.260027e-01 1 1  ON 47
eH2_8                 1.609124e-01 1 1  ON 48
eH2_9                 6.417217e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.6211e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s056 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s056 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=56  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6899e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 56
    time step          = 0.05
    reference energy   = -16.8092
    reference variance = 0.193223
====================================================
  Execution time = 2.0958e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s056
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6898e+01
  VMC Evar = 2.9743e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.4929e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.297465280704
                                         uncertainty =       0.004075828152

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.297465280704
                                         uncertainty =       0.004075828152

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000385638777
  error estimate for blocks of size 2^( 2) =       0.000402777438
  error estimate for blocks of size 2^( 3) =       0.000420792188
  error estimate for blocks of size 2^( 4) =       0.000436900302
  error estimate for blocks of size 2^( 5) =       0.000449159294
  error estimate for blocks of size 2^( 6) =       0.000457555331
  error estimate for blocks of size 2^( 7) =       0.000461708326

      target function =      -0.916537515640
              le_mean =     -16.898289128280
             les_mean =     285.849609847045
             stat err =       0.000451330813
             autocorr =       1.369709838982
   target nu stat err =       0.000451330813
   target dn stat err =       0.004016469829
      target stat err =       0.006097289103
              std dev =       0.545375588755
             le_variance =       0.297434532810


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.689828912828e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 3.9062e+37, overlap shift 3.9062e+38 and omega -1.7456e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.916577026251       residual = 1.41e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.916577026251       residual = 1.41e-03           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.9062e+37 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 1.5625e+38, overlap shift 1.5625e+39 and omega -1.7456e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.916577026251       residual = 1.41e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.916577026251       residual = 1.41e-03           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.5625e+38 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 6.2500e+38, overlap shift 6.2500e+39 and omega -1.7456e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.916577026251       residual = 1.41e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.916577026251       residual = 1.41e-03           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 6.2500e+38 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               1.488417 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.6457e+01
  </log>
  <optVariables href="H2O.s056.opt.xml">
 uu_0                 2.517233e-01 1 1  ON 0
 uu_1                 1.009440e-01 1 1  ON 1
 uu_2                 1.617079e-02 1 1  ON 2
 uu_3                -3.223684e-02 1 1  ON 3
 uu_4                -6.387117e-02 1 1  ON 4
 uu_5                -8.576607e-02 1 1  ON 5
 uu_6                -1.001312e-01 1 1  ON 6
 uu_7                -1.065673e-01 1 1  ON 7
 uu_8                -9.668739e-02 1 1  ON 8
 uu_9                -6.389513e-02 1 1  ON 9
 ud_0                 3.492134e-01 1 1  ON 10
 ud_1                 1.235409e-01 1 1  ON 11
 ud_2                 2.392782e-02 1 1  ON 12
 ud_3                -3.019578e-02 1 1  ON 13
 ud_4                -6.975615e-02 1 1  ON 14
 ud_5                -9.484122e-02 1 1  ON 15
 ud_6                -1.085598e-01 1 1  ON 16
 ud_7                -1.109505e-01 1 1  ON 17
 ud_8                -9.792103e-02 1 1  ON 18
 ud_9                -6.281979e-02 1 1  ON 19
 eO_0                -5.692885e-01 1 1  ON 20
 eO_1                -3.060844e-01 1 1  ON 21
 eO_2                 4.730127e-02 1 1  ON 22
 eO_3                 2.840620e-01 1 1  ON 23
 eO_4                 3.913445e-01 1 1  ON 24
 eO_5                 3.212389e-01 1 1  ON 25
 eO_6                 1.205694e-01 1 1  ON 26
 eO_7                -7.888705e-02 1 1  ON 27
 eO_8                -1.549102e-01 1 1  ON 28
 eO_9                -6.122098e-02 1 1  ON 29
eH1_0                -2.277697e-01 1 1  ON 30
eH1_1                -1.106400e-01 1 1  ON 31
eH1_2                -6.162952e-02 1 1  ON 32
eH1_3                -2.530653e-02 1 1  ON 33
eH1_4                 4.247832e-03 1 1  ON 34
eH1_5                 2.367079e-02 1 1  ON 35
eH1_6                 6.569443e-02 1 1  ON 36
eH1_7                 1.154361e-01 1 1  ON 37
eH1_8                 1.435221e-01 1 1  ON 38
eH1_9                 7.467419e-02 1 1  ON 39
eH2_0                -2.307043e-01 1 1  ON 40
eH2_1                -1.139386e-01 1 1  ON 41
eH2_2                -6.444539e-02 1 1  ON 42
eH2_3                -2.722663e-02 1 1  ON 43
eH2_4                 1.073593e-03 1 1  ON 44
eH2_5                 2.532957e-02 1 1  ON 45
eH2_6                 7.564477e-02 1 1  ON 46
eH2_7                 1.260027e-01 1 1  ON 47
eH2_8                 1.609124e-01 1 1  ON 48
eH2_9                 6.417217e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 56
    time step          = 0.05
    reference energy   = -16.808
    reference variance = 0.195579
====================================================
  Execution time = 2.0373e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s056
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6898e+01
  VMC Evar = 2.9395e-01
  Total weights = 2.0000e+06
  Execution time = 2.3785e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.293897212488
                                         uncertainty =       0.002886955872

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.293897212488
                                         uncertainty =       0.002886955872

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000383373841
  error estimate for blocks of size 2^( 2) =       0.000401085614
  error estimate for blocks of size 2^( 3) =       0.000418833997
  error estimate for blocks of size 2^( 4) =       0.000434182783
  error estimate for blocks of size 2^( 5) =       0.000445561932
  error estimate for blocks of size 2^( 6) =       0.000452622166
  error estimate for blocks of size 2^( 7) =       0.000454632083

      target function =      -0.921833935624
              le_mean =     -16.898218498385
             les_mean =     285.843739276002
             stat err =       0.000446749741
             autocorr =       1.357949647142
   target nu stat err =       0.000446749741
   target dn stat err =       0.002852112126
      target stat err =       0.004409001268
              std dev =       0.542172485305
             le_variance =       0.293951003822

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.293897212488
                                         uncertainty =       0.002886955872

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.293897212488
                                         uncertainty =       0.002886955872

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000383373841
  error estimate for blocks of size 2^( 2) =       0.000401085614
  error estimate for blocks of size 2^( 3) =       0.000418833997
  error estimate for blocks of size 2^( 4) =       0.000434182783
  error estimate for blocks of size 2^( 5) =       0.000445561932
  error estimate for blocks of size 2^( 6) =       0.000452622166
  error estimate for blocks of size 2^( 7) =       0.000454632083

      target function =      -0.921833935624
              le_mean =     -16.898218498385
             les_mean =     285.843739276002
             stat err =       0.000446749741
             autocorr =       1.357949647142
   target nu stat err =       0.000446749741
   target dn stat err =       0.002852112126
      target stat err =       0.004409001268
              std dev =       0.542172485305
             le_variance =       0.293951003822

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.293897212488
                                         uncertainty =       0.002886955872

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.293897212488
                                         uncertainty =       0.002886955872

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000383373841
  error estimate for blocks of size 2^( 2) =       0.000401085614
  error estimate for blocks of size 2^( 3) =       0.000418833997
  error estimate for blocks of size 2^( 4) =       0.000434182783
  error estimate for blocks of size 2^( 5) =       0.000445561932
  error estimate for blocks of size 2^( 6) =       0.000452622166
  error estimate for blocks of size 2^( 7) =       0.000454632083

      target function =      -0.921833935624
              le_mean =     -16.898218498385
             les_mean =     285.843739276002
             stat err =       0.000446749741
             autocorr =       1.357949647142
   target nu stat err =       0.000446749741
   target dn stat err =       0.002852112126
      target stat err =       0.004409001268
              std dev =       0.542172485305
             le_variance =       0.293951003822

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.293897212488
                                         uncertainty =       0.002886955872

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.293897212488
                                         uncertainty =       0.002886955872

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000383373841
  error estimate for blocks of size 2^( 2) =       0.000401085614
  error estimate for blocks of size 2^( 3) =       0.000418833997
  error estimate for blocks of size 2^( 4) =       0.000434182783
  error estimate for blocks of size 2^( 5) =       0.000445561932
  error estimate for blocks of size 2^( 6) =       0.000452622166
  error estimate for blocks of size 2^( 7) =       0.000454632083

      target function =      -0.921833935624
              le_mean =     -16.898218498385
             les_mean =     285.843739276002
             stat err =       0.000446749741
             autocorr =       1.357949647142
   target nu stat err =       0.000446749741
   target dn stat err =       0.002852112126
      target stat err =       0.004409001268
              std dev =       0.542172485305
             le_variance =       0.293951003822


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.921833935624        initial  <--
     3.9062e+37     3.9062e+38             0.0000e+00        -0.921833935624
     1.5625e+38     1.5625e+39             0.0000e+00        -0.921833935624
     6.2500e+38     6.2500e+39             0.0000e+00        -0.921833935624

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 31.0280
  </log>
  <optVariables href="H2O.s056.opt.xml">
 uu_0                 2.517233e-01 1 1  ON 0
 uu_1                 1.009440e-01 1 1  ON 1
 uu_2                 1.617079e-02 1 1  ON 2
 uu_3                -3.223684e-02 1 1  ON 3
 uu_4                -6.387117e-02 1 1  ON 4
 uu_5                -8.576607e-02 1 1  ON 5
 uu_6                -1.001312e-01 1 1  ON 6
 uu_7                -1.065673e-01 1 1  ON 7
 uu_8                -9.668739e-02 1 1  ON 8
 uu_9                -6.389513e-02 1 1  ON 9
 ud_0                 3.492134e-01 1 1  ON 10
 ud_1                 1.235409e-01 1 1  ON 11
 ud_2                 2.392782e-02 1 1  ON 12
 ud_3                -3.019578e-02 1 1  ON 13
 ud_4                -6.975615e-02 1 1  ON 14
 ud_5                -9.484122e-02 1 1  ON 15
 ud_6                -1.085598e-01 1 1  ON 16
 ud_7                -1.109505e-01 1 1  ON 17
 ud_8                -9.792103e-02 1 1  ON 18
 ud_9                -6.281979e-02 1 1  ON 19
 eO_0                -5.692885e-01 1 1  ON 20
 eO_1                -3.060844e-01 1 1  ON 21
 eO_2                 4.730127e-02 1 1  ON 22
 eO_3                 2.840620e-01 1 1  ON 23
 eO_4                 3.913445e-01 1 1  ON 24
 eO_5                 3.212389e-01 1 1  ON 25
 eO_6                 1.205694e-01 1 1  ON 26
 eO_7                -7.888705e-02 1 1  ON 27
 eO_8                -1.549102e-01 1 1  ON 28
 eO_9                -6.122098e-02 1 1  ON 29
eH1_0                -2.277697e-01 1 1  ON 30
eH1_1                -1.106400e-01 1 1  ON 31
eH1_2                -6.162952e-02 1 1  ON 32
eH1_3                -2.530653e-02 1 1  ON 33
eH1_4                 4.247832e-03 1 1  ON 34
eH1_5                 2.367079e-02 1 1  ON 35
eH1_6                 6.569443e-02 1 1  ON 36
eH1_7                 1.154361e-01 1 1  ON 37
eH1_8                 1.435221e-01 1 1  ON 38
eH1_9                 7.467419e-02 1 1  ON 39
eH2_0                -2.307043e-01 1 1  ON 40
eH2_1                -1.139386e-01 1 1  ON 41
eH2_2                -6.444539e-02 1 1  ON 42
eH2_3                -2.722663e-02 1 1  ON 43
eH2_4                 1.073593e-03 1 1  ON 44
eH2_5                 2.532957e-02 1 1  ON 45
eH2_6                 7.564477e-02 1 1  ON 46
eH2_7                 1.260027e-01 1 1  ON 47
eH2_8                 1.609124e-01 1 1  ON 48
eH2_9                 6.417217e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.7491e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s057 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s057 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=57  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6898e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 57
    time step          = 0.05
    reference energy   = -16.8124
    reference variance = 0.33093
====================================================
  Execution time = 2.0655e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s057
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6899e+01
  VMC Evar = 3.0008e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.5398e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.300111985541
                                         uncertainty =       0.005015516149

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.300111985541
                                         uncertainty =       0.005015516149

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000387351427
  error estimate for blocks of size 2^( 2) =       0.000404489250
  error estimate for blocks of size 2^( 3) =       0.000421981654
  error estimate for blocks of size 2^( 4) =       0.000438595118
  error estimate for blocks of size 2^( 5) =       0.000452527427
  error estimate for blocks of size 2^( 6) =       0.000460977685
  error estimate for blocks of size 2^( 7) =       0.000466355687

      target function =      -0.912547920516
              le_mean =     -16.898521242451
             les_mean =     285.860102287814
             stat err =       0.000454613979
             autocorr =       1.377448122687
   target nu stat err =       0.000454613979
   target dn stat err =       0.005133202185
      target stat err =       0.007706899697
              std dev =       0.547797641728
             le_variance =       0.300082256283


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.689852124245e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 3.9062e+38, overlap shift 3.9062e+39 and omega -1.7456e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.912611194807       residual = 1.52e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.912611194807       residual = 1.52e-03           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.9062e+38 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 1.5625e+39, overlap shift 1.5625e+40 and omega -1.7456e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.912611194807       residual = 1.52e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.912611194807       residual = 1.52e-03           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.5625e+39 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 6.2500e+39, overlap shift 6.2500e+40 and omega -1.7456e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.912611194807       residual = 1.52e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.912611194807       residual = 1.52e-03           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 6.2500e+39 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               1.489523 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.6202e+01
  </log>
  <optVariables href="H2O.s057.opt.xml">
 uu_0                 2.517233e-01 1 1  ON 0
 uu_1                 1.009440e-01 1 1  ON 1
 uu_2                 1.617079e-02 1 1  ON 2
 uu_3                -3.223684e-02 1 1  ON 3
 uu_4                -6.387117e-02 1 1  ON 4
 uu_5                -8.576607e-02 1 1  ON 5
 uu_6                -1.001312e-01 1 1  ON 6
 uu_7                -1.065673e-01 1 1  ON 7
 uu_8                -9.668739e-02 1 1  ON 8
 uu_9                -6.389513e-02 1 1  ON 9
 ud_0                 3.492134e-01 1 1  ON 10
 ud_1                 1.235409e-01 1 1  ON 11
 ud_2                 2.392782e-02 1 1  ON 12
 ud_3                -3.019578e-02 1 1  ON 13
 ud_4                -6.975615e-02 1 1  ON 14
 ud_5                -9.484122e-02 1 1  ON 15
 ud_6                -1.085598e-01 1 1  ON 16
 ud_7                -1.109505e-01 1 1  ON 17
 ud_8                -9.792103e-02 1 1  ON 18
 ud_9                -6.281979e-02 1 1  ON 19
 eO_0                -5.692885e-01 1 1  ON 20
 eO_1                -3.060844e-01 1 1  ON 21
 eO_2                 4.730127e-02 1 1  ON 22
 eO_3                 2.840620e-01 1 1  ON 23
 eO_4                 3.913445e-01 1 1  ON 24
 eO_5                 3.212389e-01 1 1  ON 25
 eO_6                 1.205694e-01 1 1  ON 26
 eO_7                -7.888705e-02 1 1  ON 27
 eO_8                -1.549102e-01 1 1  ON 28
 eO_9                -6.122098e-02 1 1  ON 29
eH1_0                -2.277697e-01 1 1  ON 30
eH1_1                -1.106400e-01 1 1  ON 31
eH1_2                -6.162952e-02 1 1  ON 32
eH1_3                -2.530653e-02 1 1  ON 33
eH1_4                 4.247832e-03 1 1  ON 34
eH1_5                 2.367079e-02 1 1  ON 35
eH1_6                 6.569443e-02 1 1  ON 36
eH1_7                 1.154361e-01 1 1  ON 37
eH1_8                 1.435221e-01 1 1  ON 38
eH1_9                 7.467419e-02 1 1  ON 39
eH2_0                -2.307043e-01 1 1  ON 40
eH2_1                -1.139386e-01 1 1  ON 41
eH2_2                -6.444539e-02 1 1  ON 42
eH2_3                -2.722663e-02 1 1  ON 43
eH2_4                 1.073593e-03 1 1  ON 44
eH2_5                 2.532957e-02 1 1  ON 45
eH2_6                 7.564477e-02 1 1  ON 46
eH2_7                 1.260027e-01 1 1  ON 47
eH2_8                 1.609124e-01 1 1  ON 48
eH2_9                 6.417217e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 57
    time step          = 0.05
    reference energy   = -16.8331
    reference variance = 0.200056
====================================================
  Execution time = 2.0366e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s057
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6899e+01
  VMC Evar = 2.9111e-01
  Total weights = 2.0000e+06
  Execution time = 1.8593e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.291143955137
                                         uncertainty =       0.001917071503

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.291143955137
                                         uncertainty =       0.001917071503

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000381514758
  error estimate for blocks of size 2^( 2) =       0.000399140719
  error estimate for blocks of size 2^( 3) =       0.000416356559
  error estimate for blocks of size 2^( 4) =       0.000431752421
  error estimate for blocks of size 2^( 5) =       0.000441993949
  error estimate for blocks of size 2^( 6) =       0.000450221923
  error estimate for blocks of size 2^( 7) =       0.000454571615

      target function =      -0.926222424597
              le_mean =     -16.898660062307
             les_mean =     285.855818777373
             stat err =       0.000444634977
             autocorr =       1.358265161173
   target nu stat err =       0.000444634977
   target dn stat err =       0.001991243123
      target stat err =       0.003153909543
              std dev =       0.539543345352
             le_variance =       0.291107021514

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.291143955137
                                         uncertainty =       0.001917071503

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.291143955137
                                         uncertainty =       0.001917071503

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000381514758
  error estimate for blocks of size 2^( 2) =       0.000399140719
  error estimate for blocks of size 2^( 3) =       0.000416356559
  error estimate for blocks of size 2^( 4) =       0.000431752421
  error estimate for blocks of size 2^( 5) =       0.000441993949
  error estimate for blocks of size 2^( 6) =       0.000450221923
  error estimate for blocks of size 2^( 7) =       0.000454571615

      target function =      -0.926222424597
              le_mean =     -16.898660062307
             les_mean =     285.855818777373
             stat err =       0.000444634977
             autocorr =       1.358265161171
   target nu stat err =       0.000444634977
   target dn stat err =       0.001991243123
      target stat err =       0.003153909543
              std dev =       0.539543345352
             le_variance =       0.291107021514

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.291143955137
                                         uncertainty =       0.001917071503

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.291143955137
                                         uncertainty =       0.001917071503

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000381514758
  error estimate for blocks of size 2^( 2) =       0.000399140719
  error estimate for blocks of size 2^( 3) =       0.000416356559
  error estimate for blocks of size 2^( 4) =       0.000431752421
  error estimate for blocks of size 2^( 5) =       0.000441993949
  error estimate for blocks of size 2^( 6) =       0.000450221923
  error estimate for blocks of size 2^( 7) =       0.000454571615

      target function =      -0.926222424597
              le_mean =     -16.898660062307
             les_mean =     285.855818777373
             stat err =       0.000444634977
             autocorr =       1.358265161171
   target nu stat err =       0.000444634977
   target dn stat err =       0.001991243123
      target stat err =       0.003153909543
              std dev =       0.539543345352
             le_variance =       0.291107021514

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.291143955137
                                         uncertainty =       0.001917071503

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.291143955137
                                         uncertainty =       0.001917071503

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000381514758
  error estimate for blocks of size 2^( 2) =       0.000399140719
  error estimate for blocks of size 2^( 3) =       0.000416356559
  error estimate for blocks of size 2^( 4) =       0.000431752421
  error estimate for blocks of size 2^( 5) =       0.000441993949
  error estimate for blocks of size 2^( 6) =       0.000450221923
  error estimate for blocks of size 2^( 7) =       0.000454571615

      target function =      -0.926222424597
              le_mean =     -16.898660062307
             les_mean =     285.855818777373
             stat err =       0.000444634977
             autocorr =       1.358265161171
   target nu stat err =       0.000444634977
   target dn stat err =       0.001991243123
      target stat err =       0.003153909543
              std dev =       0.539543345352
             le_variance =       0.291107021514


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.926222424597        initial  <--
     3.9062e+38     3.9062e+39             0.0000e+00        -0.926222424597
     1.5625e+39     1.5625e+40             0.0000e+00        -0.926222424597
     6.2500e+39     6.2500e+40             0.0000e+00        -0.926222424597

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 29.8320
  </log>
  <optVariables href="H2O.s057.opt.xml">
 uu_0                 2.517233e-01 1 1  ON 0
 uu_1                 1.009440e-01 1 1  ON 1
 uu_2                 1.617079e-02 1 1  ON 2
 uu_3                -3.223684e-02 1 1  ON 3
 uu_4                -6.387117e-02 1 1  ON 4
 uu_5                -8.576607e-02 1 1  ON 5
 uu_6                -1.001312e-01 1 1  ON 6
 uu_7                -1.065673e-01 1 1  ON 7
 uu_8                -9.668739e-02 1 1  ON 8
 uu_9                -6.389513e-02 1 1  ON 9
 ud_0                 3.492134e-01 1 1  ON 10
 ud_1                 1.235409e-01 1 1  ON 11
 ud_2                 2.392782e-02 1 1  ON 12
 ud_3                -3.019578e-02 1 1  ON 13
 ud_4                -6.975615e-02 1 1  ON 14
 ud_5                -9.484122e-02 1 1  ON 15
 ud_6                -1.085598e-01 1 1  ON 16
 ud_7                -1.109505e-01 1 1  ON 17
 ud_8                -9.792103e-02 1 1  ON 18
 ud_9                -6.281979e-02 1 1  ON 19
 eO_0                -5.692885e-01 1 1  ON 20
 eO_1                -3.060844e-01 1 1  ON 21
 eO_2                 4.730127e-02 1 1  ON 22
 eO_3                 2.840620e-01 1 1  ON 23
 eO_4                 3.913445e-01 1 1  ON 24
 eO_5                 3.212389e-01 1 1  ON 25
 eO_6                 1.205694e-01 1 1  ON 26
 eO_7                -7.888705e-02 1 1  ON 27
 eO_8                -1.549102e-01 1 1  ON 28
 eO_9                -6.122098e-02 1 1  ON 29
eH1_0                -2.277697e-01 1 1  ON 30
eH1_1                -1.106400e-01 1 1  ON 31
eH1_2                -6.162952e-02 1 1  ON 32
eH1_3                -2.530653e-02 1 1  ON 33
eH1_4                 4.247832e-03 1 1  ON 34
eH1_5                 2.367079e-02 1 1  ON 35
eH1_6                 6.569443e-02 1 1  ON 36
eH1_7                 1.154361e-01 1 1  ON 37
eH1_8                 1.435221e-01 1 1  ON 38
eH1_9                 7.467419e-02 1 1  ON 39
eH2_0                -2.307043e-01 1 1  ON 40
eH2_1                -1.139386e-01 1 1  ON 41
eH2_2                -6.444539e-02 1 1  ON 42
eH2_3                -2.722663e-02 1 1  ON 43
eH2_4                 1.073593e-03 1 1  ON 44
eH2_5                 2.532957e-02 1 1  ON 45
eH2_6                 7.564477e-02 1 1  ON 46
eH2_7                 1.260027e-01 1 1  ON 47
eH2_8                 1.609124e-01 1 1  ON 48
eH2_9                 6.417217e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.6040e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s058 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s058 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=58  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6896e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 58
    time step          = 0.05
    reference energy   = -16.9701
    reference variance = 0.157363
====================================================
  Execution time = 2.0681e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s058
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6899e+01
  VMC Evar = 2.9975e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.4892e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.299772996831
                                         uncertainty =       0.002707591639

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.299772996831
                                         uncertainty =       0.002707591639

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000387139142
  error estimate for blocks of size 2^( 2) =       0.000403706993
  error estimate for blocks of size 2^( 3) =       0.000420567499
  error estimate for blocks of size 2^( 4) =       0.000435358207
  error estimate for blocks of size 2^( 5) =       0.000444604151
  error estimate for blocks of size 2^( 6) =       0.000450871599
  error estimate for blocks of size 2^( 7) =       0.000456141081

      target function =      -0.913087414742
              le_mean =     -16.898692946395
             les_mean =     285.865576576518
             stat err =       0.000446743760
             autocorr =       1.331627710238
   target nu stat err =       0.000446743760
   target dn stat err =       0.002945886100
      target stat err =       0.004468966419
              std dev =       0.547497424507
             le_variance =       0.299753429842


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.689869294640e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 3.9062e+39, overlap shift 3.9062e+40 and omega -1.7456e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.913107826423       residual = 1.04e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.913107826423       residual = 1.04e-03           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.9062e+39 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 1.5625e+40, overlap shift 1.5625e+41 and omega -1.7456e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.913107826423       residual = 1.04e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.913107826423       residual = 1.04e-03           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.5625e+40 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 6.2500e+40, overlap shift 6.2500e+41 and omega -1.7456e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.913107826423       residual = 1.04e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.913107826423       residual = 1.04e-03           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 6.2500e+40 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               1.490648 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.6176e+01
  </log>
  <optVariables href="H2O.s058.opt.xml">
 uu_0                 2.517233e-01 1 1  ON 0
 uu_1                 1.009440e-01 1 1  ON 1
 uu_2                 1.617079e-02 1 1  ON 2
 uu_3                -3.223684e-02 1 1  ON 3
 uu_4                -6.387117e-02 1 1  ON 4
 uu_5                -8.576607e-02 1 1  ON 5
 uu_6                -1.001312e-01 1 1  ON 6
 uu_7                -1.065673e-01 1 1  ON 7
 uu_8                -9.668739e-02 1 1  ON 8
 uu_9                -6.389513e-02 1 1  ON 9
 ud_0                 3.492134e-01 1 1  ON 10
 ud_1                 1.235409e-01 1 1  ON 11
 ud_2                 2.392782e-02 1 1  ON 12
 ud_3                -3.019578e-02 1 1  ON 13
 ud_4                -6.975615e-02 1 1  ON 14
 ud_5                -9.484122e-02 1 1  ON 15
 ud_6                -1.085598e-01 1 1  ON 16
 ud_7                -1.109505e-01 1 1  ON 17
 ud_8                -9.792103e-02 1 1  ON 18
 ud_9                -6.281979e-02 1 1  ON 19
 eO_0                -5.692885e-01 1 1  ON 20
 eO_1                -3.060844e-01 1 1  ON 21
 eO_2                 4.730127e-02 1 1  ON 22
 eO_3                 2.840620e-01 1 1  ON 23
 eO_4                 3.913445e-01 1 1  ON 24
 eO_5                 3.212389e-01 1 1  ON 25
 eO_6                 1.205694e-01 1 1  ON 26
 eO_7                -7.888705e-02 1 1  ON 27
 eO_8                -1.549102e-01 1 1  ON 28
 eO_9                -6.122098e-02 1 1  ON 29
eH1_0                -2.277697e-01 1 1  ON 30
eH1_1                -1.106400e-01 1 1  ON 31
eH1_2                -6.162952e-02 1 1  ON 32
eH1_3                -2.530653e-02 1 1  ON 33
eH1_4                 4.247832e-03 1 1  ON 34
eH1_5                 2.367079e-02 1 1  ON 35
eH1_6                 6.569443e-02 1 1  ON 36
eH1_7                 1.154361e-01 1 1  ON 37
eH1_8                 1.435221e-01 1 1  ON 38
eH1_9                 7.467419e-02 1 1  ON 39
eH2_0                -2.307043e-01 1 1  ON 40
eH2_1                -1.139386e-01 1 1  ON 41
eH2_2                -6.444539e-02 1 1  ON 42
eH2_3                -2.722663e-02 1 1  ON 43
eH2_4                 1.073593e-03 1 1  ON 44
eH2_5                 2.532957e-02 1 1  ON 45
eH2_6                 7.564477e-02 1 1  ON 46
eH2_7                 1.260027e-01 1 1  ON 47
eH2_8                 1.609124e-01 1 1  ON 48
eH2_9                 6.417217e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 58
    time step          = 0.05
    reference energy   = -16.9264
    reference variance = 0.294774
====================================================
  Execution time = 2.0447e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s058
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6898e+01
  VMC Evar = 3.0350e-01
  Total weights = 2.0000e+06
  Execution time = 1.8628e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.303546244086
                                         uncertainty =       0.007239323018

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.303546244086
                                         uncertainty =       0.007239323018

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000389549000
  error estimate for blocks of size 2^( 2) =       0.000406640842
  error estimate for blocks of size 2^( 3) =       0.000424291352
  error estimate for blocks of size 2^( 4) =       0.000439326958
  error estimate for blocks of size 2^( 5) =       0.000451358352
  error estimate for blocks of size 2^( 6) =       0.000460290935
  error estimate for blocks of size 2^( 7) =       0.000463137972

      target function =      -0.907386806586
              le_mean =     -16.897816758149
             les_mean =     285.839707887037
             stat err =       0.000453528554
             autocorr =       1.355454936778
   target nu stat err =       0.000453528554
   target dn stat err =       0.007512049558
      target stat err =       0.011110486139
              std dev =       0.550905479000
             le_variance =       0.303496846793

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.303546244086
                                         uncertainty =       0.007239323018

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.303546244086
                                         uncertainty =       0.007239323018

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000389549000
  error estimate for blocks of size 2^( 2) =       0.000406640842
  error estimate for blocks of size 2^( 3) =       0.000424291352
  error estimate for blocks of size 2^( 4) =       0.000439326958
  error estimate for blocks of size 2^( 5) =       0.000451358352
  error estimate for blocks of size 2^( 6) =       0.000460290935
  error estimate for blocks of size 2^( 7) =       0.000463137972

      target function =      -0.907386806586
              le_mean =     -16.897816758149
             les_mean =     285.839707887037
             stat err =       0.000453528554
             autocorr =       1.355454936779
   target nu stat err =       0.000453528554
   target dn stat err =       0.007512049558
      target stat err =       0.011110486139
              std dev =       0.550905479000
             le_variance =       0.303496846793

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.303546244086
                                         uncertainty =       0.007239323018

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.303546244086
                                         uncertainty =       0.007239323018

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000389549000
  error estimate for blocks of size 2^( 2) =       0.000406640842
  error estimate for blocks of size 2^( 3) =       0.000424291352
  error estimate for blocks of size 2^( 4) =       0.000439326958
  error estimate for blocks of size 2^( 5) =       0.000451358352
  error estimate for blocks of size 2^( 6) =       0.000460290935
  error estimate for blocks of size 2^( 7) =       0.000463137972

      target function =      -0.907386806586
              le_mean =     -16.897816758149
             les_mean =     285.839707887037
             stat err =       0.000453528554
             autocorr =       1.355454936779
   target nu stat err =       0.000453528554
   target dn stat err =       0.007512049558
      target stat err =       0.011110486139
              std dev =       0.550905479000
             le_variance =       0.303496846793

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.303546244086
                                         uncertainty =       0.007239323018

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.303546244086
                                         uncertainty =       0.007239323018

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000389549000
  error estimate for blocks of size 2^( 2) =       0.000406640842
  error estimate for blocks of size 2^( 3) =       0.000424291352
  error estimate for blocks of size 2^( 4) =       0.000439326958
  error estimate for blocks of size 2^( 5) =       0.000451358352
  error estimate for blocks of size 2^( 6) =       0.000460290935
  error estimate for blocks of size 2^( 7) =       0.000463137972

      target function =      -0.907386806586
              le_mean =     -16.897816758149
             les_mean =     285.839707887037
             stat err =       0.000453528554
             autocorr =       1.355454936779
   target nu stat err =       0.000453528554
   target dn stat err =       0.007512049558
      target stat err =       0.011110486139
              std dev =       0.550905479000
             le_variance =       0.303496846793


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.907386806586        initial  <--
     3.9062e+39     3.9062e+40             0.0000e+00        -0.907386806586
     1.5625e+40     1.5625e+41             0.0000e+00        -0.907386806586
     6.2500e+40     6.2500e+41             0.0000e+00        -0.907386806586

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 29.8660
  </log>
  <optVariables href="H2O.s058.opt.xml">
 uu_0                 2.517233e-01 1 1  ON 0
 uu_1                 1.009440e-01 1 1  ON 1
 uu_2                 1.617079e-02 1 1  ON 2
 uu_3                -3.223684e-02 1 1  ON 3
 uu_4                -6.387117e-02 1 1  ON 4
 uu_5                -8.576607e-02 1 1  ON 5
 uu_6                -1.001312e-01 1 1  ON 6
 uu_7                -1.065673e-01 1 1  ON 7
 uu_8                -9.668739e-02 1 1  ON 8
 uu_9                -6.389513e-02 1 1  ON 9
 ud_0                 3.492134e-01 1 1  ON 10
 ud_1                 1.235409e-01 1 1  ON 11
 ud_2                 2.392782e-02 1 1  ON 12
 ud_3                -3.019578e-02 1 1  ON 13
 ud_4                -6.975615e-02 1 1  ON 14
 ud_5                -9.484122e-02 1 1  ON 15
 ud_6                -1.085598e-01 1 1  ON 16
 ud_7                -1.109505e-01 1 1  ON 17
 ud_8                -9.792103e-02 1 1  ON 18
 ud_9                -6.281979e-02 1 1  ON 19
 eO_0                -5.692885e-01 1 1  ON 20
 eO_1                -3.060844e-01 1 1  ON 21
 eO_2                 4.730127e-02 1 1  ON 22
 eO_3                 2.840620e-01 1 1  ON 23
 eO_4                 3.913445e-01 1 1  ON 24
 eO_5                 3.212389e-01 1 1  ON 25
 eO_6                 1.205694e-01 1 1  ON 26
 eO_7                -7.888705e-02 1 1  ON 27
 eO_8                -1.549102e-01 1 1  ON 28
 eO_9                -6.122098e-02 1 1  ON 29
eH1_0                -2.277697e-01 1 1  ON 30
eH1_1                -1.106400e-01 1 1  ON 31
eH1_2                -6.162952e-02 1 1  ON 32
eH1_3                -2.530653e-02 1 1  ON 33
eH1_4                 4.247832e-03 1 1  ON 34
eH1_5                 2.367079e-02 1 1  ON 35
eH1_6                 6.569443e-02 1 1  ON 36
eH1_7                 1.154361e-01 1 1  ON 37
eH1_8                 1.435221e-01 1 1  ON 38
eH1_9                 7.467419e-02 1 1  ON 39
eH2_0                -2.307043e-01 1 1  ON 40
eH2_1                -1.139386e-01 1 1  ON 41
eH2_2                -6.444539e-02 1 1  ON 42
eH2_3                -2.722663e-02 1 1  ON 43
eH2_4                 1.073593e-03 1 1  ON 44
eH2_5                 2.532957e-02 1 1  ON 45
eH2_6                 7.564477e-02 1 1  ON 46
eH2_7                 1.260027e-01 1 1  ON 47
eH2_8                 1.609124e-01 1 1  ON 48
eH2_9                 6.417217e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.6049e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s059 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s059 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=59  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6897e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 59
    time step          = 0.05
    reference energy   = -16.8864
    reference variance = 0.239627
====================================================
  Execution time = 2.2499e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s059
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6897e+01
  VMC Evar = 2.9121e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.5519e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.291066175593
                                         uncertainty =       0.002464471250

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.291066175593
                                         uncertainty =       0.002464471250

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000381584354
  error estimate for blocks of size 2^( 2) =       0.000398621915
  error estimate for blocks of size 2^( 3) =       0.000416421721
  error estimate for blocks of size 2^( 4) =       0.000431550100
  error estimate for blocks of size 2^( 5) =       0.000444526667
  error estimate for blocks of size 2^( 6) =       0.000451210429
  error estimate for blocks of size 2^( 7) =       0.000454567517

      target function =      -0.925989284790
              le_mean =     -16.897471916044
             les_mean =     285.815770245986
             stat err =       0.000445463678
             autocorr =       1.362835630892
   target nu stat err =       0.000445463678
   target dn stat err =       0.002411115490
      target stat err =       0.003775812575
              std dev =       0.539641768305
             le_variance =       0.291213238100


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.689747191604e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 3.9062e+40, overlap shift 3.9062e+41 and omega -1.7456e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.926003281446       residual = 1.50e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.926003281446       residual = 8.27e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.926003281446       residual = 3.26e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.926003281446       residual = 1.50e-03           smallest_sin_value = 1.00e+00
davidson iteration    4 stopping due to too large eigenvalue change
davidson solver did not converge after          4 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.9062e+40 is 2.784717e-45

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 1.5625e+41, overlap shift 1.5625e+42 and omega -1.7456e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.926003281446       residual = 1.50e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.926003281446       residual = 8.27e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.926003281446       residual = 3.26e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.926003281446       residual = 1.50e-03           smallest_sin_value = 1.00e+00
davidson iteration    4 stopping due to too large eigenvalue change
davidson solver did not converge after          4 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.5625e+41 is 6.961792e-46

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 6.2500e+41, overlap shift 6.2500e+42 and omega -1.7456e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.926003281446       residual = 1.50e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.926003281446       residual = 8.27e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.926003281446       residual = 3.26e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.926003281446       residual = 1.50e-03           smallest_sin_value = 1.00e+00
davidson iteration    4 stopping due to too large eigenvalue change
davidson solver did not converge after          4 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 6.2500e+41 is 1.740448e-46

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               1.492295 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.8058e+01
  </log>
  <optVariables href="H2O.s059.opt.xml">
 uu_0                 2.517233e-01 1 1  ON 0
 uu_1                 1.009440e-01 1 1  ON 1
 uu_2                 1.617079e-02 1 1  ON 2
 uu_3                -3.223684e-02 1 1  ON 3
 uu_4                -6.387117e-02 1 1  ON 4
 uu_5                -8.576607e-02 1 1  ON 5
 uu_6                -1.001312e-01 1 1  ON 6
 uu_7                -1.065673e-01 1 1  ON 7
 uu_8                -9.668739e-02 1 1  ON 8
 uu_9                -6.389513e-02 1 1  ON 9
 ud_0                 3.492134e-01 1 1  ON 10
 ud_1                 1.235409e-01 1 1  ON 11
 ud_2                 2.392782e-02 1 1  ON 12
 ud_3                -3.019578e-02 1 1  ON 13
 ud_4                -6.975615e-02 1 1  ON 14
 ud_5                -9.484122e-02 1 1  ON 15
 ud_6                -1.085598e-01 1 1  ON 16
 ud_7                -1.109505e-01 1 1  ON 17
 ud_8                -9.792103e-02 1 1  ON 18
 ud_9                -6.281979e-02 1 1  ON 19
 eO_0                -5.692885e-01 1 1  ON 20
 eO_1                -3.060844e-01 1 1  ON 21
 eO_2                 4.730127e-02 1 1  ON 22
 eO_3                 2.840620e-01 1 1  ON 23
 eO_4                 3.913445e-01 1 1  ON 24
 eO_5                 3.212389e-01 1 1  ON 25
 eO_6                 1.205694e-01 1 1  ON 26
 eO_7                -7.888705e-02 1 1  ON 27
 eO_8                -1.549102e-01 1 1  ON 28
 eO_9                -6.122098e-02 1 1  ON 29
eH1_0                -2.277697e-01 1 1  ON 30
eH1_1                -1.106400e-01 1 1  ON 31
eH1_2                -6.162952e-02 1 1  ON 32
eH1_3                -2.530653e-02 1 1  ON 33
eH1_4                 4.247832e-03 1 1  ON 34
eH1_5                 2.367079e-02 1 1  ON 35
eH1_6                 6.569443e-02 1 1  ON 36
eH1_7                 1.154361e-01 1 1  ON 37
eH1_8                 1.435221e-01 1 1  ON 38
eH1_9                 7.467419e-02 1 1  ON 39
eH2_0                -2.307043e-01 1 1  ON 40
eH2_1                -1.139386e-01 1 1  ON 41
eH2_2                -6.444539e-02 1 1  ON 42
eH2_3                -2.722663e-02 1 1  ON 43
eH2_4                 1.073593e-03 1 1  ON 44
eH2_5                 2.532957e-02 1 1  ON 45
eH2_6                 7.564477e-02 1 1  ON 46
eH2_7                 1.260027e-01 1 1  ON 47
eH2_8                 1.609124e-01 1 1  ON 48
eH2_9                 6.417217e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 59
    time step          = 0.05
    reference energy   = -16.9256
    reference variance = 0.141281
====================================================
  Execution time = 2.0212e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s059
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6898e+01
  VMC Evar = 2.9443e-01
  Total weights = 2.0000e+06
  Execution time = 1.8648e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.294379358003
                                         uncertainty =       0.004244266685

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.294379358003
                                         uncertainty =       0.004244266685

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000383689246
  error estimate for blocks of size 2^( 2) =       0.000400640960
  error estimate for blocks of size 2^( 3) =       0.000417916095
  error estimate for blocks of size 2^( 4) =       0.000433773329
  error estimate for blocks of size 2^( 5) =       0.000444861927
  error estimate for blocks of size 2^( 6) =       0.000450638540
  error estimate for blocks of size 2^( 7) =       0.000450671257

      target function =      -0.921068105781
              le_mean =     -16.898144126298
             les_mean =     285.841709640545
             stat err =       0.000444986263
             autocorr =       1.345036144858
   target nu stat err =       0.000444986263
   target dn stat err =       0.004234215885
      target stat err =       0.006483458335
              std dev =       0.542618535087
             le_variance =       0.294434874620

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.294379358003
                                         uncertainty =       0.004244266685

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.294379358003
                                         uncertainty =       0.004244266685

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000383689246
  error estimate for blocks of size 2^( 2) =       0.000400640960
  error estimate for blocks of size 2^( 3) =       0.000417916095
  error estimate for blocks of size 2^( 4) =       0.000433773329
  error estimate for blocks of size 2^( 5) =       0.000444861927
  error estimate for blocks of size 2^( 6) =       0.000450638540
  error estimate for blocks of size 2^( 7) =       0.000450671257

      target function =      -0.921068105781
              le_mean =     -16.898144126298
             les_mean =     285.841709640545
             stat err =       0.000444986263
             autocorr =       1.345036144858
   target nu stat err =       0.000444986263
   target dn stat err =       0.004234215885
      target stat err =       0.006483458335
              std dev =       0.542618535087
             le_variance =       0.294434874620

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.294379358003
                                         uncertainty =       0.004244266685

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.294379358003
                                         uncertainty =       0.004244266685

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000383689246
  error estimate for blocks of size 2^( 2) =       0.000400640960
  error estimate for blocks of size 2^( 3) =       0.000417916095
  error estimate for blocks of size 2^( 4) =       0.000433773329
  error estimate for blocks of size 2^( 5) =       0.000444861927
  error estimate for blocks of size 2^( 6) =       0.000450638540
  error estimate for blocks of size 2^( 7) =       0.000450671257

      target function =      -0.921068105781
              le_mean =     -16.898144126298
             les_mean =     285.841709640545
             stat err =       0.000444986263
             autocorr =       1.345036144858
   target nu stat err =       0.000444986263
   target dn stat err =       0.004234215885
      target stat err =       0.006483458335
              std dev =       0.542618535087
             le_variance =       0.294434874620

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.294379358003
                                         uncertainty =       0.004244266685

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.294379358003
                                         uncertainty =       0.004244266685

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000383689246
  error estimate for blocks of size 2^( 2) =       0.000400640960
  error estimate for blocks of size 2^( 3) =       0.000417916095
  error estimate for blocks of size 2^( 4) =       0.000433773329
  error estimate for blocks of size 2^( 5) =       0.000444861927
  error estimate for blocks of size 2^( 6) =       0.000450638540
  error estimate for blocks of size 2^( 7) =       0.000450671257

      target function =      -0.921068105781
              le_mean =     -16.898144126298
             les_mean =     285.841709640545
             stat err =       0.000444986263
             autocorr =       1.345036144858
   target nu stat err =       0.000444986263
   target dn stat err =       0.004234215885
      target stat err =       0.006483458335
              std dev =       0.542618535087
             le_variance =       0.294434874620


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.921068105781        initial  <--
     3.9062e+40     3.9062e+41             2.7847e-45        -0.921068105781
     1.5625e+41     1.5625e+42             6.9618e-46        -0.921068105781
     6.2500e+41     6.2500e+42             1.7404e-46        -0.921068105781

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 29.6541
  </log>
  <optVariables href="H2O.s059.opt.xml">
 uu_0                 2.517233e-01 1 1  ON 0
 uu_1                 1.009440e-01 1 1  ON 1
 uu_2                 1.617079e-02 1 1  ON 2
 uu_3                -3.223684e-02 1 1  ON 3
 uu_4                -6.387117e-02 1 1  ON 4
 uu_5                -8.576607e-02 1 1  ON 5
 uu_6                -1.001312e-01 1 1  ON 6
 uu_7                -1.065673e-01 1 1  ON 7
 uu_8                -9.668739e-02 1 1  ON 8
 uu_9                -6.389513e-02 1 1  ON 9
 ud_0                 3.492134e-01 1 1  ON 10
 ud_1                 1.235409e-01 1 1  ON 11
 ud_2                 2.392782e-02 1 1  ON 12
 ud_3                -3.019578e-02 1 1  ON 13
 ud_4                -6.975615e-02 1 1  ON 14
 ud_5                -9.484122e-02 1 1  ON 15
 ud_6                -1.085598e-01 1 1  ON 16
 ud_7                -1.109505e-01 1 1  ON 17
 ud_8                -9.792103e-02 1 1  ON 18
 ud_9                -6.281979e-02 1 1  ON 19
 eO_0                -5.692885e-01 1 1  ON 20
 eO_1                -3.060844e-01 1 1  ON 21
 eO_2                 4.730127e-02 1 1  ON 22
 eO_3                 2.840620e-01 1 1  ON 23
 eO_4                 3.913445e-01 1 1  ON 24
 eO_5                 3.212389e-01 1 1  ON 25
 eO_6                 1.205694e-01 1 1  ON 26
 eO_7                -7.888705e-02 1 1  ON 27
 eO_8                -1.549102e-01 1 1  ON 28
 eO_9                -6.122098e-02 1 1  ON 29
eH1_0                -2.277697e-01 1 1  ON 30
eH1_1                -1.106400e-01 1 1  ON 31
eH1_2                -6.162952e-02 1 1  ON 32
eH1_3                -2.530653e-02 1 1  ON 33
eH1_4                 4.247832e-03 1 1  ON 34
eH1_5                 2.367079e-02 1 1  ON 35
eH1_6                 6.569443e-02 1 1  ON 36
eH1_7                 1.154361e-01 1 1  ON 37
eH1_8                 1.435221e-01 1 1  ON 38
eH1_9                 7.467419e-02 1 1  ON 39
eH2_0                -2.307043e-01 1 1  ON 40
eH2_1                -1.139386e-01 1 1  ON 41
eH2_2                -6.444539e-02 1 1  ON 42
eH2_3                -2.722663e-02 1 1  ON 43
eH2_4                 1.073593e-03 1 1  ON 44
eH2_5                 2.532957e-02 1 1  ON 45
eH2_6                 7.564477e-02 1 1  ON 46
eH2_7                 1.260027e-01 1 1  ON 47
eH2_8                 1.609124e-01 1 1  ON 48
eH2_9                 6.417217e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.7718e+01 secs
  Total Execution time = 3.4381e+03 secs

=========================================================
  A new xml input file : H2O.s059.cont.xml
