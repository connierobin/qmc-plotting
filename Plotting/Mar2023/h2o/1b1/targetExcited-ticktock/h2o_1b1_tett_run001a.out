Rank =    0  Free Memory = 88949 MB
Rank =    1  Free Memory = 88947 MB
Rank =    2  Free Memory = 88947 MB
Rank =    3  Free Memory = 88947 MB
Rank =    4  Free Memory = 88947 MB
Rank =    5  Free Memory = 88947 MB
Rank =    6  Free Memory = 88947 MB
Rank =    7  Free Memory = 88947 MB
Rank =    8  Free Memory = 88947 MB
Rank =    9  Free Memory = 88947 MB
Rank =   10  Free Memory = 88947 MB
Rank =   11  Free Memory = 88947 MB
Rank =   12  Free Memory = 88947 MB
Rank =   13  Free Memory = 88945 MB
Rank =   14  Free Memory = 88945 MB
Rank =   15  Free Memory = 88929 MB
Rank =   16  Free Memory = 88925 MB
Rank =   17  Free Memory = 88925 MB
Rank =   18  Free Memory = 88925 MB
Rank =   19  Free Memory = 88925 MB
Rank =   20  Free Memory = 88925 MB
Rank =   21  Free Memory = 88925 MB
Rank =   22  Free Memory = 88925 MB
Rank =   23  Free Memory = 88925 MB
Rank =   24  Free Memory = 88925 MB
Rank =   25  Free Memory = 88925 MB
Rank =   26  Free Memory = 88925 MB
Rank =   27  Free Memory = 88925 MB
Rank =   28  Free Memory = 88925 MB
Rank =   29  Free Memory = 88925 MB
Rank =   30  Free Memory = 88925 MB
Rank =   31  Free Memory = 88925 MB
Rank =   32  Free Memory = 88925 MB
Rank =   33  Free Memory = 88925 MB
Rank =   34  Free Memory = 88925 MB
Rank =   35  Free Memory = 88925 MB
Rank =   36  Free Memory = 88925 MB
Rank =   37  Free Memory = 88925 MB
Rank =   38  Free Memory = 88925 MB
Rank =   39  Free Memory = 88925 MB
Rank =   40  Free Memory = 89070 MB
Rank =   41  Free Memory = 89070 MB
Rank =   42  Free Memory = 89070 MB
Rank =   43  Free Memory = 89070 MB
Rank =   44  Free Memory = 89070 MB
Rank =   45  Free Memory = 89070 MB
Rank =   46  Free Memory = 89070 MB
Rank =   47  Free Memory = 89070 MB
Rank =   48  Free Memory = 89070 MB
Rank =   49  Free Memory = 89069 MB
Rank =   50  Free Memory = 89069 MB
Rank =   51  Free Memory = 89069 MB
Rank =   52  Free Memory = 89069 MB
Rank =   53  Free Memory = 89069 MB
Rank =   54  Free Memory = 89069 MB
Rank =   55  Free Memory = 89069 MB
Rank =   56  Free Memory = 89069 MB
Rank =   57  Free Memory = 89069 MB
Rank =   58  Free Memory = 89069 MB
Rank =   59  Free Memory = 89069 MB
Rank =   60  Free Memory = 89069 MB
Rank =   61  Free Memory = 89069 MB
Rank =   62  Free Memory = 89069 MB
Rank =   63  Free Memory = 89069 MB
Rank =   64  Free Memory = 89069 MB
Rank =   65  Free Memory = 89069 MB
Rank =   66  Free Memory = 89069 MB
Rank =   67  Free Memory = 89069 MB
Rank =   68  Free Memory = 89069 MB
Rank =   69  Free Memory = 89069 MB
Rank =   70  Free Memory = 89069 MB
Rank =   71  Free Memory = 89069 MB
Rank =   72  Free Memory = 89069 MB
Rank =   73  Free Memory = 89069 MB
Rank =   74  Free Memory = 89069 MB
Rank =   75  Free Memory = 89069 MB
Rank =   76  Free Memory = 89069 MB
Rank =   77  Free Memory = 89069 MB
Rank =   78  Free Memory = 89069 MB
Rank =   79  Free Memory = 89069 MB
Rank =   80  Free Memory = 88995 MB
Rank =   81  Free Memory = 88995 MB
Rank =   82  Free Memory = 88995 MB
Rank =   83  Free Memory = 88995 MB
Rank =   84  Free Memory = 88995 MB
Rank =   85  Free Memory = 88995 MB
Rank =   86  Free Memory = 88995 MB
Rank =   87  Free Memory = 88995 MB
Rank =   88  Free Memory = 88995 MB
Rank =   89  Free Memory = 88995 MB
Rank =   90  Free Memory = 88995 MB
Rank =   91  Free Memory = 88995 MB
Rank =   92  Free Memory = 88995 MB
Rank =   93  Free Memory = 88995 MB
Rank =   94  Free Memory = 88995 MB
Rank =   95  Free Memory = 88995 MB
Rank =   96  Free Memory = 88995 MB
Rank =   97  Free Memory = 88995 MB
Rank =   98  Free Memory = 88995 MB
Rank =   99  Free Memory = 88995 MB
Rank =  100  Free Memory = 88995 MB
Rank =  101  Free Memory = 88995 MB
Rank =  102  Free Memory = 88995 MB
Rank =  103  Free Memory = 88995 MB
Rank =  104  Free Memory = 88995 MB
Rank =  105  Free Memory = 88995 MB
Rank =  106  Free Memory = 88995 MB
Rank =  107  Free Memory = 88995 MB
Rank =  108  Free Memory = 88995 MB
Rank =  109  Free Memory = 88995 MB
Rank =  110  Free Memory = 88995 MB
Rank =  111  Free Memory = 88995 MB
Rank =  112  Free Memory = 88995 MB
Rank =  113  Free Memory = 88995 MB
Rank =  114  Free Memory = 88995 MB
Rank =  115  Free Memory = 88995 MB
Rank =  116  Free Memory = 88995 MB
Rank =  117  Free Memory = 88995 MB
Rank =  118  Free Memory = 88995 MB
Rank =  119  Free Memory = 88995 MB
Rank =  120  Free Memory = 91401 MB
Rank =  121  Free Memory = 91401 MB
Rank =  122  Free Memory = 91401 MB
Rank =  123  Free Memory = 91401 MB
Rank =  124  Free Memory = 91401 MB
Rank =  125  Free Memory = 91401 MB
Rank =  126  Free Memory = 91401 MB
Rank =  127  Free Memory = 91401 MB
  Input file(s): opt_h2o_1b1_tett_run001a.xml 

=====================================================
                    QMCPACK 3.7.9

       (c) Copyright 2003-  QMCPACK developers

                    Please cite:
 J. Kim et al. J. Phys. Cond. Mat. 30 195901 (2018)
      https://doi.org/10.1088/1361-648X/aab9c3

  Git branch: gvp
  Last git commit: a1d851bbe8d902a0d3168a885b757a378aeaab54-dirty
  Last git commit date: Mon Feb 13 11:52:39 2023 -0800
  Last git commit subject: Print param update magnitude and largest update
=====================================================
  Global options 

  Total number of MPI ranks = 128
  Number of MPI groups      = 1
  MPI group ID              = 0
  Number of ranks in group  = 128
  MPI ranks per node        = 40
  OMP 1st level threads     = 1
  OMP nested threading disabled or only 1 thread on the 2nd level

  Precision used in this calculation, see definitions in the manual:
  Base precision      = double
  Full precision      = double

  Structure-of-arrays (SoA) optimization enabled

  Input XML = opt_h2o_1b1_tett_run001a.xml

  Project = H2O
  date    = 2023-03-06 11:13:59 PST
  host    = n0126.savio3

 Random Number
 -------------
  Offset for the random number seeds based on time: 887

  Range of prime numbers to use as seeds over processors and threads = 6911-8089


 Particle Set 
 ------------
  Name: e
  All the species have the same mass 1
  Particle set size: 8

 Particle Set 
 ------------
  Name: ion0
  All the species have the same mass 1
  Particle set size: 3

 Wavefunction setup: 
 ------------------- 
  Name: psi0

   Jastrow
   -------
    Name: J2   Type: Two-Body   Function: Bspline

    Radial function for species: u - u
     Number of parameters: 10
     Cusp: -0.25
     Cutoff radius: 10

     Name                        Value Type Recompute Use Index
     ---- ---------------------------- ---- --------- --- -----
     uu_0                 3.027108e-01    1         1 OFF
     uu_1                 1.395499e-01    1         1 OFF
     uu_2                 4.158458e-02    1         1 OFF
     uu_3                -1.946409e-02    1         1 OFF
     uu_4                -6.333239e-02    1         1 OFF
     uu_5                -9.587524e-02    1         1 OFF
     uu_6                -1.205706e-01    1         1 OFF
     uu_7                -1.310580e-01    1         1 OFF
     uu_8                -1.203232e-01    1         1 OFF
     uu_9                -9.277332e-02    1         1 OFF

    Radial function for species: u - d
     Number of parameters: 10
     Cusp: -5.000000e-01
     Cutoff radius: 1.000000e+01

     Name                        Value Type Recompute Use Index
     ---- ---------------------------- ---- --------- --- -----
     ud_0                 4.114416e-01    1         1 OFF
     ud_1                 1.583401e-01    1         1 OFF
     ud_2                 6.092685e-02    1         1 OFF
     ud_3                 2.699750e-03    1         1 OFF
     ud_4                -5.713986e-02    1         1 OFF
     ud_5                -1.014997e-01    1         1 OFF
     ud_6                -1.286687e-01    1         1 OFF
     ud_7                -1.435029e-01    1         1 OFF
     ud_8                -1.424319e-01    1         1 OFF
     ud_9                -1.344547e-01    1         1 OFF


   Jastrow
   -------
    Name: J1   Type: One-Body   Function: Bspline

    Radial function for element: O
     Number of parameters: 10
     Cusp: 0.000000e+00
     Cutoff radius: 1.000000e+01

     Name                        Value Type Recompute Use Index
     ---- ---------------------------- ---- --------- --- -----
     eO_0                -7.043100e-01    1         1 OFF
     eO_1                -4.137154e-01    1         1 OFF
     eO_2                -3.185752e-02    1         1 OFF
     eO_3                 2.692030e-01    1         1 OFF
     eO_4                 4.916456e-01    1         1 OFF
     eO_5                 4.596091e-01    1         1 OFF
     eO_6                 2.360353e-01    1         1 OFF
     eO_7                -5.591968e-02    1         1 OFF
     eO_8                -1.959242e-01    1         1 OFF
     eO_9                -5.768884e-02    1         1 OFF

    Radial function for element: H1
     Number of parameters: 10
     Cusp: 0.000000e+00
     Cutoff radius: 1.000000e+01

      Name                        Value Type Recompute Use Index
     ----- ---------------------------- ---- --------- --- -----
     eH1_0                -2.099404e-01    1         1 OFF
     eH1_1                -1.274877e-01    1         1 OFF
     eH1_2                -8.838243e-02    1         1 OFF
     eH1_3                -3.738645e-02    1         1 OFF
     eH1_4                 1.159942e-02    1         1 OFF
     eH1_5                 4.473069e-02    1         1 OFF
     eH1_6                 9.476145e-02    1         1 OFF
     eH1_7                 1.381756e-01    1         1 OFF
     eH1_8                 1.456924e-01    1         1 OFF
     eH1_9                 3.283823e-02    1         1 OFF

    Radial function for element: H2
     Number of parameters: 10
     Cusp: 0.000000e+00
     Cutoff radius: 1.000000e+01

      Name                        Value Type Recompute Use Index
     ----- ---------------------------- ---- --------- --- -----
     eH2_0                -2.088198e-01    1         1 OFF
     eH2_1                -1.265485e-01    1         1 OFF
     eH2_2                -8.741031e-02    1         1 OFF
     eH2_3                -3.640778e-02    1         1 OFF
     eH2_4                 1.289653e-02    1         1 OFF
     eH2_5                 4.794967e-02    1         1 OFF
     eH2_6                 1.006131e-01    1         1 OFF
     eH2_7                 1.496008e-01    1         1 OFF
     eH2_8                 1.537439e-01    1         1 OFF
     eH2_9                 1.292423e-02    1         1 OFF

  Created SPOSet builder named 'LCAOBSet' of type molecularorbital
  LCAO: SoaAtomicBasisSet<MultiQuintic,0>
  AO BasisSet for O
   Angular momentum expanded in cartesian functions x^lx y^ly z^lz according to Gamess
Using log grid with default values: ri = 1.000000e-06 rf = 1.000000e+02 npts = 1001
   R(n,l,m,s) 0 0 0 0
   R(n,l,m,s) 1 0 0 0
   R(n,l,m,s) 2 1 0 0
   R(n,l,m,s) 3 1 0 0
   R(n,l,m,s) 4 2 0 0
Expanding Ylm (angular function) according to Gamess using cartesian gaussians
Adding 1 cartesian gaussian orbitals for l= 0
Adding 1 cartesian gaussian orbitals for l= 0
Adding 3 cartesian gaussian orbitals for l= 1
Adding 3 cartesian gaussian orbitals for l= 1
Adding 6 cartesian gaussian orbitals for l= 2
  Setting cutoff radius 1.018591e+01

   Maximum Angular Momentum  = 2
   Number of Radial functors = 5
   Basis size                = 14

  AO BasisSet for H1
   Angular momentum expanded in cartesian functions x^lx y^ly z^lz according to Gamess
Using log grid with default values: ri = 1.000000e-06 rf = 1.000000e+02 npts = 1001
   R(n,l,m,s) 0 0 0 0
   R(n,l,m,s) 1 0 0 0
   R(n,l,m,s) 2 1 0 0
Expanding Ylm (angular function) according to Gamess using cartesian gaussians
Adding 1 cartesian gaussian orbitals for l= 0
Adding 1 cartesian gaussian orbitals for l= 0
Adding 3 cartesian gaussian orbitals for l= 1
  Setting cutoff radius 1.270574e+01

   Maximum Angular Momentum  = 1
   Number of Radial functors = 3
   Basis size                = 5

  AO BasisSet for H2
   Angular momentum expanded in cartesian functions x^lx y^ly z^lz according to Gamess
Using log grid with default values: ri = 1.000000e-06 rf = 1.000000e+02 npts = 1001
   R(n,l,m,s) 0 0 0 0
   R(n,l,m,s) 1 0 0 0
   R(n,l,m,s) 2 1 0 0
Expanding Ylm (angular function) according to Gamess using cartesian gaussians
Adding 1 cartesian gaussian orbitals for l= 0
Adding 1 cartesian gaussian orbitals for l= 0
Adding 3 cartesian gaussian orbitals for l= 1
  Setting cutoff radius 1.270574e+01

   Maximum Angular Momentum  = 1
   Number of Radial functors = 3
   Basis size                = 5

Creating SPOSet in SlaterDetBuilder::put(xmlNodePtr cur).
spo_name = spo-up
  Building SPOSet 'spo-up' with '' basis set.
Creating SPOSet in SlaterDetBuilder::put(xmlNodePtr cur).
spo_name = spo-dn
  Building SPOSet 'spo-dn' with '' basis set.
Using Bryan's algorithm for MultiSlaterDeterminant expansion. 
Creating base determinant (up) for MSD expansion. 
Creating base determinant (down) for MSD expansion. 
Found determinant list. 
Reading CI expansion.
Found 75 terms in the MSD expansion.
Norm of ci vector (sum of ci^2): 9.913765e-01
Norm of qchem ci vector (sum of qchem_ci^2): 0.000000e+00
Found 30 unique up determinants.
Found 30 unique down determinants.
Number of terms in pairs array: 20
Number of terms in pairs array: 20
CI coefficients are optimizable. 
  FermionWF = MultiSlaterDeterminantFast
  QMCHamiltonian::addOperator Kinetic to H, physical Hamiltonian 
  QMCHamiltonian::addOperator ElecElec to H, physical Hamiltonian 
QMCHamiltonian::addOperatorType added type coulomb named ElecElec

  ECPotential builder for pseudopotential 

  Adding pseudopotential for O
   Linear grid  ri=0.000000e+00 rf=1.000000e+01 npts = 10001
    ECPComponentBuilder::buildSemiLocalAndLocal 
    Assuming Hartree unit
   Number of angular momentum channels 2
   Maximum angular momentum channel 1
   Creating a Linear Grid Rmax=1.075000e+00
  Using global grid with delta = 1.000000e-03
   Making L=1 a local potential with a radial cutoff of 9.999000e+00
    Non-local pseudopotential parameters
    Maximum angular mementum = 0
    Number of non-local channels = 1
       l(0)=0
    Cutoff radius = 1.075000e+00
    Spherical grids and weights: 
         1.0000000000e+00  0.0000000000e+00  0.0000000000e+00    8.3333333333e-02
        -1.0000000000e+00  1.2246467991e-16  0.0000000000e+00    8.3333333333e-02
         4.4721359550e-01  8.9442719100e-01  0.0000000000e+00    8.3333333333e-02
        -4.4721359550e-01  7.2360679775e-01  5.2573111212e-01    8.3333333333e-02
         4.4721359550e-01  2.7639320225e-01  8.5065080835e-01    8.3333333333e-02
        -4.4721359550e-01 -2.7639320225e-01  8.5065080835e-01    8.3333333333e-02
         4.4721359550e-01 -7.2360679775e-01  5.2573111212e-01    8.3333333333e-02
        -4.4721359550e-01 -8.9442719100e-01  1.0953573965e-16    8.3333333333e-02
         4.4721359550e-01 -7.2360679775e-01 -5.2573111212e-01    8.3333333333e-02
        -4.4721359550e-01 -2.7639320225e-01 -8.5065080835e-01    8.3333333333e-02
         4.4721359550e-01  2.7639320225e-01 -8.5065080835e-01    8.3333333333e-02
        -4.4721359550e-01  7.2360679775e-01 -5.2573111212e-01    8.3333333333e-02
    Maximum cutoff radius 1.0750000000e+00

  Adding pseudopotential for H1
   Linear grid  ri=0.0000000000e+00 rf=1.0000000000e+01 npts = 10001
    ECPComponentBuilder::buildSemiLocalAndLocal 
    Assuming Hartree unit
   Number of angular momentum channels 2
   Maximum angular momentum channel 1
   Creating a Linear Grid Rmax=1.0000000000e-10
  Using global grid with delta = 1.0000000000e-03
   Making L=1 a local potential with a radial cutoff of 9.9990000000e+00
    Non-local pseudopotential parameters
    Maximum angular mementum = 0
    Number of non-local channels = 1
       l(0)=0
    Cutoff radius = 1.0000000000e-03
    Spherical grids and weights: 
         1.0000000000e+00  0.0000000000e+00  0.0000000000e+00    8.3333333333e-02
        -1.0000000000e+00  1.2246467991e-16  0.0000000000e+00    8.3333333333e-02
         4.4721359550e-01  8.9442719100e-01  0.0000000000e+00    8.3333333333e-02
        -4.4721359550e-01  7.2360679775e-01  5.2573111212e-01    8.3333333333e-02
         4.4721359550e-01  2.7639320225e-01  8.5065080835e-01    8.3333333333e-02
        -4.4721359550e-01 -2.7639320225e-01  8.5065080835e-01    8.3333333333e-02
         4.4721359550e-01 -7.2360679775e-01  5.2573111212e-01    8.3333333333e-02
        -4.4721359550e-01 -8.9442719100e-01  1.0953573965e-16    8.3333333333e-02
         4.4721359550e-01 -7.2360679775e-01 -5.2573111212e-01    8.3333333333e-02
        -4.4721359550e-01 -2.7639320225e-01 -8.5065080835e-01    8.3333333333e-02
         4.4721359550e-01  2.7639320225e-01 -8.5065080835e-01    8.3333333333e-02
        -4.4721359550e-01  7.2360679775e-01 -5.2573111212e-01    8.3333333333e-02
    Maximum cutoff radius 1.0000000000e-03

  Adding pseudopotential for H2
   Linear grid  ri=0.0000000000e+00 rf=1.0000000000e+01 npts = 10001
    ECPComponentBuilder::buildSemiLocalAndLocal 
    Assuming Hartree unit
   Number of angular momentum channels 2
   Maximum angular momentum channel 1
   Creating a Linear Grid Rmax=1.0000000000e-10
  Using global grid with delta = 1.0000000000e-03
   Making L=1 a local potential with a radial cutoff of 9.9990000000e+00
    Non-local pseudopotential parameters
    Maximum angular mementum = 0
    Number of non-local channels = 1
       l(0)=0
    Cutoff radius = 1.0000000000e-03
    Spherical grids and weights: 
         1.0000000000e+00  0.0000000000e+00  0.0000000000e+00    8.3333333333e-02
        -1.0000000000e+00  1.2246467991e-16  0.0000000000e+00    8.3333333333e-02
         4.4721359550e-01  8.9442719100e-01  0.0000000000e+00    8.3333333333e-02
        -4.4721359550e-01  7.2360679775e-01  5.2573111212e-01    8.3333333333e-02
         4.4721359550e-01  2.7639320225e-01  8.5065080835e-01    8.3333333333e-02
        -4.4721359550e-01 -2.7639320225e-01  8.5065080835e-01    8.3333333333e-02
         4.4721359550e-01 -7.2360679775e-01  5.2573111212e-01    8.3333333333e-02
        -4.4721359550e-01 -8.9442719100e-01  1.0953573965e-16    8.3333333333e-02
         4.4721359550e-01 -7.2360679775e-01 -5.2573111212e-01    8.3333333333e-02
        -4.4721359550e-01 -2.7639320225e-01 -8.5065080835e-01    8.3333333333e-02
         4.4721359550e-01  2.7639320225e-01 -8.5065080835e-01    8.3333333333e-02
        -4.4721359550e-01  7.2360679775e-01 -5.2573111212e-01    8.3333333333e-02
    Maximum cutoff radius 1.0000000000e-03
  QMCHamiltonian::addOperator LocalECP to H, physical Hamiltonian 

  Using NonLocalECP potential 
    Maximum grid on a sphere for NonLocalECPotential: 12
  QMCHamiltonian::addOperator NonLocalECP to H, physical Hamiltonian 
QMCHamiltonian::addOperatorType added type pseudo named NonLocalECP
  QMCHamiltonian::addOperator IonIon to H, physical Hamiltonian 
QMCHamiltonian::addOperatorType added type coulomb named IonIon

  QMCHamiltonian::add2WalkerProperty added
    5 to P::PropertyList 
    0 to P::Collectables 
    starting Index of the observables in P::PropertyList = 10
ParticleSetPool::randomize 
  Initialization Execution time = 1.9930e-01 secs
=========================================================
 Summary of QMC systems 
=========================================================
ParticleSetPool has: 

  ParticleSet 'e' contains 8 particles :  u(4) d(4)

    u  6.1002844054e-01  1.3250453608e-01 -4.2267217978e-01
    u -4.3494847795e-01 -2.3203549626e-01  1.0876787134e-01
    u -1.5984350305e-01  8.1842956548e-01  5.1837161342e-02
    u  1.1948334779e+00  1.4453040952e+00  1.6346730752e+00
    d -9.5054657961e-01  2.3768909128e-01 -6.0876959125e-01
    d -2.0429807517e-01  1.5546410594e+00 -1.0292769217e-01
    d  4.7451519973e-01  3.4811618685e-02  3.5425821429e-01
    d -8.6403568621e-02 -1.8286319639e+00  9.9844026831e-01

  Distance table for similar particles (A-A):
    source/target: e
    Using structure-of-arrays (SoA) data layout
    Distance computations use open boundary conditions in 3D.

  Distance table for dissimilar particles (A-B):
    source: ion0  target: e
    Using structure-of-arrays (SoA) data layout
    Distance computations use open boundary conditions in 3D.


  ParticleSet 'ion0' contains 3 particles :  O(1) H1(1) H2(1)

    O  0.0000000000e+00  0.0000000000e+00 -1.3209751581e-01
    H1  0.0000000000e+00  1.4315279079e+00  9.7970009311e-01
    H2  0.0000000000e+00 -1.4315279079e+00  9.7970009311e-01

  Distance table for similar particles (A-A):
    source/target: ion0
    Using structure-of-arrays (SoA) data layout
    Distance computations use open boundary conditions in 3D.


  Hamiltonian h0
  Kinetic         Kinetic energy
  ElecElec        CoulombAA source/target e

  LocalECP        LocalECPotential: ion0
  NonLocalECP     NonLocalECPotential: ion0
  IonIon          CoulombAA source/target ion0


Loop execution max-interations = 100
Inside LM engine constructor, num_params is: 0 and _total_num_params is: 0

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s000 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15
  Adding 1 walkers to 0 existing sets
  Total number of walkers: 1.2800000000e+02
  Total weight: 1.2800000000e+02

=========================================================
  Start VMC
  File Root H2O.s000 append = no 
=========================================================
Resetting walkers
  Using the current 1 walkers.
  Total number of walkers: 1.2800000000e+02
  Total weight: 1.2800000000e+02
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=0  my_counter=0
  time step      = 5.0000000000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000000000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625000000e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000000000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000000000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000000000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000000000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000000000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000000000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000000000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625000000e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000000000e-02</parameter>
<parameter name="time_step" condition="au">5.0000000000e-02</parameter>
<parameter name="timestep" condition="au">5.0000000000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
  Set drift_modifier UNR parameter a = 1.0000000000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000000000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: 0 and ratio_threshold_: 0.0000000000e+00
Allocating full size _hmat_temp and _smat_temp
Inside LM engine's get_param, num_params is: 74
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 0
    time step          = 0.05
    reference energy   = -16.8209
    reference variance = 0.328584
====================================================
  Execution time = 1.5337e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s000
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5244e+04
  VMC Eavg = -1.6894e+01
  VMC Evar = 3.8788e-01
  Total weights = 1.950738262e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 2.6711e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.371554890931
                                         uncertainty =       0.002480726588

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.371554890931
                                         uncertainty =       0.002480726588

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000430987438
  error estimate for blocks of size 2^( 2) =       0.000445451146
  error estimate for blocks of size 2^( 3) =       0.000460136430
  error estimate for blocks of size 2^( 4) =       0.000472443718
  error estimate for blocks of size 2^( 5) =       0.000483387816
  error estimate for blocks of size 2^( 6) =       0.000492013276
  error estimate for blocks of size 2^( 7) =       0.000497818125

      target function =      -0.802715844161
              le_mean =     -16.893976817040
             les_mean =     285.794335556671
             stat err =       0.000486415734
             autocorr =       1.273755306368
   target nu stat err =       0.000486415734
   target dn stat err =       0.002933691210
      target stat err =       0.003051620268
              std dev =       0.609508279367
             le_variance =       0.371500342617


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy-1.689397681704e+01 
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 74
Check correct_vf_var_size: 225, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.5000e-01, overlap shift 2.5000e+00 and omega -1.7527e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.802726282542       residual = 9.90e-01           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.816502779684       residual = 2.13e-01           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.819381465015       residual = 3.77e-02           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.820131522181       residual = 7.41e-03           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.820309888682       residual = 2.87e-03           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.820371816270       residual = 2.04e-03           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.820407070964       residual = 6.69e-04           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.820420149000       residual = 1.75e-04           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.820425422999       residual = 5.83e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.820428017632       residual = 1.65e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.820428683521       residual = 7.86e-06           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.820428486519       residual = 1.21e-06           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.820428539558       residual = 4.31e-07           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.820428498949       residual = 1.01e-07           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.820428514601       residual = 1.20e-07           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.820428547467       residual = 1.42e-07           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.820428568994       residual = 7.75e-08           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.820428572907       residual = 5.94e-08           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.820428565677       residual = 2.60e-08           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.820428566166       residual = 1.22e-08           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.820428551708       residual = 2.86e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         20 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 2.5000e-01 is 4.070101e-03

solving harmonic davidson linear method for identity shift 1.0000e+00, overlap shift 1.0000e+01 and omega -1.7527e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.802726282542       residual = 9.90e-01           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.806774100704       residual = 2.01e-01           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.807582027660       residual = 3.42e-02           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.807781031695       residual = 6.36e-03           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.807827004876       residual = 2.40e-03           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.807842256963       residual = 1.59e-03           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.807850217195       residual = 5.01e-04           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.807852986774       residual = 1.23e-04           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.807854098747       residual = 3.71e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.807854639449       residual = 1.04e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.807854760086       residual = 4.52e-06           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.807854699622       residual = 6.43e-07           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.807854710213       residual = 2.41e-07           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.807854701883       residual = 7.69e-08           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.807854707026       residual = 1.19e-07           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.807854714795       residual = 1.01e-07           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.807854717476       residual = 4.63e-08           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.807854716442       residual = 2.72e-08           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.807854714182       residual = 9.65e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         18 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 1.0000e+00 is 1.211923e-03

solving harmonic davidson linear method for identity shift 4.0000e+00, overlap shift 4.0000e+01 and omega -1.7527e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.802726282542       residual = 9.90e-01           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.803783681431       residual = 1.97e-01           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.803991508816       residual = 3.31e-02           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.804041795156       residual = 6.05e-03           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.804053310490       residual = 2.26e-03           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.804057074754       residual = 1.46e-03           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.804058987894       residual = 4.57e-04           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.804059640231       residual = 1.11e-04           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.804059902302       residual = 3.23e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.804060029512       residual = 9.02e-06           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.804060056480       residual = 3.81e-06           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.804060040944       residual = 5.31e-07           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.804060043440       residual = 2.05e-07           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.804060041491       residual = 7.26e-08           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.804060042881       residual = 1.18e-07           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.804060044696       residual = 8.68e-08           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.804060045168       residual = 3.83e-08           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.804060044816       residual = 2.09e-08           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.804060044261       residual = 7.00e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         18 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 4.0000e+00 is 3.178328e-04

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.124627 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 75 and numParams is: 74

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.8140e+01
  </log>
  <optVariables href="H2O.s000.opt.xml">
ci_0001 6.938167e-01                 3 1 ON  0
ci_0002 6.937393e-01                 3 1 ON  1
ci_0003 -4.753948e-02                3 1 ON  2
ci_0004 -4.746802e-02                3 1 ON  3
ci_0005 -4.473368e-02                3 1 ON  4
ci_0006 -4.483789e-02                3 1 ON  5
ci_0007 -3.241748e-02                3 1 ON  6
ci_0008 -3.258919e-02                3 1 ON  7
ci_0009 -3.121696e-02                3 1 ON  8
ci_0010 -3.120606e-02                3 1 ON  9
ci_0011 -2.630560e-02                3 1 ON  10
ci_0012 -2.633080e-02                3 1 ON  11
ci_0013 2.582976e-02                 3 1 ON  12
ci_0014 2.578637e-02                 3 1 ON  13
ci_0015 2.564279e-02                 3 1 ON  14
ci_0016 2.573926e-02                 3 1 ON  15
ci_0017 2.370836e-02                 3 1 ON  16
ci_0018 2.374963e-02                 3 1 ON  17
ci_0019 1.975356e-02                 3 1 ON  18
ci_0020 1.970262e-02                 3 1 ON  19
ci_0021 1.908567e-02                 3 1 ON  20
ci_0022 1.904380e-02                 3 1 ON  21
ci_0023 -1.851629e-02                3 1 ON  22
ci_0024 -1.849406e-02                3 1 ON  23
ci_0025 -1.779698e-02                3 1 ON  24
ci_0026 -1.788141e-02                3 1 ON  25
ci_0027 -1.779704e-02                3 1 ON  26
ci_0028 -1.781258e-02                3 1 ON  27
ci_0029 -1.654015e-02                3 1 ON  28
ci_0030 -1.653315e-02                3 1 ON  29
ci_0031 1.641505e-02                 3 1 ON  30
ci_0032 1.648619e-02                 3 1 ON  31
ci_0033 1.547359e-02                 3 1 ON  32
ci_0034 1.556597e-02                 3 1 ON  33
ci_0035 1.504761e-02                 3 1 ON  34
ci_0036 1.512759e-02                 3 1 ON  35
ci_0037 -1.469174e-02                3 1 ON  36
ci_0038 -1.475488e-02                3 1 ON  37
ci_0039 -1.413599e-02                3 1 ON  38
ci_0040 -1.412538e-02                3 1 ON  39
ci_0041 1.429284e-02                 3 1 ON  40
ci_0042 1.428509e-02                 3 1 ON  41
ci_0043 -1.374836e-02                3 1 ON  42
ci_0044 -1.391022e-02                3 1 ON  43
ci_0045 1.381017e-02                 3 1 ON  44
ci_0046 1.378734e-02                 3 1 ON  45
ci_0047 -1.312503e-02                3 1 ON  46
ci_0048 -1.312253e-02                3 1 ON  47
ci_0049 -1.192296e-02                3 1 ON  48
ci_0050 -1.196268e-02                3 1 ON  49
ci_0051 -1.181449e-02                3 1 ON  50
ci_0052 -1.177314e-02                3 1 ON  51
ci_0053 -1.159316e-02                3 1 ON  52
ci_0054 -1.156588e-02                3 1 ON  53
ci_0055 1.132350e-02                 3 1 ON  54
ci_0056 1.138145e-02                 3 1 ON  55
ci_0057 1.119812e-02                 3 1 ON  56
ci_0058 1.141482e-02                 3 1 ON  57
ci_0059 -1.125473e-02                3 1 ON  58
ci_0060 -1.123003e-02                3 1 ON  59
ci_0061 -1.120977e-02                3 1 ON  60
ci_0062 -1.123409e-02                3 1 ON  61
ci_0063 -1.128067e-02                3 1 ON  62
ci_0064 -1.127811e-02                3 1 ON  63
ci_0065 -1.087939e-02                3 1 ON  64
ci_0066 -1.089478e-02                3 1 ON  65
ci_0067 -1.064334e-02                3 1 ON  66
ci_0068 -1.063861e-02                3 1 ON  67
ci_0069 1.008380e-02                 3 1 ON  68
ci_0070 1.006512e-02                 3 1 ON  69
ci_0071 1.009252e-02                 3 1 ON  70
ci_0072 1.011523e-02                 3 1 ON  71
ci_0073 9.697903e-03                 3 1 ON  72
ci_0074 9.722936e-03                 3 1 ON  73
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 0
    time step          = 0.05
    reference energy   = -16.9058
    reference variance = 0.302523
====================================================
  Execution time = 1.4521e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s000
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6895e+01
  VMC Evar = 3.8136e-01
  Total weights = 1.9512e+06
  Execution time = 1.9246e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.374039354275
                                         uncertainty =       0.002393334847

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.374039354275
                                         uncertainty =       0.002393334847

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000432478855
  error estimate for blocks of size 2^( 2) =       0.000446786038
  error estimate for blocks of size 2^( 3) =       0.000460944771
  error estimate for blocks of size 2^( 4) =       0.000473380536
  error estimate for blocks of size 2^( 5) =       0.000484993418
  error estimate for blocks of size 2^( 6) =       0.000492857793
  error estimate for blocks of size 2^( 7) =       0.000497972437

      target function =      -0.751438246564
              le_mean =     -16.894823601508
             les_mean =     285.875379504908
             stat err =       0.000487301046
             autocorr =       1.269594204980
   target nu stat err =       0.000487301046
   target dn stat err =       0.032981236592
      target stat err =       0.029532675095
              std dev =       0.611617461477
             le_variance =       0.374075919184

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       1.097940744525
                                         uncertainty =       0.540892467851

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       1.097940744525
                                         uncertainty =       0.540892467851

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000741232430
  error estimate for blocks of size 2^( 2) =       0.000748848538
  error estimate for blocks of size 2^( 3) =       0.000756953383
  error estimate for blocks of size 2^( 4) =       0.000763600540
  error estimate for blocks of size 2^( 5) =       0.000770297605
  error estimate for blocks of size 2^( 6) =       0.000773809307
  error estimate for blocks of size 2^( 7) =       0.000776635333

      target function =      -0.117745496210
              le_mean =     -16.896141566902
             les_mean =     289.145281870701
             stat err =       0.000771085696
             autocorr =       1.082172441227
   target nu stat err =       0.000771085696
   target dn stat err =       2.289016714483
      target stat err =       0.066334909104
              std dev =       1.048260955003
             le_variance =       1.098851029783

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.356142770338
                                         uncertainty =       0.002249171298

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.356142770338
                                         uncertainty =       0.002249171298

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000422001816
  error estimate for blocks of size 2^( 2) =       0.000436052532
  error estimate for blocks of size 2^( 3) =       0.000450043871
  error estimate for blocks of size 2^( 4) =       0.000462523655
  error estimate for blocks of size 2^( 5) =       0.000474296083
  error estimate for blocks of size 2^( 6) =       0.000482251907
  error estimate for blocks of size 2^( 7) =       0.000487403765

      target function =      -0.802216424050
              le_mean =     -16.894910846460
             les_mean =     285.826273167963
             stat err =       0.000476618853
             autocorr =       1.275597894955
   target nu stat err =       0.000476618853
   target dn stat err =       0.010498214466
      target stat err =       0.010715838245
              std dev =       0.596800691567
             le_variance =       0.356171065455

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.371318584417
                                         uncertainty =       0.002355319826

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.371318584417
                                         uncertainty =       0.002355319826

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000430902748
  error estimate for blocks of size 2^( 2) =       0.000445166095
  error estimate for blocks of size 2^( 3) =       0.000459296740
  error estimate for blocks of size 2^( 4) =       0.000471763539
  error estimate for blocks of size 2^( 5) =       0.000483417012
  error estimate for blocks of size 2^( 6) =       0.000491286453
  error estimate for blocks of size 2^( 7) =       0.000496404228

      target function =      -0.768760221103
              le_mean =     -16.894801553804
             les_mean =     285.855867594686
             stat err =       0.000485717808
             autocorr =       1.270601976483
   target nu stat err =       0.000485717808
   target dn stat err =       0.030347125048
      target stat err =       0.028435903291
              std dev =       0.609388509587
             le_variance =       0.371354355617


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.751438246564        initial
     2.5000e-01     2.5000e+00             4.0701e-03        -0.117745496210
     1.0000e+00     1.0000e+01             1.2119e-03        -0.802216424050  <--
     4.0000e+00     4.0000e+01             3.1783e-04        -0.768760221103

*****************************************************************************
Applying the update for shift_i =   1.0000e+00     and shift_s =   1.0000e+01
*****************************************************************************

  Execution time = 2.4223e+01
  </log>
  <optVariables href="H2O.s000.opt.xml">
ci_0001                 6.938167e-01 3 1  ON 0
ci_0002                 6.937393e-01 3 1  ON 1
ci_0003                -4.753948e-02 3 1  ON 2
ci_0004                -4.746802e-02 3 1  ON 3
ci_0005                -4.473368e-02 3 1  ON 4
ci_0006                -4.483789e-02 3 1  ON 5
ci_0007                -3.241748e-02 3 1  ON 6
ci_0008                -3.258919e-02 3 1  ON 7
ci_0009                -3.121696e-02 3 1  ON 8
ci_0010                -3.120606e-02 3 1  ON 9
ci_0011                -2.630560e-02 3 1  ON 10
ci_0012                -2.633080e-02 3 1  ON 11
ci_0013                 2.582976e-02 3 1  ON 12
ci_0014                 2.578637e-02 3 1  ON 13
ci_0015                 2.564279e-02 3 1  ON 14
ci_0016                 2.573926e-02 3 1  ON 15
ci_0017                 2.370836e-02 3 1  ON 16
ci_0018                 2.374963e-02 3 1  ON 17
ci_0019                 1.975356e-02 3 1  ON 18
ci_0020                 1.970262e-02 3 1  ON 19
ci_0021                 1.908567e-02 3 1  ON 20
ci_0022                 1.904380e-02 3 1  ON 21
ci_0023                -1.851629e-02 3 1  ON 22
ci_0024                -1.849406e-02 3 1  ON 23
ci_0025                -1.779698e-02 3 1  ON 24
ci_0026                -1.788141e-02 3 1  ON 25
ci_0027                -1.779704e-02 3 1  ON 26
ci_0028                -1.781258e-02 3 1  ON 27
ci_0029                -1.654015e-02 3 1  ON 28
ci_0030                -1.653315e-02 3 1  ON 29
ci_0031                 1.641505e-02 3 1  ON 30
ci_0032                 1.648619e-02 3 1  ON 31
ci_0033                 1.547359e-02 3 1  ON 32
ci_0034                 1.556597e-02 3 1  ON 33
ci_0035                 1.504761e-02 3 1  ON 34
ci_0036                 1.512759e-02 3 1  ON 35
ci_0037                -1.469174e-02 3 1  ON 36
ci_0038                -1.475488e-02 3 1  ON 37
ci_0039                -1.413599e-02 3 1  ON 38
ci_0040                -1.412538e-02 3 1  ON 39
ci_0041                 1.429284e-02 3 1  ON 40
ci_0042                 1.428509e-02 3 1  ON 41
ci_0043                -1.374836e-02 3 1  ON 42
ci_0044                -1.391022e-02 3 1  ON 43
ci_0045                 1.381017e-02 3 1  ON 44
ci_0046                 1.378734e-02 3 1  ON 45
ci_0047                -1.312503e-02 3 1  ON 46
ci_0048                -1.312253e-02 3 1  ON 47
ci_0049                -1.192296e-02 3 1  ON 48
ci_0050                -1.196268e-02 3 1  ON 49
ci_0051                -1.181449e-02 3 1  ON 50
ci_0052                -1.177314e-02 3 1  ON 51
ci_0053                -1.159316e-02 3 1  ON 52
ci_0054                -1.156588e-02 3 1  ON 53
ci_0055                 1.132350e-02 3 1  ON 54
ci_0056                 1.138145e-02 3 1  ON 55
ci_0057                 1.119812e-02 3 1  ON 56
ci_0058                 1.141482e-02 3 1  ON 57
ci_0059                -1.125473e-02 3 1  ON 58
ci_0060                -1.123003e-02 3 1  ON 59
ci_0061                -1.120977e-02 3 1  ON 60
ci_0062                -1.123409e-02 3 1  ON 61
ci_0063                -1.128067e-02 3 1  ON 62
ci_0064                -1.127811e-02 3 1  ON 63
ci_0065                -1.087939e-02 3 1  ON 64
ci_0066                -1.089478e-02 3 1  ON 65
ci_0067                -1.064334e-02 3 1  ON 66
ci_0068                -1.063861e-02 3 1  ON 67
ci_0069                 1.008380e-02 3 1  ON 68
ci_0070                 1.006512e-02 3 1  ON 69
ci_0071                 1.009252e-02 3 1  ON 70
ci_0072                 1.011523e-02 3 1  ON 71
ci_0073                 9.697903e-03 3 1  ON 72
ci_0074                 9.722936e-03 3 1  ON 73
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 4.2369e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s001 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s001 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=1  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6863e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 1
    time step          = 0.05
    reference energy   = -16.9729
    reference variance = 0.200226
====================================================
  Execution time = 1.4599e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s001
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5231e+04
  VMC Eavg = -1.6895e+01
  VMC Evar = 3.8235e-01
  Total weights = 1.950692575e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 2.6296e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.364901071678
                                         uncertainty =       0.002604982983

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.364901071678
                                         uncertainty =       0.002604982983

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000427113880
  error estimate for blocks of size 2^( 2) =       0.000441398489
  error estimate for blocks of size 2^( 3) =       0.000455906684
  error estimate for blocks of size 2^( 4) =       0.000469411917
  error estimate for blocks of size 2^( 5) =       0.000480784354
  error estimate for blocks of size 2^( 6) =       0.000490707738
  error estimate for blocks of size 2^( 7) =       0.000498825175

      target function =      -0.808418403017
              le_mean =     -16.895198391783
             les_mean =     285.830079685359
             stat err =       0.000484932296
             autocorr =       1.289065091684
   target nu stat err =       0.000484932296
   target dn stat err =       0.003656758450
      target stat err =       0.003836170197
              std dev =       0.604030241244
             le_variance =       0.364852532337


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.689519839178e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 74
Check correct_vf_var_size: 225, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.5000e-01, overlap shift 2.5000e+00 and omega -1.7527e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.808435431565       residual = 8.69e-01           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.820438203726       residual = 1.75e-01           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.822831891200       residual = 3.35e-02           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.823457651688       residual = 7.51e-03           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.823615965461       residual = 3.00e-03           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.823676094491       residual = 1.84e-03           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.823720132226       residual = 5.50e-04           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.823733802833       residual = 1.45e-04           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.823736796611       residual = 5.59e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.823738548810       residual = 2.16e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.823739472156       residual = 1.46e-05           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.823740027290       residual = 6.73e-06           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.823739852619       residual = 9.02e-06           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.823740099462       residual = 7.76e-06           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.823740284842       residual = 5.63e-06           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.823740650497       residual = 9.32e-07           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.823740670824       residual = 2.43e-07           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.823740585104       residual = 8.67e-08           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.823740546331       residual = 2.66e-08           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.823740537033       residual = 1.02e-08           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.823740543219       residual = 2.70e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         20 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 2.5000e-01 is 3.722060e-03

solving harmonic davidson linear method for identity shift 1.0000e+00, overlap shift 1.0000e+01 and omega -1.7527e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.808435431565       residual = 8.69e-01           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.811971250756       residual = 1.66e-01           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.812645358533       residual = 3.05e-02           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.812812194619       residual = 6.46e-03           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.812853228585       residual = 2.53e-03           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.812868311420       residual = 1.48e-03           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.812878496531       residual = 4.12e-04           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.812881497487       residual = 1.02e-04           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.812882062598       residual = 3.66e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.812882430478       residual = 1.48e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.812882619874       residual = 9.51e-06           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.812882728168       residual = 4.57e-06           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.812882677938       residual = 6.36e-06           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.812882736026       residual = 4.36e-06           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.812882768326       residual = 2.18e-06           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.812882825056       residual = 2.99e-07           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.812882825091       residual = 8.69e-08           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.812882808952       residual = 2.94e-08           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.812882803265       residual = 8.28e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         18 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 1.0000e+00 is 1.107167e-03

solving harmonic davidson linear method for identity shift 4.0000e+00, overlap shift 4.0000e+01 and omega -1.7527e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.808435431565       residual = 8.69e-01           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.809359926345       residual = 1.63e-01           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.809533554772       residual = 2.95e-02           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.809575787611       residual = 6.15e-03           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.809586087190       residual = 2.40e-03           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.809589832544       residual = 1.38e-03           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.809592299593       residual = 3.76e-04           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.809593014992       residual = 9.19e-05           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.809593143013       residual = 3.21e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.809593230026       residual = 1.32e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.809593274328       residual = 8.35e-06           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.809593299305       residual = 4.07e-06           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.809593286486       residual = 5.69e-06           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.809593300711       residual = 3.59e-06           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.809593307866       residual = 1.62e-06           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.809593320102       residual = 2.14e-07           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.809593319886       residual = 6.42e-08           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.809593316212       residual = 2.13e-08           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.809593315024       residual = 5.83e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         18 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 4.0000e+00 is 2.903237e-04

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.137529 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 75 and numParams is: 74

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.7247e+01
  </log>
  <optVariables href="H2O.s001.opt.xml">
ci_0001                 6.941049e-01 3 1  ON 0
ci_0002                 6.945153e-01 3 1  ON 1
ci_0003                -4.649203e-02 3 1  ON 2
ci_0004                -4.657688e-02 3 1  ON 3
ci_0005                -4.384765e-02 3 1  ON 4
ci_0006                -4.408222e-02 3 1  ON 5
ci_0007                -3.175470e-02 3 1  ON 6
ci_0008                -3.188323e-02 3 1  ON 7
ci_0009                -3.040538e-02 3 1  ON 8
ci_0010                -3.044953e-02 3 1  ON 9
ci_0011                -2.565498e-02 3 1  ON 10
ci_0012                -2.563758e-02 3 1  ON 11
ci_0013                 2.521909e-02 3 1  ON 12
ci_0014                 2.515508e-02 3 1  ON 13
ci_0015                 2.502432e-02 3 1  ON 14
ci_0016                 2.507118e-02 3 1  ON 15
ci_0017                 2.308032e-02 3 1  ON 16
ci_0018                 2.307910e-02 3 1  ON 17
ci_0019                 1.924505e-02 3 1  ON 18
ci_0020                 1.926394e-02 3 1  ON 19
ci_0021                 1.900247e-02 3 1  ON 20
ci_0022                 1.896647e-02 3 1  ON 21
ci_0023                -1.810311e-02 3 1  ON 22
ci_0024                -1.803095e-02 3 1  ON 23
ci_0025                -1.668981e-02 3 1  ON 24
ci_0026                -1.685552e-02 3 1  ON 25
ci_0027                -1.747685e-02 3 1  ON 26
ci_0028                -1.740511e-02 3 1  ON 27
ci_0029                -1.614002e-02 3 1  ON 28
ci_0030                -1.615775e-02 3 1  ON 29
ci_0031                 1.638191e-02 3 1  ON 30
ci_0032                 1.639755e-02 3 1  ON 31
ci_0033                 1.501377e-02 3 1  ON 32
ci_0034                 1.516954e-02 3 1  ON 33
ci_0035                 1.438746e-02 3 1  ON 34
ci_0036                 1.447366e-02 3 1  ON 35
ci_0037                -1.449662e-02 3 1  ON 36
ci_0038                -1.456986e-02 3 1  ON 37
ci_0039                -1.344340e-02 3 1  ON 38
ci_0040                -1.338628e-02 3 1  ON 39
ci_0041                 1.402463e-02 3 1  ON 40
ci_0042                 1.401079e-02 3 1  ON 41
ci_0043                -1.335187e-02 3 1  ON 42
ci_0044                -1.355730e-02 3 1  ON 43
ci_0045                 1.360857e-02 3 1  ON 44
ci_0046                 1.352607e-02 3 1  ON 45
ci_0047                -1.243451e-02 3 1  ON 46
ci_0048                -1.245525e-02 3 1  ON 47
ci_0049                -1.120214e-02 3 1  ON 48
ci_0050                -1.120518e-02 3 1  ON 49
ci_0051                -1.108700e-02 3 1  ON 50
ci_0052                -1.101179e-02 3 1  ON 51
ci_0053                -1.100977e-02 3 1  ON 52
ci_0054                -1.103816e-02 3 1  ON 53
ci_0055                 1.073106e-02 3 1  ON 54
ci_0056                 1.065789e-02 3 1  ON 55
ci_0057                 1.064546e-02 3 1  ON 56
ci_0058                 1.085711e-02 3 1  ON 57
ci_0059                -1.068146e-02 3 1  ON 58
ci_0060                -1.075711e-02 3 1  ON 59
ci_0061                -1.068188e-02 3 1  ON 60
ci_0062                -1.072986e-02 3 1  ON 61
ci_0063                -1.122599e-02 3 1  ON 62
ci_0064                -1.117481e-02 3 1  ON 63
ci_0065                -1.057421e-02 3 1  ON 64
ci_0066                -1.063349e-02 3 1  ON 65
ci_0067                -1.016373e-02 3 1  ON 66
ci_0068                -1.018551e-02 3 1  ON 67
ci_0069                 9.582586e-03 3 1  ON 68
ci_0070                 9.555480e-03 3 1  ON 69
ci_0071                 9.694561e-03 3 1  ON 70
ci_0072                 9.831355e-03 3 1  ON 71
ci_0073                 9.178089e-03 3 1  ON 72
ci_0074                 9.310052e-03 3 1  ON 73
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 1
    time step          = 0.05
    reference energy   = -16.9134
    reference variance = 0.242313
====================================================
  Execution time = 1.4503e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s001
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6896e+01
  VMC Evar = 3.7508e-01
  Total weights = 1.9504e+06
  Execution time = 1.9169e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.371652427293
                                         uncertainty =       0.003875543351

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.371652427293
                                         uncertainty =       0.003875543351

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000431066736
  error estimate for blocks of size 2^( 2) =       0.000445380341
  error estimate for blocks of size 2^( 3) =       0.000460328662
  error estimate for blocks of size 2^( 4) =       0.000473482226
  error estimate for blocks of size 2^( 5) =       0.000486750196
  error estimate for blocks of size 2^( 6) =       0.000495027139
  error estimate for blocks of size 2^( 7) =       0.000498553546

      target function =      -0.552621676528
              le_mean =     -16.896272781393
             les_mean =     286.156454345747
             stat err =       0.000488453277
             autocorr =       1.283976376795
   target nu stat err =       0.000488453277
   target dn stat err =       0.275401093336
      target stat err =       0.142286880201
              std dev =       0.609620423698
             le_variance =       0.371637060990

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.352763140721
                                         uncertainty =       0.006713785015

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.352763140721
                                         uncertainty =       0.006713785015

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000419977660
  error estimate for blocks of size 2^( 2) =       0.000433950652
  error estimate for blocks of size 2^( 3) =       0.000448622001
  error estimate for blocks of size 2^( 4) =       0.000461768876
  error estimate for blocks of size 2^( 5) =       0.000475008145
  error estimate for blocks of size 2^( 6) =       0.000483428250
  error estimate for blocks of size 2^( 7) =       0.000487350200

      target function =      -0.034261386483
              le_mean =     -16.896730029253
             les_mean =     295.686843688257
             stat err =       0.000476888868
             autocorr =       1.289383152315
   target nu stat err =       0.000476888868
   target dn stat err =       9.088284389411
      target stat err =       0.029419671833
              std dev =       0.593938102209
             le_variance =       0.352762469256

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.352936778761
                                         uncertainty =       0.002996427266

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.352936778761
                                         uncertainty =       0.002996427266

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000420081461
  error estimate for blocks of size 2^( 2) =       0.000434263474
  error estimate for blocks of size 2^( 3) =       0.000449103942
  error estimate for blocks of size 2^( 4) =       0.000462426284
  error estimate for blocks of size 2^( 5) =       0.000475796788
  error estimate for blocks of size 2^( 6) =       0.000484147714
  error estimate for blocks of size 2^( 7) =       0.000487655678

      target function =      -0.818320159903
              le_mean =     -16.896374889797
             les_mean =     285.860416838484
             stat err =       0.000477506616
             autocorr =       1.292086996197
   target nu stat err =       0.000477506616
   target dn stat err =       0.005014452705
      target stat err =       0.005365041677
              std dev =       0.594084898971
             le_variance =       0.352936867185

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.367232131316
                                         uncertainty =       0.003236234165

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.367232131316
                                         uncertainty =       0.003236234165

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000428501487
  error estimate for blocks of size 2^( 2) =       0.000442851541
  error estimate for blocks of size 2^( 3) =       0.000457776891
  error estimate for blocks of size 2^( 4) =       0.000470981245
  error estimate for blocks of size 2^( 5) =       0.000484315242
  error estimate for blocks of size 2^( 6) =       0.000492606379
  error estimate for blocks of size 2^( 7) =       0.000496017122

      target function =      -0.747620153368
              le_mean =     -16.896298101584
             les_mean =     285.927859249873
             stat err =       0.000485979997
             autocorr =       1.286269942238
   target nu stat err =       0.000485979997
   target dn stat err =       0.048699881403
      target stat err =       0.043340662205
              std dev =       0.605992614460
             le_variance =       0.367227048780


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.552621676528        initial
     2.5000e-01     2.5000e+00             3.7221e-03        -0.034261386483
     1.0000e+00     1.0000e+01             1.1072e-03        -0.818320159903  <--
     4.0000e+00     4.0000e+01             2.9032e-04        -0.747620153368

*****************************************************************************
Applying the update for shift_i =   1.0000e+00     and shift_s =   1.0000e+01
*****************************************************************************

  Execution time = 2.4402e+01
  </log>
  <optVariables href="H2O.s001.opt.xml">
ci_0001                 6.941049e-01 3 1  ON 0
ci_0002                 6.945153e-01 3 1  ON 1
ci_0003                -4.649203e-02 3 1  ON 2
ci_0004                -4.657688e-02 3 1  ON 3
ci_0005                -4.384765e-02 3 1  ON 4
ci_0006                -4.408222e-02 3 1  ON 5
ci_0007                -3.175470e-02 3 1  ON 6
ci_0008                -3.188323e-02 3 1  ON 7
ci_0009                -3.040538e-02 3 1  ON 8
ci_0010                -3.044953e-02 3 1  ON 9
ci_0011                -2.565498e-02 3 1  ON 10
ci_0012                -2.563758e-02 3 1  ON 11
ci_0013                 2.521909e-02 3 1  ON 12
ci_0014                 2.515508e-02 3 1  ON 13
ci_0015                 2.502432e-02 3 1  ON 14
ci_0016                 2.507118e-02 3 1  ON 15
ci_0017                 2.308032e-02 3 1  ON 16
ci_0018                 2.307910e-02 3 1  ON 17
ci_0019                 1.924505e-02 3 1  ON 18
ci_0020                 1.926394e-02 3 1  ON 19
ci_0021                 1.900247e-02 3 1  ON 20
ci_0022                 1.896647e-02 3 1  ON 21
ci_0023                -1.810311e-02 3 1  ON 22
ci_0024                -1.803095e-02 3 1  ON 23
ci_0025                -1.668981e-02 3 1  ON 24
ci_0026                -1.685552e-02 3 1  ON 25
ci_0027                -1.747685e-02 3 1  ON 26
ci_0028                -1.740511e-02 3 1  ON 27
ci_0029                -1.614002e-02 3 1  ON 28
ci_0030                -1.615775e-02 3 1  ON 29
ci_0031                 1.638191e-02 3 1  ON 30
ci_0032                 1.639755e-02 3 1  ON 31
ci_0033                 1.501377e-02 3 1  ON 32
ci_0034                 1.516954e-02 3 1  ON 33
ci_0035                 1.438746e-02 3 1  ON 34
ci_0036                 1.447366e-02 3 1  ON 35
ci_0037                -1.449662e-02 3 1  ON 36
ci_0038                -1.456986e-02 3 1  ON 37
ci_0039                -1.344340e-02 3 1  ON 38
ci_0040                -1.338628e-02 3 1  ON 39
ci_0041                 1.402463e-02 3 1  ON 40
ci_0042                 1.401079e-02 3 1  ON 41
ci_0043                -1.335187e-02 3 1  ON 42
ci_0044                -1.355730e-02 3 1  ON 43
ci_0045                 1.360857e-02 3 1  ON 44
ci_0046                 1.352607e-02 3 1  ON 45
ci_0047                -1.243451e-02 3 1  ON 46
ci_0048                -1.245525e-02 3 1  ON 47
ci_0049                -1.120214e-02 3 1  ON 48
ci_0050                -1.120518e-02 3 1  ON 49
ci_0051                -1.108700e-02 3 1  ON 50
ci_0052                -1.101179e-02 3 1  ON 51
ci_0053                -1.100977e-02 3 1  ON 52
ci_0054                -1.103816e-02 3 1  ON 53
ci_0055                 1.073106e-02 3 1  ON 54
ci_0056                 1.065789e-02 3 1  ON 55
ci_0057                 1.064546e-02 3 1  ON 56
ci_0058                 1.085711e-02 3 1  ON 57
ci_0059                -1.068146e-02 3 1  ON 58
ci_0060                -1.075711e-02 3 1  ON 59
ci_0061                -1.068188e-02 3 1  ON 60
ci_0062                -1.072986e-02 3 1  ON 61
ci_0063                -1.122599e-02 3 1  ON 62
ci_0064                -1.117481e-02 3 1  ON 63
ci_0065                -1.057421e-02 3 1  ON 64
ci_0066                -1.063349e-02 3 1  ON 65
ci_0067                -1.016373e-02 3 1  ON 66
ci_0068                -1.018551e-02 3 1  ON 67
ci_0069                 9.582586e-03 3 1  ON 68
ci_0070                 9.555480e-03 3 1  ON 69
ci_0071                 9.694561e-03 3 1  ON 70
ci_0072                 9.831355e-03 3 1  ON 71
ci_0073                 9.178089e-03 3 1  ON 72
ci_0074                 9.310052e-03 3 1  ON 73
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 4.1656e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s002 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s002 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=2  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6903e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 2
    time step          = 0.05
    reference energy   = -16.9344
    reference variance = 0.518408
====================================================
  Execution time = 1.4580e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s002
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5228e+04
  VMC Eavg = -1.6897e+01
  VMC Evar = 3.6730e-01
  Total weights = 1.950451357e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 2.6532e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.351487620643
                                         uncertainty =       0.002099231646

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.351487620643
                                         uncertainty =       0.002099231646

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000419268390
  error estimate for blocks of size 2^( 2) =       0.000433616159
  error estimate for blocks of size 2^( 3) =       0.000448290815
  error estimate for blocks of size 2^( 4) =       0.000461234467
  error estimate for blocks of size 2^( 5) =       0.000471879443
  error estimate for blocks of size 2^( 6) =       0.000480876741
  error estimate for blocks of size 2^( 7) =       0.000485933275

      target function =      -0.824385596902
              le_mean =     -16.896580609190
             les_mean =     285.861734724051
             stat err =       0.000474980981
             autocorr =       1.283418217932
   target nu stat err =       0.000474980981
   target dn stat err =       0.002869264305
      target stat err =       0.003157382596
              std dev =       0.592935043255
             le_variance =       0.351571965519


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.689658060919e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 74
Check correct_vf_var_size: 225, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.5000e-01, overlap shift 2.5000e+00 and omega -1.7527e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.824396624182       residual = 7.67e-01           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.835286336422       residual = 1.56e-01           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.837319727245       residual = 3.05e-02           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.837868497040       residual = 6.49e-03           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.838007414342       residual = 2.63e-03           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.838061343473       residual = 1.68e-03           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.838101489697       residual = 5.22e-04           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.838113635440       residual = 1.32e-04           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.838116820811       residual = 4.61e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.838117742091       residual = 1.37e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.838118423749       residual = 7.21e-06           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.838118303380       residual = 2.56e-06           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.838118378010       residual = 2.29e-06           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.838118426873       residual = 2.60e-06           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.838118501698       residual = 2.87e-06           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.838118531690       residual = 8.05e-07           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.838118571007       residual = 1.96e-07           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.838118629120       residual = 7.53e-08           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.838118637637       residual = 2.12e-08           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.838118661081       residual = 7.83e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         19 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 2.5000e-01 is 3.706055e-03

solving harmonic davidson linear method for identity shift 1.0000e+00, overlap shift 1.0000e+01 and omega -1.7527e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.824396624182       residual = 7.67e-01           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.827616812828       residual = 1.48e-01           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.828193582950       residual = 2.78e-02           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.828340761209       residual = 5.62e-03           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.828377014664       residual = 2.24e-03           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.828390693276       residual = 1.36e-03           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.828400105937       residual = 3.91e-04           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.828402716280       residual = 9.32e-05           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.828403342441       residual = 3.01e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.828403521424       residual = 9.08e-06           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.828403667694       residual = 4.58e-06           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.828403630957       residual = 1.72e-06           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.828403647150       residual = 1.70e-06           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.828403656049       residual = 1.81e-06           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.828403672054       residual = 1.39e-06           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.828403674076       residual = 2.78e-07           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.828403680265       residual = 6.86e-08           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.828403690574       residual = 2.45e-08           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.828403691868       residual = 6.68e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         18 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 1.0000e+00 is 1.106108e-03

solving harmonic davidson linear method for identity shift 4.0000e+00, overlap shift 4.0000e+01 and omega -1.7527e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.824396624182       residual = 7.67e-01           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.825239647134       residual = 1.45e-01           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.825388555499       residual = 2.70e-02           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.825425882606       residual = 5.37e-03           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.825435000983       residual = 2.13e-03           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.825438409933       residual = 1.27e-03           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.825440699497       residual = 3.57e-04           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.825441316846       residual = 8.35e-05           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.825441460949       residual = 2.64e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.825441502186       residual = 8.00e-06           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.825441536985       residual = 3.99e-06           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.825441527486       residual = 1.53e-06           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.825441531381       residual = 1.55e-06           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.825441533335       residual = 1.60e-06           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.825441537121       residual = 1.09e-06           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.825441537371       residual = 2.02e-07           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.825441538728       residual = 5.03e-08           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.825441541050       residual = 1.74e-08           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.825441541327       residual = 4.72e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         18 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 4.0000e+00 is 2.903628e-04

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.150153 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 75 and numParams is: 74

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.7251e+01
  </log>
  <optVariables href="H2O.s002.opt.xml">
ci_0001                 6.947332e-01 3 1  ON 0
ci_0002                 6.948603e-01 3 1  ON 1
ci_0003                -4.556542e-02 3 1  ON 2
ci_0004                -4.567532e-02 3 1  ON 3
ci_0005                -4.311634e-02 3 1  ON 4
ci_0006                -4.335214e-02 3 1  ON 5
ci_0007                -3.101344e-02 3 1  ON 6
ci_0008                -3.113456e-02 3 1  ON 7
ci_0009                -2.968448e-02 3 1  ON 8
ci_0010                -2.972029e-02 3 1  ON 9
ci_0011                -2.500129e-02 3 1  ON 10
ci_0012                -2.496374e-02 3 1  ON 11
ci_0013                 2.466202e-02 3 1  ON 12
ci_0014                 2.454625e-02 3 1  ON 13
ci_0015                 2.452174e-02 3 1  ON 14
ci_0016                 2.448771e-02 3 1  ON 15
ci_0017                 2.251165e-02 3 1  ON 16
ci_0018                 2.253652e-02 3 1  ON 17
ci_0019                 1.875672e-02 3 1  ON 18
ci_0020                 1.883207e-02 3 1  ON 19
ci_0021                 1.896009e-02 3 1  ON 20
ci_0022                 1.873939e-02 3 1  ON 21
ci_0023                -1.764054e-02 3 1  ON 22
ci_0024                -1.754343e-02 3 1  ON 23
ci_0025                -1.572742e-02 3 1  ON 24
ci_0026                -1.574941e-02 3 1  ON 25
ci_0027                -1.707693e-02 3 1  ON 26
ci_0028                -1.703034e-02 3 1  ON 27
ci_0029                -1.576760e-02 3 1  ON 28
ci_0030                -1.569611e-02 3 1  ON 29
ci_0031                 1.635133e-02 3 1  ON 30
ci_0032                 1.625097e-02 3 1  ON 31
ci_0033                 1.469794e-02 3 1  ON 32
ci_0034                 1.495117e-02 3 1  ON 33
ci_0035                 1.353458e-02 3 1  ON 34
ci_0036                 1.378223e-02 3 1  ON 35
ci_0037                -1.436647e-02 3 1  ON 36
ci_0038                -1.436111e-02 3 1  ON 37
ci_0039                -1.280901e-02 3 1  ON 38
ci_0040                -1.271213e-02 3 1  ON 39
ci_0041                 1.377001e-02 3 1  ON 40
ci_0042                 1.377593e-02 3 1  ON 41
ci_0043                -1.308148e-02 3 1  ON 42
ci_0044                -1.323095e-02 3 1  ON 43
ci_0045                 1.341400e-02 3 1  ON 44
ci_0046                 1.331446e-02 3 1  ON 45
ci_0047                -1.183408e-02 3 1  ON 46
ci_0048                -1.184003e-02 3 1  ON 47
ci_0049                -1.065191e-02 3 1  ON 48
ci_0050                -1.058073e-02 3 1  ON 49
ci_0051                -1.044462e-02 3 1  ON 50
ci_0052                -1.038617e-02 3 1  ON 51
ci_0053                -1.054081e-02 3 1  ON 52
ci_0054                -1.044537e-02 3 1  ON 53
ci_0055                 1.013436e-02 3 1  ON 54
ci_0056                 1.013958e-02 3 1  ON 55
ci_0057                 1.000548e-02 3 1  ON 56
ci_0058                 1.028707e-02 3 1  ON 57
ci_0059                -1.026613e-02 3 1  ON 58
ci_0060                -1.018292e-02 3 1  ON 59
ci_0061                -1.018718e-02 3 1  ON 60
ci_0062                -1.024597e-02 3 1  ON 61
ci_0063                -1.109629e-02 3 1  ON 62
ci_0064                -1.102069e-02 3 1  ON 63
ci_0065                -1.025967e-02 3 1  ON 64
ci_0066                -1.036302e-02 3 1  ON 65
ci_0067                -9.709417e-03 3 1  ON 66
ci_0068                -9.759857e-03 3 1  ON 67
ci_0069                 9.193794e-03 3 1  ON 68
ci_0070                 9.134782e-03 3 1  ON 69
ci_0071                 9.415800e-03 3 1  ON 70
ci_0072                 9.400402e-03 3 1  ON 71
ci_0073                 8.749427e-03 3 1  ON 72
ci_0074                 8.897462e-03 3 1  ON 73
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 2
    time step          = 0.05
    reference energy   = -16.7853
    reference variance = 0.289937
====================================================
  Execution time = 1.4584e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s002
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6897e+01
  VMC Evar = 3.6573e-01
  Total weights = 1.9506e+06
  Execution time = 1.9216e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.358681287847
                                         uncertainty =       0.003325256254

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.358681287847
                                         uncertainty =       0.003325256254

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000423638191
  error estimate for blocks of size 2^( 2) =       0.000437967955
  error estimate for blocks of size 2^( 3) =       0.000452202493
  error estimate for blocks of size 2^( 4) =       0.000465131913
  error estimate for blocks of size 2^( 5) =       0.000475296061
  error estimate for blocks of size 2^( 6) =       0.000483980094
  error estimate for blocks of size 2^( 7) =       0.000486020849

      target function =      -0.798721406414
              le_mean =     -16.897466587536
             les_mean =     285.916140684461
             stat err =       0.000477607229
             autocorr =       1.271017628701
   target nu stat err =       0.000477607229
   target dn stat err =       0.009070132679
      target stat err =       0.009219778169
              std dev =       0.599114875275
             le_variance =       0.358938633776

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338763354637
                                         uncertainty =       0.003360067853

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338763354637
                                         uncertainty =       0.003360067853

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000411677287
  error estimate for blocks of size 2^( 2) =       0.000425732599
  error estimate for blocks of size 2^( 3) =       0.000439883190
  error estimate for blocks of size 2^( 4) =       0.000452806985
  error estimate for blocks of size 2^( 5) =       0.000462996203
  error estimate for blocks of size 2^( 6) =       0.000471799914
  error estimate for blocks of size 2^( 7) =       0.000474246829

      target function =      -0.770545748956
              le_mean =     -16.897737665166
             les_mean =     285.953284622380
             stat err =       0.000465462482
             autocorr =       1.278366991198
   target nu stat err =       0.000465462482
   target dn stat err =       0.027225678314
      target stat err =       0.025743669543
              std dev =       0.582199603182
             le_variance =       0.338956377946

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.345443486279
                                         uncertainty =       0.003338274839

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.345443486279
                                         uncertainty =       0.003338274839

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000415728299
  error estimate for blocks of size 2^( 2) =       0.000429890356
  error estimate for blocks of size 2^( 3) =       0.000444052792
  error estimate for blocks of size 2^( 4) =       0.000457001066
  error estimate for blocks of size 2^( 5) =       0.000467247064
  error estimate for blocks of size 2^( 6) =       0.000475991731
  error estimate for blocks of size 2^( 7) =       0.000478236804

      target function =      -0.827649022837
              le_mean =     -16.897470572739
             les_mean =     285.888827377374
             stat err =       0.000469619166
             autocorr =       1.276063977678
   target nu stat err =       0.000469619166
   target dn stat err =       0.004441901183
      target stat err =       0.004876525428
              std dev =       0.587928599173
             le_variance =       0.345660037726

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.356663411431
                                         uncertainty =       0.003311284154

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.356663411431
                                         uncertainty =       0.003311284154

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000422442249
  error estimate for blocks of size 2^( 2) =       0.000436753392
  error estimate for blocks of size 2^( 3) =       0.000450979589
  error estimate for blocks of size 2^( 4) =       0.000463903927
  error estimate for blocks of size 2^( 5) =       0.000474104566
  error estimate for blocks of size 2^( 6) =       0.000482803703
  error estimate for blocks of size 2^( 7) =       0.000484878801

      target function =      -0.816500864873
              le_mean =     -16.897457151142
             les_mean =     285.898755379759
             stat err =       0.000476422749
             autocorr =       1.271892157560
   target nu stat err =       0.000476422749
   target dn stat err =       0.004031770940
      target stat err =       0.004317502016
              std dev =       0.597423558159
             le_variance =       0.356914907843


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.798721406414        initial
     2.5000e-01     2.5000e+00             3.7061e-03        -0.770545748956
     1.0000e+00     1.0000e+01             1.1061e-03        -0.827649022837  <--
     4.0000e+00     4.0000e+01             2.9036e-04        -0.816500864873

*****************************************************************************
Applying the update for shift_i =   1.0000e+00     and shift_s =   1.0000e+01
*****************************************************************************

  Execution time = 2.7896e+01
  </log>
  <optVariables href="H2O.s002.opt.xml">
ci_0001                 6.947332e-01 3 1  ON 0
ci_0002                 6.948603e-01 3 1  ON 1
ci_0003                -4.556542e-02 3 1  ON 2
ci_0004                -4.567532e-02 3 1  ON 3
ci_0005                -4.311634e-02 3 1  ON 4
ci_0006                -4.335214e-02 3 1  ON 5
ci_0007                -3.101344e-02 3 1  ON 6
ci_0008                -3.113456e-02 3 1  ON 7
ci_0009                -2.968448e-02 3 1  ON 8
ci_0010                -2.972029e-02 3 1  ON 9
ci_0011                -2.500129e-02 3 1  ON 10
ci_0012                -2.496374e-02 3 1  ON 11
ci_0013                 2.466202e-02 3 1  ON 12
ci_0014                 2.454625e-02 3 1  ON 13
ci_0015                 2.452174e-02 3 1  ON 14
ci_0016                 2.448771e-02 3 1  ON 15
ci_0017                 2.251165e-02 3 1  ON 16
ci_0018                 2.253652e-02 3 1  ON 17
ci_0019                 1.875672e-02 3 1  ON 18
ci_0020                 1.883207e-02 3 1  ON 19
ci_0021                 1.896009e-02 3 1  ON 20
ci_0022                 1.873939e-02 3 1  ON 21
ci_0023                -1.764054e-02 3 1  ON 22
ci_0024                -1.754343e-02 3 1  ON 23
ci_0025                -1.572742e-02 3 1  ON 24
ci_0026                -1.574941e-02 3 1  ON 25
ci_0027                -1.707693e-02 3 1  ON 26
ci_0028                -1.703034e-02 3 1  ON 27
ci_0029                -1.576760e-02 3 1  ON 28
ci_0030                -1.569611e-02 3 1  ON 29
ci_0031                 1.635133e-02 3 1  ON 30
ci_0032                 1.625097e-02 3 1  ON 31
ci_0033                 1.469794e-02 3 1  ON 32
ci_0034                 1.495117e-02 3 1  ON 33
ci_0035                 1.353458e-02 3 1  ON 34
ci_0036                 1.378223e-02 3 1  ON 35
ci_0037                -1.436647e-02 3 1  ON 36
ci_0038                -1.436111e-02 3 1  ON 37
ci_0039                -1.280901e-02 3 1  ON 38
ci_0040                -1.271213e-02 3 1  ON 39
ci_0041                 1.377001e-02 3 1  ON 40
ci_0042                 1.377593e-02 3 1  ON 41
ci_0043                -1.308148e-02 3 1  ON 42
ci_0044                -1.323095e-02 3 1  ON 43
ci_0045                 1.341400e-02 3 1  ON 44
ci_0046                 1.331446e-02 3 1  ON 45
ci_0047                -1.183408e-02 3 1  ON 46
ci_0048                -1.184003e-02 3 1  ON 47
ci_0049                -1.065191e-02 3 1  ON 48
ci_0050                -1.058073e-02 3 1  ON 49
ci_0051                -1.044462e-02 3 1  ON 50
ci_0052                -1.038617e-02 3 1  ON 51
ci_0053                -1.054081e-02 3 1  ON 52
ci_0054                -1.044537e-02 3 1  ON 53
ci_0055                 1.013436e-02 3 1  ON 54
ci_0056                 1.013958e-02 3 1  ON 55
ci_0057                 1.000548e-02 3 1  ON 56
ci_0058                 1.028707e-02 3 1  ON 57
ci_0059                -1.026613e-02 3 1  ON 58
ci_0060                -1.018292e-02 3 1  ON 59
ci_0061                -1.018718e-02 3 1  ON 60
ci_0062                -1.024597e-02 3 1  ON 61
ci_0063                -1.109629e-02 3 1  ON 62
ci_0064                -1.102069e-02 3 1  ON 63
ci_0065                -1.025967e-02 3 1  ON 64
ci_0066                -1.036302e-02 3 1  ON 65
ci_0067                -9.709417e-03 3 1  ON 66
ci_0068                -9.759857e-03 3 1  ON 67
ci_0069                 9.193794e-03 3 1  ON 68
ci_0070                 9.134782e-03 3 1  ON 69
ci_0071                 9.415800e-03 3 1  ON 70
ci_0072                 9.400402e-03 3 1  ON 71
ci_0073                 8.749427e-03 3 1  ON 72
ci_0074                 8.897462e-03 3 1  ON 73
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 4.5154e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s003 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s003 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=3  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6889e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 3
    time step          = 0.05
    reference energy   = -16.8913
    reference variance = 0.325414
====================================================
  Execution time = 1.4599e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s003
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5233e+04
  VMC Eavg = -1.6898e+01
  VMC Evar = 3.6852e-01
  Total weights = 1.951204060e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 2.6513e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.353185886800
                                         uncertainty =       0.002899594041

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.353185886800
                                         uncertainty =       0.002899594041

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000420192460
  error estimate for blocks of size 2^( 2) =       0.000434101343
  error estimate for blocks of size 2^( 3) =       0.000447790138
  error estimate for blocks of size 2^( 4) =       0.000460404622
  error estimate for blocks of size 2^( 5) =       0.000469255891
  error estimate for blocks of size 2^( 6) =       0.000477513216
  error estimate for blocks of size 2^( 7) =       0.000483337494

      target function =      -0.823115059596
              le_mean =     -16.897806803340
             les_mean =     285.904398573200
             stat err =       0.000472627806
             autocorr =       1.265150022181
   target nu stat err =       0.000472627806
   target dn stat err =       0.003780626315
      target stat err =       0.004120968381
              std dev =       0.594241875394
             le_variance =       0.353123406471


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.689780680334e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 74
Check correct_vf_var_size: 225, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.5000e-01, overlap shift 2.5000e+00 and omega -1.7527e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.823134421521       residual = 7.22e-01           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.833198860538       residual = 1.29e-01           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.834969966997       residual = 2.56e-02           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.835448903901       residual = 7.34e-03           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.835576363783       residual = 2.89e-03           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.835629685046       residual = 1.54e-03           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.835667719171       residual = 5.44e-04           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.835677067301       residual = 1.94e-04           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.835681983966       residual = 7.85e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.835684198947       residual = 3.13e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.835684541289       residual = 2.39e-05           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.835684863514       residual = 1.28e-05           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.835684980413       residual = 1.43e-05           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.835685224892       residual = 1.26e-05           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.835686188661       residual = 8.80e-06           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.835686402758       residual = 2.02e-06           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.835686467313       residual = 3.05e-07           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.835686424145       residual = 1.37e-07           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.835686428261       residual = 3.48e-08           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.835686417944       residual = 1.54e-08           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.835686428716       residual = 3.23e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         20 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 2.5000e-01 is 3.248427e-03

solving harmonic davidson linear method for identity shift 1.0000e+00, overlap shift 1.0000e+01 and omega -1.7527e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.823134421521       residual = 7.22e-01           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.826112052888       residual = 1.23e-01           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.826614689665       residual = 2.34e-02           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.826743624560       residual = 6.35e-03           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.826776850168       residual = 2.47e-03           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.826790208743       residual = 1.24e-03           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.826799140978       residual = 4.07e-04           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.826801189150       residual = 1.39e-04           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.826802261452       residual = 5.48e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.826802724379       residual = 2.25e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.826802770711       residual = 1.68e-05           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.826802826093       residual = 9.30e-06           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.826802851889       residual = 1.06e-05           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.826802915828       residual = 7.20e-06           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.826803098244       residual = 3.61e-06           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.826803115261       residual = 6.28e-07           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.826803122692       residual = 1.07e-07           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.826803114556       residual = 4.75e-08           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.826803115771       residual = 1.11e-08           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.826803114345       residual = 4.66e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         19 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 1.0000e+00 is 9.706361e-04

solving harmonic davidson linear method for identity shift 4.0000e+00, overlap shift 4.0000e+01 and omega -1.7527e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.823134421521       residual = 7.22e-01           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.823914106220       residual = 1.21e-01           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.824043912480       residual = 2.27e-02           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.824076656112       residual = 6.06e-03           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.824085010853       residual = 2.35e-03           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.824088326711       residual = 1.16e-03           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.824090501295       residual = 3.71e-04           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.824090989172       residual = 1.26e-04           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.824091244893       residual = 4.91e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.824091353931       residual = 2.03e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.824091362739       residual = 1.51e-05           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.824091374965       residual = 8.45e-06           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.824091381291       residual = 9.64e-06           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.824091397304       residual = 5.96e-06           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.824091438548       residual = 2.71e-06           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.824091441189       residual = 4.41e-07           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.824091442679       residual = 7.89e-08           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.824091440829       residual = 3.46e-08           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.824091441142       residual = 7.86e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         18 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 4.0000e+00 is 2.549496e-04

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.163614 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 75 and numParams is: 74

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.7270e+01
  </log>
  <optVariables href="H2O.s003.opt.xml">
ci_0001                 6.948568e-01 3 1  ON 0
ci_0002                 6.956247e-01 3 1  ON 1
ci_0003                -4.469888e-02 3 1  ON 2
ci_0004                -4.488051e-02 3 1  ON 3
ci_0005                -4.229649e-02 3 1  ON 4
ci_0006                -4.258751e-02 3 1  ON 5
ci_0007                -3.032545e-02 3 1  ON 6
ci_0008                -3.054492e-02 3 1  ON 7
ci_0009                -2.899184e-02 3 1  ON 8
ci_0010                -2.907604e-02 3 1  ON 9
ci_0011                -2.441145e-02 3 1  ON 10
ci_0012                -2.438938e-02 3 1  ON 11
ci_0013                 2.405878e-02 3 1  ON 12
ci_0014                 2.401162e-02 3 1  ON 13
ci_0015                 2.402916e-02 3 1  ON 14
ci_0016                 2.396819e-02 3 1  ON 15
ci_0017                 2.186945e-02 3 1  ON 16
ci_0018                 2.203876e-02 3 1  ON 17
ci_0019                 1.832588e-02 3 1  ON 18
ci_0020                 1.845022e-02 3 1  ON 19
ci_0021                 1.881427e-02 3 1  ON 20
ci_0022                 1.878914e-02 3 1  ON 21
ci_0023                -1.722702e-02 3 1  ON 22
ci_0024                -1.711286e-02 3 1  ON 23
ci_0025                -1.475678e-02 3 1  ON 24
ci_0026                -1.493649e-02 3 1  ON 25
ci_0027                -1.671514e-02 3 1  ON 26
ci_0028                -1.666867e-02 3 1  ON 27
ci_0029                -1.541508e-02 3 1  ON 28
ci_0030                -1.526644e-02 3 1  ON 29
ci_0031                 1.620217e-02 3 1  ON 30
ci_0032                 1.612283e-02 3 1  ON 31
ci_0033                 1.439643e-02 3 1  ON 32
ci_0034                 1.468206e-02 3 1  ON 33
ci_0035                 1.276529e-02 3 1  ON 34
ci_0036                 1.305168e-02 3 1  ON 35
ci_0037                -1.424248e-02 3 1  ON 36
ci_0038                -1.419419e-02 3 1  ON 37
ci_0039                -1.222385e-02 3 1  ON 38
ci_0040                -1.211930e-02 3 1  ON 39
ci_0041                 1.352896e-02 3 1  ON 40
ci_0042                 1.357841e-02 3 1  ON 41
ci_0043                -1.270642e-02 3 1  ON 42
ci_0044                -1.287322e-02 3 1  ON 43
ci_0045                 1.312686e-02 3 1  ON 44
ci_0046                 1.314198e-02 3 1  ON 45
ci_0047                -1.124513e-02 3 1  ON 46
ci_0048                -1.127420e-02 3 1  ON 47
ci_0049                -1.000284e-02 3 1  ON 48
ci_0050                -9.914164e-03 3 1  ON 49
ci_0051                -9.742237e-03 3 1  ON 50
ci_0052                -9.833409e-03 3 1  ON 51
ci_0053                -1.010014e-02 3 1  ON 52
ci_0054                -9.941520e-03 3 1  ON 53
ci_0055                 9.566885e-03 3 1  ON 54
ci_0056                 9.731366e-03 3 1  ON 55
ci_0057                 9.551814e-03 3 1  ON 56
ci_0058                 9.732453e-03 3 1  ON 57
ci_0059                -9.844226e-03 3 1  ON 58
ci_0060                -9.663730e-03 3 1  ON 59
ci_0061                -9.759963e-03 3 1  ON 60
ci_0062                -9.804359e-03 3 1  ON 61
ci_0063                -1.094404e-02 3 1  ON 62
ci_0064                -1.091646e-02 3 1  ON 63
ci_0065                -1.002883e-02 3 1  ON 64
ci_0066                -1.018772e-02 3 1  ON 65
ci_0067                -9.171883e-03 3 1  ON 66
ci_0068                -9.332352e-03 3 1  ON 67
ci_0069                 8.888201e-03 3 1  ON 68
ci_0070                 8.663236e-03 3 1  ON 69
ci_0071                 9.008682e-03 3 1  ON 70
ci_0072                 9.106321e-03 3 1  ON 71
ci_0073                 8.324700e-03 3 1  ON 72
ci_0074                 8.498902e-03 3 1  ON 73
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 3
    time step          = 0.05
    reference energy   = -16.8029
    reference variance = 0.220512
====================================================
  Execution time = 1.4277e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s003
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6898e+01
  VMC Evar = 3.6112e-01
  Total weights = 1.9511e+06
  Execution time = 1.9189e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.480448551267
                                         uncertainty =       0.125456415296

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.480448551267
                                         uncertainty =       0.125456415296

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000489916274
  error estimate for blocks of size 2^( 2) =       0.000502304575
  error estimate for blocks of size 2^( 3) =       0.000514556918
  error estimate for blocks of size 2^( 4) =       0.000526556557
  error estimate for blocks of size 2^( 5) =       0.000536595151
  error estimate for blocks of size 2^( 6) =       0.000542308222
  error estimate for blocks of size 2^( 7) =       0.000547129846

      target function =      -0.000954860206
              le_mean =     -16.898219894164
             les_mean =     614.982776901357
             stat err =       0.000538147444
             autocorr =       1.206587527571
   target nu stat err =       0.000538147444
   target dn stat err =     329.209135371830
      target stat err =       0.000953069815
              std dev =       0.692846239208
             le_variance =       0.480035911184

ERROR CostFunction-> Number of Effective Walkers is too small! 
  Number of effective walkers (samples) / total number of samples = 0.235126
  User specified threshold minwalkers = 0.3
  If this message appears frequently. You might have to be cautious. 
  Find info about parameter "minwalkers" in the user manual!
Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.334433896404
                                         uncertainty =       0.002300808721

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.334433896404
                                         uncertainty =       0.002300808721

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000408898149
  error estimate for blocks of size 2^( 2) =       0.000422943472
  error estimate for blocks of size 2^( 3) =       0.000437492160
  error estimate for blocks of size 2^( 4) =       0.000451160919
  error estimate for blocks of size 2^( 5) =       0.000462928072
  error estimate for blocks of size 2^( 6) =       0.000470089878
  error estimate for blocks of size 2^( 7) =       0.000474599176

      target function =      -0.835124410490
              le_mean =     -16.898760840314
             les_mean =     285.925682657674
             stat err =       0.000464694511
             autocorr =       1.291530888228
   target nu stat err =       0.000464694511
   target dn stat err =       0.006160474460
      target stat err =       0.006872602463
              std dev =       0.578269307411
             le_variance =       0.334395391894

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.341096806915
                                         uncertainty =       0.002341665797

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.341096806915
                                         uncertainty =       0.002341665797

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000412958371
  error estimate for blocks of size 2^( 2) =       0.000427051919
  error estimate for blocks of size 2^( 3) =       0.000441596685
  error estimate for blocks of size 2^( 4) =       0.000455214626
  error estimate for blocks of size 2^( 5) =       0.000466921828
  error estimate for blocks of size 2^( 6) =       0.000473909774
  error estimate for blocks of size 2^( 7) =       0.000478652122

      target function =      -0.837180491250
              le_mean =     -16.898528516277
             les_mean =     285.916008466236
             stat err =       0.000468674588
             autocorr =       1.288042707444
   target nu stat err =       0.000468674588
   target dn stat err =       0.003005299408
      target stat err =       0.003411856936
              std dev =       0.584011329468
             le_variance =       0.341069232947

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.352360800670
                                         uncertainty =       0.002656472171

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.352360800670
                                         uncertainty =       0.002656472171

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000419732214
  error estimate for blocks of size 2^( 2) =       0.000433936675
  error estimate for blocks of size 2^( 3) =       0.000448466443
  error estimate for blocks of size 2^( 4) =       0.000462039152
  error estimate for blocks of size 2^( 5) =       0.000473676768
  error estimate for blocks of size 2^( 6) =       0.000480463625
  error estimate for blocks of size 2^( 7) =       0.000485357328

      target function =      -0.818610667876
              le_mean =     -16.898461894798
             les_mean =     285.930757727927
             stat err =       0.000475384218
             autocorr =       1.282758544669
   target nu stat err =       0.000475384218
   target dn stat err =       0.004382047993
      target stat err =       0.004716622991
              std dev =       0.593590989068
             le_variance =       0.352350262303


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.000954860206        initial  <--
            N/A            N/A                    N/A                    N/A     bad update
            N/A            N/A                    N/A                    N/A     bad update
            N/A            N/A                    N/A                    N/A     bad update

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 23.9832
  </log>
  <optVariables href="H2O.s003.opt.xml">
ci_0001                 6.947332e-01 3 1  ON 0
ci_0002                 6.948603e-01 3 1  ON 1
ci_0003                -4.556542e-02 3 1  ON 2
ci_0004                -4.567532e-02 3 1  ON 3
ci_0005                -4.311634e-02 3 1  ON 4
ci_0006                -4.335214e-02 3 1  ON 5
ci_0007                -3.101344e-02 3 1  ON 6
ci_0008                -3.113456e-02 3 1  ON 7
ci_0009                -2.968448e-02 3 1  ON 8
ci_0010                -2.972029e-02 3 1  ON 9
ci_0011                -2.500129e-02 3 1  ON 10
ci_0012                -2.496374e-02 3 1  ON 11
ci_0013                 2.466202e-02 3 1  ON 12
ci_0014                 2.454625e-02 3 1  ON 13
ci_0015                 2.452174e-02 3 1  ON 14
ci_0016                 2.448771e-02 3 1  ON 15
ci_0017                 2.251165e-02 3 1  ON 16
ci_0018                 2.253652e-02 3 1  ON 17
ci_0019                 1.875672e-02 3 1  ON 18
ci_0020                 1.883207e-02 3 1  ON 19
ci_0021                 1.896009e-02 3 1  ON 20
ci_0022                 1.873939e-02 3 1  ON 21
ci_0023                -1.764054e-02 3 1  ON 22
ci_0024                -1.754343e-02 3 1  ON 23
ci_0025                -1.572742e-02 3 1  ON 24
ci_0026                -1.574941e-02 3 1  ON 25
ci_0027                -1.707693e-02 3 1  ON 26
ci_0028                -1.703034e-02 3 1  ON 27
ci_0029                -1.576760e-02 3 1  ON 28
ci_0030                -1.569611e-02 3 1  ON 29
ci_0031                 1.635133e-02 3 1  ON 30
ci_0032                 1.625097e-02 3 1  ON 31
ci_0033                 1.469794e-02 3 1  ON 32
ci_0034                 1.495117e-02 3 1  ON 33
ci_0035                 1.353458e-02 3 1  ON 34
ci_0036                 1.378223e-02 3 1  ON 35
ci_0037                -1.436647e-02 3 1  ON 36
ci_0038                -1.436111e-02 3 1  ON 37
ci_0039                -1.280901e-02 3 1  ON 38
ci_0040                -1.271213e-02 3 1  ON 39
ci_0041                 1.377001e-02 3 1  ON 40
ci_0042                 1.377593e-02 3 1  ON 41
ci_0043                -1.308148e-02 3 1  ON 42
ci_0044                -1.323095e-02 3 1  ON 43
ci_0045                 1.341400e-02 3 1  ON 44
ci_0046                 1.331446e-02 3 1  ON 45
ci_0047                -1.183408e-02 3 1  ON 46
ci_0048                -1.184003e-02 3 1  ON 47
ci_0049                -1.065191e-02 3 1  ON 48
ci_0050                -1.058073e-02 3 1  ON 49
ci_0051                -1.044462e-02 3 1  ON 50
ci_0052                -1.038617e-02 3 1  ON 51
ci_0053                -1.054081e-02 3 1  ON 52
ci_0054                -1.044537e-02 3 1  ON 53
ci_0055                 1.013436e-02 3 1  ON 54
ci_0056                 1.013958e-02 3 1  ON 55
ci_0057                 1.000548e-02 3 1  ON 56
ci_0058                 1.028707e-02 3 1  ON 57
ci_0059                -1.026613e-02 3 1  ON 58
ci_0060                -1.018292e-02 3 1  ON 59
ci_0061                -1.018718e-02 3 1  ON 60
ci_0062                -1.024597e-02 3 1  ON 61
ci_0063                -1.109629e-02 3 1  ON 62
ci_0064                -1.102069e-02 3 1  ON 63
ci_0065                -1.025967e-02 3 1  ON 64
ci_0066                -1.036302e-02 3 1  ON 65
ci_0067                -9.709417e-03 3 1  ON 66
ci_0068                -9.759857e-03 3 1  ON 67
ci_0069                 9.193794e-03 3 1  ON 68
ci_0070                 9.134782e-03 3 1  ON 69
ci_0071                 9.415800e-03 3 1  ON 70
ci_0072                 9.400402e-03 3 1  ON 71
ci_0073                 8.749427e-03 3 1  ON 72
ci_0074                 8.897462e-03 3 1  ON 73
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 4.1263e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s004 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s004 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=4  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6878e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 4
    time step          = 0.05
    reference energy   = -16.8997
    reference variance = 0.390099
====================================================
  Execution time = 1.5406e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s004
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5234e+04
  VMC Eavg = -1.6898e+01
  VMC Evar = 3.6726e-01
  Total weights = 1.950965976e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 2.6555e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.350918996938
                                         uncertainty =       0.002334958018

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.350918996938
                                         uncertainty =       0.002334958018

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000418855641
  error estimate for blocks of size 2^( 2) =       0.000433298310
  error estimate for blocks of size 2^( 3) =       0.000447547929
  error estimate for blocks of size 2^( 4) =       0.000460009949
  error estimate for blocks of size 2^( 5) =       0.000470657411
  error estimate for blocks of size 2^( 6) =       0.000478905717
  error estimate for blocks of size 2^( 7) =       0.000485235049

      target function =      -0.824458330722
              le_mean =     -16.897524789879
             les_mean =     285.893607246737
             stat err =       0.000473702032
             autocorr =       1.279033024528
   target nu stat err =       0.000473702032
   target dn stat err =       0.004103613325
      target stat err =       0.004478052889
              std dev =       0.592351327585
             le_variance =       0.350880095292


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.689752478988e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 74
Check correct_vf_var_size: 225, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.5000e+00, overlap shift 2.5000e+01 and omega -1.7527e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.824481526436       residual = 7.95e-01           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.825770953035       residual = 1.36e-01           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.825985087437       residual = 2.72e-02           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.826044915402       residual = 6.90e-03           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.826058551267       residual = 2.62e-03           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.826065495452       residual = 1.22e-03           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.826068613639       residual = 3.81e-04           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.826069159844       residual = 8.80e-05           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.826069315468       residual = 3.20e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.826069453839       residual = 1.01e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.826069503889       residual = 4.08e-06           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.826069521420       residual = 1.56e-06           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.826069519194       residual = 1.11e-06           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.826069538471       residual = 1.22e-06           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.826069581912       residual = 1.25e-06           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.826069588805       residual = 3.17e-07           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.826069592352       residual = 8.17e-08           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.826069593077       residual = 3.48e-08           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.826069595671       residual = 1.12e-08           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.826069594922       residual = 3.92e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         19 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 2.5000e+00 is 4.387236e-04

solving harmonic davidson linear method for identity shift 1.0000e+01, overlap shift 1.0000e+02 and omega -1.7527e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.824481526436       residual = 7.95e-01           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.824810105450       residual = 1.35e-01           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.824864343943       residual = 2.69e-02           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.824879401035       residual = 6.77e-03           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.824882813880       residual = 2.57e-03           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.824884544372       residual = 1.18e-03           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.824885313361       residual = 3.67e-04           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.824885445488       residual = 8.40e-05           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.824885482655       residual = 3.02e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.824885516545       residual = 9.53e-06           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.824885528810       residual = 3.83e-06           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.824885532966       residual = 1.47e-06           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.824885532439       residual = 1.07e-06           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.824885537384       residual = 1.16e-06           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.824885547906       residual = 1.15e-06           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.824885549434       residual = 2.77e-07           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.824885550257       residual = 7.22e-08           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.824885550387       residual = 3.06e-08           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.824885551013       residual = 9.56e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         18 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 1.0000e+01 is 1.119112e-04

solving harmonic davidson linear method for identity shift 4.0000e+01, overlap shift 4.0000e+02 and omega -1.7527e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.824481526436       residual = 7.95e-01           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.824564068778       residual = 1.35e-01           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.824577672812       residual = 2.68e-02           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.824581443201       residual = 6.73e-03           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.824582296590       residual = 2.56e-03           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.824582728818       residual = 1.18e-03           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.824582920379       residual = 3.63e-04           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.824582953130       residual = 8.30e-05           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.824582962311       residual = 2.98e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.824582970739       residual = 9.40e-06           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.824582973790       residual = 3.77e-06           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.824582974815       residual = 1.44e-06           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.824582974685       residual = 1.06e-06           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.824582975929       residual = 1.15e-06           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.824582978537       residual = 1.13e-06           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.824582978908       residual = 2.68e-07           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.824582979110       residual = 7.00e-08           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.824582979139       residual = 2.96e-08           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.824582979294       residual = 9.18e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         18 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 4.0000e+01 is 2.812013e-05

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.181383 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 75 and numParams is: 74

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.8087e+01
  </log>
  <optVariables href="H2O.s004.opt.xml">
ci_0001                 6.947677e-01 3 1  ON 0
ci_0002                 6.949201e-01 3 1  ON 1
ci_0003                -4.547664e-02 3 1  ON 2
ci_0004                -4.559021e-02 3 1  ON 3
ci_0005                -4.303603e-02 3 1  ON 4
ci_0006                -4.327538e-02 3 1  ON 5
ci_0007                -3.094174e-02 3 1  ON 6
ci_0008                -3.105545e-02 3 1  ON 7
ci_0009                -2.961926e-02 3 1  ON 8
ci_0010                -2.965550e-02 3 1  ON 9
ci_0011                -2.493705e-02 3 1  ON 10
ci_0012                -2.490332e-02 3 1  ON 11
ci_0013                 2.460534e-02 3 1  ON 12
ci_0014                 2.448065e-02 3 1  ON 13
ci_0015                 2.446541e-02 3 1  ON 14
ci_0016                 2.442723e-02 3 1  ON 15
ci_0017                 2.245136e-02 3 1  ON 16
ci_0018                 2.247566e-02 3 1  ON 17
ci_0019                 1.871907e-02 3 1  ON 18
ci_0020                 1.878975e-02 3 1  ON 19
ci_0021                 1.894911e-02 3 1  ON 20
ci_0022                 1.872572e-02 3 1  ON 21
ci_0023                -1.760362e-02 3 1  ON 22
ci_0024                -1.750318e-02 3 1  ON 23
ci_0025                -1.563004e-02 3 1  ON 24
ci_0026                -1.563750e-02 3 1  ON 25
ci_0027                -1.703101e-02 3 1  ON 26
ci_0028                -1.699396e-02 3 1  ON 27
ci_0029                -1.573586e-02 3 1  ON 28
ci_0030                -1.565606e-02 3 1  ON 29
ci_0031                 1.634189e-02 3 1  ON 30
ci_0032                 1.623489e-02 3 1  ON 31
ci_0033                 1.467664e-02 3 1  ON 32
ci_0034                 1.490888e-02 3 1  ON 33
ci_0035                 1.346674e-02 3 1  ON 34
ci_0036                 1.371080e-02 3 1  ON 35
ci_0037                -1.434195e-02 3 1  ON 36
ci_0038                -1.434702e-02 3 1  ON 37
ci_0039                -1.274034e-02 3 1  ON 38
ci_0040                -1.264640e-02 3 1  ON 39
ci_0041                 1.374438e-02 3 1  ON 40
ci_0042                 1.374925e-02 3 1  ON 41
ci_0043                -1.303654e-02 3 1  ON 42
ci_0044                -1.320993e-02 3 1  ON 43
ci_0045                 1.339320e-02 3 1  ON 44
ci_0046                 1.329238e-02 3 1  ON 45
ci_0047                -1.176896e-02 3 1  ON 46
ci_0048                -1.177751e-02 3 1  ON 47
ci_0049                -1.060493e-02 3 1  ON 48
ci_0050                -1.051978e-02 3 1  ON 49
ci_0051                -1.037031e-02 3 1  ON 50
ci_0052                -1.031964e-02 3 1  ON 51
ci_0053                -1.049600e-02 3 1  ON 52
ci_0054                -1.039241e-02 3 1  ON 53
ci_0055                 1.006115e-02 3 1  ON 54
ci_0056                 1.007227e-02 3 1  ON 55
ci_0057                 9.953350e-03 3 1  ON 56
ci_0058                 1.022690e-02 3 1  ON 57
ci_0059                -1.021449e-02 3 1  ON 58
ci_0060                -1.014346e-02 3 1  ON 59
ci_0061                -1.014178e-02 3 1  ON 60
ci_0062                -1.019989e-02 3 1  ON 61
ci_0063                -1.108325e-02 3 1  ON 62
ci_0064                -1.100826e-02 3 1  ON 63
ci_0065                -1.023538e-02 3 1  ON 64
ci_0066                -1.033886e-02 3 1  ON 65
ci_0067                -9.662918e-03 3 1  ON 66
ci_0068                -9.712768e-03 3 1  ON 67
ci_0069                 9.138159e-03 3 1  ON 68
ci_0070                 9.085998e-03 3 1  ON 69
ci_0071                 9.384608e-03 3 1  ON 70
ci_0072                 9.362279e-03 3 1  ON 71
ci_0073                 8.707818e-03 3 1  ON 72
ci_0074                 8.849750e-03 3 1  ON 73
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 4
    time step          = 0.05
    reference energy   = -16.9074
    reference variance = 0.303879
====================================================
  Execution time = 1.4287e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s004
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6897e+01
  VMC Evar = 3.7003e-01
  Total weights = 1.9511e+06
  Execution time = 1.9184e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.345156578780
                                         uncertainty =       0.001968056335

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.345156578780
                                         uncertainty =       0.001968056335

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000415475530
  error estimate for blocks of size 2^( 2) =       0.000429647949
  error estimate for blocks of size 2^( 3) =       0.000443119450
  error estimate for blocks of size 2^( 4) =       0.000456074897
  error estimate for blocks of size 2^( 5) =       0.000467174985
  error estimate for blocks of size 2^( 6) =       0.000473048267
  error estimate for blocks of size 2^( 7) =       0.000477682850

      target function =      -0.821461127647
              le_mean =     -16.897191676974
             les_mean =     285.885004801117
             stat err =       0.000468495250
             autocorr =       1.271509131733
   target nu stat err =       0.000468495250
   target dn stat err =       0.010248355336
      target stat err =       0.011007899447
              std dev =       0.587571128803
             le_variance =       0.345239831403

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.342736815366
                                         uncertainty =       0.001947640355

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.342736815366
                                         uncertainty =       0.001947640355

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000414015578
  error estimate for blocks of size 2^( 2) =       0.000428144832
  error estimate for blocks of size 2^( 3) =       0.000441599154
  error estimate for blocks of size 2^( 4) =       0.000454552383
  error estimate for blocks of size 2^( 5) =       0.000465665051
  error estimate for blocks of size 2^( 6) =       0.000471557119
  error estimate for blocks of size 2^( 7) =       0.000476173659

      target function =      -0.813156972651
              le_mean =     -16.897198691184
             les_mean =     285.892684757658
             stat err =       0.000466987053
             autocorr =       1.272261296915
   target nu stat err =       0.000466987053
   target dn stat err =       0.020027630954
      target stat err =       0.021065875973
              std dev =       0.585506444994
             le_variance =       0.342817797129

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.343877831661
                                         uncertainty =       0.001954961447

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.343877831661
                                         uncertainty =       0.001954961447

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000414704709
  error estimate for blocks of size 2^( 2) =       0.000428856912
  error estimate for blocks of size 2^( 3) =       0.000442320763
  error estimate for blocks of size 2^( 4) =       0.000455276197
  error estimate for blocks of size 2^( 5) =       0.000466382771
  error estimate for blocks of size 2^( 6) =       0.000472265249
  error estimate for blocks of size 2^( 7) =       0.000476891231

      target function =      -0.818974985950
              le_mean =     -16.897193405554
             les_mean =     285.887273809873
             stat err =       0.000467703862
             autocorr =       1.271932248537
   target nu stat err =       0.000467703862
   target dn stat err =       0.013925152072
      target stat err =       0.014858568218
              std dev =       0.586481023351
             le_variance =       0.343959990751

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.344991733001
                                         uncertainty =       0.001966290173

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.344991733001
                                         uncertainty =       0.001966290173

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000415376247
  error estimate for blocks of size 2^( 2) =       0.000429546145
  error estimate for blocks of size 2^( 3) =       0.000443016696
  error estimate for blocks of size 2^( 4) =       0.000455972199
  error estimate for blocks of size 2^( 5) =       0.000467073173
  error estimate for blocks of size 2^( 6) =       0.000472947498
  error estimate for blocks of size 2^( 7) =       0.000477581039

      target function =      -0.821820356180
              le_mean =     -16.897191694418
             les_mean =     285.884661303891
             stat err =       0.000468393477
             autocorr =       1.271564399498
   target nu stat err =       0.000468393477
   target dn stat err =       0.010585453722
      target stat err =       0.011378943450
              std dev =       0.587430722206
             le_variance =       0.345074853392


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.821461127647        initial
     2.5000e+00     2.5000e+01             4.3872e-04        -0.813156972651
     1.0000e+01     1.0000e+02             1.1191e-04        -0.818974985950
     4.0000e+01     4.0000e+02             2.8120e-05        -0.821820356180  <--

*****************************************************************************
Applying the update for shift_i =   4.0000e+01     and shift_s =   4.0000e+02
*****************************************************************************

  Execution time = 2.3948e+01
  </log>
  <optVariables href="H2O.s004.opt.xml">
ci_0001                 6.947419e-01 3 1  ON 0
ci_0002                 6.948753e-01 3 1  ON 1
ci_0003                -4.554314e-02 3 1  ON 2
ci_0004                -4.565396e-02 3 1  ON 3
ci_0005                -4.309620e-02 3 1  ON 4
ci_0006                -4.333289e-02 3 1  ON 5
ci_0007                -3.099547e-02 3 1  ON 6
ci_0008                -3.111474e-02 3 1  ON 7
ci_0009                -2.966810e-02 3 1  ON 8
ci_0010                -2.970402e-02 3 1  ON 9
ci_0011                -2.498516e-02 3 1  ON 10
ci_0012                -2.494857e-02 3 1  ON 11
ci_0013                 2.464779e-02 3 1  ON 12
ci_0014                 2.452978e-02 3 1  ON 13
ci_0015                 2.450760e-02 3 1  ON 14
ci_0016                 2.447253e-02 3 1  ON 15
ci_0017                 2.249652e-02 3 1  ON 16
ci_0018                 2.252124e-02 3 1  ON 17
ci_0019                 1.874726e-02 3 1  ON 18
ci_0020                 1.882144e-02 3 1  ON 19
ci_0021                 1.895735e-02 3 1  ON 20
ci_0022                 1.873597e-02 3 1  ON 21
ci_0023                -1.763127e-02 3 1  ON 22
ci_0024                -1.753332e-02 3 1  ON 23
ci_0025                -1.570295e-02 3 1  ON 24
ci_0026                -1.572129e-02 3 1  ON 25
ci_0027                -1.706540e-02 3 1  ON 26
ci_0028                -1.702120e-02 3 1  ON 27
ci_0029                -1.575963e-02 3 1  ON 28
ci_0030                -1.568605e-02 3 1  ON 29
ci_0031                 1.634896e-02 3 1  ON 30
ci_0032                 1.624694e-02 3 1  ON 31
ci_0033                 1.469260e-02 3 1  ON 32
ci_0034                 1.494057e-02 3 1  ON 33
ci_0035                 1.351753e-02 3 1  ON 34
ci_0036                 1.376429e-02 3 1  ON 35
ci_0037                -1.436032e-02 3 1  ON 36
ci_0038                -1.435758e-02 3 1  ON 37
ci_0039                -1.279176e-02 3 1  ON 38
ci_0040                -1.269562e-02 3 1  ON 39
ci_0041                 1.376358e-02 3 1  ON 40
ci_0042                 1.376924e-02 3 1  ON 41
ci_0043                -1.307021e-02 3 1  ON 42
ci_0044                -1.322568e-02 3 1  ON 43
ci_0045                 1.340878e-02 3 1  ON 44
ci_0046                 1.330892e-02 3 1  ON 45
ci_0047                -1.181772e-02 3 1  ON 46
ci_0048                -1.182432e-02 3 1  ON 47
ci_0049                -1.064011e-02 3 1  ON 48
ci_0050                -1.056541e-02 3 1  ON 49
ci_0051                -1.042594e-02 3 1  ON 50
ci_0052                -1.036945e-02 3 1  ON 51
ci_0053                -1.052955e-02 3 1  ON 52
ci_0054                -1.043206e-02 3 1  ON 53
ci_0055                 1.011595e-02 3 1  ON 54
ci_0056                 1.012267e-02 3 1  ON 55
ci_0057                 9.992382e-03 3 1  ON 56
ci_0058                 1.027195e-02 3 1  ON 57
ci_0059                -1.025315e-02 3 1  ON 58
ci_0060                -1.017301e-02 3 1  ON 59
ci_0061                -1.017578e-02 3 1  ON 60
ci_0062                -1.023440e-02 3 1  ON 61
ci_0063                -1.109302e-02 3 1  ON 62
ci_0064                -1.101757e-02 3 1  ON 63
ci_0065                -1.025357e-02 3 1  ON 64
ci_0066                -1.035696e-02 3 1  ON 65
ci_0067                -9.697732e-03 3 1  ON 66
ci_0068                -9.748024e-03 3 1  ON 67
ci_0069                 9.179813e-03 3 1  ON 68
ci_0070                 9.122523e-03 3 1  ON 69
ci_0071                 9.407964e-03 3 1  ON 70
ci_0072                 9.390825e-03 3 1  ON 71
ci_0073                 8.738974e-03 3 1  ON 72
ci_0074                 8.885472e-03 3 1  ON 73
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 4.2050e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s005 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s005 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=5  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6883e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 5
    time step          = 0.05
    reference energy   = -16.8478
    reference variance = 0.318972
====================================================
  Execution time = 1.4768e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s005
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5272e+04
  VMC Eavg = -1.6897e+01
  VMC Evar = 3.6803e-01
  Total weights = 1.950887731e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 2.6203e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.353730637136
                                         uncertainty =       0.002999474704

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.353730637136
                                         uncertainty =       0.002999474704

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000420523931
  error estimate for blocks of size 2^( 2) =       0.000434149813
  error estimate for blocks of size 2^( 3) =       0.000448059308
  error estimate for blocks of size 2^( 4) =       0.000461192927
  error estimate for blocks of size 2^( 5) =       0.000473272077
  error estimate for blocks of size 2^( 6) =       0.000482694336
  error estimate for blocks of size 2^( 7) =       0.000489629396

      target function =      -0.823608765706
              le_mean =     -16.897043681558
             les_mean =     285.878115959712
             stat err =       0.000476697184
             autocorr =       1.285001816152
   target nu stat err =       0.000476697184
   target dn stat err =       0.003930796676
      target stat err =       0.004281704189
              std dev =       0.594710646884
             le_variance =       0.353680753517


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.689704368156e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 74
Check correct_vf_var_size: 225, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.0000e+01, overlap shift 1.0000e+02 and omega -1.7527e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.823629833637       residual = 6.89e-01           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.823936176330       residual = 1.15e-01           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.823987288180       residual = 2.08e-02           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.823999307102       residual = 4.32e-03           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.824002662088       residual = 1.47e-03           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.824003912702       residual = 6.60e-04           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.824004312563       residual = 1.82e-04           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.824004445707       residual = 9.24e-05           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.824004503639       residual = 3.56e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.824004534872       residual = 1.93e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.824004540088       residual = 1.55e-05           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.824004542848       residual = 9.51e-06           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.824004562657       residual = 1.04e-05           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.824004583497       residual = 4.00e-06           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.824004587162       residual = 8.12e-07           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.824004589718       residual = 1.38e-07           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.824004589367       residual = 3.69e-08           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.824004590281       residual = 1.23e-08           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.824004590533       residual = 3.57e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         18 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 1.0000e+01 is 1.056213e-04

solving harmonic davidson linear method for identity shift 4.0000e+01, overlap shift 4.0000e+02 and omega -1.7527e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.823629833637       residual = 6.89e-01           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.823706785154       residual = 1.15e-01           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.823719604430       residual = 2.07e-02           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.823722612727       residual = 4.30e-03           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.823723451874       residual = 1.46e-03           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.823723763857       residual = 6.54e-04           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.823723863380       residual = 1.81e-04           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.823723896503       residual = 9.14e-05           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.823723910922       residual = 3.52e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.823723918694       residual = 1.91e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.823723919978       residual = 1.54e-05           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.823723920663       residual = 9.42e-06           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.823723925610       residual = 1.02e-05           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.823723930764       residual = 3.90e-06           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.823723931652       residual = 7.84e-07           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.823723932280       residual = 1.33e-07           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.823723932194       residual = 3.57e-08           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.823723932420       residual = 1.18e-08           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.823723932482       residual = 3.43e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         18 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 4.0000e+01 is 2.653954e-05

solving harmonic davidson linear method for identity shift 1.6000e+02, overlap shift 1.6000e+03 and omega -1.7527e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.823629833637       residual = 6.89e-01           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.823649094508       residual = 1.15e-01           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.823652301914       residual = 2.07e-02           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.823653054209       residual = 4.29e-03           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.823653264019       residual = 1.46e-03           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.823653341973       residual = 6.53e-04           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.823653366825       residual = 1.80e-04           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.823653375096       residual = 9.12e-05           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.823653378697       residual = 3.51e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.823653380638       residual = 1.91e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.823653380957       residual = 1.53e-05           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.823653381128       residual = 9.40e-06           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.823653382365       residual = 1.02e-05           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.823653383650       residual = 3.88e-06           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.823653383869       residual = 7.77e-07           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.823653384026       residual = 1.32e-07           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.823653384005       residual = 3.54e-08           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.823653384061       residual = 1.17e-08           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.823653384076       residual = 3.39e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         18 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 1.6000e+02 is 6.643322e-06

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.198777 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 75 and numParams is: 74

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.7414e+01
  </log>
  <optVariables href="H2O.s005.opt.xml">
ci_0001                 6.947448e-01 3 1  ON 0
ci_0002                 6.948958e-01 3 1  ON 1
ci_0003                -4.552117e-02 3 1  ON 2
ci_0004                -4.563203e-02 3 1  ON 3
ci_0005                -4.307601e-02 3 1  ON 4
ci_0006                -4.331552e-02 3 1  ON 5
ci_0007                -3.097691e-02 3 1  ON 6
ci_0008                -3.109629e-02 3 1  ON 7
ci_0009                -2.965069e-02 3 1  ON 8
ci_0010                -2.968543e-02 3 1  ON 9
ci_0011                -2.497097e-02 3 1  ON 10
ci_0012                -2.493283e-02 3 1  ON 11
ci_0013                 2.463148e-02 3 1  ON 12
ci_0014                 2.451525e-02 3 1  ON 13
ci_0015                 2.449340e-02 3 1  ON 14
ci_0016                 2.445807e-02 3 1  ON 15
ci_0017                 2.248303e-02 3 1  ON 16
ci_0018                 2.250633e-02 3 1  ON 17
ci_0019                 1.873676e-02 3 1  ON 18
ci_0020                 1.880883e-02 3 1  ON 19
ci_0021                 1.895324e-02 3 1  ON 20
ci_0022                 1.873442e-02 3 1  ON 21
ci_0023                -1.762027e-02 3 1  ON 22
ci_0024                -1.752264e-02 3 1  ON 23
ci_0025                -1.567717e-02 3 1  ON 24
ci_0026                -1.569476e-02 3 1  ON 25
ci_0027                -1.705424e-02 3 1  ON 26
ci_0028                -1.701323e-02 3 1  ON 27
ci_0029                -1.574793e-02 3 1  ON 28
ci_0030                -1.567644e-02 3 1  ON 29
ci_0031                 1.634613e-02 3 1  ON 30
ci_0032                 1.624411e-02 3 1  ON 31
ci_0033                 1.468120e-02 3 1  ON 32
ci_0034                 1.493284e-02 3 1  ON 33
ci_0035                 1.350426e-02 3 1  ON 34
ci_0036                 1.374526e-02 3 1  ON 35
ci_0037                -1.435589e-02 3 1  ON 36
ci_0038                -1.435384e-02 3 1  ON 37
ci_0039                -1.277602e-02 3 1  ON 38
ci_0040                -1.267839e-02 3 1  ON 39
ci_0041                 1.375790e-02 3 1  ON 40
ci_0042                 1.376169e-02 3 1  ON 41
ci_0043                -1.306164e-02 3 1  ON 42
ci_0044                -1.321800e-02 3 1  ON 43
ci_0045                 1.340553e-02 3 1  ON 44
ci_0046                 1.330402e-02 3 1  ON 45
ci_0047                -1.180227e-02 3 1  ON 46
ci_0048                -1.180945e-02 3 1  ON 47
ci_0049                -1.062366e-02 3 1  ON 48
ci_0050                -1.055080e-02 3 1  ON 49
ci_0051                -1.040882e-02 3 1  ON 50
ci_0052                -1.035363e-02 3 1  ON 51
ci_0053                -1.051764e-02 3 1  ON 52
ci_0054                -1.042181e-02 3 1  ON 53
ci_0055                 1.010136e-02 3 1  ON 54
ci_0056                 1.010594e-02 3 1  ON 55
ci_0057                 9.980290e-03 3 1  ON 56
ci_0058                 1.025774e-02 3 1  ON 57
ci_0059                -1.023999e-02 3 1  ON 58
ci_0060                -1.016103e-02 3 1  ON 59
ci_0061                -1.016487e-02 3 1  ON 60
ci_0062                -1.022304e-02 3 1  ON 61
ci_0063                -1.108867e-02 3 1  ON 62
ci_0064                -1.101487e-02 3 1  ON 63
ci_0065                -1.024695e-02 3 1  ON 64
ci_0066                -1.034976e-02 3 1  ON 65
ci_0067                -9.685267e-03 3 1  ON 66
ci_0068                -9.736595e-03 3 1  ON 67
ci_0069                 9.167301e-03 3 1  ON 68
ci_0070                 9.110567e-03 3 1  ON 69
ci_0071                 9.399476e-03 3 1  ON 70
ci_0072                 9.383189e-03 3 1  ON 71
ci_0073                 8.729584e-03 3 1  ON 72
ci_0074                 8.874451e-03 3 1  ON 73
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 5
    time step          = 0.05
    reference energy   = -16.8496
    reference variance = 0.260304
====================================================
  Execution time = 1.4469e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s005
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6897e+01
  VMC Evar = 3.7422e-01
  Total weights = 1.9507e+06
  Execution time = 2.0293e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.356834218101
                                         uncertainty =       0.003247424942

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.356834218101
                                         uncertainty =       0.003247424942

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000422344523
  error estimate for blocks of size 2^( 2) =       0.000436585023
  error estimate for blocks of size 2^( 3) =       0.000450615621
  error estimate for blocks of size 2^( 4) =       0.000465158550
  error estimate for blocks of size 2^( 5) =       0.000475055458
  error estimate for blocks of size 2^( 6) =       0.000483571770
  error estimate for blocks of size 2^( 7) =       0.000487890661

      target function =      -0.816987186902
              le_mean =     -16.896730342717
             les_mean =     285.873707937603
             stat err =       0.000477919110
             autocorr =       1.280486662403
   target nu stat err =       0.000477919110
   target dn stat err =       0.004154209125
      target stat err =       0.004446355394
              std dev =       0.597285352645
             le_variance =       0.356749792484

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.356156319325
                                         uncertainty =       0.003240815856

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.356156319325
                                         uncertainty =       0.003240815856

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000421943111
  error estimate for blocks of size 2^( 2) =       0.000436174916
  error estimate for blocks of size 2^( 3) =       0.000450199005
  error estimate for blocks of size 2^( 4) =       0.000464742769
  error estimate for blocks of size 2^( 5) =       0.000474644746
  error estimate for blocks of size 2^( 6) =       0.000483162507
  error estimate for blocks of size 2^( 7) =       0.000487481491

      target function =      -0.816439052120
              le_mean =     -16.896732765625
             les_mean =     285.874303765539
             stat err =       0.000477507878
             autocorr =       1.280717314998
   target nu stat err =       0.000477507878
   target dn stat err =       0.004483345614
      target stat err =       0.004785633668
              std dev =       0.596717670024
             le_variance =       0.356071977719

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.356492343590
                                         uncertainty =       0.003244064845

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.356492343590
                                         uncertainty =       0.003244064845

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000422142133
  error estimate for blocks of size 2^( 2) =       0.000436378245
  error estimate for blocks of size 2^( 3) =       0.000450405580
  error estimate for blocks of size 2^( 4) =       0.000464948925
  error estimate for blocks of size 2^( 5) =       0.000474848401
  error estimate for blocks of size 2^( 6) =       0.000483365442
  error estimate for blocks of size 2^( 7) =       0.000487684198

      target function =      -0.816900697784
              le_mean =     -16.896731428502
             les_mean =     285.873825330611
             stat err =       0.000477711741
             autocorr =       1.280602752372
   target nu stat err =       0.000477711741
   target dn stat err =       0.004241938834
      target stat err =       0.004537472291
              std dev =       0.596999129751
             le_variance =       0.356407960924

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.356791293822
                                         uncertainty =       0.003247000288

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.356791293822
                                         uncertainty =       0.003247000288

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000422319117
  error estimate for blocks of size 2^( 2) =       0.000436559066
  error estimate for blocks of size 2^( 3) =       0.000450589256
  error estimate for blocks of size 2^( 4) =       0.000465132236
  error estimate for blocks of size 2^( 5) =       0.000475029468
  error estimate for blocks of size 2^( 6) =       0.000483545871
  error estimate for blocks of size 2^( 7) =       0.000487864732

      target function =      -0.816989067027
              le_mean =     -16.896730464692
             les_mean =     285.873710212926
             stat err =       0.000477893077
             autocorr =       1.280501216412
   target nu stat err =       0.000477893077
   target dn stat err =       0.004161349985
      target stat err =       0.004453866862
              std dev =       0.597249423316
             le_variance =       0.356706873652


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.816987186902        initial
     1.0000e+01     1.0000e+02             1.0562e-04        -0.816439052120
     4.0000e+01     4.0000e+02             2.6540e-05        -0.816900697784
     1.6000e+02     1.6000e+03             6.6433e-06        -0.816989067027  <--

*****************************************************************************
Applying the update for shift_i =   1.6000e+02     and shift_s =   1.6000e+03
*****************************************************************************

  Execution time = 2.4280e+01
  </log>
  <optVariables href="H2O.s005.opt.xml">
ci_0001                 6.947426e-01 3 1  ON 0
ci_0002                 6.948804e-01 3 1  ON 1
ci_0003                -4.553764e-02 3 1  ON 2
ci_0004                -4.564847e-02 3 1  ON 3
ci_0005                -4.309115e-02 3 1  ON 4
ci_0006                -4.332855e-02 3 1  ON 5
ci_0007                -3.099083e-02 3 1  ON 6
ci_0008                -3.111012e-02 3 1  ON 7
ci_0009                -2.966374e-02 3 1  ON 8
ci_0010                -2.969937e-02 3 1  ON 9
ci_0011                -2.498161e-02 3 1  ON 10
ci_0012                -2.494463e-02 3 1  ON 11
ci_0013                 2.464371e-02 3 1  ON 12
ci_0014                 2.452614e-02 3 1  ON 13
ci_0015                 2.450405e-02 3 1  ON 14
ci_0016                 2.446891e-02 3 1  ON 15
ci_0017                 2.249314e-02 3 1  ON 16
ci_0018                 2.251751e-02 3 1  ON 17
ci_0019                 1.874463e-02 3 1  ON 18
ci_0020                 1.881828e-02 3 1  ON 19
ci_0021                 1.895632e-02 3 1  ON 20
ci_0022                 1.873558e-02 3 1  ON 21
ci_0023                -1.762852e-02 3 1  ON 22
ci_0024                -1.753065e-02 3 1  ON 23
ci_0025                -1.569649e-02 3 1  ON 24
ci_0026                -1.571465e-02 3 1  ON 25
ci_0027                -1.706261e-02 3 1  ON 26
ci_0028                -1.701920e-02 3 1  ON 27
ci_0029                -1.575670e-02 3 1  ON 28
ci_0030                -1.568364e-02 3 1  ON 29
ci_0031                 1.634825e-02 3 1  ON 30
ci_0032                 1.624623e-02 3 1  ON 31
ci_0033                 1.468975e-02 3 1  ON 32
ci_0034                 1.493863e-02 3 1  ON 33
ci_0035                 1.351421e-02 3 1  ON 34
ci_0036                 1.375952e-02 3 1  ON 35
ci_0037                -1.435921e-02 3 1  ON 36
ci_0038                -1.435664e-02 3 1  ON 37
ci_0039                -1.278782e-02 3 1  ON 38
ci_0040                -1.269131e-02 3 1  ON 39
ci_0041                 1.376216e-02 3 1  ON 40
ci_0042                 1.376735e-02 3 1  ON 41
ci_0043                -1.306807e-02 3 1  ON 42
ci_0044                -1.322376e-02 3 1  ON 43
ci_0045                 1.340797e-02 3 1  ON 44
ci_0046                 1.330770e-02 3 1  ON 45
ci_0047                -1.181385e-02 3 1  ON 46
ci_0048                -1.182060e-02 3 1  ON 47
ci_0049                -1.063599e-02 3 1  ON 48
ci_0050                -1.056176e-02 3 1  ON 49
ci_0051                -1.042165e-02 3 1  ON 50
ci_0052                -1.036549e-02 3 1  ON 51
ci_0053                -1.052657e-02 3 1  ON 52
ci_0054                -1.042950e-02 3 1  ON 53
ci_0055                 1.011230e-02 3 1  ON 54
ci_0056                 1.011848e-02 3 1  ON 55
ci_0057                 9.989356e-03 3 1  ON 56
ci_0058                 1.026840e-02 3 1  ON 57
ci_0059                -1.024986e-02 3 1  ON 58
ci_0060                -1.017001e-02 3 1  ON 59
ci_0061                -1.017305e-02 3 1  ON 60
ci_0062                -1.023156e-02 3 1  ON 61
ci_0063                -1.109193e-02 3 1  ON 62
ci_0064                -1.101690e-02 3 1  ON 63
ci_0065                -1.025192e-02 3 1  ON 64
ci_0066                -1.035516e-02 3 1  ON 65
ci_0067                -9.694612e-03 3 1  ON 66
ci_0068                -9.745163e-03 3 1  ON 67
ci_0069                 9.176681e-03 3 1  ON 68
ci_0070                 9.119530e-03 3 1  ON 69
ci_0071                 9.405840e-03 3 1  ON 70
ci_0072                 9.388914e-03 3 1  ON 71
ci_0073                 8.736623e-03 3 1  ON 72
ci_0074                 8.882713e-03 3 1  ON 73
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 4.1709e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s006 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s006 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=6  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6878e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 6
    time step          = 0.05
    reference energy   = -16.7626
    reference variance = 0.245419
====================================================
  Execution time = 1.4554e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s006
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5211e+04
  VMC Eavg = -1.6898e+01
  VMC Evar = 3.6640e-01
  Total weights = 1.951018700e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 2.7145e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.351049630505
                                         uncertainty =       0.003117421797

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.351049630505
                                         uncertainty =       0.003117421797

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000418939204
  error estimate for blocks of size 2^( 2) =       0.000433239823
  error estimate for blocks of size 2^( 3) =       0.000447805976
  error estimate for blocks of size 2^( 4) =       0.000460834707
  error estimate for blocks of size 2^( 5) =       0.000470809098
  error estimate for blocks of size 2^( 6) =       0.000479291706
  error estimate for blocks of size 2^( 7) =       0.000484828275

      target function =      -0.825396835009
              le_mean =     -16.897667453601
             les_mean =     285.897569159423
             stat err =       0.000473940946
             autocorr =       1.279812822583
   target nu stat err =       0.000473940946
   target dn stat err =       0.003951165712
      target stat err =       0.004325699825
              std dev =       0.592469503631
             le_variance =       0.351020112733


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.689766745360e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 74
Check correct_vf_var_size: 225, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 4.0000e+01, overlap shift 4.0000e+02 and omega -1.7527e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.825418555819       residual = 7.18e-01           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.825497827620       residual = 1.24e-01           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.825510833397       residual = 2.26e-02           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.825514504147       residual = 4.25e-03           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.825515286132       residual = 1.55e-03           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.825515655557       residual = 5.37e-04           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.825515758775       residual = 1.54e-04           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.825515793002       residual = 6.98e-05           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.825515809974       residual = 2.35e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.825515813821       residual = 5.63e-06           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.825515817517       residual = 1.68e-06           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.825515817789       residual = 2.99e-07           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.825515817793       residual = 6.27e-08           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.825515817817       residual = 1.52e-08           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.825515817698       residual = 6.31e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         14 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 4.0000e+01 is 2.993931e-05

solving harmonic davidson linear method for identity shift 1.6000e+02, overlap shift 1.6000e+03 and omega -1.7527e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.825418555819       residual = 7.18e-01           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.825438397637       residual = 1.24e-01           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.825441651749       residual = 2.26e-02           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.825442569736       residual = 4.24e-03           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.825442765263       residual = 1.55e-03           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.825442857565       residual = 5.36e-04           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.825442883340       residual = 1.53e-04           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.825442891887       residual = 6.96e-05           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.825442896128       residual = 2.34e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.825442897088       residual = 5.61e-06           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.825442898010       residual = 1.67e-06           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.825442898077       residual = 2.97e-07           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.825442898078       residual = 6.22e-08           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.825442898084       residual = 1.50e-08           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.825442898055       residual = 6.23e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         14 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 1.6000e+02 is 7.494507e-06

solving harmonic davidson linear method for identity shift 6.4000e+02, overlap shift 6.4000e+03 and omega -1.7527e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.825418555819       residual = 7.18e-01           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.825423517767       residual = 1.24e-01           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.825424331462       residual = 2.26e-02           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.825424560977       residual = 4.24e-03           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.825424609861       residual = 1.55e-03           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.825424632934       residual = 5.36e-04           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.825424639375       residual = 1.53e-04           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.825424641511       residual = 6.95e-05           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.825424642572       residual = 2.34e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.825424642812       residual = 5.60e-06           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.825424643042       residual = 1.67e-06           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.825424643059       residual = 2.97e-07           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.825424643059       residual = 6.21e-08           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.825424643061       residual = 1.50e-08           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.825424643054       residual = 6.21e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         14 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 6.4000e+02 is 1.874232e-06

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.210943 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 75 and numParams is: 74

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.7290e+01
  </log>
  <optVariables href="H2O.s006.opt.xml">
ci_0001                 6.947456e-01 3 1  ON 0
ci_0002                 6.948834e-01 3 1  ON 1
ci_0003                -4.553234e-02 3 1  ON 2
ci_0004                -4.564309e-02 3 1  ON 3
ci_0005                -4.308590e-02 3 1  ON 4
ci_0006                -4.332363e-02 3 1  ON 5
ci_0007                -3.098572e-02 3 1  ON 6
ci_0008                -3.110569e-02 3 1  ON 7
ci_0009                -2.965952e-02 3 1  ON 8
ci_0010                -2.969496e-02 3 1  ON 9
ci_0011                -2.497774e-02 3 1  ON 10
ci_0012                -2.494090e-02 3 1  ON 11
ci_0013                 2.463986e-02 3 1  ON 12
ci_0014                 2.452191e-02 3 1  ON 13
ci_0015                 2.450025e-02 3 1  ON 14
ci_0016                 2.446548e-02 3 1  ON 15
ci_0017                 2.248973e-02 3 1  ON 16
ci_0018                 2.251371e-02 3 1  ON 17
ci_0019                 1.874165e-02 3 1  ON 18
ci_0020                 1.881590e-02 3 1  ON 19
ci_0021                 1.895563e-02 3 1  ON 20
ci_0022                 1.873438e-02 3 1  ON 21
ci_0023                -1.762565e-02 3 1  ON 22
ci_0024                -1.752769e-02 3 1  ON 23
ci_0025                -1.569002e-02 3 1  ON 24
ci_0026                -1.570716e-02 3 1  ON 25
ci_0027                -1.705980e-02 3 1  ON 26
ci_0028                -1.701661e-02 3 1  ON 27
ci_0029                -1.575468e-02 3 1  ON 28
ci_0030                -1.568097e-02 3 1  ON 29
ci_0031                 1.634719e-02 3 1  ON 30
ci_0032                 1.624513e-02 3 1  ON 31
ci_0033                 1.468866e-02 3 1  ON 32
ci_0034                 1.493631e-02 3 1  ON 33
ci_0035                 1.351016e-02 3 1  ON 34
ci_0036                 1.375468e-02 3 1  ON 35
ci_0037                -1.435795e-02 3 1  ON 36
ci_0038                -1.435581e-02 3 1  ON 37
ci_0039                -1.278358e-02 3 1  ON 38
ci_0040                -1.268729e-02 3 1  ON 39
ci_0041                 1.376073e-02 3 1  ON 40
ci_0042                 1.376589e-02 3 1  ON 41
ci_0043                -1.306571e-02 3 1  ON 42
ci_0044                -1.322193e-02 3 1  ON 43
ci_0045                 1.340648e-02 3 1  ON 44
ci_0046                 1.330671e-02 3 1  ON 45
ci_0047                -1.181016e-02 3 1  ON 46
ci_0048                -1.181695e-02 3 1  ON 47
ci_0049                -1.063239e-02 3 1  ON 48
ci_0050                -1.055816e-02 3 1  ON 49
ci_0051                -1.041743e-02 3 1  ON 50
ci_0052                -1.036132e-02 3 1  ON 51
ci_0053                -1.052300e-02 3 1  ON 52
ci_0054                -1.042638e-02 3 1  ON 53
ci_0055                 1.010830e-02 3 1  ON 54
ci_0056                 1.011458e-02 3 1  ON 55
ci_0057                 9.986048e-03 3 1  ON 56
ci_0058                 1.026483e-02 3 1  ON 57
ci_0059                -1.024721e-02 3 1  ON 58
ci_0060                -1.016705e-02 3 1  ON 59
ci_0061                -1.017030e-02 3 1  ON 60
ci_0062                -1.022847e-02 3 1  ON 61
ci_0063                -1.109128e-02 3 1  ON 62
ci_0064                -1.101688e-02 3 1  ON 63
ci_0065                -1.025057e-02 3 1  ON 64
ci_0066                -1.035347e-02 3 1  ON 65
ci_0067                -9.691865e-03 3 1  ON 66
ci_0068                -9.742584e-03 3 1  ON 67
ci_0069                 9.173790e-03 3 1  ON 68
ci_0070                 9.117226e-03 3 1  ON 69
ci_0071                 9.403276e-03 3 1  ON 70
ci_0072                 9.386858e-03 3 1  ON 71
ci_0073                 8.734280e-03 3 1  ON 72
ci_0074                 8.880300e-03 3 1  ON 73
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 6
    time step          = 0.05
    reference energy   = -16.8594
    reference variance = 0.255733
====================================================
  Execution time = 1.4758e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s006
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6898e+01
  VMC Evar = 3.5964e-01
  Total weights = 1.9508e+06
  Execution time = 1.9323e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.346168736939
                                         uncertainty =       0.002151404230

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.346168736939
                                         uncertainty =       0.002151404230

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000415980755
  error estimate for blocks of size 2^( 2) =       0.000429724738
  error estimate for blocks of size 2^( 3) =       0.000443573619
  error estimate for blocks of size 2^( 4) =       0.000455349690
  error estimate for blocks of size 2^( 5) =       0.000466325835
  error estimate for blocks of size 2^( 6) =       0.000473578013
  error estimate for blocks of size 2^( 7) =       0.000479743150

      target function =      -0.832725653140
              le_mean =     -16.898062267521
             les_mean =     285.904240188536
             stat err =       0.000468749172
             autocorr =       1.269797741932
   target nu stat err =       0.000468749172
   target dn stat err =       0.002699187608
      target stat err =       0.003042394316
              std dev =       0.588285625344
             le_variance =       0.346079976986

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.345997164001
                                         uncertainty =       0.002149610399

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.345997164001
                                         uncertainty =       0.002149610399

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000415877711
  error estimate for blocks of size 2^( 2) =       0.000429619025
  error estimate for blocks of size 2^( 3) =       0.000443467000
  error estimate for blocks of size 2^( 4) =       0.000455244361
  error estimate for blocks of size 2^( 5) =       0.000466221129
  error estimate for blocks of size 2^( 6) =       0.000473474489
  error estimate for blocks of size 2^( 7) =       0.000479641367

      target function =      -0.833080734661
              le_mean =     -16.898062765543
             les_mean =     285.903935535172
             stat err =       0.000468645337
             autocorr =       1.269864285985
   target nu stat err =       0.000468645337
   target dn stat err =       0.002676723456
      target stat err =       0.003020626812
              std dev =       0.588139899658
             le_variance =       0.345908541569

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.346082774164
                                         uncertainty =       0.002150504712

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.346082774164
                                         uncertainty =       0.002150504712

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000415929130
  error estimate for blocks of size 2^( 2) =       0.000429671776
  error estimate for blocks of size 2^( 3) =       0.000443520205
  error estimate for blocks of size 2^( 4) =       0.000455296920
  error estimate for blocks of size 2^( 5) =       0.000466273377
  error estimate for blocks of size 2^( 6) =       0.000473526149
  error estimate for blocks of size 2^( 7) =       0.000479692154

      target function =      -0.832912416183
              le_mean =     -16.898062509380
             les_mean =     285.904079243745
             stat err =       0.000468697150
             autocorr =       1.269831068977
   target nu stat err =       0.000468697150
   target dn stat err =       0.002686176263
      target stat err =       0.003029657870
              std dev =       0.588212617258
             le_variance =       0.345994083101

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.346157980363
                                         uncertainty =       0.002151291591

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.346157980363
                                         uncertainty =       0.002151291591

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000415974295
  error estimate for blocks of size 2^( 2) =       0.000429718111
  error estimate for blocks of size 2^( 3) =       0.000443566936
  error estimate for blocks of size 2^( 4) =       0.000455343087
  error estimate for blocks of size 2^( 5) =       0.000466319271
  error estimate for blocks of size 2^( 6) =       0.000473571524
  error estimate for blocks of size 2^( 7) =       0.000479736769

      target function =      -0.832750162856
              le_mean =     -16.898062296943
             les_mean =     285.904218985486
             stat err =       0.000468742663
             autocorr =       1.269801910312
   target nu stat err =       0.000468742663
   target dn stat err =       0.002697311540
      target stat err =       0.003040541440
              std dev =       0.588276490291
             le_variance =       0.346069229029


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.832725653140        initial
     4.0000e+01     4.0000e+02             2.9939e-05        -0.833080734661  <--
     1.6000e+02     1.6000e+03             7.4945e-06        -0.832912416183
     6.4000e+02     6.4000e+03             1.8742e-06        -0.832750162856

*****************************************************************************
Applying the update for shift_i =   4.0000e+01     and shift_s =   4.0000e+02
*****************************************************************************

  Execution time = 2.4464e+01
  </log>
  <optVariables href="H2O.s006.opt.xml">
ci_0001                 6.947545e-01 3 1  ON 0
ci_0002                 6.948922e-01 3 1  ON 1
ci_0003                -4.551646e-02 3 1  ON 2
ci_0004                -4.562696e-02 3 1  ON 3
ci_0005                -4.307016e-02 3 1  ON 4
ci_0006                -4.330891e-02 3 1  ON 5
ci_0007                -3.097040e-02 3 1  ON 6
ci_0008                -3.109239e-02 3 1  ON 7
ci_0009                -2.964686e-02 3 1  ON 8
ci_0010                -2.968176e-02 3 1  ON 9
ci_0011                -2.496614e-02 3 1  ON 10
ci_0012                -2.492972e-02 3 1  ON 11
ci_0013                 2.462834e-02 3 1  ON 12
ci_0014                 2.450924e-02 3 1  ON 13
ci_0015                 2.448889e-02 3 1  ON 14
ci_0016                 2.445522e-02 3 1  ON 15
ci_0017                 2.247952e-02 3 1  ON 16
ci_0018                 2.250235e-02 3 1  ON 17
ci_0019                 1.873270e-02 3 1  ON 18
ci_0020                 1.880878e-02 3 1  ON 19
ci_0021                 1.895355e-02 3 1  ON 20
ci_0022                 1.873079e-02 3 1  ON 21
ci_0023                -1.761707e-02 3 1  ON 22
ci_0024                -1.751885e-02 3 1  ON 23
ci_0025                -1.567065e-02 3 1  ON 24
ci_0026                -1.568471e-02 3 1  ON 25
ci_0027                -1.705138e-02 3 1  ON 26
ci_0028                -1.700885e-02 3 1  ON 27
ci_0029                -1.574865e-02 3 1  ON 28
ci_0030                -1.567297e-02 3 1  ON 29
ci_0031                 1.634401e-02 3 1  ON 30
ci_0032                 1.624185e-02 3 1  ON 31
ci_0033                 1.468542e-02 3 1  ON 32
ci_0034                 1.492933e-02 3 1  ON 33
ci_0035                 1.349803e-02 3 1  ON 34
ci_0036                 1.374019e-02 3 1  ON 35
ci_0037                -1.435419e-02 3 1  ON 36
ci_0038                -1.435334e-02 3 1  ON 37
ci_0039                -1.277088e-02 3 1  ON 38
ci_0040                -1.267527e-02 3 1  ON 39
ci_0041                 1.375645e-02 3 1  ON 40
ci_0042                 1.376154e-02 3 1  ON 41
ci_0043                -1.305866e-02 3 1  ON 42
ci_0044                -1.321645e-02 3 1  ON 43
ci_0045                 1.340201e-02 3 1  ON 44
ci_0046                 1.330377e-02 3 1  ON 45
ci_0047                -1.179908e-02 3 1  ON 46
ci_0048                -1.180601e-02 3 1  ON 47
ci_0049                -1.062162e-02 3 1  ON 48
ci_0050                -1.054740e-02 3 1  ON 49
ci_0051                -1.040477e-02 3 1  ON 50
ci_0052                -1.034886e-02 3 1  ON 51
ci_0053                -1.051231e-02 3 1  ON 52
ci_0054                -1.041704e-02 3 1  ON 53
ci_0055                 1.009633e-02 3 1  ON 54
ci_0056                 1.010289e-02 3 1  ON 55
ci_0057                 9.976141e-03 3 1  ON 56
ci_0058                 1.025414e-02 3 1  ON 57
ci_0059                -1.023928e-02 3 1  ON 58
ci_0060                -1.015820e-02 3 1  ON 59
ci_0061                -1.016204e-02 3 1  ON 60
ci_0062                -1.021923e-02 3 1  ON 61
ci_0063                -1.108933e-02 3 1  ON 62
ci_0064                -1.101682e-02 3 1  ON 63
ci_0065                -1.024656e-02 3 1  ON 64
ci_0066                -1.034844e-02 3 1  ON 65
ci_0067                -9.683639e-03 3 1  ON 66
ci_0068                -9.734862e-03 3 1  ON 67
ci_0069                 9.165130e-03 3 1  ON 68
ci_0070                 9.110325e-03 3 1  ON 69
ci_0071                 9.395597e-03 3 1  ON 70
ci_0072                 9.380702e-03 3 1  ON 71
ci_0073                 8.727261e-03 3 1  ON 72
ci_0074                 8.873072e-03 3 1  ON 73
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 4.1769e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s007 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s007 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=7  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6868e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 7
    time step          = 0.05
    reference energy   = -16.9584
    reference variance = 0.254722
====================================================
  Execution time = 1.4703e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s007
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5238e+04
  VMC Eavg = -1.6897e+01
  VMC Evar = 3.7402e-01
  Total weights = 1.950723494e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 2.6244e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.355222996962
                                         uncertainty =       0.003284344317

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.355222996962
                                         uncertainty =       0.003284344317

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000421440250
  error estimate for blocks of size 2^( 2) =       0.000435571305
  error estimate for blocks of size 2^( 3) =       0.000449835607
  error estimate for blocks of size 2^( 4) =       0.000462389303
  error estimate for blocks of size 2^( 5) =       0.000472665908
  error estimate for blocks of size 2^( 6) =       0.000482178595
  error estimate for blocks of size 2^( 7) =       0.000488704510

      target function =      -0.817217455915
              le_mean =     -16.897497985303
             les_mean =     285.899453862741
             stat err =       0.000476484579
             autocorr =       1.278279067800
   target nu stat err =       0.000476484579
   target dn stat err =       0.004667771807
      target stat err =       0.004994608034
              std dev =       0.596006517492
             le_variance =       0.355223768893


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.689749798530e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 74
Check correct_vf_var_size: 225, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.0000e+01, overlap shift 1.0000e+02 and omega -1.7527e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.817246929126       residual = 7.05e-01           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.817542170181       residual = 1.30e-01           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.817596918527       residual = 2.37e-02           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.817610865020       residual = 5.27e-03           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.817614530804       residual = 1.93e-03           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.817615949146       residual = 1.13e-03           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.817616667852       residual = 3.74e-04           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.817616887447       residual = 1.40e-04           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.817616974235       residual = 6.20e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.817617035806       residual = 3.05e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.817617076107       residual = 2.62e-05           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.817617123981       residual = 1.52e-05           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.817617139200       residual = 1.65e-05           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.817617148671       residual = 9.39e-06           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.817617162497       residual = 4.24e-06           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.817617172135       residual = 8.53e-07           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.817617171748       residual = 1.51e-07           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.817617171025       residual = 4.74e-08           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.817617170065       residual = 1.40e-08           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.817617169815       residual = 5.05e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         19 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 1.0000e+01 is 1.134671e-04

solving harmonic davidson linear method for identity shift 4.0000e+01, overlap shift 4.0000e+02 and omega -1.7527e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.817246929126       residual = 7.05e-01           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.817321093596       residual = 1.29e-01           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.817334825243       residual = 2.36e-02           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.817338316555       residual = 5.25e-03           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.817339233677       residual = 1.92e-03           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.817339587570       residual = 1.13e-03           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.817339766692       residual = 3.71e-04           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.817339821337       residual = 1.38e-04           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.817339842888       residual = 6.13e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.817339858210       residual = 3.01e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.817339868230       residual = 2.59e-05           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.817339880134       residual = 1.51e-05           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.817339883895       residual = 1.63e-05           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.817339886239       residual = 9.17e-06           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.817339889655       residual = 4.11e-06           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.817339892023       residual = 8.23e-07           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.817339891924       residual = 1.46e-07           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.817339891745       residual = 4.58e-08           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.817339891507       residual = 1.36e-08           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.817339891446       residual = 4.85e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         19 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 4.0000e+01 is 2.850943e-05

solving harmonic davidson linear method for identity shift 1.6000e+02, overlap shift 1.6000e+03 and omega -1.7527e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.817246929126       residual = 7.05e-01           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.817265492505       residual = 1.29e-01           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.817268928207       residual = 2.36e-02           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.817269801326       residual = 5.24e-03           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.817270030647       residual = 1.92e-03           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.817270119077       residual = 1.12e-03           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.817270163822       residual = 3.70e-04           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.817270177467       residual = 1.38e-04           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.817270182846       residual = 6.11e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.817270186672       residual = 3.00e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.817270189174       residual = 2.58e-05           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.817270192146       residual = 1.50e-05           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.817270193083       residual = 1.62e-05           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.817270193668       residual = 9.11e-06           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.817270194519       residual = 4.08e-06           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.817270195109       residual = 8.15e-07           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.817270195084       residual = 1.44e-07           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.817270195039       residual = 4.54e-08           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.817270194980       residual = 1.34e-08           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.817270194964       residual = 4.80e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         19 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 1.6000e+02 is 7.136325e-06

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.229679 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 75 and numParams is: 74

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.7354e+01
  </log>
  <optVariables href="H2O.s007.opt.xml">
ci_0001                 6.947768e-01 3 1  ON 0
ci_0002                 6.948933e-01 3 1  ON 1
ci_0003                -4.549454e-02 3 1  ON 2
ci_0004                -4.560805e-02 3 1  ON 3
ci_0005                -4.305056e-02 3 1  ON 4
ci_0006                -4.328725e-02 3 1  ON 5
ci_0007                -3.094616e-02 3 1  ON 6
ci_0008                -3.107681e-02 3 1  ON 7
ci_0009                -2.962908e-02 3 1  ON 8
ci_0010                -2.966578e-02 3 1  ON 9
ci_0011                -2.494949e-02 3 1  ON 10
ci_0012                -2.491177e-02 3 1  ON 11
ci_0013                 2.461342e-02 3 1  ON 12
ci_0014                 2.449330e-02 3 1  ON 13
ci_0015                 2.447610e-02 3 1  ON 14
ci_0016                 2.443903e-02 3 1  ON 15
ci_0017                 2.246496e-02 3 1  ON 16
ci_0018                 2.248919e-02 3 1  ON 17
ci_0019                 1.872172e-02 3 1  ON 18
ci_0020                 1.879744e-02 3 1  ON 19
ci_0021                 1.894953e-02 3 1  ON 20
ci_0022                 1.872814e-02 3 1  ON 21
ci_0023                -1.760680e-02 3 1  ON 22
ci_0024                -1.750909e-02 3 1  ON 23
ci_0025                -1.564214e-02 3 1  ON 24
ci_0026                -1.565898e-02 3 1  ON 25
ci_0027                -1.704301e-02 3 1  ON 26
ci_0028                -1.699782e-02 3 1  ON 27
ci_0029                -1.573680e-02 3 1  ON 28
ci_0030                -1.566141e-02 3 1  ON 29
ci_0031                 1.634270e-02 3 1  ON 30
ci_0032                 1.623780e-02 3 1  ON 31
ci_0033                 1.467709e-02 3 1  ON 32
ci_0034                 1.491868e-02 3 1  ON 33
ci_0035                 1.348031e-02 3 1  ON 34
ci_0036                 1.372496e-02 3 1  ON 35
ci_0037                -1.435035e-02 3 1  ON 36
ci_0038                -1.434792e-02 3 1  ON 37
ci_0039                -1.275431e-02 3 1  ON 38
ci_0040                -1.265995e-02 3 1  ON 39
ci_0041                 1.375040e-02 3 1  ON 40
ci_0042                 1.375400e-02 3 1  ON 41
ci_0043                -1.305001e-02 3 1  ON 42
ci_0044                -1.321024e-02 3 1  ON 43
ci_0045                 1.339738e-02 3 1  ON 44
ci_0046                 1.329801e-02 3 1  ON 45
ci_0047                -1.178504e-02 3 1  ON 46
ci_0048                -1.179182e-02 3 1  ON 47
ci_0049                -1.060564e-02 3 1  ON 48
ci_0050                -1.053328e-02 3 1  ON 49
ci_0051                -1.038846e-02 3 1  ON 50
ci_0052                -1.033288e-02 3 1  ON 51
ci_0053                -1.049932e-02 3 1  ON 52
ci_0054                -1.040550e-02 3 1  ON 53
ci_0055                 1.008300e-02 3 1  ON 54
ci_0056                 1.008931e-02 3 1  ON 55
ci_0057                 9.960755e-03 3 1  ON 56
ci_0058                 1.024307e-02 3 1  ON 57
ci_0059                -1.022754e-02 3 1  ON 58
ci_0060                -1.014717e-02 3 1  ON 59
ci_0061                -1.014972e-02 3 1  ON 60
ci_0062                -1.020817e-02 3 1  ON 61
ci_0063                -1.108827e-02 3 1  ON 62
ci_0064                -1.101443e-02 3 1  ON 63
ci_0065                -1.024244e-02 3 1  ON 64
ci_0066                -1.034196e-02 3 1  ON 65
ci_0067                -9.672983e-03 3 1  ON 66
ci_0068                -9.723648e-03 3 1  ON 67
ci_0069                 9.155617e-03 3 1  ON 68
ci_0070                 9.098912e-03 3 1  ON 69
ci_0071                 9.387904e-03 3 1  ON 70
ci_0072                 9.373176e-03 3 1  ON 71
ci_0073                 8.718237e-03 3 1  ON 72
ci_0074                 8.862183e-03 3 1  ON 73
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 7
    time step          = 0.05
    reference energy   = -16.8778
    reference variance = 0.340585
====================================================
  Execution time = 1.4374e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s007
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6899e+01
  VMC Evar = 3.6654e-01
  Total weights = 1.9510e+06
  Execution time = 1.9145e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.349079698147
                                         uncertainty =       0.002253273749

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.349079698147
                                         uncertainty =       0.002253273749

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000417742554
  error estimate for blocks of size 2^( 2) =       0.000432237367
  error estimate for blocks of size 2^( 3) =       0.000445837378
  error estimate for blocks of size 2^( 4) =       0.000458610806
  error estimate for blocks of size 2^( 5) =       0.000469845086
  error estimate for blocks of size 2^( 6) =       0.000476454824
  error estimate for blocks of size 2^( 7) =       0.000480159205

      target function =      -0.825064074300
              le_mean =     -16.898621457528
             les_mean =     285.930159121131
             stat err =       0.000471267480
             autocorr =       1.272674990378
   target nu stat err =       0.000471267480
   target dn stat err =       0.004144078265
      target stat err =       0.004535421704
              std dev =       0.590777185539
             le_variance =       0.349017682953

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.348395680675
                                         uncertainty =       0.002246927318

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.348395680675
                                         uncertainty =       0.002246927318

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000417333007
  error estimate for blocks of size 2^( 2) =       0.000431819332
  error estimate for blocks of size 2^( 3) =       0.000445416923
  error estimate for blocks of size 2^( 4) =       0.000458194761
  error estimate for blocks of size 2^( 5) =       0.000469431314
  error estimate for blocks of size 2^( 6) =       0.000476042521
  error estimate for blocks of size 2^( 7) =       0.000479761002

      target function =      -0.825807571226
              le_mean =     -16.898620723076
             les_mean =     285.929449852853
             stat err =       0.000470857399
             autocorr =       1.272955817014
   target nu stat err =       0.000470857399
   target dn stat err =       0.004071199188
      target stat err =       0.004465035146
              std dev =       0.590197998672
             le_variance =       0.348333677637

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.348734819877
                                         uncertainty =       0.002250067987

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.348734819877
                                         uncertainty =       0.002250067987

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000417536113
  error estimate for blocks of size 2^( 2) =       0.000432026636
  error estimate for blocks of size 2^( 3) =       0.000445625420
  error estimate for blocks of size 2^( 4) =       0.000458401077
  error estimate for blocks of size 2^( 5) =       0.000469636503
  error estimate for blocks of size 2^( 6) =       0.000476246909
  error estimate for blocks of size 2^( 7) =       0.000479958476

      target function =      -0.825500619533
              le_mean =     -16.898620972013
             les_mean =     285.929740657568
             stat err =       0.000471060741
             autocorr =       1.272816317888
   target nu stat err =       0.000471060741
   target dn stat err =       0.004104247646
      target stat err =       0.004497313234
              std dev =       0.590485233649
             le_variance =       0.348672811157

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.349036399695
                                         uncertainty =       0.002252870881

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.349036399695
                                         uncertainty =       0.002252870881

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000417716642
  error estimate for blocks of size 2^( 2) =       0.000432210914
  error estimate for blocks of size 2^( 3) =       0.000445810770
  error estimate for blocks of size 2^( 4) =       0.000458584479
  error estimate for blocks of size 2^( 5) =       0.000469818903
  error estimate for blocks of size 2^( 6) =       0.000476428721
  error estimate for blocks of size 2^( 7) =       0.000480134013

      target function =      -0.825124959117
              le_mean =     -16.898621382312
             les_mean =     285.930100476460
             stat err =       0.000471241529
             autocorr =       1.272692714034
   target nu stat err =       0.000471241529
   target dn stat err =       0.004138764037
      target stat err =       0.004530370915
              std dev =       0.590740539795
             le_variance =       0.348974385357


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.825064074300        initial
     1.0000e+01     1.0000e+02             1.1347e-04        -0.825807571226  <--
     4.0000e+01     4.0000e+02             2.8509e-05        -0.825500619533
     1.6000e+02     1.6000e+03             7.1363e-06        -0.825124959117

*****************************************************************************
Applying the update for shift_i =   1.0000e+01     and shift_s =   1.0000e+02
*****************************************************************************

  Execution time = 2.4025e+01
  </log>
  <optVariables href="H2O.s007.opt.xml">
ci_0001                 6.948437e-01 3 1  ON 0
ci_0002                 6.948964e-01 3 1  ON 1
ci_0003                -4.542913e-02 3 1  ON 2
ci_0004                -4.555159e-02 3 1  ON 3
ci_0005                -4.299200e-02 3 1  ON 4
ci_0006                -4.322253e-02 3 1  ON 5
ci_0007                -3.087368e-02 3 1  ON 6
ci_0008                -3.103018e-02 3 1  ON 7
ci_0009                -2.957605e-02 3 1  ON 8
ci_0010                -2.961810e-02 3 1  ON 9
ci_0011                -2.489982e-02 3 1  ON 10
ci_0012                -2.485820e-02 3 1  ON 11
ci_0013                 2.456891e-02 3 1  ON 12
ci_0014                 2.444575e-02 3 1  ON 13
ci_0015                 2.443795e-02 3 1  ON 14
ci_0016                 2.439072e-02 3 1  ON 15
ci_0017                 2.242156e-02 3 1  ON 16
ci_0018                 2.244993e-02 3 1  ON 17
ci_0019                 1.868896e-02 3 1  ON 18
ci_0020                 1.876362e-02 3 1  ON 19
ci_0021                 1.893749e-02 3 1  ON 20
ci_0022                 1.872025e-02 3 1  ON 21
ci_0023                -1.757618e-02 3 1  ON 22
ci_0024                -1.747999e-02 3 1  ON 23
ci_0025                -1.555718e-02 3 1  ON 24
ci_0026                -1.558228e-02 3 1  ON 25
ci_0027                -1.701807e-02 3 1  ON 26
ci_0028                -1.696492e-02 3 1  ON 27
ci_0029                -1.570146e-02 3 1  ON 28
ci_0030                -1.562694e-02 3 1  ON 29
ci_0031                 1.633879e-02 3 1  ON 30
ci_0032                 1.622571e-02 3 1  ON 31
ci_0033                 1.465219e-02 3 1  ON 32
ci_0034                 1.488686e-02 3 1  ON 33
ci_0035                 1.342753e-02 3 1  ON 34
ci_0036                 1.367958e-02 3 1  ON 35
ci_0037                -1.433890e-02 3 1  ON 36
ci_0038                -1.433174e-02 3 1  ON 37
ci_0039                -1.270491e-02 3 1  ON 38
ci_0040                -1.261427e-02 3 1  ON 39
ci_0041                 1.373233e-02 3 1  ON 40
ci_0042                 1.373149e-02 3 1  ON 41
ci_0043                -1.302417e-02 3 1  ON 42
ci_0044                -1.319168e-02 3 1  ON 43
ci_0045                 1.338356e-02 3 1  ON 44
ci_0046                 1.328081e-02 3 1  ON 45
ci_0047                -1.174320e-02 3 1  ON 46
ci_0048                -1.174950e-02 3 1  ON 47
ci_0049                -1.055805e-02 3 1  ON 48
ci_0050                -1.049120e-02 3 1  ON 49
ci_0051                -1.033989e-02 3 1  ON 50
ci_0052                -1.028529e-02 3 1  ON 51
ci_0053                -1.046062e-02 3 1  ON 52
ci_0054                -1.037112e-02 3 1  ON 53
ci_0055                 1.004328e-02 3 1  ON 54
ci_0056                 1.004882e-02 3 1  ON 55
ci_0057                 9.914900e-03 3 1  ON 56
ci_0058                 1.021010e-02 3 1  ON 57
ci_0059                -1.019257e-02 3 1  ON 58
ci_0060                -1.011429e-02 3 1  ON 59
ci_0061                -1.011295e-02 3 1  ON 60
ci_0062                -1.017516e-02 3 1  ON 61
ci_0063                -1.108511e-02 3 1  ON 62
ci_0064                -1.100733e-02 3 1  ON 63
ci_0065                -1.023015e-02 3 1  ON 64
ci_0066                -1.032263e-02 3 1  ON 65
ci_0067                -9.641229e-03 3 1  ON 66
ci_0068                -9.690233e-03 3 1  ON 67
ci_0069                 9.127272e-03 3 1  ON 68
ci_0070                 9.064905e-03 3 1  ON 69
ci_0071                 9.364972e-03 3 1  ON 70
ci_0072                 9.350734e-03 3 1  ON 71
ci_0073                 8.691346e-03 3 1  ON 72
ci_0074                 8.829733e-03 3 1  ON 73
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 4.1395e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s008 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s008 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=8  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6874e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 8
    time step          = 0.05
    reference energy   = -16.8738
    reference variance = 0.215352
====================================================
  Execution time = 1.4695e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s008
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5271e+04
  VMC Eavg = -1.6898e+01
  VMC Evar = 3.6594e-01
  Total weights = 1.950894904e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 2.6247e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.348981563081
                                         uncertainty =       0.002540284765

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.348981563081
                                         uncertainty =       0.002540284765

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000417678777
  error estimate for blocks of size 2^( 2) =       0.000431650549
  error estimate for blocks of size 2^( 3) =       0.000445388847
  error estimate for blocks of size 2^( 4) =       0.000457304037
  error estimate for blocks of size 2^( 5) =       0.000467240003
  error estimate for blocks of size 2^( 6) =       0.000473935940
  error estimate for blocks of size 2^( 7) =       0.000475610606

      target function =      -0.825907131997
              le_mean =     -16.897690868496
             les_mean =     285.897896564570
             stat err =       0.000468522647
             autocorr =       1.258277291732
   target nu stat err =       0.000468522647
   target dn stat err =       0.003362675010
      target stat err =       0.003699314384
              std dev =       0.590686990868
             le_variance =       0.348911121180


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.689769086850e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 74
Check correct_vf_var_size: 225, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.5000e+00, overlap shift 2.5000e+01 and omega -1.7527e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.825922670365       residual = 6.72e-01           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.827082570376       residual = 1.18e-01           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.827284975370       residual = 2.07e-02           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.827334266857       residual = 4.33e-03           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.827347914831       residual = 1.60e-03           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.827353265512       residual = 1.04e-03           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.827355201642       residual = 2.66e-04           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.827356053127       residual = 6.59e-05           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.827356297089       residual = 2.10e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.827356282715       residual = 7.29e-06           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.827356361161       residual = 2.58e-06           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.827356370853       residual = 4.27e-07           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.827356360686       residual = 1.09e-07           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.827356360545       residual = 2.90e-08           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.827356359821       residual = 2.72e-08           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.827356360347       residual = 2.97e-08           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.827356360656       residual = 1.54e-08           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.827356359857       residual = 1.02e-08           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.827356358789       residual = 3.07e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         18 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 2.5000e+00 is 3.935215e-04

solving harmonic davidson linear method for identity shift 1.0000e+01, overlap shift 1.0000e+02 and omega -1.7527e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.825922670365       residual = 6.72e-01           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.826218201531       residual = 1.17e-01           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.826269472972       residual = 2.04e-02           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.826281864292       residual = 4.25e-03           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.826285286664       residual = 1.56e-03           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.826286617531       residual = 1.01e-03           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.826287093026       residual = 2.56e-04           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.826287301970       residual = 6.30e-05           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.826287361117       residual = 1.99e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.826287357276       residual = 6.85e-06           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.826287376502       residual = 2.39e-06           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.826287378705       residual = 3.92e-07           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.826287376222       residual = 1.00e-07           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.826287376194       residual = 2.76e-08           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.826287376013       residual = 2.67e-08           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.826287376150       residual = 2.80e-08           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.826287376212       residual = 1.43e-08           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.826287376009       residual = 9.17e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         17 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 1.0000e+01 is 1.003557e-04

solving harmonic davidson linear method for identity shift 4.0000e+01, overlap shift 4.0000e+02 and omega -1.7527e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.825922670365       residual = 6.72e-01           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.825996908177       residual = 1.16e-01           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.826009768296       residual = 2.04e-02           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.826012870268       residual = 4.23e-03           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.826013726459       residual = 1.56e-03           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.826014058713       residual = 1.00e-03           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.826014177036       residual = 2.53e-04           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.826014229020       residual = 6.23e-05           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.826014243690       residual = 1.96e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.826014242714       residual = 6.74e-06           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.826014247496       residual = 2.34e-06           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.826014248033       residual = 3.84e-07           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.826014247417       residual = 9.82e-08           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.826014247410       residual = 2.72e-08           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.826014247365       residual = 2.65e-08           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.826014247399       residual = 2.76e-08           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.826014247414       residual = 1.41e-08           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.826014247363       residual = 8.92e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         17 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 4.0000e+01 is 2.521626e-05

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.246130 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 75 and numParams is: 74

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.7344e+01
  </log>
  <optVariables href="H2O.s008.opt.xml">
ci_0001                 6.948914e-01 3 1  ON 0
ci_0002                 6.949397e-01 3 1  ON 1
ci_0003                -4.534650e-02 3 1  ON 2
ci_0004                -4.547001e-02 3 1  ON 3
ci_0005                -4.290907e-02 3 1  ON 4
ci_0006                -4.314640e-02 3 1  ON 5
ci_0007                -3.080536e-02 3 1  ON 6
ci_0008                -3.095434e-02 3 1  ON 7
ci_0009                -2.950462e-02 3 1  ON 8
ci_0010                -2.954706e-02 3 1  ON 9
ci_0011                -2.484059e-02 3 1  ON 10
ci_0012                -2.480564e-02 3 1  ON 11
ci_0013                 2.450739e-02 3 1  ON 12
ci_0014                 2.438632e-02 3 1  ON 13
ci_0015                 2.438878e-02 3 1  ON 14
ci_0016                 2.433265e-02 3 1  ON 15
ci_0017                 2.236925e-02 3 1  ON 16
ci_0018                 2.238953e-02 3 1  ON 17
ci_0019                 1.864606e-02 3 1  ON 18
ci_0020                 1.872295e-02 3 1  ON 19
ci_0021                 1.893924e-02 3 1  ON 20
ci_0022                 1.871383e-02 3 1  ON 21
ci_0023                -1.753095e-02 3 1  ON 22
ci_0024                -1.743629e-02 3 1  ON 23
ci_0025                -1.545683e-02 3 1  ON 24
ci_0026                -1.548202e-02 3 1  ON 25
ci_0027                -1.697304e-02 3 1  ON 26
ci_0028                -1.692413e-02 3 1  ON 27
ci_0029                -1.566219e-02 3 1  ON 28
ci_0030                -1.559314e-02 3 1  ON 29
ci_0031                 1.633020e-02 3 1  ON 30
ci_0032                 1.621094e-02 3 1  ON 31
ci_0033                 1.461920e-02 3 1  ON 32
ci_0034                 1.486185e-02 3 1  ON 33
ci_0035                 1.337401e-02 3 1  ON 34
ci_0036                 1.361673e-02 3 1  ON 35
ci_0037                -1.431789e-02 3 1  ON 36
ci_0038                -1.431078e-02 3 1  ON 37
ci_0039                -1.263977e-02 3 1  ON 38
ci_0040                -1.254616e-02 3 1  ON 39
ci_0041                 1.370960e-02 3 1  ON 40
ci_0042                 1.371021e-02 3 1  ON 41
ci_0043                -1.298358e-02 3 1  ON 42
ci_0044                -1.314402e-02 3 1  ON 43
ci_0045                 1.336507e-02 3 1  ON 44
ci_0046                 1.325939e-02 3 1  ON 45
ci_0047                -1.168331e-02 3 1  ON 46
ci_0048                -1.168820e-02 3 1  ON 47
ci_0049                -1.050415e-02 3 1  ON 48
ci_0050                -1.043159e-02 3 1  ON 49
ci_0051                -1.027113e-02 3 1  ON 50
ci_0052                -1.022010e-02 3 1  ON 51
ci_0053                -1.040776e-02 3 1  ON 52
ci_0054                -1.031791e-02 3 1  ON 53
ci_0055                 9.981177e-03 3 1  ON 54
ci_0056                 9.974447e-03 3 1  ON 55
ci_0057                 9.853459e-03 3 1  ON 56
ci_0058                 1.014966e-02 3 1  ON 57
ci_0059                -1.015522e-02 3 1  ON 58
ci_0060                -1.008142e-02 3 1  ON 59
ci_0061                -1.006455e-02 3 1  ON 60
ci_0062                -1.012990e-02 3 1  ON 61
ci_0063                -1.107485e-02 3 1  ON 62
ci_0064                -1.099948e-02 3 1  ON 63
ci_0065                -1.020505e-02 3 1  ON 64
ci_0066                -1.030251e-02 3 1  ON 65
ci_0067                -9.594609e-03 3 1  ON 66
ci_0068                -9.642113e-03 3 1  ON 67
ci_0069                 9.088546e-03 3 1  ON 68
ci_0070                 9.016514e-03 3 1  ON 69
ci_0071                 9.330318e-03 3 1  ON 70
ci_0072                 9.308611e-03 3 1  ON 71
ci_0073                 8.659233e-03 3 1  ON 72
ci_0074                 8.788701e-03 3 1  ON 73
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 8
    time step          = 0.05
    reference energy   = -16.9273
    reference variance = 0.207064
====================================================
  Execution time = 1.4560e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s008
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6898e+01
  VMC Evar = 3.6521e-01
  Total weights = 1.9509e+06
  Execution time = 1.9699e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.351854364210
                                         uncertainty =       0.002826183542

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.351854364210
                                         uncertainty =       0.002826183542

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000419425043
  error estimate for blocks of size 2^( 2) =       0.000434061443
  error estimate for blocks of size 2^( 3) =       0.000448248948
  error estimate for blocks of size 2^( 4) =       0.000461969923
  error estimate for blocks of size 2^( 5) =       0.000472555596
  error estimate for blocks of size 2^( 6) =       0.000482529554
  error estimate for blocks of size 2^( 7) =       0.000488900242

      target function =      -0.825971892304
              le_mean =     -16.897512932744
             les_mean =     285.891813012093
             stat err =       0.000476488829
             autocorr =       1.290615068756
   target nu stat err =       0.000476488829
   target dn stat err =       0.003609987368
      target stat err =       0.003965248526
              std dev =       0.593156583691
             le_variance =       0.351834732776

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.349345152357
                                         uncertainty =       0.002823313308

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.349345152357
                                         uncertainty =       0.002823313308

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000417927822
  error estimate for blocks of size 2^( 2) =       0.000432531423
  error estimate for blocks of size 2^( 3) =       0.000446707445
  error estimate for blocks of size 2^( 4) =       0.000460442469
  error estimate for blocks of size 2^( 5) =       0.000471042445
  error estimate for blocks of size 2^( 6) =       0.000481061393
  error estimate for blocks of size 2^( 7) =       0.000487454568

      target function =      -0.828122094416
              le_mean =     -16.897523295754
             les_mean =     285.890185817947
             stat err =       0.000475000219
             autocorr =       1.291769577831
   target nu stat err =       0.000475000219
   target dn stat err =       0.003672870363
      target stat err =       0.004053151865
              std dev =       0.591039193463
             le_variance =       0.349327328209

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.350557106602
                                         uncertainty =       0.002824470455

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.350557106602
                                         uncertainty =       0.002824470455

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000418651649
  error estimate for blocks of size 2^( 2) =       0.000433270993
  error estimate for blocks of size 2^( 3) =       0.000447452503
  error estimate for blocks of size 2^( 4) =       0.000461180321
  error estimate for blocks of size 2^( 5) =       0.000471773427
  error estimate for blocks of size 2^( 6) =       0.000481770811
  error estimate for blocks of size 2^( 7) =       0.000488153768

      target function =      -0.827328901936
              le_mean =     -16.897516442463
             les_mean =     285.890682561640
             stat err =       0.000475719582
             autocorr =       1.291208699501
   target nu stat err =       0.000475719582
   target dn stat err =       0.003623468652
      target stat err =       0.003992478619
              std dev =       0.592062840618
             le_variance =       0.350538407240

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.351689335471
                                         uncertainty =       0.002825939646

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.351689335471
                                         uncertainty =       0.002825939646

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000419326736
  error estimate for blocks of size 2^( 2) =       0.000433960947
  error estimate for blocks of size 2^( 3) =       0.000448147700
  error estimate for blocks of size 2^( 4) =       0.000461869545
  error estimate for blocks of size 2^( 5) =       0.000472456159
  error estimate for blocks of size 2^( 6) =       0.000482433124
  error estimate for blocks of size 2^( 7) =       0.000488805381

      target function =      -0.826178442134
              le_mean =     -16.897513156914
             les_mean =     285.891630204472
             stat err =       0.000476391052
             autocorr =       1.290690416275
   target nu stat err =       0.000476391052
   target dn stat err =       0.003610335653
      target stat err =       0.003967561691
              std dev =       0.593017556480
             le_variance =       0.351669822293


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.825971892304        initial
     2.5000e+00     2.5000e+01             3.9352e-04        -0.828122094416  <--
     1.0000e+01     1.0000e+02             1.0036e-04        -0.827328901936
     4.0000e+01     4.0000e+02             2.5216e-05        -0.826178442134

*****************************************************************************
Applying the update for shift_i =   2.5000e+00     and shift_s =   2.5000e+01
*****************************************************************************

  Execution time = 2.4543e+01
  </log>
  <optVariables href="H2O.s008.opt.xml">
ci_0001                 6.950320e-01 3 1  ON 0
ci_0002                 6.950667e-01 3 1  ON 1
ci_0003                -4.510371e-02 3 1  ON 2
ci_0004                -4.523024e-02 3 1  ON 3
ci_0005                -4.266430e-02 3 1  ON 4
ci_0006                -4.292171e-02 3 1  ON 5
ci_0007                -3.060295e-02 3 1  ON 6
ci_0008                -3.072971e-02 3 1  ON 7
ci_0009                -2.929524e-02 3 1  ON 8
ci_0010                -2.933880e-02 3 1  ON 9
ci_0011                -2.466687e-02 3 1  ON 10
ci_0012                -2.465149e-02 3 1  ON 11
ci_0013                 2.432696e-02 3 1  ON 12
ci_0014                 2.421197e-02 3 1  ON 13
ci_0015                 2.424455e-02 3 1  ON 14
ci_0016                 2.416226e-02 3 1  ON 15
ci_0017                 2.221593e-02 3 1  ON 16
ci_0018                 2.221245e-02 3 1  ON 17
ci_0019                 1.852046e-02 3 1  ON 18
ci_0020                 1.860384e-02 3 1  ON 19
ci_0021                 1.894414e-02 3 1  ON 20
ci_0022                 1.869440e-02 3 1  ON 21
ci_0023                -1.739846e-02 3 1  ON 22
ci_0024                -1.730828e-02 3 1  ON 23
ci_0025                -1.516366e-02 3 1  ON 24
ci_0026                -1.518918e-02 3 1  ON 25
ci_0027                -1.684108e-02 3 1  ON 26
ci_0028                -1.680470e-02 3 1  ON 27
ci_0029                -1.554719e-02 3 1  ON 28
ci_0030                -1.549434e-02 3 1  ON 29
ci_0031                 1.630478e-02 3 1  ON 30
ci_0032                 1.616738e-02 3 1  ON 31
ci_0033                 1.452177e-02 3 1  ON 32
ci_0034                 1.478790e-02 3 1  ON 33
ci_0035                 1.321774e-02 3 1  ON 34
ci_0036                 1.343320e-02 3 1  ON 35
ci_0037                -1.425609e-02 3 1  ON 36
ci_0038                -1.424906e-02 3 1  ON 37
ci_0039                -1.244935e-02 3 1  ON 38
ci_0040                -1.234702e-02 3 1  ON 39
ci_0041                 1.364275e-02 3 1  ON 40
ci_0042                 1.364769e-02 3 1  ON 41
ci_0043                -1.286374e-02 3 1  ON 42
ci_0044                -1.300317e-02 3 1  ON 43
ci_0045                 1.331063e-02 3 1  ON 44
ci_0046                 1.319637e-02 3 1  ON 45
ci_0047                -1.150815e-02 3 1  ON 46
ci_0048                -1.150888e-02 3 1  ON 47
ci_0049                -1.034673e-02 3 1  ON 48
ci_0050                -1.025763e-02 3 1  ON 49
ci_0051                -1.007070e-02 3 1  ON 50
ci_0052                -1.002999e-02 3 1  ON 51
ci_0053                -1.025332e-02 3 1  ON 52
ci_0054                -1.016253e-02 3 1  ON 53
ci_0055                 9.799779e-03 3 1  ON 54
ci_0056                 9.757344e-03 3 1  ON 55
ci_0057                 9.673936e-03 3 1  ON 56
ci_0058                 9.973088e-03 3 1  ON 57
ci_0059                -1.004612e-02 3 1  ON 58
ci_0060                -9.985490e-03 3 1  ON 59
ci_0061                -9.922544e-03 3 1  ON 60
ci_0062                -9.997046e-03 3 1  ON 61
ci_0063                -1.104486e-02 3 1  ON 62
ci_0064                -1.097655e-02 3 1  ON 63
ci_0065                -1.013142e-02 3 1  ON 64
ci_0066                -1.024342e-02 3 1  ON 65
ci_0067                -9.458475e-03 3 1  ON 66
ci_0068                -9.501572e-03 3 1  ON 67
ci_0069                 8.975514e-03 3 1  ON 68
ci_0070                 8.875247e-03 3 1  ON 69
ci_0071                 9.228945e-03 3 1  ON 70
ci_0072                 9.185516e-03 3 1  ON 71
ci_0073                 8.565469e-03 3 1  ON 72
ci_0074                 8.668941e-03 3 1  ON 73
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 4.1903e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s009 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s009 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=9  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6877e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 9
    time step          = 0.05
    reference energy   = -16.8335
    reference variance = 0.345351
====================================================
  Execution time = 1.4936e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s009
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5228e+04
  VMC Eavg = -1.6898e+01
  VMC Evar = 3.6399e-01
  Total weights = 1.950585597e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 2.6907e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.347403706507
                                         uncertainty =       0.002223130436

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.347403706507
                                         uncertainty =       0.002223130436

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000416757654
  error estimate for blocks of size 2^( 2) =       0.000430882771
  error estimate for blocks of size 2^( 3) =       0.000445033487
  error estimate for blocks of size 2^( 4) =       0.000458061034
  error estimate for blocks of size 2^( 5) =       0.000469655409
  error estimate for blocks of size 2^( 6) =       0.000478828921
  error estimate for blocks of size 2^( 7) =       0.000484655518

      target function =      -0.828066178533
              le_mean =     -16.898305762929
             les_mean =     285.916725854669
             stat err =       0.000472800220
             autocorr =       1.287028519193
   target nu stat err =       0.000472800220
   target dn stat err =       0.002989224604
      target stat err =       0.003321799950
              std dev =       0.589384326971
             le_variance =       0.347373884879


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.689830576293e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 74
Check correct_vf_var_size: 225, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 6.2500e-01, overlap shift 6.2500e+00 and omega -1.7527e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.828078433323       residual = 7.08e-01           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.832269812665       residual = 1.40e-01           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.833107220538       residual = 2.58e-02           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.833317331980       residual = 6.70e-03           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.833373467108       residual = 3.01e-03           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.833398473658       residual = 1.26e-03           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.833414914730       residual = 3.62e-04           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.833419367857       residual = 8.36e-05           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.833420687627       residual = 2.67e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.833421165731       residual = 8.18e-06           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.833421246855       residual = 3.00e-06           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.833421284790       residual = 5.24e-07           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.833421298607       residual = 1.31e-07           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.833421320943       residual = 2.34e-08           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.833421333547       residual = 7.60e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         14 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 6.2500e-01 is 1.423654e-03

solving harmonic davidson linear method for identity shift 2.5000e+00, overlap shift 2.5000e+01 and omega -1.7527e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.828078433323       residual = 7.08e-01           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.829206943678       residual = 1.37e-01           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.829427818881       residual = 2.47e-02           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.829481905211       residual = 6.25e-03           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.829496125938       residual = 2.79e-03           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.829502364279       residual = 1.14e-03           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.829506327311       residual = 3.16e-04           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.829507374069       residual = 7.09e-05           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.829507676146       residual = 2.18e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.829507782780       residual = 6.59e-06           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.829507798044       residual = 2.29e-06           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.829507806399       residual = 3.84e-07           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.829507809383       residual = 9.24e-08           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.829507814388       residual = 1.62e-08           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.829507817169       residual = 5.19e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         14 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 2.5000e+00 is 3.842892e-04

solving harmonic davidson linear method for identity shift 1.0000e+01, overlap shift 1.0000e+02 and omega -1.7527e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.828078433323       residual = 7.08e-01           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.828366064692       residual = 1.36e-01           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.828422034261       residual = 2.44e-02           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.828435647534       residual = 6.13e-03           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.828439211245       residual = 2.73e-03           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.828440767871       residual = 1.11e-03           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.828441747580       residual = 3.05e-04           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.828442004574       residual = 6.77e-05           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.828442078208       residual = 2.06e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.828442104011       residual = 6.21e-06           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.828442107514       residual = 2.12e-06           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.828442109534       residual = 3.52e-07           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.828442110250       residual = 8.39e-08           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.828442111464       residual = 1.46e-08           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.828442112135       residual = 4.67e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         14 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 1.0000e+01 is 9.801245e-05

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.258245 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 75 and numParams is: 74

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.7647e+01
  </log>
  <optVariables href="H2O.s009.opt.xml">
ci_0001                 6.952091e-01 3 1  ON 0
ci_0002                 6.952414e-01 3 1  ON 1
ci_0003                -4.473858e-02 3 1  ON 2
ci_0004                -4.489889e-02 3 1  ON 3
ci_0005                -4.229772e-02 3 1  ON 4
ci_0006                -4.260846e-02 3 1  ON 5
ci_0007                -3.033571e-02 3 1  ON 6
ci_0008                -3.045975e-02 3 1  ON 7
ci_0009                -2.901874e-02 3 1  ON 8
ci_0010                -2.907270e-02 3 1  ON 9
ci_0011                -2.443033e-02 3 1  ON 10
ci_0012                -2.442579e-02 3 1  ON 11
ci_0013                 2.412467e-02 3 1  ON 12
ci_0014                 2.398156e-02 3 1  ON 13
ci_0015                 2.401431e-02 3 1  ON 14
ci_0016                 2.394361e-02 3 1  ON 15
ci_0017                 2.203071e-02 3 1  ON 16
ci_0018                 2.198173e-02 3 1  ON 17
ci_0019                 1.835811e-02 3 1  ON 18
ci_0020                 1.841126e-02 3 1  ON 19
ci_0021                 1.892642e-02 3 1  ON 20
ci_0022                 1.869066e-02 3 1  ON 21
ci_0023                -1.725333e-02 3 1  ON 22
ci_0024                -1.713744e-02 3 1  ON 23
ci_0025                -1.478183e-02 3 1  ON 24
ci_0026                -1.480489e-02 3 1  ON 25
ci_0027                -1.669630e-02 3 1  ON 26
ci_0028                -1.666029e-02 3 1  ON 27
ci_0029                -1.536979e-02 3 1  ON 28
ci_0030                -1.534650e-02 3 1  ON 29
ci_0031                 1.625122e-02 3 1  ON 30
ci_0032                 1.612875e-02 3 1  ON 31
ci_0033                 1.440008e-02 3 1  ON 32
ci_0034                 1.465877e-02 3 1  ON 33
ci_0035                 1.293627e-02 3 1  ON 34
ci_0036                 1.317897e-02 3 1  ON 35
ci_0037                -1.419831e-02 3 1  ON 36
ci_0038                -1.418219e-02 3 1  ON 37
ci_0039                -1.219001e-02 3 1  ON 38
ci_0040                -1.210428e-02 3 1  ON 39
ci_0041                 1.357337e-02 3 1  ON 40
ci_0042                 1.356493e-02 3 1  ON 41
ci_0043                -1.274296e-02 3 1  ON 42
ci_0044                -1.290515e-02 3 1  ON 43
ci_0045                 1.322672e-02 3 1  ON 44
ci_0046                 1.311171e-02 3 1  ON 45
ci_0047                -1.128029e-02 3 1  ON 46
ci_0048                -1.125909e-02 3 1  ON 47
ci_0049                -1.015421e-02 3 1  ON 48
ci_0050                -1.001418e-02 3 1  ON 49
ci_0051                -9.789651e-03 3 1  ON 50
ci_0052                -9.765389e-03 3 1  ON 51
ci_0053                -1.009628e-02 3 1  ON 52
ci_0054                -9.970851e-03 3 1  ON 53
ci_0055                 9.552992e-03 3 1  ON 54
ci_0056                 9.560043e-03 3 1  ON 55
ci_0057                 9.480111e-03 3 1  ON 56
ci_0058                 9.740068e-03 3 1  ON 57
ci_0059                -9.871752e-03 3 1  ON 58
ci_0060                -9.802330e-03 3 1  ON 59
ci_0061                -9.765818e-03 3 1  ON 60
ci_0062                -9.832134e-03 3 1  ON 61
ci_0063                -1.098958e-02 3 1  ON 62
ci_0064                -1.093473e-02 3 1  ON 63
ci_0065                -1.005989e-02 3 1  ON 64
ci_0066                -1.017248e-02 3 1  ON 65
ci_0067                -9.284224e-03 3 1  ON 66
ci_0068                -9.310560e-03 3 1  ON 67
ci_0069                 8.829967e-03 3 1  ON 68
ci_0070                 8.715978e-03 3 1  ON 69
ci_0071                 9.097495e-03 3 1  ON 70
ci_0072                 9.056914e-03 3 1  ON 71
ci_0073                 8.421473e-03 3 1  ON 72
ci_0074                 8.504724e-03 3 1  ON 73
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 9
    time step          = 0.05
    reference energy   = -16.9211
    reference variance = 0.332704
====================================================
  Execution time = 1.4329e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s009
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6899e+01
  VMC Evar = 3.6860e-01
  Total weights = 1.9513e+06
  Execution time = 1.9465e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.350003306472
                                         uncertainty =       0.003905669325

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.350003306472
                                         uncertainty =       0.003905669325

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000418262316
  error estimate for blocks of size 2^( 2) =       0.000432562700
  error estimate for blocks of size 2^( 3) =       0.000446196094
  error estimate for blocks of size 2^( 4) =       0.000458487831
  error estimate for blocks of size 2^( 5) =       0.000468977346
  error estimate for blocks of size 2^( 6) =       0.000476343845
  error estimate for blocks of size 2^( 7) =       0.000481584777

      target function =      -0.820585972073
              le_mean =     -16.898760741167
             les_mean =     285.938996704107
             stat err =       0.000471348450
             autocorr =       1.269950199773
   target nu stat err =       0.000471348450
   target dn stat err =       0.006203037491
      target stat err =       0.006682617310
              std dev =       0.591512239678
             le_variance =       0.349886729688

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.341358238356
                                         uncertainty =       0.003769287941

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.341358238356
                                         uncertainty =       0.003769287941

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000413066572
  error estimate for blocks of size 2^( 2) =       0.000427275355
  error estimate for blocks of size 2^( 3) =       0.000440867922
  error estimate for blocks of size 2^( 4) =       0.000453188214
  error estimate for blocks of size 2^( 5) =       0.000463690297
  error estimate for blocks of size 2^( 6) =       0.000471042921
  error estimate for blocks of size 2^( 7) =       0.000476276344

      target function =      -0.814167218147
              le_mean =     -16.898821937586
             les_mean =     285.946921178975
             stat err =       0.000466049444
             autocorr =       1.272986759104
   target nu stat err =       0.000466049444
   target dn stat err =       0.013236383608
      target stat err =       0.013995354184
              std dev =       0.584164348957
             le_variance =       0.341247986593

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.348706733295
                                         uncertainty =       0.005256655891

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.348706733295
                                         uncertainty =       0.005256655891

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000417478640
  error estimate for blocks of size 2^( 2) =       0.000431678309
  error estimate for blocks of size 2^( 3) =       0.000445246644
  error estimate for blocks of size 2^( 4) =       0.000457553017
  error estimate for blocks of size 2^( 5) =       0.000468084640
  error estimate for blocks of size 2^( 6) =       0.000475572445
  error estimate for blocks of size 2^( 7) =       0.000480856213

      target function =      -0.078694689734
              le_mean =     -16.898721926209
             les_mean =     289.863270842601
             stat err =       0.000470516579
             autocorr =       1.270227000820
   target nu stat err =       0.000470516579
   target dn stat err =       3.928474446905
      target stat err =       0.065908603816
              std dev =       0.590403955120
             le_variance =       0.348576830222

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.349339555359
                                         uncertainty =       0.003893467544

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.349339555359
                                         uncertainty =       0.003893467544

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000417865689
  error estimate for blocks of size 2^( 2) =       0.000432158719
  error estimate for blocks of size 2^( 3) =       0.000445789247
  error estimate for blocks of size 2^( 4) =       0.000458085926
  error estimate for blocks of size 2^( 5) =       0.000468579526
  error estimate for blocks of size 2^( 6) =       0.000475946288
  error estimate for blocks of size 2^( 7) =       0.000481192044

      target function =      -0.805693642961
              le_mean =     -16.898756827185
             les_mean =     285.952712478033
             stat err =       0.000470950946
             autocorr =       1.270217000483
   target nu stat err =       0.000470950946
   target dn stat err =       0.016338942162
      target stat err =       0.016913797809
              std dev =       0.590951324966
             le_variance =       0.349223468479


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.820585972073        initial  <--
     6.2500e-01     6.2500e+00             1.4237e-03        -0.814167218147
     2.5000e+00     2.5000e+01             3.8429e-04        -0.078694689734
     1.0000e+01     1.0000e+02             9.8012e-05        -0.805693642961

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 24.1693
  </log>
  <optVariables href="H2O.s009.opt.xml">
ci_0001                 6.950320e-01 3 1  ON 0
ci_0002                 6.950667e-01 3 1  ON 1
ci_0003                -4.510371e-02 3 1  ON 2
ci_0004                -4.523024e-02 3 1  ON 3
ci_0005                -4.266430e-02 3 1  ON 4
ci_0006                -4.292171e-02 3 1  ON 5
ci_0007                -3.060295e-02 3 1  ON 6
ci_0008                -3.072971e-02 3 1  ON 7
ci_0009                -2.929524e-02 3 1  ON 8
ci_0010                -2.933880e-02 3 1  ON 9
ci_0011                -2.466687e-02 3 1  ON 10
ci_0012                -2.465149e-02 3 1  ON 11
ci_0013                 2.432696e-02 3 1  ON 12
ci_0014                 2.421197e-02 3 1  ON 13
ci_0015                 2.424455e-02 3 1  ON 14
ci_0016                 2.416226e-02 3 1  ON 15
ci_0017                 2.221593e-02 3 1  ON 16
ci_0018                 2.221245e-02 3 1  ON 17
ci_0019                 1.852046e-02 3 1  ON 18
ci_0020                 1.860384e-02 3 1  ON 19
ci_0021                 1.894414e-02 3 1  ON 20
ci_0022                 1.869440e-02 3 1  ON 21
ci_0023                -1.739846e-02 3 1  ON 22
ci_0024                -1.730828e-02 3 1  ON 23
ci_0025                -1.516366e-02 3 1  ON 24
ci_0026                -1.518918e-02 3 1  ON 25
ci_0027                -1.684108e-02 3 1  ON 26
ci_0028                -1.680470e-02 3 1  ON 27
ci_0029                -1.554719e-02 3 1  ON 28
ci_0030                -1.549434e-02 3 1  ON 29
ci_0031                 1.630478e-02 3 1  ON 30
ci_0032                 1.616738e-02 3 1  ON 31
ci_0033                 1.452177e-02 3 1  ON 32
ci_0034                 1.478790e-02 3 1  ON 33
ci_0035                 1.321774e-02 3 1  ON 34
ci_0036                 1.343320e-02 3 1  ON 35
ci_0037                -1.425609e-02 3 1  ON 36
ci_0038                -1.424906e-02 3 1  ON 37
ci_0039                -1.244935e-02 3 1  ON 38
ci_0040                -1.234702e-02 3 1  ON 39
ci_0041                 1.364275e-02 3 1  ON 40
ci_0042                 1.364769e-02 3 1  ON 41
ci_0043                -1.286374e-02 3 1  ON 42
ci_0044                -1.300317e-02 3 1  ON 43
ci_0045                 1.331063e-02 3 1  ON 44
ci_0046                 1.319637e-02 3 1  ON 45
ci_0047                -1.150815e-02 3 1  ON 46
ci_0048                -1.150888e-02 3 1  ON 47
ci_0049                -1.034673e-02 3 1  ON 48
ci_0050                -1.025763e-02 3 1  ON 49
ci_0051                -1.007070e-02 3 1  ON 50
ci_0052                -1.002999e-02 3 1  ON 51
ci_0053                -1.025332e-02 3 1  ON 52
ci_0054                -1.016253e-02 3 1  ON 53
ci_0055                 9.799779e-03 3 1  ON 54
ci_0056                 9.757344e-03 3 1  ON 55
ci_0057                 9.673936e-03 3 1  ON 56
ci_0058                 9.973088e-03 3 1  ON 57
ci_0059                -1.004612e-02 3 1  ON 58
ci_0060                -9.985490e-03 3 1  ON 59
ci_0061                -9.922544e-03 3 1  ON 60
ci_0062                -9.997046e-03 3 1  ON 61
ci_0063                -1.104486e-02 3 1  ON 62
ci_0064                -1.097655e-02 3 1  ON 63
ci_0065                -1.013142e-02 3 1  ON 64
ci_0066                -1.024342e-02 3 1  ON 65
ci_0067                -9.458475e-03 3 1  ON 66
ci_0068                -9.501572e-03 3 1  ON 67
ci_0069                 8.975514e-03 3 1  ON 68
ci_0070                 8.875247e-03 3 1  ON 69
ci_0071                 9.228945e-03 3 1  ON 70
ci_0072                 9.185516e-03 3 1  ON 71
ci_0073                 8.565469e-03 3 1  ON 72
ci_0074                 8.668941e-03 3 1  ON 73
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 4.1827e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s010 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s010 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=10  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6877e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 10
    time step          = 0.05
    reference energy   = -16.9163
    reference variance = 0.429761
====================================================
  Execution time = 1.6831e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s010
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5234e+04
  VMC Eavg = -1.6898e+01
  VMC Evar = 3.5659e-01
  Total weights = 1.951135950e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 2.6997e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.342274796871
                                         uncertainty =       0.002081782240

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.342274796871
                                         uncertainty =       0.002081782240

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000413725149
  error estimate for blocks of size 2^( 2) =       0.000427899377
  error estimate for blocks of size 2^( 3) =       0.000441860180
  error estimate for blocks of size 2^( 4) =       0.000455097857
  error estimate for blocks of size 2^( 5) =       0.000466730605
  error estimate for blocks of size 2^( 6) =       0.000476372683
  error estimate for blocks of size 2^( 7) =       0.000483260329

      target function =      -0.836215727461
              le_mean =     -16.898165830664
             les_mean =     285.904598003286
             stat err =       0.000470365368
             autocorr =       1.292548457844
   target nu stat err =       0.000470365368
   target dn stat err =       0.002514374196
      target stat err =       0.002867316659
              std dev =       0.585095717404
             le_variance =       0.342336998524


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.689816583066e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 74
Check correct_vf_var_size: 225, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 6.2500e+00, overlap shift 6.2500e+01 and omega -1.7527e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.836224431514       residual = 6.46e-01           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.836670008861       residual = 1.11e-01           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.836744799323       residual = 2.20e-02           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.836766949024       residual = 3.84e-03           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.836771256167       residual = 1.50e-03           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.836773213188       residual = 9.37e-04           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.836774045059       residual = 2.88e-04           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.836774301228       residual = 7.20e-05           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.836774322430       residual = 2.84e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.836774326434       residual = 1.36e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.836774355241       residual = 1.07e-05           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.836774375421       residual = 7.22e-06           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.836774390121       residual = 7.66e-06           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.836774396325       residual = 3.57e-06           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.836774398089       residual = 1.01e-06           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.836774403694       residual = 8.41e-08           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.836774405056       residual = 2.54e-08           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.836774405608       residual = 8.15e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         17 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 6.2500e+00 is 1.554339e-04

solving harmonic davidson linear method for identity shift 2.5000e+01, overlap shift 2.5000e+02 and omega -1.7527e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.836224431514       residual = 6.46e-01           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.836336700714       residual = 1.10e-01           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.836355501557       residual = 2.19e-02           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.836361053239       residual = 3.81e-03           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.836362130785       residual = 1.49e-03           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.836362619065       residual = 9.25e-04           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.836362825999       residual = 2.83e-04           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.836362889362       residual = 7.07e-05           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.836362894458       residual = 2.79e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.836362895408       residual = 1.34e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.836362902594       residual = 1.06e-05           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.836362907616       residual = 7.12e-06           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.836362911241       residual = 7.47e-06           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.836362912737       residual = 3.43e-06           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.836362913159       residual = 9.58e-07           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.836362914528       residual = 7.95e-08           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.836362914860       residual = 2.41e-08           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.836362914995       residual = 7.68e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         17 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 2.5000e+01 is 3.918076e-05

solving harmonic davidson linear method for identity shift 1.0000e+02, overlap shift 1.0000e+03 and omega -1.7527e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.836224431514       residual = 6.46e-01           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.836252553996       residual = 1.10e-01           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.836257260685       residual = 2.19e-02           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.836258649488       residual = 3.81e-03           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.836258918919       residual = 1.48e-03           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.836259040926       residual = 9.22e-04           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.836259092594       residual = 2.82e-04           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.836259108392       residual = 7.04e-05           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.836259109653       residual = 2.78e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.836259109887       residual = 1.34e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.836259111683       residual = 1.05e-05           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.836259112937       residual = 7.10e-06           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.836259113840       residual = 7.43e-06           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.836259114210       residual = 3.39e-06           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.836259114315       residual = 9.45e-07           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.836259114655       residual = 7.84e-08           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.836259114738       residual = 2.38e-08           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.836259114771       residual = 7.57e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         17 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 1.0000e+02 is 9.815527e-06

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.268370 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 75 and numParams is: 74

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.9547e+01
  </log>
  <optVariables href="H2O.s010.opt.xml">
ci_0001                 6.950377e-01 3 1  ON 0
ci_0002                 6.950966e-01 3 1  ON 1
ci_0003                -4.506762e-02 3 1  ON 2
ci_0004                -4.519583e-02 3 1  ON 3
ci_0005                -4.263112e-02 3 1  ON 4
ci_0006                -4.289173e-02 3 1  ON 5
ci_0007                -3.057763e-02 3 1  ON 6
ci_0008                -3.069927e-02 3 1  ON 7
ci_0009                -2.926506e-02 3 1  ON 8
ci_0010                -2.931427e-02 3 1  ON 9
ci_0011                -2.464174e-02 3 1  ON 10
ci_0012                -2.462958e-02 3 1  ON 11
ci_0013                 2.430220e-02 3 1  ON 12
ci_0014                 2.418955e-02 3 1  ON 13
ci_0015                 2.422265e-02 3 1  ON 14
ci_0016                 2.414243e-02 3 1  ON 15
ci_0017                 2.218964e-02 3 1  ON 16
ci_0018                 2.218851e-02 3 1  ON 17
ci_0019                 1.850447e-02 3 1  ON 18
ci_0020                 1.858545e-02 3 1  ON 19
ci_0021                 1.894232e-02 3 1  ON 20
ci_0022                 1.868656e-02 3 1  ON 21
ci_0023                -1.738199e-02 3 1  ON 22
ci_0024                -1.729136e-02 3 1  ON 23
ci_0025                -1.512448e-02 3 1  ON 24
ci_0026                -1.515373e-02 3 1  ON 25
ci_0027                -1.682560e-02 3 1  ON 26
ci_0028                -1.678936e-02 3 1  ON 27
ci_0029                -1.553303e-02 3 1  ON 28
ci_0030                -1.548022e-02 3 1  ON 29
ci_0031                 1.630081e-02 3 1  ON 30
ci_0032                 1.615988e-02 3 1  ON 31
ci_0033                 1.451088e-02 3 1  ON 32
ci_0034                 1.477802e-02 3 1  ON 33
ci_0035                 1.319471e-02 3 1  ON 34
ci_0036                 1.341063e-02 3 1  ON 35
ci_0037                -1.424848e-02 3 1  ON 36
ci_0038                -1.424262e-02 3 1  ON 37
ci_0039                -1.242326e-02 3 1  ON 38
ci_0040                -1.232152e-02 3 1  ON 39
ci_0041                 1.363194e-02 3 1  ON 40
ci_0042                 1.363725e-02 3 1  ON 41
ci_0043                -1.285102e-02 3 1  ON 42
ci_0044                -1.299298e-02 3 1  ON 43
ci_0045                 1.330320e-02 3 1  ON 44
ci_0046                 1.318929e-02 3 1  ON 45
ci_0047                -1.148447e-02 3 1  ON 46
ci_0048                -1.148639e-02 3 1  ON 47
ci_0049                -1.032451e-02 3 1  ON 48
ci_0050                -1.023325e-02 3 1  ON 49
ci_0051                -1.004416e-02 3 1  ON 50
ci_0052                -1.000396e-02 3 1  ON 51
ci_0053                -1.023606e-02 3 1  ON 52
ci_0054                -1.014318e-02 3 1  ON 53
ci_0055                 9.776278e-03 3 1  ON 54
ci_0056                 9.734554e-03 3 1  ON 55
ci_0057                 9.653296e-03 3 1  ON 56
ci_0058                 9.952345e-03 3 1  ON 57
ci_0059                -1.002610e-02 3 1  ON 58
ci_0060                -9.965880e-03 3 1  ON 59
ci_0061                -9.906207e-03 3 1  ON 60
ci_0062                -9.980788e-03 3 1  ON 61
ci_0063                -1.104128e-02 3 1  ON 62
ci_0064                -1.097116e-02 3 1  ON 63
ci_0065                -1.012387e-02 3 1  ON 64
ci_0066                -1.023673e-02 3 1  ON 65
ci_0067                -9.439703e-03 3 1  ON 66
ci_0068                -9.483670e-03 3 1  ON 67
ci_0069                 8.959885e-03 3 1  ON 68
ci_0070                 8.859541e-03 3 1  ON 69
ci_0071                 9.213261e-03 3 1  ON 70
ci_0072                 9.170017e-03 3 1  ON 71
ci_0073                 8.550432e-03 3 1  ON 72
ci_0074                 8.653493e-03 3 1  ON 73
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 10
    time step          = 0.05
    reference energy   = -16.8542
    reference variance = 1.12123
====================================================
  Execution time = 1.4573e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s010
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6899e+01
  VMC Evar = 3.6521e-01
  Total weights = 1.9508e+06
  Execution time = 1.9526e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.349763787520
                                         uncertainty =       0.003060227160

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.349763787520
                                         uncertainty =       0.003060227160

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000418234499
  error estimate for blocks of size 2^( 2) =       0.000432482519
  error estimate for blocks of size 2^( 3) =       0.000446169508
  error estimate for blocks of size 2^( 4) =       0.000458159723
  error estimate for blocks of size 2^( 5) =       0.000469641099
  error estimate for blocks of size 2^( 6) =       0.000477879068
  error estimate for blocks of size 2^( 7) =       0.000481950078

      target function =      -0.824206896462
              le_mean =     -16.898515792105
             les_mean =     285.927372974101
             stat err =       0.000471907492
             autocorr =       1.273133767037
   target nu stat err =       0.000471907492
   target dn stat err =       0.004350596067
      target stat err =       0.004746852681
              std dev =       0.591472900753
             le_variance =       0.349840192325

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.348767167927
                                         uncertainty =       0.003057740903

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.348767167927
                                         uncertainty =       0.003057740903

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000417638486
  error estimate for blocks of size 2^( 2) =       0.000431871304
  error estimate for blocks of size 2^( 3) =       0.000445549188
  error estimate for blocks of size 2^( 4) =       0.000457538542
  error estimate for blocks of size 2^( 5) =       0.000469030200
  error estimate for blocks of size 2^( 6) =       0.000477280173
  error estimate for blocks of size 2^( 7) =       0.000481352800

      target function =      -0.826875663861
              le_mean =     -16.898518915017
             les_mean =     285.925022935293
             stat err =       0.000471300429
             autocorr =       1.273487375372
   target nu stat err =       0.000471300429
   target dn stat err =       0.004030331661
      target stat err =       0.004431770922
              std dev =       0.590630011618
             le_variance =       0.348843810624

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.349258568636
                                         uncertainty =       0.003058883989

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.349258568636
                                         uncertainty =       0.003058883989

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000417932466
  error estimate for blocks of size 2^( 2) =       0.000432172805
  error estimate for blocks of size 2^( 3) =       0.000445855177
  error estimate for blocks of size 2^( 4) =       0.000457844956
  error estimate for blocks of size 2^( 5) =       0.000469331606
  error estimate for blocks of size 2^( 6) =       0.000477575629
  error estimate for blocks of size 2^( 7) =       0.000481647269

      target function =      -0.827026987339
              le_mean =     -16.898517099456
             les_mean =     285.924822815522
             stat err =       0.000471599865
             autocorr =       1.273312858429
   target nu stat err =       0.000471599865
   target dn stat err =       0.004002556133
      target stat err =       0.004403466205
              std dev =       0.591045761830
             le_variance =       0.349335092577

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.349700170576
                                         uncertainty =       0.003060048600

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.349700170576
                                         uncertainty =       0.003060048600

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000418196479
  error estimate for blocks of size 2^( 2) =       0.000432443621
  error estimate for blocks of size 2^( 3) =       0.000446129978
  error estimate for blocks of size 2^( 4) =       0.000458120060
  error estimate for blocks of size 2^( 5) =       0.000469601988
  error estimate for blocks of size 2^( 6) =       0.000477840722
  error estimate for blocks of size 2^( 7) =       0.000481911703

      target function =      -0.826102750810
              le_mean =     -16.898516036617
             les_mean =     285.925636281577
             stat err =       0.000471868618
             autocorr =       1.273155489941
   target nu stat err =       0.000471868618
   target dn stat err =       0.004014896593
      target stat err =       0.004407047090
              std dev =       0.591419132300
             le_variance =       0.349776590051


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.824206896462        initial
     6.2500e+00     6.2500e+01             1.5543e-04        -0.826875663861
     2.5000e+01     2.5000e+02             3.9181e-05        -0.827026987339  <--
     1.0000e+02     1.0000e+03             9.8155e-06        -0.826102750810

*****************************************************************************
Applying the update for shift_i =   2.5000e+01     and shift_s =   2.5000e+02
*****************************************************************************

  Execution time = 2.4508e+01
  </log>
  <optVariables href="H2O.s010.opt.xml">
ci_0001                 6.950377e-01 3 1  ON 0
ci_0002                 6.950966e-01 3 1  ON 1
ci_0003                -4.506762e-02 3 1  ON 2
ci_0004                -4.519583e-02 3 1  ON 3
ci_0005                -4.263112e-02 3 1  ON 4
ci_0006                -4.289173e-02 3 1  ON 5
ci_0007                -3.057763e-02 3 1  ON 6
ci_0008                -3.069927e-02 3 1  ON 7
ci_0009                -2.926506e-02 3 1  ON 8
ci_0010                -2.931427e-02 3 1  ON 9
ci_0011                -2.464174e-02 3 1  ON 10
ci_0012                -2.462958e-02 3 1  ON 11
ci_0013                 2.430220e-02 3 1  ON 12
ci_0014                 2.418955e-02 3 1  ON 13
ci_0015                 2.422265e-02 3 1  ON 14
ci_0016                 2.414243e-02 3 1  ON 15
ci_0017                 2.218964e-02 3 1  ON 16
ci_0018                 2.218851e-02 3 1  ON 17
ci_0019                 1.850447e-02 3 1  ON 18
ci_0020                 1.858545e-02 3 1  ON 19
ci_0021                 1.894232e-02 3 1  ON 20
ci_0022                 1.868656e-02 3 1  ON 21
ci_0023                -1.738199e-02 3 1  ON 22
ci_0024                -1.729136e-02 3 1  ON 23
ci_0025                -1.512448e-02 3 1  ON 24
ci_0026                -1.515373e-02 3 1  ON 25
ci_0027                -1.682560e-02 3 1  ON 26
ci_0028                -1.678936e-02 3 1  ON 27
ci_0029                -1.553303e-02 3 1  ON 28
ci_0030                -1.548022e-02 3 1  ON 29
ci_0031                 1.630081e-02 3 1  ON 30
ci_0032                 1.615988e-02 3 1  ON 31
ci_0033                 1.451088e-02 3 1  ON 32
ci_0034                 1.477802e-02 3 1  ON 33
ci_0035                 1.319471e-02 3 1  ON 34
ci_0036                 1.341063e-02 3 1  ON 35
ci_0037                -1.424848e-02 3 1  ON 36
ci_0038                -1.424262e-02 3 1  ON 37
ci_0039                -1.242326e-02 3 1  ON 38
ci_0040                -1.232152e-02 3 1  ON 39
ci_0041                 1.363194e-02 3 1  ON 40
ci_0042                 1.363725e-02 3 1  ON 41
ci_0043                -1.285102e-02 3 1  ON 42
ci_0044                -1.299298e-02 3 1  ON 43
ci_0045                 1.330320e-02 3 1  ON 44
ci_0046                 1.318929e-02 3 1  ON 45
ci_0047                -1.148447e-02 3 1  ON 46
ci_0048                -1.148639e-02 3 1  ON 47
ci_0049                -1.032451e-02 3 1  ON 48
ci_0050                -1.023325e-02 3 1  ON 49
ci_0051                -1.004416e-02 3 1  ON 50
ci_0052                -1.000396e-02 3 1  ON 51
ci_0053                -1.023606e-02 3 1  ON 52
ci_0054                -1.014318e-02 3 1  ON 53
ci_0055                 9.776278e-03 3 1  ON 54
ci_0056                 9.734554e-03 3 1  ON 55
ci_0057                 9.653296e-03 3 1  ON 56
ci_0058                 9.952345e-03 3 1  ON 57
ci_0059                -1.002610e-02 3 1  ON 58
ci_0060                -9.965880e-03 3 1  ON 59
ci_0061                -9.906207e-03 3 1  ON 60
ci_0062                -9.980788e-03 3 1  ON 61
ci_0063                -1.104128e-02 3 1  ON 62
ci_0064                -1.097116e-02 3 1  ON 63
ci_0065                -1.012387e-02 3 1  ON 64
ci_0066                -1.023673e-02 3 1  ON 65
ci_0067                -9.439703e-03 3 1  ON 66
ci_0068                -9.483670e-03 3 1  ON 67
ci_0069                 8.959885e-03 3 1  ON 68
ci_0070                 8.859541e-03 3 1  ON 69
ci_0071                 9.213261e-03 3 1  ON 70
ci_0072                 9.170017e-03 3 1  ON 71
ci_0073                 8.550432e-03 3 1  ON 72
ci_0074                 8.653493e-03 3 1  ON 73
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 4.4060e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s011 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s011 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=11  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6878e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 11
    time step          = 0.05
    reference energy   = -16.9486
    reference variance = 0.295491
====================================================
  Execution time = 1.4981e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s011
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5234e+04
  VMC Eavg = -1.6898e+01
  VMC Evar = 3.6030e-01
  Total weights = 1.950957656e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 2.6939e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.345784857477
                                         uncertainty =       0.002284941580

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.345784857477
                                         uncertainty =       0.002284941580

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000415766767
  error estimate for blocks of size 2^( 2) =       0.000430587654
  error estimate for blocks of size 2^( 3) =       0.000445499971
  error estimate for blocks of size 2^( 4) =       0.000459370173
  error estimate for blocks of size 2^( 5) =       0.000470986121
  error estimate for blocks of size 2^( 6) =       0.000483861275
  error estimate for blocks of size 2^( 7) =       0.000493106721

      target function =      -0.832102277508
              le_mean =     -16.898190300927
             les_mean =     285.909135183653
             stat err =       0.000476831072
             autocorr =       1.315314330176
   target nu stat err =       0.000476831072
   target dn stat err =       0.003261429333
      target stat err =       0.003649124506
              std dev =       0.587983000316
             le_variance =       0.345724008661


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.689819030093e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 74
Check correct_vf_var_size: 225, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 6.2500e+00, overlap shift 6.2500e+01 and omega -1.7527e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.832117240328       residual = 6.48e-01           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.832550462379       residual = 1.29e-01           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.832634483980       residual = 2.20e-02           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.832654904573       residual = 5.30e-03           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.832659857730       residual = 2.53e-03           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.832662236868       residual = 1.13e-03           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.832663462818       residual = 3.41e-04           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.832663763829       residual = 1.06e-04           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.832663913461       residual = 3.59e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.832663973669       residual = 1.42e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.832664026959       residual = 8.37e-06           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.832664038421       residual = 4.64e-06           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.832664048728       residual = 5.68e-06           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.832664074208       residual = 3.76e-06           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.832664085868       residual = 1.52e-06           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.832664088229       residual = 2.79e-07           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.832664088344       residual = 5.75e-08           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.832664089504       residual = 2.30e-08           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.832664089359       residual = 5.59e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         18 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 6.2500e+00 is 1.609919e-04

solving harmonic davidson linear method for identity shift 2.5000e+01, overlap shift 2.5000e+02 and omega -1.7527e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.832117240328       residual = 6.48e-01           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.832226399991       residual = 1.29e-01           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.832247520564       residual = 2.19e-02           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.832252639862       residual = 5.26e-03           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.832253879550       residual = 2.51e-03           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.832254473662       residual = 1.12e-03           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.832254778588       residual = 3.36e-04           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.832254853214       residual = 1.04e-04           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.832254890282       residual = 3.52e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.832254905188       residual = 1.39e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.832254918451       residual = 8.20e-06           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.832254921279       residual = 4.55e-06           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.832254923831       residual = 5.58e-06           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.832254930140       residual = 3.64e-06           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.832254932979       residual = 1.45e-06           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.832254933538       residual = 2.63e-07           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.832254933563       residual = 5.46e-08           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.832254933848       residual = 2.18e-08           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.832254933812       residual = 5.25e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         18 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 2.5000e+01 is 4.057687e-05

solving harmonic davidson linear method for identity shift 1.0000e+02, overlap shift 1.0000e+03 and omega -1.7527e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.832117240328       residual = 6.48e-01           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.832144584123       residual = 1.29e-01           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.832149871493       residual = 2.19e-02           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.832151152195       residual = 5.25e-03           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.832151462202       residual = 2.50e-03           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.832151610685       residual = 1.11e-03           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.832151686817       residual = 3.35e-04           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.832151705434       residual = 1.04e-04           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.832151714680       residual = 3.50e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.832151718397       residual = 1.38e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.832151721709       residual = 8.15e-06           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.832151722414       residual = 4.53e-06           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.832151723050       residual = 5.55e-06           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.832151724624       residual = 3.61e-06           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.832151725328       residual = 1.43e-06           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.832151725467       residual = 2.59e-07           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.832151725472       residual = 5.39e-08           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.832151725543       residual = 2.15e-08           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.832151725535       residual = 5.17e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         18 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 1.0000e+02 is 1.016497e-05

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.279676 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 75 and numParams is: 74

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.7692e+01
  </log>
  <optVariables href="H2O.s011.opt.xml">
ci_0001                 6.950651e-01 3 1  ON 0
ci_0002                 6.951037e-01 3 1  ON 1
ci_0003                -4.503269e-02 3 1  ON 2
ci_0004                -4.516071e-02 3 1  ON 3
ci_0005                -4.259999e-02 3 1  ON 4
ci_0006                -4.286326e-02 3 1  ON 5
ci_0007                -3.055024e-02 3 1  ON 6
ci_0008                -3.067235e-02 3 1  ON 7
ci_0009                -2.923856e-02 3 1  ON 8
ci_0010                -2.929030e-02 3 1  ON 9
ci_0011                -2.461909e-02 3 1  ON 10
ci_0012                -2.460622e-02 3 1  ON 11
ci_0013                 2.428043e-02 3 1  ON 12
ci_0014                 2.416660e-02 3 1  ON 13
ci_0015                 2.420239e-02 3 1  ON 14
ci_0016                 2.412690e-02 3 1  ON 15
ci_0017                 2.216845e-02 3 1  ON 16
ci_0018                 2.216818e-02 3 1  ON 17
ci_0019                 1.848988e-02 3 1  ON 18
ci_0020                 1.856736e-02 3 1  ON 19
ci_0021                 1.893747e-02 3 1  ON 20
ci_0022                 1.868705e-02 3 1  ON 21
ci_0023                -1.736477e-02 3 1  ON 22
ci_0024                -1.727239e-02 3 1  ON 23
ci_0025                -1.508966e-02 3 1  ON 24
ci_0026                -1.511315e-02 3 1  ON 25
ci_0027                -1.680908e-02 3 1  ON 26
ci_0028                -1.677983e-02 3 1  ON 27
ci_0029                -1.552049e-02 3 1  ON 28
ci_0030                -1.546472e-02 3 1  ON 29
ci_0031                 1.629528e-02 3 1  ON 30
ci_0032                 1.615610e-02 3 1  ON 31
ci_0033                 1.450080e-02 3 1  ON 32
ci_0034                 1.476462e-02 3 1  ON 33
ci_0035                 1.316562e-02 3 1  ON 34
ci_0036                 1.338706e-02 3 1  ON 35
ci_0037                -1.424298e-02 3 1  ON 36
ci_0038                -1.423389e-02 3 1  ON 37
ci_0039                -1.239857e-02 3 1  ON 38
ci_0040                -1.229596e-02 3 1  ON 39
ci_0041                 1.362445e-02 3 1  ON 40
ci_0042                 1.362663e-02 3 1  ON 41
ci_0043                -1.283382e-02 3 1  ON 42
ci_0044                -1.297335e-02 3 1  ON 43
ci_0045                 1.329389e-02 3 1  ON 44
ci_0046                 1.318310e-02 3 1  ON 45
ci_0047                -1.146145e-02 3 1  ON 46
ci_0048                -1.146374e-02 3 1  ON 47
ci_0049                -1.030192e-02 3 1  ON 48
ci_0050                -1.021069e-02 3 1  ON 49
ci_0051                -1.001647e-02 3 1  ON 50
ci_0052                -9.978754e-03 3 1  ON 51
ci_0053                -1.021686e-02 3 1  ON 52
ci_0054                -1.012348e-02 3 1  ON 53
ci_0055                 9.753580e-03 3 1  ON 54
ci_0056                 9.708805e-03 3 1  ON 55
ci_0057                 9.631918e-03 3 1  ON 56
ci_0058                 9.928878e-03 3 1  ON 57
ci_0059                -1.000835e-02 3 1  ON 58
ci_0060                -9.950133e-03 3 1  ON 59
ci_0061                -9.888864e-03 3 1  ON 60
ci_0062                -9.964595e-03 3 1  ON 61
ci_0063                -1.103612e-02 3 1  ON 62
ci_0064                -1.096434e-02 3 1  ON 63
ci_0065                -1.011626e-02 3 1  ON 64
ci_0066                -1.022836e-02 3 1  ON 65
ci_0067                -9.419719e-03 3 1  ON 66
ci_0068                -9.467042e-03 3 1  ON 67
ci_0069                 8.944882e-03 3 1  ON 68
ci_0070                 8.844330e-03 3 1  ON 69
ci_0071                 9.199314e-03 3 1  ON 70
ci_0072                 9.155836e-03 3 1  ON 71
ci_0073                 8.535668e-03 3 1  ON 72
ci_0074                 8.646099e-03 3 1  ON 73
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 11
    time step          = 0.05
    reference energy   = -16.9945
    reference variance = 0.24471
====================================================
  Execution time = 1.4728e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s011
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6898e+01
  VMC Evar = 3.6413e-01
  Total weights = 1.9509e+06
  Execution time = 1.9578e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.349046915743
                                         uncertainty =       0.003966614281

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.349046915743
                                         uncertainty =       0.003966614281

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000417718959
  error estimate for blocks of size 2^( 2) =       0.000431633204
  error estimate for blocks of size 2^( 3) =       0.000445293044
  error estimate for blocks of size 2^( 4) =       0.000458530626
  error estimate for blocks of size 2^( 5) =       0.000469305277
  error estimate for blocks of size 2^( 6) =       0.000476910108
  error estimate for blocks of size 2^( 7) =       0.000481880644

      target function =      -0.827661887094
              le_mean =     -16.897733901266
             les_mean =     285.897725493050
             stat err =       0.000471656664
             autocorr =       1.274921883692
   target nu stat err =       0.000471656664
   target dn stat err =       0.004644455557
      target stat err =       0.005098038431
              std dev =       0.590743816647
             le_variance =       0.348978256906

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.348469102683
                                         uncertainty =       0.004239715991

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.348469102683
                                         uncertainty =       0.004239715991

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000417373967
  error estimate for blocks of size 2^( 2) =       0.000431266211
  error estimate for blocks of size 2^( 3) =       0.000444915052
  error estimate for blocks of size 2^( 4) =       0.000458149625
  error estimate for blocks of size 2^( 5) =       0.000468927030
  error estimate for blocks of size 2^( 6) =       0.000476538634
  error estimate for blocks of size 2^( 7) =       0.000481499635

      target function =      -0.827515191565
              le_mean =     -16.897729400436
             les_mean =     285.897703027796
             stat err =       0.000471278731
             autocorr =       1.274984683496
   target nu stat err =       0.000471278731
   target dn stat err =       0.005028754771
      target stat err =       0.005511845533
              std dev =       0.590255924087
             le_variance =       0.348402055920

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.348742902113
                                         uncertainty =       0.004094417051

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.348742902113
                                         uncertainty =       0.004094417051

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000417537437
  error estimate for blocks of size 2^( 2) =       0.000431440762
  error estimate for blocks of size 2^( 3) =       0.000445095553
  error estimate for blocks of size 2^( 4) =       0.000458331635
  error estimate for blocks of size 2^( 5) =       0.000469107661
  error estimate for blocks of size 2^( 6) =       0.000476715549
  error estimate for blocks of size 2^( 7) =       0.000481681412

      target function =      -0.827954142924
              le_mean =     -16.897731533727
             les_mean =     285.897375361829
             stat err =       0.000471459064
             autocorr =       1.274961694900
   target nu stat err =       0.000471459064
   target dn stat err =       0.004794173876
      target stat err =       0.005263630264
              std dev =       0.590487106634
             le_variance =       0.348675023101

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.349007515734
                                         uncertainty =       0.003981636134

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.349007515734
                                         uncertainty =       0.003981636134

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000417695434
  error estimate for blocks of size 2^( 2) =       0.000431608326
  error estimate for blocks of size 2^( 3) =       0.000445267560
  error estimate for blocks of size 2^( 4) =       0.000458504963
  error estimate for blocks of size 2^( 5) =       0.000469279797
  error estimate for blocks of size 2^( 6) =       0.000476885006
  error estimate for blocks of size 2^( 7) =       0.000481854980

      target function =      -0.827715332412
              le_mean =     -16.897733581635
             les_mean =     285.897665410805
             stat err =       0.000471631186
             autocorr =       1.274927749318
   target nu stat err =       0.000471631186
   target dn stat err =       0.004661842747
      target stat err =       0.005117491874
              std dev =       0.590710547781
             le_variance =       0.348938951260


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.827661887094        initial
     6.2500e+00     6.2500e+01             1.6099e-04        -0.827515191565
     2.5000e+01     2.5000e+02             4.0577e-05        -0.827954142924  <--
     1.0000e+02     1.0000e+03             1.0165e-05        -0.827715332412

*****************************************************************************
Applying the update for shift_i =   2.5000e+01     and shift_s =   2.5000e+02
*****************************************************************************

  Execution time = 2.4622e+01
  </log>
  <optVariables href="H2O.s011.opt.xml">
ci_0001                 6.950651e-01 3 1  ON 0
ci_0002                 6.951037e-01 3 1  ON 1
ci_0003                -4.503269e-02 3 1  ON 2
ci_0004                -4.516071e-02 3 1  ON 3
ci_0005                -4.259999e-02 3 1  ON 4
ci_0006                -4.286326e-02 3 1  ON 5
ci_0007                -3.055024e-02 3 1  ON 6
ci_0008                -3.067235e-02 3 1  ON 7
ci_0009                -2.923856e-02 3 1  ON 8
ci_0010                -2.929030e-02 3 1  ON 9
ci_0011                -2.461909e-02 3 1  ON 10
ci_0012                -2.460622e-02 3 1  ON 11
ci_0013                 2.428043e-02 3 1  ON 12
ci_0014                 2.416660e-02 3 1  ON 13
ci_0015                 2.420239e-02 3 1  ON 14
ci_0016                 2.412690e-02 3 1  ON 15
ci_0017                 2.216845e-02 3 1  ON 16
ci_0018                 2.216818e-02 3 1  ON 17
ci_0019                 1.848988e-02 3 1  ON 18
ci_0020                 1.856736e-02 3 1  ON 19
ci_0021                 1.893747e-02 3 1  ON 20
ci_0022                 1.868705e-02 3 1  ON 21
ci_0023                -1.736477e-02 3 1  ON 22
ci_0024                -1.727239e-02 3 1  ON 23
ci_0025                -1.508966e-02 3 1  ON 24
ci_0026                -1.511315e-02 3 1  ON 25
ci_0027                -1.680908e-02 3 1  ON 26
ci_0028                -1.677983e-02 3 1  ON 27
ci_0029                -1.552049e-02 3 1  ON 28
ci_0030                -1.546472e-02 3 1  ON 29
ci_0031                 1.629528e-02 3 1  ON 30
ci_0032                 1.615610e-02 3 1  ON 31
ci_0033                 1.450080e-02 3 1  ON 32
ci_0034                 1.476462e-02 3 1  ON 33
ci_0035                 1.316562e-02 3 1  ON 34
ci_0036                 1.338706e-02 3 1  ON 35
ci_0037                -1.424298e-02 3 1  ON 36
ci_0038                -1.423389e-02 3 1  ON 37
ci_0039                -1.239857e-02 3 1  ON 38
ci_0040                -1.229596e-02 3 1  ON 39
ci_0041                 1.362445e-02 3 1  ON 40
ci_0042                 1.362663e-02 3 1  ON 41
ci_0043                -1.283382e-02 3 1  ON 42
ci_0044                -1.297335e-02 3 1  ON 43
ci_0045                 1.329389e-02 3 1  ON 44
ci_0046                 1.318310e-02 3 1  ON 45
ci_0047                -1.146145e-02 3 1  ON 46
ci_0048                -1.146374e-02 3 1  ON 47
ci_0049                -1.030192e-02 3 1  ON 48
ci_0050                -1.021069e-02 3 1  ON 49
ci_0051                -1.001647e-02 3 1  ON 50
ci_0052                -9.978754e-03 3 1  ON 51
ci_0053                -1.021686e-02 3 1  ON 52
ci_0054                -1.012348e-02 3 1  ON 53
ci_0055                 9.753580e-03 3 1  ON 54
ci_0056                 9.708805e-03 3 1  ON 55
ci_0057                 9.631918e-03 3 1  ON 56
ci_0058                 9.928878e-03 3 1  ON 57
ci_0059                -1.000835e-02 3 1  ON 58
ci_0060                -9.950133e-03 3 1  ON 59
ci_0061                -9.888864e-03 3 1  ON 60
ci_0062                -9.964595e-03 3 1  ON 61
ci_0063                -1.103612e-02 3 1  ON 62
ci_0064                -1.096434e-02 3 1  ON 63
ci_0065                -1.011626e-02 3 1  ON 64
ci_0066                -1.022836e-02 3 1  ON 65
ci_0067                -9.419719e-03 3 1  ON 66
ci_0068                -9.467042e-03 3 1  ON 67
ci_0069                 8.944882e-03 3 1  ON 68
ci_0070                 8.844330e-03 3 1  ON 69
ci_0071                 9.199314e-03 3 1  ON 70
ci_0072                 9.155836e-03 3 1  ON 71
ci_0073                 8.535668e-03 3 1  ON 72
ci_0074                 8.646099e-03 3 1  ON 73
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 4.2319e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s012 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s012 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=12  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6886e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 12
    time step          = 0.05
    reference energy   = -16.9031
    reference variance = 0.483421
====================================================
  Execution time = 1.5201e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s012
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5228e+04
  VMC Eavg = -1.6898e+01
  VMC Evar = 3.6431e-01
  Total weights = 1.951040805e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 2.7081e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.349707732728
                                         uncertainty =       0.003546003105

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.349707732728
                                         uncertainty =       0.003546003105

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000418112455
  error estimate for blocks of size 2^( 2) =       0.000432020681
  error estimate for blocks of size 2^( 3) =       0.000446451833
  error estimate for blocks of size 2^( 4) =       0.000459462104
  error estimate for blocks of size 2^( 5) =       0.000470717525
  error estimate for blocks of size 2^( 6) =       0.000480125089
  error estimate for blocks of size 2^( 7) =       0.000485191223

      target function =      -0.827680327177
              le_mean =     -16.898020536115
             les_mean =     285.907412835170
             stat err =       0.000473873985
             autocorr =       1.284516020694
   target nu stat err =       0.000473873985
   target dn stat err =       0.004340423706
      target stat err =       0.004772181904
              std dev =       0.591300304435
             le_variance =       0.349636050025


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.689802053611e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 74
Check correct_vf_var_size: 225, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 6.2500e+00, overlap shift 6.2500e+01 and omega -1.7527e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.827706991838       residual = 6.41e-01           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.828139117432       residual = 1.09e-01           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.828214666897       residual = 2.10e-02           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.828234061432       residual = 3.66e-03           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.828238573787       residual = 1.18e-03           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.828240156385       residual = 5.27e-04           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.828240785763       residual = 1.76e-04           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.828240876769       residual = 7.15e-05           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.828240932789       residual = 2.26e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.828240927353       residual = 7.82e-06           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.828240934731       residual = 5.40e-06           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.828240921262       residual = 2.82e-06           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.828240907031       residual = 3.23e-06           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.828240911712       residual = 2.54e-06           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.828240917817       residual = 1.21e-06           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.828240924156       residual = 1.91e-07           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.828240921656       residual = 3.70e-08           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.828240920686       residual = 1.34e-08           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.828240920396       residual = 3.05e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         18 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 6.2500e+00 is 1.434798e-04

solving harmonic davidson linear method for identity shift 2.5000e+01, overlap shift 2.5000e+02 and omega -1.7527e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.827706991838       residual = 6.41e-01           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.827815864664       residual = 1.09e-01           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.827834855586       residual = 2.09e-02           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.827839716400       residual = 3.63e-03           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.827840845379       residual = 1.17e-03           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.827841240137       residual = 5.20e-04           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.827841396636       residual = 1.72e-04           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.827841418979       residual = 7.03e-05           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.827841432769       residual = 2.22e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.827841431342       residual = 7.68e-06           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.827841433147       residual = 5.30e-06           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.827841429773       residual = 2.77e-06           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.827841426242       residual = 3.18e-06           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.827841427436       residual = 2.47e-06           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.827841428958       residual = 1.15e-06           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.827841430506       residual = 1.80e-07           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.827841429888       residual = 3.51e-08           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.827841429651       residual = 1.27e-08           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.827841429580       residual = 2.87e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         18 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 2.5000e+01 is 3.616007e-05

solving harmonic davidson linear method for identity shift 1.0000e+02, overlap shift 1.0000e+03 and omega -1.7527e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.827706991838       residual = 6.41e-01           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.827734263114       residual = 1.09e-01           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.827739017343       residual = 2.09e-02           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.827740233301       residual = 3.63e-03           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.827740515598       residual = 1.17e-03           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.827740614230       residual = 5.18e-04           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.827740653301       residual = 1.71e-04           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.827740658861       residual = 7.00e-05           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.827740662295       residual = 2.21e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.827740661934       residual = 7.64e-06           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.827740662383       residual = 5.27e-06           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.827740661539       residual = 2.76e-06           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.827740660658       residual = 3.17e-06           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.827740660958       residual = 2.45e-06           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.827740661339       residual = 1.14e-06           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.827740661723       residual = 1.78e-07           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.827740661569       residual = 3.46e-08           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.827740661510       residual = 1.25e-08           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.827740661492       residual = 2.82e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         18 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 1.0000e+02 is 9.058322e-06

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.291051 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 75 and numParams is: 74

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.7926e+01
  </log>
  <optVariables href="H2O.s012.opt.xml">
ci_0001                 6.950898e-01 3 1  ON 0
ci_0002                 6.951128e-01 3 1  ON 1
ci_0003                -4.499949e-02 3 1  ON 2
ci_0004                -4.512545e-02 3 1  ON 3
ci_0005                -4.257134e-02 3 1  ON 4
ci_0006                -4.283552e-02 3 1  ON 5
ci_0007                -3.052779e-02 3 1  ON 6
ci_0008                -3.064987e-02 3 1  ON 7
ci_0009                -2.921336e-02 3 1  ON 8
ci_0010                -2.926192e-02 3 1  ON 9
ci_0011                -2.459651e-02 3 1  ON 10
ci_0012                -2.458499e-02 3 1  ON 11
ci_0013                 2.425769e-02 3 1  ON 12
ci_0014                 2.414213e-02 3 1  ON 13
ci_0015                 2.417917e-02 3 1  ON 14
ci_0016                 2.410661e-02 3 1  ON 15
ci_0017                 2.214627e-02 3 1  ON 16
ci_0018                 2.214584e-02 3 1  ON 17
ci_0019                 1.847231e-02 3 1  ON 18
ci_0020                 1.855421e-02 3 1  ON 19
ci_0021                 1.893402e-02 3 1  ON 20
ci_0022                 1.868364e-02 3 1  ON 21
ci_0023                -1.734771e-02 3 1  ON 22
ci_0024                -1.725481e-02 3 1  ON 23
ci_0025                -1.505562e-02 3 1  ON 24
ci_0026                -1.507699e-02 3 1  ON 25
ci_0027                -1.679360e-02 3 1  ON 26
ci_0028                -1.676603e-02 3 1  ON 27
ci_0029                -1.550513e-02 3 1  ON 28
ci_0030                -1.545438e-02 3 1  ON 29
ci_0031                 1.629453e-02 3 1  ON 30
ci_0032                 1.615365e-02 3 1  ON 31
ci_0033                 1.449169e-02 3 1  ON 32
ci_0034                 1.475071e-02 3 1  ON 33
ci_0035                 1.313294e-02 3 1  ON 34
ci_0036                 1.337024e-02 3 1  ON 35
ci_0037                -1.423793e-02 3 1  ON 36
ci_0038                -1.422760e-02 3 1  ON 37
ci_0039                -1.237287e-02 3 1  ON 38
ci_0040                -1.227290e-02 3 1  ON 39
ci_0041                 1.361561e-02 3 1  ON 40
ci_0042                 1.361650e-02 3 1  ON 41
ci_0043                -1.281630e-02 3 1  ON 42
ci_0044                -1.295928e-02 3 1  ON 43
ci_0045                 1.328603e-02 3 1  ON 44
ci_0046                 1.317451e-02 3 1  ON 45
ci_0047                -1.143859e-02 3 1  ON 46
ci_0048                -1.144135e-02 3 1  ON 47
ci_0049                -1.028328e-02 3 1  ON 48
ci_0050                -1.019234e-02 3 1  ON 49
ci_0051                -9.989429e-03 3 1  ON 50
ci_0052                -9.954305e-03 3 1  ON 51
ci_0053                -1.019926e-02 3 1  ON 52
ci_0054                -1.010084e-02 3 1  ON 53
ci_0055                 9.730538e-03 3 1  ON 54
ci_0056                 9.684839e-03 3 1  ON 55
ci_0057                 9.611151e-03 3 1  ON 56
ci_0058                 9.905568e-03 3 1  ON 57
ci_0059                -9.990851e-03 3 1  ON 58
ci_0060                -9.929062e-03 3 1  ON 59
ci_0061                -9.871637e-03 3 1  ON 60
ci_0062                -9.949675e-03 3 1  ON 61
ci_0063                -1.103160e-02 3 1  ON 62
ci_0064                -1.095845e-02 3 1  ON 63
ci_0065                -1.010959e-02 3 1  ON 64
ci_0066                -1.021809e-02 3 1  ON 65
ci_0067                -9.399737e-03 3 1  ON 66
ci_0068                -9.449029e-03 3 1  ON 67
ci_0069                 8.928957e-03 3 1  ON 68
ci_0070                 8.824189e-03 3 1  ON 69
ci_0071                 9.194235e-03 3 1  ON 70
ci_0072                 9.133750e-03 3 1  ON 71
ci_0073                 8.522688e-03 3 1  ON 72
ci_0074                 8.629954e-03 3 1  ON 73
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 12
    time step          = 0.05
    reference energy   = -16.9242
    reference variance = 0.203765
====================================================
  Execution time = 1.4534e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s012
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6898e+01
  VMC Evar = 3.6655e-01
  Total weights = 1.9509e+06
  Execution time = 1.9765e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.350335549381
                                         uncertainty =       0.003429028527

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.350335549381
                                         uncertainty =       0.003429028527

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000418486050
  error estimate for blocks of size 2^( 2) =       0.000432260920
  error estimate for blocks of size 2^( 3) =       0.000446444807
  error estimate for blocks of size 2^( 4) =       0.000459867895
  error estimate for blocks of size 2^( 5) =       0.000469834718
  error estimate for blocks of size 2^( 6) =       0.000478804827
  error estimate for blocks of size 2^( 7) =       0.000483580485

      target function =      -0.818967099988
              le_mean =     -16.897646017953
             les_mean =     285.902773818974
             stat err =       0.000473021981
             autocorr =       1.277616979119
   target nu stat err =       0.000473021981
   target dn stat err =       0.007447655858
      target stat err =       0.007967760233
              std dev =       0.591828647476
             le_variance =       0.350261147974

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.349403393430
                                         uncertainty =       0.003433382089

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.349403393430
                                         uncertainty =       0.003433382089

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000417928960
  error estimate for blocks of size 2^( 2) =       0.000431692770
  error estimate for blocks of size 2^( 3) =       0.000445878259
  error estimate for blocks of size 2^( 4) =       0.000459305686
  error estimate for blocks of size 2^( 5) =       0.000469286176
  error estimate for blocks of size 2^( 6) =       0.000478262678
  error estimate for blocks of size 2^( 7) =       0.000483057736

      target function =      -0.811839809080
              le_mean =     -16.897649821186
             les_mean =     285.909462603341
             stat err =       0.000472478069
             autocorr =       1.278080991414
   target nu stat err =       0.000472478069
   target dn stat err =       0.014010779338
      target stat err =       0.014701541016
              std dev =       0.591040804045
             le_variance =       0.349329232046

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.349863141339
                                         uncertainty =       0.003431130372

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.349863141339
                                         uncertainty =       0.003431130372

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000418203816
  error estimate for blocks of size 2^( 2) =       0.000431973087
  error estimate for blocks of size 2^( 3) =       0.000446157631
  error estimate for blocks of size 2^( 4) =       0.000459583132
  error estimate for blocks of size 2^( 5) =       0.000469557024
  error estimate for blocks of size 2^( 6) =       0.000478529546
  error estimate for blocks of size 2^( 7) =       0.000483314915

      target function =      -0.825396859943
              le_mean =     -16.897647689632
             les_mean =     285.896889004411
             stat err =       0.000472746154
             autocorr =       1.277850438985
   target nu stat err =       0.000472746154
   target dn stat err =       0.004936520775
      target stat err =       0.005384065577
              std dev =       0.591429508556
             le_variance =       0.349788863591

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.350276047596
                                         uncertainty =       0.003429286394

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.350276047596
                                         uncertainty =       0.003429286394

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000418450512
  error estimate for blocks of size 2^( 2) =       0.000432224908
  error estimate for blocks of size 2^( 3) =       0.000446408867
  error estimate for blocks of size 2^( 4) =       0.000459832497
  error estimate for blocks of size 2^( 5) =       0.000469800452
  error estimate for blocks of size 2^( 6) =       0.000478771838
  error estimate for blocks of size 2^( 7) =       0.000483551312

      target function =      -0.822174524283
              le_mean =     -16.897646610765
             les_mean =     285.899829318556
             stat err =       0.000472989025
             autocorr =       1.277655942422
   target nu stat err =       0.000472989025
   target dn stat err =       0.005614246380
      target stat err =       0.006066696398
              std dev =       0.591778389587
             le_variance =       0.350201662383


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.818967099988        initial
     6.2500e+00     6.2500e+01             1.4348e-04        -0.811839809080
     2.5000e+01     2.5000e+02             3.6160e-05        -0.825396859943  <--
     1.0000e+02     1.0000e+03             9.0583e-06        -0.822174524283

*****************************************************************************
Applying the update for shift_i =   2.5000e+01     and shift_s =   2.5000e+02
*****************************************************************************

  Execution time = 2.4473e+01
  </log>
  <optVariables href="H2O.s012.opt.xml">
ci_0001                 6.950898e-01 3 1  ON 0
ci_0002                 6.951128e-01 3 1  ON 1
ci_0003                -4.499949e-02 3 1  ON 2
ci_0004                -4.512545e-02 3 1  ON 3
ci_0005                -4.257134e-02 3 1  ON 4
ci_0006                -4.283552e-02 3 1  ON 5
ci_0007                -3.052779e-02 3 1  ON 6
ci_0008                -3.064987e-02 3 1  ON 7
ci_0009                -2.921336e-02 3 1  ON 8
ci_0010                -2.926192e-02 3 1  ON 9
ci_0011                -2.459651e-02 3 1  ON 10
ci_0012                -2.458499e-02 3 1  ON 11
ci_0013                 2.425769e-02 3 1  ON 12
ci_0014                 2.414213e-02 3 1  ON 13
ci_0015                 2.417917e-02 3 1  ON 14
ci_0016                 2.410661e-02 3 1  ON 15
ci_0017                 2.214627e-02 3 1  ON 16
ci_0018                 2.214584e-02 3 1  ON 17
ci_0019                 1.847231e-02 3 1  ON 18
ci_0020                 1.855421e-02 3 1  ON 19
ci_0021                 1.893402e-02 3 1  ON 20
ci_0022                 1.868364e-02 3 1  ON 21
ci_0023                -1.734771e-02 3 1  ON 22
ci_0024                -1.725481e-02 3 1  ON 23
ci_0025                -1.505562e-02 3 1  ON 24
ci_0026                -1.507699e-02 3 1  ON 25
ci_0027                -1.679360e-02 3 1  ON 26
ci_0028                -1.676603e-02 3 1  ON 27
ci_0029                -1.550513e-02 3 1  ON 28
ci_0030                -1.545438e-02 3 1  ON 29
ci_0031                 1.629453e-02 3 1  ON 30
ci_0032                 1.615365e-02 3 1  ON 31
ci_0033                 1.449169e-02 3 1  ON 32
ci_0034                 1.475071e-02 3 1  ON 33
ci_0035                 1.313294e-02 3 1  ON 34
ci_0036                 1.337024e-02 3 1  ON 35
ci_0037                -1.423793e-02 3 1  ON 36
ci_0038                -1.422760e-02 3 1  ON 37
ci_0039                -1.237287e-02 3 1  ON 38
ci_0040                -1.227290e-02 3 1  ON 39
ci_0041                 1.361561e-02 3 1  ON 40
ci_0042                 1.361650e-02 3 1  ON 41
ci_0043                -1.281630e-02 3 1  ON 42
ci_0044                -1.295928e-02 3 1  ON 43
ci_0045                 1.328603e-02 3 1  ON 44
ci_0046                 1.317451e-02 3 1  ON 45
ci_0047                -1.143859e-02 3 1  ON 46
ci_0048                -1.144135e-02 3 1  ON 47
ci_0049                -1.028328e-02 3 1  ON 48
ci_0050                -1.019234e-02 3 1  ON 49
ci_0051                -9.989429e-03 3 1  ON 50
ci_0052                -9.954305e-03 3 1  ON 51
ci_0053                -1.019926e-02 3 1  ON 52
ci_0054                -1.010084e-02 3 1  ON 53
ci_0055                 9.730538e-03 3 1  ON 54
ci_0056                 9.684839e-03 3 1  ON 55
ci_0057                 9.611151e-03 3 1  ON 56
ci_0058                 9.905568e-03 3 1  ON 57
ci_0059                -9.990851e-03 3 1  ON 58
ci_0060                -9.929062e-03 3 1  ON 59
ci_0061                -9.871637e-03 3 1  ON 60
ci_0062                -9.949675e-03 3 1  ON 61
ci_0063                -1.103160e-02 3 1  ON 62
ci_0064                -1.095845e-02 3 1  ON 63
ci_0065                -1.010959e-02 3 1  ON 64
ci_0066                -1.021809e-02 3 1  ON 65
ci_0067                -9.399737e-03 3 1  ON 66
ci_0068                -9.449029e-03 3 1  ON 67
ci_0069                 8.928957e-03 3 1  ON 68
ci_0070                 8.824189e-03 3 1  ON 69
ci_0071                 9.194235e-03 3 1  ON 70
ci_0072                 9.133750e-03 3 1  ON 71
ci_0073                 8.522688e-03 3 1  ON 72
ci_0074                 8.629954e-03 3 1  ON 73
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 4.2405e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s013 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s013 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=13  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6888e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 13
    time step          = 0.05
    reference energy   = -16.8505
    reference variance = 0.207162
====================================================
  Execution time = 1.4876e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s013
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5220e+04
  VMC Eavg = -1.6897e+01
  VMC Evar = 3.6239e-01
  Total weights = 1.951288122e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 2.7257e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.344044202139
                                         uncertainty =       0.002681329595

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.344044202139
                                         uncertainty =       0.002681329595

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000414712752
  error estimate for blocks of size 2^( 2) =       0.000428936798
  error estimate for blocks of size 2^( 3) =       0.000443369925
  error estimate for blocks of size 2^( 4) =       0.000457448935
  error estimate for blocks of size 2^( 5) =       0.000468579879
  error estimate for blocks of size 2^( 6) =       0.000477407098
  error estimate for blocks of size 2^( 7) =       0.000482313383

      target function =      -0.829724971076
              le_mean =     -16.897110137995
             les_mean =     285.874719678160
             stat err =       0.000471437324
             autocorr =       1.292269652634
   target nu stat err =       0.000471437324
   target dn stat err =       0.004920903944
      target stat err =       0.005418489857
              std dev =       0.586492398507
             le_variance =       0.343973333506


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.689711013799e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 74
Check correct_vf_var_size: 225, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 6.2500e+00, overlap shift 6.2500e+01 and omega -1.7527e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.829759356377       residual = 6.76e-01           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.830207223703       residual = 1.33e-01           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.830292266079       residual = 2.47e-02           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.830313516082       residual = 5.73e-03           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.830318924272       residual = 2.78e-03           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.830321213016       residual = 1.16e-03           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.830322792074       residual = 3.56e-04           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.830323170391       residual = 7.82e-05           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.830323290799       residual = 2.73e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.830323305835       residual = 7.30e-06           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.830323294874       residual = 3.28e-06           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.830323293559       residual = 6.91e-07           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.830323289374       residual = 3.12e-07           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.830323292016       residual = 2.54e-07           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.830323294801       residual = 3.12e-07           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.830323299491       residual = 2.02e-07           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.830323299571       residual = 5.05e-08           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.830323299508       residual = 2.23e-08           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.830323298698       residual = 6.10e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         18 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 6.2500e+00 is 1.506508e-04

solving harmonic davidson linear method for identity shift 2.5000e+01, overlap shift 2.5000e+02 and omega -1.7527e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.829759356377       residual = 6.76e-01           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.829872199840       residual = 1.32e-01           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.829893576387       residual = 2.46e-02           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.829898902818       residual = 5.69e-03           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.829900256295       residual = 2.75e-03           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.829900827793       residual = 1.15e-03           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.829901220882       residual = 3.51e-04           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.829901314606       residual = 7.68e-05           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.829901344348       residual = 2.66e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.829901347965       residual = 7.12e-06           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.829901345219       residual = 3.19e-06           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.829901344883       residual = 6.69e-07           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.829901343846       residual = 3.03e-07           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.829901344510       residual = 2.48e-07           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.829901345208       residual = 3.03e-07           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.829901346357       residual = 1.92e-07           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.829901346372       residual = 4.80e-08           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.829901346354       residual = 2.11e-08           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.829901346153       residual = 5.75e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         18 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 2.5000e+01 is 3.797068e-05

solving harmonic davidson linear method for identity shift 1.0000e+02, overlap shift 1.0000e+03 and omega -1.7527e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.829759356377       residual = 6.76e-01           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.829787622534       residual = 1.32e-01           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.829792973946       residual = 2.46e-02           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.829794306417       residual = 5.68e-03           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.829794644872       residual = 2.75e-03           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.829794787701       residual = 1.15e-03           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.829794885866       residual = 3.49e-04           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.829794909243       residual = 7.64e-05           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.829794916656       residual = 2.65e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.829794917552       residual = 7.08e-06           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.829794916865       residual = 3.16e-06           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.829794916780       residual = 6.63e-07           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.829794916522       residual = 3.01e-07           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.829794916688       residual = 2.46e-07           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.829794916862       residual = 3.00e-07           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.829794917148       residual = 1.90e-07           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.829794917152       residual = 4.74e-08           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.829794917147       residual = 2.08e-08           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.829794917097       residual = 5.66e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         18 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 1.0000e+02 is 9.512102e-06

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.302542 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 75 and numParams is: 74

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.7619e+01
  </log>
  <optVariables href="H2O.s013.opt.xml">
ci_0001                 6.951101e-01 3 1  ON 0
ci_0002                 6.951280e-01 3 1  ON 1
ci_0003                -4.496503e-02 3 1  ON 2
ci_0004                -4.509098e-02 3 1  ON 3
ci_0005                -4.253684e-02 3 1  ON 4
ci_0006                -4.280565e-02 3 1  ON 5
ci_0007                -3.050292e-02 3 1  ON 6
ci_0008                -3.061828e-02 3 1  ON 7
ci_0009                -2.918480e-02 3 1  ON 8
ci_0010                -2.923430e-02 3 1  ON 9
ci_0011                -2.457306e-02 3 1  ON 10
ci_0012                -2.455758e-02 3 1  ON 11
ci_0013                 2.423622e-02 3 1  ON 12
ci_0014                 2.411831e-02 3 1  ON 13
ci_0015                 2.416292e-02 3 1  ON 14
ci_0016                 2.408540e-02 3 1  ON 15
ci_0017                 2.212525e-02 3 1  ON 16
ci_0018                 2.211906e-02 3 1  ON 17
ci_0019                 1.845361e-02 3 1  ON 18
ci_0020                 1.853686e-02 3 1  ON 19
ci_0021                 1.893014e-02 3 1  ON 20
ci_0022                 1.867864e-02 3 1  ON 21
ci_0023                -1.733187e-02 3 1  ON 22
ci_0024                -1.723739e-02 3 1  ON 23
ci_0025                -1.501765e-02 3 1  ON 24
ci_0026                -1.503991e-02 3 1  ON 25
ci_0027                -1.678063e-02 3 1  ON 26
ci_0028                -1.675247e-02 3 1  ON 27
ci_0029                -1.549221e-02 3 1  ON 28
ci_0030                -1.544224e-02 3 1  ON 29
ci_0031                 1.629225e-02 3 1  ON 30
ci_0032                 1.615112e-02 3 1  ON 31
ci_0033                 1.447874e-02 3 1  ON 32
ci_0034                 1.473894e-02 3 1  ON 33
ci_0035                 1.310542e-02 3 1  ON 34
ci_0036                 1.334617e-02 3 1  ON 35
ci_0037                -1.422961e-02 3 1  ON 36
ci_0038                -1.421964e-02 3 1  ON 37
ci_0039                -1.234734e-02 3 1  ON 38
ci_0040                -1.224893e-02 3 1  ON 39
ci_0041                 1.360395e-02 3 1  ON 40
ci_0042                 1.360719e-02 3 1  ON 41
ci_0043                -1.280724e-02 3 1  ON 42
ci_0044                -1.294362e-02 3 1  ON 43
ci_0045                 1.328046e-02 3 1  ON 44
ci_0046                 1.316196e-02 3 1  ON 45
ci_0047                -1.141467e-02 3 1  ON 46
ci_0048                -1.141854e-02 3 1  ON 47
ci_0049                -1.026291e-02 3 1  ON 48
ci_0050                -1.016337e-02 3 1  ON 49
ci_0051                -9.967546e-03 3 1  ON 50
ci_0052                -9.926891e-03 3 1  ON 51
ci_0053                -1.017946e-02 3 1  ON 52
ci_0054                -1.007853e-02 3 1  ON 53
ci_0055                 9.706360e-03 3 1  ON 54
ci_0056                 9.665073e-03 3 1  ON 55
ci_0057                 9.589366e-03 3 1  ON 56
ci_0058                 9.879827e-03 3 1  ON 57
ci_0059                -9.973081e-03 3 1  ON 58
ci_0060                -9.909662e-03 3 1  ON 59
ci_0061                -9.855865e-03 3 1  ON 60
ci_0062                -9.933734e-03 3 1  ON 61
ci_0063                -1.102740e-02 3 1  ON 62
ci_0064                -1.095311e-02 3 1  ON 63
ci_0065                -1.010324e-02 3 1  ON 64
ci_0066                -1.020848e-02 3 1  ON 65
ci_0067                -9.379462e-03 3 1  ON 66
ci_0068                -9.429718e-03 3 1  ON 67
ci_0069                 8.913952e-03 3 1  ON 68
ci_0070                 8.807862e-03 3 1  ON 69
ci_0071                 9.185419e-03 3 1  ON 70
ci_0072                 9.112115e-03 3 1  ON 71
ci_0073                 8.508032e-03 3 1  ON 72
ci_0074                 8.615682e-03 3 1  ON 73
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 13
    time step          = 0.05
    reference energy   = -16.9042
    reference variance = 0.432149
====================================================
  Execution time = 1.4909e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s013
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6899e+01
  VMC Evar = 3.6655e-01
  Total weights = 1.9513e+06
  Execution time = 1.9765e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.347840119232
                                         uncertainty =       0.003119397283

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.347840119232
                                         uncertainty =       0.003119397283

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000417094220
  error estimate for blocks of size 2^( 2) =       0.000431077163
  error estimate for blocks of size 2^( 3) =       0.000445084401
  error estimate for blocks of size 2^( 4) =       0.000458044411
  error estimate for blocks of size 2^( 5) =       0.000470027493
  error estimate for blocks of size 2^( 6) =       0.000477481612
  error estimate for blocks of size 2^( 7) =       0.000483658222

      target function =      -0.824727084639
              le_mean =     -16.898725329353
             les_mean =     285.933980254033
             stat err =       0.000472302935
             autocorr =       1.282250700344
   target nu stat err =       0.000472302935
   target dn stat err =       0.004553772839
      target stat err =       0.004972807412
              std dev =       0.589860302897
             le_variance =       0.347935176933

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.346854169363
                                         uncertainty =       0.003106538659

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.346854169363
                                         uncertainty =       0.003106538659

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000416502819
  error estimate for blocks of size 2^( 2) =       0.000430474056
  error estimate for blocks of size 2^( 3) =       0.000444476554
  error estimate for blocks of size 2^( 4) =       0.000457441349
  error estimate for blocks of size 2^( 5) =       0.000469429540
  error estimate for blocks of size 2^( 6) =       0.000476883170
  error estimate for blocks of size 2^( 7) =       0.000483076508

      target function =      -0.826486616601
              le_mean =     -16.898725500502
             les_mean =     285.932366581343
             stat err =       0.000471707642
             autocorr =       1.282655220192
   target nu stat err =       0.000471707642
   target dn stat err =       0.004457344735
      target stat err =       0.004889687790
              std dev =       0.589023935987
             le_variance =       0.346949197165

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.347338314587
                                         uncertainty =       0.003113139901

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.347338314587
                                         uncertainty =       0.003113139901

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000416793329
  error estimate for blocks of size 2^( 2) =       0.000430770317
  error estimate for blocks of size 2^( 3) =       0.000444775179
  error estimate for blocks of size 2^( 4) =       0.000457737523
  error estimate for blocks of size 2^( 5) =       0.000469723408
  error estimate for blocks of size 2^( 6) =       0.000477177207
  error estimate for blocks of size 2^( 7) =       0.000483362141

      target function =      -0.825736991318
              le_mean =     -16.898725063308
             les_mean =     285.933041046871
             stat err =       0.000472000070
             autocorr =       1.282456390773
   target nu stat err =       0.000472000070
   target dn stat err =       0.004485611091
      target stat err =       0.004911394109
              std dev =       0.589434779199
             le_variance =       0.347433358930

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.347776557466
                                         uncertainty =       0.003118655308

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.347776557466
                                         uncertainty =       0.003118655308

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000417056120
  error estimate for blocks of size 2^( 2) =       0.000431038310
  error estimate for blocks of size 2^( 3) =       0.000445045253
  error estimate for blocks of size 2^( 4) =       0.000458005541
  error estimate for blocks of size 2^( 5) =       0.000469989003
  error estimate for blocks of size 2^( 6) =       0.000477443062
  error estimate for blocks of size 2^( 7) =       0.000483620706

      target function =      -0.824876153818
              le_mean =     -16.898725247473
             les_mean =     285.933840069018
             stat err =       0.000472264578
             autocorr =       1.282276695244
   target nu stat err =       0.000472264578
   target dn stat err =       0.004540948150
      target stat err =       0.004960791871
              std dev =       0.589806420512
             le_variance =       0.347871613677


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.824727084639        initial
     6.2500e+00     6.2500e+01             1.5065e-04        -0.826486616601  <--
     2.5000e+01     2.5000e+02             3.7971e-05        -0.825736991318
     1.0000e+02     1.0000e+03             9.5121e-06        -0.824876153818

*****************************************************************************
Applying the update for shift_i =   6.2500e+00     and shift_s =   6.2500e+01
*****************************************************************************

  Execution time = 2.4897e+01
  </log>
  <optVariables href="H2O.s013.opt.xml">
ci_0001                 6.951707e-01 3 1  ON 0
ci_0002                 6.951731e-01 3 1  ON 1
ci_0003                -4.486253e-02 3 1  ON 2
ci_0004                -4.498843e-02 3 1  ON 3
ci_0005                -4.243401e-02 3 1  ON 4
ci_0006                -4.271663e-02 3 1  ON 5
ci_0007                -3.042873e-02 3 1  ON 6
ci_0008                -3.052400e-02 3 1  ON 7
ci_0009                -2.909991e-02 3 1  ON 8
ci_0010                -2.915223e-02 3 1  ON 9
ci_0011                -2.450337e-02 3 1  ON 10
ci_0012                -2.447609e-02 3 1  ON 11
ci_0013                 2.417239e-02 3 1  ON 12
ci_0014                 2.404751e-02 3 1  ON 13
ci_0015                 2.411462e-02 3 1  ON 14
ci_0016                 2.402232e-02 3 1  ON 15
ci_0017                 2.206275e-02 3 1  ON 16
ci_0018                 2.203949e-02 3 1  ON 17
ci_0019                 1.839806e-02 3 1  ON 18
ci_0020                 1.848529e-02 3 1  ON 19
ci_0021                 1.891851e-02 3 1  ON 20
ci_0022                 1.866364e-02 3 1  ON 21
ci_0023                -1.728480e-02 3 1  ON 22
ci_0024                -1.718565e-02 3 1  ON 23
ci_0025                -1.490497e-02 3 1  ON 24
ci_0026                -1.492989e-02 3 1  ON 25
ci_0027                -1.674213e-02 3 1  ON 26
ci_0028                -1.671221e-02 3 1  ON 27
ci_0029                -1.545386e-02 3 1  ON 28
ci_0030                -1.540621e-02 3 1  ON 29
ci_0031                 1.628545e-02 3 1  ON 30
ci_0032                 1.614357e-02 3 1  ON 31
ci_0033                 1.444016e-02 3 1  ON 32
ci_0034                 1.470387e-02 3 1  ON 33
ci_0035                 1.302377e-02 3 1  ON 34
ci_0036                 1.327473e-02 3 1  ON 35
ci_0037                -1.420486e-02 3 1  ON 36
ci_0038                -1.419595e-02 3 1  ON 37
ci_0039                -1.227152e-02 3 1  ON 38
ci_0040                -1.217775e-02 3 1  ON 39
ci_0041                 1.356927e-02 3 1  ON 40
ci_0042                 1.357948e-02 3 1  ON 41
ci_0043                -1.278024e-02 3 1  ON 42
ci_0044                -1.289695e-02 3 1  ON 43
ci_0045                 1.326388e-02 3 1  ON 44
ci_0046                 1.312459e-02 3 1  ON 45
ci_0047                -1.134363e-02 3 1  ON 46
ci_0048                -1.135078e-02 3 1  ON 47
ci_0049                -1.020244e-02 3 1  ON 48
ci_0050                -1.007743e-02 3 1  ON 49
ci_0051                -9.902654e-03 3 1  ON 50
ci_0052                -9.845596e-03 3 1  ON 51
ci_0053                -1.012071e-02 3 1  ON 52
ci_0054                -1.001232e-02 3 1  ON 53
ci_0055                 9.634617e-03 3 1  ON 54
ci_0056                 9.606417e-03 3 1  ON 55
ci_0057                 9.524704e-03 3 1  ON 56
ci_0058                 9.803434e-03 3 1  ON 57
ci_0059                -9.920358e-03 3 1  ON 58
ci_0060                -9.852089e-03 3 1  ON 59
ci_0061                -9.808971e-03 3 1  ON 60
ci_0062                -9.886337e-03 3 1  ON 61
ci_0063                -1.101493e-02 3 1  ON 62
ci_0064                -1.093725e-02 3 1  ON 63
ci_0065                -1.008434e-02 3 1  ON 64
ci_0066                -1.017991e-02 3 1  ON 65
ci_0067                -9.319308e-03 3 1  ON 66
ci_0068                -9.372430e-03 3 1  ON 67
ci_0069                 8.869435e-03 3 1  ON 68
ci_0070                 8.759420e-03 3 1  ON 69
ci_0071                 9.159238e-03 3 1  ON 70
ci_0072                 9.047919e-03 3 1  ON 71
ci_0073                 8.464554e-03 3 1  ON 72
ci_0074                 8.573331e-03 3 1  ON 73
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 4.2522e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s014 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s014 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=14  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6887e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 14
    time step          = 0.05
    reference energy   = -16.9142
    reference variance = 0.211333
====================================================
  Execution time = 1.5010e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s014
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5245e+04
  VMC Eavg = -1.6898e+01
  VMC Evar = 3.6268e-01
  Total weights = 1.950925577e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 2.7180e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.348139308663
                                         uncertainty =       0.002298150351

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.348139308663
                                         uncertainty =       0.002298150351

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000417163913
  error estimate for blocks of size 2^( 2) =       0.000431408542
  error estimate for blocks of size 2^( 3) =       0.000445474152
  error estimate for blocks of size 2^( 4) =       0.000458175737
  error estimate for blocks of size 2^( 5) =       0.000469416788
  error estimate for blocks of size 2^( 6) =       0.000478239521
  error estimate for blocks of size 2^( 7) =       0.000484368254

      target function =      -0.829493276361
              le_mean =     -16.898150941771
             les_mean =     285.910180881837
             stat err =       0.000472550075
             autocorr =       1.283164118858
   target nu stat err =       0.000472550075
   target dn stat err =       0.002899694137
      target stat err =       0.003235920168
              std dev =       0.589958864185
             le_variance =       0.348051461431


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.689815094177e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 74
Check correct_vf_var_size: 225, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.5625e+00, overlap shift 1.5625e+01 and omega -1.7527e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.829504984209       residual = 6.58e-01           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.831236715276       residual = 1.25e-01           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.831546744583       residual = 2.26e-02           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.831631275794       residual = 4.54e-03           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.831648974562       residual = 1.69e-03           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.831656464830       residual = 1.19e-03           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.831660121631       residual = 3.24e-04           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.831661579243       residual = 8.12e-05           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.831661963532       residual = 2.83e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.831662000171       residual = 8.04e-06           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.831662102298       residual = 3.81e-06           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.831662172202       residual = 8.58e-07           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.831662187099       residual = 4.99e-07           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.831662198482       residual = 4.11e-07           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.831662200164       residual = 5.98e-07           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.831662181801       residual = 2.44e-07           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.831662188207       residual = 7.16e-08           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.831662187813       residual = 2.66e-08           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.831662188424       residual = 8.08e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         18 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 1.5625e+00 is 6.065623e-04

solving harmonic davidson linear method for identity shift 6.2500e+00, overlap shift 6.2500e+01 and omega -1.7527e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.829504984209       residual = 6.58e-01           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.829951373363       residual = 1.24e-01           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.830030597778       residual = 2.22e-02           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.830051960827       residual = 4.42e-03           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.830056399440       residual = 1.63e-03           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.830058267136       residual = 1.14e-03           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.830059162018       residual = 3.05e-04           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.830059516933       residual = 7.56e-05           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.830059608706       residual = 2.60e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.830059616736       residual = 7.39e-06           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.830059641714       residual = 3.44e-06           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.830059658637       residual = 7.72e-07           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.830059662229       residual = 4.60e-07           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.830059664950       residual = 3.88e-07           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.830059665221       residual = 5.44e-07           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.830059660767       residual = 2.02e-07           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.830059662293       residual = 5.98e-08           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.830059662173       residual = 2.17e-08           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.830059662294       residual = 6.45e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         18 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 6.2500e+00 is 1.565390e-04

solving harmonic davidson linear method for identity shift 2.5000e+01, overlap shift 2.5000e+02 and omega -1.7527e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.829504984209       residual = 6.58e-01           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.829617453306       residual = 1.23e-01           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.829637368549       residual = 2.21e-02           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.829642723259       residual = 4.38e-03           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.829643833589       residual = 1.62e-03           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.829644300101       residual = 1.12e-03           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.829644522535       residual = 3.00e-04           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.829644610642       residual = 7.43e-05           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.829644633309       residual = 2.55e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.829644635247       residual = 7.23e-06           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.829644641456       residual = 3.34e-06           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.829644645651       residual = 7.51e-07           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.829644646540       residual = 4.51e-07           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.829644647212       residual = 3.83e-07           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.829644647270       residual = 5.31e-07           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.829644646166       residual = 1.92e-07           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.829644646543       residual = 5.71e-08           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.829644646512       residual = 2.06e-08           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.829644646540       residual = 6.09e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         18 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 2.5000e+01 is 3.945246e-05

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.314058 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 75 and numParams is: 74

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.7746e+01
  </log>
  <optVariables href="H2O.s014.opt.xml">
ci_0001                 6.952532e-01 3 1  ON 0
ci_0002                 6.952287e-01 3 1  ON 1
ci_0003                -4.472168e-02 3 1  ON 2
ci_0004                -4.485317e-02 3 1  ON 3
ci_0005                -4.230729e-02 3 1  ON 4
ci_0006                -4.260528e-02 3 1  ON 5
ci_0007                -3.032956e-02 3 1  ON 6
ci_0008                -3.041868e-02 3 1  ON 7
ci_0009                -2.899664e-02 3 1  ON 8
ci_0010                -2.905340e-02 3 1  ON 9
ci_0011                -2.441749e-02 3 1  ON 10
ci_0012                -2.438157e-02 3 1  ON 11
ci_0013                 2.407171e-02 3 1  ON 12
ci_0014                 2.394932e-02 3 1  ON 13
ci_0015                 2.402665e-02 3 1  ON 14
ci_0016                 2.393192e-02 3 1  ON 15
ci_0017                 2.197595e-02 3 1  ON 16
ci_0018                 2.195441e-02 3 1  ON 17
ci_0019                 1.833300e-02 3 1  ON 18
ci_0020                 1.842173e-02 3 1  ON 19
ci_0021                 1.891806e-02 3 1  ON 20
ci_0022                 1.864620e-02 3 1  ON 21
ci_0023                -1.722555e-02 3 1  ON 22
ci_0024                -1.711813e-02 3 1  ON 23
ci_0025                -1.475646e-02 3 1  ON 24
ci_0026                -1.477335e-02 3 1  ON 25
ci_0027                -1.668206e-02 3 1  ON 26
ci_0028                -1.665598e-02 3 1  ON 27
ci_0029                -1.538829e-02 3 1  ON 28
ci_0030                -1.535340e-02 3 1  ON 29
ci_0031                 1.626326e-02 3 1  ON 30
ci_0032                 1.610254e-02 3 1  ON 31
ci_0033                 1.439131e-02 3 1  ON 32
ci_0034                 1.464169e-02 3 1  ON 33
ci_0035                 1.290418e-02 3 1  ON 34
ci_0036                 1.314261e-02 3 1  ON 35
ci_0037                -1.417120e-02 3 1  ON 36
ci_0038                -1.417253e-02 3 1  ON 37
ci_0039                -1.217562e-02 3 1  ON 38
ci_0040                -1.208327e-02 3 1  ON 39
ci_0041                 1.352510e-02 3 1  ON 40
ci_0042                 1.353869e-02 3 1  ON 41
ci_0043                -1.271818e-02 3 1  ON 42
ci_0044                -1.285069e-02 3 1  ON 43
ci_0045                 1.322956e-02 3 1  ON 44
ci_0046                 1.311414e-02 3 1  ON 45
ci_0047                -1.125189e-02 3 1  ON 46
ci_0048                -1.125885e-02 3 1  ON 47
ci_0049                -1.011516e-02 3 1  ON 48
ci_0050                -9.981830e-03 3 1  ON 49
ci_0051                -9.803754e-03 3 1  ON 50
ci_0052                -9.747504e-03 3 1  ON 51
ci_0053                -1.004418e-02 3 1  ON 52
ci_0054                -9.935085e-03 3 1  ON 53
ci_0055                 9.543851e-03 3 1  ON 54
ci_0056                 9.519451e-03 3 1  ON 55
ci_0057                 9.440401e-03 3 1  ON 56
ci_0058                 9.722813e-03 3 1  ON 57
ci_0059                -9.849940e-03 3 1  ON 58
ci_0060                -9.784664e-03 3 1  ON 59
ci_0061                -9.749768e-03 3 1  ON 60
ci_0062                -9.811754e-03 3 1  ON 61
ci_0063                -1.099373e-02 3 1  ON 62
ci_0064                -1.092389e-02 3 1  ON 63
ci_0065                -1.006364e-02 3 1  ON 64
ci_0066                -1.015039e-02 3 1  ON 65
ci_0067                -9.260970e-03 3 1  ON 66
ci_0068                -9.298642e-03 3 1  ON 67
ci_0069                 8.816514e-03 3 1  ON 68
ci_0070                 8.688907e-03 3 1  ON 69
ci_0071                 9.113185e-03 3 1  ON 70
ci_0072                 8.982794e-03 3 1  ON 71
ci_0073                 8.410371e-03 3 1  ON 72
ci_0074                 8.508375e-03 3 1  ON 73
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 14
    time step          = 0.05
    reference energy   = -16.9663
    reference variance = 0.461915
====================================================
  Execution time = 1.4861e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s014
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6899e+01
  VMC Evar = 3.5761e-01
  Total weights = 1.9511e+06
  Execution time = 1.9644e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.342647012906
                                         uncertainty =       0.002562753121

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.342647012906
                                         uncertainty =       0.002562753121

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000413906869
  error estimate for blocks of size 2^( 2) =       0.000428057868
  error estimate for blocks of size 2^( 3) =       0.000441511784
  error estimate for blocks of size 2^( 4) =       0.000454778674
  error estimate for blocks of size 2^( 5) =       0.000465837848
  error estimate for blocks of size 2^( 6) =       0.000474130485
  error estimate for blocks of size 2^( 7) =       0.000480162847

      target function =      -0.833472783381
              le_mean =     -16.898836803122
             les_mean =     285.929777336770
             stat err =       0.000468727464
             autocorr =       1.282435504787
   target nu stat err =       0.000468727464
   target dn stat err =       0.003528878773
      target stat err =       0.003954932898
              std dev =       0.585352707838
             le_variance =       0.342637792574

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339026200192
                                         uncertainty =       0.002461760907

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339026200192
                                         uncertainty =       0.002461760907

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000411714733
  error estimate for blocks of size 2^( 2) =       0.000425828556
  error estimate for blocks of size 2^( 3) =       0.000439275510
  error estimate for blocks of size 2^( 4) =       0.000452561097
  error estimate for blocks of size 2^( 5) =       0.000463634161
  error estimate for blocks of size 2^( 6) =       0.000471932927
  error estimate for blocks of size 2^( 7) =       0.000477955139

      target function =      -0.806209724641
              le_mean =     -16.898844567816
             les_mean =     285.954969075771
             stat err =       0.000466520831
             autocorr =       1.283953406926
   target nu stat err =       0.000466520831
   target dn stat err =       0.020767208963
      target stat err =       0.021528866001
              std dev =       0.582252559642
             le_variance =       0.339018043210

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.340948973058
                                         uncertainty =       0.002528720993

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.340948973058
                                         uncertainty =       0.002528720993

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000412880161
  error estimate for blocks of size 2^( 2) =       0.000427003384
  error estimate for blocks of size 2^( 3) =       0.000440447360
  error estimate for blocks of size 2^( 4) =       0.000453714971
  error estimate for blocks of size 2^( 5) =       0.000464793137
  error estimate for blocks of size 2^( 6) =       0.000473138773
  error estimate for blocks of size 2^( 7) =       0.000479052346

      target function =      -0.194499259173
              le_mean =     -16.898827615672
             les_mean =     287.417736187504
             stat err =       0.000467674807
             autocorr =       1.283039183271
   target nu stat err =       0.000467674807
   target dn stat err =       1.487160144160
      target stat err =       0.129052455626
              std dev =       0.583900723967
             le_variance =       0.340940055449

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.342399979901
                                         uncertainty =       0.002556058399

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.342399979901
                                         uncertainty =       0.002556058399

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000413757684
  error estimate for blocks of size 2^( 2) =       0.000427906080
  error estimate for blocks of size 2^( 3) =       0.000441359507
  error estimate for blocks of size 2^( 4) =       0.000454628035
  error estimate for blocks of size 2^( 5) =       0.000465688640
  error estimate for blocks of size 2^( 6) =       0.000473981588
  error estimate for blocks of size 2^( 7) =       0.000480013417

      target function =      -0.834744984008
              le_mean =     -16.898836509827
             les_mean =     285.928620614769
             stat err =       0.000468577920
             autocorr =       1.282541702987
   target nu stat err =       0.000468577920
   target dn stat err =       0.003422767332
      target stat err =       0.003850535857
              std dev =       0.585141728819
             le_variance =       0.342390842805


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.833472783381        initial
     1.5625e+00     1.5625e+01             6.0656e-04        -0.806209724641
     6.2500e+00     6.2500e+01             1.5654e-04        -0.194499259173
     2.5000e+01     2.5000e+02             3.9452e-05        -0.834744984008  <--

*****************************************************************************
Applying the update for shift_i =   2.5000e+01     and shift_s =   2.5000e+02
*****************************************************************************

  Execution time = 2.4807e+01
  </log>
  <optVariables href="H2O.s014.opt.xml">
ci_0001                 6.951914e-01 3 1  ON 0
ci_0002                 6.951871e-01 3 1  ON 1
ci_0003                -4.482709e-02 3 1  ON 2
ci_0004                -4.495440e-02 3 1  ON 3
ci_0005                -4.240217e-02 3 1  ON 4
ci_0006                -4.268866e-02 3 1  ON 5
ci_0007                -3.040385e-02 3 1  ON 6
ci_0008                -3.049757e-02 3 1  ON 7
ci_0009                -2.907391e-02 3 1  ON 8
ci_0010                -2.912735e-02 3 1  ON 9
ci_0011                -2.448175e-02 3 1  ON 10
ci_0012                -2.445229e-02 3 1  ON 11
ci_0013                 2.414705e-02 3 1  ON 12
ci_0014                 2.402280e-02 3 1  ON 13
ci_0015                 2.409248e-02 3 1  ON 14
ci_0016                 2.399957e-02 3 1  ON 15
ci_0017                 2.204090e-02 3 1  ON 16
ci_0018                 2.201807e-02 3 1  ON 17
ci_0019                 1.838167e-02 3 1  ON 18
ci_0020                 1.846928e-02 3 1  ON 19
ci_0021                 1.891842e-02 3 1  ON 20
ci_0022                 1.865926e-02 3 1  ON 21
ci_0023                -1.726988e-02 3 1  ON 22
ci_0024                -1.716865e-02 3 1  ON 23
ci_0025                -1.486753e-02 3 1  ON 24
ci_0026                -1.489044e-02 3 1  ON 25
ci_0027                -1.672700e-02 3 1  ON 26
ci_0028                -1.669805e-02 3 1  ON 27
ci_0029                -1.543734e-02 3 1  ON 28
ci_0030                -1.539290e-02 3 1  ON 29
ci_0031                 1.627988e-02 3 1  ON 30
ci_0032                 1.613326e-02 3 1  ON 31
ci_0033                 1.442788e-02 3 1  ON 32
ci_0034                 1.468825e-02 3 1  ON 33
ci_0035                 1.299362e-02 3 1  ON 34
ci_0036                 1.324143e-02 3 1  ON 35
ci_0037                -1.419639e-02 3 1  ON 36
ci_0038                -1.419006e-02 3 1  ON 37
ci_0039                -1.224736e-02 3 1  ON 38
ci_0040                -1.215395e-02 3 1  ON 39
ci_0041                 1.355816e-02 3 1  ON 40
ci_0042                 1.356922e-02 3 1  ON 41
ci_0043                -1.276465e-02 3 1  ON 42
ci_0044                -1.288532e-02 3 1  ON 43
ci_0045                 1.325525e-02 3 1  ON 44
ci_0046                 1.312196e-02 3 1  ON 45
ci_0047                -1.132051e-02 3 1  ON 46
ci_0048                -1.132762e-02 3 1  ON 47
ci_0049                -1.018044e-02 3 1  ON 48
ci_0050                -1.005333e-02 3 1  ON 49
ci_0051                -9.877714e-03 3 1  ON 50
ci_0052                -9.820858e-03 3 1  ON 51
ci_0053                -1.010142e-02 3 1  ON 52
ci_0054                -9.992853e-03 3 1  ON 53
ci_0055                 9.611733e-03 3 1  ON 54
ci_0056                 9.584491e-03 3 1  ON 55
ci_0057                 9.503460e-03 3 1  ON 56
ci_0058                 9.783117e-03 3 1  ON 57
ci_0059                -9.902608e-03 3 1  ON 58
ci_0060                -9.835094e-03 3 1  ON 59
ci_0061                -9.794070e-03 3 1  ON 60
ci_0062                -9.867565e-03 3 1  ON 61
ci_0063                -1.100959e-02 3 1  ON 62
ci_0064                -1.093389e-02 3 1  ON 63
ci_0065                -1.007913e-02 3 1  ON 64
ci_0066                -1.017248e-02 3 1  ON 65
ci_0067                -9.304601e-03 3 1  ON 66
ci_0068                -9.353830e-03 3 1  ON 67
ci_0069                 8.856096e-03 3 1  ON 68
ci_0070                 8.741646e-03 3 1  ON 69
ci_0071                 9.147637e-03 3 1  ON 70
ci_0072                 9.031509e-03 3 1  ON 71
ci_0073                 8.450895e-03 3 1  ON 72
ci_0074                 8.556957e-03 3 1  ON 73
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 4.2558e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s015 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s015 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=15  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6891e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 15
    time step          = 0.05
    reference energy   = -16.8998
    reference variance = 0.184688
====================================================
  Execution time = 1.4903e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s015
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5178e+04
  VMC Eavg = -1.6899e+01
  VMC Evar = 3.6405e-01
  Total weights = 1.951036675e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 2.6813e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.348304928407
                                         uncertainty =       0.002733417287

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.348304928407
                                         uncertainty =       0.002733417287

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000417322878
  error estimate for blocks of size 2^( 2) =       0.000431175919
  error estimate for blocks of size 2^( 3) =       0.000445318823
  error estimate for blocks of size 2^( 4) =       0.000457573546
  error estimate for blocks of size 2^( 5) =       0.000467979134
  error estimate for blocks of size 2^( 6) =       0.000476666557
  error estimate for blocks of size 2^( 7) =       0.000480520779

      target function =      -0.828027172091
              le_mean =     -16.898937709695
             les_mean =     285.938146527339
             stat err =       0.000470685004
             autocorr =       1.272085597941
   target nu stat err =       0.000470685004
   target dn stat err =       0.003398100076
      target stat err =       0.003764098014
              std dev =       0.590183674408
             le_variance =       0.348316769538


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.689893770969e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 74
Check correct_vf_var_size: 225, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 6.2500e+00, overlap shift 6.2500e+01 and omega -1.7527e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.828043279632       residual = 7.38e-01           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.828495413628       residual = 1.43e-01           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.828590745284       residual = 2.50e-02           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.828613691057       residual = 5.40e-03           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.828618433713       residual = 2.75e-03           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.828620882187       residual = 1.09e-03           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.828622301073       residual = 3.51e-04           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.828622704381       residual = 8.27e-05           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.828622810110       residual = 2.59e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.828622852755       residual = 7.35e-06           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.828622856918       residual = 2.91e-06           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.828622862863       residual = 7.87e-07           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.828622858226       residual = 4.71e-07           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.828622859295       residual = 4.72e-07           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.828622864636       residual = 6.17e-07           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.828622869606       residual = 1.73e-07           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.828622869719       residual = 3.84e-08           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.828622870043       residual = 1.33e-08           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.828622870298       residual = 3.56e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         18 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 6.2500e+00 is 1.595917e-04

solving harmonic davidson linear method for identity shift 2.5000e+01, overlap shift 2.5000e+02 and omega -1.7527e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.828043279632       residual = 7.38e-01           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.828157210568       residual = 1.42e-01           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.828181173552       residual = 2.49e-02           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.828186925607       residual = 5.35e-03           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.828188112227       residual = 2.73e-03           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.828188723896       residual = 1.08e-03           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.828189076891       residual = 3.46e-04           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.828189176908       residual = 8.11e-05           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.828189203045       residual = 2.53e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.828189213566       residual = 7.18e-06           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.828189214563       residual = 2.83e-06           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.828189216023       residual = 7.60e-07           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.828189214875       residual = 4.57e-07           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.828189215148       residual = 4.58e-07           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.828189216473       residual = 5.94e-07           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.828189217688       residual = 1.64e-07           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.828189217713       residual = 3.64e-08           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.828189217792       residual = 1.25e-08           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.828189217855       residual = 3.35e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         18 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 2.5000e+01 is 4.023470e-05

solving harmonic davidson linear method for identity shift 1.0000e+02, overlap shift 1.0000e+03 and omega -1.7527e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.828043279632       residual = 7.38e-01           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.828071818978       residual = 1.42e-01           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.828077817884       residual = 2.48e-02           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.828079256865       residual = 5.34e-03           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.828079553577       residual = 2.72e-03           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.828079706464       residual = 1.07e-03           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.828079794603       residual = 3.45e-04           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.828079819556       residual = 8.07e-05           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.828079826072       residual = 2.51e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.828079828693       residual = 7.14e-06           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.828079828940       residual = 2.81e-06           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.828079829303       residual = 7.54e-07           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.828079829017       residual = 4.53e-07           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.828079829085       residual = 4.55e-07           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.828079829416       residual = 5.88e-07           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.828079829718       residual = 1.61e-07           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.828079829724       residual = 3.60e-08           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.828079829744       residual = 1.24e-08           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.828079829759       residual = 3.29e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         18 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 1.0000e+02 is 1.007993e-05

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.325395 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 75 and numParams is: 74

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.7601e+01
  </log>
  <optVariables href="H2O.s015.opt.xml">
ci_0001                 6.952056e-01 3 1  ON 0
ci_0002                 6.952078e-01 3 1  ON 1
ci_0003                -4.479066e-02 3 1  ON 2
ci_0004                -4.491849e-02 3 1  ON 3
ci_0005                -4.236880e-02 3 1  ON 4
ci_0006                -4.266068e-02 3 1  ON 5
ci_0007                -3.037984e-02 3 1  ON 6
ci_0008                -3.046835e-02 3 1  ON 7
ci_0009                -2.904643e-02 3 1  ON 8
ci_0010                -2.909943e-02 3 1  ON 9
ci_0011                -2.445729e-02 3 1  ON 10
ci_0012                -2.442963e-02 3 1  ON 11
ci_0013                 2.412522e-02 3 1  ON 12
ci_0014                 2.400083e-02 3 1  ON 13
ci_0015                 2.406977e-02 3 1  ON 14
ci_0016                 2.397880e-02 3 1  ON 15
ci_0017                 2.201783e-02 3 1  ON 16
ci_0018                 2.199963e-02 3 1  ON 17
ci_0019                 1.836740e-02 3 1  ON 18
ci_0020                 1.845259e-02 3 1  ON 19
ci_0021                 1.891198e-02 3 1  ON 20
ci_0022                 1.865258e-02 3 1  ON 21
ci_0023                -1.725556e-02 3 1  ON 22
ci_0024                -1.715152e-02 3 1  ON 23
ci_0025                -1.482730e-02 3 1  ON 24
ci_0026                -1.485412e-02 3 1  ON 25
ci_0027                -1.671461e-02 3 1  ON 26
ci_0028                -1.668351e-02 3 1  ON 27
ci_0029                -1.542127e-02 3 1  ON 28
ci_0030                -1.537848e-02 3 1  ON 29
ci_0031                 1.627441e-02 3 1  ON 30
ci_0032                 1.612842e-02 3 1  ON 31
ci_0033                 1.441989e-02 3 1  ON 32
ci_0034                 1.467475e-02 3 1  ON 33
ci_0035                 1.296186e-02 3 1  ON 34
ci_0036                 1.320892e-02 3 1  ON 35
ci_0037                -1.419279e-02 3 1  ON 36
ci_0038                -1.418376e-02 3 1  ON 37
ci_0039                -1.222198e-02 3 1  ON 38
ci_0040                -1.212965e-02 3 1  ON 39
ci_0041                 1.355079e-02 3 1  ON 40
ci_0042                 1.355828e-02 3 1  ON 41
ci_0043                -1.275054e-02 3 1  ON 42
ci_0044                -1.286993e-02 3 1  ON 43
ci_0045                 1.324849e-02 3 1  ON 44
ci_0046                 1.311446e-02 3 1  ON 45
ci_0047                -1.129788e-02 3 1  ON 46
ci_0048                -1.130468e-02 3 1  ON 47
ci_0049                -1.016622e-02 3 1  ON 48
ci_0050                -1.003805e-02 3 1  ON 49
ci_0051                -9.851064e-03 3 1  ON 50
ci_0052                -9.793636e-03 3 1  ON 51
ci_0053                -1.008481e-02 3 1  ON 52
ci_0054                -9.974280e-03 3 1  ON 53
ci_0055                 9.584637e-03 3 1  ON 54
ci_0056                 9.557834e-03 3 1  ON 55
ci_0057                 9.483821e-03 3 1  ON 56
ci_0058                 9.764662e-03 3 1  ON 57
ci_0059                -9.884426e-03 3 1  ON 58
ci_0060                -9.815126e-03 3 1  ON 59
ci_0061                -9.778517e-03 3 1  ON 60
ci_0062                -9.852086e-03 3 1  ON 61
ci_0063                -1.100270e-02 3 1  ON 62
ci_0064                -1.092896e-02 3 1  ON 63
ci_0065                -1.007176e-02 3 1  ON 64
ci_0066                -1.016255e-02 3 1  ON 65
ci_0067                -9.285251e-03 3 1  ON 66
ci_0068                -9.339338e-03 3 1  ON 67
ci_0069                 8.841617e-03 3 1  ON 68
ci_0070                 8.724846e-03 3 1  ON 69
ci_0071                 9.136435e-03 3 1  ON 70
ci_0072                 9.018594e-03 3 1  ON 71
ci_0073                 8.437071e-03 3 1  ON 72
ci_0074                 8.539423e-03 3 1  ON 73
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 15
    time step          = 0.05
    reference energy   = -16.8458
    reference variance = 0.263812
====================================================
  Execution time = 1.4765e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s015
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6898e+01
  VMC Evar = 3.6305e-01
  Total weights = 1.9509e+06
  Execution time = 1.9637e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.344741412065
                                         uncertainty =       0.002465690776

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.344741412065
                                         uncertainty =       0.002465690776

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000415172166
  error estimate for blocks of size 2^( 2) =       0.000429182260
  error estimate for blocks of size 2^( 3) =       0.000443050461
  error estimate for blocks of size 2^( 4) =       0.000456194792
  error estimate for blocks of size 2^( 5) =       0.000467717139
  error estimate for blocks of size 2^( 6) =       0.000476888315
  error estimate for blocks of size 2^( 7) =       0.000485785787

      target function =      -0.828429724278
              le_mean =     -16.898186205432
             les_mean =     285.912336845240
             stat err =       0.000471646508
             autocorr =       1.290555803744
   target nu stat err =       0.000471646508
   target dn stat err =       0.004017749932
      target stat err =       0.004432385658
              std dev =       0.587142107268
             le_variance =       0.344735854127

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.343769912458
                                         uncertainty =       0.002457590776

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.343769912458
                                         uncertainty =       0.002457590776

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000414587026
  error estimate for blocks of size 2^( 2) =       0.000428587220
  error estimate for blocks of size 2^( 3) =       0.000442452665
  error estimate for blocks of size 2^( 4) =       0.000455598326
  error estimate for blocks of size 2^( 5) =       0.000467125306
  error estimate for blocks of size 2^( 6) =       0.000476304573
  error estimate for blocks of size 2^( 7) =       0.000485216829

      target function =      -0.829286657094
              le_mean =     -16.898191576795
             les_mean =     285.911736664562
             stat err =       0.000471061258
             autocorr =       1.290991434445
   target nu stat err =       0.000471061258
   target dn stat err =       0.003847324856
      target stat err =       0.004256766502
              std dev =       0.586314595201
             le_variance =       0.343764804546

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.344248458567
                                         uncertainty =       0.002461552160

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.344248458567
                                         uncertainty =       0.002461552160

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000414875360
  error estimate for blocks of size 2^( 2) =       0.000428880441
  error estimate for blocks of size 2^( 3) =       0.000442747244
  error estimate for blocks of size 2^( 4) =       0.000455892208
  error estimate for blocks of size 2^( 5) =       0.000467416825
  error estimate for blocks of size 2^( 6) =       0.000476592141
  error estimate for blocks of size 2^( 7) =       0.000485496917

      target function =      -0.829482166710
              le_mean =     -16.898188667771
             les_mean =     285.911459636181
             stat err =       0.000471349523
             autocorr =       1.290775932214
   target nu stat err =       0.000471349523
   target dn stat err =       0.003845085909
      target stat err =       0.004256362774
              std dev =       0.586722360704
             le_variance =       0.344243128550

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.344680092948
                                         uncertainty =       0.002465345688

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.344680092948
                                         uncertainty =       0.002465345688

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000415135256
  error estimate for blocks of size 2^( 2) =       0.000429144956
  error estimate for blocks of size 2^( 3) =       0.000443013443
  error estimate for blocks of size 2^( 4) =       0.000456157167
  error estimate for blocks of size 2^( 5) =       0.000467679266
  error estimate for blocks of size 2^( 6) =       0.000476847855
  error estimate for blocks of size 2^( 7) =       0.000485747537

      target function =      -0.125414468509
              le_mean =     -16.898187126463
             les_mean =     288.326477395464
             stat err =       0.000471607956
             autocorr =       1.290574292157
   target nu stat err =       0.000471607956
   target dn stat err =       2.415492991986
      target stat err =       0.095487430480
              std dev =       0.587089909673
             le_variance =       0.344674562040


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.828429724278        initial
     6.2500e+00     6.2500e+01             1.5959e-04        -0.829286657094
     2.5000e+01     2.5000e+02             4.0235e-05        -0.829482166710  <--
     1.0000e+02     1.0000e+03             1.0080e-05        -0.125414468509

*****************************************************************************
Applying the update for shift_i =   2.5000e+01     and shift_s =   2.5000e+02
*****************************************************************************

  Execution time = 2.4696e+01
  </log>
  <optVariables href="H2O.s015.opt.xml">
ci_0001                 6.952056e-01 3 1  ON 0
ci_0002                 6.952078e-01 3 1  ON 1
ci_0003                -4.479066e-02 3 1  ON 2
ci_0004                -4.491849e-02 3 1  ON 3
ci_0005                -4.236880e-02 3 1  ON 4
ci_0006                -4.266068e-02 3 1  ON 5
ci_0007                -3.037984e-02 3 1  ON 6
ci_0008                -3.046835e-02 3 1  ON 7
ci_0009                -2.904643e-02 3 1  ON 8
ci_0010                -2.909943e-02 3 1  ON 9
ci_0011                -2.445729e-02 3 1  ON 10
ci_0012                -2.442963e-02 3 1  ON 11
ci_0013                 2.412522e-02 3 1  ON 12
ci_0014                 2.400083e-02 3 1  ON 13
ci_0015                 2.406977e-02 3 1  ON 14
ci_0016                 2.397880e-02 3 1  ON 15
ci_0017                 2.201783e-02 3 1  ON 16
ci_0018                 2.199963e-02 3 1  ON 17
ci_0019                 1.836740e-02 3 1  ON 18
ci_0020                 1.845259e-02 3 1  ON 19
ci_0021                 1.891198e-02 3 1  ON 20
ci_0022                 1.865258e-02 3 1  ON 21
ci_0023                -1.725556e-02 3 1  ON 22
ci_0024                -1.715152e-02 3 1  ON 23
ci_0025                -1.482730e-02 3 1  ON 24
ci_0026                -1.485412e-02 3 1  ON 25
ci_0027                -1.671461e-02 3 1  ON 26
ci_0028                -1.668351e-02 3 1  ON 27
ci_0029                -1.542127e-02 3 1  ON 28
ci_0030                -1.537848e-02 3 1  ON 29
ci_0031                 1.627441e-02 3 1  ON 30
ci_0032                 1.612842e-02 3 1  ON 31
ci_0033                 1.441989e-02 3 1  ON 32
ci_0034                 1.467475e-02 3 1  ON 33
ci_0035                 1.296186e-02 3 1  ON 34
ci_0036                 1.320892e-02 3 1  ON 35
ci_0037                -1.419279e-02 3 1  ON 36
ci_0038                -1.418376e-02 3 1  ON 37
ci_0039                -1.222198e-02 3 1  ON 38
ci_0040                -1.212965e-02 3 1  ON 39
ci_0041                 1.355079e-02 3 1  ON 40
ci_0042                 1.355828e-02 3 1  ON 41
ci_0043                -1.275054e-02 3 1  ON 42
ci_0044                -1.286993e-02 3 1  ON 43
ci_0045                 1.324849e-02 3 1  ON 44
ci_0046                 1.311446e-02 3 1  ON 45
ci_0047                -1.129788e-02 3 1  ON 46
ci_0048                -1.130468e-02 3 1  ON 47
ci_0049                -1.016622e-02 3 1  ON 48
ci_0050                -1.003805e-02 3 1  ON 49
ci_0051                -9.851064e-03 3 1  ON 50
ci_0052                -9.793636e-03 3 1  ON 51
ci_0053                -1.008481e-02 3 1  ON 52
ci_0054                -9.974280e-03 3 1  ON 53
ci_0055                 9.584637e-03 3 1  ON 54
ci_0056                 9.557834e-03 3 1  ON 55
ci_0057                 9.483821e-03 3 1  ON 56
ci_0058                 9.764662e-03 3 1  ON 57
ci_0059                -9.884426e-03 3 1  ON 58
ci_0060                -9.815126e-03 3 1  ON 59
ci_0061                -9.778517e-03 3 1  ON 60
ci_0062                -9.852086e-03 3 1  ON 61
ci_0063                -1.100270e-02 3 1  ON 62
ci_0064                -1.092896e-02 3 1  ON 63
ci_0065                -1.007176e-02 3 1  ON 64
ci_0066                -1.016255e-02 3 1  ON 65
ci_0067                -9.285251e-03 3 1  ON 66
ci_0068                -9.339338e-03 3 1  ON 67
ci_0069                 8.841617e-03 3 1  ON 68
ci_0070                 8.724846e-03 3 1  ON 69
ci_0071                 9.136435e-03 3 1  ON 70
ci_0072                 9.018594e-03 3 1  ON 71
ci_0073                 8.437071e-03 3 1  ON 72
ci_0074                 8.539423e-03 3 1  ON 73
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 4.2302e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s016 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s016 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=16  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6890e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 16
    time step          = 0.05
    reference energy   = -16.954
    reference variance = 0.366272
====================================================
  Execution time = 1.5152e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s016
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5225e+04
  VMC Eavg = -1.6898e+01
  VMC Evar = 3.6368e-01
  Total weights = 1.950950273e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 2.6963e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.345066994034
                                         uncertainty =       0.002408644607

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.345066994034
                                         uncertainty =       0.002408644607

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000415330215
  error estimate for blocks of size 2^( 2) =       0.000429450425
  error estimate for blocks of size 2^( 3) =       0.000443671121
  error estimate for blocks of size 2^( 4) =       0.000457058902
  error estimate for blocks of size 2^( 5) =       0.000467766616
  error estimate for blocks of size 2^( 6) =       0.000475211393
  error estimate for blocks of size 2^( 7) =       0.000481678891

      target function =      -0.828333737848
              le_mean =     -16.898081660508
             les_mean =     285.908844838957
             stat err =       0.000470428950
             autocorr =       1.282924284585
   target nu stat err =       0.000470428950
   target dn stat err =       0.006904207423
      target stat err =       0.007564262660
              std dev =       0.587365623620
             le_variance =       0.344998375810


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.689808166051e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 74
Check correct_vf_var_size: 225, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 6.2500e+00, overlap shift 6.2500e+01 and omega -1.7527e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.828401732842       residual = 6.83e-01           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.828869261582       residual = 1.22e-01           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.828948938016       residual = 2.19e-02           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.828969319514       residual = 4.54e-03           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.828974312217       residual = 1.98e-03           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.828976071068       residual = 1.17e-03           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.828977290621       residual = 3.28e-04           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.828977654840       residual = 9.52e-05           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.828977775956       residual = 4.05e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.828977789609       residual = 2.15e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.828977846492       residual = 2.00e-05           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.828977842584       residual = 1.22e-05           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.828977862334       residual = 1.37e-05           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.828977915062       residual = 4.84e-06           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.828977942934       residual = 1.56e-06           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.828977943101       residual = 1.97e-07           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.828977944151       residual = 7.13e-08           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.828977943268       residual = 1.95e-08           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.828977943515       residual = 7.07e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         18 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 6.2500e+00 is 1.690654e-04

solving harmonic davidson linear method for identity shift 2.5000e+01, overlap shift 2.5000e+02 and omega -1.7527e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.828401732842       residual = 6.83e-01           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.828519523178       residual = 1.22e-01           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.828539549686       residual = 2.18e-02           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.828544657693       residual = 4.51e-03           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.828545907179       residual = 1.96e-03           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.828546346323       residual = 1.16e-03           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.828546649548       residual = 3.23e-04           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.828546739874       residual = 9.36e-05           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.828546769809       residual = 3.98e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.828546773114       residual = 2.11e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.828546787269       residual = 1.96e-05           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.828546786256       residual = 1.19e-05           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.828546791218       residual = 1.33e-05           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.828546804258       residual = 4.65e-06           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.828546811059       residual = 1.47e-06           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.828546811076       residual = 1.86e-07           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.828546811331       residual = 6.76e-08           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.828546811114       residual = 1.84e-08           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.828546811175       residual = 6.65e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         18 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 2.5000e+01 is 4.261249e-05

solving harmonic davidson linear method for identity shift 1.0000e+02, overlap shift 1.0000e+03 and omega -1.7527e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.828401732842       residual = 6.83e-01           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.828431237699       residual = 1.22e-01           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.828436251064       residual = 2.18e-02           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.828437528847       residual = 4.50e-03           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.828437841297       residual = 1.96e-03           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.828437951046       residual = 1.15e-03           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.828438026746       residual = 3.22e-04           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.828438049282       residual = 9.32e-05           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.828438056744       residual = 3.96e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.828438057563       residual = 2.11e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.828438061098       residual = 1.96e-05           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.828438060842       residual = 1.19e-05           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.828438062084       residual = 1.32e-05           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.828438065335       residual = 4.60e-06           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.828438067025       residual = 1.46e-06           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.828438067028       residual = 1.84e-07           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.828438067091       residual = 6.67e-08           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.828438067037       residual = 1.81e-08           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.828438067052       residual = 6.55e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         18 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 1.0000e+02 is 1.067496e-05

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.336806 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 75 and numParams is: 74

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.7866e+01
  </log>
  <optVariables href="H2O.s016.opt.xml">
ci_0001                 6.952389e-01 3 1  ON 0
ci_0002                 6.952092e-01 3 1  ON 1
ci_0003                -4.475662e-02 3 1  ON 2
ci_0004                -4.488359e-02 3 1  ON 3
ci_0005                -4.234113e-02 3 1  ON 4
ci_0006                -4.263162e-02 3 1  ON 5
ci_0007                -3.034738e-02 3 1  ON 6
ci_0008                -3.044152e-02 3 1  ON 7
ci_0009                -2.902185e-02 3 1  ON 8
ci_0010                -2.906408e-02 3 1  ON 9
ci_0011                -2.443684e-02 3 1  ON 10
ci_0012                -2.440761e-02 3 1  ON 11
ci_0013                 2.410347e-02 3 1  ON 12
ci_0014                 2.397137e-02 3 1  ON 13
ci_0015                 2.405000e-02 3 1  ON 14
ci_0016                 2.396206e-02 3 1  ON 15
ci_0017                 2.199603e-02 3 1  ON 16
ci_0018                 2.198003e-02 3 1  ON 17
ci_0019                 1.834943e-02 3 1  ON 18
ci_0020                 1.843436e-02 3 1  ON 19
ci_0021                 1.891083e-02 3 1  ON 20
ci_0022                 1.865634e-02 3 1  ON 21
ci_0023                -1.723784e-02 3 1  ON 22
ci_0024                -1.713491e-02 3 1  ON 23
ci_0025                -1.478991e-02 3 1  ON 24
ci_0026                -1.481151e-02 3 1  ON 25
ci_0027                -1.669968e-02 3 1  ON 26
ci_0028                -1.666673e-02 3 1  ON 27
ci_0029                -1.540617e-02 3 1  ON 28
ci_0030                -1.536268e-02 3 1  ON 29
ci_0031                 1.627032e-02 3 1  ON 30
ci_0032                 1.612263e-02 3 1  ON 31
ci_0033                 1.440961e-02 3 1  ON 32
ci_0034                 1.466328e-02 3 1  ON 33
ci_0035                 1.294002e-02 3 1  ON 34
ci_0036                 1.318120e-02 3 1  ON 35
ci_0037                -1.418562e-02 3 1  ON 36
ci_0038                -1.417231e-02 3 1  ON 37
ci_0039                -1.219633e-02 3 1  ON 38
ci_0040                -1.210397e-02 3 1  ON 39
ci_0041                 1.354258e-02 3 1  ON 40
ci_0042                 1.354955e-02 3 1  ON 41
ci_0043                -1.274140e-02 3 1  ON 42
ci_0044                -1.286052e-02 3 1  ON 43
ci_0045                 1.323743e-02 3 1  ON 44
ci_0046                 1.310672e-02 3 1  ON 45
ci_0047                -1.127481e-02 3 1  ON 46
ci_0048                -1.128121e-02 3 1  ON 47
ci_0049                -1.014475e-02 3 1  ON 48
ci_0050                -1.001089e-02 3 1  ON 49
ci_0051                -9.824584e-03 3 1  ON 50
ci_0052                -9.767796e-03 3 1  ON 51
ci_0053                -1.006651e-02 3 1  ON 52
ci_0054                -9.953357e-03 3 1  ON 53
ci_0055                 9.562065e-03 3 1  ON 54
ci_0056                 9.534708e-03 3 1  ON 55
ci_0057                 9.462296e-03 3 1  ON 56
ci_0058                 9.738998e-03 3 1  ON 57
ci_0059                -9.867449e-03 3 1  ON 58
ci_0060                -9.789674e-03 3 1  ON 59
ci_0061                -9.761446e-03 3 1  ON 60
ci_0062                -9.833139e-03 3 1  ON 61
ci_0063                -1.099933e-02 3 1  ON 62
ci_0064                -1.092433e-02 3 1  ON 63
ci_0065                -1.006612e-02 3 1  ON 64
ci_0066                -1.015578e-02 3 1  ON 65
ci_0067                -9.267382e-03 3 1  ON 66
ci_0068                -9.322473e-03 3 1  ON 67
ci_0069                 8.826334e-03 3 1  ON 68
ci_0070                 8.710504e-03 3 1  ON 69
ci_0071                 9.122111e-03 3 1  ON 70
ci_0072                 9.004748e-03 3 1  ON 71
ci_0073                 8.423932e-03 3 1  ON 72
ci_0074                 8.520417e-03 3 1  ON 73
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 16
    time step          = 0.05
    reference energy   = -16.8727
    reference variance = 0.379535
====================================================
  Execution time = 1.4682e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s016
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6897e+01
  VMC Evar = 3.6110e-01
  Total weights = 1.9508e+06
  Execution time = 1.9510e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.346988556723
                                         uncertainty =       0.002695215245

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.346988556723
                                         uncertainty =       0.002695215245

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000416507864
  error estimate for blocks of size 2^( 2) =       0.000430702463
  error estimate for blocks of size 2^( 3) =       0.000445223785
  error estimate for blocks of size 2^( 4) =       0.000458466996
  error estimate for blocks of size 2^( 5) =       0.000470119681
  error estimate for blocks of size 2^( 6) =       0.000480493358
  error estimate for blocks of size 2^( 7) =       0.000483944072

      target function =      -0.830676070374
              le_mean =     -16.897370823059
             les_mean =     285.882689640961
             stat err =       0.000473256027
             autocorr =       1.291058422194
   target nu stat err =       0.000473256027
   target dn stat err =       0.003624955049
      target stat err =       0.004024626142
              std dev =       0.589031070225
             le_variance =       0.346957601691

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.345994815125
                                         uncertainty =       0.002671604450

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.345994815125
                                         uncertainty =       0.002671604450

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000415911122
  error estimate for blocks of size 2^( 2) =       0.000430093160
  error estimate for blocks of size 2^( 3) =       0.000444613372
  error estimate for blocks of size 2^( 4) =       0.000457861009
  error estimate for blocks of size 2^( 5) =       0.000469524251
  error estimate for blocks of size 2^( 6) =       0.000479905073
  error estimate for blocks of size 2^( 7) =       0.000483349109

      target function =      -0.831503305717
              le_mean =     -16.897370014489
             les_mean =     285.881908176949
             stat err =       0.000472659860
             autocorr =       1.291505844173
   target nu stat err =       0.000472659860
   target dn stat err =       0.003686018478
      target stat err =       0.004098735626
              std dev =       0.588187149952
             le_variance =       0.345964123368

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.346484957988
                                         uncertainty =       0.002683152615

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.346484957988
                                         uncertainty =       0.002683152615

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000416205561
  error estimate for blocks of size 2^( 2) =       0.000430393779
  error estimate for blocks of size 2^( 3) =       0.000444914475
  error estimate for blocks of size 2^( 4) =       0.000458159831
  error estimate for blocks of size 2^( 5) =       0.000469817797
  error estimate for blocks of size 2^( 6) =       0.000480195273
  error estimate for blocks of size 2^( 7) =       0.000483642539

      target function =      -0.831362883927
              le_mean =     -16.897370116147
             les_mean =     285.882039909969
             stat err =       0.000472953860
             autocorr =       1.291284066499
   target nu stat err =       0.000472953860
   target dn stat err =       0.003634864267
      target stat err =       0.004041893077
              std dev =       0.588603548805
             le_variance =       0.346454137665

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.346925150941
                                         uncertainty =       0.002693685636

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.346925150941
                                         uncertainty =       0.002693685636

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000416469815
  error estimate for blocks of size 2^( 2) =       0.000430663610
  error estimate for blocks of size 2^( 3) =       0.000445184826
  error estimate for blocks of size 2^( 4) =       0.000458428278
  error estimate for blocks of size 2^( 5) =       0.000470081629
  error estimate for blocks of size 2^( 6) =       0.000480455815
  error estimate for blocks of size 2^( 7) =       0.000483906041

      target function =      -0.830879154460
              le_mean =     -16.897370682084
             les_mean =     285.882499825498
             stat err =       0.000473217941
             autocorr =       1.291086510116
   target nu stat err =       0.000473217941
   target dn stat err =       0.003616584737
      target stat err =       0.004017488036
              std dev =       0.588977260193
             le_variance =       0.346894213024


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.830676070374        initial
     6.2500e+00     6.2500e+01             1.6907e-04        -0.831503305717  <--
     2.5000e+01     2.5000e+02             4.2612e-05        -0.831362883927
     1.0000e+02     1.0000e+03             1.0675e-05        -0.830879154460

*****************************************************************************
Applying the update for shift_i =   6.2500e+00     and shift_s =   6.2500e+01
*****************************************************************************

  Execution time = 2.4575e+01
  </log>
  <optVariables href="H2O.s016.opt.xml">
ci_0001                 6.953385e-01 3 1  ON 0
ci_0002                 6.952129e-01 3 1  ON 1
ci_0003                -4.465537e-02 3 1  ON 2
ci_0004                -4.477975e-02 3 1  ON 3
ci_0005                -4.225868e-02 3 1  ON 4
ci_0006                -4.254498e-02 3 1  ON 5
ci_0007                -3.025048e-02 3 1  ON 6
ci_0008                -3.036147e-02 3 1  ON 7
ci_0009                -2.894882e-02 3 1  ON 8
ci_0010                -2.895900e-02 3 1  ON 9
ci_0011                -2.437606e-02 3 1  ON 10
ci_0012                -2.434213e-02 3 1  ON 11
ci_0013                 2.403881e-02 3 1  ON 12
ci_0014                 2.388376e-02 3 1  ON 13
ci_0015                 2.399123e-02 3 1  ON 14
ci_0016                 2.391229e-02 3 1  ON 15
ci_0017                 2.193126e-02 3 1  ON 16
ci_0018                 2.192176e-02 3 1  ON 17
ci_0019                 1.829607e-02 3 1  ON 18
ci_0020                 1.838019e-02 3 1  ON 19
ci_0021                 1.890739e-02 3 1  ON 20
ci_0022                 1.866748e-02 3 1  ON 21
ci_0023                -1.718521e-02 3 1  ON 22
ci_0024                -1.708555e-02 3 1  ON 23
ci_0025                -1.467896e-02 3 1  ON 24
ci_0026                -1.468506e-02 3 1  ON 25
ci_0027                -1.665535e-02 3 1  ON 26
ci_0028                -1.661686e-02 3 1  ON 27
ci_0029                -1.536133e-02 3 1  ON 28
ci_0030                -1.531575e-02 3 1  ON 29
ci_0031                 1.625810e-02 3 1  ON 30
ci_0032                 1.610536e-02 3 1  ON 31
ci_0033                 1.437896e-02 3 1  ON 32
ci_0034                 1.462906e-02 3 1  ON 33
ci_0035                 1.287522e-02 3 1  ON 34
ci_0036                 1.309893e-02 3 1  ON 35
ci_0037                -1.416429e-02 3 1  ON 36
ci_0038                -1.413823e-02 3 1  ON 37
ci_0039                -1.212016e-02 3 1  ON 38
ci_0040                -1.202773e-02 3 1  ON 39
ci_0041                 1.351814e-02 3 1  ON 40
ci_0042                 1.352357e-02 3 1  ON 41
ci_0043                -1.271416e-02 3 1  ON 42
ci_0044                -1.283246e-02 3 1  ON 43
ci_0045                 1.320447e-02 3 1  ON 44
ci_0046                 1.308368e-02 3 1  ON 45
ci_0047                -1.120634e-02 3 1  ON 46
ci_0048                -1.121151e-02 3 1  ON 47
ci_0049                -1.008103e-02 3 1  ON 48
ci_0050                -9.930298e-03 3 1  ON 49
ci_0051                -9.746059e-03 3 1  ON 50
ci_0052                -9.691164e-03 3 1  ON 51
ci_0053                -1.001219e-02 3 1  ON 52
ci_0054                -9.891267e-03 3 1  ON 53
ci_0055                 9.495089e-03 3 1  ON 54
ci_0056                 9.466095e-03 3 1  ON 55
ci_0057                 9.398421e-03 3 1  ON 56
ci_0058                 9.662840e-03 3 1  ON 57
ci_0059                -9.817069e-03 3 1  ON 58
ci_0060                -9.714160e-03 3 1  ON 59
ci_0061                -9.710695e-03 3 1  ON 60
ci_0062                -9.776817e-03 3 1  ON 61
ci_0063                -1.098932e-02 3 1  ON 62
ci_0064                -1.091057e-02 3 1  ON 63
ci_0065                -1.004936e-02 3 1  ON 64
ci_0066                -1.013565e-02 3 1  ON 65
ci_0067                -9.214368e-03 3 1  ON 66
ci_0068                -9.272428e-03 3 1  ON 67
ci_0069                 8.780984e-03 3 1  ON 68
ci_0070                 8.667946e-03 3 1  ON 69
ci_0071                 9.079582e-03 3 1  ON 70
ci_0072                 8.963644e-03 3 1  ON 71
ci_0073                 8.384952e-03 3 1  ON 72
ci_0074                 8.464036e-03 3 1  ON 73
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 4.2447e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s017 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s017 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=17  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6891e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 17
    time step          = 0.05
    reference energy   = -16.9018
    reference variance = 0.354313
====================================================
  Execution time = 1.7635e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s017
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5268e+04
  VMC Eavg = -1.6898e+01
  VMC Evar = 8.4430e-01
  Total weights = 1.951094948e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 2.7114e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.834460287444
                                         uncertainty =       0.489694348000

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.834460287444
                                         uncertainty =       0.489694348000

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000645264435
  error estimate for blocks of size 2^( 2) =       0.000654367658
  error estimate for blocks of size 2^( 3) =       0.000663093292
  error estimate for blocks of size 2^( 4) =       0.000671569434
  error estimate for blocks of size 2^( 5) =       0.000680392821
  error estimate for blocks of size 2^( 6) =       0.000687745576
  error estimate for blocks of size 2^( 7) =       0.000695277090

      target function =      -0.440803478641
              le_mean =     -16.898039015913
             les_mean =     286.388024247613
             stat err =       0.000683746230
             autocorr =       1.122831096317
   target nu stat err =       0.000683746230
   target dn stat err =       0.481419988679
      target stat err =       0.171238363994
              std dev =       0.912541715588
             le_variance =       0.832732382688


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.689803901591e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 74
Check correct_vf_var_size: 225, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.5625e+00, overlap shift 1.5625e+01 and omega -1.7527e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.507127750741       residual = 2.04e+02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.517422975091       residual = 4.00e-01           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.518378331870       residual = 9.19e-02           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.518596960367       residual = 1.67e-02           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.518651517836       residual = 4.83e-03           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.518664775087       residual = 1.57e-03           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.518670669114       residual = 6.03e-04           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.518674384772       residual = 2.50e-04           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.518675729394       residual = 5.54e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.518675949280       residual = 1.75e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.518676134764       residual = 5.86e-06           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.518676155250       residual = 3.10e-06           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.518676141537       residual = 1.45e-06           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.518676160871       residual = 1.29e-06           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.518676191372       residual = 1.22e-06           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.518676220153       residual = 9.42e-07           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.518676253424       residual = 1.72e-07           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.518676255902       residual = 3.29e-08           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.518676252440       residual = 1.42e-08           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.518676250122       residual = 3.66e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         19 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 1.5625e+00 is 8.330072e-04

solving harmonic davidson linear method for identity shift 6.2500e+00, overlap shift 6.2500e+01 and omega -1.7527e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.507127750741       residual = 2.04e+02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.509725774681       residual = 3.88e-01           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.509961644017       residual = 8.83e-02           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.510015130326       residual = 1.60e-02           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.510028353109       residual = 4.54e-03           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.510031532864       residual = 1.48e-03           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.510032943784       residual = 5.62e-04           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.510033822499       residual = 2.29e-04           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.510034137301       residual = 5.01e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.510034187673       residual = 1.57e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.510034230778       residual = 5.26e-06           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.510034235110       residual = 2.75e-06           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.510034231756       residual = 1.29e-06           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.510034236495       residual = 1.17e-06           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.510034243877       residual = 1.08e-06           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.510034250568       residual = 7.90e-07           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.510034257855       residual = 1.34e-07           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.510034258316       residual = 2.62e-08           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.510034257519       residual = 1.13e-08           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.510034256997       residual = 2.85e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         19 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 6.2500e+00 is 2.134089e-04

solving harmonic davidson linear method for identity shift 2.5000e+01, overlap shift 2.5000e+02 and omega -1.7527e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.507127750741       residual = 2.04e+02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.507778713140       residual = 3.85e-01           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.507837475805       residual = 8.74e-02           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.507850769770       residual = 1.58e-02           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.507854048411       residual = 4.47e-03           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.507854834752       residual = 1.46e-03           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.507855183493       residual = 5.52e-04           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.507855400016       residual = 2.24e-04           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.507855477389       residual = 4.88e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.507855489700       residual = 1.52e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.507855500276       residual = 5.12e-06           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.507855501312       residual = 2.66e-06           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.507855500479       residual = 1.25e-06           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.507855501657       residual = 1.14e-06           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.507855503487       residual = 1.04e-06           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.507855505128       residual = 7.55e-07           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.507855506889       residual = 1.26e-07           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.507855506995       residual = 2.48e-08           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.507855506800       residual = 1.07e-08           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.507855506673       residual = 2.67e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         19 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 2.5000e+01 is 5.367763e-05

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.349652 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 75 and numParams is: 74

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.0365e+01
  </log>
  <optVariables href="H2O.s017.opt.xml">
ci_0001                 6.953802e-01 3 1  ON 0
ci_0002                 6.953039e-01 3 1  ON 1
ci_0003                -4.453445e-02 3 1  ON 2
ci_0004                -4.466449e-02 3 1  ON 3
ci_0005                -4.213559e-02 3 1  ON 4
ci_0006                -4.243652e-02 3 1  ON 5
ci_0007                -3.016230e-02 3 1  ON 6
ci_0008                -3.028449e-02 3 1  ON 7
ci_0009                -2.885159e-02 3 1  ON 8
ci_0010                -2.885156e-02 3 1  ON 9
ci_0011                -2.426975e-02 3 1  ON 10
ci_0012                -2.423700e-02 3 1  ON 11
ci_0013                 2.392404e-02 3 1  ON 12
ci_0014                 2.379218e-02 3 1  ON 13
ci_0015                 2.390583e-02 3 1  ON 14
ci_0016                 2.383808e-02 3 1  ON 15
ci_0017                 2.184652e-02 3 1  ON 16
ci_0018                 2.183228e-02 3 1  ON 17
ci_0019                 1.822824e-02 3 1  ON 18
ci_0020                 1.829427e-02 3 1  ON 19
ci_0021                 1.891008e-02 3 1  ON 20
ci_0022                 1.868159e-02 3 1  ON 21
ci_0023                -1.713813e-02 3 1  ON 22
ci_0024                -1.703345e-02 3 1  ON 23
ci_0025                -1.453055e-02 3 1  ON 24
ci_0026                -1.455375e-02 3 1  ON 25
ci_0027                -1.659589e-02 3 1  ON 26
ci_0028                -1.655937e-02 3 1  ON 27
ci_0029                -1.514792e-02 3 1  ON 28
ci_0030                -1.525511e-02 3 1  ON 29
ci_0031                 1.624308e-02 3 1  ON 30
ci_0032                 1.609668e-02 3 1  ON 31
ci_0033                 1.431262e-02 3 1  ON 32
ci_0034                 1.457334e-02 3 1  ON 33
ci_0035                 1.277594e-02 3 1  ON 34
ci_0036                 1.301528e-02 3 1  ON 35
ci_0037                -1.413391e-02 3 1  ON 36
ci_0038                -1.411558e-02 3 1  ON 37
ci_0039                -1.202408e-02 3 1  ON 38
ci_0040                -1.193198e-02 3 1  ON 39
ci_0041                 1.347507e-02 3 1  ON 40
ci_0042                 1.348558e-02 3 1  ON 41
ci_0043                -1.262574e-02 3 1  ON 42
ci_0044                -1.279695e-02 3 1  ON 43
ci_0045                 1.317950e-02 3 1  ON 44
ci_0046                 1.305075e-02 3 1  ON 45
ci_0047                -1.111724e-02 3 1  ON 46
ci_0048                -1.112237e-02 3 1  ON 47
ci_0049                -9.997351e-03 3 1  ON 48
ci_0050                -9.861786e-03 3 1  ON 49
ci_0051                -9.646151e-03 3 1  ON 50
ci_0052                -9.605035e-03 3 1  ON 51
ci_0053                -9.949461e-03 3 1  ON 52
ci_0054                -9.828681e-03 3 1  ON 53
ci_0055                 9.401072e-03 3 1  ON 54
ci_0056                 9.393401e-03 3 1  ON 55
ci_0057                 9.288091e-03 3 1  ON 56
ci_0058                 9.614348e-03 3 1  ON 57
ci_0059                -9.747449e-03 3 1  ON 58
ci_0060                -9.646024e-03 3 1  ON 59
ci_0061                -9.644463e-03 3 1  ON 60
ci_0062                -9.717875e-03 3 1  ON 61
ci_0063                -1.096232e-02 3 1  ON 62
ci_0064                -1.089960e-02 3 1  ON 63
ci_0065                -1.001073e-02 3 1  ON 64
ci_0066                -1.010544e-02 3 1  ON 65
ci_0067                -9.132626e-03 3 1  ON 66
ci_0068                -9.212884e-03 3 1  ON 67
ci_0069                 8.683674e-03 3 1  ON 68
ci_0070                 8.600785e-03 3 1  ON 69
ci_0071                 9.058820e-03 3 1  ON 70
ci_0072                 8.919954e-03 3 1  ON 71
ci_0073                 8.314635e-03 3 1  ON 72
ci_0074                 8.409460e-03 3 1  ON 73
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 17
    time step          = 0.05
    reference energy   = -16.8149
    reference variance = 0.323343
====================================================
  Execution time = 1.4666e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s017
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6898e+01
  VMC Evar = 3.7075e-01
  Total weights = 1.9509e+06
  Execution time = 1.9766e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.353714555766
                                         uncertainty =       0.008902217409

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.353714555766
                                         uncertainty =       0.008902217409

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000420499152
  error estimate for blocks of size 2^( 2) =       0.000434975004
  error estimate for blocks of size 2^( 3) =       0.000449443227
  error estimate for blocks of size 2^( 4) =       0.000462078842
  error estimate for blocks of size 2^( 5) =       0.000474006505
  error estimate for blocks of size 2^( 6) =       0.000484001135
  error estimate for blocks of size 2^( 7) =       0.000489667144

      target function =      -0.811553324465
              le_mean =     -16.898388138028
             les_mean =     285.934702927370
             stat err =       0.000477438406
             autocorr =       1.289152975721
   target nu stat err =       0.000477438406
   target dn stat err =       0.014080558801
      target stat err =       0.014781911357
              std dev =       0.594675603519
             le_variance =       0.353639073421

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.349255804780
                                         uncertainty =       0.008095491759

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.349255804780
                                         uncertainty =       0.008095491759

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000417841400
  error estimate for blocks of size 2^( 2) =       0.000432295221
  error estimate for blocks of size 2^( 3) =       0.000446791248
  error estimate for blocks of size 2^( 4) =       0.000459465040
  error estimate for blocks of size 2^( 5) =       0.000471450511
  error estimate for blocks of size 2^( 6) =       0.000481498757
  error estimate for blocks of size 2^( 7) =       0.000487157766

      target function =      -0.824438248410
              le_mean =     -16.898413979525
             les_mean =     285.923557291132
             stat err =       0.000474893018
             autocorr =       1.291720744692
   target nu stat err =       0.000474893018
   target dn stat err =       0.011704302909
      target stat err =       0.012684159333
              std dev =       0.590916974486
             le_variance =       0.349182870735

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.351389735272
                                         uncertainty =       0.008476213233

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.351389735272
                                         uncertainty =       0.008476213233

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000419115504
  error estimate for blocks of size 2^( 2) =       0.000433582012
  error estimate for blocks of size 2^( 3) =       0.000448064815
  error estimate for blocks of size 2^( 4) =       0.000460720976
  error estimate for blocks of size 2^( 5) =       0.000472673742
  error estimate for blocks of size 2^( 6) =       0.000482698052
  error estimate for blocks of size 2^( 7) =       0.000488362402

      target function =      -0.822034455483
              le_mean =     -16.898395977839
             les_mean =     285.925158346585
             stat err =       0.000476113793
             autocorr =       1.290488304996
   target nu stat err =       0.000476113793
   target dn stat err =       0.012279775340
      target stat err =       0.013228933764
              std dev =       0.592718829804
             le_variance =       0.351315611205

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.353415729195
                                         uncertainty =       0.008846915881

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.353415729195
                                         uncertainty =       0.008846915881

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000420321559
  error estimate for blocks of size 2^( 2) =       0.000434797623
  error estimate for blocks of size 2^( 3) =       0.000449268423
  error estimate for blocks of size 2^( 4) =       0.000461907984
  error estimate for blocks of size 2^( 5) =       0.000473839036
  error estimate for blocks of size 2^( 6) =       0.000483839090
  error estimate for blocks of size 2^( 7) =       0.000489504995

      target function =      -0.816877015641
              le_mean =     -16.898388158863
             les_mean =     285.929695573458
             stat err =       0.000477272776
             autocorr =       1.289347533675
   target nu stat err =       0.000477272776
   target dn stat err =       0.012998379413
      target stat err =       0.013826723601
              std dev =       0.594424448706
             le_variance =       0.353340425219


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.811553324465        initial
     1.5625e+00     1.5625e+01             8.3301e-04        -0.824438248410  <--
     6.2500e+00     6.2500e+01             2.1341e-04        -0.822034455483
     2.5000e+01     2.5000e+02             5.3678e-05        -0.816877015641

*****************************************************************************
Applying the update for shift_i =   1.5625e+00     and shift_s =   1.5625e+01
*****************************************************************************

  Execution time = 2.4636e+01
  </log>
  <optVariables href="H2O.s017.opt.xml">
ci_0001                 6.955000e-01 3 1  ON 0
ci_0002                 6.955756e-01 3 1  ON 1
ci_0003                -4.417649e-02 3 1  ON 2
ci_0004                -4.432395e-02 3 1  ON 3
ci_0005                -4.176901e-02 3 1  ON 4
ci_0006                -4.211348e-02 3 1  ON 5
ci_0007                -2.989772e-02 3 1  ON 6
ci_0008                -3.005309e-02 3 1  ON 7
ci_0009                -2.856501e-02 3 1  ON 8
ci_0010                -2.853497e-02 3 1  ON 9
ci_0011                -2.395602e-02 3 1  ON 10
ci_0012                -2.392696e-02 3 1  ON 11
ci_0013                 2.358524e-02 3 1  ON 12
ci_0014                 2.352206e-02 3 1  ON 13
ci_0015                 2.365385e-02 3 1  ON 14
ci_0016                 2.361933e-02 3 1  ON 15
ci_0017                 2.159674e-02 3 1  ON 16
ci_0018                 2.156854e-02 3 1  ON 17
ci_0019                 1.802864e-02 3 1  ON 18
ci_0020                 1.804127e-02 3 1  ON 19
ci_0021                 1.891705e-02 3 1  ON 20
ci_0022                 1.872295e-02 3 1  ON 21
ci_0023                -1.699973e-02 3 1  ON 22
ci_0024                -1.688038e-02 3 1  ON 23
ci_0025                -1.409582e-02 3 1  ON 24
ci_0026                -1.416907e-02 3 1  ON 25
ci_0027                -1.642092e-02 3 1  ON 26
ci_0028                -1.639036e-02 3 1  ON 27
ci_0029                -1.452833e-02 3 1  ON 28
ci_0030                -1.507693e-02 3 1  ON 29
ci_0031                 1.619824e-02 3 1  ON 30
ci_0032                 1.607049e-02 3 1  ON 31
ci_0033                 1.411498e-02 3 1  ON 32
ci_0034                 1.440715e-02 3 1  ON 33
ci_0035                 1.248518e-02 3 1  ON 34
ci_0036                 1.277021e-02 3 1  ON 35
ci_0037                -1.404369e-02 3 1  ON 36
ci_0038                -1.404839e-02 3 1  ON 37
ci_0039                -1.174201e-02 3 1  ON 38
ci_0040                -1.165099e-02 3 1  ON 39
ci_0041                 1.334769e-02 3 1  ON 40
ci_0042                 1.337343e-02 3 1  ON 41
ci_0043                -1.236256e-02 3 1  ON 42
ci_0044                -1.269133e-02 3 1  ON 43
ci_0045                 1.310519e-02 3 1  ON 44
ci_0046                 1.295317e-02 3 1  ON 45
ci_0047                -1.085567e-02 3 1  ON 46
ci_0048                -1.086072e-02 3 1  ON 47
ci_0049                -9.752270e-03 3 1  ON 48
ci_0050                -9.661317e-03 3 1  ON 49
ci_0051                -9.354410e-03 3 1  ON 50
ci_0052                -9.353507e-03 3 1  ON 51
ci_0053                -9.765783e-03 3 1  ON 52
ci_0054                -9.645359e-03 3 1  ON 53
ci_0055                 9.125512e-03 3 1  ON 54
ci_0056                 9.180703e-03 3 1  ON 55
ci_0057                 8.965012e-03 3 1  ON 56
ci_0058                 9.472298e-03 3 1  ON 57
ci_0059                -9.543557e-03 3 1  ON 58
ci_0060                -9.446428e-03 3 1  ON 59
ci_0061                -9.449316e-03 3 1  ON 60
ci_0062                -9.544003e-03 3 1  ON 61
ci_0063                -1.088304e-02 3 1  ON 62
ci_0064                -1.086736e-02 3 1  ON 63
ci_0065                -9.896621e-03 3 1  ON 64
ci_0066                -1.001619e-02 3 1  ON 65
ci_0067                -8.893506e-03 3 1  ON 66
ci_0068                -9.038568e-03 3 1  ON 67
ci_0069                 8.399027e-03 3 1  ON 68
ci_0070                 8.404129e-03 3 1  ON 69
ci_0071                 8.997466e-03 3 1  ON 70
ci_0072                 8.791740e-03 3 1  ON 71
ci_0073                 8.108858e-03 3 1  ON 72
ci_0074                 8.249647e-03 3 1  ON 73
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 4.5007e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s018 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s018 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=18  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6889e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 18
    time step          = 0.05
    reference energy   = -16.8411
    reference variance = 0.275823
====================================================
  Execution time = 1.4849e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s018
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5216e+04
  VMC Eavg = -1.6899e+01
  VMC Evar = 3.6694e-01
  Total weights = 1.950905666e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 2.7311e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.342501952188
                                         uncertainty =       0.005642984634

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.342501952188
                                         uncertainty =       0.005642984634

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000413797553
  error estimate for blocks of size 2^( 2) =       0.000427741970
  error estimate for blocks of size 2^( 3) =       0.000441653342
  error estimate for blocks of size 2^( 4) =       0.000454430082
  error estimate for blocks of size 2^( 5) =       0.000466200179
  error estimate for blocks of size 2^( 6) =       0.000476205345
  error estimate for blocks of size 2^( 7) =       0.000481111371

      target function =      -0.824691857837
              le_mean =     -16.899068106112
             les_mean =     285.945441346146
             stat err =       0.000469486744
             autocorr =       1.287273508486
   target nu stat err =       0.000469486744
   target dn stat err =       0.012316323852
      target stat err =       0.013367963124
              std dev =       0.585198112191
             le_variance =       0.342456830512


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.689906810611e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 74
Check correct_vf_var_size: 225, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 3.9062e-01, overlap shift 3.9062e+00 and omega -1.7527e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.824906367607       residual = 7.13e-01           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.831718708124       residual = 1.26e-01           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.832811318802       residual = 2.83e-02           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.833154776344       residual = 5.98e-03           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.833229048821       residual = 3.34e-03           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.833262989990       residual = 1.30e-03           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.833285803064       residual = 4.65e-04           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.833295307205       residual = 1.49e-04           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.833297415305       residual = 5.94e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.833299056757       residual = 3.41e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.833297184872       residual = 2.84e-05           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.833299202481       residual = 2.61e-05           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.833298025140       residual = 1.76e-05           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.833299024778       residual = 1.47e-05           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.833300065400       residual = 1.09e-05           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.833300013305       residual = 3.62e-06           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.833300075978       residual = 6.67e-07           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.833300070990       residual = 1.53e-07           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.833300071930       residual = 5.91e-08           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.833300016922       residual = 1.37e-08           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.833300015966       residual = 4.54e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         20 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 3.9062e-01 is 2.385735e-03

solving harmonic davidson linear method for identity shift 1.5625e+00, overlap shift 1.5625e+01 and omega -1.7527e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.824906367607       residual = 7.13e-01           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.826817543900       residual = 1.22e-01           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.827112837413       residual = 2.64e-02           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.827203194783       residual = 5.42e-03           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.827221872966       residual = 2.97e-03           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.827230428103       residual = 1.11e-03           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.827235942219       residual = 3.85e-04           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.827238200311       residual = 1.18e-04           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.827238484055       residual = 4.85e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.827239078632       residual = 3.20e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.827238445616       residual = 2.71e-05           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.827238821257       residual = 1.78e-05           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.827238756371       residual = 1.33e-05           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.827238902947       residual = 1.08e-05           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.827239154952       residual = 6.41e-06           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.827239121334       residual = 1.80e-06           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.827239127973       residual = 2.92e-07           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.827239125453       residual = 6.90e-08           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.827239122679       residual = 2.61e-08           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.827239113947       residual = 5.67e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         19 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 1.5625e+00 is 6.790063e-04

solving harmonic davidson linear method for identity shift 6.2500e+00, overlap shift 6.2500e+01 and omega -1.7527e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.824906367607       residual = 7.13e-01           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.825399075032       residual = 1.20e-01           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.825474354940       residual = 2.59e-02           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.825497207998       residual = 5.26e-03           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.825501869720       residual = 2.87e-03           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.825504008023       residual = 1.06e-03           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.825505368141       residual = 3.64e-04           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.825505923960       residual = 1.11e-04           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.825505976309       residual = 4.61e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.825506136902       residual = 3.18e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.825505977847       residual = 2.51e-05           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.825506058662       residual = 1.64e-05           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.825506051405       residual = 1.23e-05           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.825506084351       residual = 9.89e-06           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.825506145336       residual = 5.46e-06           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.825506136221       residual = 1.47e-06           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.825506137403       residual = 2.31e-07           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.825506136749       residual = 5.51e-08           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.825506135903       residual = 2.06e-08           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.825506134026       residual = 4.41e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         19 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 6.2500e+00 is 1.757725e-04

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.363261 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 75 and numParams is: 74

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.7600e+01
  </log>
  <optVariables href="H2O.s018.opt.xml">
ci_0001                 6.959954e-01 3 1  ON 0
ci_0002                 6.956050e-01 3 1  ON 1
ci_0003                -4.363720e-02 3 1  ON 2
ci_0004                -4.379404e-02 3 1  ON 3
ci_0005                -4.121778e-02 3 1  ON 4
ci_0006                -4.152535e-02 3 1  ON 5
ci_0007                -2.960160e-02 3 1  ON 6
ci_0008                -2.969682e-02 3 1  ON 7
ci_0009                -2.811885e-02 3 1  ON 8
ci_0010                -2.815231e-02 3 1  ON 9
ci_0011                -2.368829e-02 3 1  ON 10
ci_0012                -2.347441e-02 3 1  ON 11
ci_0013                 2.318968e-02 3 1  ON 12
ci_0014                 2.320188e-02 3 1  ON 13
ci_0015                 2.337177e-02 3 1  ON 14
ci_0016                 2.321830e-02 3 1  ON 15
ci_0017                 2.133871e-02 3 1  ON 16
ci_0018                 2.121259e-02 3 1  ON 17
ci_0019                 1.779501e-02 3 1  ON 18
ci_0020                 1.769239e-02 3 1  ON 19
ci_0021                 1.884741e-02 3 1  ON 20
ci_0022                 1.863254e-02 3 1  ON 21
ci_0023                -1.686266e-02 3 1  ON 22
ci_0024                -1.656164e-02 3 1  ON 23
ci_0025                -1.356652e-02 3 1  ON 24
ci_0026                -1.371928e-02 3 1  ON 25
ci_0027                -1.607519e-02 3 1  ON 26
ci_0028                -1.620825e-02 3 1  ON 27
ci_0029                -1.433080e-02 3 1  ON 28
ci_0030                -1.490034e-02 3 1  ON 29
ci_0031                 1.614759e-02 3 1  ON 30
ci_0032                 1.603387e-02 3 1  ON 31
ci_0033                 1.380959e-02 3 1  ON 32
ci_0034                 1.409089e-02 3 1  ON 33
ci_0035                 1.215112e-02 3 1  ON 34
ci_0036                 1.221886e-02 3 1  ON 35
ci_0037                -1.391418e-02 3 1  ON 36
ci_0038                -1.389746e-02 3 1  ON 37
ci_0039                -1.140338e-02 3 1  ON 38
ci_0040                -1.130584e-02 3 1  ON 39
ci_0041                 1.333827e-02 3 1  ON 40
ci_0042                 1.325465e-02 3 1  ON 41
ci_0043                -1.224653e-02 3 1  ON 42
ci_0044                -1.257210e-02 3 1  ON 43
ci_0045                 1.286086e-02 3 1  ON 44
ci_0046                 1.286281e-02 3 1  ON 45
ci_0047                -1.052841e-02 3 1  ON 46
ci_0048                -1.052142e-02 3 1  ON 47
ci_0049                -9.387720e-03 3 1  ON 48
ci_0050                -9.307805e-03 3 1  ON 49
ci_0051                -8.991773e-03 3 1  ON 50
ci_0052                -8.999375e-03 3 1  ON 51
ci_0053                -9.497806e-03 3 1  ON 52
ci_0054                -9.389321e-03 3 1  ON 53
ci_0055                 8.446506e-03 3 1  ON 54
ci_0056                 8.928225e-03 3 1  ON 55
ci_0057                 8.322389e-03 3 1  ON 56
ci_0058                 9.183198e-03 3 1  ON 57
ci_0059                -9.332452e-03 3 1  ON 58
ci_0060                -9.187157e-03 3 1  ON 59
ci_0061                -9.186377e-03 3 1  ON 60
ci_0062                -9.279987e-03 3 1  ON 61
ci_0063                -1.075234e-02 3 1  ON 62
ci_0064                -1.073274e-02 3 1  ON 63
ci_0065                -9.810472e-03 3 1  ON 64
ci_0066                -9.900149e-03 3 1  ON 65
ci_0067                -8.677398e-03 3 1  ON 66
ci_0068                -8.877113e-03 3 1  ON 67
ci_0069                 8.219402e-03 3 1  ON 68
ci_0070                 8.154387e-03 3 1  ON 69
ci_0071                 8.861239e-03 3 1  ON 70
ci_0072                 8.529276e-03 3 1  ON 71
ci_0073                 7.902893e-03 3 1  ON 72
ci_0074                 8.022976e-03 3 1  ON 73
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 18
    time step          = 0.05
    reference energy   = -16.8765
    reference variance = 0.168002
====================================================
  Execution time = 1.4742e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s018
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6899e+01
  VMC Evar = 3.5069e-01
  Total weights = 1.9512e+06
  Execution time = 1.9626e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339814497945
                                         uncertainty =       0.001996807433

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339814497945
                                         uncertainty =       0.001996807433

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000412202122
  error estimate for blocks of size 2^( 2) =       0.000426154346
  error estimate for blocks of size 2^( 3) =       0.000439996575
  error estimate for blocks of size 2^( 4) =       0.000452718714
  error estimate for blocks of size 2^( 5) =       0.000463389430
  error estimate for blocks of size 2^( 6) =       0.000470268526
  error estimate for blocks of size 2^( 7) =       0.000475381721

      target function =      -0.823975916422
              le_mean =     -16.899355867365
             les_mean =     285.955878777812
             stat err =       0.000465439598
             autocorr =       1.274988335442
   target nu stat err =       0.000465439598
   target dn stat err =       0.011035340303
      target stat err =       0.011964577423
              std dev =       0.582941831067
             le_variance =       0.339821178408

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.329294222125
                                         uncertainty =       0.002068844346

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.329294222125
                                         uncertainty =       0.002068844346

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000405769772
  error estimate for blocks of size 2^( 2) =       0.000419622412
  error estimate for blocks of size 2^( 3) =       0.000433458576
  error estimate for blocks of size 2^( 4) =       0.000446250814
  error estimate for blocks of size 2^( 5) =       0.000457016226
  error estimate for blocks of size 2^( 6) =       0.000464186317
  error estimate for blocks of size 2^( 7) =       0.000469310813

      target function =      -0.798068893974
              le_mean =     -16.899473477252
             les_mean =     285.982736927959
             stat err =       0.000459191042
             autocorr =       1.280641094846
   target nu stat err =       0.000459191042
   target dn stat err =       0.039428559831
      target stat err =       0.040155139704
              std dev =       0.573845114325
             le_variance =       0.329298215234

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.332960686779
                                         uncertainty =       0.001925756276

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.332960686779
                                         uncertainty =       0.001925756276

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000408024159
  error estimate for blocks of size 2^( 2) =       0.000421934985
  error estimate for blocks of size 2^( 3) =       0.000435770026
  error estimate for blocks of size 2^( 4) =       0.000448561551
  error estimate for blocks of size 2^( 5) =       0.000459268980
  error estimate for blocks of size 2^( 6) =       0.000466298271
  error estimate for blocks of size 2^( 7) =       0.000471374801

      target function =      -0.842958939088
              le_mean =     -16.899381644740
             les_mean =     285.939749928501
             stat err =       0.000461375901
             autocorr =       1.278609879813
   target nu stat err =       0.000461375901
   target dn stat err =       0.003965917463
      target stat err =       0.004536353808
              std dev =       0.577033299180
             le_variance =       0.332967428362

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338795059403
                                         uncertainty =       0.001988973398

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338795059403
                                         uncertainty =       0.001988973398

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000411583354
  error estimate for blocks of size 2^( 2) =       0.000425529850
  error estimate for blocks of size 2^( 3) =       0.000439368500
  error estimate for blocks of size 2^( 4) =       0.000452082391
  error estimate for blocks of size 2^( 5) =       0.000462727362
  error estimate for blocks of size 2^( 6) =       0.000469620676
  error estimate for blocks of size 2^( 7) =       0.000474712989

      target function =      -0.833014382633
              le_mean =     -16.899366980782
             les_mean =     285.948111847630
             stat err =       0.000464785854
             autocorr =       1.275234929791
   target nu stat err =       0.000464785854
   target dn stat err =       0.005783639955
      target stat err =       0.006429457654
              std dev =       0.582066761510
             le_variance =       0.338801714855


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.823975916422        initial
     3.9062e-01     3.9062e+00             2.3857e-03        -0.798068893974
     1.5625e+00     1.5625e+01             6.7901e-04        -0.842958939088  <--
     6.2500e+00     6.2500e+01             1.7577e-04        -0.833014382633

*****************************************************************************
Applying the update for shift_i =   1.5625e+00     and shift_s =   1.5625e+01
*****************************************************************************

  Execution time = 2.4660e+01
  </log>
  <optVariables href="H2O.s018.opt.xml">
ci_0001                 6.959954e-01 3 1  ON 0
ci_0002                 6.956050e-01 3 1  ON 1
ci_0003                -4.363720e-02 3 1  ON 2
ci_0004                -4.379404e-02 3 1  ON 3
ci_0005                -4.121778e-02 3 1  ON 4
ci_0006                -4.152535e-02 3 1  ON 5
ci_0007                -2.960160e-02 3 1  ON 6
ci_0008                -2.969682e-02 3 1  ON 7
ci_0009                -2.811885e-02 3 1  ON 8
ci_0010                -2.815231e-02 3 1  ON 9
ci_0011                -2.368829e-02 3 1  ON 10
ci_0012                -2.347441e-02 3 1  ON 11
ci_0013                 2.318968e-02 3 1  ON 12
ci_0014                 2.320188e-02 3 1  ON 13
ci_0015                 2.337177e-02 3 1  ON 14
ci_0016                 2.321830e-02 3 1  ON 15
ci_0017                 2.133871e-02 3 1  ON 16
ci_0018                 2.121259e-02 3 1  ON 17
ci_0019                 1.779501e-02 3 1  ON 18
ci_0020                 1.769239e-02 3 1  ON 19
ci_0021                 1.884741e-02 3 1  ON 20
ci_0022                 1.863254e-02 3 1  ON 21
ci_0023                -1.686266e-02 3 1  ON 22
ci_0024                -1.656164e-02 3 1  ON 23
ci_0025                -1.356652e-02 3 1  ON 24
ci_0026                -1.371928e-02 3 1  ON 25
ci_0027                -1.607519e-02 3 1  ON 26
ci_0028                -1.620825e-02 3 1  ON 27
ci_0029                -1.433080e-02 3 1  ON 28
ci_0030                -1.490034e-02 3 1  ON 29
ci_0031                 1.614759e-02 3 1  ON 30
ci_0032                 1.603387e-02 3 1  ON 31
ci_0033                 1.380959e-02 3 1  ON 32
ci_0034                 1.409089e-02 3 1  ON 33
ci_0035                 1.215112e-02 3 1  ON 34
ci_0036                 1.221886e-02 3 1  ON 35
ci_0037                -1.391418e-02 3 1  ON 36
ci_0038                -1.389746e-02 3 1  ON 37
ci_0039                -1.140338e-02 3 1  ON 38
ci_0040                -1.130584e-02 3 1  ON 39
ci_0041                 1.333827e-02 3 1  ON 40
ci_0042                 1.325465e-02 3 1  ON 41
ci_0043                -1.224653e-02 3 1  ON 42
ci_0044                -1.257210e-02 3 1  ON 43
ci_0045                 1.286086e-02 3 1  ON 44
ci_0046                 1.286281e-02 3 1  ON 45
ci_0047                -1.052841e-02 3 1  ON 46
ci_0048                -1.052142e-02 3 1  ON 47
ci_0049                -9.387720e-03 3 1  ON 48
ci_0050                -9.307805e-03 3 1  ON 49
ci_0051                -8.991773e-03 3 1  ON 50
ci_0052                -8.999375e-03 3 1  ON 51
ci_0053                -9.497806e-03 3 1  ON 52
ci_0054                -9.389321e-03 3 1  ON 53
ci_0055                 8.446506e-03 3 1  ON 54
ci_0056                 8.928225e-03 3 1  ON 55
ci_0057                 8.322389e-03 3 1  ON 56
ci_0058                 9.183198e-03 3 1  ON 57
ci_0059                -9.332452e-03 3 1  ON 58
ci_0060                -9.187157e-03 3 1  ON 59
ci_0061                -9.186377e-03 3 1  ON 60
ci_0062                -9.279987e-03 3 1  ON 61
ci_0063                -1.075234e-02 3 1  ON 62
ci_0064                -1.073274e-02 3 1  ON 63
ci_0065                -9.810472e-03 3 1  ON 64
ci_0066                -9.900149e-03 3 1  ON 65
ci_0067                -8.677398e-03 3 1  ON 66
ci_0068                -8.877113e-03 3 1  ON 67
ci_0069                 8.219402e-03 3 1  ON 68
ci_0070                 8.154387e-03 3 1  ON 69
ci_0071                 8.861239e-03 3 1  ON 70
ci_0072                 8.529276e-03 3 1  ON 71
ci_0073                 7.902893e-03 3 1  ON 72
ci_0074                 8.022976e-03 3 1  ON 73
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 4.2266e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s019 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s019 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=19  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6888e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 19
    time step          = 0.05
    reference energy   = -16.8631
    reference variance = 0.260448
====================================================
  Execution time = 1.4957e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s019
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5246e+04
  VMC Eavg = -1.6899e+01
  VMC Evar = 3.5277e-01
  Total weights = 1.951136014e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 2.7102e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337891487312
                                         uncertainty =       0.001864445541

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337891487312
                                         uncertainty =       0.001864445541

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000411071802
  error estimate for blocks of size 2^( 2) =       0.000424975023
  error estimate for blocks of size 2^( 3) =       0.000439208273
  error estimate for blocks of size 2^( 4) =       0.000452689965
  error estimate for blocks of size 2^( 5) =       0.000463888106
  error estimate for blocks of size 2^( 6) =       0.000474867800
  error estimate for blocks of size 2^( 7) =       0.000480035296

      target function =      -0.840553837272
              le_mean =     -16.899114589906
             les_mean =     285.932845646028
             stat err =       0.000467870292
             autocorr =       1.295434819896
   target nu stat err =       0.000467870292
   target dn stat err =       0.002849570132
      target stat err =       0.003269672067
              std dev =       0.581343317221
             le_variance =       0.337960052477


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.689911458991e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 74
Check correct_vf_var_size: 225, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 3.9062e-01, overlap shift 3.9062e+00 and omega -1.7527e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.840565385196       residual = 6.12e-01           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.846080047945       residual = 1.20e-01           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.847100746157       residual = 2.27e-02           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.847382336858       residual = 5.62e-03           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.847450667619       residual = 2.56e-03           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.847482899342       residual = 1.23e-03           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.847502671185       residual = 3.62e-04           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.847509520203       residual = 9.34e-05           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.847511154336       residual = 2.99e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.847511771269       residual = 1.11e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.847511565311       residual = 6.51e-06           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.847511440405       residual = 3.10e-06           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.847511588665       residual = 3.44e-06           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.847511659775       residual = 3.37e-06           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.847511715916       residual = 3.01e-06           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.847511713655       residual = 6.95e-07           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.847511682539       residual = 1.27e-07           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.847511674731       residual = 5.06e-08           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.847511653029       residual = 1.36e-08           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.847511654171       residual = 5.88e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         19 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 3.9062e-01 is 2.022491e-03

solving harmonic davidson linear method for identity shift 1.5625e+00, overlap shift 1.5625e+01 and omega -1.7527e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.840565385196       residual = 6.12e-01           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.842116426311       residual = 1.16e-01           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.842395345732       residual = 2.14e-02           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.842469453471       residual = 5.09e-03           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.842487106047       residual = 2.30e-03           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.842495227852       residual = 1.07e-03           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.842499902878       residual = 2.98e-04           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.842501498188       residual = 7.37e-05           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.842501836483       residual = 2.27e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.842501963186       residual = 8.71e-06           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.842501904377       residual = 5.13e-06           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.842501872746       residual = 2.69e-06           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.842501913496       residual = 3.12e-06           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.842501929064       residual = 2.65e-06           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.842501938678       residual = 1.73e-06           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.842501933459       residual = 3.22e-07           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.842501926290       residual = 6.17e-08           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.842501925035       residual = 2.41e-08           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.842501920966       residual = 6.05e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         18 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 1.5625e+00 is 5.714471e-04

solving harmonic davidson linear method for identity shift 6.2500e+00, overlap shift 6.2500e+01 and omega -1.7527e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.840565385196       residual = 6.12e-01           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.840965564255       residual = 1.14e-01           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.841036903228       residual = 2.10e-02           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.841055649308       residual = 4.95e-03           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.841060091323       residual = 2.22e-03           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.841062119773       residual = 1.02e-03           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.841063265980       residual = 2.82e-04           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.841063655638       residual = 6.88e-05           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.841063735286       residual = 2.10e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.841063765065       residual = 8.15e-06           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.841063749941       residual = 4.81e-06           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.841063742052       residual = 2.59e-06           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.841063752507       residual = 3.02e-06           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.841063756176       residual = 2.44e-06           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.841063758258       residual = 1.45e-06           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.841063756747       residual = 2.59e-07           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.841063755019       residual = 5.04e-08           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.841063754748       residual = 1.95e-08           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.841063753815       residual = 4.81e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         18 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 6.2500e+00 is 1.476278e-04

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.375386 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 75 and numParams is: 74

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.7685e+01
  </log>
  <optVariables href="H2O.s019.opt.xml">
ci_0001                 6.963541e-01 3 1  ON 0
ci_0002                 6.957304e-01 3 1  ON 1
ci_0003                -4.315201e-02 3 1  ON 2
ci_0004                -4.329131e-02 3 1  ON 3
ci_0005                -4.074441e-02 3 1  ON 4
ci_0006                -4.110330e-02 3 1  ON 5
ci_0007                -2.918117e-02 3 1  ON 6
ci_0008                -2.930114e-02 3 1  ON 7
ci_0009                -2.773193e-02 3 1  ON 8
ci_0010                -2.777628e-02 3 1  ON 9
ci_0011                -2.337753e-02 3 1  ON 10
ci_0012                -2.313946e-02 3 1  ON 11
ci_0013                 2.285030e-02 3 1  ON 12
ci_0014                 2.284065e-02 3 1  ON 13
ci_0015                 2.307332e-02 3 1  ON 14
ci_0016                 2.297101e-02 3 1  ON 15
ci_0017                 2.097804e-02 3 1  ON 16
ci_0018                 2.088640e-02 3 1  ON 17
ci_0019                 1.754679e-02 3 1  ON 18
ci_0020                 1.745384e-02 3 1  ON 19
ci_0021                 1.874070e-02 3 1  ON 20
ci_0022                 1.859067e-02 3 1  ON 21
ci_0023                -1.663689e-02 3 1  ON 22
ci_0024                -1.631624e-02 3 1  ON 23
ci_0025                -1.303395e-02 3 1  ON 24
ci_0026                -1.314783e-02 3 1  ON 25
ci_0027                -1.586020e-02 3 1  ON 26
ci_0028                -1.600698e-02 3 1  ON 27
ci_0029                -1.412645e-02 3 1  ON 28
ci_0030                -1.469027e-02 3 1  ON 29
ci_0031                 1.607203e-02 3 1  ON 30
ci_0032                 1.598283e-02 3 1  ON 31
ci_0033                 1.361294e-02 3 1  ON 32
ci_0034                 1.388449e-02 3 1  ON 33
ci_0035                 1.166058e-02 3 1  ON 34
ci_0036                 1.186818e-02 3 1  ON 35
ci_0037                -1.380340e-02 3 1  ON 36
ci_0038                -1.376922e-02 3 1  ON 37
ci_0039                -1.102778e-02 3 1  ON 38
ci_0040                -1.096685e-02 3 1  ON 39
ci_0041                 1.317751e-02 3 1  ON 40
ci_0042                 1.307798e-02 3 1  ON 41
ci_0043                -1.203458e-02 3 1  ON 42
ci_0044                -1.238105e-02 3 1  ON 43
ci_0045                 1.274685e-02 3 1  ON 44
ci_0046                 1.271462e-02 3 1  ON 45
ci_0047                -1.019376e-02 3 1  ON 46
ci_0048                -1.019438e-02 3 1  ON 47
ci_0049                -9.039766e-03 3 1  ON 48
ci_0050                -9.000776e-03 3 1  ON 49
ci_0051                -8.639348e-03 3 1  ON 50
ci_0052                -8.636016e-03 3 1  ON 51
ci_0053                -9.200037e-03 3 1  ON 52
ci_0054                -9.118733e-03 3 1  ON 53
ci_0055                 8.214185e-03 3 1  ON 54
ci_0056                 8.531001e-03 3 1  ON 55
ci_0057                 8.096360e-03 3 1  ON 56
ci_0058                 8.878795e-03 3 1  ON 57
ci_0059                -9.071936e-03 3 1  ON 58
ci_0060                -8.889649e-03 3 1  ON 59
ci_0061                -8.964663e-03 3 1  ON 60
ci_0062                -9.038186e-03 3 1  ON 61
ci_0063                -1.069294e-02 3 1  ON 62
ci_0064                -1.067982e-02 3 1  ON 63
ci_0065                -9.666392e-03 3 1  ON 64
ci_0066                -9.784229e-03 3 1  ON 65
ci_0067                -8.458764e-03 3 1  ON 66
ci_0068                -8.646738e-03 3 1  ON 67
ci_0069                 7.994990e-03 3 1  ON 68
ci_0070                 7.972861e-03 3 1  ON 69
ci_0071                 8.651182e-03 3 1  ON 70
ci_0072                 8.354366e-03 3 1  ON 71
ci_0073                 7.663935e-03 3 1  ON 72
ci_0074                 7.774778e-03 3 1  ON 73
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 19
    time step          = 0.05
    reference energy   = -16.9248
    reference variance = 0.154824
====================================================
  Execution time = 1.4650e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s019
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6900e+01
  VMC Evar = 3.6032e-01
  Total weights = 1.9509e+06
  Execution time = 1.9595e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

ERROR CostFunction-> Number of Effective Walkers is too small! 
  Number of effective walkers (samples) / total number of samples = 0.155291
  User specified threshold minwalkers = 0.3
  If this message appears frequently. You might have to be cautious. 
  Find info about parameter "minwalkers" in the user manual!
Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.340529307315
                                         uncertainty =       0.003926279198

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.340529307315
                                         uncertainty =       0.003926279198

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000412781814
  error estimate for blocks of size 2^( 2) =       0.000426298121
  error estimate for blocks of size 2^( 3) =       0.000439886528
  error estimate for blocks of size 2^( 4) =       0.000452248593
  error estimate for blocks of size 2^( 5) =       0.000463235468
  error estimate for blocks of size 2^( 6) =       0.000471429025
  error estimate for blocks of size 2^( 7) =       0.000476827910

      target function =      -0.820717708302
              le_mean =     -16.899532115789
             les_mean =     285.964688856361
             stat err =       0.000465935249
             autocorr =       1.274119091197
   target nu stat err =       0.000465935249
   target dn stat err =       0.016014966252
      target stat err =       0.017223519695
              std dev =       0.583761639829
             le_variance =       0.340777652136

ERROR CostFunction-> Number of Effective Walkers is too small! 
  Number of effective walkers (samples) / total number of samples = 0.00425547
  User specified threshold minwalkers = 0.3
  If this message appears frequently. You might have to be cautious. 
  Find info about parameter "minwalkers" in the user manual!
Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.329573788659
                                         uncertainty =       0.002720791081

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.329573788659
                                         uncertainty =       0.002720791081

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000406119641
  error estimate for blocks of size 2^( 2) =       0.000419568550
  error estimate for blocks of size 2^( 3) =       0.000433183436
  error estimate for blocks of size 2^( 4) =       0.000445620620
  error estimate for blocks of size 2^( 5) =       0.000456621247
  error estimate for blocks of size 2^( 6) =       0.000464796635
  error estimate for blocks of size 2^( 7) =       0.000470159302

      target function =      -0.828312475195
              le_mean =     -16.899632851212
             les_mean =     285.961252998919
             stat err =       0.000459299451
             autocorr =       1.279039228228
   target nu stat err =       0.000459299451
   target dn stat err =       0.011540738203
      target stat err =       0.012648483154
              std dev =       0.574339904778
             le_variance =       0.329866326221

ERROR CostFunction-> Number of Effective Walkers is too small! 
  Number of effective walkers (samples) / total number of samples = 0.161109
  User specified threshold minwalkers = 0.3
  If this message appears frequently. You might have to be cautious. 
  Find info about parameter "minwalkers" in the user manual!
Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.333751828365
                                         uncertainty =       0.003157903068

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.333751828365
                                         uncertainty =       0.003157903068

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000408670036
  error estimate for blocks of size 2^( 2) =       0.000422145280
  error estimate for blocks of size 2^( 3) =       0.000435748323
  error estimate for blocks of size 2^( 4) =       0.000448166531
  error estimate for blocks of size 2^( 5) =       0.000459176261
  error estimate for blocks of size 2^( 6) =       0.000467372743
  error estimate for blocks of size 2^( 7) =       0.000472768376

      target function =      -0.831022478902
              le_mean =     -16.899555530647
             les_mean =     285.956138960855
             stat err =       0.000461870978
             autocorr =       1.277308360637
   target nu stat err =       0.000461870978
   target dn stat err =       0.012947288453
      target stat err =       0.014278520162
              std dev =       0.577946707903
             le_variance =       0.334022397176

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339573365585
                                         uncertainty =       0.003808186907

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339573365585
                                         uncertainty =       0.003808186907

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000412204072
  error estimate for blocks of size 2^( 2) =       0.000425713355
  error estimate for blocks of size 2^( 3) =       0.000439304106
  error estimate for blocks of size 2^( 4) =       0.000451677281
  error estimate for blocks of size 2^( 5) =       0.000462666147
  error estimate for blocks of size 2^( 6) =       0.000470864059
  error estimate for blocks of size 2^( 7) =       0.000476254652

      target function =      -0.821434844320
              le_mean =     -16.899530579681
             les_mean =     285.963974843665
             stat err =       0.000465365535
             autocorr =       1.274570544314
   target nu stat err =       0.000465365535
   target dn stat err =       0.015889246924
      target stat err =       0.017118168904
              std dev =       0.582944588395
             le_variance =       0.339824393140


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.820717708302        initial
     3.9062e-01     3.9062e+00             2.0225e-03        -0.828312475195
     1.5625e+00     1.5625e+01             5.7145e-04        -0.831022478902  <--
     6.2500e+00     6.2500e+01             1.4763e-04        -0.821434844320

*****************************************************************************
Applying the update for shift_i =   1.5625e+00     and shift_s =   1.5625e+01
*****************************************************************************

  Execution time = 2.4563e+01
  </log>
  <optVariables href="H2O.s019.opt.xml">
ci_0001                 6.963541e-01 3 1  ON 0
ci_0002                 6.957304e-01 3 1  ON 1
ci_0003                -4.315201e-02 3 1  ON 2
ci_0004                -4.329131e-02 3 1  ON 3
ci_0005                -4.074441e-02 3 1  ON 4
ci_0006                -4.110330e-02 3 1  ON 5
ci_0007                -2.918117e-02 3 1  ON 6
ci_0008                -2.930114e-02 3 1  ON 7
ci_0009                -2.773193e-02 3 1  ON 8
ci_0010                -2.777628e-02 3 1  ON 9
ci_0011                -2.337753e-02 3 1  ON 10
ci_0012                -2.313946e-02 3 1  ON 11
ci_0013                 2.285030e-02 3 1  ON 12
ci_0014                 2.284065e-02 3 1  ON 13
ci_0015                 2.307332e-02 3 1  ON 14
ci_0016                 2.297101e-02 3 1  ON 15
ci_0017                 2.097804e-02 3 1  ON 16
ci_0018                 2.088640e-02 3 1  ON 17
ci_0019                 1.754679e-02 3 1  ON 18
ci_0020                 1.745384e-02 3 1  ON 19
ci_0021                 1.874070e-02 3 1  ON 20
ci_0022                 1.859067e-02 3 1  ON 21
ci_0023                -1.663689e-02 3 1  ON 22
ci_0024                -1.631624e-02 3 1  ON 23
ci_0025                -1.303395e-02 3 1  ON 24
ci_0026                -1.314783e-02 3 1  ON 25
ci_0027                -1.586020e-02 3 1  ON 26
ci_0028                -1.600698e-02 3 1  ON 27
ci_0029                -1.412645e-02 3 1  ON 28
ci_0030                -1.469027e-02 3 1  ON 29
ci_0031                 1.607203e-02 3 1  ON 30
ci_0032                 1.598283e-02 3 1  ON 31
ci_0033                 1.361294e-02 3 1  ON 32
ci_0034                 1.388449e-02 3 1  ON 33
ci_0035                 1.166058e-02 3 1  ON 34
ci_0036                 1.186818e-02 3 1  ON 35
ci_0037                -1.380340e-02 3 1  ON 36
ci_0038                -1.376922e-02 3 1  ON 37
ci_0039                -1.102778e-02 3 1  ON 38
ci_0040                -1.096685e-02 3 1  ON 39
ci_0041                 1.317751e-02 3 1  ON 40
ci_0042                 1.307798e-02 3 1  ON 41
ci_0043                -1.203458e-02 3 1  ON 42
ci_0044                -1.238105e-02 3 1  ON 43
ci_0045                 1.274685e-02 3 1  ON 44
ci_0046                 1.271462e-02 3 1  ON 45
ci_0047                -1.019376e-02 3 1  ON 46
ci_0048                -1.019438e-02 3 1  ON 47
ci_0049                -9.039766e-03 3 1  ON 48
ci_0050                -9.000776e-03 3 1  ON 49
ci_0051                -8.639348e-03 3 1  ON 50
ci_0052                -8.636016e-03 3 1  ON 51
ci_0053                -9.200037e-03 3 1  ON 52
ci_0054                -9.118733e-03 3 1  ON 53
ci_0055                 8.214185e-03 3 1  ON 54
ci_0056                 8.531001e-03 3 1  ON 55
ci_0057                 8.096360e-03 3 1  ON 56
ci_0058                 8.878795e-03 3 1  ON 57
ci_0059                -9.071936e-03 3 1  ON 58
ci_0060                -8.889649e-03 3 1  ON 59
ci_0061                -8.964663e-03 3 1  ON 60
ci_0062                -9.038186e-03 3 1  ON 61
ci_0063                -1.069294e-02 3 1  ON 62
ci_0064                -1.067982e-02 3 1  ON 63
ci_0065                -9.666392e-03 3 1  ON 64
ci_0066                -9.784229e-03 3 1  ON 65
ci_0067                -8.458764e-03 3 1  ON 66
ci_0068                -8.646738e-03 3 1  ON 67
ci_0069                 7.994990e-03 3 1  ON 68
ci_0070                 7.972861e-03 3 1  ON 69
ci_0071                 8.651182e-03 3 1  ON 70
ci_0072                 8.354366e-03 3 1  ON 71
ci_0073                 7.663935e-03 3 1  ON 72
ci_0074                 7.774778e-03 3 1  ON 73
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 4.2258e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s020 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s020 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=20  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6888e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 20
    time step          = 0.05
    reference energy   = -16.8465
    reference variance = 0.479703
====================================================
  Execution time = 1.5061e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s020
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5257e+04
  VMC Eavg = -1.6900e+01
  VMC Evar = 3.5085e-01
  Total weights = 1.950865545e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 2.7237e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337314163258
                                         uncertainty =       0.003105626931

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337314163258
                                         uncertainty =       0.003105626931

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000410672996
  error estimate for blocks of size 2^( 2) =       0.000424420632
  error estimate for blocks of size 2^( 3) =       0.000438328988
  error estimate for blocks of size 2^( 4) =       0.000451223264
  error estimate for blocks of size 2^( 5) =       0.000461667134
  error estimate for blocks of size 2^( 6) =       0.000470605274
  error estimate for blocks of size 2^( 7) =       0.000477649029

      target function =      -0.842779567419
              le_mean =     -16.900008449209
             les_mean =     285.961138927018
             stat err =       0.000465286175
             autocorr =       1.283654078521
   target nu stat err =       0.000465286175
   target dn stat err =       0.003686691447
      target stat err =       0.004226360955
              std dev =       0.580779320118
             le_variance =       0.337304618676


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690000844921e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 74
Check correct_vf_var_size: 225, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 3.9062e-01, overlap shift 3.9062e+00 and omega -1.7527e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.842799536268       residual = 5.18e-01           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.847764715995       residual = 9.05e-02           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.848571557593       residual = 1.80e-02           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.848805914547       residual = 4.36e-03           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.848868622357       residual = 1.63e-03           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.848893217723       residual = 1.21e-03           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.848903132647       residual = 3.25e-04           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.848907269426       residual = 8.82e-05           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.848909444025       residual = 2.89e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.848910542828       residual = 9.19e-06           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.848910369511       residual = 3.61e-06           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.848910386943       residual = 8.48e-07           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.848910346971       residual = 2.83e-07           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.848910362661       residual = 1.42e-07           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.848910363527       residual = 1.86e-07           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.848910411142       residual = 2.09e-07           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.848910404336       residual = 8.46e-08           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.848910371133       residual = 3.55e-08           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.848910386596       residual = 1.63e-08           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.848910382422       residual = 6.54e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         19 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 3.9062e-01 is 1.832733e-03

solving harmonic davidson linear method for identity shift 1.5625e+00, overlap shift 1.5625e+01 and omega -1.7527e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.842799536268       residual = 5.18e-01           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.844195564868       residual = 8.76e-02           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.844416091039       residual = 1.69e-02           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.844477695611       residual = 3.97e-03           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.844493819348       residual = 1.46e-03           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.844499947029       residual = 1.03e-03           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.844502227825       residual = 2.64e-04           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.844503159014       residual = 6.88e-05           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.844503660952       residual = 2.13e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.844503901215       residual = 6.70e-06           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.844503851486       residual = 2.42e-06           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.844503852736       residual = 5.28e-07           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.844503843677       residual = 1.76e-07           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.844503847265       residual = 9.20e-08           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.844503847148       residual = 1.22e-07           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.844503857019       residual = 1.07e-07           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.844503854933       residual = 4.27e-08           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.844503848769       residual = 1.83e-08           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.844503851884       residual = 7.43e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         18 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 1.5625e+00 is 5.170290e-04

solving harmonic davidson linear method for identity shift 6.2500e+00, overlap shift 6.2500e+01 and omega -1.7527e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.842799536268       residual = 5.18e-01           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.843159694471       residual = 8.67e-02           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.843216105380       residual = 1.66e-02           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.843231684387       residual = 3.87e-03           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.843235736085       residual = 1.41e-03           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.843237261520       residual = 9.78e-04           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.843237816160       residual = 2.49e-04           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.843238041301       residual = 6.41e-05           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.843238163695       residual = 1.95e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.843238221297       residual = 6.12e-06           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.843238208535       residual = 2.16e-06           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.843238208672       residual = 4.60e-07           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.843238206483       residual = 1.53e-07           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.843238207356       residual = 8.09e-08           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.843238207309       residual = 1.07e-07           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.843238209633       residual = 8.80e-08           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.843238209105       residual = 3.52e-08           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.843238207699       residual = 1.51e-08           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.843238208428       residual = 5.93e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         18 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 6.2500e+00 is 1.335129e-04

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.393603 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 75 and numParams is: 74

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.7812e+01
  </log>
  <optVariables href="H2O.s020.opt.xml">
ci_0001                 6.966011e-01 3 1  ON 0
ci_0002                 6.959327e-01 3 1  ON 1
ci_0003                -4.267303e-02 3 1  ON 2
ci_0004                -4.282464e-02 3 1  ON 3
ci_0005                -4.025911e-02 3 1  ON 4
ci_0006                -4.067637e-02 3 1  ON 5
ci_0007                -2.879605e-02 3 1  ON 6
ci_0008                -2.887848e-02 3 1  ON 7
ci_0009                -2.738053e-02 3 1  ON 8
ci_0010                -2.740021e-02 3 1  ON 9
ci_0011                -2.306016e-02 3 1  ON 10
ci_0012                -2.283110e-02 3 1  ON 11
ci_0013                 2.256236e-02 3 1  ON 12
ci_0014                 2.254720e-02 3 1  ON 13
ci_0015                 2.278748e-02 3 1  ON 14
ci_0016                 2.267356e-02 3 1  ON 15
ci_0017                 2.066033e-02 3 1  ON 16
ci_0018                 2.062467e-02 3 1  ON 17
ci_0019                 1.731915e-02 3 1  ON 18
ci_0020                 1.720309e-02 3 1  ON 19
ci_0021                 1.869120e-02 3 1  ON 20
ci_0022                 1.852891e-02 3 1  ON 21
ci_0023                -1.641121e-02 3 1  ON 22
ci_0024                -1.613709e-02 3 1  ON 23
ci_0025                -1.253457e-02 3 1  ON 24
ci_0026                -1.263080e-02 3 1  ON 25
ci_0027                -1.570912e-02 3 1  ON 26
ci_0028                -1.578746e-02 3 1  ON 27
ci_0029                -1.396135e-02 3 1  ON 28
ci_0030                -1.445830e-02 3 1  ON 29
ci_0031                 1.604437e-02 3 1  ON 30
ci_0032                 1.588371e-02 3 1  ON 31
ci_0033                 1.341000e-02 3 1  ON 32
ci_0034                 1.368503e-02 3 1  ON 33
ci_0035                 1.117557e-02 3 1  ON 34
ci_0036                 1.145689e-02 3 1  ON 35
ci_0037                -1.371388e-02 3 1  ON 36
ci_0038                -1.365293e-02 3 1  ON 37
ci_0039                -1.067753e-02 3 1  ON 38
ci_0040                -1.065201e-02 3 1  ON 39
ci_0041                 1.304153e-02 3 1  ON 40
ci_0042                 1.294140e-02 3 1  ON 41
ci_0043                -1.186735e-02 3 1  ON 42
ci_0044                -1.216874e-02 3 1  ON 43
ci_0045                 1.266856e-02 3 1  ON 44
ci_0046                 1.264244e-02 3 1  ON 45
ci_0047                -9.883380e-03 3 1  ON 46
ci_0048                -9.886708e-03 3 1  ON 47
ci_0049                -8.672949e-03 3 1  ON 48
ci_0050                -8.834774e-03 3 1  ON 49
ci_0051                -8.312045e-03 3 1  ON 50
ci_0052                -8.314959e-03 3 1  ON 51
ci_0053                -8.919456e-03 3 1  ON 52
ci_0054                -8.855987e-03 3 1  ON 53
ci_0055                 7.825502e-03 3 1  ON 54
ci_0056                 8.205496e-03 3 1  ON 55
ci_0057                 7.858924e-03 3 1  ON 56
ci_0058                 8.678508e-03 3 1  ON 57
ci_0059                -8.803232e-03 3 1  ON 58
ci_0060                -8.627703e-03 3 1  ON 59
ci_0061                -8.709186e-03 3 1  ON 60
ci_0062                -8.784969e-03 3 1  ON 61
ci_0063                -1.065311e-02 3 1  ON 62
ci_0064                -1.062118e-02 3 1  ON 63
ci_0065                -9.546656e-03 3 1  ON 64
ci_0066                -9.651736e-03 3 1  ON 65
ci_0067                -8.254962e-03 3 1  ON 66
ci_0068                -8.422872e-03 3 1  ON 67
ci_0069                 7.808197e-03 3 1  ON 68
ci_0070                 7.719448e-03 3 1  ON 69
ci_0071                 8.511173e-03 3 1  ON 70
ci_0072                 8.193631e-03 3 1  ON 71
ci_0073                 7.463656e-03 3 1  ON 72
ci_0074                 7.589205e-03 3 1  ON 73
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 20
    time step          = 0.05
    reference energy   = -16.9677
    reference variance = 0.340147
====================================================
  Execution time = 1.4606e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s020
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6901e+01
  VMC Evar = 3.4726e-01
  Total weights = 1.9512e+06
  Execution time = 1.9761e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.335674064818
                                         uncertainty =       0.002880422662

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.335674064818
                                         uncertainty =       0.002880422662

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000409742268
  error estimate for blocks of size 2^( 2) =       0.000423425675
  error estimate for blocks of size 2^( 3) =       0.000437231020
  error estimate for blocks of size 2^( 4) =       0.000450452760
  error estimate for blocks of size 2^( 5) =       0.000461517862
  error estimate for blocks of size 2^( 6) =       0.000469296925
  error estimate for blocks of size 2^( 7) =       0.000474835957

      target function =      -0.835466802579
              le_mean =     -16.901179172346
             les_mean =     286.007245959849
             stat err =       0.000464025876
             autocorr =       1.282516215439
   target nu stat err =       0.000464025876
   target dn stat err =       0.006352087912
      target stat err =       0.007117831990
              std dev =       0.579463072535
             le_variance =       0.335777452432

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.342735427176
                                         uncertainty =       0.016332263721

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.342735427176
                                         uncertainty =       0.016332263721

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000414012090
  error estimate for blocks of size 2^( 2) =       0.000427353143
  error estimate for blocks of size 2^( 3) =       0.000440905603
  error estimate for blocks of size 2^( 4) =       0.000453991360
  error estimate for blocks of size 2^( 5) =       0.000464913702
  error estimate for blocks of size 2^( 6) =       0.000472525948
  error estimate for blocks of size 2^( 7) =       0.000478495526

      target function =      -0.403192959553
              le_mean =     -16.901303037974
             les_mean =     286.569743262459
             stat err =       0.000467481634
             autocorr =       1.274979081358
   target nu stat err =       0.000467481634
   target dn stat err =       0.564857465911
      target stat err =       0.174306841152
              std dev =       0.585501512980
             le_variance =       0.342812021701

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.330107392304
                                         uncertainty =       0.002823499878

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.330107392304
                                         uncertainty =       0.002823499878

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000406330704
  error estimate for blocks of size 2^( 2) =       0.000419965489
  error estimate for blocks of size 2^( 3) =       0.000433795011
  error estimate for blocks of size 2^( 4) =       0.000447084190
  error estimate for blocks of size 2^( 5) =       0.000458213472
  error estimate for blocks of size 2^( 6) =       0.000466040454
  error estimate for blocks of size 2^( 7) =       0.000471716028

      target function =      -0.849911690840
              le_mean =     -16.901158080707
             les_mean =     285.993850469755
             stat err =       0.000460763536
             autocorr =       1.285869580298
   target nu stat err =       0.000460763536
   target dn stat err =       0.003193376067
      target stat err =       0.003741526498
              std dev =       0.574638393060
             le_variance =       0.330209282779

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.334901537369
                                         uncertainty =       0.002872626940

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.334901537369
                                         uncertainty =       0.002872626940

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000409270545
  error estimate for blocks of size 2^( 2) =       0.000422946906
  error estimate for blocks of size 2^( 3) =       0.000436756298
  error estimate for blocks of size 2^( 4) =       0.000449988001
  error estimate for blocks of size 2^( 5) =       0.000461063101
  error estimate for blocks of size 2^( 6) =       0.000468850593
  error estimate for blocks of size 2^( 7) =       0.000474407142

      target function =      -0.841351376980
              le_mean =     -16.901171053996
             les_mean =     286.001767669826
             stat err =       0.000463577209
             autocorr =       1.282989713006
   target nu stat err =       0.000463577209
   target dn stat err =       0.004067918787
      target stat err =       0.004646970148
              std dev =       0.578795955145
             le_variance =       0.335004757692


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.835466802579        initial
     3.9062e-01     3.9062e+00             1.8327e-03        -0.403192959553
     1.5625e+00     1.5625e+01             5.1703e-04        -0.849911690840  <--
     6.2500e+00     6.2500e+01             1.3351e-04        -0.841351376980

*****************************************************************************
Applying the update for shift_i =   1.5625e+00     and shift_s =   1.5625e+01
*****************************************************************************

  Execution time = 2.4593e+01
  </log>
  <optVariables href="H2O.s020.opt.xml">
ci_0001                 6.966011e-01 3 1  ON 0
ci_0002                 6.959327e-01 3 1  ON 1
ci_0003                -4.267303e-02 3 1  ON 2
ci_0004                -4.282464e-02 3 1  ON 3
ci_0005                -4.025911e-02 3 1  ON 4
ci_0006                -4.067637e-02 3 1  ON 5
ci_0007                -2.879605e-02 3 1  ON 6
ci_0008                -2.887848e-02 3 1  ON 7
ci_0009                -2.738053e-02 3 1  ON 8
ci_0010                -2.740021e-02 3 1  ON 9
ci_0011                -2.306016e-02 3 1  ON 10
ci_0012                -2.283110e-02 3 1  ON 11
ci_0013                 2.256236e-02 3 1  ON 12
ci_0014                 2.254720e-02 3 1  ON 13
ci_0015                 2.278748e-02 3 1  ON 14
ci_0016                 2.267356e-02 3 1  ON 15
ci_0017                 2.066033e-02 3 1  ON 16
ci_0018                 2.062467e-02 3 1  ON 17
ci_0019                 1.731915e-02 3 1  ON 18
ci_0020                 1.720309e-02 3 1  ON 19
ci_0021                 1.869120e-02 3 1  ON 20
ci_0022                 1.852891e-02 3 1  ON 21
ci_0023                -1.641121e-02 3 1  ON 22
ci_0024                -1.613709e-02 3 1  ON 23
ci_0025                -1.253457e-02 3 1  ON 24
ci_0026                -1.263080e-02 3 1  ON 25
ci_0027                -1.570912e-02 3 1  ON 26
ci_0028                -1.578746e-02 3 1  ON 27
ci_0029                -1.396135e-02 3 1  ON 28
ci_0030                -1.445830e-02 3 1  ON 29
ci_0031                 1.604437e-02 3 1  ON 30
ci_0032                 1.588371e-02 3 1  ON 31
ci_0033                 1.341000e-02 3 1  ON 32
ci_0034                 1.368503e-02 3 1  ON 33
ci_0035                 1.117557e-02 3 1  ON 34
ci_0036                 1.145689e-02 3 1  ON 35
ci_0037                -1.371388e-02 3 1  ON 36
ci_0038                -1.365293e-02 3 1  ON 37
ci_0039                -1.067753e-02 3 1  ON 38
ci_0040                -1.065201e-02 3 1  ON 39
ci_0041                 1.304153e-02 3 1  ON 40
ci_0042                 1.294140e-02 3 1  ON 41
ci_0043                -1.186735e-02 3 1  ON 42
ci_0044                -1.216874e-02 3 1  ON 43
ci_0045                 1.266856e-02 3 1  ON 44
ci_0046                 1.264244e-02 3 1  ON 45
ci_0047                -9.883380e-03 3 1  ON 46
ci_0048                -9.886708e-03 3 1  ON 47
ci_0049                -8.672949e-03 3 1  ON 48
ci_0050                -8.834774e-03 3 1  ON 49
ci_0051                -8.312045e-03 3 1  ON 50
ci_0052                -8.314959e-03 3 1  ON 51
ci_0053                -8.919456e-03 3 1  ON 52
ci_0054                -8.855987e-03 3 1  ON 53
ci_0055                 7.825502e-03 3 1  ON 54
ci_0056                 8.205496e-03 3 1  ON 55
ci_0057                 7.858924e-03 3 1  ON 56
ci_0058                 8.678508e-03 3 1  ON 57
ci_0059                -8.803232e-03 3 1  ON 58
ci_0060                -8.627703e-03 3 1  ON 59
ci_0061                -8.709186e-03 3 1  ON 60
ci_0062                -8.784969e-03 3 1  ON 61
ci_0063                -1.065311e-02 3 1  ON 62
ci_0064                -1.062118e-02 3 1  ON 63
ci_0065                -9.546656e-03 3 1  ON 64
ci_0066                -9.651736e-03 3 1  ON 65
ci_0067                -8.254962e-03 3 1  ON 66
ci_0068                -8.422872e-03 3 1  ON 67
ci_0069                 7.808197e-03 3 1  ON 68
ci_0070                 7.719448e-03 3 1  ON 69
ci_0071                 8.511173e-03 3 1  ON 70
ci_0072                 8.193631e-03 3 1  ON 71
ci_0073                 7.463656e-03 3 1  ON 72
ci_0074                 7.589205e-03 3 1  ON 73
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 4.2420e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s021 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s021 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=21  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6889e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 21
    time step          = 0.05
    reference energy   = -16.9382
    reference variance = 0.379288
====================================================
  Execution time = 1.5174e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s021
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5215e+04
  VMC Eavg = -1.6900e+01
  VMC Evar = 3.4993e-01
  Total weights = 1.951369576e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 2.7345e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.332938531912
                                         uncertainty =       0.002336704308

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.332938531912
                                         uncertainty =       0.002336704308

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000407975332
  error estimate for blocks of size 2^( 2) =       0.000421799335
  error estimate for blocks of size 2^( 3) =       0.000435745192
  error estimate for blocks of size 2^( 4) =       0.000449022787
  error estimate for blocks of size 2^( 5) =       0.000461301367
  error estimate for blocks of size 2^( 6) =       0.000470873545
  error estimate for blocks of size 2^( 7) =       0.000477297995

      target function =      -0.843810617136
              le_mean =     -16.899895723617
             les_mean =     285.956408491855
             stat err =       0.000464623924
             autocorr =       1.296986114068
   target nu stat err =       0.000464623924
   target dn stat err =       0.004088913912
      target stat err =       0.004688250845
              std dev =       0.576964247851
             le_variance =       0.332887743298


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.689989572362e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 74
Check correct_vf_var_size: 225, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 3.9062e-01, overlap shift 3.9062e+00 and omega -1.7527e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.843835539527       residual = 4.97e-01           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.848049384882       residual = 1.04e-01           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.848992555799       residual = 1.71e-02           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.849226757435       residual = 3.74e-03           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.849290099152       residual = 1.34e-03           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.849317382817       residual = 9.68e-04           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.849328857860       residual = 3.37e-04           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.849333343420       residual = 9.09e-05           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.849334803709       residual = 3.98e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.849335124347       residual = 1.84e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.849335384919       residual = 1.87e-05           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.849335157520       residual = 1.08e-05           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.849335538808       residual = 1.26e-05           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.849336401072       residual = 7.27e-06           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.849336645064       residual = 2.88e-06           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.849336673520       residual = 5.26e-07           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.849336727137       residual = 9.03e-08           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.849336733346       residual = 4.07e-08           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.849336723690       residual = 9.66e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         18 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 3.9062e-01 is 1.943252e-03

solving harmonic davidson linear method for identity shift 1.5625e+00, overlap shift 1.5625e+01 and omega -1.7527e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.843835539527       residual = 4.97e-01           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.845022987671       residual = 1.01e-01           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.845281190360       residual = 1.61e-02           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.845343009691       residual = 3.41e-03           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.845359359695       residual = 1.20e-03           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.845366196833       residual = 8.13e-04           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.845368903165       residual = 2.76e-04           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.845369917437       residual = 7.28e-05           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.845370226684       residual = 3.13e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.845370286450       residual = 1.55e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.845370347633       residual = 1.55e-05           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.845370290254       residual = 8.92e-06           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.845370396627       residual = 9.58e-06           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.845370588087       residual = 4.43e-06           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.845370625999       residual = 1.43e-06           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.845370626821       residual = 2.38e-07           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.845370635629       residual = 4.40e-08           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.845370636171       residual = 1.92e-08           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.845370634277       residual = 4.23e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         18 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 1.5625e+00 is 5.484419e-04

solving harmonic davidson linear method for identity shift 6.2500e+00, overlap shift 6.2500e+01 and omega -1.7527e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.843835539527       residual = 4.97e-01           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.844142096569       residual = 9.98e-02           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.844208178535       residual = 1.58e-02           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.844223831804       residual = 3.32e-03           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.844227945260       residual = 1.17e-03           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.844229650473       residual = 7.72e-04           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.844230313768       residual = 2.61e-04           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.844230559262       residual = 6.82e-05           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.844230632624       residual = 2.93e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.844230646233       residual = 1.47e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.844230661286       residual = 1.47e-05           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.844230647030       residual = 8.43e-06           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.844230674309       residual = 8.80e-06           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.844230720212       residual = 3.82e-06           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.844230728346       residual = 1.16e-06           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.844230728275       residual = 1.90e-07           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.844230730226       residual = 3.60e-08           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.844230730312       residual = 1.55e-08           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.844230729873       residual = 3.35e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         18 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 6.2500e+00 is 1.416463e-04

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.411183 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 75 and numParams is: 74

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.7934e+01
  </log>
  <optVariables href="H2O.s021.opt.xml">
ci_0001                 6.970091e-01 3 1  ON 0
ci_0002                 6.959385e-01 3 1  ON 1
ci_0003                -4.226300e-02 3 1  ON 2
ci_0004                -4.234094e-02 3 1  ON 3
ci_0005                -3.988726e-02 3 1  ON 4
ci_0006                -4.028044e-02 3 1  ON 5
ci_0007                -2.843085e-02 3 1  ON 6
ci_0008                -2.851845e-02 3 1  ON 7
ci_0009                -2.701361e-02 3 1  ON 8
ci_0010                -2.704080e-02 3 1  ON 9
ci_0011                -2.274051e-02 3 1  ON 10
ci_0012                -2.256537e-02 3 1  ON 11
ci_0013                 2.229643e-02 3 1  ON 12
ci_0014                 2.223191e-02 3 1  ON 13
ci_0015                 2.252868e-02 3 1  ON 14
ci_0016                 2.238086e-02 3 1  ON 15
ci_0017                 2.036208e-02 3 1  ON 16
ci_0018                 2.032940e-02 3 1  ON 17
ci_0019                 1.713200e-02 3 1  ON 18
ci_0020                 1.701414e-02 3 1  ON 19
ci_0021                 1.862305e-02 3 1  ON 20
ci_0022                 1.851089e-02 3 1  ON 21
ci_0023                -1.619900e-02 3 1  ON 22
ci_0024                -1.593423e-02 3 1  ON 23
ci_0025                -1.217513e-02 3 1  ON 24
ci_0026                -1.208236e-02 3 1  ON 25
ci_0027                -1.557341e-02 3 1  ON 26
ci_0028                -1.557037e-02 3 1  ON 27
ci_0029                -1.376122e-02 3 1  ON 28
ci_0030                -1.421660e-02 3 1  ON 29
ci_0031                 1.598192e-02 3 1  ON 30
ci_0032                 1.580526e-02 3 1  ON 31
ci_0033                 1.321502e-02 3 1  ON 32
ci_0034                 1.344993e-02 3 1  ON 33
ci_0035                 1.084739e-02 3 1  ON 34
ci_0036                 1.109784e-02 3 1  ON 35
ci_0037                -1.362438e-02 3 1  ON 36
ci_0038                -1.356031e-02 3 1  ON 37
ci_0039                -1.037996e-02 3 1  ON 38
ci_0040                -1.039731e-02 3 1  ON 39
ci_0041                 1.290132e-02 3 1  ON 40
ci_0042                 1.280677e-02 3 1  ON 41
ci_0043                -1.166930e-02 3 1  ON 42
ci_0044                -1.190347e-02 3 1  ON 43
ci_0045                 1.258542e-02 3 1  ON 44
ci_0046                 1.256613e-02 3 1  ON 45
ci_0047                -9.597284e-03 3 1  ON 46
ci_0048                -9.612567e-03 3 1  ON 47
ci_0049                -8.432450e-03 3 1  ON 48
ci_0050                -8.424846e-03 3 1  ON 49
ci_0051                -7.962572e-03 3 1  ON 50
ci_0052                -7.970957e-03 3 1  ON 51
ci_0053                -8.659934e-03 3 1  ON 52
ci_0054                -8.642003e-03 3 1  ON 53
ci_0055                 7.553755e-03 3 1  ON 54
ci_0056                 7.853757e-03 3 1  ON 55
ci_0057                 7.649806e-03 3 1  ON 56
ci_0058                 8.434477e-03 3 1  ON 57
ci_0059                -8.598541e-03 3 1  ON 58
ci_0060                -8.403107e-03 3 1  ON 59
ci_0061                -8.472169e-03 3 1  ON 60
ci_0062                -8.542187e-03 3 1  ON 61
ci_0063                -1.063623e-02 3 1  ON 62
ci_0064                -1.057298e-02 3 1  ON 63
ci_0065                -9.449016e-03 3 1  ON 64
ci_0066                -9.518681e-03 3 1  ON 65
ci_0067                -8.043017e-03 3 1  ON 66
ci_0068                -8.207251e-03 3 1  ON 67
ci_0069                 7.604595e-03 3 1  ON 68
ci_0070                 7.496253e-03 3 1  ON 69
ci_0071                 8.326462e-03 3 1  ON 70
ci_0072                 8.055368e-03 3 1  ON 71
ci_0073                 7.282448e-03 3 1  ON 72
ci_0074                 7.391830e-03 3 1  ON 73
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 21
    time step          = 0.05
    reference energy   = -16.8903
    reference variance = 0.199192
====================================================
  Execution time = 1.4743e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s021
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6902e+01
  VMC Evar = 3.3990e-01
  Total weights = 1.9515e+06
  Execution time = 1.9533e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.330371637617
                                         uncertainty =       0.002295419184

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.330371637617
                                         uncertainty =       0.002295419184

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000406375365
  error estimate for blocks of size 2^( 2) =       0.000420587180
  error estimate for blocks of size 2^( 3) =       0.000434716716
  error estimate for blocks of size 2^( 4) =       0.000447639052
  error estimate for blocks of size 2^( 5) =       0.000459431443
  error estimate for blocks of size 2^( 6) =       0.000468633547
  error estimate for blocks of size 2^( 7) =       0.000475313030

      target function =      -0.834643772952
              le_mean =     -16.901560125942
             les_mean =     286.020807639269
             stat err =       0.000462754268
             autocorr =       1.296719731828
   target nu stat err =       0.000462754268
   target dn stat err =       0.009835188562
      target stat err =       0.010982476328
              std dev =       0.574701553267
             le_variance =       0.330281875327

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.322046539410
                                         uncertainty =       0.002194967230

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.322046539410
                                         uncertainty =       0.002194967230

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000401227474
  error estimate for blocks of size 2^( 2) =       0.000415424393
  error estimate for blocks of size 2^( 3) =       0.000429584998
  error estimate for blocks of size 2^( 4) =       0.000442537676
  error estimate for blocks of size 2^( 5) =       0.000454480062
  error estimate for blocks of size 2^( 6) =       0.000463690124
  error estimate for blocks of size 2^( 7) =       0.000470233999

      target function =      -0.854941818703
              le_mean =     -16.901612432003
             les_mean =     286.004911522182
             stat err =       0.000457735465
             autocorr =       1.301510865950
   target nu stat err =       0.000457735465
   target dn stat err =       0.003834787674
      target stat err =       0.004529042017
              std dev =       0.567421335120
             le_variance =       0.321966971549

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.325352785915
                                         uncertainty =       0.002235868053

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.325352785915
                                         uncertainty =       0.002235868053

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000403279566
  error estimate for blocks of size 2^( 2) =       0.000417480699
  error estimate for blocks of size 2^( 3) =       0.000431619841
  error estimate for blocks of size 2^( 4) =       0.000444561392
  error estimate for blocks of size 2^( 5) =       0.000456434365
  error estimate for blocks of size 2^( 6) =       0.000465641382
  error estimate for blocks of size 2^( 7) =       0.000472252899

      target function =      -0.844199287327
              le_mean =     -16.901554225966
             les_mean =     286.012075578300
             stat err =       0.000459722510
             autocorr =       1.299508435338
   target nu stat err =       0.000459722510
   target dn stat err =       0.011734222576
      target stat err =       0.013398862071
              std dev =       0.570323432278
             le_variance =       0.325268817405

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.329656869683
                                         uncertainty =       0.002287411221

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.329656869683
                                         uncertainty =       0.002287411221

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000405935918
  error estimate for blocks of size 2^( 2) =       0.000420149375
  error estimate for blocks of size 2^( 3) =       0.000434279684
  error estimate for blocks of size 2^( 4) =       0.000447205607
  error estimate for blocks of size 2^( 5) =       0.000459015748
  error estimate for blocks of size 2^( 6) =       0.000468212967
  error estimate for blocks of size 2^( 7) =       0.000474889957

      target function =      -0.851150903074
              le_mean =     -16.901552610047
             les_mean =     286.006146691286
             stat err =       0.000462331070
             autocorr =       1.297152982528
   target nu stat err =       0.000462331070
   target dn stat err =       0.003194458263
      target stat err =       0.003756247521
              std dev =       0.574080081262
             le_variance =       0.329567939702


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.834643772952        initial
     3.9062e-01     3.9062e+00             1.9433e-03        -0.854941818703  <--
     1.5625e+00     1.5625e+01             5.4844e-04        -0.844199287327
     6.2500e+00     6.2500e+01             1.4165e-04        -0.851150903074

*****************************************************************************
Applying the update for shift_i =   3.9062e-01     and shift_s =   3.9062e+00
*****************************************************************************

  Execution time = 2.4716e+01
  </log>
  <optVariables href="H2O.s021.opt.xml">
ci_0001                 6.981482e-01 3 1  ON 0
ci_0002                 6.958833e-01 3 1  ON 1
ci_0003                -4.118634e-02 3 1  ON 2
ci_0004                -4.106585e-02 3 1  ON 3
ci_0005                -3.888543e-02 3 1  ON 4
ci_0006                -3.920851e-02 3 1  ON 5
ci_0007                -2.742311e-02 3 1  ON 6
ci_0008                -2.752045e-02 3 1  ON 7
ci_0009                -2.606136e-02 3 1  ON 8
ci_0010                -2.610579e-02 3 1  ON 9
ci_0011                -2.190897e-02 3 1  ON 10
ci_0012                -2.187329e-02 3 1  ON 11
ci_0013                 2.160552e-02 3 1  ON 12
ci_0014                 2.140811e-02 3 1  ON 13
ci_0015                 2.185542e-02 3 1  ON 14
ci_0016                 2.161741e-02 3 1  ON 15
ci_0017                 1.958859e-02 3 1  ON 16
ci_0018                 1.956085e-02 3 1  ON 17
ci_0019                 1.665286e-02 3 1  ON 18
ci_0020                 1.652626e-02 3 1  ON 19
ci_0021                 1.842736e-02 3 1  ON 20
ci_0022                 1.844897e-02 3 1  ON 21
ci_0023                -1.565107e-02 3 1  ON 22
ci_0024                -1.541126e-02 3 1  ON 23
ci_0025                -1.125832e-02 3 1  ON 24
ci_0026                -1.068755e-02 3 1  ON 25
ci_0027                -1.522695e-02 3 1  ON 26
ci_0028                -1.500872e-02 3 1  ON 27
ci_0029                -1.324722e-02 3 1  ON 28
ci_0030                -1.359162e-02 3 1  ON 29
ci_0031                 1.581494e-02 3 1  ON 30
ci_0032                 1.558726e-02 3 1  ON 31
ci_0033                 1.269359e-02 3 1  ON 32
ci_0034                 1.281720e-02 3 1  ON 33
ci_0035                 1.001432e-02 3 1  ON 34
ci_0036                 1.018601e-02 3 1  ON 35
ci_0037                -1.338885e-02 3 1  ON 36
ci_0038                -1.331335e-02 3 1  ON 37
ci_0039                -9.619048e-03 3 1  ON 38
ci_0040                -9.745468e-03 3 1  ON 39
ci_0041                 1.253163e-02 3 1  ON 40
ci_0042                 1.245101e-02 3 1  ON 41
ci_0043                -1.112915e-02 3 1  ON 42
ci_0044                -1.118189e-02 3 1  ON 43
ci_0045                 1.236842e-02 3 1  ON 44
ci_0046                 1.236016e-02 3 1  ON 45
ci_0047                -8.864751e-03 3 1  ON 46
ci_0048                -8.909395e-03 3 1  ON 47
ci_0049                -7.821662e-03 3 1  ON 48
ci_0050                -7.385512e-03 3 1  ON 49
ci_0051                -7.083724e-03 3 1  ON 50
ci_0052                -7.105873e-03 3 1  ON 51
ci_0053                -8.003075e-03 3 1  ON 52
ci_0054                -8.097091e-03 3 1  ON 53
ci_0055                 6.864801e-03 3 1  ON 54
ci_0056                 6.964804e-03 3 1  ON 55
ci_0057                 7.116753e-03 3 1  ON 56
ci_0058                 7.811719e-03 3 1  ON 57
ci_0059                -8.079386e-03 3 1  ON 58
ci_0060                -7.833501e-03 3 1  ON 59
ci_0061                -7.853613e-03 3 1  ON 60
ci_0062                -7.908500e-03 3 1  ON 61
ci_0063                -1.059595e-02 3 1  ON 62
ci_0064                -1.044851e-02 3 1  ON 63
ci_0065                -9.195141e-03 3 1  ON 64
ci_0066                -9.170724e-03 3 1  ON 65
ci_0067                -7.504706e-03 3 1  ON 66
ci_0068                -7.660018e-03 3 1  ON 67
ci_0069                 7.087910e-03 3 1  ON 68
ci_0070                 6.929476e-03 3 1  ON 69
ci_0071                 7.854912e-03 3 1  ON 70
ci_0072                 7.699067e-03 3 1  ON 71
ci_0073                 6.824061e-03 3 1  ON 72
ci_0074                 6.891248e-03 3 1  ON 73
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 4.2665e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s022 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s022 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=22  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6890e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 22
    time step          = 0.05
    reference energy   = -16.9807
    reference variance = 0.233124
====================================================
  Execution time = 1.5285e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s022
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5241e+04
  VMC Eavg = -1.6901e+01
  VMC Evar = 3.4104e-01
  Total weights = 1.951373662e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 2.6741e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.327085521493
                                         uncertainty =       0.002423290668

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.327085521493
                                         uncertainty =       0.002423290668

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000404333113
  error estimate for blocks of size 2^( 2) =       0.000418904314
  error estimate for blocks of size 2^( 3) =       0.000433052937
  error estimate for blocks of size 2^( 4) =       0.000446477978
  error estimate for blocks of size 2^( 5) =       0.000458115783
  error estimate for blocks of size 2^( 6) =       0.000466016284
  error estimate for blocks of size 2^( 7) =       0.000472054598

      target function =      -0.854188399691
              le_mean =     -16.901433030220
             les_mean =     285.999480634226
             stat err =       0.000460666161
             autocorr =       1.298057720881
   target nu stat err =       0.000460666161
   target dn stat err =       0.003395569924
      target stat err =       0.004013313640
              std dev =       0.571813371829
             le_variance =       0.326970532203


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690143303022e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 74
Check correct_vf_var_size: 225, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 9.7656e-02, overlap shift 9.7656e-01 and omega -1.7527e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.854206144463       residual = 3.60e-01           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.863148254508       residual = 6.64e-02           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.864819037417       residual = 1.42e-02           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.865341776418       residual = 3.26e-03           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.865479875990       residual = 1.50e-03           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.865545750193       residual = 1.22e-03           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.865588315600       residual = 3.53e-04           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.865601676130       residual = 1.13e-04           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.865606484878       residual = 4.55e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.865607906468       residual = 1.95e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.865608395366       residual = 1.56e-05           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.865608449272       residual = 7.91e-06           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.865609082054       residual = 1.15e-05           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.865609729412       residual = 1.07e-05           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.865610487938       residual = 9.31e-06           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.865610540452       residual = 2.18e-06           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.865610441287       residual = 4.20e-07           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.865610362493       residual = 1.54e-07           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.865610352408       residual = 4.11e-08           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.865610341684       residual = 2.00e-08           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.865610353353       residual = 3.68e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         20 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 9.7656e-02 is 4.406976e-03

solving harmonic davidson linear method for identity shift 3.9062e-01, overlap shift 3.9062e+00 and omega -1.7527e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.854206144463       residual = 3.60e-01           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.857470276795       residual = 6.21e-02           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.858044403247       residual = 1.25e-02           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.858208245116       residual = 2.63e-03           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.858249676897       residual = 1.15e-03           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.858268051979       residual = 8.35e-04           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.858277947664       residual = 2.20e-04           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.858280700948       residual = 6.38e-05           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.858281579728       residual = 2.33e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.858281777769       residual = 1.09e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.858281829598       residual = 8.47e-06           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.858281803543       residual = 4.76e-06           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.858281965767       residual = 6.83e-06           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.858282077673       residual = 3.93e-06           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.858282160078       residual = 1.61e-06           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.858282131227       residual = 2.73e-07           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.858282113919       residual = 5.82e-08           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.858282105493       residual = 1.95e-08           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.858282104109       residual = 4.83e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         18 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 3.9062e-01 is 1.623333e-03

solving harmonic davidson linear method for identity shift 1.5625e+00, overlap shift 1.5625e+01 and omega -1.7527e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.854206144463       residual = 3.60e-01           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.855127100335       residual = 6.02e-02           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.855284798553       residual = 1.18e-02           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.855328087556       residual = 2.40e-03           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.855338851866       residual = 1.02e-03           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.855343473652       residual = 7.10e-04           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.855345782661       residual = 1.81e-04           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.855346393631       residual = 5.07e-05           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.855346579089       residual = 1.79e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.855346614265       residual = 8.78e-06           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.855346621741       residual = 6.74e-06           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.855346613126       residual = 3.93e-06           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.855346653327       residual = 5.29e-06           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.855346675843       residual = 2.44e-06           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.855346689757       residual = 7.84e-07           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.855346682387       residual = 1.25e-07           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.855346678896       residual = 2.81e-08           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.855346677491       residual = 9.02e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         17 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 1.5625e+00 is 4.597366e-04

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.423314 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 75 and numParams is: 74

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.7977e+01
  </log>
  <optVariables href="H2O.s022.opt.xml">
ci_0001                 6.993245e-01 3 1  ON 0
ci_0002                 6.959238e-01 3 1  ON 1
ci_0003                -3.989120e-02 3 1  ON 2
ci_0004                -3.974834e-02 3 1  ON 3
ci_0005                -3.752243e-02 3 1  ON 4
ci_0006                -3.800882e-02 3 1  ON 5
ci_0007                -2.625731e-02 3 1  ON 6
ci_0008                -2.648400e-02 3 1  ON 7
ci_0009                -2.498392e-02 3 1  ON 8
ci_0010                -2.500613e-02 3 1  ON 9
ci_0011                -2.110174e-02 3 1  ON 10
ci_0012                -2.103944e-02 3 1  ON 11
ci_0013                 2.073250e-02 3 1  ON 12
ci_0014                 2.047290e-02 3 1  ON 13
ci_0015                 2.101145e-02 3 1  ON 14
ci_0016                 2.070457e-02 3 1  ON 15
ci_0017                 1.873936e-02 3 1  ON 16
ci_0018                 1.875965e-02 3 1  ON 17
ci_0019                 1.600838e-02 3 1  ON 18
ci_0020                 1.580981e-02 3 1  ON 19
ci_0021                 1.796982e-02 3 1  ON 20
ci_0022                 1.801415e-02 3 1  ON 21
ci_0023                -1.509265e-02 3 1  ON 22
ci_0024                -1.463460e-02 3 1  ON 23
ci_0025                -9.806637e-03 3 1  ON 24
ci_0026                -9.064220e-03 3 1  ON 25
ci_0027                -1.465515e-02 3 1  ON 26
ci_0028                -1.444284e-02 3 1  ON 27
ci_0029                -1.275191e-02 3 1  ON 28
ci_0030                -1.293413e-02 3 1  ON 29
ci_0031                 1.550264e-02 3 1  ON 30
ci_0032                 1.539414e-02 3 1  ON 31
ci_0033                 1.212174e-02 3 1  ON 32
ci_0034                 1.230324e-02 3 1  ON 33
ci_0035                 9.126604e-03 3 1  ON 34
ci_0036                 9.378222e-03 3 1  ON 35
ci_0037                -1.299569e-02 3 1  ON 36
ci_0038                -1.271990e-02 3 1  ON 37
ci_0039                -8.725725e-03 3 1  ON 38
ci_0040                -8.808406e-03 3 1  ON 39
ci_0041                 1.219837e-02 3 1  ON 40
ci_0042                 1.192401e-02 3 1  ON 41
ci_0043                -1.034040e-02 3 1  ON 42
ci_0044                -1.028718e-02 3 1  ON 43
ci_0045                 1.221495e-02 3 1  ON 44
ci_0046                 1.193712e-02 3 1  ON 45
ci_0047                -7.948795e-03 3 1  ON 46
ci_0048                -8.022209e-03 3 1  ON 47
ci_0049                -6.799672e-03 3 1  ON 48
ci_0050                -6.601284e-03 3 1  ON 49
ci_0051                -6.157344e-03 3 1  ON 50
ci_0052                -6.140192e-03 3 1  ON 51
ci_0053                -7.170124e-03 3 1  ON 52
ci_0054                -7.303195e-03 3 1  ON 53
ci_0055                 6.100212e-03 3 1  ON 54
ci_0056                 6.093018e-03 3 1  ON 55
ci_0057                 6.522459e-03 3 1  ON 56
ci_0058                 7.119029e-03 3 1  ON 57
ci_0059                -7.366198e-03 3 1  ON 58
ci_0060                -7.165274e-03 3 1  ON 59
ci_0061                -7.097025e-03 3 1  ON 60
ci_0062                -7.111869e-03 3 1  ON 61
ci_0063                -1.055851e-02 3 1  ON 62
ci_0064                -1.037121e-02 3 1  ON 63
ci_0065                -8.785765e-03 3 1  ON 64
ci_0066                -8.670072e-03 3 1  ON 65
ci_0067                -6.793846e-03 3 1  ON 66
ci_0068                -7.019342e-03 3 1  ON 67
ci_0069                 6.319251e-03 3 1  ON 68
ci_0070                 6.249417e-03 3 1  ON 69
ci_0071                 7.153452e-03 3 1  ON 70
ci_0072                 7.292108e-03 3 1  ON 71
ci_0073                 6.283072e-03 3 1  ON 72
ci_0074                 6.315332e-03 3 1  ON 73
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 22
    time step          = 0.05
    reference energy   = -16.8824
    reference variance = 0.204622
====================================================
  Execution time = 1.4633e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s022
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6902e+01
  VMC Evar = 3.3174e-01
  Total weights = 1.9510e+06
  Execution time = 1.9723e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.340648862665
                                         uncertainty =       0.014753709925

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.340648862665
                                         uncertainty =       0.014753709925

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000412666650
  error estimate for blocks of size 2^( 2) =       0.000426329658
  error estimate for blocks of size 2^( 3) =       0.000440055544
  error estimate for blocks of size 2^( 4) =       0.000452160311
  error estimate for blocks of size 2^( 5) =       0.000463114059
  error estimate for blocks of size 2^( 6) =       0.000469898316
  error estimate for blocks of size 2^( 7) =       0.000473950080

      target function =      -0.624009260470
              le_mean =     -16.902067361704
             les_mean =     286.242885166000
             stat err =       0.000464780692
             autocorr =       1.268520271378
   target nu stat err =       0.000464780692
   target dn stat err =       0.213372849634
      target stat err =       0.139723287769
              std dev =       0.583598772609
             le_variance =       0.340587527390

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.319533311320
                                         uncertainty =       0.007251476240

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.319533311320
                                         uncertainty =       0.007251476240

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000399641192
  error estimate for blocks of size 2^( 2) =       0.000413470467
  error estimate for blocks of size 2^( 3) =       0.000427559667
  error estimate for blocks of size 2^( 4) =       0.000439770965
  error estimate for blocks of size 2^( 5) =       0.000451078695
  error estimate for blocks of size 2^( 6) =       0.000458345745
  error estimate for blocks of size 2^( 7) =       0.000462745840

      target function =      -0.786174789354
              le_mean =     -16.902193829442
             les_mean =     286.085847666476
             stat err =       0.000452985311
             autocorr =       1.284776988207
   target nu stat err =       0.000452985311
   target dn stat err =       0.045901494807
      target stat err =       0.045598221736
              std dev =       0.565177993107
             le_variance =       0.319426163892

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.316673503864
                                         uncertainty =       0.002689808972

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.316673503864
                                         uncertainty =       0.002689808972

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000397850844
  error estimate for blocks of size 2^( 2) =       0.000411752421
  error estimate for blocks of size 2^( 3) =       0.000425811975
  error estimate for blocks of size 2^( 4) =       0.000438154375
  error estimate for blocks of size 2^( 5) =       0.000449407514
  error estimate for blocks of size 2^( 6) =       0.000456653547
  error estimate for blocks of size 2^( 7) =       0.000461330664

      target function =      -0.801521372779
              le_mean =     -16.901926095551
             les_mean =     286.061803678841
             stat err =       0.000451386525
             autocorr =       1.287231360880
   target nu stat err =       0.000451386525
   target dn stat err =       0.043613800511
      target stat err =       0.045005147667
              std dev =       0.562646060045
             le_variance =       0.316570588884

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.324696500968
                                         uncertainty =       0.002246501026

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.324696500968
                                         uncertainty =       0.002246501026

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000402864665
  error estimate for blocks of size 2^( 2) =       0.000416788274
  error estimate for blocks of size 2^( 3) =       0.000430873954
  error estimate for blocks of size 2^( 4) =       0.000443092557
  error estimate for blocks of size 2^( 5) =       0.000454220441
  error estimate for blocks of size 2^( 6) =       0.000461112539
  error estimate for blocks of size 2^( 7) =       0.000465318226

      target function =      -0.845136868876
              le_mean =     -16.901955855530
             les_mean =     286.024852307251
             stat err =       0.000455935941
             autocorr =       1.280823546904
   target nu stat err =       0.000455935941
   target dn stat err =       0.011821237427
      target stat err =       0.013536539539
              std dev =       0.569736672393
             le_variance =       0.324599875870


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.624009260470        initial
     9.7656e-02     9.7656e-01             4.4070e-03        -0.786174789354
     3.9062e-01     3.9062e+00             1.6233e-03        -0.801521372779
     1.5625e+00     1.5625e+01             4.5974e-04        -0.845136868876  <--

*****************************************************************************
Applying the update for shift_i =   1.5625e+00     and shift_s =   1.5625e+01
*****************************************************************************

  Execution time = 2.4568e+01
  </log>
  <optVariables href="H2O.s022.opt.xml">
ci_0001                 6.984581e-01 3 1  ON 0
ci_0002                 6.959097e-01 3 1  ON 1
ci_0003                -4.082891e-02 3 1  ON 2
ci_0004                -4.070316e-02 3 1  ON 3
ci_0005                -3.851727e-02 3 1  ON 4
ci_0006                -3.888456e-02 3 1  ON 5
ci_0007                -2.711283e-02 3 1  ON 6
ci_0008                -2.724487e-02 3 1  ON 7
ci_0009                -2.576079e-02 3 1  ON 8
ci_0010                -2.579984e-02 3 1  ON 9
ci_0011                -2.168432e-02 3 1  ON 10
ci_0012                -2.164144e-02 3 1  ON 11
ci_0013                 2.136274e-02 3 1  ON 12
ci_0014                 2.114863e-02 3 1  ON 13
ci_0015                 2.162076e-02 3 1  ON 14
ci_0016                 2.136440e-02 3 1  ON 15
ci_0017                 1.935191e-02 3 1  ON 16
ci_0018                 1.933800e-02 3 1  ON 17
ci_0019                 1.647248e-02 3 1  ON 18
ci_0020                 1.632654e-02 3 1  ON 19
ci_0021                 1.830802e-02 3 1  ON 20
ci_0022                 1.833600e-02 3 1  ON 21
ci_0023                -1.549439e-02 3 1  ON 22
ci_0024                -1.519461e-02 3 1  ON 23
ci_0025                -1.084835e-02 3 1  ON 24
ci_0026                -1.022782e-02 3 1  ON 25
ci_0027                -1.506682e-02 3 1  ON 26
ci_0028                -1.485045e-02 3 1  ON 27
ci_0029                -1.310758e-02 3 1  ON 28
ci_0030                -1.340760e-02 3 1  ON 29
ci_0031                 1.573122e-02 3 1  ON 30
ci_0032                 1.553508e-02 3 1  ON 31
ci_0033                 1.253966e-02 3 1  ON 32
ci_0034                 1.267827e-02 3 1  ON 33
ci_0035                 9.762970e-03 3 1  ON 34
ci_0036                 9.957665e-03 3 1  ON 35
ci_0037                -1.328079e-02 3 1  ON 36
ci_0038                -1.315094e-02 3 1  ON 37
ci_0039                -9.367615e-03 3 1  ON 38
ci_0040                -9.481828e-03 3 1  ON 39
ci_0041                 1.243952e-02 3 1  ON 40
ci_0042                 1.230558e-02 3 1  ON 41
ci_0043                -1.091600e-02 3 1  ON 42
ci_0044                -1.094137e-02 3 1  ON 43
ci_0045                 1.232578e-02 3 1  ON 44
ci_0046                 1.224475e-02 3 1  ON 45
ci_0047                -8.607224e-03 3 1  ON 46
ci_0048                -8.660020e-03 3 1  ON 47
ci_0049                -7.532433e-03 3 1  ON 48
ci_0050                -7.163473e-03 3 1  ON 49
ci_0051                -6.819853e-03 3 1  ON 50
ci_0052                -6.831005e-03 3 1  ON 51
ci_0053                -7.767566e-03 3 1  ON 52
ci_0054                -7.872624e-03 3 1  ON 53
ci_0055                 6.648532e-03 3 1  ON 54
ci_0056                 6.717268e-03 3 1  ON 55
ci_0057                 6.948610e-03 3 1  ON 56
ci_0058                 7.616717e-03 3 1  ON 57
ci_0059                -7.877470e-03 3 1  ON 58
ci_0060                -7.644525e-03 3 1  ON 59
ci_0061                -7.643567e-03 3 1  ON 60
ci_0062                -7.687407e-03 3 1  ON 61
ci_0063                -1.058512e-02 3 1  ON 62
ci_0064                -1.042670e-02 3 1  ON 63
ci_0065                -9.081596e-03 3 1  ON 64
ci_0066                -9.031899e-03 3 1  ON 65
ci_0067                -7.303251e-03 3 1  ON 66
ci_0068                -7.478776e-03 3 1  ON 67
ci_0069                 6.870320e-03 3 1  ON 68
ci_0070                 6.737002e-03 3 1  ON 69
ci_0071                 7.657243e-03 3 1  ON 70
ci_0072                 7.584992e-03 3 1  ON 71
ci_0073                 6.670647e-03 3 1  ON 72
ci_0074                 6.728110e-03 3 1  ON 73
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 4.2551e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s023 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s023 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=23  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6892e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 23
    time step          = 0.05
    reference energy   = -16.9547
    reference variance = 0.317859
====================================================
  Execution time = 1.5059e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s023
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5268e+04
  VMC Eavg = -1.6901e+01
  VMC Evar = 3.3823e-01
  Total weights = 1.951233110e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 2.6589e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.324260359438
                                         uncertainty =       0.002521580892

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.324260359438
                                         uncertainty =       0.002521580892

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000402601866
  error estimate for blocks of size 2^( 2) =       0.000416466310
  error estimate for blocks of size 2^( 3) =       0.000431013152
  error estimate for blocks of size 2^( 4) =       0.000444471734
  error estimate for blocks of size 2^( 5) =       0.000455875262
  error estimate for blocks of size 2^( 6) =       0.000465752493
  error estimate for blocks of size 2^( 7) =       0.000474621041

      target function =      -0.857433891988
              le_mean =     -16.900895350907
             les_mean =     285.978490224052
             stat err =       0.000460180133
             autocorr =       1.306484202090
   target nu stat err =       0.000460180133
   target dn stat err =       0.003417285670
      target stat err =       0.004065124460
              std dev =       0.569365019295
             le_variance =       0.324176525197


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690089535091e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 74
Check correct_vf_var_size: 225, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 3.9062e-01, overlap shift 3.9062e+00 and omega -1.7527e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.857452130673       residual = 3.32e-01           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.860414431230       residual = 6.00e-02           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.860973359252       residual = 1.25e-02           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.861139063193       residual = 2.54e-03           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.861181634413       residual = 1.09e-03           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.861205352986       residual = 4.80e-04           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.861211785162       residual = 1.48e-04           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.861212365756       residual = 8.80e-05           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.861213113392       residual = 3.78e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.861213309177       residual = 2.33e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.861213631466       residual = 2.44e-05           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.861214042275       residual = 1.57e-05           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.861214307355       residual = 1.65e-05           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.861214369138       residual = 7.15e-06           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.861214326512       residual = 2.71e-06           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.861214380730       residual = 4.22e-07           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.861214440897       residual = 7.45e-08           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.861214450632       residual = 3.35e-08           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.861214458815       residual = 9.94e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         18 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 3.9062e-01 is 1.702483e-03

solving harmonic davidson linear method for identity shift 1.5625e+00, overlap shift 1.5625e+01 and omega -1.7527e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.857452130673       residual = 3.32e-01           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.858288665296       residual = 5.82e-02           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.858442113396       residual = 1.18e-02           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.858485892986       residual = 2.33e-03           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.858496959830       residual = 9.81e-04           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.858502825207       residual = 4.02e-04           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.858504307948       residual = 1.16e-04           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.858504407694       residual = 6.91e-05           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.858504567855       residual = 3.13e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.858504602770       residual = 2.00e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.858504684524       residual = 1.98e-05           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.858504774396       residual = 1.23e-05           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.858504824064       residual = 1.11e-05           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.858504831284       residual = 4.06e-06           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.858504821092       residual = 1.32e-06           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.858504830995       residual = 1.90e-07           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.858504842758       residual = 3.75e-08           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.858504844722       residual = 1.58e-08           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.858504845963       residual = 4.40e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         18 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 1.5625e+00 is 4.823864e-04

solving harmonic davidson linear method for identity shift 6.2500e+00, overlap shift 6.2500e+01 and omega -1.7527e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.857452130673       residual = 3.32e-01           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.857668238869       residual = 5.76e-02           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.857707547697       residual = 1.16e-02           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.857718637036       residual = 2.27e-03           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.857721427393       residual = 9.51e-04           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.857722884760       residual = 3.82e-04           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.857723245550       residual = 1.08e-04           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.857723267409       residual = 6.42e-05           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.857723305721       residual = 2.97e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.857723313461       residual = 1.92e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.857723334019       residual = 1.86e-05           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.857723355512       residual = 1.14e-05           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.857723366780       residual = 9.86e-06           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.857723368187       residual = 3.44e-06           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.857723365731       residual = 1.07e-06           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.857723368001       residual = 1.52e-07           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.857723370746       residual = 3.10e-08           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.857723371203       residual = 1.28e-08           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.857723371468       residual = 3.48e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         18 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 6.2500e+00 is 1.247406e-04

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.434952 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 75 and numParams is: 74

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.7736e+01
  </log>
  <optVariables href="H2O.s023.opt.xml">
ci_0001                 6.983921e-01 3 1  ON 0
ci_0002                 6.963064e-01 3 1  ON 1
ci_0003                -4.036367e-02 3 1  ON 2
ci_0004                -4.036048e-02 3 1  ON 3
ci_0005                -3.811434e-02 3 1  ON 4
ci_0006                -3.852259e-02 3 1  ON 5
ci_0007                -2.673298e-02 3 1  ON 6
ci_0008                -2.696079e-02 3 1  ON 7
ci_0009                -2.546638e-02 3 1  ON 8
ci_0010                -2.548095e-02 3 1  ON 9
ci_0011                -2.139636e-02 3 1  ON 10
ci_0012                -2.137549e-02 3 1  ON 11
ci_0013                 2.109506e-02 3 1  ON 12
ci_0014                 2.093082e-02 3 1  ON 13
ci_0015                 2.134723e-02 3 1  ON 14
ci_0016                 2.116883e-02 3 1  ON 15
ci_0017                 1.909770e-02 3 1  ON 16
ci_0018                 1.910280e-02 3 1  ON 17
ci_0019                 1.633889e-02 3 1  ON 18
ci_0020                 1.614606e-02 3 1  ON 19
ci_0021                 1.811279e-02 3 1  ON 20
ci_0022                 1.832371e-02 3 1  ON 21
ci_0023                -1.533197e-02 3 1  ON 22
ci_0024                -1.500434e-02 3 1  ON 23
ci_0025                -1.036597e-02 3 1  ON 24
ci_0026                -9.861635e-03 3 1  ON 25
ci_0027                -1.486633e-02 3 1  ON 26
ci_0028                -1.469164e-02 3 1  ON 27
ci_0029                -1.293109e-02 3 1  ON 28
ci_0030                -1.324196e-02 3 1  ON 29
ci_0031                 1.567075e-02 3 1  ON 30
ci_0032                 1.547460e-02 3 1  ON 31
ci_0033                 1.236444e-02 3 1  ON 32
ci_0034                 1.258060e-02 3 1  ON 33
ci_0035                 9.553957e-03 3 1  ON 34
ci_0036                 9.736482e-03 3 1  ON 35
ci_0037                -1.320771e-02 3 1  ON 36
ci_0038                -1.309389e-02 3 1  ON 37
ci_0039                -9.075652e-03 3 1  ON 38
ci_0040                -9.221971e-03 3 1  ON 39
ci_0041                 1.231548e-02 3 1  ON 40
ci_0042                 1.221639e-02 3 1  ON 41
ci_0043                -1.076444e-02 3 1  ON 42
ci_0044                -1.084023e-02 3 1  ON 43
ci_0045                 1.225398e-02 3 1  ON 44
ci_0046                 1.214656e-02 3 1  ON 45
ci_0047                -8.383099e-03 3 1  ON 46
ci_0048                -8.429853e-03 3 1  ON 47
ci_0049                -7.363379e-03 3 1  ON 48
ci_0050                -6.951942e-03 3 1  ON 49
ci_0051                -6.551798e-03 3 1  ON 50
ci_0052                -6.581117e-03 3 1  ON 51
ci_0053                -7.590342e-03 3 1  ON 52
ci_0054                -7.680490e-03 3 1  ON 53
ci_0055                 6.464326e-03 3 1  ON 54
ci_0056                 6.477916e-03 3 1  ON 55
ci_0057                 6.826565e-03 3 1  ON 56
ci_0058                 7.396413e-03 3 1  ON 57
ci_0059                -7.679144e-03 3 1  ON 58
ci_0060                -7.468272e-03 3 1  ON 59
ci_0061                -7.493106e-03 3 1  ON 60
ci_0062                -7.464645e-03 3 1  ON 61
ci_0063                -1.057327e-02 3 1  ON 62
ci_0064                -1.040948e-02 3 1  ON 63
ci_0065                -9.041650e-03 3 1  ON 64
ci_0066                -8.938185e-03 3 1  ON 65
ci_0067                -7.125589e-03 3 1  ON 66
ci_0068                -7.314825e-03 3 1  ON 67
ci_0069                 6.691354e-03 3 1  ON 68
ci_0070                 6.612261e-03 3 1  ON 69
ci_0071                 7.457000e-03 3 1  ON 70
ci_0072                 7.460496e-03 3 1  ON 71
ci_0073                 6.579681e-03 3 1  ON 72
ci_0074                 6.580294e-03 3 1  ON 73
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 23
    time step          = 0.05
    reference energy   = -16.9654
    reference variance = 0.204036
====================================================
  Execution time = 1.4759e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s023
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6902e+01
  VMC Evar = 3.3488e-01
  Total weights = 1.9512e+06
  Execution time = 1.9796e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.323860539423
                                         uncertainty =       0.002681413938

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.323860539423
                                         uncertainty =       0.002681413938

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000402431085
  error estimate for blocks of size 2^( 2) =       0.000416396935
  error estimate for blocks of size 2^( 3) =       0.000430381380
  error estimate for blocks of size 2^( 4) =       0.000442455467
  error estimate for blocks of size 2^( 5) =       0.000453708474
  error estimate for blocks of size 2^( 6) =       0.000462228832
  error estimate for blocks of size 2^( 7) =       0.000465597416

      target function =      -0.841796724283
              le_mean =     -16.901609926975
             les_mean =     286.015960023272
             stat err =       0.000455997547
             autocorr =       1.283931853245
   target nu stat err =       0.000455997547
   target dn stat err =       0.014906682613
      target stat err =       0.016921702375
              std dev =       0.569123498848
             le_variance =       0.323901556941

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.319994262719
                                         uncertainty =       0.002926470462

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.319994262719
                                         uncertainty =       0.002926470462

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000400013344
  error estimate for blocks of size 2^( 2) =       0.000413936329
  error estimate for blocks of size 2^( 3) =       0.000427906656
  error estimate for blocks of size 2^( 4) =       0.000440018515
  error estimate for blocks of size 2^( 5) =       0.000451249493
  error estimate for blocks of size 2^( 6) =       0.000459889994
  error estimate for blocks of size 2^( 7) =       0.000463123227

      target function =      -0.328866855294
              le_mean =     -16.901700408915
             les_mean =     286.778163947513
             stat err =       0.000453570307
             autocorr =       1.285701864761
   target nu stat err =       0.000453570307
   target dn stat err =       0.774041258920
      target stat err =       0.169582669380
              std dev =       0.565704295976
             le_variance =       0.320021350486

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.320642298257
                                         uncertainty =       0.002629579083

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.320642298257
                                         uncertainty =       0.002629579083

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000400423938
  error estimate for blocks of size 2^( 2) =       0.000414381034
  error estimate for blocks of size 2^( 3) =       0.000428379398
  error estimate for blocks of size 2^( 4) =       0.000440498460
  error estimate for blocks of size 2^( 5) =       0.000451769618
  error estimate for blocks of size 2^( 6) =       0.000460329623
  error estimate for blocks of size 2^( 7) =       0.000463624047

      target function =      -0.860302447153
              le_mean =     -16.901622145447
             les_mean =     286.000689061698
             stat err =       0.000454055437
             autocorr =       1.285812654424
   target nu stat err =       0.000454055437
   target dn stat err =       0.003388427241
      target stat err =       0.004061728350
              std dev =       0.566284964282
             le_variance =       0.320678660772

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.323400275927
                                         uncertainty =       0.002674812440

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.323400275927
                                         uncertainty =       0.002674812440

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000402144717
  error estimate for blocks of size 2^( 2) =       0.000416107730
  error estimate for blocks of size 2^( 3) =       0.000430093738
  error estimate for blocks of size 2^( 4) =       0.000442165728
  error estimate for blocks of size 2^( 5) =       0.000453414704
  error estimate for blocks of size 2^( 6) =       0.000461941084
  error estimate for blocks of size 2^( 7) =       0.000465306525

      target function =      -0.859373724736
              le_mean =     -16.901610469160
             les_mean =     286.001080531050
             stat err =       0.000455707010
             autocorr =       1.284123173522
   target nu stat err =       0.000455707010
   target dn stat err =       0.003143236315
      target stat err =       0.003767303830
              std dev =       0.568718512642
             le_variance =       0.323440746621


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.841796724283        initial
     3.9062e-01     3.9062e+00             1.7025e-03        -0.328866855294
     1.5625e+00     1.5625e+01             4.8239e-04        -0.860302447153  <--
     6.2500e+00     6.2500e+01             1.2474e-04        -0.859373724736

*****************************************************************************
Applying the update for shift_i =   1.5625e+00     and shift_s =   1.5625e+01
*****************************************************************************

  Execution time = 2.4785e+01
  </log>
  <optVariables href="H2O.s023.opt.xml">
ci_0001                 6.983921e-01 3 1  ON 0
ci_0002                 6.963064e-01 3 1  ON 1
ci_0003                -4.036367e-02 3 1  ON 2
ci_0004                -4.036048e-02 3 1  ON 3
ci_0005                -3.811434e-02 3 1  ON 4
ci_0006                -3.852259e-02 3 1  ON 5
ci_0007                -2.673298e-02 3 1  ON 6
ci_0008                -2.696079e-02 3 1  ON 7
ci_0009                -2.546638e-02 3 1  ON 8
ci_0010                -2.548095e-02 3 1  ON 9
ci_0011                -2.139636e-02 3 1  ON 10
ci_0012                -2.137549e-02 3 1  ON 11
ci_0013                 2.109506e-02 3 1  ON 12
ci_0014                 2.093082e-02 3 1  ON 13
ci_0015                 2.134723e-02 3 1  ON 14
ci_0016                 2.116883e-02 3 1  ON 15
ci_0017                 1.909770e-02 3 1  ON 16
ci_0018                 1.910280e-02 3 1  ON 17
ci_0019                 1.633889e-02 3 1  ON 18
ci_0020                 1.614606e-02 3 1  ON 19
ci_0021                 1.811279e-02 3 1  ON 20
ci_0022                 1.832371e-02 3 1  ON 21
ci_0023                -1.533197e-02 3 1  ON 22
ci_0024                -1.500434e-02 3 1  ON 23
ci_0025                -1.036597e-02 3 1  ON 24
ci_0026                -9.861635e-03 3 1  ON 25
ci_0027                -1.486633e-02 3 1  ON 26
ci_0028                -1.469164e-02 3 1  ON 27
ci_0029                -1.293109e-02 3 1  ON 28
ci_0030                -1.324196e-02 3 1  ON 29
ci_0031                 1.567075e-02 3 1  ON 30
ci_0032                 1.547460e-02 3 1  ON 31
ci_0033                 1.236444e-02 3 1  ON 32
ci_0034                 1.258060e-02 3 1  ON 33
ci_0035                 9.553957e-03 3 1  ON 34
ci_0036                 9.736482e-03 3 1  ON 35
ci_0037                -1.320771e-02 3 1  ON 36
ci_0038                -1.309389e-02 3 1  ON 37
ci_0039                -9.075652e-03 3 1  ON 38
ci_0040                -9.221971e-03 3 1  ON 39
ci_0041                 1.231548e-02 3 1  ON 40
ci_0042                 1.221639e-02 3 1  ON 41
ci_0043                -1.076444e-02 3 1  ON 42
ci_0044                -1.084023e-02 3 1  ON 43
ci_0045                 1.225398e-02 3 1  ON 44
ci_0046                 1.214656e-02 3 1  ON 45
ci_0047                -8.383099e-03 3 1  ON 46
ci_0048                -8.429853e-03 3 1  ON 47
ci_0049                -7.363379e-03 3 1  ON 48
ci_0050                -6.951942e-03 3 1  ON 49
ci_0051                -6.551798e-03 3 1  ON 50
ci_0052                -6.581117e-03 3 1  ON 51
ci_0053                -7.590342e-03 3 1  ON 52
ci_0054                -7.680490e-03 3 1  ON 53
ci_0055                 6.464326e-03 3 1  ON 54
ci_0056                 6.477916e-03 3 1  ON 55
ci_0057                 6.826565e-03 3 1  ON 56
ci_0058                 7.396413e-03 3 1  ON 57
ci_0059                -7.679144e-03 3 1  ON 58
ci_0060                -7.468272e-03 3 1  ON 59
ci_0061                -7.493106e-03 3 1  ON 60
ci_0062                -7.464645e-03 3 1  ON 61
ci_0063                -1.057327e-02 3 1  ON 62
ci_0064                -1.040948e-02 3 1  ON 63
ci_0065                -9.041650e-03 3 1  ON 64
ci_0066                -8.938185e-03 3 1  ON 65
ci_0067                -7.125589e-03 3 1  ON 66
ci_0068                -7.314825e-03 3 1  ON 67
ci_0069                 6.691354e-03 3 1  ON 68
ci_0070                 6.612261e-03 3 1  ON 69
ci_0071                 7.457000e-03 3 1  ON 70
ci_0072                 7.460496e-03 3 1  ON 71
ci_0073                 6.579681e-03 3 1  ON 72
ci_0074                 6.580294e-03 3 1  ON 73
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 4.2526e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s024 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s024 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=24  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6895e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 24
    time step          = 0.05
    reference energy   = -16.9541
    reference variance = 0.202504
====================================================
  Execution time = 1.7389e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s024
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5240e+04
  VMC Eavg = -1.6902e+01
  VMC Evar = 3.4212e-01
  Total weights = 1.951616398e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 2.7041e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.325025346408
                                         uncertainty =       0.003858998794

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.325025346408
                                         uncertainty =       0.003858998794

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000403086214
  error estimate for blocks of size 2^( 2) =       0.000416805188
  error estimate for blocks of size 2^( 3) =       0.000430745864
  error estimate for blocks of size 2^( 4) =       0.000442972557
  error estimate for blocks of size 2^( 5) =       0.000453460987
  error estimate for blocks of size 2^( 6) =       0.000461202748
  error estimate for blocks of size 2^( 7) =       0.000464489921

      target function =      -0.852929729178
              le_mean =     -16.901915625215
             les_mean =     286.016871418855
             stat err =       0.000455531553
             autocorr =       1.277147444731
   target nu stat err =       0.000455531553
   target dn stat err =       0.006371473548
      target stat err =       0.007447648346
              std dev =       0.570049990657
             le_variance =       0.324956991848


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690191562522e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 74
Check correct_vf_var_size: 225, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 3.9062e-01, overlap shift 3.9062e+00 and omega -1.7527e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.852993694251       residual = 3.49e-01           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.856017209641       residual = 6.28e-02           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.856570249793       residual = 1.19e-02           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.856722160609       residual = 2.70e-03           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.856763596360       residual = 1.15e-03           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.856780530070       residual = 8.27e-04           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.856788602576       residual = 3.12e-04           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.856793358000       residual = 8.04e-05           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.856794414868       residual = 4.75e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.856795626366       residual = 3.07e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.856796194712       residual = 3.27e-05           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.856796555529       residual = 1.91e-05           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.856797295904       residual = 2.01e-05           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.856798362568       residual = 6.63e-06           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.856798503576       residual = 3.10e-06           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.856798541270       residual = 3.26e-07           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.856798569132       residual = 9.91e-08           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.856798580195       residual = 3.51e-08           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.856798569303       residual = 1.09e-08           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.856798561071       residual = 3.20e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         19 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 3.9062e-01 is 1.886384e-03

solving harmonic davidson linear method for identity shift 1.5625e+00, overlap shift 1.5625e+01 and omega -1.7527e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.852993694251       residual = 3.49e-01           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.853848480894       residual = 6.10e-02           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.854000292133       residual = 1.12e-02           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.854040574188       residual = 2.45e-03           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.854051254269       residual = 1.03e-03           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.854055496120       residual = 7.01e-04           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.854057403115       residual = 2.56e-04           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.854058529195       residual = 6.57e-05           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.854058761445       residual = 3.90e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.854059058463       residual = 2.70e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.854059191362       residual = 2.69e-05           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.854059276975       residual = 1.48e-05           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.854059450195       residual = 1.35e-05           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.854059662880       residual = 3.65e-06           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.854059680272       residual = 1.51e-06           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.854059683926       residual = 1.52e-07           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.854059688671       residual = 4.80e-08           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.854059690360       residual = 1.57e-08           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.854059688230       residual = 4.58e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         18 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 1.5625e+00 is 5.368867e-04

solving harmonic davidson linear method for identity shift 6.2500e+00, overlap shift 6.2500e+01 and omega -1.7527e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.852993694251       residual = 3.49e-01           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.853214589962       residual = 6.05e-02           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.853253477708       residual = 1.11e-02           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.853263691796       residual = 2.38e-03           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.853266377780       residual = 9.98e-04           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.853267435702       residual = 6.67e-04           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.853267903391       residual = 2.42e-04           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.853268179893       residual = 6.20e-05           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.853268235682       residual = 3.68e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.853268309524       residual = 2.60e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.853268341968       residual = 2.53e-05           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.853268363025       residual = 1.37e-05           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.853268405278       residual = 1.20e-05           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.853268454873       residual = 3.07e-06           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.853268458279       residual = 1.23e-06           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.853268458947       residual = 1.23e-07           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.853268460013       residual = 3.92e-08           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.853268460377       residual = 1.24e-08           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.853268459884       residual = 3.57e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         18 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 6.2500e+00 is 1.390049e-04

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.446942 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 75 and numParams is: 74

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.0111e+01
  </log>
  <optVariables href="H2O.s024.opt.xml">
ci_0001                 6.988045e-01 3 1  ON 0
ci_0002                 6.961860e-01 3 1  ON 1
ci_0003                -4.005589e-02 3 1  ON 2
ci_0004                -4.005476e-02 3 1  ON 3
ci_0005                -3.785887e-02 3 1  ON 4
ci_0006                -3.818172e-02 3 1  ON 5
ci_0007                -2.643441e-02 3 1  ON 6
ci_0008                -2.661269e-02 3 1  ON 7
ci_0009                -2.516971e-02 3 1  ON 8
ci_0010                -2.519908e-02 3 1  ON 9
ci_0011                -2.109127e-02 3 1  ON 10
ci_0012                -2.113621e-02 3 1  ON 11
ci_0013                 2.087479e-02 3 1  ON 12
ci_0014                 2.073972e-02 3 1  ON 13
ci_0015                 2.114231e-02 3 1  ON 14
ci_0016                 2.094104e-02 3 1  ON 15
ci_0017                 1.889492e-02 3 1  ON 16
ci_0018                 1.887645e-02 3 1  ON 17
ci_0019                 1.616093e-02 3 1  ON 18
ci_0020                 1.599175e-02 3 1  ON 19
ci_0021                 1.805009e-02 3 1  ON 20
ci_0022                 1.838111e-02 3 1  ON 21
ci_0023                -1.515588e-02 3 1  ON 22
ci_0024                -1.484938e-02 3 1  ON 23
ci_0025                -1.004401e-02 3 1  ON 24
ci_0026                -9.510788e-03 3 1  ON 25
ci_0027                -1.471562e-02 3 1  ON 26
ci_0028                -1.449359e-02 3 1  ON 27
ci_0029                -1.280136e-02 3 1  ON 28
ci_0030                -1.305247e-02 3 1  ON 29
ci_0031                 1.562283e-02 3 1  ON 30
ci_0032                 1.542780e-02 3 1  ON 31
ci_0033                 1.232501e-02 3 1  ON 32
ci_0034                 1.227435e-02 3 1  ON 33
ci_0035                 9.144204e-03 3 1  ON 34
ci_0036                 9.471790e-03 3 1  ON 35
ci_0037                -1.313999e-02 3 1  ON 36
ci_0038                -1.297461e-02 3 1  ON 37
ci_0039                -8.821405e-03 3 1  ON 38
ci_0040                -8.963613e-03 3 1  ON 39
ci_0041                 1.222416e-02 3 1  ON 40
ci_0042                 1.213642e-02 3 1  ON 41
ci_0043                -1.057970e-02 3 1  ON 42
ci_0044                -1.059403e-02 3 1  ON 43
ci_0045                 1.218435e-02 3 1  ON 44
ci_0046                 1.204472e-02 3 1  ON 45
ci_0047                -8.167358e-03 3 1  ON 46
ci_0048                -8.227956e-03 3 1  ON 47
ci_0049                -6.826492e-03 3 1  ON 48
ci_0050                -6.761632e-03 3 1  ON 49
ci_0051                -6.296282e-03 3 1  ON 50
ci_0052                -6.365314e-03 3 1  ON 51
ci_0053                -7.389304e-03 3 1  ON 52
ci_0054                -7.510209e-03 3 1  ON 53
ci_0055                 6.361654e-03 3 1  ON 54
ci_0056                 6.254299e-03 3 1  ON 55
ci_0057                 6.641891e-03 3 1  ON 56
ci_0058                 7.497739e-03 3 1  ON 57
ci_0059                -7.535339e-03 3 1  ON 58
ci_0060                -7.342013e-03 3 1  ON 59
ci_0061                -7.308575e-03 3 1  ON 60
ci_0062                -7.222406e-03 3 1  ON 61
ci_0063                -1.052412e-02 3 1  ON 62
ci_0064                -1.041225e-02 3 1  ON 63
ci_0065                -8.972886e-03 3 1  ON 64
ci_0066                -8.811826e-03 3 1  ON 65
ci_0067                -6.950529e-03 3 1  ON 66
ci_0068                -7.166436e-03 3 1  ON 67
ci_0069                 6.573921e-03 3 1  ON 68
ci_0070                 6.473800e-03 3 1  ON 69
ci_0071                 7.351013e-03 3 1  ON 70
ci_0072                 7.419775e-03 3 1  ON 71
ci_0073                 6.433080e-03 3 1  ON 72
ci_0074                 6.434643e-03 3 1  ON 73
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 24
    time step          = 0.05
    reference energy   = -16.8964
    reference variance = 0.356754
====================================================
  Execution time = 1.4814e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s024
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6902e+01
  VMC Evar = 3.3342e-01
  Total weights = 1.9511e+06
  Execution time = 1.9594e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.322364337538
                                         uncertainty =       0.002296791485

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.322364337538
                                         uncertainty =       0.002296791485

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000401458032
  error estimate for blocks of size 2^( 2) =       0.000415230198
  error estimate for blocks of size 2^( 3) =       0.000429037394
  error estimate for blocks of size 2^( 4) =       0.000441556869
  error estimate for blocks of size 2^( 5) =       0.000451729650
  error estimate for blocks of size 2^( 6) =       0.000459475766
  error estimate for blocks of size 2^( 7) =       0.000464515105

      target function =      -0.858861742637
              le_mean =     -16.901955581378
             les_mean =     286.013207303898
             stat err =       0.000454319347
             autocorr =       1.280684523386
   target nu stat err =       0.000454319347
   target dn stat err =       0.003407394861
      target stat err =       0.004072649290
              std dev =       0.567747393554
             le_variance =       0.322337102887

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.317211851113
                                         uncertainty =       0.002126890910

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.317211851113
                                         uncertainty =       0.002126890910

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000398238152
  error estimate for blocks of size 2^( 2) =       0.000412043733
  error estimate for blocks of size 2^( 3) =       0.000425915467
  error estimate for blocks of size 2^( 4) =       0.000438523197
  error estimate for blocks of size 2^( 5) =       0.000448792124
  error estimate for blocks of size 2^( 6) =       0.000456626924
  error estimate for blocks of size 2^( 7) =       0.000461619072

      target function =      -0.839153455093
              le_mean =     -16.902012120772
             les_mean =     286.031519242728
             stat err =       0.000451390329
             autocorr =       1.284750436027
   target nu stat err =       0.000451390329
   target dn stat err =       0.022784275780
      target stat err =       0.025722464526
              std dev =       0.563193794986
             le_variance =       0.317187250710

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.319272421624
                                         uncertainty =       0.002194598826

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.319272421624
                                         uncertainty =       0.002194598826

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000399529050
  error estimate for blocks of size 2^( 2) =       0.000413317280
  error estimate for blocks of size 2^( 3) =       0.000427162052
  error estimate for blocks of size 2^( 4) =       0.000439729732
  error estimate for blocks of size 2^( 5) =       0.000449952996
  error estimate for blocks of size 2^( 6) =       0.000457755693
  error estimate for blocks of size 2^( 7) =       0.000462770596

      target function =      -0.864367653148
              le_mean =     -16.901963205066
             les_mean =     286.008836060198
             stat err =       0.000452552254
             autocorr =       1.283041607703
   target nu stat err =       0.000452552254
   target dn stat err =       0.003148150147
      target stat err =       0.003817837556
              std dev =       0.565019400804
             le_variance =       0.319246923285

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.321940329484
                                         uncertainty =       0.002282293825

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.321940329484
                                         uncertainty =       0.002282293825

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000401194053
  error estimate for blocks of size 2^( 2) =       0.000414967533
  error estimate for blocks of size 2^( 3) =       0.000428779787
  error estimate for blocks of size 2^( 4) =       0.000441302843
  error estimate for blocks of size 2^( 5) =       0.000451481390
  error estimate for blocks of size 2^( 6) =       0.000459238598
  error estimate for blocks of size 2^( 7) =       0.000464269989

      target function =      -0.856200814931
              le_mean =     -16.901952873414
             les_mean =     286.015353547634
             stat err =       0.000454073205
             autocorr =       1.280981261509
   target nu stat err =       0.000454073205
   target dn stat err =       0.005269109179
      target stat err =       0.006216200961
              std dev =       0.567374070258
             le_variance =       0.321913335601


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.858861742637        initial
     3.9062e-01     3.9062e+00             1.8864e-03        -0.839153455093
     1.5625e+00     1.5625e+01             5.3689e-04        -0.864367653148  <--
     6.2500e+00     6.2500e+01             1.3900e-04        -0.856200814931

*****************************************************************************
Applying the update for shift_i =   1.5625e+00     and shift_s =   1.5625e+01
*****************************************************************************

  Execution time = 2.4784e+01
  </log>
  <optVariables href="H2O.s024.opt.xml">
ci_0001                 6.988045e-01 3 1  ON 0
ci_0002                 6.961860e-01 3 1  ON 1
ci_0003                -4.005589e-02 3 1  ON 2
ci_0004                -4.005476e-02 3 1  ON 3
ci_0005                -3.785887e-02 3 1  ON 4
ci_0006                -3.818172e-02 3 1  ON 5
ci_0007                -2.643441e-02 3 1  ON 6
ci_0008                -2.661269e-02 3 1  ON 7
ci_0009                -2.516971e-02 3 1  ON 8
ci_0010                -2.519908e-02 3 1  ON 9
ci_0011                -2.109127e-02 3 1  ON 10
ci_0012                -2.113621e-02 3 1  ON 11
ci_0013                 2.087479e-02 3 1  ON 12
ci_0014                 2.073972e-02 3 1  ON 13
ci_0015                 2.114231e-02 3 1  ON 14
ci_0016                 2.094104e-02 3 1  ON 15
ci_0017                 1.889492e-02 3 1  ON 16
ci_0018                 1.887645e-02 3 1  ON 17
ci_0019                 1.616093e-02 3 1  ON 18
ci_0020                 1.599175e-02 3 1  ON 19
ci_0021                 1.805009e-02 3 1  ON 20
ci_0022                 1.838111e-02 3 1  ON 21
ci_0023                -1.515588e-02 3 1  ON 22
ci_0024                -1.484938e-02 3 1  ON 23
ci_0025                -1.004401e-02 3 1  ON 24
ci_0026                -9.510788e-03 3 1  ON 25
ci_0027                -1.471562e-02 3 1  ON 26
ci_0028                -1.449359e-02 3 1  ON 27
ci_0029                -1.280136e-02 3 1  ON 28
ci_0030                -1.305247e-02 3 1  ON 29
ci_0031                 1.562283e-02 3 1  ON 30
ci_0032                 1.542780e-02 3 1  ON 31
ci_0033                 1.232501e-02 3 1  ON 32
ci_0034                 1.227435e-02 3 1  ON 33
ci_0035                 9.144204e-03 3 1  ON 34
ci_0036                 9.471790e-03 3 1  ON 35
ci_0037                -1.313999e-02 3 1  ON 36
ci_0038                -1.297461e-02 3 1  ON 37
ci_0039                -8.821405e-03 3 1  ON 38
ci_0040                -8.963613e-03 3 1  ON 39
ci_0041                 1.222416e-02 3 1  ON 40
ci_0042                 1.213642e-02 3 1  ON 41
ci_0043                -1.057970e-02 3 1  ON 42
ci_0044                -1.059403e-02 3 1  ON 43
ci_0045                 1.218435e-02 3 1  ON 44
ci_0046                 1.204472e-02 3 1  ON 45
ci_0047                -8.167358e-03 3 1  ON 46
ci_0048                -8.227956e-03 3 1  ON 47
ci_0049                -6.826492e-03 3 1  ON 48
ci_0050                -6.761632e-03 3 1  ON 49
ci_0051                -6.296282e-03 3 1  ON 50
ci_0052                -6.365314e-03 3 1  ON 51
ci_0053                -7.389304e-03 3 1  ON 52
ci_0054                -7.510209e-03 3 1  ON 53
ci_0055                 6.361654e-03 3 1  ON 54
ci_0056                 6.254299e-03 3 1  ON 55
ci_0057                 6.641891e-03 3 1  ON 56
ci_0058                 7.497739e-03 3 1  ON 57
ci_0059                -7.535339e-03 3 1  ON 58
ci_0060                -7.342013e-03 3 1  ON 59
ci_0061                -7.308575e-03 3 1  ON 60
ci_0062                -7.222406e-03 3 1  ON 61
ci_0063                -1.052412e-02 3 1  ON 62
ci_0064                -1.041225e-02 3 1  ON 63
ci_0065                -8.972886e-03 3 1  ON 64
ci_0066                -8.811826e-03 3 1  ON 65
ci_0067                -6.950529e-03 3 1  ON 66
ci_0068                -7.166436e-03 3 1  ON 67
ci_0069                 6.573921e-03 3 1  ON 68
ci_0070                 6.473800e-03 3 1  ON 69
ci_0071                 7.351013e-03 3 1  ON 70
ci_0072                 7.419775e-03 3 1  ON 71
ci_0073                 6.433080e-03 3 1  ON 72
ci_0074                 6.434643e-03 3 1  ON 73
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 4.4900e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s025 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s025 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=25  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6896e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 25
    time step          = 0.05
    reference energy   = -16.9266
    reference variance = 0.26623
====================================================
  Execution time = 1.5019e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s025
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5233e+04
  VMC Eavg = -1.6903e+01
  VMC Evar = 3.3443e-01
  Total weights = 1.951387936e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 2.6908e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.320544397722
                                         uncertainty =       0.002258444421

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.320544397722
                                         uncertainty =       0.002258444421

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000400317203
  error estimate for blocks of size 2^( 2) =       0.000413976275
  error estimate for blocks of size 2^( 3) =       0.000427970416
  error estimate for blocks of size 2^( 4) =       0.000441502340
  error estimate for blocks of size 2^( 5) =       0.000452678983
  error estimate for blocks of size 2^( 6) =       0.000460143073
  error estimate for blocks of size 2^( 7) =       0.000465017702

      target function =      -0.862106007604
              le_mean =     -16.902720189687
             les_mean =     286.036383007606
             stat err =       0.000454835524
             autocorr =       1.290922727324
   target nu stat err =       0.000454835524
   target dn stat err =       0.003669598000
      target stat err =       0.004417259810
              std dev =       0.566134018260
             le_variance =       0.320507726631


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690272018969e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 74
Check correct_vf_var_size: 225, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 3.9062e-01, overlap shift 3.9062e+00 and omega -1.7527e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.862127350212       residual = 2.91e-01           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.864677995416       residual = 4.82e-02           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.865109454155       residual = 9.80e-03           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.865225682680       residual = 3.23e-03           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.865259095132       residual = 1.13e-03           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.865280890969       residual = 5.18e-04           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.865288035795       residual = 2.09e-04           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.865289772599       residual = 8.67e-05           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.865290630837       residual = 2.78e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.865291506813       residual = 6.84e-06           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.865291592943       residual = 2.74e-06           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.865291685056       residual = 7.86e-07           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.865291717523       residual = 1.26e-07           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.865291710078       residual = 4.59e-08           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.865291739575       residual = 2.86e-08           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.865291741979       residual = 5.68e-08           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.865291756717       residual = 2.52e-08           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.865291752700       residual = 1.43e-08           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.865291747347       residual = 6.08e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         18 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 3.9062e-01 is 1.294806e-03

solving harmonic davidson linear method for identity shift 1.5625e+00, overlap shift 1.5625e+01 and omega -1.7527e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.862127350212       residual = 2.91e-01           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.862848712429       residual = 4.69e-02           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.862967481539       residual = 9.27e-03           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.862998367270       residual = 2.94e-03           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.863007004566       residual = 1.03e-03           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.863012570299       residual = 4.46e-04           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.863014229599       residual = 1.76e-04           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.863014630567       residual = 6.82e-05           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.863014827086       residual = 2.12e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.863015025992       residual = 5.04e-06           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.863015042046       residual = 1.93e-06           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.863015062702       residual = 5.14e-07           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.863015069147       residual = 8.57e-08           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.863015067311       residual = 3.70e-08           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.863015075262       residual = 2.98e-08           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.863015075310       residual = 4.94e-08           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.863015078122       residual = 1.65e-08           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.863015076685       residual = 8.48e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         17 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 1.5625e+00 is 3.569233e-04

solving harmonic davidson linear method for identity shift 6.2500e+00, overlap shift 6.2500e+01 and omega -1.7527e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.862127350212       residual = 2.91e-01           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.862313789614       residual = 4.65e-02           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.862344239383       residual = 9.12e-03           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.862352075949       residual = 2.86e-03           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.862354250082       residual = 1.00e-03           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.862355646066       residual = 4.26e-04           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.862356050812       residual = 1.67e-04           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.862356148451       residual = 6.36e-05           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.862356196233       residual = 1.95e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.862356244497       residual = 4.62e-06           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.862356248155       residual = 1.74e-06           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.862356253157       residual = 4.55e-07           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.862356254658       residual = 7.72e-08           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.862356254204       residual = 3.52e-08           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.862356256240       residual = 3.02e-08           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.862356256193       residual = 4.62e-08           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.862356256832       residual = 1.45e-08           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.862356256453       residual = 7.23e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         17 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 6.2500e+00 is 9.157408e-05

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.457711 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 75 and numParams is: 74

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.7726e+01
  </log>
  <optVariables href="H2O.s025.opt.xml">
ci_0001                 6.989260e-01 3 1  ON 0
ci_0002                 6.963408e-01 3 1  ON 1
ci_0003                -3.969897e-02 3 1  ON 2
ci_0004                -3.971601e-02 3 1  ON 3
ci_0005                -3.752800e-02 3 1  ON 4
ci_0006                -3.783838e-02 3 1  ON 5
ci_0007                -2.615081e-02 3 1  ON 6
ci_0008                -2.634528e-02 3 1  ON 7
ci_0009                -2.491161e-02 3 1  ON 8
ci_0010                -2.495159e-02 3 1  ON 9
ci_0011                -2.089023e-02 3 1  ON 10
ci_0012                -2.088389e-02 3 1  ON 11
ci_0013                 2.069744e-02 3 1  ON 12
ci_0014                 2.052753e-02 3 1  ON 13
ci_0015                 2.096825e-02 3 1  ON 14
ci_0016                 2.073511e-02 3 1  ON 15
ci_0017                 1.872565e-02 3 1  ON 16
ci_0018                 1.867551e-02 3 1  ON 17
ci_0019                 1.600478e-02 3 1  ON 18
ci_0020                 1.581983e-02 3 1  ON 19
ci_0021                 1.805445e-02 3 1  ON 20
ci_0022                 1.830259e-02 3 1  ON 21
ci_0023                -1.499670e-02 3 1  ON 22
ci_0024                -1.467537e-02 3 1  ON 23
ci_0025                -9.890523e-03 3 1  ON 24
ci_0026                -9.203471e-03 3 1  ON 25
ci_0027                -1.452650e-02 3 1  ON 26
ci_0028                -1.434718e-02 3 1  ON 27
ci_0029                -1.266740e-02 3 1  ON 28
ci_0030                -1.294203e-02 3 1  ON 29
ci_0031                 1.558635e-02 3 1  ON 30
ci_0032                 1.535698e-02 3 1  ON 31
ci_0033                 1.219640e-02 3 1  ON 32
ci_0034                 1.221282e-02 3 1  ON 33
ci_0035                 8.916283e-03 3 1  ON 34
ci_0036                 9.271631e-03 3 1  ON 35
ci_0037                -1.309942e-02 3 1  ON 36
ci_0038                -1.293981e-02 3 1  ON 37
ci_0039                -8.600069e-03 3 1  ON 38
ci_0040                -8.712704e-03 3 1  ON 39
ci_0041                 1.214827e-02 3 1  ON 40
ci_0042                 1.206276e-02 3 1  ON 41
ci_0043                -1.042193e-02 3 1  ON 42
ci_0044                -1.042062e-02 3 1  ON 43
ci_0045                 1.213751e-02 3 1  ON 44
ci_0046                 1.195136e-02 3 1  ON 45
ci_0047                -7.936492e-03 3 1  ON 46
ci_0048                -8.056110e-03 3 1  ON 47
ci_0049                -6.547874e-03 3 1  ON 48
ci_0050                -6.446104e-03 3 1  ON 49
ci_0051                -6.120883e-03 3 1  ON 50
ci_0052                -6.161086e-03 3 1  ON 51
ci_0053                -7.193131e-03 3 1  ON 52
ci_0054                -7.364605e-03 3 1  ON 53
ci_0055                 6.250655e-03 3 1  ON 54
ci_0056                 6.023402e-03 3 1  ON 55
ci_0057                 6.314802e-03 3 1  ON 56
ci_0058                 7.228730e-03 3 1  ON 57
ci_0059                -7.247096e-03 3 1  ON 58
ci_0060                -7.186764e-03 3 1  ON 59
ci_0061                -7.151400e-03 3 1  ON 60
ci_0062                -7.106139e-03 3 1  ON 61
ci_0063                -1.047775e-02 3 1  ON 62
ci_0064                -1.035856e-02 3 1  ON 63
ci_0065                -8.883531e-03 3 1  ON 64
ci_0066                -8.722033e-03 3 1  ON 65
ci_0067                -6.837400e-03 3 1  ON 66
ci_0068                -7.055088e-03 3 1  ON 67
ci_0069                 6.419555e-03 3 1  ON 68
ci_0070                 6.351598e-03 3 1  ON 69
ci_0071                 7.224378e-03 3 1  ON 70
ci_0072                 7.264385e-03 3 1  ON 71
ci_0073                 6.142205e-03 3 1  ON 72
ci_0074                 6.288293e-03 3 1  ON 73
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 25
    time step          = 0.05
    reference energy   = -16.8658
    reference variance = 0.326627
====================================================
  Execution time = 1.4721e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s025
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6903e+01
  VMC Evar = 3.3458e-01
  Total weights = 1.9517e+06
  Execution time = 1.9559e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.321008713789
                                         uncertainty =       0.001927003855

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.321008713789
                                         uncertainty =       0.001927003855

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000400615464
  error estimate for blocks of size 2^( 2) =       0.000414385761
  error estimate for blocks of size 2^( 3) =       0.000427846309
  error estimate for blocks of size 2^( 4) =       0.000440832811
  error estimate for blocks of size 2^( 5) =       0.000451980777
  error estimate for blocks of size 2^( 6) =       0.000459717128
  error estimate for blocks of size 2^( 7) =       0.000466060945

      target function =      -0.853384828456
              le_mean =     -16.903191338886
             les_mean =     286.059700311233
             stat err =       0.000454647916
             autocorr =       1.287938098101
   target nu stat err =       0.000454647916
   target dn stat err =       0.006552609545
      target stat err =       0.007681697365
              std dev =       0.566555822473
             le_variance =       0.320985499978

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.316741672455
                                         uncertainty =       0.001902416509

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.316741672455
                                         uncertainty =       0.001902416509

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000397942953
  error estimate for blocks of size 2^( 2) =       0.000411733965
  error estimate for blocks of size 2^( 3) =       0.000425260957
  error estimate for blocks of size 2^( 4) =       0.000438347804
  error estimate for blocks of size 2^( 5) =       0.000449578199
  error estimate for blocks of size 2^( 6) =       0.000457382388
  error estimate for blocks of size 2^( 7) =       0.000463724936

      target function =      -0.862158456698
              le_mean =     -16.903205469404
             les_mean =     286.052785861822
             stat err =       0.000452258332
             autocorr =       1.291610350094
   target nu stat err =       0.000452258332
   target dn stat err =       0.003727637794
      target stat err =       0.004489260890
              std dev =       0.562776320920
             le_variance =       0.316717187388

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.318454378907
                                         uncertainty =       0.001909496448

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.318454378907
                                         uncertainty =       0.001909496448

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000399017868
  error estimate for blocks of size 2^( 2) =       0.000412798071
  error estimate for blocks of size 2^( 3) =       0.000426294921
  error estimate for blocks of size 2^( 4) =       0.000439333831
  error estimate for blocks of size 2^( 5) =       0.000450530216
  error estimate for blocks of size 2^( 6) =       0.000458304576
  error estimate for blocks of size 2^( 7) =       0.000464660972

      target function =      -0.855984393257
              le_mean =     -16.903181907432
             les_mean =     286.057181661692
             stat err =       0.000453207399
             autocorr =       1.290058177282
   target nu stat err =       0.000453207399
   target dn stat err =       0.005372846327
      target stat err =       0.006346569996
              std dev =       0.564296480161
             le_variance =       0.318430517522

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.320656647605
                                         uncertainty =       0.001924358456

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.320656647605
                                         uncertainty =       0.001924358456

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000400395657
  error estimate for blocks of size 2^( 2) =       0.000414166891
  error estimate for blocks of size 2^( 3) =       0.000427631318
  error estimate for blocks of size 2^( 4) =       0.000440624903
  error estimate for blocks of size 2^( 5) =       0.000451780537
  error estimate for blocks of size 2^( 6) =       0.000459522799
  error estimate for blocks of size 2^( 7) =       0.000465867941

      target function =      -0.860556187437
              le_mean =     -16.903187118905
             les_mean =     286.053513743762
             stat err =       0.000454449045
             autocorr =       1.288224851035
   target nu stat err =       0.000454449045
   target dn stat err =       0.003349708265
      target stat err =       0.004028934793
              std dev =       0.566244969056
             le_variance =       0.320633364981


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.853384828456        initial
     3.9062e-01     3.9062e+00             1.2948e-03        -0.862158456698  <--
     1.5625e+00     1.5625e+01             3.5692e-04        -0.855984393257
     6.2500e+00     6.2500e+01             9.1574e-05        -0.860556187437

*****************************************************************************
Applying the update for shift_i =   3.9062e-01     and shift_s =   3.9062e+00
*****************************************************************************

  Execution time = 2.4626e+01
  </log>
  <optVariables href="H2O.s025.opt.xml">
ci_0001                 6.992415e-01 3 1  ON 0
ci_0002                 6.967484e-01 3 1  ON 1
ci_0003                -3.876108e-02 3 1  ON 2
ci_0004                -3.882782e-02 3 1  ON 3
ci_0005                -3.663669e-02 3 1  ON 4
ci_0006                -3.691017e-02 3 1  ON 5
ci_0007                -2.536806e-02 3 1  ON 6
ci_0008                -2.560653e-02 3 1  ON 7
ci_0009                -2.424294e-02 3 1  ON 8
ci_0010                -2.431116e-02 3 1  ON 9
ci_0011                -2.036932e-02 3 1  ON 10
ci_0012                -2.022867e-02 3 1  ON 11
ci_0013                 2.023786e-02 3 1  ON 12
ci_0014                 1.997668e-02 3 1  ON 13
ci_0015                 2.051528e-02 3 1  ON 14
ci_0016                 2.020001e-02 3 1  ON 15
ci_0017                 1.828849e-02 3 1  ON 16
ci_0018                 1.815676e-02 3 1  ON 17
ci_0019                 1.560310e-02 3 1  ON 18
ci_0020                 1.537829e-02 3 1  ON 19
ci_0021                 1.805925e-02 3 1  ON 20
ci_0022                 1.807737e-02 3 1  ON 21
ci_0023                -1.458689e-02 3 1  ON 22
ci_0024                -1.422686e-02 3 1  ON 23
ci_0025                -9.496553e-03 3 1  ON 24
ci_0026                -8.423422e-03 3 1  ON 25
ci_0027                -1.403947e-02 3 1  ON 26
ci_0028                -1.396944e-02 3 1  ON 27
ci_0029                -1.232499e-02 3 1  ON 28
ci_0030                -1.266225e-02 3 1  ON 29
ci_0031                 1.548396e-02 3 1  ON 30
ci_0032                 1.516375e-02 3 1  ON 31
ci_0033                 1.185021e-02 3 1  ON 32
ci_0034                 1.204825e-02 3 1  ON 33
ci_0035                 8.341916e-03 3 1  ON 34
ci_0036                 8.763995e-03 3 1  ON 35
ci_0037                -1.299403e-02 3 1  ON 36
ci_0038                -1.284867e-02 3 1  ON 37
ci_0039                -8.035218e-03 3 1  ON 38
ci_0040                -8.073484e-03 3 1  ON 39
ci_0041                 1.194873e-02 3 1  ON 40
ci_0042                 1.187009e-02 3 1  ON 41
ci_0043                -9.997802e-03 3 1  ON 42
ci_0044                -9.954191e-03 3 1  ON 43
ci_0045                 1.201472e-02 3 1  ON 44
ci_0046                 1.170331e-02 3 1  ON 45
ci_0047                -7.347400e-03 3 1  ON 46
ci_0048                -7.617549e-03 3 1  ON 47
ci_0049                -5.846554e-03 3 1  ON 48
ci_0050                -5.650124e-03 3 1  ON 49
ci_0051                -5.680052e-03 3 1  ON 50
ci_0052                -5.649338e-03 3 1  ON 51
ci_0053                -6.697820e-03 3 1  ON 52
ci_0054                -6.994183e-03 3 1  ON 53
ci_0055                 5.970315e-03 3 1  ON 54
ci_0056                 5.441669e-03 3 1  ON 55
ci_0057                 5.487121e-03 3 1  ON 56
ci_0058                 6.546883e-03 3 1  ON 57
ci_0059                -6.520903e-03 3 1  ON 58
ci_0060                -6.794035e-03 3 1  ON 59
ci_0061                -6.742980e-03 3 1  ON 60
ci_0062                -6.803390e-03 3 1  ON 61
ci_0063                -1.035847e-02 3 1  ON 62
ci_0064                -1.022062e-02 3 1  ON 63
ci_0065                -8.651512e-03 3 1  ON 64
ci_0066                -8.488469e-03 3 1  ON 65
ci_0067                -6.551085e-03 3 1  ON 66
ci_0068                -6.773656e-03 3 1  ON 67
ci_0069                 6.029366e-03 3 1  ON 68
ci_0070                 6.042009e-03 3 1  ON 69
ci_0071                 6.902142e-03 3 1  ON 70
ci_0072                 6.870013e-03 3 1  ON 71
ci_0073                 5.409500e-03 3 1  ON 72
ci_0074                 5.917933e-03 3 1  ON 73
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 4.2357e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s026 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s026 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=26  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6896e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 26
    time step          = 0.05
    reference energy   = -16.8587
    reference variance = 0.189297
====================================================
  Execution time = 1.4841e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s026
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5219e+04
  VMC Eavg = -1.6902e+01
  VMC Evar = 3.2885e-01
  Total weights = 1.951155527e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 2.7014e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.313236799212
                                         uncertainty =       0.002120551284

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.313236799212
                                         uncertainty =       0.002120551284

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000395815045
  error estimate for blocks of size 2^( 2) =       0.000409993335
  error estimate for blocks of size 2^( 3) =       0.000424494826
  error estimate for blocks of size 2^( 4) =       0.000437703288
  error estimate for blocks of size 2^( 5) =       0.000448299595
  error estimate for blocks of size 2^( 6) =       0.000457746865
  error estimate for blocks of size 2^( 7) =       0.000461264905

      target function =      -0.868684830561
              le_mean =     -16.901659501176
             les_mean =     285.994948273494
             stat err =       0.000451253663
             autocorr =       1.299741202215
   target nu stat err =       0.000451253663
   target dn stat err =       0.003190855344
      target stat err =       0.003904286838
              std dev =       0.559767004439
             le_variance =       0.313339099259


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690165950118e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 74
Check correct_vf_var_size: 225, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 9.7656e-02, overlap shift 9.7656e-01 and omega -1.7527e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.868701161454       residual = 2.18e-01           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.873594726448       residual = 5.05e-02           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.874761036616       residual = 9.82e-03           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.875132115936       residual = 3.23e-03           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.875228425147       residual = 1.69e-03           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.875317131524       residual = 9.74e-04           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.875376335998       residual = 2.33e-04           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.875387871155       residual = 7.33e-05           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.875391538013       residual = 3.17e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.875394522212       residual = 1.62e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.875393294929       residual = 9.65e-06           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.875393113798       residual = 5.25e-06           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.875392450988       residual = 8.46e-06           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.875391716727       residual = 7.49e-06           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.875393305612       residual = 6.59e-06           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.875393629368       residual = 1.09e-06           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.875393918297       residual = 4.57e-07           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.875393960745       residual = 1.87e-07           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.875393945351       residual = 5.29e-08           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.875393903757       residual = 1.50e-08           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.875393897914       residual = 6.36e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         20 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 9.7656e-02 is 4.253531e-03

solving harmonic davidson linear method for identity shift 3.9062e-01, overlap shift 3.9062e+00 and omega -1.7527e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.868701161454       residual = 2.18e-01           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.870504620587       residual = 4.74e-02           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.870908819191       residual = 8.74e-03           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.871026880222       residual = 2.61e-03           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.871056197545       residual = 1.34e-03           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.871081972602       residual = 6.72e-04           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.871096665297       residual = 1.40e-04           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.871099021146       residual = 4.08e-05           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.871099697503       residual = 1.63e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.871100268961       residual = 8.37e-06           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.871099889156       residual = 4.71e-06           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.871099811966       residual = 3.01e-06           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.871099638183       residual = 4.36e-06           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.871099569422       residual = 2.43e-06           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.871099878147       residual = 1.11e-06           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.871099907958       residual = 1.56e-07           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.871099946159       residual = 6.74e-08           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.871099938361       residual = 2.29e-08           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.871099939010       residual = 5.68e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         18 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 3.9062e-01 is 1.380501e-03

solving harmonic davidson linear method for identity shift 1.5625e+00, overlap shift 1.5625e+01 and omega -1.7527e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.868701161454       residual = 2.18e-01           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.869212312489       residual = 4.61e-02           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.869323835041       residual = 8.31e-03           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.869355254439       residual = 2.39e-03           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.869362928467       residual = 1.22e-03           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.869369537054       residual = 5.74e-04           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.869373074934       residual = 1.13e-04           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.869373595344       residual = 3.23e-05           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.869373738922       residual = 1.26e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.869373862311       residual = 6.44e-06           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.869373765100       residual = 3.58e-06           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.869373744616       residual = 2.44e-06           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.869373703447       residual = 3.21e-06           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.869373698516       residual = 1.46e-06           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.869373763052       residual = 5.43e-07           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.869373768573       residual = 7.75e-08           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.869373775709       residual = 3.35e-08           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.869373773479       residual = 1.02e-08           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.869373773760       residual = 2.47e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         18 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 1.5625e+00 is 3.919276e-04

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.470354 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 75 and numParams is: 74

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.7560e+01
  </log>
  <optVariables href="H2O.s026.opt.xml">
ci_0001                 6.992387e-01 3 1  ON 0
ci_0002                 6.976264e-01 3 1  ON 1
ci_0003                -3.781171e-02 3 1  ON 2
ci_0004                -3.788657e-02 3 1  ON 3
ci_0005                -3.542777e-02 3 1  ON 4
ci_0006                -3.578856e-02 3 1  ON 5
ci_0007                -2.412416e-02 3 1  ON 6
ci_0008                -2.427268e-02 3 1  ON 7
ci_0009                -2.327908e-02 3 1  ON 8
ci_0010                -2.355860e-02 3 1  ON 9
ci_0011                -1.950330e-02 3 1  ON 10
ci_0012                -1.949321e-02 3 1  ON 11
ci_0013                 1.950442e-02 3 1  ON 12
ci_0014                 1.910424e-02 3 1  ON 13
ci_0015                 1.978419e-02 3 1  ON 14
ci_0016                 1.964749e-02 3 1  ON 15
ci_0017                 1.766408e-02 3 1  ON 16
ci_0018                 1.756656e-02 3 1  ON 17
ci_0019                 1.520963e-02 3 1  ON 18
ci_0020                 1.495255e-02 3 1  ON 19
ci_0021                 1.766923e-02 3 1  ON 20
ci_0022                 1.838001e-02 3 1  ON 21
ci_0023                -1.411090e-02 3 1  ON 22
ci_0024                -1.374035e-02 3 1  ON 23
ci_0025                -8.245962e-03 3 1  ON 24
ci_0026                -7.042921e-03 3 1  ON 25
ci_0027                -1.360618e-02 3 1  ON 26
ci_0028                -1.345862e-02 3 1  ON 27
ci_0029                -1.186994e-02 3 1  ON 28
ci_0030                -1.226920e-02 3 1  ON 29
ci_0031                 1.535957e-02 3 1  ON 30
ci_0032                 1.485473e-02 3 1  ON 31
ci_0033                 1.105947e-02 3 1  ON 32
ci_0034                 1.131225e-02 3 1  ON 33
ci_0035                 7.622480e-03 3 1  ON 34
ci_0036                 8.081066e-03 3 1  ON 35
ci_0037                -1.268661e-02 3 1  ON 36
ci_0038                -1.269841e-02 3 1  ON 37
ci_0039                -7.323932e-03 3 1  ON 38
ci_0040                -7.441634e-03 3 1  ON 39
ci_0041                 1.159589e-02 3 1  ON 40
ci_0042                 1.154309e-02 3 1  ON 41
ci_0043                -9.555187e-03 3 1  ON 42
ci_0044                -9.580600e-03 3 1  ON 43
ci_0045                 1.158859e-02 3 1  ON 44
ci_0046                 1.160516e-02 3 1  ON 45
ci_0047                -6.712084e-03 3 1  ON 46
ci_0048                -6.912421e-03 3 1  ON 47
ci_0049                -5.332732e-03 3 1  ON 48
ci_0050                -5.025958e-03 3 1  ON 49
ci_0051                -4.870340e-03 3 1  ON 50
ci_0052                -5.037593e-03 3 1  ON 51
ci_0053                -6.361008e-03 3 1  ON 52
ci_0054                -6.492510e-03 3 1  ON 53
ci_0055                 5.475069e-03 3 1  ON 54
ci_0056                 5.037100e-03 3 1  ON 55
ci_0057                 4.980324e-03 3 1  ON 56
ci_0058                 6.702853e-03 3 1  ON 57
ci_0059                -6.088105e-03 3 1  ON 58
ci_0060                -6.287861e-03 3 1  ON 59
ci_0061                -6.089290e-03 3 1  ON 60
ci_0062                -6.327235e-03 3 1  ON 61
ci_0063                -1.019069e-02 3 1  ON 62
ci_0064                -9.983946e-03 3 1  ON 63
ci_0065                -8.387362e-03 3 1  ON 64
ci_0066                -8.165833e-03 3 1  ON 65
ci_0067                -6.151311e-03 3 1  ON 66
ci_0068                -6.382281e-03 3 1  ON 67
ci_0069                 5.586282e-03 3 1  ON 68
ci_0070                 5.707986e-03 3 1  ON 69
ci_0071                 6.529355e-03 3 1  ON 70
ci_0072                 6.574548e-03 3 1  ON 71
ci_0073                 5.240923e-03 3 1  ON 72
ci_0074                 5.435455e-03 3 1  ON 73
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 26
    time step          = 0.05
    reference energy   = -16.8861
    reference variance = 0.127294
====================================================
  Execution time = 1.4644e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s026
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6902e+01
  VMC Evar = 3.3140e-01
  Total weights = 1.9516e+06
  Execution time = 1.9119e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.321442326472
                                         uncertainty =       0.005704651438

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.321442326472
                                         uncertainty =       0.005704651438

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000400977847
  error estimate for blocks of size 2^( 2) =       0.000414938827
  error estimate for blocks of size 2^( 3) =       0.000429679824
  error estimate for blocks of size 2^( 4) =       0.000442298518
  error estimate for blocks of size 2^( 5) =       0.000452405560
  error estimate for blocks of size 2^( 6) =       0.000459686430
  error estimate for blocks of size 2^( 7) =       0.000464277893

      target function =      -0.801930902859
              le_mean =     -16.902533100239
             les_mean =     286.082717802373
             stat err =       0.000454667100
             autocorr =       1.285719708013
   target nu stat err =       0.000454667100
   target dn stat err =       0.035848451145
      target stat err =       0.037029830083
              std dev =       0.567068308889
             le_variance =       0.321566466946

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.313952676151
                                         uncertainty =       0.006395963432

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.313952676151
                                         uncertainty =       0.006395963432

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000396298082
  error estimate for blocks of size 2^( 2) =       0.000410449383
  error estimate for blocks of size 2^( 3) =       0.000425324692
  error estimate for blocks of size 2^( 4) =       0.000438138600
  error estimate for blocks of size 2^( 5) =       0.000448475346
  error estimate for blocks of size 2^( 6) =       0.000455720330
  error estimate for blocks of size 2^( 7) =       0.000460486018

      target function =      -0.843162034524
              le_mean =     -16.902657029255
             les_mean =     286.050271896146
             stat err =       0.000450705074
             autocorr =       1.293424111164
   target nu stat err =       0.000450705074
   target dn stat err =       0.013514098127
      target stat err =       0.015417331005
              std dev =       0.560450122772
             le_variance =       0.314104340115

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.315065914293
                                         uncertainty =       0.006139028943

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.315065914293
                                         uncertainty =       0.006139028943

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000396995967
  error estimate for blocks of size 2^( 2) =       0.000411084200
  error estimate for blocks of size 2^( 3) =       0.000425917957
  error estimate for blocks of size 2^( 4) =       0.000438678530
  error estimate for blocks of size 2^( 5) =       0.000448991477
  error estimate for blocks of size 2^( 6) =       0.000456258784
  error estimate for blocks of size 2^( 7) =       0.000460953031

      target function =      -0.854649265554
              le_mean =     -16.902511090461
             les_mean =     286.035462850344
             stat err =       0.000451220456
             autocorr =       1.291830009115
   target nu stat err =       0.000451220456
   target dn stat err =       0.011022512797
      target stat err =       0.012920133309
              std dev =       0.561437081169
             le_variance =       0.315211596112

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.319993727243
                                         uncertainty =       0.005749580486

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.319993727243
                                         uncertainty =       0.005749580486

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000400076266
  error estimate for blocks of size 2^( 2) =       0.000414053938
  error estimate for blocks of size 2^( 3) =       0.000428807220
  error estimate for blocks of size 2^( 4) =       0.000441450044
  error estimate for blocks of size 2^( 5) =       0.000451607029
  error estimate for blocks of size 2^( 6) =       0.000458928593
  error estimate for blocks of size 2^( 7) =       0.000463548713

      target function =      -0.859187531165
              le_mean =     -16.902521065599
             les_mean =     286.032044318558
             stat err =       0.000453883594
             autocorr =       1.287073638466
   target nu stat err =       0.000453883594
   target dn stat err =       0.006939645071
      target stat err =       0.008234333888
              std dev =       0.565793280968
             le_variance =       0.320122036788


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.801930902859        initial
     9.7656e-02     9.7656e-01             4.2535e-03        -0.843162034524
     3.9062e-01     3.9062e+00             1.3805e-03        -0.854649265554
     1.5625e+00     1.5625e+01             3.9193e-04        -0.859187531165  <--

*****************************************************************************
Applying the update for shift_i =   1.5625e+00     and shift_s =   1.5625e+01
*****************************************************************************

  Execution time = 2.4307e+01
  </log>
  <optVariables href="H2O.s026.opt.xml">
ci_0001                 6.992547e-01 3 1  ON 0
ci_0002                 6.969770e-01 3 1  ON 1
ci_0003                -3.849922e-02 3 1  ON 2
ci_0004                -3.856714e-02 3 1  ON 3
ci_0005                -3.630993e-02 3 1  ON 4
ci_0006                -3.660534e-02 3 1  ON 5
ci_0007                -2.503754e-02 3 1  ON 6
ci_0008                -2.525066e-02 3 1  ON 7
ci_0009                -2.397449e-02 3 1  ON 8
ci_0010                -2.410060e-02 3 1  ON 9
ci_0011                -2.012891e-02 3 1  ON 10
ci_0012                -2.002366e-02 3 1  ON 11
ci_0013                 2.003391e-02 3 1  ON 12
ci_0014                 1.973379e-02 3 1  ON 13
ci_0015                 2.031230e-02 3 1  ON 14
ci_0016                 2.004593e-02 3 1  ON 15
ci_0017                 1.811443e-02 3 1  ON 16
ci_0018                 1.799171e-02 3 1  ON 17
ci_0019                 1.549257e-02 3 1  ON 18
ci_0020                 1.525855e-02 3 1  ON 19
ci_0021                 1.795745e-02 3 1  ON 20
ci_0022                 1.815953e-02 3 1  ON 21
ci_0023                -1.445359e-02 3 1  ON 22
ci_0024                -1.409017e-02 3 1  ON 23
ci_0025                -9.142773e-03 3 1  ON 24
ci_0026                -8.031494e-03 3 1  ON 25
ci_0027                -1.391824e-02 3 1  ON 26
ci_0028                -1.382619e-02 3 1  ON 27
ci_0029                -1.219707e-02 3 1  ON 28
ci_0030                -1.255129e-02 3 1  ON 29
ci_0031                 1.545052e-02 3 1  ON 30
ci_0032                 1.508040e-02 3 1  ON 31
ci_0033                 1.163509e-02 3 1  ON 32
ci_0034                 1.184804e-02 3 1  ON 33
ci_0035                 8.138080e-03 3 1  ON 34
ci_0036                 8.570186e-03 3 1  ON 35
ci_0037                -1.290961e-02 3 1  ON 36
ci_0038                -1.280656e-02 3 1  ON 37
ci_0039                -7.834729e-03 3 1  ON 38
ci_0040                -7.895254e-03 3 1  ON 39
ci_0041                 1.185157e-02 3 1  ON 40
ci_0042                 1.177967e-02 3 1  ON 41
ci_0043                -9.877698e-03 3 1  ON 42
ci_0044                -9.851658e-03 3 1  ON 43
ci_0045                 1.189850e-02 3 1  ON 44
ci_0046                 1.167588e-02 3 1  ON 45
ci_0047                -7.168518e-03 3 1  ON 46
ci_0048                -7.418863e-03 3 1  ON 47
ci_0049                -5.700293e-03 3 1  ON 48
ci_0050                -5.472606e-03 3 1  ON 49
ci_0051                -5.448664e-03 3 1  ON 50
ci_0052                -5.474768e-03 3 1  ON 51
ci_0053                -6.602507e-03 3 1  ON 52
ci_0054                -6.851892e-03 3 1  ON 53
ci_0055                 5.829530e-03 3 1  ON 54
ci_0056                 5.326727e-03 3 1  ON 55
ci_0057                 5.344154e-03 3 1  ON 56
ci_0058                 6.591635e-03 3 1  ON 57
ci_0059                -6.398487e-03 3 1  ON 58
ci_0060                -6.650464e-03 3 1  ON 59
ci_0061                -6.561410e-03 3 1  ON 60
ci_0062                -6.671315e-03 3 1  ON 61
ci_0063                -1.031164e-02 3 1  ON 62
ci_0064                -1.015409e-02 3 1  ON 63
ci_0065                -8.578108e-03 3 1  ON 64
ci_0066                -8.398673e-03 3 1  ON 65
ci_0067                -6.437922e-03 3 1  ON 66
ci_0068                -6.662660e-03 3 1  ON 67
ci_0069                 5.903979e-03 3 1  ON 68
ci_0070                 5.947168e-03 3 1  ON 69
ci_0071                 6.797107e-03 3 1  ON 70
ci_0072                 6.786730e-03 3 1  ON 71
ci_0073                 5.361772e-03 3 1  ON 72
ci_0074                 5.780858e-03 3 1  ON 73
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 4.1873e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s027 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s027 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=27  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6895e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 27
    time step          = 0.05
    reference energy   = -16.9876
    reference variance = 0.797267
====================================================
  Execution time = 1.4468e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s027
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5241e+04
  VMC Eavg = -1.6903e+01
  VMC Evar = 3.2823e-01
  Total weights = 1.951629871e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 2.5982e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.316827131228
                                         uncertainty =       0.002667844815

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.316827131228
                                         uncertainty =       0.002667844815

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000398027698
  error estimate for blocks of size 2^( 2) =       0.000411855456
  error estimate for blocks of size 2^( 3) =       0.000425656657
  error estimate for blocks of size 2^( 4) =       0.000438090916
  error estimate for blocks of size 2^( 5) =       0.000449539122
  error estimate for blocks of size 2^( 6) =       0.000456825021
  error estimate for blocks of size 2^( 7) =       0.000460675988

      target function =      -0.869606854443
              le_mean =     -16.903124902422
             les_mean =     286.043860664037
             stat err =       0.000451282762
             autocorr =       1.285496502971
   target nu stat err =       0.000451282762
   target dn stat err =       0.003838388752
      target stat err =       0.004698745031
              std dev =       0.562896168412
             le_variance =       0.316852096413


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690312490242e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 74
Check correct_vf_var_size: 225, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 3.9062e-01, overlap shift 3.9062e+00 and omega -1.7527e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.869631217820       residual = 2.10e-01           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.871501932799       residual = 4.18e-02           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.871863178211       residual = 7.81e-03           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.871971892221       residual = 2.40e-03           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.872009673656       residual = 9.90e-04           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.872023300278       residual = 5.89e-04           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.872030938863       residual = 1.41e-04           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.872032895717       residual = 4.00e-05           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.872033411421       residual = 1.43e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.872033558412       residual = 4.62e-06           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.872033653086       residual = 2.09e-06           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.872033664037       residual = 4.67e-07           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.872033650290       residual = 2.05e-07           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.872033649199       residual = 1.63e-07           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.872033685944       residual = 2.85e-07           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.872033726729       residual = 1.48e-07           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.872033712944       residual = 4.17e-08           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.872033701114       residual = 1.59e-08           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.872033699055       residual = 4.60e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         18 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 3.9062e-01 is 1.401566e-03

solving harmonic davidson linear method for identity shift 1.5625e+00, overlap shift 1.5625e+01 and omega -1.7527e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.869631217820       residual = 2.10e-01           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.870160992077       residual = 4.07e-02           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.870260808419       residual = 7.40e-03           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.870289669325       residual = 2.19e-03           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.870299570907       residual = 8.89e-04           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.870302986647       residual = 5.04e-04           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.870304780813       residual = 1.16e-04           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.870305220166       residual = 3.15e-05           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.870305328467       residual = 1.06e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.870305358694       residual = 3.43e-06           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.870305378413       residual = 1.45e-06           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.870305379748       residual = 3.25e-07           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.870305376529       residual = 1.57e-07           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.870305376723       residual = 1.41e-07           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.870305386092       residual = 2.21e-07           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.870305393302       residual = 7.75e-08           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.870305389797       residual = 2.04e-08           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.870305387252       residual = 7.45e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         17 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 1.5625e+00 is 3.800174e-04

solving harmonic davidson linear method for identity shift 6.2500e+00, overlap shift 6.2500e+01 and omega -1.7527e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.869631217820       residual = 2.10e-01           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.869768197856       residual = 4.04e-02           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.869793818164       residual = 7.29e-03           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.869801139245       residual = 2.14e-03           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.869803641887       residual = 8.62e-04           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.869804493770       residual = 4.81e-04           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.869804932873       residual = 1.09e-04           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.869805038980       residual = 2.94e-05           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.869805064621       residual = 9.72e-06           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.869805071750       residual = 3.14e-06           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.869805076417       residual = 1.31e-06           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.869805076669       residual = 2.93e-07           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.869805075881       residual = 1.47e-07           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.869805075967       residual = 1.35e-07           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.869805078303       residual = 2.03e-07           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.869805079904       residual = 6.39e-08           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.869805079043       residual = 1.67e-08           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.869805078437       residual = 6.00e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         17 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 6.2500e+00 is 9.705042e-05

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.481037 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 75 and numParams is: 74

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.7082e+01
  </log>
  <optVariables href="H2O.s027.opt.xml">
ci_0001                 6.993428e-01 3 1  ON 0
ci_0002                 6.971261e-01 3 1  ON 1
ci_0003                -3.821032e-02 3 1  ON 2
ci_0004                -3.825137e-02 3 1  ON 3
ci_0005                -3.602301e-02 3 1  ON 4
ci_0006                -3.622533e-02 3 1  ON 5
ci_0007                -2.479068e-02 3 1  ON 6
ci_0008                -2.501492e-02 3 1  ON 7
ci_0009                -2.375981e-02 3 1  ON 8
ci_0010                -2.390675e-02 3 1  ON 9
ci_0011                -1.991161e-02 3 1  ON 10
ci_0012                -1.978750e-02 3 1  ON 11
ci_0013                 1.982223e-02 3 1  ON 12
ci_0014                 1.955367e-02 3 1  ON 13
ci_0015                 2.009817e-02 3 1  ON 14
ci_0016                 1.991419e-02 3 1  ON 15
ci_0017                 1.793039e-02 3 1  ON 16
ci_0018                 1.780464e-02 3 1  ON 17
ci_0019                 1.534278e-02 3 1  ON 18
ci_0020                 1.517887e-02 3 1  ON 19
ci_0021                 1.786799e-02 3 1  ON 20
ci_0022                 1.805586e-02 3 1  ON 21
ci_0023                -1.435505e-02 3 1  ON 22
ci_0024                -1.395717e-02 3 1  ON 23
ci_0025                -8.797968e-03 3 1  ON 24
ci_0026                -7.664425e-03 3 1  ON 25
ci_0027                -1.381081e-02 3 1  ON 26
ci_0028                -1.374389e-02 3 1  ON 27
ci_0029                -1.209489e-02 3 1  ON 28
ci_0030                -1.242610e-02 3 1  ON 29
ci_0031                 1.541118e-02 3 1  ON 30
ci_0032                 1.499883e-02 3 1  ON 31
ci_0033                 1.158032e-02 3 1  ON 32
ci_0034                 1.174398e-02 3 1  ON 33
ci_0035                 7.944850e-03 3 1  ON 34
ci_0036                 8.339906e-03 3 1  ON 35
ci_0037                -1.282390e-02 3 1  ON 36
ci_0038                -1.272442e-02 3 1  ON 37
ci_0039                -7.636797e-03 3 1  ON 38
ci_0040                -7.710654e-03 3 1  ON 39
ci_0041                 1.175591e-02 3 1  ON 40
ci_0042                 1.169028e-02 3 1  ON 41
ci_0043                -9.657062e-03 3 1  ON 42
ci_0044                -9.704484e-03 3 1  ON 43
ci_0045                 1.185654e-02 3 1  ON 44
ci_0046                 1.156066e-02 3 1  ON 45
ci_0047                -7.012402e-03 3 1  ON 46
ci_0048                -7.260101e-03 3 1  ON 47
ci_0049                -5.554069e-03 3 1  ON 48
ci_0050                -5.338897e-03 3 1  ON 49
ci_0051                -5.220553e-03 3 1  ON 50
ci_0052                -5.306304e-03 3 1  ON 51
ci_0053                -6.494034e-03 3 1  ON 52
ci_0054                -6.689171e-03 3 1  ON 53
ci_0055                 5.623805e-03 3 1  ON 54
ci_0056                 5.087641e-03 3 1  ON 55
ci_0057                 5.250756e-03 3 1  ON 56
ci_0058                 6.358441e-03 3 1  ON 57
ci_0059                -6.253964e-03 3 1  ON 58
ci_0060                -6.513296e-03 3 1  ON 59
ci_0061                -6.419192e-03 3 1  ON 60
ci_0062                -6.522376e-03 3 1  ON 61
ci_0063                -1.028064e-02 3 1  ON 62
ci_0064                -1.013438e-02 3 1  ON 63
ci_0065                -8.505621e-03 3 1  ON 64
ci_0066                -8.339560e-03 3 1  ON 65
ci_0067                -6.299287e-03 3 1  ON 66
ci_0068                -6.552668e-03 3 1  ON 67
ci_0069                 5.797187e-03 3 1  ON 68
ci_0070                 5.820220e-03 3 1  ON 69
ci_0071                 6.679349e-03 3 1  ON 70
ci_0072                 6.657434e-03 3 1  ON 71
ci_0073                 5.247514e-03 3 1  ON 72
ci_0074                 5.711757e-03 3 1  ON 73
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 27
    time step          = 0.05
    reference energy   = -16.8215
    reference variance = 0.946887
====================================================
  Execution time = 1.4435e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s027
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6903e+01
  VMC Evar = 3.2565e-01
  Total weights = 1.9516e+06
  Execution time = 1.9276e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.314517257054
                                         uncertainty =       0.003426037613

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.314517257054
                                         uncertainty =       0.003426037613

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000396558505
  error estimate for blocks of size 2^( 2) =       0.000410556996
  error estimate for blocks of size 2^( 3) =       0.000424787799
  error estimate for blocks of size 2^( 4) =       0.000437484705
  error estimate for blocks of size 2^( 5) =       0.000450223349
  error estimate for blocks of size 2^( 6) =       0.000458367476
  error estimate for blocks of size 2^( 7) =       0.000464338561

      target function =      -0.870845177240
              le_mean =     -16.903053831442
             les_mean =     286.040431182592
             stat err =       0.000452603523
             autocorr =       1.302630744152
   target nu stat err =       0.000452603523
   target dn stat err =       0.003885918274
      target stat err =       0.004769029490
              std dev =       0.560818415346
             le_variance =       0.314517294992

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.311296029513
                                         uncertainty =       0.003367255822

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.311296029513
                                         uncertainty =       0.003367255822

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000394521742
  error estimate for blocks of size 2^( 2) =       0.000408554124
  error estimate for blocks of size 2^( 3) =       0.000422858816
  error estimate for blocks of size 2^( 4) =       0.000435604997
  error estimate for blocks of size 2^( 5) =       0.000448398545
  error estimate for blocks of size 2^( 6) =       0.000456621599
  error estimate for blocks of size 2^( 7) =       0.000462594970

      target function =      -0.861224196145
              le_mean =     -16.903057088005
             les_mean =     286.048450066688
             stat err =       0.000450805028
             autocorr =       1.305676590718
   target nu stat err =       0.000450805028
   target dn stat err =       0.008939358985
      target stat err =       0.010654723419
              std dev =       0.557937998329
             le_variance =       0.311294809980

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.312573480587
                                         uncertainty =       0.003391032999

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.312573480587
                                         uncertainty =       0.003391032999

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000395330771
  error estimate for blocks of size 2^( 2) =       0.000409344435
  error estimate for blocks of size 2^( 3) =       0.000423616447
  error estimate for blocks of size 2^( 4) =       0.000436345035
  error estimate for blocks of size 2^( 5) =       0.000449113756
  error estimate for blocks of size 2^( 6) =       0.000457280868
  error estimate for blocks of size 2^( 7) =       0.000463279767

      target function =      -0.826925572580
              le_mean =     -16.903044006356
             les_mean =     286.076503953452
             stat err =       0.000451504857
             autocorr =       1.304378447714
   target nu stat err =       0.000451504857
   target dn stat err =       0.032303732068
      target stat err =       0.035512229764
              std dev =       0.559082137350
             le_variance =       0.312572836303

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.314245162502
                                         uncertainty =       0.003421187548

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.314245162502
                                         uncertainty =       0.003421187548

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000396386884
  error estimate for blocks of size 2^( 2) =       0.000410387077
  error estimate for blocks of size 2^( 3) =       0.000424623133
  error estimate for blocks of size 2^( 4) =       0.000437325026
  error estimate for blocks of size 2^( 5) =       0.000450066943
  error estimate for blocks of size 2^( 6) =       0.000458215386
  error estimate for blocks of size 2^( 7) =       0.000464187435

      target function =      -0.869968480923
              le_mean =     -16.903051040737
             les_mean =     286.041055934301
             stat err =       0.000452448698
             autocorr =       1.302867146960
   target nu stat err =       0.000452448698
   target dn stat err =       0.004076914377
      target stat err =       0.004989391043
              std dev =       0.560575707406
             le_variance =       0.314245123733


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.870845177240        initial  <--
     3.9062e-01     3.9062e+00             1.4016e-03        -0.861224196145
     1.5625e+00     1.5625e+01             3.8002e-04        -0.826925572580
     6.2500e+00     6.2500e+01             9.7050e-05        -0.869968480923

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 24.1603
  </log>
  <optVariables href="H2O.s027.opt.xml">
ci_0001                 6.992547e-01 3 1  ON 0
ci_0002                 6.969770e-01 3 1  ON 1
ci_0003                -3.849922e-02 3 1  ON 2
ci_0004                -3.856714e-02 3 1  ON 3
ci_0005                -3.630993e-02 3 1  ON 4
ci_0006                -3.660534e-02 3 1  ON 5
ci_0007                -2.503754e-02 3 1  ON 6
ci_0008                -2.525066e-02 3 1  ON 7
ci_0009                -2.397449e-02 3 1  ON 8
ci_0010                -2.410060e-02 3 1  ON 9
ci_0011                -2.012891e-02 3 1  ON 10
ci_0012                -2.002366e-02 3 1  ON 11
ci_0013                 2.003391e-02 3 1  ON 12
ci_0014                 1.973379e-02 3 1  ON 13
ci_0015                 2.031230e-02 3 1  ON 14
ci_0016                 2.004593e-02 3 1  ON 15
ci_0017                 1.811443e-02 3 1  ON 16
ci_0018                 1.799171e-02 3 1  ON 17
ci_0019                 1.549257e-02 3 1  ON 18
ci_0020                 1.525855e-02 3 1  ON 19
ci_0021                 1.795745e-02 3 1  ON 20
ci_0022                 1.815953e-02 3 1  ON 21
ci_0023                -1.445359e-02 3 1  ON 22
ci_0024                -1.409017e-02 3 1  ON 23
ci_0025                -9.142773e-03 3 1  ON 24
ci_0026                -8.031494e-03 3 1  ON 25
ci_0027                -1.391824e-02 3 1  ON 26
ci_0028                -1.382619e-02 3 1  ON 27
ci_0029                -1.219707e-02 3 1  ON 28
ci_0030                -1.255129e-02 3 1  ON 29
ci_0031                 1.545052e-02 3 1  ON 30
ci_0032                 1.508040e-02 3 1  ON 31
ci_0033                 1.163509e-02 3 1  ON 32
ci_0034                 1.184804e-02 3 1  ON 33
ci_0035                 8.138080e-03 3 1  ON 34
ci_0036                 8.570186e-03 3 1  ON 35
ci_0037                -1.290961e-02 3 1  ON 36
ci_0038                -1.280656e-02 3 1  ON 37
ci_0039                -7.834729e-03 3 1  ON 38
ci_0040                -7.895254e-03 3 1  ON 39
ci_0041                 1.185157e-02 3 1  ON 40
ci_0042                 1.177967e-02 3 1  ON 41
ci_0043                -9.877698e-03 3 1  ON 42
ci_0044                -9.851658e-03 3 1  ON 43
ci_0045                 1.189850e-02 3 1  ON 44
ci_0046                 1.167588e-02 3 1  ON 45
ci_0047                -7.168518e-03 3 1  ON 46
ci_0048                -7.418863e-03 3 1  ON 47
ci_0049                -5.700293e-03 3 1  ON 48
ci_0050                -5.472606e-03 3 1  ON 49
ci_0051                -5.448664e-03 3 1  ON 50
ci_0052                -5.474768e-03 3 1  ON 51
ci_0053                -6.602507e-03 3 1  ON 52
ci_0054                -6.851892e-03 3 1  ON 53
ci_0055                 5.829530e-03 3 1  ON 54
ci_0056                 5.326727e-03 3 1  ON 55
ci_0057                 5.344154e-03 3 1  ON 56
ci_0058                 6.591635e-03 3 1  ON 57
ci_0059                -6.398487e-03 3 1  ON 58
ci_0060                -6.650464e-03 3 1  ON 59
ci_0061                -6.561410e-03 3 1  ON 60
ci_0062                -6.671315e-03 3 1  ON 61
ci_0063                -1.031164e-02 3 1  ON 62
ci_0064                -1.015409e-02 3 1  ON 63
ci_0065                -8.578108e-03 3 1  ON 64
ci_0066                -8.398673e-03 3 1  ON 65
ci_0067                -6.437922e-03 3 1  ON 66
ci_0068                -6.662660e-03 3 1  ON 67
ci_0069                 5.903979e-03 3 1  ON 68
ci_0070                 5.947168e-03 3 1  ON 69
ci_0071                 6.797107e-03 3 1  ON 70
ci_0072                 6.786730e-03 3 1  ON 71
ci_0073                 5.361772e-03 3 1  ON 72
ci_0074                 5.780858e-03 3 1  ON 73
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 4.1249e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s028 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s028 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=28  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6895e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 28
    time step          = 0.05
    reference energy   = -16.8863
    reference variance = 0.332562
====================================================
  Execution time = 1.4602e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s028
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5227e+04
  VMC Eavg = -1.6902e+01
  VMC Evar = 3.2788e-01
  Total weights = 1.951412131e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 2.6367e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.315595200893
                                         uncertainty =       0.002397681999

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.315595200893
                                         uncertainty =       0.002397681999

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000397264992
  error estimate for blocks of size 2^( 2) =       0.000411415389
  error estimate for blocks of size 2^( 3) =       0.000425470626
  error estimate for blocks of size 2^( 4) =       0.000438614838
  error estimate for blocks of size 2^( 5) =       0.000450859811
  error estimate for blocks of size 2^( 6) =       0.000458740668
  error estimate for blocks of size 2^( 7) =       0.000461522841

      target function =      -0.869949709169
              le_mean =     -16.902446757610
             les_mean =     286.020590873252
             stat err =       0.000452434539
             autocorr =       1.297032662426
   target nu stat err =       0.000452434539
   target dn stat err =       0.003430347371
      target stat err =       0.004207652923
              std dev =       0.561817539523
             le_variance =       0.315638947716


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690244675761e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 74
Check correct_vf_var_size: 225, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 3.9062e+00, overlap shift 3.9062e+01 and omega -1.7527e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.869968927197       residual = 1.84e-01           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.870154259978       residual = 3.58e-02           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.870193473603       residual = 6.92e-03           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.870203496115       residual = 1.54e-03           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.870206410264       residual = 8.66e-04           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.870207480668       residual = 4.86e-04           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.870208177287       residual = 1.20e-04           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.870208471480       residual = 3.35e-05           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.870208474186       residual = 1.25e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.870208510966       residual = 6.98e-06           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.870208532073       residual = 5.44e-06           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.870208540465       residual = 4.30e-06           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.870208534665       residual = 4.10e-06           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.870208567194       residual = 1.74e-06           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.870208578275       residual = 4.66e-07           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.870208577140       residual = 5.32e-08           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.870208579788       residual = 1.87e-08           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.870208580018       residual = 7.53e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         17 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 3.9062e+00 is 1.592245e-04

solving harmonic davidson linear method for identity shift 1.5625e+01, overlap shift 1.5625e+02 and omega -1.7527e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.869968927197       residual = 1.84e-01           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.870015900990       residual = 3.57e-02           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.870025807151       residual = 6.87e-03           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.870028326618       residual = 1.52e-03           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.870029058274       residual = 8.54e-04           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.870029324970       residual = 4.77e-04           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.870029497912       residual = 1.17e-04           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.870029570867       residual = 3.26e-05           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.870029571229       residual = 1.21e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.870029580372       residual = 6.85e-06           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.870029585645       residual = 5.32e-06           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.870029587699       residual = 4.21e-06           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.870029586251       residual = 3.93e-06           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.870029594303       residual = 1.63e-06           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.870029596944       residual = 4.27e-07           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.870029596655       residual = 4.87e-08           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.870029597295       residual = 1.72e-08           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.870029597342       residual = 6.91e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         17 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 1.5625e+01 is 4.007156e-05

solving harmonic davidson linear method for identity shift 6.2500e+01, overlap shift 6.2500e+02 and omega -1.7527e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.869968927197       residual = 1.84e-01           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.869980711367       residual = 3.56e-02           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.869983194404       residual = 6.86e-03           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.869983825133       residual = 1.52e-03           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.869984008240       residual = 8.51e-04           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.869984074854       residual = 4.75e-04           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.869984118012       residual = 1.17e-04           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.869984136212       residual = 3.24e-05           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.869984136283       residual = 1.20e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.869984138566       residual = 6.82e-06           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.869984139884       residual = 5.29e-06           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.869984140394       residual = 4.19e-06           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.869984140032       residual = 3.89e-06           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.869984142040       residual = 1.60e-06           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.869984142692       residual = 4.17e-07           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.869984142620       residual = 4.77e-08           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.869984142779       residual = 1.69e-08           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.869984142790       residual = 6.76e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         17 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 6.2500e+01 is 1.003461e-05

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.491182 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 75 and numParams is: 74

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.7255e+01
  </log>
  <optVariables href="H2O.s028.opt.xml">
ci_0001                 6.992803e-01 3 1  ON 0
ci_0002                 6.969749e-01 3 1  ON 1
ci_0003                -3.846667e-02 3 1  ON 2
ci_0004                -3.853507e-02 3 1  ON 3
ci_0005                -3.628170e-02 3 1  ON 4
ci_0006                -3.657861e-02 3 1  ON 5
ci_0007                -2.499747e-02 3 1  ON 6
ci_0008                -2.522034e-02 3 1  ON 7
ci_0009                -2.395222e-02 3 1  ON 8
ci_0010                -2.407587e-02 3 1  ON 9
ci_0011                -2.010678e-02 3 1  ON 10
ci_0012                -2.000451e-02 3 1  ON 11
ci_0013                 2.001585e-02 3 1  ON 12
ci_0014                 1.971574e-02 3 1  ON 13
ci_0015                 2.029155e-02 3 1  ON 14
ci_0016                 2.002780e-02 3 1  ON 15
ci_0017                 1.809688e-02 3 1  ON 16
ci_0018                 1.797534e-02 3 1  ON 17
ci_0019                 1.547905e-02 3 1  ON 18
ci_0020                 1.524649e-02 3 1  ON 19
ci_0021                 1.795473e-02 3 1  ON 20
ci_0022                 1.815927e-02 3 1  ON 21
ci_0023                -1.444095e-02 3 1  ON 22
ci_0024                -1.407674e-02 3 1  ON 23
ci_0025                -9.113065e-03 3 1  ON 24
ci_0026                -8.007547e-03 3 1  ON 25
ci_0027                -1.390293e-02 3 1  ON 26
ci_0028                -1.381242e-02 3 1  ON 27
ci_0029                -1.218840e-02 3 1  ON 28
ci_0030                -1.254383e-02 3 1  ON 29
ci_0031                 1.544208e-02 3 1  ON 30
ci_0032                 1.507503e-02 3 1  ON 31
ci_0033                 1.162870e-02 3 1  ON 32
ci_0034                 1.183048e-02 3 1  ON 33
ci_0035                 8.124376e-03 3 1  ON 34
ci_0036                 8.547188e-03 3 1  ON 35
ci_0037                -1.291234e-02 3 1  ON 36
ci_0038                -1.280018e-02 3 1  ON 37
ci_0039                -7.815129e-03 3 1  ON 38
ci_0040                -7.877029e-03 3 1  ON 39
ci_0041                 1.184527e-02 3 1  ON 40
ci_0042                 1.176686e-02 3 1  ON 41
ci_0043                -9.864566e-03 3 1  ON 42
ci_0044                -9.839680e-03 3 1  ON 43
ci_0045                 1.189809e-02 3 1  ON 44
ci_0046                 1.166867e-02 3 1  ON 45
ci_0047                -7.147476e-03 3 1  ON 46
ci_0048                -7.400457e-03 3 1  ON 47
ci_0049                -5.683016e-03 3 1  ON 48
ci_0050                -5.454664e-03 3 1  ON 49
ci_0051                -5.431349e-03 3 1  ON 50
ci_0052                -5.454665e-03 3 1  ON 51
ci_0053                -6.589365e-03 3 1  ON 52
ci_0054                -6.838014e-03 3 1  ON 53
ci_0055                 5.813467e-03 3 1  ON 54
ci_0056                 5.316040e-03 3 1  ON 55
ci_0057                 5.328669e-03 3 1  ON 56
ci_0058                 6.572721e-03 3 1  ON 57
ci_0059                -6.382656e-03 3 1  ON 58
ci_0060                -6.632493e-03 3 1  ON 59
ci_0061                -6.548767e-03 3 1  ON 60
ci_0062                -6.657824e-03 3 1  ON 61
ci_0063                -1.030690e-02 3 1  ON 62
ci_0064                -1.014825e-02 3 1  ON 63
ci_0065                -8.567771e-03 3 1  ON 64
ci_0066                -8.386381e-03 3 1  ON 65
ci_0067                -6.428189e-03 3 1  ON 66
ci_0068                -6.649950e-03 3 1  ON 67
ci_0069                 5.894170e-03 3 1  ON 68
ci_0070                 5.932963e-03 3 1  ON 69
ci_0071                 6.784190e-03 3 1  ON 70
ci_0072                 6.775286e-03 3 1  ON 71
ci_0073                 5.354382e-03 3 1  ON 72
ci_0074                 5.766647e-03 3 1  ON 73
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 28
    time step          = 0.05
    reference energy   = -16.9343
    reference variance = 0.522579
====================================================
  Execution time = 1.4438e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s028
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6903e+01
  VMC Evar = 3.2839e-01
  Total weights = 1.9515e+06
  Execution time = 1.9099e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.313751670059
                                         uncertainty =       0.002120843155

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.313751670059
                                         uncertainty =       0.002120843155

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000396121382
  error estimate for blocks of size 2^( 2) =       0.000410249639
  error estimate for blocks of size 2^( 3) =       0.000424413710
  error estimate for blocks of size 2^( 4) =       0.000437794119
  error estimate for blocks of size 2^( 5) =       0.000449053369
  error estimate for blocks of size 2^( 6) =       0.000459037386
  error estimate for blocks of size 2^( 7) =       0.000463877297

      target function =      -0.868330486162
              le_mean =     -16.902552901655
             les_mean =     286.025524738622
             stat err =       0.000452440543
             autocorr =       1.304567212567
   target nu stat err =       0.000452440543
   target dn stat err =       0.003659003883
      target stat err =       0.004466283897
              std dev =       0.560200230180
             le_variance =       0.313824297894

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.313370735042
                                         uncertainty =       0.002116274217

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.313370735042
                                         uncertainty =       0.002116274217

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000395880788
  error estimate for blocks of size 2^( 2) =       0.000410012556
  error estimate for blocks of size 2^( 3) =       0.000424184542
  error estimate for blocks of size 2^( 4) =       0.000437577178
  error estimate for blocks of size 2^( 5) =       0.000448847276
  error estimate for blocks of size 2^( 6) =       0.000458829291
  error estimate for blocks of size 2^( 7) =       0.000463676747

      target function =      -0.869866535363
              le_mean =     -16.902551384657
             les_mean =     286.024205792962
             stat err =       0.000452232623
             autocorr =       1.304953160883
   target nu stat err =       0.000452232623
   target dn stat err =       0.003519040079
      target stat err =       0.004313900243
              std dev =       0.559859979658
             le_variance =       0.313443196822

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.313557277587
                                         uncertainty =       0.002118513541

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.313557277587
                                         uncertainty =       0.002118513541

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000395998625
  error estimate for blocks of size 2^( 2) =       0.000410128618
  error estimate for blocks of size 2^( 3) =       0.000424296739
  error estimate for blocks of size 2^( 4) =       0.000437683311
  error estimate for blocks of size 2^( 5) =       0.000448948006
  error estimate for blocks of size 2^( 6) =       0.000458931188
  error estimate for blocks of size 2^( 7) =       0.000463774912

      target function =      -0.869588140881
              le_mean =     -16.902551923626
             les_mean =     286.024453533718
             stat err =       0.000452334354
             autocorr =       1.304763473999
   target nu stat err =       0.000452334354
   target dn stat err =       0.003537130693
      target stat err =       0.004332884568
              std dev =       0.560026626155
             le_variance =       0.313629822002

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.313727115991
                                         uncertainty =       0.002120548805

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.313727115991
                                         uncertainty =       0.002120548805

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000396105878
  error estimate for blocks of size 2^( 2) =       0.000410234342
  error estimate for blocks of size 2^( 3) =       0.000424398935
  error estimate for blocks of size 2^( 4) =       0.000437780111
  error estimate for blocks of size 2^( 5) =       0.000449040015
  error estimate for blocks of size 2^( 6) =       0.000459024013
  error estimate for blocks of size 2^( 7) =       0.000463864410

      target function =      -0.868862105255
              le_mean =     -16.902552736428
             les_mean =     286.025080240234
             stat err =       0.000452427137
             autocorr =       1.304592023839
   target nu stat err =       0.000452427137
   target dn stat err =       0.003581993315
      target stat err =       0.004379464257
              std dev =       0.560178305138
             le_variance =       0.313799733548


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.868330486162        initial
     3.9062e+00     3.9062e+01             1.5922e-04        -0.869866535363  <--
     1.5625e+01     1.5625e+02             4.0072e-05        -0.869588140881
     6.2500e+01     6.2500e+02             1.0035e-05        -0.868862105255

*****************************************************************************
Applying the update for shift_i =   3.9062e+00     and shift_s =   3.9062e+01
*****************************************************************************

  Execution time = 2.4096e+01
  </log>
  <optVariables href="H2O.s028.opt.xml">
ci_0001                 6.993565e-01 3 1  ON 0
ci_0002                 6.969681e-01 3 1  ON 1
ci_0003                -3.837042e-02 3 1  ON 2
ci_0004                -3.844020e-02 3 1  ON 3
ci_0005                -3.619797e-02 3 1  ON 4
ci_0006                -3.649931e-02 3 1  ON 5
ci_0007                -2.487832e-02 3 1  ON 6
ci_0008                -2.513021e-02 3 1  ON 7
ci_0009                -2.388650e-02 3 1  ON 8
ci_0010                -2.400282e-02 3 1  ON 9
ci_0011                -2.004141e-02 3 1  ON 10
ci_0012                -1.994795e-02 3 1  ON 11
ci_0013                 1.996251e-02 3 1  ON 12
ci_0014                 1.966242e-02 3 1  ON 13
ci_0015                 2.023026e-02 3 1  ON 14
ci_0016                 1.997424e-02 3 1  ON 15
ci_0017                 1.804508e-02 3 1  ON 16
ci_0018                 1.792703e-02 3 1  ON 17
ci_0019                 1.543920e-02 3 1  ON 18
ci_0020                 1.521089e-02 3 1  ON 19
ci_0021                 1.794655e-02 3 1  ON 20
ci_0022                 1.815840e-02 3 1  ON 21
ci_0023                -1.440367e-02 3 1  ON 22
ci_0024                -1.403712e-02 3 1  ON 23
ci_0025                -9.025584e-03 3 1  ON 24
ci_0026                -7.936985e-03 3 1  ON 25
ci_0027                -1.385774e-02 3 1  ON 26
ci_0028                -1.377177e-02 3 1  ON 27
ci_0029                -1.216287e-02 3 1  ON 28
ci_0030                -1.252185e-02 3 1  ON 29
ci_0031                 1.541701e-02 3 1  ON 30
ci_0032                 1.505908e-02 3 1  ON 31
ci_0033                 1.160975e-02 3 1  ON 32
ci_0034                 1.177838e-02 3 1  ON 33
ci_0035                 8.084039e-03 3 1  ON 34
ci_0036                 8.479451e-03 3 1  ON 35
ci_0037                -1.292044e-02 3 1  ON 36
ci_0038                -1.278127e-02 3 1  ON 37
ci_0039                -7.757358e-03 3 1  ON 38
ci_0040                -7.823303e-03 3 1  ON 39
ci_0041                 1.182664e-02 3 1  ON 40
ci_0042                 1.172895e-02 3 1  ON 41
ci_0043                -9.825633e-03 3 1  ON 42
ci_0044                -9.804166e-03 3 1  ON 43
ci_0045                 1.189689e-02 3 1  ON 44
ci_0046                 1.164733e-02 3 1  ON 45
ci_0047                -7.085441e-03 3 1  ON 46
ci_0048                -7.346193e-03 3 1  ON 47
ci_0049                -5.632141e-03 3 1  ON 48
ci_0050                -5.401841e-03 3 1  ON 49
ci_0051                -5.380411e-03 3 1  ON 50
ci_0052                -5.395544e-03 3 1  ON 51
ci_0053                -6.550648e-03 3 1  ON 52
ci_0054                -6.797135e-03 3 1  ON 53
ci_0055                 5.766180e-03 3 1  ON 54
ci_0056                 5.284569e-03 3 1  ON 55
ci_0057                 5.283042e-03 3 1  ON 56
ci_0058                 6.516977e-03 3 1  ON 57
ci_0059                -6.336042e-03 3 1  ON 58
ci_0060                -6.579552e-03 3 1  ON 59
ci_0061                -6.511417e-03 3 1  ON 60
ci_0062                -6.617965e-03 3 1  ON 61
ci_0063                -1.029290e-02 3 1  ON 62
ci_0064                -1.013103e-02 3 1  ON 63
ci_0065                -8.537248e-03 3 1  ON 64
ci_0066                -8.350058e-03 3 1  ON 65
ci_0067                -6.399526e-03 3 1  ON 66
ci_0068                -6.612520e-03 3 1  ON 67
ci_0069                 5.865276e-03 3 1  ON 68
ci_0070                 5.891127e-03 3 1  ON 69
ci_0071                 6.746123e-03 3 1  ON 70
ci_0072                 6.741548e-03 3 1  ON 71
ci_0073                 5.332629e-03 3 1  ON 72
ci_0074                 5.724796e-03 3 1  ON 73
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 4.1356e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s029 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s029 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=29  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6896e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 29
    time step          = 0.05
    reference energy   = -16.852
    reference variance = 0.201689
====================================================
  Execution time = 1.4551e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s029
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5279e+04
  VMC Eavg = -1.6903e+01
  VMC Evar = 3.1791e-01
  Total weights = 1.951488152e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 2.5819e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.307666746557
                                         uncertainty =       0.001697908561

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.307666746557
                                         uncertainty =       0.001697908561

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000392220676
  error estimate for blocks of size 2^( 2) =       0.000405815823
  error estimate for blocks of size 2^( 3) =       0.000419856004
  error estimate for blocks of size 2^( 4) =       0.000431826480
  error estimate for blocks of size 2^( 5) =       0.000441714508
  error estimate for blocks of size 2^( 6) =       0.000448994744
  error estimate for blocks of size 2^( 7) =       0.000453149003

      target function =      -0.882264192929
              le_mean =     -16.902676676857
             les_mean =     286.018387333030
             stat err =       0.000443921184
             autocorr =       1.281004841946
   target nu stat err =       0.000443921184
   target dn stat err =       0.002041142280
      target stat err =       0.002623090141
              std dev =       0.554683800002
             le_variance =       0.307674117985


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690267667686e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 74
Check correct_vf_var_size: 225, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 9.7656e-01, overlap shift 9.7656e+00 and omega -1.7527e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.882270916987       residual = 1.78e-01           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.883011206636       residual = 2.81e-02           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.883140021303       residual = 6.38e-03           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.883173146525       residual = 1.57e-03           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.883183287801       residual = 6.53e-04           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.883188588644       residual = 4.41e-04           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.883190820408       residual = 1.18e-04           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.883191491366       residual = 3.93e-05           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.883191826267       residual = 1.89e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.883191881778       residual = 1.25e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.883192020815       residual = 1.07e-05           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.883192083655       residual = 6.99e-06           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.883192169793       residual = 7.95e-06           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.883192273084       residual = 2.97e-06           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.883192387590       residual = 1.11e-06           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.883192416581       residual = 1.55e-07           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.883192396640       residual = 3.86e-08           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.883192394295       residual = 1.86e-08           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.883192391042       residual = 4.73e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         18 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 9.7656e-01 is 5.503707e-04

solving harmonic davidson linear method for identity shift 3.9062e+00, overlap shift 3.9062e+01 and omega -1.7527e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.882270916987       residual = 1.78e-01           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.882466166035       residual = 2.77e-02           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.882499730277       residual = 6.21e-03           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.882508202242       residual = 1.51e-03           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.882510776835       residual = 6.21e-04           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.882512106447       residual = 4.08e-04           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.882512646421       residual = 1.08e-04           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.882512806647       residual = 3.58e-05           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.882512886475       residual = 1.71e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.882512898411       residual = 1.15e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.882512932812       residual = 9.74e-06           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.882512948399       residual = 6.24e-06           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.882512969662       residual = 6.65e-06           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.882512993448       residual = 2.31e-06           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.882513018665       residual = 7.98e-07           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.882513024453       residual = 1.09e-07           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.882513019873       residual = 2.84e-08           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.882513019340       residual = 1.32e-08           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.882513018633       residual = 3.21e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         18 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 3.9062e+00 is 1.452139e-04

solving harmonic davidson linear method for identity shift 1.5625e+01, overlap shift 1.5625e+02 and omega -1.7527e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.882270916987       residual = 1.78e-01           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.882320408977       residual = 2.76e-02           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.882328889104       residual = 6.16e-03           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.882331018904       residual = 1.49e-03           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.882331664885       residual = 6.13e-04           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.882331997406       residual = 4.00e-04           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.882332131152       residual = 1.06e-04           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.882332170702       residual = 3.49e-05           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.882332190401       residual = 1.67e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.882332193259       residual = 1.13e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.882332201837       residual = 9.49e-06           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.882332205726       residual = 6.06e-06           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.882332211018       residual = 6.34e-06           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.882332216831       residual = 2.15e-06           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.882332222923       residual = 7.31e-07           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.882332224285       residual = 9.93e-08           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.882332223166       residual = 2.63e-08           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.882332223036       residual = 1.21e-08           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.882332222866       residual = 2.90e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         18 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 1.5625e+01 is 3.681267e-05

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.502645 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 75 and numParams is: 74

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.7149e+01
  </log>
  <optVariables href="H2O.s029.opt.xml">
ci_0001                 6.994723e-01 3 1  ON 0
ci_0002                 6.969407e-01 3 1  ON 1
ci_0003                -3.824002e-02 3 1  ON 2
ci_0004                -3.833090e-02 3 1  ON 3
ci_0005                -3.606551e-02 3 1  ON 4
ci_0006                -3.639925e-02 3 1  ON 5
ci_0007                -2.477255e-02 3 1  ON 6
ci_0008                -2.500850e-02 3 1  ON 7
ci_0009                -2.380540e-02 3 1  ON 8
ci_0010                -2.390923e-02 3 1  ON 9
ci_0011                -1.996975e-02 3 1  ON 10
ci_0012                -1.987265e-02 3 1  ON 11
ci_0013                 1.990671e-02 3 1  ON 12
ci_0014                 1.959546e-02 3 1  ON 13
ci_0015                 2.014948e-02 3 1  ON 14
ci_0016                 1.990209e-02 3 1  ON 15
ci_0017                 1.796900e-02 3 1  ON 16
ci_0018                 1.786049e-02 3 1  ON 17
ci_0019                 1.536553e-02 3 1  ON 18
ci_0020                 1.517164e-02 3 1  ON 19
ci_0021                 1.793703e-02 3 1  ON 20
ci_0022                 1.817964e-02 3 1  ON 21
ci_0023                -1.434720e-02 3 1  ON 22
ci_0024                -1.399421e-02 3 1  ON 23
ci_0025                -8.880370e-03 3 1  ON 24
ci_0026                -7.843650e-03 3 1  ON 25
ci_0027                -1.382291e-02 3 1  ON 26
ci_0028                -1.371604e-02 3 1  ON 27
ci_0029                -1.211646e-02 3 1  ON 28
ci_0030                -1.245270e-02 3 1  ON 29
ci_0031                 1.538116e-02 3 1  ON 30
ci_0032                 1.504474e-02 3 1  ON 31
ci_0033                 1.156097e-02 3 1  ON 32
ci_0034                 1.174283e-02 3 1  ON 33
ci_0035                 8.040091e-03 3 1  ON 34
ci_0036                 8.408242e-03 3 1  ON 35
ci_0037                -1.290903e-02 3 1  ON 36
ci_0038                -1.274879e-02 3 1  ON 37
ci_0039                -7.678326e-03 3 1  ON 38
ci_0040                -7.748566e-03 3 1  ON 39
ci_0041                 1.178418e-02 3 1  ON 40
ci_0042                 1.168756e-02 3 1  ON 41
ci_0043                -9.790880e-03 3 1  ON 42
ci_0044                -9.801423e-03 3 1  ON 43
ci_0045                 1.187594e-02 3 1  ON 44
ci_0046                 1.161423e-02 3 1  ON 45
ci_0047                -7.020168e-03 3 1  ON 46
ci_0048                -7.278629e-03 3 1  ON 47
ci_0049                -5.557184e-03 3 1  ON 48
ci_0050                -5.363442e-03 3 1  ON 49
ci_0051                -5.314855e-03 3 1  ON 50
ci_0052                -5.319906e-03 3 1  ON 51
ci_0053                -6.483344e-03 3 1  ON 52
ci_0054                -6.740538e-03 3 1  ON 53
ci_0055                 5.697951e-03 3 1  ON 54
ci_0056                 5.225195e-03 3 1  ON 55
ci_0057                 5.216191e-03 3 1  ON 56
ci_0058                 6.438295e-03 3 1  ON 57
ci_0059                -6.291790e-03 3 1  ON 58
ci_0060                -6.510225e-03 3 1  ON 59
ci_0061                -6.467530e-03 3 1  ON 60
ci_0062                -6.550256e-03 3 1  ON 61
ci_0063                -1.027420e-02 3 1  ON 62
ci_0064                -1.012954e-02 3 1  ON 63
ci_0065                -8.517914e-03 3 1  ON 64
ci_0066                -8.318931e-03 3 1  ON 65
ci_0067                -6.346967e-03 3 1  ON 66
ci_0068                -6.560112e-03 3 1  ON 67
ci_0069                 5.825978e-03 3 1  ON 68
ci_0070                 5.824815e-03 3 1  ON 69
ci_0071                 6.707468e-03 3 1  ON 70
ci_0072                 6.702559e-03 3 1  ON 71
ci_0073                 5.284787e-03 3 1  ON 72
ci_0074                 5.678705e-03 3 1  ON 73
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 29
    time step          = 0.05
    reference energy   = -16.8395
    reference variance = 0.415738
====================================================
  Execution time = 1.4121e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s029
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6902e+01
  VMC Evar = 3.2735e-01
  Total weights = 1.9515e+06
  Execution time = 1.9197e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.315450774128
                                         uncertainty =       0.001950344172

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.315450774128
                                         uncertainty =       0.001950344172

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000397147558
  error estimate for blocks of size 2^( 2) =       0.000410691567
  error estimate for blocks of size 2^( 3) =       0.000424219513
  error estimate for blocks of size 2^( 4) =       0.000437091807
  error estimate for blocks of size 2^( 5) =       0.000448505440
  error estimate for blocks of size 2^( 6) =       0.000455884042
  error estimate for blocks of size 2^( 7) =       0.000458742405

      target function =      -0.869875481224
              le_mean =     -16.902187840810
             les_mean =     286.011879287617
             stat err =       0.000450055923
             autocorr =       1.284189666608
   target nu stat err =       0.000450055923
   target dn stat err =       0.002893853876
      target stat err =       0.003563022722
              std dev =       0.561651462884
             le_variance =       0.315452365760

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.314194638963
                                         uncertainty =       0.001962691185

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.314194638963
                                         uncertainty =       0.001962691185

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000396356551
  error estimate for blocks of size 2^( 2) =       0.000409924501
  error estimate for blocks of size 2^( 3) =       0.000423491084
  error estimate for blocks of size 2^( 4) =       0.000436384728
  error estimate for blocks of size 2^( 5) =       0.000447803078
  error estimate for blocks of size 2^( 6) =       0.000455201376
  error estimate for blocks of size 2^( 7) =       0.000458068560

      target function =      -0.871410372201
              le_mean =     -16.902202801144
             les_mean =     286.011121969125
             stat err =       0.000449364435
             autocorr =       1.285361578409
   target nu stat err =       0.000449364435
   target dn stat err =       0.002936038484
      target stat err =       0.003625856815
              std dev =       0.560532809765
             le_variance =       0.314197030823

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.314770248851
                                         uncertainty =       0.001956408964

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.314770248851
                                         uncertainty =       0.001956408964

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000396719213
  error estimate for blocks of size 2^( 2) =       0.000410275341
  error estimate for blocks of size 2^( 3) =       0.000423823319
  error estimate for blocks of size 2^( 4) =       0.000436706512
  error estimate for blocks of size 2^( 5) =       0.000448122961
  error estimate for blocks of size 2^( 6) =       0.000455512217
  error estimate for blocks of size 2^( 7) =       0.000458375620

      target function =      -0.871068976059
              le_mean =     -16.902192999633
             les_mean =     286.011070907352
             stat err =       0.000449679327
             autocorr =       1.284811389180
   target nu stat err =       0.000449679327
   target dn stat err =       0.002879762252
      target stat err =       0.003555732962
              std dev =       0.561045691542
             le_variance =       0.314772267998

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.315362069379
                                         uncertainty =       0.001951066614

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.315362069379
                                         uncertainty =       0.001951066614

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000397091750
  error estimate for blocks of size 2^( 2) =       0.000410637234
  error estimate for blocks of size 2^( 3) =       0.000424167688
  error estimate for blocks of size 2^( 4) =       0.000437041332
  error estimate for blocks of size 2^( 5) =       0.000448455321
  error estimate for blocks of size 2^( 6) =       0.000455835320
  error estimate for blocks of size 2^( 7) =       0.000458694234

      target function =      -0.870073341469
              le_mean =     -16.902188160027
             les_mean =     286.011726924792
             stat err =       0.000450006551
             autocorr =       1.284268834251
   target nu stat err =       0.000450006551
   target dn stat err =       0.002889943291
      target stat err =       0.003559940467
              std dev =       0.561572539045
             le_variance =       0.315363716609


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.869875481224        initial
     9.7656e-01     9.7656e+00             5.5037e-04        -0.871410372201  <--
     3.9062e+00     3.9062e+01             1.4521e-04        -0.871068976059
     1.5625e+01     1.5625e+02             3.6813e-05        -0.870073341469

*****************************************************************************
Applying the update for shift_i =   9.7656e-01     and shift_s =   9.7656e+00
*****************************************************************************

  Execution time = 2.3808e+01
  </log>
  <optVariables href="H2O.s029.opt.xml">
ci_0001                 6.998124e-01 3 1  ON 0
ci_0002                 6.968505e-01 3 1  ON 1
ci_0003                -3.787097e-02 3 1  ON 2
ci_0004                -3.802088e-02 3 1  ON 3
ci_0005                -3.568641e-02 3 1  ON 4
ci_0006                -3.611240e-02 3 1  ON 5
ci_0007                -2.446670e-02 3 1  ON 6
ci_0008                -2.465573e-02 3 1  ON 7
ci_0009                -2.357753e-02 3 1  ON 8
ci_0010                -2.364530e-02 3 1  ON 9
ci_0011                -1.976820e-02 3 1  ON 10
ci_0012                -1.966001e-02 3 1  ON 11
ci_0013                 1.974976e-02 3 1  ON 12
ci_0014                 1.940645e-02 3 1  ON 13
ci_0015                 1.992182e-02 3 1  ON 14
ci_0016                 1.969836e-02 3 1  ON 15
ci_0017                 1.775517e-02 3 1  ON 16
ci_0018                 1.767304e-02 3 1  ON 17
ci_0019                 1.515835e-02 3 1  ON 18
ci_0020                 1.506141e-02 3 1  ON 19
ci_0021                 1.790852e-02 3 1  ON 20
ci_0022                 1.824012e-02 3 1  ON 21
ci_0023                -1.418876e-02 3 1  ON 22
ci_0024                -1.387371e-02 3 1  ON 23
ci_0025                -8.475213e-03 3 1  ON 24
ci_0026                -7.582621e-03 3 1  ON 25
ci_0027                -1.372581e-02 3 1  ON 26
ci_0028                -1.355908e-02 3 1  ON 27
ci_0029                -1.198664e-02 3 1  ON 28
ci_0030                -1.225810e-02 3 1  ON 29
ci_0031                 1.527852e-02 3 1  ON 30
ci_0032                 1.500292e-02 3 1  ON 31
ci_0033                 1.142128e-02 3 1  ON 32
ci_0034                 1.164095e-02 3 1  ON 33
ci_0035                 7.917768e-03 3 1  ON 34
ci_0036                 8.209605e-03 3 1  ON 35
ci_0037                -1.287690e-02 3 1  ON 36
ci_0038                -1.265616e-02 3 1  ON 37
ci_0039                -7.457252e-03 3 1  ON 38
ci_0040                -7.539399e-03 3 1  ON 39
ci_0041                 1.166384e-02 3 1  ON 40
ci_0042                 1.157013e-02 3 1  ON 41
ci_0043                -9.692138e-03 3 1  ON 42
ci_0044                -9.794222e-03 3 1  ON 43
ci_0045                 1.181643e-02 3 1  ON 44
ci_0046                 1.151995e-02 3 1  ON 45
ci_0047                -6.837543e-03 3 1  ON 46
ci_0048                -7.089466e-03 3 1  ON 47
ci_0049                -5.348435e-03 3 1  ON 48
ci_0050                -5.256624e-03 3 1  ON 49
ci_0051                -5.132851e-03 3 1  ON 50
ci_0052                -5.109738e-03 3 1  ON 51
ci_0053                -6.295650e-03 3 1  ON 52
ci_0054                -6.582779e-03 3 1  ON 53
ci_0055                 5.507880e-03 3 1  ON 54
ci_0056                 5.059860e-03 3 1  ON 55
ci_0057                 5.029470e-03 3 1  ON 56
ci_0058                 6.218266e-03 3 1  ON 57
ci_0059                -6.168428e-03 3 1  ON 58
ci_0060                -6.317013e-03 3 1  ON 59
ci_0061                -6.343906e-03 3 1  ON 60
ci_0062                -6.359211e-03 3 1  ON 61
ci_0063                -1.022197e-02 3 1  ON 62
ci_0064                -1.012543e-02 3 1  ON 63
ci_0065                -8.463526e-03 3 1  ON 64
ci_0066                -8.231052e-03 3 1  ON 65
ci_0067                -6.200713e-03 3 1  ON 66
ci_0068                -6.413892e-03 3 1  ON 67
ci_0069                 5.716542e-03 3 1  ON 68
ci_0070                 5.639917e-03 3 1  ON 69
ci_0071                 6.599289e-03 3 1  ON 70
ci_0072                 6.593497e-03 3 1  ON 71
ci_0073                 5.151605e-03 3 1  ON 72
ci_0074                 5.550300e-03 3 1  ON 73
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 4.0963e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s030 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s030 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=30  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6894e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 30
    time step          = 0.05
    reference energy   = -16.9741
    reference variance = 0.692884
====================================================
  Execution time = 1.4606e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s030
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5253e+04
  VMC Eavg = -1.6903e+01
  VMC Evar = 3.3241e-01
  Total weights = 1.951625604e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 2.5882e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.316571297007
                                         uncertainty =       0.001989960748

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.316571297007
                                         uncertainty =       0.001989960748

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000397867630
  error estimate for blocks of size 2^( 2) =       0.000411583379
  error estimate for blocks of size 2^( 3) =       0.000425708456
  error estimate for blocks of size 2^( 4) =       0.000438641783
  error estimate for blocks of size 2^( 5) =       0.000448548883
  error estimate for blocks of size 2^( 6) =       0.000458281741
  error estimate for blocks of size 2^( 7) =       0.000463390245

      target function =      -0.864536528817
              le_mean =     -16.902820364853
             les_mean =     286.037743003698
             stat err =       0.000452215663
             autocorr =       1.291855642111
   target nu stat err =       0.000452215663
   target dn stat err =       0.003765366497
      target stat err =       0.004555808395
              std dev =       0.562669798768
             le_variance =       0.316597302446


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690282036485e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 74
Check correct_vf_var_size: 225, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.4414e-01, overlap shift 2.4414e+00 and omega -1.7527e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.864559631240       residual = 2.52e-01           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.866811332859       residual = 5.97e-02           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.867536606089       residual = 9.20e-03           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.867707541728       residual = 3.60e-03           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.867759652405       residual = 1.26e-03           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.867787437068       residual = 5.71e-04           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.867805963009       residual = 1.74e-04           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.867807743450       residual = 5.21e-05           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.867809105009       residual = 1.72e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.867809361412       residual = 4.89e-06           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.867809323587       residual = 2.22e-06           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.867809174143       residual = 4.66e-07           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.867809221222       residual = 1.76e-07           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.867809258537       residual = 9.43e-08           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.867809271728       residual = 1.41e-07           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.867809340005       residual = 1.45e-07           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.867809364759       residual = 4.90e-08           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.867809396393       residual = 2.43e-08           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.867809404868       residual = 9.57e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         18 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 2.4414e-01 is 1.697437e-03

solving harmonic davidson linear method for identity shift 9.7656e-01, overlap shift 9.7656e+00 and omega -1.7527e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.864559631240       residual = 2.52e-01           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.865243868384       residual = 5.77e-02           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.865455798353       residual = 8.62e-03           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.865503621339       residual = 3.16e-03           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.865517592493       residual = 1.10e-03           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.865524871227       residual = 4.73e-04           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.865529348488       residual = 1.32e-04           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.865529662205       residual = 3.71e-05           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.865529948077       residual = 1.12e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.865529985576       residual = 3.17e-06           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.865529969089       residual = 1.26e-06           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.865529934409       residual = 2.34e-07           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.865529944008       residual = 7.75e-08           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.865529950641       residual = 3.61e-08           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.865529953372       residual = 4.96e-08           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.865529963869       residual = 4.47e-08           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.865529967156       residual = 1.62e-08           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.865529972782       residual = 7.98e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         17 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 9.7656e-01 is 5.098438e-04

solving harmonic davidson linear method for identity shift 3.9062e+00, overlap shift 3.9062e+01 and omega -1.7527e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.864559631240       residual = 2.52e-01           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.864740405120       residual = 5.71e-02           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.864795683777       residual = 8.44e-03           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.864807985013       residual = 3.04e-03           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.864811531140       residual = 1.06e-03           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.864813364984       residual = 4.45e-04           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.864814464742       residual = 1.21e-04           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.864814532798       residual = 3.33e-05           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.864814600014       residual = 9.85e-06           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.864814607501       residual = 2.77e-06           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.864814602989       residual = 1.05e-06           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.864814594606       residual = 1.87e-07           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.864814596825       residual = 5.87e-08           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.864814598273       residual = 2.54e-08           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.864814598872       residual = 3.30e-08           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.864814601020       residual = 2.95e-08           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.864814601690       residual = 1.13e-08           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.864814602958       residual = 5.60e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         17 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 3.9062e+00 is 1.344595e-04

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.513370 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 75 and numParams is: 74

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.7210e+01
  </log>
  <optVariables href="H2O.s030.opt.xml">
ci_0001                 6.999972e-01 3 1  ON 0
ci_0002                 6.969989e-01 3 1  ON 1
ci_0003                -3.743445e-02 3 1  ON 2
ci_0004                -3.754930e-02 3 1  ON 3
ci_0005                -3.522511e-02 3 1  ON 4
ci_0006                -3.563380e-02 3 1  ON 5
ci_0007                -2.406825e-02 3 1  ON 6
ci_0008                -2.422730e-02 3 1  ON 7
ci_0009                -2.327350e-02 3 1  ON 8
ci_0010                -2.334585e-02 3 1  ON 9
ci_0011                -1.949673e-02 3 1  ON 10
ci_0012                -1.939832e-02 3 1  ON 11
ci_0013                 1.948798e-02 3 1  ON 12
ci_0014                 1.912524e-02 3 1  ON 13
ci_0015                 1.972505e-02 3 1  ON 14
ci_0016                 1.947614e-02 3 1  ON 15
ci_0017                 1.747308e-02 3 1  ON 16
ci_0018                 1.732804e-02 3 1  ON 17
ci_0019                 1.495885e-02 3 1  ON 18
ci_0020                 1.475327e-02 3 1  ON 19
ci_0021                 1.779441e-02 3 1  ON 20
ci_0022                 1.811461e-02 3 1  ON 21
ci_0023                -1.405650e-02 3 1  ON 22
ci_0024                -1.368838e-02 3 1  ON 23
ci_0025                -7.965370e-03 3 1  ON 24
ci_0026                -7.159754e-03 3 1  ON 25
ci_0027                -1.358878e-02 3 1  ON 26
ci_0028                -1.339689e-02 3 1  ON 27
ci_0029                -1.182838e-02 3 1  ON 28
ci_0030                -1.209584e-02 3 1  ON 29
ci_0031                 1.515750e-02 3 1  ON 30
ci_0032                 1.487890e-02 3 1  ON 31
ci_0033                 1.130684e-02 3 1  ON 32
ci_0034                 1.146357e-02 3 1  ON 33
ci_0035                 7.731653e-03 3 1  ON 34
ci_0036                 7.908370e-03 3 1  ON 35
ci_0037                -1.283532e-02 3 1  ON 36
ci_0038                -1.250621e-02 3 1  ON 37
ci_0039                -7.188024e-03 3 1  ON 38
ci_0040                -7.295759e-03 3 1  ON 39
ci_0041                 1.155885e-02 3 1  ON 40
ci_0042                 1.146480e-02 3 1  ON 41
ci_0043                -9.409433e-03 3 1  ON 42
ci_0044                -9.733587e-03 3 1  ON 43
ci_0045                 1.168601e-02 3 1  ON 44
ci_0046                 1.142322e-02 3 1  ON 45
ci_0047                -6.588640e-03 3 1  ON 46
ci_0048                -6.854359e-03 3 1  ON 47
ci_0049                -5.213772e-03 3 1  ON 48
ci_0050                -5.120652e-03 3 1  ON 49
ci_0051                -4.729306e-03 3 1  ON 50
ci_0052                -4.832229e-03 3 1  ON 51
ci_0053                -6.125115e-03 3 1  ON 52
ci_0054                -6.391050e-03 3 1  ON 53
ci_0055                 5.315662e-03 3 1  ON 54
ci_0056                 4.746521e-03 3 1  ON 55
ci_0057                 4.982317e-03 3 1  ON 56
ci_0058                 5.975184e-03 3 1  ON 57
ci_0059                -5.899396e-03 3 1  ON 58
ci_0060                -6.115760e-03 3 1  ON 59
ci_0061                -6.145803e-03 3 1  ON 60
ci_0062                -6.113673e-03 3 1  ON 61
ci_0063                -1.020384e-02 3 1  ON 62
ci_0064                -1.006239e-02 3 1  ON 63
ci_0065                -8.366087e-03 3 1  ON 64
ci_0066                -8.112845e-03 3 1  ON 65
ci_0067                -6.032297e-03 3 1  ON 66
ci_0068                -6.181428e-03 3 1  ON 67
ci_0069                 5.554950e-03 3 1  ON 68
ci_0070                 5.364064e-03 3 1  ON 69
ci_0071                 6.493147e-03 3 1  ON 70
ci_0072                 6.396632e-03 3 1  ON 71
ci_0073                 5.076555e-03 3 1  ON 72
ci_0074                 5.386502e-03 3 1  ON 73
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 30
    time step          = 0.05
    reference energy   = -16.8769
    reference variance = 0.179293
====================================================
  Execution time = 1.4206e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s030
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6903e+01
  VMC Evar = 3.2186e-01
  Total weights = 1.9513e+06
  Execution time = 1.9172e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.309801897474
                                         uncertainty =       0.002081581008

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.309801897474
                                         uncertainty =       0.002081581008

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000393595873
  error estimate for blocks of size 2^( 2) =       0.000407658175
  error estimate for blocks of size 2^( 3) =       0.000421775715
  error estimate for blocks of size 2^( 4) =       0.000435227554
  error estimate for blocks of size 2^( 5) =       0.000445234706
  error estimate for blocks of size 2^( 6) =       0.000452267764
  error estimate for blocks of size 2^( 7) =       0.000455567678

      target function =      -0.864187881681
              le_mean =     -16.902826985159
             les_mean =     286.038160439510
             stat err =       0.000447074425
             autocorr =       1.290204591738
   target nu stat err =       0.000447074425
   target dn stat err =       0.009221367069
      target stat err =       0.011061106091
              std dev =       0.556628620994
             le_variance =       0.309835421710

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.306125745283
                                         uncertainty =       0.001858354858

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.306125745283
                                         uncertainty =       0.001858354858

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000391252178
  error estimate for blocks of size 2^( 2) =       0.000405422722
  error estimate for blocks of size 2^( 3) =       0.000419664653
  error estimate for blocks of size 2^( 4) =       0.000433232266
  error estimate for blocks of size 2^( 5) =       0.000443368835
  error estimate for blocks of size 2^( 6) =       0.000450478171
  error estimate for blocks of size 2^( 7) =       0.000453792781

      target function =      -0.862458349104
              le_mean =     -16.902831929296
             les_mean =     286.039627931366
             stat err =       0.000445218013
             autocorr =       1.294887142168
   target nu stat err =       0.000445218013
   target dn stat err =       0.013852602473
      target stat err =       0.016538850451
              std dev =       0.553314136246
             le_variance =       0.306156533370

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.307256841278
                                         uncertainty =       0.001918247506

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.307256841278
                                         uncertainty =       0.001918247506

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000391975245
  error estimate for blocks of size 2^( 2) =       0.000406103783
  error estimate for blocks of size 2^( 3) =       0.000420303635
  error estimate for blocks of size 2^( 4) =       0.000433831212
  error estimate for blocks of size 2^( 5) =       0.000443909248
  error estimate for blocks of size 2^( 6) =       0.000450992606
  error estimate for blocks of size 2^( 7) =       0.000454305908

      target function =      -0.878789052965
              le_mean =     -16.902811064778
             les_mean =     286.025728774247
             stat err =       0.000445759744
             autocorr =       1.293255724001
   target nu stat err =       0.000445759744
   target dn stat err =       0.003613815242
      target stat err =       0.004518617296
              std dev =       0.554336707645
             le_variance =       0.307289185442

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.309431630394
                                         uncertainty =       0.002053879598

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.309431630394
                                         uncertainty =       0.002053879598

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000393360519
  error estimate for blocks of size 2^( 2) =       0.000407433934
  error estimate for blocks of size 2^( 3) =       0.000421564773
  error estimate for blocks of size 2^( 4) =       0.000435029168
  error estimate for blocks of size 2^( 5) =       0.000445050907
  error estimate for blocks of size 2^( 6) =       0.000452081230
  error estimate for blocks of size 2^( 7) =       0.000455375099

      target function =      -0.849707025290
              le_mean =     -16.902817674661
             les_mean =     286.049644210470
             stat err =       0.000446884101
             autocorr =       1.290649361968
   target nu stat err =       0.000446884101
   target dn stat err =       0.021302307297
      target stat err =       0.024688251746
              std dev =       0.556295780681
             le_variance =       0.309464995603


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.864187881681        initial
     2.4414e-01     2.4414e+00             1.6974e-03        -0.862458349104
     9.7656e-01     9.7656e+00             5.0984e-04        -0.878789052965  <--
     3.9062e+00     3.9062e+01             1.3446e-04        -0.849707025290

*****************************************************************************
Applying the update for shift_i =   9.7656e-01     and shift_s =   9.7656e+00
*****************************************************************************

  Execution time = 2.3875e+01
  </log>
  <optVariables href="H2O.s030.opt.xml">
ci_0001                 6.999972e-01 3 1  ON 0
ci_0002                 6.969989e-01 3 1  ON 1
ci_0003                -3.743445e-02 3 1  ON 2
ci_0004                -3.754930e-02 3 1  ON 3
ci_0005                -3.522511e-02 3 1  ON 4
ci_0006                -3.563380e-02 3 1  ON 5
ci_0007                -2.406825e-02 3 1  ON 6
ci_0008                -2.422730e-02 3 1  ON 7
ci_0009                -2.327350e-02 3 1  ON 8
ci_0010                -2.334585e-02 3 1  ON 9
ci_0011                -1.949673e-02 3 1  ON 10
ci_0012                -1.939832e-02 3 1  ON 11
ci_0013                 1.948798e-02 3 1  ON 12
ci_0014                 1.912524e-02 3 1  ON 13
ci_0015                 1.972505e-02 3 1  ON 14
ci_0016                 1.947614e-02 3 1  ON 15
ci_0017                 1.747308e-02 3 1  ON 16
ci_0018                 1.732804e-02 3 1  ON 17
ci_0019                 1.495885e-02 3 1  ON 18
ci_0020                 1.475327e-02 3 1  ON 19
ci_0021                 1.779441e-02 3 1  ON 20
ci_0022                 1.811461e-02 3 1  ON 21
ci_0023                -1.405650e-02 3 1  ON 22
ci_0024                -1.368838e-02 3 1  ON 23
ci_0025                -7.965370e-03 3 1  ON 24
ci_0026                -7.159754e-03 3 1  ON 25
ci_0027                -1.358878e-02 3 1  ON 26
ci_0028                -1.339689e-02 3 1  ON 27
ci_0029                -1.182838e-02 3 1  ON 28
ci_0030                -1.209584e-02 3 1  ON 29
ci_0031                 1.515750e-02 3 1  ON 30
ci_0032                 1.487890e-02 3 1  ON 31
ci_0033                 1.130684e-02 3 1  ON 32
ci_0034                 1.146357e-02 3 1  ON 33
ci_0035                 7.731653e-03 3 1  ON 34
ci_0036                 7.908370e-03 3 1  ON 35
ci_0037                -1.283532e-02 3 1  ON 36
ci_0038                -1.250621e-02 3 1  ON 37
ci_0039                -7.188024e-03 3 1  ON 38
ci_0040                -7.295759e-03 3 1  ON 39
ci_0041                 1.155885e-02 3 1  ON 40
ci_0042                 1.146480e-02 3 1  ON 41
ci_0043                -9.409433e-03 3 1  ON 42
ci_0044                -9.733587e-03 3 1  ON 43
ci_0045                 1.168601e-02 3 1  ON 44
ci_0046                 1.142322e-02 3 1  ON 45
ci_0047                -6.588640e-03 3 1  ON 46
ci_0048                -6.854359e-03 3 1  ON 47
ci_0049                -5.213772e-03 3 1  ON 48
ci_0050                -5.120652e-03 3 1  ON 49
ci_0051                -4.729306e-03 3 1  ON 50
ci_0052                -4.832229e-03 3 1  ON 51
ci_0053                -6.125115e-03 3 1  ON 52
ci_0054                -6.391050e-03 3 1  ON 53
ci_0055                 5.315662e-03 3 1  ON 54
ci_0056                 4.746521e-03 3 1  ON 55
ci_0057                 4.982317e-03 3 1  ON 56
ci_0058                 5.975184e-03 3 1  ON 57
ci_0059                -5.899396e-03 3 1  ON 58
ci_0060                -6.115760e-03 3 1  ON 59
ci_0061                -6.145803e-03 3 1  ON 60
ci_0062                -6.113673e-03 3 1  ON 61
ci_0063                -1.020384e-02 3 1  ON 62
ci_0064                -1.006239e-02 3 1  ON 63
ci_0065                -8.366087e-03 3 1  ON 64
ci_0066                -8.112845e-03 3 1  ON 65
ci_0067                -6.032297e-03 3 1  ON 66
ci_0068                -6.181428e-03 3 1  ON 67
ci_0069                 5.554950e-03 3 1  ON 68
ci_0070                 5.364064e-03 3 1  ON 69
ci_0071                 6.493147e-03 3 1  ON 70
ci_0072                 6.396632e-03 3 1  ON 71
ci_0073                 5.076555e-03 3 1  ON 72
ci_0074                 5.386502e-03 3 1  ON 73
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 4.1091e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s031 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s031 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=31  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6895e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 31
    time step          = 0.05
    reference energy   = -16.847
    reference variance = 0.151406
====================================================
  Execution time = 1.6689e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s031
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5277e+04
  VMC Eavg = -1.6903e+01
  VMC Evar = 3.2476e-01
  Total weights = 1.951445723e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 2.5789e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.312170495246
                                         uncertainty =       0.001707325719

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.312170495246
                                         uncertainty =       0.001707325719

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000395045223
  error estimate for blocks of size 2^( 2) =       0.000409298770
  error estimate for blocks of size 2^( 3) =       0.000423962324
  error estimate for blocks of size 2^( 4) =       0.000437461130
  error estimate for blocks of size 2^( 5) =       0.000448863832
  error estimate for blocks of size 2^( 6) =       0.000457592468
  error estimate for blocks of size 2^( 7) =       0.000464019364

      target function =      -0.873891690411
              le_mean =     -16.903456038991
             les_mean =     286.051586499668
             stat err =       0.000451984199
             autocorr =       1.309039875341
   target nu stat err =       0.000451984199
   target dn stat err =       0.002432638727
      target stat err =       0.003048388345
              std dev =       0.558678311685
             le_variance =       0.312121455947


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690345603899e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 74
Check correct_vf_var_size: 225, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.4414e-01, overlap shift 2.4414e+00 and omega -1.7527e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.873901216828       residual = 1.18e-01           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.875462762659       residual = 2.45e-02           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.875812544953       residual = 5.67e-03           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.875936428866       residual = 1.48e-03           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.875975320201       residual = 6.83e-04           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.875991091924       residual = 4.37e-04           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.875997424087       residual = 1.42e-04           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.876000120563       residual = 3.76e-05           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.876001362876       residual = 1.35e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.876001521025       residual = 6.01e-06           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.876001765998       residual = 3.88e-06           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.876001961188       residual = 2.43e-06           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.876001898518       residual = 3.65e-06           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.876002023755       residual = 2.69e-06           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.876002317097       residual = 1.03e-06           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.876002310496       residual = 1.72e-07           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.876002281890       residual = 7.53e-08           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.876002259116       residual = 2.21e-08           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.876002270696       residual = 7.42e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         18 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 2.4414e-01 is 1.748562e-03

solving harmonic davidson linear method for identity shift 9.7656e-01, overlap shift 9.7656e+00 and omega -1.7527e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.873901216828       residual = 1.18e-01           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.874372877539       residual = 2.35e-02           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.874474834207       residual = 5.27e-03           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.874509087105       residual = 1.31e-03           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.874519483694       residual = 5.82e-04           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.874523333549       residual = 3.39e-04           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.874524802480       residual = 1.06e-04           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.874525384249       residual = 2.66e-05           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.874525659869       residual = 9.19e-06           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.874525684707       residual = 4.30e-06           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.874525737634       residual = 2.77e-06           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.874525785172       residual = 1.90e-06           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.874525768951       residual = 2.50e-06           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.874525798336       residual = 1.39e-06           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.874525850157       residual = 3.74e-07           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.874525845693       residual = 6.28e-08           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.874525838778       residual = 2.71e-08           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.874525835479       residual = 7.08e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         17 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 9.7656e-01 is 4.827210e-04

solving harmonic davidson linear method for identity shift 3.9062e+00, overlap shift 3.9062e+01 and omega -1.7527e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.873901216828       residual = 1.18e-01           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.874025593643       residual = 2.33e-02           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.874052171509       residual = 5.15e-03           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.874060950792       residual = 1.26e-03           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.874063587760       residual = 5.52e-04           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.874064535857       residual = 3.13e-04           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.874064892153       residual = 9.65e-05           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.874065030014       residual = 2.39e-05           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.874065096254       residual = 8.16e-06           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.874065101415       residual = 3.88e-06           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.874065114070       residual = 2.51e-06           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.874065125855       residual = 1.76e-06           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.874065121787       residual = 2.19e-06           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.874065128858       residual = 1.11e-06           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.874065140390       residual = 2.73e-07           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.874065139188       residual = 4.66e-08           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.874065137518       residual = 1.98e-08           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.874065136842       residual = 4.99e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         17 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 3.9062e+00 is 1.242804e-04

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.524066 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 75 and numParams is: 74

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.9284e+01
  </log>
  <optVariables href="H2O.s031.opt.xml">
ci_0001                 6.999992e-01 3 1  ON 0
ci_0002                 6.972946e-01 3 1  ON 1
ci_0003                -3.702324e-02 3 1  ON 2
ci_0004                -3.707316e-02 3 1  ON 3
ci_0005                -3.485747e-02 3 1  ON 4
ci_0006                -3.524283e-02 3 1  ON 5
ci_0007                -2.358553e-02 3 1  ON 6
ci_0008                -2.379042e-02 3 1  ON 7
ci_0009                -2.299911e-02 3 1  ON 8
ci_0010                -2.312400e-02 3 1  ON 9
ci_0011                -1.923582e-02 3 1  ON 10
ci_0012                -1.915041e-02 3 1  ON 11
ci_0013                 1.921839e-02 3 1  ON 12
ci_0014                 1.888407e-02 3 1  ON 13
ci_0015                 1.951091e-02 3 1  ON 14
ci_0016                 1.923686e-02 3 1  ON 15
ci_0017                 1.719717e-02 3 1  ON 16
ci_0018                 1.713125e-02 3 1  ON 17
ci_0019                 1.475638e-02 3 1  ON 18
ci_0020                 1.460436e-02 3 1  ON 19
ci_0021                 1.759586e-02 3 1  ON 20
ci_0022                 1.820058e-02 3 1  ON 21
ci_0023                -1.389581e-02 3 1  ON 22
ci_0024                -1.356105e-02 3 1  ON 23
ci_0025                -7.642542e-03 3 1  ON 24
ci_0026                -6.830086e-03 3 1  ON 25
ci_0027                -1.344484e-02 3 1  ON 26
ci_0028                -1.327519e-02 3 1  ON 27
ci_0029                -1.167456e-02 3 1  ON 28
ci_0030                -1.198197e-02 3 1  ON 29
ci_0031                 1.498538e-02 3 1  ON 30
ci_0032                 1.478863e-02 3 1  ON 31
ci_0033                 1.116863e-02 3 1  ON 32
ci_0034                 1.124745e-02 3 1  ON 33
ci_0035                 7.524901e-03 3 1  ON 34
ci_0036                 7.725083e-03 3 1  ON 35
ci_0037                -1.269946e-02 3 1  ON 36
ci_0038                -1.243800e-02 3 1  ON 37
ci_0039                -6.960095e-03 3 1  ON 38
ci_0040                -7.021196e-03 3 1  ON 39
ci_0041                 1.142977e-02 3 1  ON 40
ci_0042                 1.138205e-02 3 1  ON 41
ci_0043                -9.077124e-03 3 1  ON 42
ci_0044                -9.698255e-03 3 1  ON 43
ci_0045                 1.155722e-02 3 1  ON 44
ci_0046                 1.122965e-02 3 1  ON 45
ci_0047                -6.386180e-03 3 1  ON 46
ci_0048                -6.602542e-03 3 1  ON 47
ci_0049                -4.991078e-03 3 1  ON 48
ci_0050                -4.881498e-03 3 1  ON 49
ci_0051                -4.503161e-03 3 1  ON 50
ci_0052                -4.599395e-03 3 1  ON 51
ci_0053                -6.015477e-03 3 1  ON 52
ci_0054                -6.095399e-03 3 1  ON 53
ci_0055                 5.151761e-03 3 1  ON 54
ci_0056                 4.607327e-03 3 1  ON 55
ci_0057                 4.775401e-03 3 1  ON 56
ci_0058                 5.734878e-03 3 1  ON 57
ci_0059                -5.750567e-03 3 1  ON 58
ci_0060                -5.952967e-03 3 1  ON 59
ci_0061                -5.998347e-03 3 1  ON 60
ci_0062                -5.900190e-03 3 1  ON 61
ci_0063                -1.016841e-02 3 1  ON 62
ci_0064                -9.964708e-03 3 1  ON 63
ci_0065                -8.266274e-03 3 1  ON 64
ci_0066                -8.026371e-03 3 1  ON 65
ci_0067                -5.916137e-03 3 1  ON 66
ci_0068                -6.007952e-03 3 1  ON 67
ci_0069                 5.412325e-03 3 1  ON 68
ci_0070                 5.285737e-03 3 1  ON 69
ci_0071                 6.334852e-03 3 1  ON 70
ci_0072                 6.260156e-03 3 1  ON 71
ci_0073                 4.980217e-03 3 1  ON 72
ci_0074                 5.313504e-03 3 1  ON 73
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 31
    time step          = 0.05
    reference energy   = -16.8972
    reference variance = 0.346893
====================================================
  Execution time = 1.4263e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s031
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6903e+01
  VMC Evar = 3.3626e-01
  Total weights = 1.9514e+06
  Execution time = 1.9159e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.315738439679
                                         uncertainty =       0.002281291744

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.315738439679
                                         uncertainty =       0.002281291744

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000397355665
  error estimate for blocks of size 2^( 2) =       0.000410694204
  error estimate for blocks of size 2^( 3) =       0.000424400568
  error estimate for blocks of size 2^( 4) =       0.000437515064
  error estimate for blocks of size 2^( 5) =       0.000448037185
  error estimate for blocks of size 2^( 6) =       0.000454998881
  error estimate for blocks of size 2^( 7) =       0.000459742339

      target function =      -0.858536170805
              le_mean =     -16.903475695689
             les_mean =     286.064920228923
             stat err =       0.000450073368
             autocorr =       1.282944331338
   target nu stat err =       0.000450073368
   target dn stat err =       0.008214399448
      target stat err =       0.009739050930
              std dev =       0.561945770268
             le_variance =       0.315783048723

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.312870138911
                                         uncertainty =       0.002315905987

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.312870138911
                                         uncertainty =       0.002315905987

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000395549170
  error estimate for blocks of size 2^( 2) =       0.000408974780
  error estimate for blocks of size 2^( 3) =       0.000422771245
  error estimate for blocks of size 2^( 4) =       0.000436013362
  error estimate for blocks of size 2^( 5) =       0.000446614393
  error estimate for blocks of size 2^( 6) =       0.000453693448
  error estimate for blocks of size 2^( 7) =       0.000458353786

      target function =      -0.858167959460
              le_mean =     -16.903517642548
             les_mean =     286.066599142053
             stat err =       0.000448668747
             autocorr =       1.286621142339
   target nu stat err =       0.000448668747
   target dn stat err =       0.010333183460
      target stat err =       0.012233097256
              std dev =       0.559391000494
             le_variance =       0.312918291433

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.313836887685
                                         uncertainty =       0.002280940045

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.313836887685
                                         uncertainty =       0.002280940045

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000396158837
  error estimate for blocks of size 2^( 2) =       0.000409548066
  error estimate for blocks of size 2^( 3) =       0.000423304790
  error estimate for blocks of size 2^( 4) =       0.000436494823
  error estimate for blocks of size 2^( 5) =       0.000447066031
  error estimate for blocks of size 2^( 6) =       0.000454096327
  error estimate for blocks of size 2^( 7) =       0.000458787162

      target function =      -0.860039923408
              le_mean =     -16.903481429789
             les_mean =     286.063825132639
             stat err =       0.000449111086
             autocorr =       1.285194485250
   target nu stat err =       0.000449111086
   target dn stat err =       0.009072378400
      target stat err =       0.010790313228
              std dev =       0.560253200659
             le_variance =       0.313883648848

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.315460701322
                                         uncertainty =       0.002279359533

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.315460701322
                                         uncertainty =       0.002279359533

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000397181067
  error estimate for blocks of size 2^( 2) =       0.000410525888
  error estimate for blocks of size 2^( 3) =       0.000424238566
  error estimate for blocks of size 2^( 4) =       0.000437362907
  error estimate for blocks of size 2^( 5) =       0.000447891655
  error estimate for blocks of size 2^( 6) =       0.000454862355
  error estimate for blocks of size 2^( 7) =       0.000459598884

      target function =      -0.858473793901
              le_mean =     -16.903473255108
             les_mean =     286.064887980417
             stat err =       0.000449928950
             autocorr =       1.283248605954
   target nu stat err =       0.000449928950
   target dn stat err =       0.008314762098
      target stat err =       0.009856111952
              std dev =       0.561698851182
             le_variance =       0.315505599419


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.858536170805        initial
     2.4414e-01     2.4414e+00             1.7486e-03        -0.858167959460
     9.7656e-01     9.7656e+00             4.8272e-04        -0.860039923408  <--
     3.9062e+00     3.9062e+01             1.2428e-04        -0.858473793901

*****************************************************************************
Applying the update for shift_i =   9.7656e-01     and shift_s =   9.7656e+00
*****************************************************************************

  Execution time = 2.3927e+01
  </log>
  <optVariables href="H2O.s031.opt.xml">
ci_0001                 6.999992e-01 3 1  ON 0
ci_0002                 6.972946e-01 3 1  ON 1
ci_0003                -3.702324e-02 3 1  ON 2
ci_0004                -3.707316e-02 3 1  ON 3
ci_0005                -3.485747e-02 3 1  ON 4
ci_0006                -3.524283e-02 3 1  ON 5
ci_0007                -2.358553e-02 3 1  ON 6
ci_0008                -2.379042e-02 3 1  ON 7
ci_0009                -2.299911e-02 3 1  ON 8
ci_0010                -2.312400e-02 3 1  ON 9
ci_0011                -1.923582e-02 3 1  ON 10
ci_0012                -1.915041e-02 3 1  ON 11
ci_0013                 1.921839e-02 3 1  ON 12
ci_0014                 1.888407e-02 3 1  ON 13
ci_0015                 1.951091e-02 3 1  ON 14
ci_0016                 1.923686e-02 3 1  ON 15
ci_0017                 1.719717e-02 3 1  ON 16
ci_0018                 1.713125e-02 3 1  ON 17
ci_0019                 1.475638e-02 3 1  ON 18
ci_0020                 1.460436e-02 3 1  ON 19
ci_0021                 1.759586e-02 3 1  ON 20
ci_0022                 1.820058e-02 3 1  ON 21
ci_0023                -1.389581e-02 3 1  ON 22
ci_0024                -1.356105e-02 3 1  ON 23
ci_0025                -7.642542e-03 3 1  ON 24
ci_0026                -6.830086e-03 3 1  ON 25
ci_0027                -1.344484e-02 3 1  ON 26
ci_0028                -1.327519e-02 3 1  ON 27
ci_0029                -1.167456e-02 3 1  ON 28
ci_0030                -1.198197e-02 3 1  ON 29
ci_0031                 1.498538e-02 3 1  ON 30
ci_0032                 1.478863e-02 3 1  ON 31
ci_0033                 1.116863e-02 3 1  ON 32
ci_0034                 1.124745e-02 3 1  ON 33
ci_0035                 7.524901e-03 3 1  ON 34
ci_0036                 7.725083e-03 3 1  ON 35
ci_0037                -1.269946e-02 3 1  ON 36
ci_0038                -1.243800e-02 3 1  ON 37
ci_0039                -6.960095e-03 3 1  ON 38
ci_0040                -7.021196e-03 3 1  ON 39
ci_0041                 1.142977e-02 3 1  ON 40
ci_0042                 1.138205e-02 3 1  ON 41
ci_0043                -9.077124e-03 3 1  ON 42
ci_0044                -9.698255e-03 3 1  ON 43
ci_0045                 1.155722e-02 3 1  ON 44
ci_0046                 1.122965e-02 3 1  ON 45
ci_0047                -6.386180e-03 3 1  ON 46
ci_0048                -6.602542e-03 3 1  ON 47
ci_0049                -4.991078e-03 3 1  ON 48
ci_0050                -4.881498e-03 3 1  ON 49
ci_0051                -4.503161e-03 3 1  ON 50
ci_0052                -4.599395e-03 3 1  ON 51
ci_0053                -6.015477e-03 3 1  ON 52
ci_0054                -6.095399e-03 3 1  ON 53
ci_0055                 5.151761e-03 3 1  ON 54
ci_0056                 4.607327e-03 3 1  ON 55
ci_0057                 4.775401e-03 3 1  ON 56
ci_0058                 5.734878e-03 3 1  ON 57
ci_0059                -5.750567e-03 3 1  ON 58
ci_0060                -5.952967e-03 3 1  ON 59
ci_0061                -5.998347e-03 3 1  ON 60
ci_0062                -5.900190e-03 3 1  ON 61
ci_0063                -1.016841e-02 3 1  ON 62
ci_0064                -9.964708e-03 3 1  ON 63
ci_0065                -8.266274e-03 3 1  ON 64
ci_0066                -8.026371e-03 3 1  ON 65
ci_0067                -5.916137e-03 3 1  ON 66
ci_0068                -6.007952e-03 3 1  ON 67
ci_0069                 5.412325e-03 3 1  ON 68
ci_0070                 5.285737e-03 3 1  ON 69
ci_0071                 6.334852e-03 3 1  ON 70
ci_0072                 6.260156e-03 3 1  ON 71
ci_0073                 4.980217e-03 3 1  ON 72
ci_0074                 5.313504e-03 3 1  ON 73
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 4.3216e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s032 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s032 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=32  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6894e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 32
    time step          = 0.05
    reference energy   = -16.8396
    reference variance = 0.342196
====================================================
  Execution time = 1.4333e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s032
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5252e+04
  VMC Eavg = -1.6905e+01
  VMC Evar = 3.2553e-01
  Total weights = 1.951348161e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 2.5867e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.313149595067
                                         uncertainty =       0.002525063203

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.313149595067
                                         uncertainty =       0.002525063203

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000395703352
  error estimate for blocks of size 2^( 2) =       0.000409588448
  error estimate for blocks of size 2^( 3) =       0.000423532378
  error estimate for blocks of size 2^( 4) =       0.000435895181
  error estimate for blocks of size 2^( 5) =       0.000446260190
  error estimate for blocks of size 2^( 6) =       0.000455198219
  error estimate for blocks of size 2^( 7) =       0.000459089028

      target function =      -0.873114688409
              le_mean =     -16.904894829482
             les_mean =     286.101002724351
             stat err =       0.000449110654
             autocorr =       1.288152429976
   target nu stat err =       0.000449110654
   target dn stat err =       0.002975819058
      target stat err =       0.003703613267
              std dev =       0.559609047392
             le_variance =       0.313162285922


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690489482948e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 74
Check correct_vf_var_size: 225, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.4414e-01, overlap shift 2.4414e+00 and omega -1.7527e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.873129538669       residual = 1.23e-01           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.874898768092       residual = 2.18e-02           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.875204112215       residual = 5.19e-03           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.875299264038       residual = 1.52e-03           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.875335252853       residual = 5.89e-04           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.875352881186       residual = 2.92e-04           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.875358528188       residual = 1.04e-04           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.875359066597       residual = 6.26e-05           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.875360586460       residual = 3.24e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.875360621429       residual = 2.16e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.875361925930       residual = 2.39e-05           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.875362919334       residual = 1.51e-05           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.875363934668       residual = 1.49e-05           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.875364518721       residual = 5.84e-06           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.875364927472       residual = 1.92e-06           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.875364999430       residual = 3.04e-07           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.875365012360       residual = 4.70e-08           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.875365036632       residual = 2.12e-08           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.875365034273       residual = 3.96e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         18 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 2.4414e-01 is 1.841566e-03

solving harmonic davidson linear method for identity shift 9.7656e-01, overlap shift 9.7656e+00 and omega -1.7527e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.873129538669       residual = 1.23e-01           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.873663009551       residual = 2.11e-02           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.873752000459       residual = 4.79e-03           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.873778225967       residual = 1.34e-03           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.873787848251       residual = 5.07e-04           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.873792263561       residual = 2.31e-04           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.873793551389       residual = 7.68e-05           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.873793646151       residual = 4.75e-05           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.873794003559       residual = 2.48e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.873793991467       residual = 1.78e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.873794342698       residual = 1.73e-05           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.873794567357       residual = 9.99e-06           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.873794775360       residual = 8.14e-06           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.873794864814       residual = 2.36e-06           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.873794925820       residual = 6.58e-07           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.873794931901       residual = 9.45e-08           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.873794934110       residual = 1.63e-08           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.873794938282       residual = 7.13e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         17 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 9.7656e-01 is 4.815000e-04

solving harmonic davidson linear method for identity shift 3.9062e+00, overlap shift 3.9062e+01 and omega -1.7527e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.873129538669       residual = 1.23e-01           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.873270135787       residual = 2.08e-02           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.873293332867       residual = 4.67e-03           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.873300047620       residual = 1.29e-03           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.873302488459       residual = 4.83e-04           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.873303585184       residual = 2.14e-04           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.873303895515       residual = 6.98e-05           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.873303916297       residual = 4.36e-05           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.873304003774       residual = 2.29e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.873303999392       residual = 1.67e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.873304088792       residual = 1.56e-05           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.873304142609       residual = 8.73e-06           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.873304190830       residual = 6.67e-06           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.873304209801       residual = 1.78e-06           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.873304222774       residual = 4.73e-07           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.873304223793       residual = 6.65e-08           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.873304224305       residual = 1.18e-08           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.873304225232       residual = 5.12e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         17 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 3.9062e+00 is 1.219912e-04

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.534776 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 75 and numParams is: 74

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.6936e+01
  </log>
  <optVariables href="H2O.s032.opt.xml">
ci_0001                 7.004807e-01 3 1  ON 0
ci_0002                 6.970978e-01 3 1  ON 1
ci_0003                -3.666479e-02 3 1  ON 2
ci_0004                -3.660632e-02 3 1  ON 3
ci_0005                -3.443101e-02 3 1  ON 4
ci_0006                -3.484477e-02 3 1  ON 5
ci_0007                -2.321311e-02 3 1  ON 6
ci_0008                -2.342646e-02 3 1  ON 7
ci_0009                -2.272238e-02 3 1  ON 8
ci_0010                -2.280417e-02 3 1  ON 9
ci_0011                -1.903008e-02 3 1  ON 10
ci_0012                -1.895183e-02 3 1  ON 11
ci_0013                 1.898508e-02 3 1  ON 12
ci_0014                 1.862410e-02 3 1  ON 13
ci_0015                 1.929814e-02 3 1  ON 14
ci_0016                 1.899876e-02 3 1  ON 15
ci_0017                 1.700269e-02 3 1  ON 16
ci_0018                 1.695973e-02 3 1  ON 17
ci_0019                 1.463725e-02 3 1  ON 18
ci_0020                 1.441213e-02 3 1  ON 19
ci_0021                 1.747461e-02 3 1  ON 20
ci_0022                 1.807602e-02 3 1  ON 21
ci_0023                -1.367407e-02 3 1  ON 22
ci_0024                -1.336285e-02 3 1  ON 23
ci_0025                -7.257141e-03 3 1  ON 24
ci_0026                -6.478705e-03 3 1  ON 25
ci_0027                -1.331736e-02 3 1  ON 26
ci_0028                -1.317360e-02 3 1  ON 27
ci_0029                -1.155407e-02 3 1  ON 28
ci_0030                -1.191454e-02 3 1  ON 29
ci_0031                 1.494963e-02 3 1  ON 30
ci_0032                 1.477740e-02 3 1  ON 31
ci_0033                 1.093993e-02 3 1  ON 32
ci_0034                 1.109837e-02 3 1  ON 33
ci_0035                 7.269922e-03 3 1  ON 34
ci_0036                 7.373366e-03 3 1  ON 35
ci_0037                -1.261514e-02 3 1  ON 36
ci_0038                -1.243277e-02 3 1  ON 37
ci_0039                -6.735598e-03 3 1  ON 38
ci_0040                -6.786898e-03 3 1  ON 39
ci_0041                 1.130887e-02 3 1  ON 40
ci_0042                 1.125950e-02 3 1  ON 41
ci_0043                -8.829244e-03 3 1  ON 42
ci_0044                -9.477583e-03 3 1  ON 43
ci_0045                 1.140938e-02 3 1  ON 44
ci_0046                 1.116828e-02 3 1  ON 45
ci_0047                -6.154109e-03 3 1  ON 46
ci_0048                -6.332210e-03 3 1  ON 47
ci_0049                -4.724067e-03 3 1  ON 48
ci_0050                -4.641915e-03 3 1  ON 49
ci_0051                -4.374709e-03 3 1  ON 50
ci_0052                -4.356003e-03 3 1  ON 51
ci_0053                -5.819520e-03 3 1  ON 52
ci_0054                -5.898421e-03 3 1  ON 53
ci_0055                 4.871706e-03 3 1  ON 54
ci_0056                 4.407423e-03 3 1  ON 55
ci_0057                 4.539943e-03 3 1  ON 56
ci_0058                 5.459038e-03 3 1  ON 57
ci_0059                -5.661354e-03 3 1  ON 58
ci_0060                -5.677910e-03 3 1  ON 59
ci_0061                -5.786586e-03 3 1  ON 60
ci_0062                -5.682417e-03 3 1  ON 61
ci_0063                -1.010955e-02 3 1  ON 62
ci_0064                -9.875127e-03 3 1  ON 63
ci_0065                -8.169754e-03 3 1  ON 64
ci_0066                -7.906342e-03 3 1  ON 65
ci_0067                -5.824386e-03 3 1  ON 66
ci_0068                -5.870926e-03 3 1  ON 67
ci_0069                 5.270987e-03 3 1  ON 68
ci_0070                 5.200044e-03 3 1  ON 69
ci_0071                 6.185744e-03 3 1  ON 70
ci_0072                 6.229491e-03 3 1  ON 71
ci_0073                 4.862883e-03 3 1  ON 72
ci_0074                 5.142572e-03 3 1  ON 73
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 32
    time step          = 0.05
    reference energy   = -16.9097
    reference variance = 0.463762
====================================================
  Execution time = 1.4253e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s032
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6903e+01
  VMC Evar = 3.2427e-01
  Total weights = 1.9512e+06
  Execution time = 1.9162e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

ERROR CostFunction-> Number of Effective Walkers is too small! 
  Number of effective walkers (samples) / total number of samples = 0.00426927
  User specified threshold minwalkers = 0.3
  If this message appears frequently. You might have to be cautious. 
  Find info about parameter "minwalkers" in the user manual!
Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.313183146359
                                         uncertainty =       0.002682061209

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.313183146359
                                         uncertainty =       0.002682061209

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000395727997
  error estimate for blocks of size 2^( 2) =       0.000409757288
  error estimate for blocks of size 2^( 3) =       0.000424529145
  error estimate for blocks of size 2^( 4) =       0.000437775658
  error estimate for blocks of size 2^( 5) =       0.000448814465
  error estimate for blocks of size 2^( 6) =       0.000457358340
  error estimate for blocks of size 2^( 7) =       0.000464185643

      target function =      -0.873089594203
              le_mean =     -16.902715008211
             les_mean =     286.027107606514
             stat err =       0.000452033527
             autocorr =       1.304811393479
   target nu stat err =       0.000452033527
   target dn stat err =       0.003346132247
      target stat err =       0.004137740537
              std dev =       0.559643900210
             le_variance =       0.313201295043

ERROR CostFunction-> Number of Effective Walkers is too small! 
  Number of effective walkers (samples) / total number of samples = 0.000328958
  User specified threshold minwalkers = 0.3
  If this message appears frequently. You might have to be cautious. 
  Find info about parameter "minwalkers" in the user manual!
Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.310517002476
                                         uncertainty =       0.002531202175

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.310517002476
                                         uncertainty =       0.002531202175

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000394038706
  error estimate for blocks of size 2^( 2) =       0.000408169146
  error estimate for blocks of size 2^( 3) =       0.000423036413
  error estimate for blocks of size 2^( 4) =       0.000436407011
  error estimate for blocks of size 2^( 5) =       0.000447510846
  error estimate for blocks of size 2^( 6) =       0.000456115525
  error estimate for blocks of size 2^( 7) =       0.000463029409

      target function =      -0.861202730192
              le_mean =     -16.902764333685
             les_mean =     286.038568672440
             stat err =       0.000450765698
             autocorr =       1.308651331549
   target nu stat err =       0.000450765698
   target dn stat err =       0.007987303044
      target stat err =       0.009518841798
              std dev =       0.557254881905
             le_variance =       0.310533003407

ERROR CostFunction-> Number of Effective Walkers is too small! 
  Number of effective walkers (samples) / total number of samples = 0.00431947
  User specified threshold minwalkers = 0.3
  If this message appears frequently. You might have to be cautious. 
  Find info about parameter "minwalkers" in the user manual!
Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.311432193907
                                         uncertainty =       0.002588062469

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.311432193907
                                         uncertainty =       0.002588062469

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000394619516
  error estimate for blocks of size 2^( 2) =       0.000408704678
  error estimate for blocks of size 2^( 3) =       0.000423533893
  error estimate for blocks of size 2^( 4) =       0.000436849362
  error estimate for blocks of size 2^( 5) =       0.000447928015
  error estimate for blocks of size 2^( 6) =       0.000456504873
  error estimate for blocks of size 2^( 7) =       0.000463376868

      target function =      -0.874566438129
              le_mean =     -16.902727850470
             les_mean =     286.026337262262
             stat err =       0.000451164779
             autocorr =       1.307113371262
   target nu stat err =       0.000451164779
   target dn stat err =       0.003268712650
      target stat err =       0.004057685382
              std dev =       0.558076272053
             le_variance =       0.311449125429

ERROR CostFunction-> Number of Effective Walkers is too small! 
  Number of effective walkers (samples) / total number of samples = 0.0125403
  User specified threshold minwalkers = 0.3
  If this message appears frequently. You might have to be cautious. 
  Find info about parameter "minwalkers" in the user manual!
Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.312928191201
                                         uncertainty =       0.002668609825

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.312928191201
                                         uncertainty =       0.002668609825

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000395566800
  error estimate for blocks of size 2^( 2) =       0.000409602925
  error estimate for blocks of size 2^( 3) =       0.000424382027
  error estimate for blocks of size 2^( 4) =       0.000437637327
  error estimate for blocks of size 2^( 5) =       0.000448681537
  error estimate for blocks of size 2^( 6) =       0.000457230219
  error estimate for blocks of size 2^( 7) =       0.000464063210

      target function =      -0.873525126174
              le_mean =     -16.902713503349
             les_mean =     286.026700564761
             stat err =       0.000451903073
             autocorr =       1.305121433151
   target nu stat err =       0.000451903073
   target dn stat err =       0.003322097643
      target stat err =       0.004112729686
              std dev =       0.559415933404
             le_variance =       0.312946186547


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.873089594203        initial
     2.4414e-01     2.4414e+00             1.8416e-03        -0.861202730192
     9.7656e-01     9.7656e+00             4.8150e-04        -0.874566438129  <--
     3.9062e+00     3.9062e+01             1.2199e-04        -0.873525126174

*****************************************************************************
Applying the update for shift_i =   9.7656e-01     and shift_s =   9.7656e+00
*****************************************************************************

  Execution time = 2.3924e+01
  </log>
  <optVariables href="H2O.s032.opt.xml">
ci_0001                 7.004807e-01 3 1  ON 0
ci_0002                 6.970978e-01 3 1  ON 1
ci_0003                -3.666479e-02 3 1  ON 2
ci_0004                -3.660632e-02 3 1  ON 3
ci_0005                -3.443101e-02 3 1  ON 4
ci_0006                -3.484477e-02 3 1  ON 5
ci_0007                -2.321311e-02 3 1  ON 6
ci_0008                -2.342646e-02 3 1  ON 7
ci_0009                -2.272238e-02 3 1  ON 8
ci_0010                -2.280417e-02 3 1  ON 9
ci_0011                -1.903008e-02 3 1  ON 10
ci_0012                -1.895183e-02 3 1  ON 11
ci_0013                 1.898508e-02 3 1  ON 12
ci_0014                 1.862410e-02 3 1  ON 13
ci_0015                 1.929814e-02 3 1  ON 14
ci_0016                 1.899876e-02 3 1  ON 15
ci_0017                 1.700269e-02 3 1  ON 16
ci_0018                 1.695973e-02 3 1  ON 17
ci_0019                 1.463725e-02 3 1  ON 18
ci_0020                 1.441213e-02 3 1  ON 19
ci_0021                 1.747461e-02 3 1  ON 20
ci_0022                 1.807602e-02 3 1  ON 21
ci_0023                -1.367407e-02 3 1  ON 22
ci_0024                -1.336285e-02 3 1  ON 23
ci_0025                -7.257141e-03 3 1  ON 24
ci_0026                -6.478705e-03 3 1  ON 25
ci_0027                -1.331736e-02 3 1  ON 26
ci_0028                -1.317360e-02 3 1  ON 27
ci_0029                -1.155407e-02 3 1  ON 28
ci_0030                -1.191454e-02 3 1  ON 29
ci_0031                 1.494963e-02 3 1  ON 30
ci_0032                 1.477740e-02 3 1  ON 31
ci_0033                 1.093993e-02 3 1  ON 32
ci_0034                 1.109837e-02 3 1  ON 33
ci_0035                 7.269922e-03 3 1  ON 34
ci_0036                 7.373366e-03 3 1  ON 35
ci_0037                -1.261514e-02 3 1  ON 36
ci_0038                -1.243277e-02 3 1  ON 37
ci_0039                -6.735598e-03 3 1  ON 38
ci_0040                -6.786898e-03 3 1  ON 39
ci_0041                 1.130887e-02 3 1  ON 40
ci_0042                 1.125950e-02 3 1  ON 41
ci_0043                -8.829244e-03 3 1  ON 42
ci_0044                -9.477583e-03 3 1  ON 43
ci_0045                 1.140938e-02 3 1  ON 44
ci_0046                 1.116828e-02 3 1  ON 45
ci_0047                -6.154109e-03 3 1  ON 46
ci_0048                -6.332210e-03 3 1  ON 47
ci_0049                -4.724067e-03 3 1  ON 48
ci_0050                -4.641915e-03 3 1  ON 49
ci_0051                -4.374709e-03 3 1  ON 50
ci_0052                -4.356003e-03 3 1  ON 51
ci_0053                -5.819520e-03 3 1  ON 52
ci_0054                -5.898421e-03 3 1  ON 53
ci_0055                 4.871706e-03 3 1  ON 54
ci_0056                 4.407423e-03 3 1  ON 55
ci_0057                 4.539943e-03 3 1  ON 56
ci_0058                 5.459038e-03 3 1  ON 57
ci_0059                -5.661354e-03 3 1  ON 58
ci_0060                -5.677910e-03 3 1  ON 59
ci_0061                -5.786586e-03 3 1  ON 60
ci_0062                -5.682417e-03 3 1  ON 61
ci_0063                -1.010955e-02 3 1  ON 62
ci_0064                -9.875127e-03 3 1  ON 63
ci_0065                -8.169754e-03 3 1  ON 64
ci_0066                -7.906342e-03 3 1  ON 65
ci_0067                -5.824386e-03 3 1  ON 66
ci_0068                -5.870926e-03 3 1  ON 67
ci_0069                 5.270987e-03 3 1  ON 68
ci_0070                 5.200044e-03 3 1  ON 69
ci_0071                 6.185744e-03 3 1  ON 70
ci_0072                 6.229491e-03 3 1  ON 71
ci_0073                 4.862883e-03 3 1  ON 72
ci_0074                 5.142572e-03 3 1  ON 73
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 4.0869e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s033 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s033 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=33  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6894e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 33
    time step          = 0.05
    reference energy   = -16.8837
    reference variance = 0.153709
====================================================
  Execution time = 1.4396e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s033
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5235e+04
  VMC Eavg = -1.6902e+01
  VMC Evar = 3.2279e-01
  Total weights = 1.951309653e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 2.5883e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.309778037551
                                         uncertainty =       0.002192712471

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.309778037551
                                         uncertainty =       0.002192712471

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000393545096
  error estimate for blocks of size 2^( 2) =       0.000407526267
  error estimate for blocks of size 2^( 3) =       0.000422369844
  error estimate for blocks of size 2^( 4) =       0.000435755370
  error estimate for blocks of size 2^( 5) =       0.000448383971
  error estimate for blocks of size 2^( 6) =       0.000458507664
  error estimate for blocks of size 2^( 7) =       0.000464673553

      target function =      -0.876149697065
              le_mean =     -16.902208952889
             les_mean =     286.007454468736
             stat err =       0.000451830139
             autocorr =       1.318139533396
   target nu stat err =       0.000451830139
   target dn stat err =       0.002950811615
      target stat err =       0.003683341807
              std dev =       0.556556811627
             le_variance =       0.309755484568


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690220895289e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 74
Check correct_vf_var_size: 225, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.4414e-01, overlap shift 2.4414e+00 and omega -1.7527e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.876163932434       residual = 1.37e-01           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.877984792571       residual = 1.99e-02           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.878269366156       residual = 5.57e-03           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.878361238052       residual = 1.45e-03           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.878397515455       residual = 5.78e-04           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.878411966864       residual = 2.97e-04           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.878417914110       residual = 9.26e-05           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.878418911315       residual = 4.30e-05           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.878418714181       residual = 1.30e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.878419009127       residual = 4.27e-06           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.878418910519       residual = 1.77e-06           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.878418887460       residual = 4.47e-07           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.878418819621       residual = 1.33e-07           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.878418832871       residual = 9.46e-08           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.878418827275       residual = 1.47e-07           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.878418848788       residual = 1.78e-07           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.878418872776       residual = 5.44e-08           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.878418894409       residual = 2.78e-08           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.878418895197       residual = 9.03e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         18 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 2.4414e-01 is 1.528483e-03

solving harmonic davidson linear method for identity shift 9.7656e-01, overlap shift 9.7656e+00 and omega -1.7527e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.876163932434       residual = 1.37e-01           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.876714263491       residual = 1.92e-02           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.876797125098       residual = 5.14e-03           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.876822344764       residual = 1.28e-03           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.876832150974       residual = 4.97e-04           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.876835690199       residual = 2.32e-04           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.876837107062       residual = 6.82e-05           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.876837294117       residual = 2.95e-05           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.876837214074       residual = 8.49e-06           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.876837275283       residual = 2.79e-06           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.876837249477       residual = 1.02e-06           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.876837243225       residual = 2.48e-07           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.876837227273       residual = 8.10e-08           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.876837231846       residual = 6.67e-08           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.876837231045       residual = 1.03e-07           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.876837236120       residual = 7.87e-08           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.876837240551       residual = 2.14e-08           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.876837244612       residual = 1.03e-08           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.876837244389       residual = 3.00e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         18 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 9.7656e-01 is 4.446046e-04

solving harmonic davidson linear method for identity shift 3.9062e+00, overlap shift 3.9062e+01 and omega -1.7527e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.876163932434       residual = 1.37e-01           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.876309081212       residual = 1.89e-02           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.876330673351       residual = 5.01e-03           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.876337121809       residual = 1.23e-03           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.876339617876       residual = 4.73e-04           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.876340490178       residual = 2.15e-04           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.876340837012       residual = 6.19e-05           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.876340878907       residual = 2.62e-05           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.876340856893       residual = 7.43e-06           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.876340871305       residual = 2.44e-06           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.876340864864       residual = 8.60e-07           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.876340863295       residual = 2.06e-07           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.876340859411       residual = 7.00e-08           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.876340860654       residual = 6.02e-08           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.876340860501       residual = 9.08e-08           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.876340861717       residual = 6.01e-08           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.876340862720       residual = 1.61e-08           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.876340863644       residual = 7.56e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         17 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 3.9062e+00 is 1.158595e-04

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.551708 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 75 and numParams is: 74

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.7009e+01
  </log>
  <optVariables href="H2O.s033.opt.xml">
ci_0001                 7.005931e-01 3 1  ON 0
ci_0002                 6.972615e-01 3 1  ON 1
ci_0003                -3.622018e-02 3 1  ON 2
ci_0004                -3.618458e-02 3 1  ON 3
ci_0005                -3.403662e-02 3 1  ON 4
ci_0006                -3.447483e-02 3 1  ON 5
ci_0007                -2.279225e-02 3 1  ON 6
ci_0008                -2.311977e-02 3 1  ON 7
ci_0009                -2.241130e-02 3 1  ON 8
ci_0010                -2.257310e-02 3 1  ON 9
ci_0011                -1.878425e-02 3 1  ON 10
ci_0012                -1.869762e-02 3 1  ON 11
ci_0013                 1.871789e-02 3 1  ON 12
ci_0014                 1.846912e-02 3 1  ON 13
ci_0015                 1.907539e-02 3 1  ON 14
ci_0016                 1.880180e-02 3 1  ON 15
ci_0017                 1.672955e-02 3 1  ON 16
ci_0018                 1.682514e-02 3 1  ON 17
ci_0019                 1.448408e-02 3 1  ON 18
ci_0020                 1.425212e-02 3 1  ON 19
ci_0021                 1.732011e-02 3 1  ON 20
ci_0022                 1.792219e-02 3 1  ON 21
ci_0023                -1.350274e-02 3 1  ON 22
ci_0024                -1.315343e-02 3 1  ON 23
ci_0025                -6.858653e-03 3 1  ON 24
ci_0026                -6.145454e-03 3 1  ON 25
ci_0027                -1.319893e-02 3 1  ON 26
ci_0028                -1.302577e-02 3 1  ON 27
ci_0029                -1.148893e-02 3 1  ON 28
ci_0030                -1.175895e-02 3 1  ON 29
ci_0031                 1.491026e-02 3 1  ON 30
ci_0032                 1.475239e-02 3 1  ON 31
ci_0033                 1.073567e-02 3 1  ON 32
ci_0034                 1.090848e-02 3 1  ON 33
ci_0035                 7.136709e-03 3 1  ON 34
ci_0036                 7.273499e-03 3 1  ON 35
ci_0037                -1.251508e-02 3 1  ON 36
ci_0038                -1.239550e-02 3 1  ON 37
ci_0039                -6.532959e-03 3 1  ON 38
ci_0040                -6.563321e-03 3 1  ON 39
ci_0041                 1.113756e-02 3 1  ON 40
ci_0042                 1.122898e-02 3 1  ON 41
ci_0043                -8.600257e-03 3 1  ON 42
ci_0044                -9.217453e-03 3 1  ON 43
ci_0045                 1.131458e-02 3 1  ON 44
ci_0046                 1.104307e-02 3 1  ON 45
ci_0047                -5.954739e-03 3 1  ON 46
ci_0048                -6.083093e-03 3 1  ON 47
ci_0049                -4.601977e-03 3 1  ON 48
ci_0050                -4.597247e-03 3 1  ON 49
ci_0051                -4.159316e-03 3 1  ON 50
ci_0052                -4.139518e-03 3 1  ON 51
ci_0053                -5.495282e-03 3 1  ON 52
ci_0054                -5.657006e-03 3 1  ON 53
ci_0055                 4.625578e-03 3 1  ON 54
ci_0056                 4.105885e-03 3 1  ON 55
ci_0057                 4.341657e-03 3 1  ON 56
ci_0058                 5.222041e-03 3 1  ON 57
ci_0059                -5.495098e-03 3 1  ON 58
ci_0060                -5.470582e-03 3 1  ON 59
ci_0061                -5.531186e-03 3 1  ON 60
ci_0062                -5.466806e-03 3 1  ON 61
ci_0063                -1.010586e-02 3 1  ON 62
ci_0064                -9.873324e-03 3 1  ON 63
ci_0065                -8.084490e-03 3 1  ON 64
ci_0066                -7.887250e-03 3 1  ON 65
ci_0067                -5.705137e-03 3 1  ON 66
ci_0068                -5.763457e-03 3 1  ON 67
ci_0069                 5.266724e-03 3 1  ON 68
ci_0070                 5.015310e-03 3 1  ON 69
ci_0071                 5.852112e-03 3 1  ON 70
ci_0072                 6.088097e-03 3 1  ON 71
ci_0073                 4.748227e-03 3 1  ON 72
ci_0074                 5.004548e-03 3 1  ON 73
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 33
    time step          = 0.05
    reference energy   = -16.991
    reference variance = 1.09428
====================================================
  Execution time = 1.4282e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s033
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6903e+01
  VMC Evar = 3.1753e-01
  Total weights = 1.9515e+06
  Execution time = 1.9401e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.307687978894
                                         uncertainty =       0.002181224679

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.307687978894
                                         uncertainty =       0.002181224679

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000392252886
  error estimate for blocks of size 2^( 2) =       0.000406235248
  error estimate for blocks of size 2^( 3) =       0.000421308882
  error estimate for blocks of size 2^( 4) =       0.000434434086
  error estimate for blocks of size 2^( 5) =       0.000446330212
  error estimate for blocks of size 2^( 6) =       0.000455079400
  error estimate for blocks of size 2^( 7) =       0.000458569887

      target function =      -0.879094249427
              le_mean =     -16.903487215008
             les_mean =     286.048421288159
             stat err =       0.000448603396
             autocorr =       1.307955051803
   target nu stat err =       0.000448603396
   target dn stat err =       0.002849159840
      target stat err =       0.003590416172
              std dev =       0.554729351124
             le_variance =       0.307724652998

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.305364487155
                                         uncertainty =       0.002191366955

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.305364487155
                                         uncertainty =       0.002191366955

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000390771139
  error estimate for blocks of size 2^( 2) =       0.000404879350
  error estimate for blocks of size 2^( 3) =       0.000420035540
  error estimate for blocks of size 2^( 4) =       0.000433270490
  error estimate for blocks of size 2^( 5) =       0.000445215088
  error estimate for blocks of size 2^( 6) =       0.000454112934
  error estimate for blocks of size 2^( 7) =       0.000457465483

      target function =      -0.882913258492
              le_mean =     -16.903516470182
             les_mean =     286.046350011682
             stat err =       0.000447515999
             autocorr =       1.311511700915
   target nu stat err =       0.000447515999
   target dn stat err =       0.002589456261
      target stat err =       0.003301634734
              std dev =       0.552633844859
             le_variance =       0.305404166484

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.306152855330
                                         uncertainty =       0.002185252942

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.306152855330
                                         uncertainty =       0.002185252942

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000391274396
  error estimate for blocks of size 2^( 2) =       0.000405329734
  error estimate for blocks of size 2^( 3) =       0.000420452948
  error estimate for blocks of size 2^( 4) =       0.000433643549
  error estimate for blocks of size 2^( 5) =       0.000445565421
  error estimate for blocks of size 2^( 6) =       0.000454407702
  error estimate for blocks of size 2^( 7) =       0.000457825239

      target function =      -0.881835111049
              le_mean =     -16.903486017503
             les_mean =     286.046178992574
             stat err =       0.000447860478
             autocorr =       1.310154822028
   target nu stat err =       0.000447860478
   target dn stat err =       0.002697216821
      target stat err =       0.003425748035
              std dev =       0.553345556841
             le_variance =       0.306191305276

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.307465085181
                                         uncertainty =       0.002180990167

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.307465085181
                                         uncertainty =       0.002180990167

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000392110952
  error estimate for blocks of size 2^( 2) =       0.000406102569
  error estimate for blocks of size 2^( 3) =       0.000421184225
  error estimate for blocks of size 2^( 4) =       0.000434320070
  error estimate for blocks of size 2^( 5) =       0.000446216711
  error estimate for blocks of size 2^( 6) =       0.000454975181
  error estimate for blocks of size 2^( 7) =       0.000458446995

      target function =      -0.876553667110
              le_mean =     -16.903482421743
             les_mean =     286.050294655912
             stat err =       0.000448489739
             autocorr =       1.308238955531
   target nu stat err =       0.000448489739
   target dn stat err =       0.004587760346
      target stat err =       0.005693119764
              std dev =       0.554528626412
             le_variance =       0.307501997511


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.879094249427        initial
     2.4414e-01     2.4414e+00             1.5285e-03        -0.882913258492  <--
     9.7656e-01     9.7656e+00             4.4460e-04        -0.881835111049
     3.9062e+00     3.9062e+01             1.1586e-04        -0.876553667110

*****************************************************************************
Applying the update for shift_i =   2.4414e-01     and shift_s =   2.4414e+00
*****************************************************************************

  Execution time = 2.4003e+01
  </log>
  <optVariables href="H2O.s033.opt.xml">
ci_0001                 7.008437e-01 3 1  ON 0
ci_0002                 6.976839e-01 3 1  ON 1
ci_0003                -3.513630e-02 3 1  ON 2
ci_0004                -3.515832e-02 3 1  ON 3
ci_0005                -3.303883e-02 3 1  ON 4
ci_0006                -3.354130e-02 3 1  ON 5
ci_0007                -2.169012e-02 3 1  ON 6
ci_0008                -2.232182e-02 3 1  ON 7
ci_0009                -2.167050e-02 3 1  ON 8
ci_0010                -2.202534e-02 3 1  ON 9
ci_0011                -1.819496e-02 3 1  ON 10
ci_0012                -1.808962e-02 3 1  ON 11
ci_0013                 1.807767e-02 3 1  ON 12
ci_0014                 1.810307e-02 3 1  ON 13
ci_0015                 1.854107e-02 3 1  ON 14
ci_0016                 1.832912e-02 3 1  ON 15
ci_0017                 1.607924e-02 3 1  ON 16
ci_0018                 1.650754e-02 3 1  ON 17
ci_0019                 1.412489e-02 3 1  ON 18
ci_0020                 1.387764e-02 3 1  ON 19
ci_0021                 1.690504e-02 3 1  ON 20
ci_0022                 1.750345e-02 3 1  ON 21
ci_0023                -1.309841e-02 3 1  ON 22
ci_0024                -1.265708e-02 3 1  ON 23
ci_0025                -5.938564e-03 3 1  ON 24
ci_0026                -5.378894e-03 3 1  ON 25
ci_0027                -1.292175e-02 3 1  ON 26
ci_0028                -1.267571e-02 3 1  ON 27
ci_0029                -1.134792e-02 3 1  ON 28
ci_0030                -1.139411e-02 3 1  ON 29
ci_0031                 1.480417e-02 3 1  ON 30
ci_0032                 1.468062e-02 3 1  ON 31
ci_0033                 1.021523e-02 3 1  ON 32
ci_0034                 1.043583e-02 3 1  ON 33
ci_0035                 6.829383e-03 3 1  ON 34
ci_0036                 7.044088e-03 3 1  ON 35
ci_0037                -1.226949e-02 3 1  ON 36
ci_0038                -1.230443e-02 3 1  ON 37
ci_0039                -6.060979e-03 3 1  ON 38
ci_0040                -6.043113e-03 3 1  ON 39
ci_0041                 1.072074e-02 3 1  ON 40
ci_0042                 1.115314e-02 3 1  ON 41
ci_0043                -8.015095e-03 3 1  ON 42
ci_0044                -8.549607e-03 3 1  ON 43
ci_0045                 1.108129e-02 3 1  ON 44
ci_0046                 1.073467e-02 3 1  ON 45
ci_0047                -5.489639e-03 3 1  ON 46
ci_0048                -5.502145e-03 3 1  ON 47
ci_0049                -4.325239e-03 3 1  ON 48
ci_0050                -4.496626e-03 3 1  ON 49
ci_0051                -3.668539e-03 3 1  ON 50
ci_0052                -3.645541e-03 3 1  ON 51
ci_0053                -4.750991e-03 3 1  ON 52
ci_0054                -5.104468e-03 3 1  ON 53
ci_0055                 4.061993e-03 3 1  ON 54
ci_0056                 3.418165e-03 3 1  ON 55
ci_0057                 3.883084e-03 3 1  ON 56
ci_0058                 4.670327e-03 3 1  ON 57
ci_0059                -5.112122e-03 3 1  ON 58
ci_0060                -4.994481e-03 3 1  ON 59
ci_0061                -4.918403e-03 3 1  ON 60
ci_0062                -4.950022e-03 3 1  ON 61
ci_0063                -1.009887e-02 3 1  ON 62
ci_0064                -9.871938e-03 3 1  ON 63
ci_0065                -7.878918e-03 3 1  ON 64
ci_0066                -7.842796e-03 3 1  ON 65
ci_0067                -5.430472e-03 3 1  ON 66
ci_0068                -5.515116e-03 3 1  ON 67
ci_0069                 5.253140e-03 3 1  ON 68
ci_0070                 4.592063e-03 3 1  ON 69
ci_0071                 5.084564e-03 3 1  ON 70
ci_0072                 5.758846e-03 3 1  ON 71
ci_0073                 4.483586e-03 3 1  ON 72
ci_0074                 4.689127e-03 3 1  ON 73
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 4.1027e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s034 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s034 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=34  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6895e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 34
    time step          = 0.05
    reference energy   = -16.9773
    reference variance = 0.293043
====================================================
  Execution time = 1.4380e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s034
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5240e+04
  VMC Eavg = -1.6904e+01
  VMC Evar = 3.1683e-01
  Total weights = 1.951574107e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 2.5857e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.307576715753
                                         uncertainty =       0.001738339794

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.307576715753
                                         uncertainty =       0.001738339794

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000392101308
  error estimate for blocks of size 2^( 2) =       0.000405879119
  error estimate for blocks of size 2^( 3) =       0.000420114335
  error estimate for blocks of size 2^( 4) =       0.000432999055
  error estimate for blocks of size 2^( 5) =       0.000444194549
  error estimate for blocks of size 2^( 6) =       0.000451784887
  error estimate for blocks of size 2^( 7) =       0.000458072419

      target function =      -0.883801712923
              le_mean =     -16.903992030230
             les_mean =     286.061774949016
             stat err =       0.000446762728
             autocorr =       1.298246870672
   target nu stat err =       0.000446762728
   target dn stat err =       0.002224542752
      target stat err =       0.002862420268
              std dev =       0.554514988228
             le_variance =       0.307486872170


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690399203023e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 74
Check correct_vf_var_size: 225, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 6.1035e-02, overlap shift 6.1035e-01 and omega -1.7527e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.883809876495       residual = 6.17e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.885829562721       residual = 1.39e-02           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.886264698663       residual = 3.71e-03           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.886425442658       residual = 1.11e-03           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.886480563152       residual = 6.80e-04           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.886503187665       residual = 4.03e-04           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.886527318844       residual = 1.29e-04           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.886531565108       residual = 4.09e-05           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.886533668812       residual = 1.61e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.886534523441       residual = 4.84e-06           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.886534179511       residual = 3.03e-06           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.886533758518       residual = 8.08e-07           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.886533800983       residual = 5.28e-07           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.886533791809       residual = 5.13e-07           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.886534168221       residual = 1.04e-06           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.886534254108       residual = 9.01e-07           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.886534416054       residual = 2.66e-07           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.886534489360       residual = 1.33e-07           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.886534396321       residual = 6.02e-08           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.886534419377       residual = 2.95e-08           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.886534452613       residual = 8.24e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         20 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 6.1035e-02 is 3.539948e-03

solving harmonic davidson linear method for identity shift 2.4414e-01, overlap shift 2.4414e+00 and omega -1.7527e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.883809876495       residual = 6.17e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.884666835588       residual = 1.30e-02           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.884840119405       residual = 3.24e-03           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.884897646792       residual = 8.74e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.884916671033       residual = 5.18e-04           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.884923285825       residual = 2.69e-04           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.884929654258       residual = 7.31e-05           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.884930470556       residual = 2.00e-05           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.884930872051       residual = 6.88e-06           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.884931027262       residual = 2.13e-06           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.884930922482       residual = 1.18e-06           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.884930814459       residual = 3.57e-07           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.884930827603       residual = 3.37e-07           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.884930852341       residual = 3.85e-07           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.884930974345       residual = 4.14e-07           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.884930946125       residual = 1.13e-07           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.884930965551       residual = 2.91e-08           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.884930968229       residual = 1.32e-08           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.884930953828       residual = 4.97e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         18 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 2.4414e-01 is 1.223729e-03

solving harmonic davidson linear method for identity shift 9.7656e-01, overlap shift 9.7656e+00 and omega -1.7527e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.883809876495       residual = 6.17e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.884069242176       residual = 1.25e-02           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.884119961130       residual = 3.01e-03           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.884135884633       residual = 7.75e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.884141065756       residual = 4.50e-04           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.884142703813       residual = 2.18e-04           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.884144223125       residual = 5.49e-05           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.884144383761       residual = 1.40e-05           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.884144465025       residual = 4.56e-06           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.884144496286       residual = 1.45e-06           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.884144470567       residual = 7.68e-07           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.884144444844       residual = 2.63e-07           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.884144449043       residual = 2.95e-07           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.884144459991       residual = 3.05e-07           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.884144486784       residual = 2.00e-07           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.884144477401       residual = 4.01e-08           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.884144480920       residual = 1.09e-08           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.884144480795       residual = 4.69e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         17 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 9.7656e-01 is 3.380208e-04

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.569700 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 75 and numParams is: 74

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.6991e+01
  </log>
  <optVariables href="H2O.s034.opt.xml">
ci_0001                 7.009672e-01 3 1  ON 0
ci_0002                 6.982263e-01 3 1  ON 1
ci_0003                -3.415722e-02 3 1  ON 2
ci_0004                -3.422949e-02 3 1  ON 3
ci_0005                -3.195324e-02 3 1  ON 4
ci_0006                -3.258999e-02 3 1  ON 5
ci_0007                -2.056875e-02 3 1  ON 6
ci_0008                -2.109809e-02 3 1  ON 7
ci_0009                -2.097075e-02 3 1  ON 8
ci_0010                -2.125020e-02 3 1  ON 9
ci_0011                -1.757288e-02 3 1  ON 10
ci_0012                -1.741804e-02 3 1  ON 11
ci_0013                 1.754383e-02 3 1  ON 12
ci_0014                 1.755153e-02 3 1  ON 13
ci_0015                 1.792735e-02 3 1  ON 14
ci_0016                 1.769089e-02 3 1  ON 15
ci_0017                 1.542668e-02 3 1  ON 16
ci_0018                 1.586768e-02 3 1  ON 17
ci_0019                 1.376466e-02 3 1  ON 18
ci_0020                 1.349393e-02 3 1  ON 19
ci_0021                 1.648208e-02 3 1  ON 20
ci_0022                 1.722799e-02 3 1  ON 21
ci_0023                -1.269233e-02 3 1  ON 22
ci_0024                -1.249609e-02 3 1  ON 23
ci_0025                -4.992311e-03 3 1  ON 24
ci_0026                -4.729508e-03 3 1  ON 25
ci_0027                -1.234583e-02 3 1  ON 26
ci_0028                -1.250844e-02 3 1  ON 27
ci_0029                -1.095405e-02 3 1  ON 28
ci_0030                -1.118738e-02 3 1  ON 29
ci_0031                 1.445037e-02 3 1  ON 30
ci_0032                 1.439641e-02 3 1  ON 31
ci_0033                 1.011619e-02 3 1  ON 32
ci_0034                 9.915755e-03 3 1  ON 33
ci_0035                 6.201991e-03 3 1  ON 34
ci_0036                 6.457767e-03 3 1  ON 35
ci_0037                -1.196089e-02 3 1  ON 36
ci_0038                -1.230749e-02 3 1  ON 37
ci_0039                -5.518939e-03 3 1  ON 38
ci_0040                -5.484868e-03 3 1  ON 39
ci_0041                 1.044812e-02 3 1  ON 40
ci_0042                 1.079801e-02 3 1  ON 41
ci_0043                -7.460746e-03 3 1  ON 42
ci_0044                -8.179223e-03 3 1  ON 43
ci_0045                 1.099747e-02 3 1  ON 44
ci_0046                 1.059954e-02 3 1  ON 45
ci_0047                -4.942983e-03 3 1  ON 46
ci_0048                -4.949940e-03 3 1  ON 47
ci_0049                -3.967378e-03 3 1  ON 48
ci_0050                -4.049399e-03 3 1  ON 49
ci_0051                -3.218911e-03 3 1  ON 50
ci_0052                -3.249834e-03 3 1  ON 51
ci_0053                -4.513892e-03 3 1  ON 52
ci_0054                -4.711616e-03 3 1  ON 53
ci_0055                 3.604947e-03 3 1  ON 54
ci_0056                 3.234455e-03 3 1  ON 55
ci_0057                 3.588923e-03 3 1  ON 56
ci_0058                 3.731582e-03 3 1  ON 57
ci_0059                -4.586573e-03 3 1  ON 58
ci_0060                -4.634852e-03 3 1  ON 59
ci_0061                -4.411697e-03 3 1  ON 60
ci_0062                -4.397435e-03 3 1  ON 61
ci_0063                -9.827731e-03 3 1  ON 62
ci_0064                -9.764076e-03 3 1  ON 63
ci_0065                -7.612641e-03 3 1  ON 64
ci_0066                -7.718120e-03 3 1  ON 65
ci_0067                -4.942551e-03 3 1  ON 66
ci_0068                -5.196528e-03 3 1  ON 67
ci_0069                 4.728596e-03 3 1  ON 68
ci_0070                 4.399279e-03 3 1  ON 69
ci_0071                 4.815002e-03 3 1  ON 70
ci_0072                 5.648187e-03 3 1  ON 71
ci_0073                 4.385220e-03 3 1  ON 72
ci_0074                 4.418924e-03 3 1  ON 73
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 34
    time step          = 0.05
    reference energy   = -16.899
    reference variance = 0.323689
====================================================
  Execution time = 1.5085e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s034
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6903e+01
  VMC Evar = 3.2366e-01
  Total weights = 1.9518e+06
  Execution time = 1.9181e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.312781734517
                                         uncertainty =       0.003132000520

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.312781734517
                                         uncertainty =       0.003132000520

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000395439761
  error estimate for blocks of size 2^( 2) =       0.000409836817
  error estimate for blocks of size 2^( 3) =       0.000424322592
  error estimate for blocks of size 2^( 4) =       0.000437511889
  error estimate for blocks of size 2^( 5) =       0.000448638214
  error estimate for blocks of size 2^( 6) =       0.000458943916
  error estimate for blocks of size 2^( 7) =       0.000462306298

      target function =      -0.864679165064
              le_mean =     -16.903490268947
             les_mean =     286.060307152968
             stat err =       0.000451850079
             autocorr =       1.305653858461
   target nu stat err =       0.000451850079
   target dn stat err =       0.005635481212
      target stat err =       0.006792387090
              std dev =       0.559236272459
             le_variance =       0.312745208434

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.309676819948
                                         uncertainty =       0.002911746787

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.309676819948
                                         uncertainty =       0.002911746787

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000393474075
  error estimate for blocks of size 2^( 2) =       0.000408129178
  error estimate for blocks of size 2^( 3) =       0.000422855802
  error estimate for blocks of size 2^( 4) =       0.000436298943
  error estimate for blocks of size 2^( 5) =       0.000447620144
  error estimate for blocks of size 2^( 6) =       0.000458020959
  error estimate for blocks of size 2^( 7) =       0.000461459126

      target function =      -0.867241602499
              le_mean =     -16.903592960919
             les_mean =     286.061653801633
             stat err =       0.000450849793
             autocorr =       1.312899558127
   target nu stat err =       0.000450849793
   target dn stat err =       0.005979326987
      target stat err =       0.007247115943
              std dev =       0.556456373823
             le_variance =       0.309643695968

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.309882729005
                                         uncertainty =       0.002945327316

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.309882729005
                                         uncertainty =       0.002945327316

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000393604746
  error estimate for blocks of size 2^( 2) =       0.000408210549
  error estimate for blocks of size 2^( 3) =       0.000422894445
  error estimate for blocks of size 2^( 4) =       0.000436286487
  error estimate for blocks of size 2^( 5) =       0.000447572032
  error estimate for blocks of size 2^( 6) =       0.000457877823
  error estimate for blocks of size 2^( 7) =       0.000461269335

      target function =      -0.817919285712
              le_mean =     -16.903541867877
             les_mean =     286.100496485709
             stat err =       0.000450751419
             autocorr =       1.311455480692
   target nu stat err =       0.000450751419
   target dn stat err =       0.046063346998
      target stat err =       0.049651713590
              std dev =       0.556641170058
             le_variance =       0.309849392203

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.312142270247
                                         uncertainty =       0.003093641475

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.312142270247
                                         uncertainty =       0.003093641475

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000395035603
  error estimate for blocks of size 2^( 2) =       0.000409461249
  error estimate for blocks of size 2^( 3) =       0.000423974139
  error estimate for blocks of size 2^( 4) =       0.000437194258
  error estimate for blocks of size 2^( 5) =       0.000448343796
  error estimate for blocks of size 2^( 6) =       0.000458649959
  error estimate for blocks of size 2^( 7) =       0.000462021178

      target function =      -0.871577395851
              le_mean =     -16.903479287679
             les_mean =     286.054256999983
             stat err =       0.000451552298
             autocorr =       1.306602953177
   target nu stat err =       0.000451552298
   target dn stat err =       0.003701837335
      target stat err =       0.004557651926
              std dev =       0.558664707859
             le_variance =       0.312106255807


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.864679165064        initial
     6.1035e-02     6.1035e-01             3.5399e-03        -0.867241602499
     2.4414e-01     2.4414e+00             1.2237e-03        -0.817919285712
     9.7656e-01     9.7656e+00             3.3802e-04        -0.871577395851  <--

*****************************************************************************
Applying the update for shift_i =   9.7656e-01     and shift_s =   9.7656e+00
*****************************************************************************

  Execution time = 2.4775e+01
  </log>
  <optVariables href="H2O.s034.opt.xml">
ci_0001                 7.008867e-01 3 1  ON 0
ci_0002                 6.978348e-01 3 1  ON 1
ci_0003                -3.485064e-02 3 1  ON 2
ci_0004                -3.488699e-02 3 1  ON 3
ci_0005                -3.273107e-02 3 1  ON 4
ci_0006                -3.327119e-02 3 1  ON 5
ci_0007                -2.137805e-02 3 1  ON 6
ci_0008                -2.198380e-02 3 1  ON 7
ci_0009                -2.146333e-02 3 1  ON 8
ci_0010                -2.179558e-02 3 1  ON 9
ci_0011                -1.801169e-02 3 1  ON 10
ci_0012                -1.789145e-02 3 1  ON 11
ci_0013                 1.791975e-02 3 1  ON 12
ci_0014                 1.794023e-02 3 1  ON 13
ci_0015                 1.836030e-02 3 1  ON 14
ci_0016                 1.814100e-02 3 1  ON 15
ci_0017                 1.588626e-02 3 1  ON 16
ci_0018                 1.631805e-02 3 1  ON 17
ci_0019                 1.401676e-02 3 1  ON 18
ci_0020                 1.376268e-02 3 1  ON 19
ci_0021                 1.679075e-02 3 1  ON 20
ci_0022                 1.742863e-02 3 1  ON 21
ci_0023                -1.297737e-02 3 1  ON 22
ci_0024                -1.260806e-02 3 1  ON 23
ci_0025                -5.652538e-03 3 1  ON 24
ci_0026                -5.182734e-03 3 1  ON 25
ci_0027                -1.275125e-02 3 1  ON 26
ci_0028                -1.262472e-02 3 1  ON 27
ci_0029                -1.122984e-02 3 1  ON 28
ci_0030                -1.133047e-02 3 1  ON 29
ci_0031                 1.470545e-02 3 1  ON 30
ci_0032                 1.460077e-02 3 1  ON 31
ci_0033                 1.018626e-02 3 1  ON 32
ci_0034                 1.028811e-02 3 1  ON 33
ci_0035                 6.638859e-03 3 1  ON 34
ci_0036                 6.866546e-03 3 1  ON 35
ci_0037                -1.218011e-02 3 1  ON 36
ci_0038                -1.230472e-02 3 1  ON 37
ci_0039                -5.897845e-03 3 1  ON 38
ci_0040                -5.875284e-03 3 1  ON 39
ci_0041                 1.064142e-02 3 1  ON 40
ci_0042                 1.104940e-02 3 1  ON 41
ci_0043                -7.858351e-03 3 1  ON 42
ci_0044                -8.444300e-03 3 1  ON 43
ci_0045                 1.105721e-02 3 1  ON 44
ci_0046                 1.069577e-02 3 1  ON 45
ci_0047                -5.325474e-03 3 1  ON 46
ci_0048                -5.336247e-03 3 1  ON 47
ci_0049                -4.216309e-03 3 1  ON 48
ci_0050                -4.360915e-03 3 1  ON 49
ci_0051                -3.531169e-03 3 1  ON 50
ci_0052                -3.524369e-03 3 1  ON 51
ci_0053                -4.679295e-03 3 1  ON 52
ci_0054                -4.985221e-03 3 1  ON 53
ci_0055                 3.923219e-03 3 1  ON 54
ci_0056                 3.362063e-03 3 1  ON 55
ci_0057                 3.794810e-03 3 1  ON 56
ci_0058                 4.386239e-03 3 1  ON 57
ci_0059                -4.952838e-03 3 1  ON 58
ci_0060                -4.885362e-03 3 1  ON 59
ci_0061                -4.769214e-03 3 1  ON 60
ci_0062                -4.786952e-03 3 1  ON 61
ci_0063                -1.001817e-02 3 1  ON 62
ci_0064                -9.839752e-03 3 1  ON 63
ci_0065                -7.800518e-03 3 1  ON 64
ci_0066                -7.805972e-03 3 1  ON 65
ci_0067                -5.282430e-03 3 1  ON 66
ci_0068                -5.418604e-03 3 1  ON 67
ci_0069                 5.094059e-03 3 1  ON 68
ci_0070                 4.533675e-03 3 1  ON 69
ci_0071                 5.003305e-03 3 1  ON 70
ci_0072                 5.725723e-03 3 1  ON 71
ci_0073                 4.453743e-03 3 1  ON 72
ci_0074                 4.607036e-03 3 1  ON 73
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 4.1781e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s035 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s035 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=35  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6896e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 35
    time step          = 0.05
    reference energy   = -16.8778
    reference variance = 0.190239
====================================================
  Execution time = 1.5633e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s035
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5252e+04
  VMC Eavg = -1.6903e+01
  VMC Evar = 3.2756e-01
  Total weights = 1.951442886e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 2.6104e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.310648941941
                                         uncertainty =       0.002837760041

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.310648941941
                                         uncertainty =       0.002837760041

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000394113227
  error estimate for blocks of size 2^( 2) =       0.000408513240
  error estimate for blocks of size 2^( 3) =       0.000423225304
  error estimate for blocks of size 2^( 4) =       0.000436124243
  error estimate for blocks of size 2^( 5) =       0.000447584065
  error estimate for blocks of size 2^( 6) =       0.000455769254
  error estimate for blocks of size 2^( 7) =       0.000458396566

      target function =      -0.870407361017
              le_mean =     -16.903288791374
             les_mean =     286.048732037142
             stat err =       0.000449468532
             autocorr =       1.300638368185
   target nu stat err =       0.000449468532
   target dn stat err =       0.005776230014
      target stat err =       0.007050203587
              std dev =       0.557360271097
             le_variance =       0.310650471798


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690328879137e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 74
Check correct_vf_var_size: 225, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.4414e-01, overlap shift 2.4414e+00 and omega -1.7527e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.870463197633       residual = 1.61e-01           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.871932155754       residual = 1.98e-02           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.872211704895       residual = 4.05e-03           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.872298714940       residual = 1.30e-03           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.872332908000       residual = 5.66e-04           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.872342574176       residual = 5.19e-04           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.872346853921       residual = 1.27e-04           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.872349959844       residual = 4.23e-05           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.872350913508       residual = 2.56e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.872351474744       residual = 1.48e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.872352183912       residual = 1.37e-05           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.872352795282       residual = 9.85e-06           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.872353423126       residual = 1.00e-05           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.872353861064       residual = 6.93e-06           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.872354332872       residual = 2.12e-06           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.872354543148       residual = 5.58e-07           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.872354685737       residual = 7.66e-08           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.872354668735       residual = 3.28e-08           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.872354706738       residual = 1.16e-08           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.872354711415       residual = 5.05e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         19 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 2.4414e-01 is 1.410806e-03

solving harmonic davidson linear method for identity shift 9.7656e-01, overlap shift 9.7656e+00 and omega -1.7527e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.870463197633       residual = 1.61e-01           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.870909708035       residual = 1.92e-02           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.870991726317       residual = 3.82e-03           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.871016115168       residual = 1.16e-03           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.871025295323       residual = 4.81e-04           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.871027715296       residual = 4.05e-04           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.871028625581       residual = 9.71e-05           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.871029361692       residual = 3.17e-05           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.871029581586       residual = 1.93e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.871029721330       residual = 1.16e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.871029901718       residual = 1.04e-05           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.871030046911       residual = 7.28e-06           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.871030197074       residual = 6.34e-06           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.871030276327       residual = 3.13e-06           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.871030357391       residual = 8.02e-07           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.871030389267       residual = 1.87e-07           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.871030411524       residual = 2.69e-08           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.871030407741       residual = 1.18e-08           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.871030414199       residual = 4.01e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         18 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 9.7656e-01 is 3.902959e-04

solving harmonic davidson linear method for identity shift 3.9062e+00, overlap shift 3.9062e+01 and omega -1.7527e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.870463197633       residual = 1.61e-01           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.870581181608       residual = 1.90e-02           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.870602605524       residual = 3.75e-03           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.870608883832       residual = 1.12e-03           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.870611215372       residual = 4.57e-04           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.870611815588       residual = 3.73e-04           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.870612029939       residual = 8.94e-05           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.870612210069       residual = 2.90e-05           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.870612263618       residual = 1.77e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.870612298592       residual = 1.07e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.870612343708       residual = 9.56e-06           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.870612379241       residual = 6.60e-06           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.870612415825       residual = 5.43e-06           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.870612433392       residual = 2.42e-06           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.870612451400       residual = 5.93e-07           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.870612458234       residual = 1.34e-07           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.870612463049       residual = 1.97e-08           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.870612462148       residual = 8.65e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         17 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 3.9062e+00 is 1.002294e-04

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.587027 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 75 and numParams is: 74

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.8270e+01
  </log>
  <optVariables href="H2O.s035.opt.xml">
ci_0001                 7.007239e-01 3 1  ON 0
ci_0002                 6.981952e-01 3 1  ON 1
ci_0003                -3.458427e-02 3 1  ON 2
ci_0004                -3.465389e-02 3 1  ON 3
ci_0005                -3.234684e-02 3 1  ON 4
ci_0006                -3.293799e-02 3 1  ON 5
ci_0007                -2.098776e-02 3 1  ON 6
ci_0008                -2.162453e-02 3 1  ON 7
ci_0009                -2.131664e-02 3 1  ON 8
ci_0010                -2.162787e-02 3 1  ON 9
ci_0011                -1.780576e-02 3 1  ON 10
ci_0012                -1.771885e-02 3 1  ON 11
ci_0013                 1.779443e-02 3 1  ON 12
ci_0014                 1.772989e-02 3 1  ON 13
ci_0015                 1.814076e-02 3 1  ON 14
ci_0016                 1.806252e-02 3 1  ON 15
ci_0017                 1.578933e-02 3 1  ON 16
ci_0018                 1.615403e-02 3 1  ON 17
ci_0019                 1.397270e-02 3 1  ON 18
ci_0020                 1.359635e-02 3 1  ON 19
ci_0021                 1.668583e-02 3 1  ON 20
ci_0022                 1.746900e-02 3 1  ON 21
ci_0023                -1.286237e-02 3 1  ON 22
ci_0024                -1.247567e-02 3 1  ON 23
ci_0025                -5.360474e-03 3 1  ON 24
ci_0026                -5.065315e-03 3 1  ON 25
ci_0027                -1.270328e-02 3 1  ON 26
ci_0028                -1.253756e-02 3 1  ON 27
ci_0029                -1.112885e-02 3 1  ON 28
ci_0030                -1.120638e-02 3 1  ON 29
ci_0031                 1.453783e-02 3 1  ON 30
ci_0032                 1.452071e-02 3 1  ON 31
ci_0033                 1.019100e-02 3 1  ON 32
ci_0034                 1.014679e-02 3 1  ON 33
ci_0035                 6.597490e-03 3 1  ON 34
ci_0036                 6.786962e-03 3 1  ON 35
ci_0037                -1.208272e-02 3 1  ON 36
ci_0038                -1.215539e-02 3 1  ON 37
ci_0039                -5.735069e-03 3 1  ON 38
ci_0040                -5.647075e-03 3 1  ON 39
ci_0041                 1.063128e-02 3 1  ON 40
ci_0042                 1.101781e-02 3 1  ON 41
ci_0043                -7.545369e-03 3 1  ON 42
ci_0044                -8.395646e-03 3 1  ON 43
ci_0045                 1.102257e-02 3 1  ON 44
ci_0046                 1.057973e-02 3 1  ON 45
ci_0047                -5.160720e-03 3 1  ON 46
ci_0048                -5.209737e-03 3 1  ON 47
ci_0049                -4.074956e-03 3 1  ON 48
ci_0050                -4.316445e-03 3 1  ON 49
ci_0051                -3.188265e-03 3 1  ON 50
ci_0052                -3.266721e-03 3 1  ON 51
ci_0053                -4.509232e-03 3 1  ON 52
ci_0054                -4.839438e-03 3 1  ON 53
ci_0055                 3.864972e-03 3 1  ON 54
ci_0056                 3.150674e-03 3 1  ON 55
ci_0057                 3.670838e-03 3 1  ON 56
ci_0058                 4.167223e-03 3 1  ON 57
ci_0059                -4.888502e-03 3 1  ON 58
ci_0060                -4.773385e-03 3 1  ON 59
ci_0061                -4.739321e-03 3 1  ON 60
ci_0062                -4.633772e-03 3 1  ON 61
ci_0063                -9.975066e-03 3 1  ON 62
ci_0064                -9.791136e-03 3 1  ON 63
ci_0065                -7.692841e-03 3 1  ON 64
ci_0066                -7.763256e-03 3 1  ON 65
ci_0067                -4.931460e-03 3 1  ON 66
ci_0068                -5.250640e-03 3 1  ON 67
ci_0069                 4.846703e-03 3 1  ON 68
ci_0070                 4.376543e-03 3 1  ON 69
ci_0071                 4.654968e-03 3 1  ON 70
ci_0072                 5.448432e-03 3 1  ON 71
ci_0073                 4.356913e-03 3 1  ON 72
ci_0074                 4.525008e-03 3 1  ON 73
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 35
    time step          = 0.05
    reference energy   = -16.908
    reference variance = 0.222594
====================================================
  Execution time = 1.4049e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s035
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6903e+01
  VMC Evar = 3.2211e-01
  Total weights = 1.9520e+06
  Execution time = 1.8965e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.307537957020
                                         uncertainty =       0.002173969820

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.307537957020
                                         uncertainty =       0.002173969820

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000392085057
  error estimate for blocks of size 2^( 2) =       0.000406155896
  error estimate for blocks of size 2^( 3) =       0.000420328836
  error estimate for blocks of size 2^( 4) =       0.000433368000
  error estimate for blocks of size 2^( 5) =       0.000444705900
  error estimate for blocks of size 2^( 6) =       0.000452561092
  error estimate for blocks of size 2^( 7) =       0.000459980809

      target function =      -0.866987166123
              le_mean =     -16.903363446309
             les_mean =     286.054072261746
             stat err =       0.000447653950
             autocorr =       1.303539693013
   target nu stat err =       0.000447653950
   target dn stat err =       0.006660007564
      target stat err =       0.008058345636
              std dev =       0.554492005187
             le_variance =       0.307461383817

ERROR CostFunction-> Number of Effective Walkers is too small! 
  Number of effective walkers (samples) / total number of samples = 0.202912
  User specified threshold minwalkers = 0.3
  If this message appears frequently. You might have to be cautious. 
  Find info about parameter "minwalkers" in the user manual!
Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.306382503407
                                         uncertainty =       0.002087438122

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.306382503407
                                         uncertainty =       0.002087438122

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000391348735
  error estimate for blocks of size 2^( 2) =       0.000405522134
  error estimate for blocks of size 2^( 3) =       0.000419812561
  error estimate for blocks of size 2^( 4) =       0.000432989476
  error estimate for blocks of size 2^( 5) =       0.000444434580
  error estimate for blocks of size 2^( 6) =       0.000452326916
  error estimate for blocks of size 2^( 7) =       0.000459742736

      target function =      -0.723796916140
              le_mean =     -16.903398730059
             les_mean =     286.178688218007
             stat err =       0.000447373427
             autocorr =       1.306810156116
   target nu stat err =       0.000447373427
   target dn stat err =       0.125974992860
      target stat err =       0.108282311278
              std dev =       0.553450688315
             le_variance =       0.306307664397

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.306546279893
                                         uncertainty =       0.002122868310

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.306546279893
                                         uncertainty =       0.002122868310

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000391452874
  error estimate for blocks of size 2^( 2) =       0.000405583595
  error estimate for blocks of size 2^( 3) =       0.000419832587
  error estimate for blocks of size 2^( 4) =       0.000432946720
  error estimate for blocks of size 2^( 5) =       0.000444339375
  error estimate for blocks of size 2^( 6) =       0.000452224592
  error estimate for blocks of size 2^( 7) =       0.000459697222

      target function =      -0.876748803396
              le_mean =     -16.903381179659
             les_mean =     286.046714559646
             stat err =       0.000447301977
             autocorr =       1.305697772724
   target nu stat err =       0.000447301977
   target dn stat err =       0.003599049390
      target stat err =       0.004484243346
              std dev =       0.553597963861
             le_variance =       0.306470705591

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.307387442533
                                         uncertainty =       0.002166573815

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.307387442533
                                         uncertainty =       0.002166573815

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000391989164
  error estimate for blocks of size 2^( 2) =       0.000406066002
  error estimate for blocks of size 2^( 3) =       0.000420249462
  error estimate for blocks of size 2^( 4) =       0.000433299621
  error estimate for blocks of size 2^( 5) =       0.000444644398
  error estimate for blocks of size 2^( 6) =       0.000452502767
  error estimate for blocks of size 2^( 7) =       0.000459932144

      target function =      -0.874992527597
              le_mean =     -16.903363391929
             les_mean =     286.047537359599
             stat err =       0.000447594732
             autocorr =       1.303832525776
   target nu stat err =       0.000447594732
   target dn stat err =       0.003662273182
      target stat err =       0.004543326477
              std dev =       0.554356391375
             le_variance =       0.307311008658


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.866987166123        initial
     2.4414e-01     2.4414e+00             1.4108e-03        -0.723796916140
     9.7656e-01     9.7656e+00             3.9030e-04        -0.876748803396  <--
     3.9062e+00     3.9062e+01             1.0023e-04        -0.874992527597

*****************************************************************************
Applying the update for shift_i =   9.7656e-01     and shift_s =   9.7656e+00
*****************************************************************************

  Execution time = 2.3696e+01
  </log>
  <optVariables href="H2O.s035.opt.xml">
ci_0001                 7.007239e-01 3 1  ON 0
ci_0002                 6.981952e-01 3 1  ON 1
ci_0003                -3.458427e-02 3 1  ON 2
ci_0004                -3.465389e-02 3 1  ON 3
ci_0005                -3.234684e-02 3 1  ON 4
ci_0006                -3.293799e-02 3 1  ON 5
ci_0007                -2.098776e-02 3 1  ON 6
ci_0008                -2.162453e-02 3 1  ON 7
ci_0009                -2.131664e-02 3 1  ON 8
ci_0010                -2.162787e-02 3 1  ON 9
ci_0011                -1.780576e-02 3 1  ON 10
ci_0012                -1.771885e-02 3 1  ON 11
ci_0013                 1.779443e-02 3 1  ON 12
ci_0014                 1.772989e-02 3 1  ON 13
ci_0015                 1.814076e-02 3 1  ON 14
ci_0016                 1.806252e-02 3 1  ON 15
ci_0017                 1.578933e-02 3 1  ON 16
ci_0018                 1.615403e-02 3 1  ON 17
ci_0019                 1.397270e-02 3 1  ON 18
ci_0020                 1.359635e-02 3 1  ON 19
ci_0021                 1.668583e-02 3 1  ON 20
ci_0022                 1.746900e-02 3 1  ON 21
ci_0023                -1.286237e-02 3 1  ON 22
ci_0024                -1.247567e-02 3 1  ON 23
ci_0025                -5.360474e-03 3 1  ON 24
ci_0026                -5.065315e-03 3 1  ON 25
ci_0027                -1.270328e-02 3 1  ON 26
ci_0028                -1.253756e-02 3 1  ON 27
ci_0029                -1.112885e-02 3 1  ON 28
ci_0030                -1.120638e-02 3 1  ON 29
ci_0031                 1.453783e-02 3 1  ON 30
ci_0032                 1.452071e-02 3 1  ON 31
ci_0033                 1.019100e-02 3 1  ON 32
ci_0034                 1.014679e-02 3 1  ON 33
ci_0035                 6.597490e-03 3 1  ON 34
ci_0036                 6.786962e-03 3 1  ON 35
ci_0037                -1.208272e-02 3 1  ON 36
ci_0038                -1.215539e-02 3 1  ON 37
ci_0039                -5.735069e-03 3 1  ON 38
ci_0040                -5.647075e-03 3 1  ON 39
ci_0041                 1.063128e-02 3 1  ON 40
ci_0042                 1.101781e-02 3 1  ON 41
ci_0043                -7.545369e-03 3 1  ON 42
ci_0044                -8.395646e-03 3 1  ON 43
ci_0045                 1.102257e-02 3 1  ON 44
ci_0046                 1.057973e-02 3 1  ON 45
ci_0047                -5.160720e-03 3 1  ON 46
ci_0048                -5.209737e-03 3 1  ON 47
ci_0049                -4.074956e-03 3 1  ON 48
ci_0050                -4.316445e-03 3 1  ON 49
ci_0051                -3.188265e-03 3 1  ON 50
ci_0052                -3.266721e-03 3 1  ON 51
ci_0053                -4.509232e-03 3 1  ON 52
ci_0054                -4.839438e-03 3 1  ON 53
ci_0055                 3.864972e-03 3 1  ON 54
ci_0056                 3.150674e-03 3 1  ON 55
ci_0057                 3.670838e-03 3 1  ON 56
ci_0058                 4.167223e-03 3 1  ON 57
ci_0059                -4.888502e-03 3 1  ON 58
ci_0060                -4.773385e-03 3 1  ON 59
ci_0061                -4.739321e-03 3 1  ON 60
ci_0062                -4.633772e-03 3 1  ON 61
ci_0063                -9.975066e-03 3 1  ON 62
ci_0064                -9.791136e-03 3 1  ON 63
ci_0065                -7.692841e-03 3 1  ON 64
ci_0066                -7.763256e-03 3 1  ON 65
ci_0067                -4.931460e-03 3 1  ON 66
ci_0068                -5.250640e-03 3 1  ON 67
ci_0069                 4.846703e-03 3 1  ON 68
ci_0070                 4.376543e-03 3 1  ON 69
ci_0071                 4.654968e-03 3 1  ON 70
ci_0072                 5.448432e-03 3 1  ON 71
ci_0073                 4.356913e-03 3 1  ON 72
ci_0074                 4.525008e-03 3 1  ON 73
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 4.1980e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s036 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s036 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=36  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6896e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 36
    time step          = 0.05
    reference energy   = -16.9378
    reference variance = 0.207021
====================================================
  Execution time = 1.4511e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s036
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5250e+04
  VMC Eavg = -1.6904e+01
  VMC Evar = 3.1490e-01
  Total weights = 1.951580914e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 2.5634e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.305204425488
                                         uncertainty =       0.002061287195

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.305204425488
                                         uncertainty =       0.002061287195

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000390686266
  error estimate for blocks of size 2^( 2) =       0.000405140828
  error estimate for blocks of size 2^( 3) =       0.000419451635
  error estimate for blocks of size 2^( 4) =       0.000432964950
  error estimate for blocks of size 2^( 5) =       0.000444378293
  error estimate for blocks of size 2^( 6) =       0.000452746039
  error estimate for blocks of size 2^( 7) =       0.000456445959

      target function =      -0.886250593145
              le_mean =     -16.904138766310
             les_mean =     286.064803464852
             stat err =       0.000446633810
             autocorr =       1.306913676173
   target nu stat err =       0.000446633810
   target dn stat err =       0.002695906503
      target stat err =       0.003461232689
              std dev =       0.552513816456
             le_variance =       0.305271517374


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690413876631e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 74
Check correct_vf_var_size: 225, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.4414e-01, overlap shift 2.4414e+00 and omega -1.7527e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.886262788406       residual = 5.92e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.886989501663       residual = 1.23e-02           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.887152414293       residual = 2.34e-03           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.887211330173       residual = 6.30e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.887225890489       residual = 2.92e-04           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.887235823565       residual = 1.66e-04           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.887238191567       residual = 4.86e-05           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.887238724601       residual = 1.42e-05           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.887238204274       residual = 4.33e-06           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.887238361192       residual = 1.74e-06           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.887238126237       residual = 5.10e-07           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.887238110362       residual = 7.66e-08           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.887238095399       residual = 3.16e-08           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.887238124767       residual = 1.84e-08           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.887238148850       residual = 3.09e-08           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.887238189092       residual = 2.20e-08           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.887238203916       residual = 1.14e-08           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.887238212984       residual = 6.81e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         17 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 2.4414e-01 is 1.232883e-03

solving harmonic davidson linear method for identity shift 9.7656e-01, overlap shift 9.7656e+00 and omega -1.7527e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.886262788406       residual = 5.92e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.886483426901       residual = 1.19e-02           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.886531049716       residual = 2.17e-03           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.886547444750       residual = 5.63e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.886551335076       residual = 2.49e-04           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.886553813426       residual = 1.30e-04           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.886554370038       residual = 3.58e-05           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.886554461557       residual = 1.00e-05           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.886554319032       residual = 2.88e-06           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.886554351288       residual = 1.07e-06           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.886554296835       residual = 2.82e-07           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.886554295537       residual = 4.21e-08           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.886554292434       residual = 1.83e-08           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.886554300247       residual = 1.26e-08           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.886554306849       residual = 1.94e-08           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.886554314513       residual = 1.03e-08           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.886554316223       residual = 4.90e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         16 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 9.7656e-01 is 3.412130e-04

solving harmonic davidson linear method for identity shift 3.9062e+00, overlap shift 3.9062e+01 and omega -1.7527e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.886262788406       residual = 5.92e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.886321070025       residual = 1.18e-02           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.886333496333       residual = 2.12e-03           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.886337707612       residual = 5.43e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.886338693998       residual = 2.37e-04           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.886339309172       residual = 1.20e-04           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.886339444707       residual = 3.25e-05           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.886339464284       residual = 8.98e-06           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.886339428068       residual = 2.53e-06           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.886339435602       residual = 9.19e-07           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.886339422439       residual = 2.34e-07           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.886339422302       residual = 3.50e-08           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.886339421574       residual = 1.56e-08           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.886339423563       residual = 1.13e-08           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.886339425234       residual = 1.65e-08           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.886339426951       residual = 8.09e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         15 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 3.9062e+00 is 8.764983e-05

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.601545 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 75 and numParams is: 74

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.7097e+01
  </log>
  <optVariables href="H2O.s036.opt.xml">
ci_0001                 7.007941e-01 3 1  ON 0
ci_0002                 6.982963e-01 3 1  ON 1
ci_0003                -3.436855e-02 3 1  ON 2
ci_0004                -3.441938e-02 3 1  ON 3
ci_0005                -3.204127e-02 3 1  ON 4
ci_0006                -3.263801e-02 3 1  ON 5
ci_0007                -2.076536e-02 3 1  ON 6
ci_0008                -2.128332e-02 3 1  ON 7
ci_0009                -2.112545e-02 3 1  ON 8
ci_0010                -2.142179e-02 3 1  ON 9
ci_0011                -1.764467e-02 3 1  ON 10
ci_0012                -1.751910e-02 3 1  ON 11
ci_0013                 1.764519e-02 3 1  ON 12
ci_0014                 1.752615e-02 3 1  ON 13
ci_0015                 1.799189e-02 3 1  ON 14
ci_0016                 1.797294e-02 3 1  ON 15
ci_0017                 1.569179e-02 3 1  ON 16
ci_0018                 1.599140e-02 3 1  ON 17
ci_0019                 1.380293e-02 3 1  ON 18
ci_0020                 1.350528e-02 3 1  ON 19
ci_0021                 1.658803e-02 3 1  ON 20
ci_0022                 1.741946e-02 3 1  ON 21
ci_0023                -1.272360e-02 3 1  ON 22
ci_0024                -1.231517e-02 3 1  ON 23
ci_0025                -5.080365e-03 3 1  ON 24
ci_0026                -4.849718e-03 3 1  ON 25
ci_0027                -1.260883e-02 3 1  ON 26
ci_0028                -1.250497e-02 3 1  ON 27
ci_0029                -1.105159e-02 3 1  ON 28
ci_0030                -1.112247e-02 3 1  ON 29
ci_0031                 1.457166e-02 3 1  ON 30
ci_0032                 1.448079e-02 3 1  ON 31
ci_0033                 1.007988e-02 3 1  ON 32
ci_0034                 9.966926e-03 3 1  ON 33
ci_0035                 6.521141e-03 3 1  ON 34
ci_0036                 6.618603e-03 3 1  ON 35
ci_0037                -1.203113e-02 3 1  ON 36
ci_0038                -1.210308e-02 3 1  ON 37
ci_0039                -5.580513e-03 3 1  ON 38
ci_0040                -5.534822e-03 3 1  ON 39
ci_0041                 1.056703e-02 3 1  ON 40
ci_0042                 1.088555e-02 3 1  ON 41
ci_0043                -7.336999e-03 3 1  ON 42
ci_0044                -8.331506e-03 3 1  ON 43
ci_0045                 1.101538e-02 3 1  ON 44
ci_0046                 1.054387e-02 3 1  ON 45
ci_0047                -5.017679e-03 3 1  ON 46
ci_0048                -5.096591e-03 3 1  ON 47
ci_0049                -3.977755e-03 3 1  ON 48
ci_0050                -4.193439e-03 3 1  ON 49
ci_0051                -3.062858e-03 3 1  ON 50
ci_0052                -3.081048e-03 3 1  ON 51
ci_0053                -4.389085e-03 3 1  ON 52
ci_0054                -4.698569e-03 3 1  ON 53
ci_0055                 3.642007e-03 3 1  ON 54
ci_0056                 3.070266e-03 3 1  ON 55
ci_0057                 3.627632e-03 3 1  ON 56
ci_0058                 4.168969e-03 3 1  ON 57
ci_0059                -4.857199e-03 3 1  ON 58
ci_0060                -4.665725e-03 3 1  ON 59
ci_0061                -4.606218e-03 3 1  ON 60
ci_0062                -4.513307e-03 3 1  ON 61
ci_0063                -9.936482e-03 3 1  ON 62
ci_0064                -9.703748e-03 3 1  ON 63
ci_0065                -7.631410e-03 3 1  ON 64
ci_0066                -7.613377e-03 3 1  ON 65
ci_0067                -4.867385e-03 3 1  ON 66
ci_0068                -5.108082e-03 3 1  ON 67
ci_0069                 4.714910e-03 3 1  ON 68
ci_0070                 4.342570e-03 3 1  ON 69
ci_0071                 4.512048e-03 3 1  ON 70
ci_0072                 5.282123e-03 3 1  ON 71
ci_0073                 4.305366e-03 3 1  ON 72
ci_0074                 4.412668e-03 3 1  ON 73
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 36
    time step          = 0.05
    reference energy   = -16.8891
    reference variance = 0.281659
====================================================
  Execution time = 1.4380e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s036
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6903e+01
  VMC Evar = 3.1600e-01
  Total weights = 1.9517e+06
  Execution time = 1.8979e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.305694015256
                                         uncertainty =       0.002458879245

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.305694015256
                                         uncertainty =       0.002458879245

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000390953940
  error estimate for blocks of size 2^( 2) =       0.000404834194
  error estimate for blocks of size 2^( 3) =       0.000419518028
  error estimate for blocks of size 2^( 4) =       0.000432817625
  error estimate for blocks of size 2^( 5) =       0.000444247601
  error estimate for blocks of size 2^( 6) =       0.000452487062
  error estimate for blocks of size 2^( 7) =       0.000458451542

      target function =      -0.883607822821
              le_mean =     -16.903034504940
             les_mean =     286.029442337633
             stat err =       0.000447000958
             autocorr =       1.307271272820
   target nu stat err =       0.000447000958
   target dn stat err =       0.003097162185
      target stat err =       0.003929949590
              std dev =       0.552892364707
             le_variance =       0.305689966951

ERROR CostFunction-> Number of Effective Walkers is too small! 
  Number of effective walkers (samples) / total number of samples = 0.146289
  User specified threshold minwalkers = 0.3
  If this message appears frequently. You might have to be cautious. 
  Find info about parameter "minwalkers" in the user manual!
Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.304542846495
                                         uncertainty =       0.002390807358

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.304542846495
                                         uncertainty =       0.002390807358

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000390217222
  error estimate for blocks of size 2^( 2) =       0.000404191270
  error estimate for blocks of size 2^( 3) =       0.000418974028
  error estimate for blocks of size 2^( 4) =       0.000432357550
  error estimate for blocks of size 2^( 5) =       0.000443842354
  error estimate for blocks of size 2^( 6) =       0.000452120485
  error estimate for blocks of size 2^( 7) =       0.000458117974

      target function =      -0.880842507083
              le_mean =     -16.903052187877
             les_mean =     286.032247680534
             stat err =       0.000446609591
             autocorr =       1.309915328893
   target nu stat err =       0.000446609591
   target dn stat err =       0.004048931588
      target stat err =       0.005078324284
              std dev =       0.551850488005
             le_variance =       0.304538961111

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.304950314744
                                         uncertainty =       0.002418145956

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.304950314744
                                         uncertainty =       0.002418145956

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000390478152
  error estimate for blocks of size 2^( 2) =       0.000404413765
  error estimate for blocks of size 2^( 3) =       0.000419155015
  error estimate for blocks of size 2^( 4) =       0.000432515290
  error estimate for blocks of size 2^( 5) =       0.000443968089
  error estimate for blocks of size 2^( 6) =       0.000452226223
  error estimate for blocks of size 2^( 7) =       0.000458219949

      target function =      -0.830864017866
              le_mean =     -16.903033976028
             les_mean =     286.071726171284
             stat err =       0.000446732388
             autocorr =       1.308884726860
   target nu stat err =       0.000446732388
   target dn stat err =       0.043307687710
      target stat err =       0.048115823273
              std dev =       0.552219498831
             le_variance =       0.304946374889

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.305583582564
                                         uncertainty =       0.002453043954

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.305583582564
                                         uncertainty =       0.002453043954

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000390883329
  error estimate for blocks of size 2^( 2) =       0.000404770623
  error estimate for blocks of size 2^( 3) =       0.000419462001
  error estimate for blocks of size 2^( 4) =       0.000432768311
  error estimate for blocks of size 2^( 5) =       0.000444203379
  error estimate for blocks of size 2^( 6) =       0.000452445996
  error estimate for blocks of size 2^( 7) =       0.000458412905

      target function =      -0.884066900319
              le_mean =     -16.903033392037
             les_mean =     286.029038425787
             stat err =       0.000446957648
             autocorr =       1.307490219991
   target nu stat err =       0.000446957648
   target dn stat err =       0.003068279799
      target stat err =       0.003898233546
              std dev =       0.552792505010
             le_variance =       0.305579553596


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.883607822821        initial
     2.4414e-01     2.4414e+00             1.2329e-03        -0.880842507083
     9.7656e-01     9.7656e+00             3.4121e-04        -0.830864017866
     3.9062e+00     3.9062e+01             8.7650e-05        -0.884066900319  <--

*****************************************************************************
Applying the update for shift_i =   3.9062e+00     and shift_s =   3.9062e+01
*****************************************************************************

  Execution time = 2.3985e+01
  </log>
  <optVariables href="H2O.s036.opt.xml">
ci_0001                 7.007425e-01 3 1  ON 0
ci_0002                 6.982213e-01 3 1  ON 1
ci_0003                -3.452797e-02 3 1  ON 2
ci_0004                -3.459264e-02 3 1  ON 3
ci_0005                -3.226772e-02 3 1  ON 4
ci_0006                -3.286036e-02 3 1  ON 5
ci_0007                -2.093060e-02 3 1  ON 6
ci_0008                -2.153688e-02 3 1  ON 7
ci_0009                -2.126653e-02 3 1  ON 8
ci_0010                -2.157382e-02 3 1  ON 9
ci_0011                -1.776359e-02 3 1  ON 10
ci_0012                -1.766657e-02 3 1  ON 11
ci_0013                 1.775536e-02 3 1  ON 12
ci_0014                 1.767657e-02 3 1  ON 13
ci_0015                 1.810178e-02 3 1  ON 14
ci_0016                 1.803902e-02 3 1  ON 15
ci_0017                 1.576372e-02 3 1  ON 16
ci_0018                 1.611139e-02 3 1  ON 17
ci_0019                 1.392824e-02 3 1  ON 18
ci_0020                 1.357237e-02 3 1  ON 19
ci_0021                 1.666096e-02 3 1  ON 20
ci_0022                 1.745636e-02 3 1  ON 21
ci_0023                -1.282595e-02 3 1  ON 22
ci_0024                -1.243354e-02 3 1  ON 23
ci_0025                -5.286517e-03 3 1  ON 24
ci_0026                -5.008450e-03 3 1  ON 25
ci_0027                -1.267845e-02 3 1  ON 26
ci_0028                -1.252887e-02 3 1  ON 27
ci_0029                -1.110849e-02 3 1  ON 28
ci_0030                -1.118425e-02 3 1  ON 29
ci_0031                 1.454648e-02 3 1  ON 30
ci_0032                 1.451056e-02 3 1  ON 31
ci_0033                 1.016218e-02 3 1  ON 32
ci_0034                 1.010020e-02 3 1  ON 33
ci_0035                 6.577378e-03 3 1  ON 34
ci_0036                 6.742471e-03 3 1  ON 35
ci_0037                -1.206928e-02 3 1  ON 36
ci_0038                -1.214172e-02 3 1  ON 37
ci_0039                -5.694391e-03 3 1  ON 38
ci_0040                -5.617520e-03 3 1  ON 39
ci_0041                 1.061452e-02 3 1  ON 40
ci_0042                 1.098335e-02 3 1  ON 41
ci_0043                -7.491621e-03 3 1  ON 42
ci_0044                -8.379000e-03 3 1  ON 43
ci_0045                 1.102063e-02 3 1  ON 44
ci_0046                 1.057034e-02 3 1  ON 45
ci_0047                -5.123030e-03 3 1  ON 46
ci_0048                -5.179922e-03 3 1  ON 47
ci_0049                -4.049259e-03 3 1  ON 48
ci_0050                -4.283906e-03 3 1  ON 49
ci_0051                -3.155031e-03 3 1  ON 50
ci_0052                -3.217520e-03 3 1  ON 51
ci_0053                -4.477508e-03 3 1  ON 52
ci_0054                -4.802240e-03 3 1  ON 53
ci_0055                 3.805995e-03 3 1  ON 54
ci_0056                 3.129491e-03 3 1  ON 55
ci_0057                 3.659544e-03 3 1  ON 56
ci_0058                 4.167738e-03 3 1  ON 57
ci_0059                -4.880228e-03 3 1  ON 58
ci_0060                -4.744893e-03 3 1  ON 59
ci_0061                -4.704507e-03 3 1  ON 60
ci_0062                -4.602218e-03 3 1  ON 61
ci_0063                -9.964936e-03 3 1  ON 62
ci_0064                -9.768245e-03 3 1  ON 63
ci_0065                -7.676794e-03 3 1  ON 64
ci_0066                -7.724048e-03 3 1  ON 65
ci_0067                -4.914537e-03 3 1  ON 66
ci_0068                -5.212987e-03 3 1  ON 67
ci_0069                 4.811906e-03 3 1  ON 68
ci_0070                 4.367566e-03 3 1  ON 69
ci_0071                 4.617305e-03 3 1  ON 70
ci_0072                 5.404603e-03 3 1  ON 71
ci_0073                 4.343348e-03 3 1  ON 72
ci_0074                 4.495314e-03 3 1  ON 73
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 4.1096e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s037 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s037 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=37  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6897e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 37
    time step          = 0.05
    reference energy   = -16.9232
    reference variance = 0.27667
====================================================
  Execution time = 1.4347e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s037
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5228e+04
  VMC Eavg = -1.6903e+01
  VMC Evar = 3.2343e-01
  Total weights = 1.951505388e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 2.5726e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.308917955879
                                         uncertainty =       0.002623211439

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.308917955879
                                         uncertainty =       0.002623211439

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000392998436
  error estimate for blocks of size 2^( 2) =       0.000407740715
  error estimate for blocks of size 2^( 3) =       0.000422258794
  error estimate for blocks of size 2^( 4) =       0.000435882731
  error estimate for blocks of size 2^( 5) =       0.000447239545
  error estimate for blocks of size 2^( 6) =       0.000455298555
  error estimate for blocks of size 2^( 7) =       0.000461683364

      target function =      -0.875475590511
              le_mean =     -16.903197346622
             les_mean =     286.041507384696
             stat err =       0.000450026049
             autocorr =       1.311274636854
   target nu stat err =       0.000450026049
   target dn stat err =       0.004227964944
      target stat err =       0.005237362736
              std dev =       0.555783718536
             le_variance =       0.308895541790


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690319734662e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 74
Check correct_vf_var_size: 225, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 9.7656e-01, overlap shift 9.7656e+00 and omega -1.7527e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.875505755518       residual = 5.43e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.875717121422       residual = 1.07e-02           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.875761930715       residual = 2.19e-03           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.875776804380       residual = 6.65e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.875781559142       residual = 2.71e-04           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.875784703176       residual = 1.03e-04           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.875785504238       residual = 2.41e-05           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.875785465808       residual = 9.53e-06           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.875785583765       residual = 4.56e-06           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.875785578987       residual = 1.77e-06           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.875785561163       residual = 9.37e-07           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.875785605674       residual = 3.99e-07           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.875785613220       residual = 5.18e-07           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.875785624084       residual = 4.64e-07           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.875785617308       residual = 2.34e-07           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.875785641733       residual = 4.19e-08           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.875785644247       residual = 1.50e-08           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.875785639906       residual = 7.97e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         17 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 9.7656e-01 is 3.935208e-04

solving harmonic davidson linear method for identity shift 3.9062e+00, overlap shift 3.9062e+01 and omega -1.7527e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.875505755518       residual = 5.43e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.875561533960       residual = 1.05e-02           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.875573224276       residual = 2.14e-03           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.875577028916       residual = 6.40e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.875578237515       residual = 2.57e-04           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.875579021146       residual = 9.47e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.875579213467       residual = 2.15e-05           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.875579202523       residual = 7.93e-06           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.875579232162       residual = 3.63e-06           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.875579227619       residual = 1.63e-06           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.875579224490       residual = 8.23e-07           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.875579235212       residual = 3.55e-07           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.875579237030       residual = 4.75e-07           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.875579239509       residual = 3.90e-07           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.875579238064       residual = 1.75e-07           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.875579243507       residual = 3.00e-08           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.875579243982       residual = 1.13e-08           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.875579242984       residual = 5.63e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         17 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 3.9062e+00 is 1.010796e-04

solving harmonic davidson linear method for identity shift 1.5625e+01, overlap shift 1.5625e+02 and omega -1.7527e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.875505755518       residual = 5.43e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.875519896569       residual = 1.05e-02           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.875522851227       residual = 2.12e-03           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.875523807767       residual = 6.34e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.875524111126       residual = 2.53e-04           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.875524306791       residual = 9.26e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.875524354323       residual = 2.09e-05           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.875524351516       residual = 7.56e-06           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.875524358912       residual = 3.38e-06           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.875524357543       residual = 1.59e-06           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.875524356888       residual = 7.97e-07           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.875524359532       residual = 3.44e-07           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.875524359983       residual = 4.63e-07           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.875524360586       residual = 3.72e-07           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.875524360241       residual = 1.62e-07           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.875524361560       residual = 2.74e-08           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.875524361670       residual = 1.05e-08           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.875524361426       residual = 5.13e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         17 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 1.5625e+01 is 2.544448e-05

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.611813 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 75 and numParams is: 74

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.6935e+01
  </log>
  <optVariables href="H2O.s037.opt.xml">
ci_0001                 7.007822e-01 3 1  ON 0
ci_0002                 6.982268e-01 3 1  ON 1
ci_0003                -3.445720e-02 3 1  ON 2
ci_0004                -3.450564e-02 3 1  ON 3
ci_0005                -3.216770e-02 3 1  ON 4
ci_0006                -3.279616e-02 3 1  ON 5
ci_0007                -2.082952e-02 3 1  ON 6
ci_0008                -2.146509e-02 3 1  ON 7
ci_0009                -2.124170e-02 3 1  ON 8
ci_0010                -2.152612e-02 3 1  ON 9
ci_0011                -1.770392e-02 3 1  ON 10
ci_0012                -1.763055e-02 3 1  ON 11
ci_0013                 1.771883e-02 3 1  ON 12
ci_0014                 1.763609e-02 3 1  ON 13
ci_0015                 1.806611e-02 3 1  ON 14
ci_0016                 1.798881e-02 3 1  ON 15
ci_0017                 1.573518e-02 3 1  ON 16
ci_0018                 1.606406e-02 3 1  ON 17
ci_0019                 1.390351e-02 3 1  ON 18
ci_0020                 1.354838e-02 3 1  ON 19
ci_0021                 1.663220e-02 3 1  ON 20
ci_0022                 1.744274e-02 3 1  ON 21
ci_0023                -1.279804e-02 3 1  ON 22
ci_0024                -1.241935e-02 3 1  ON 23
ci_0025                -5.205415e-03 3 1  ON 24
ci_0026                -4.947821e-03 3 1  ON 25
ci_0027                -1.265994e-02 3 1  ON 26
ci_0028                -1.250078e-02 3 1  ON 27
ci_0029                -1.110306e-02 3 1  ON 28
ci_0030                -1.117056e-02 3 1  ON 29
ci_0031                 1.454836e-02 3 1  ON 30
ci_0032                 1.448316e-02 3 1  ON 31
ci_0033                 1.013593e-02 3 1  ON 32
ci_0034                 1.005193e-02 3 1  ON 33
ci_0035                 6.529771e-03 3 1  ON 34
ci_0036                 6.684370e-03 3 1  ON 35
ci_0037                -1.206959e-02 3 1  ON 36
ci_0038                -1.212378e-02 3 1  ON 37
ci_0039                -5.653356e-03 3 1  ON 38
ci_0040                -5.587582e-03 3 1  ON 39
ci_0041                 1.059745e-02 3 1  ON 40
ci_0042                 1.097032e-02 3 1  ON 41
ci_0043                -7.460369e-03 3 1  ON 42
ci_0044                -8.371014e-03 3 1  ON 43
ci_0045                 1.100792e-02 3 1  ON 44
ci_0046                 1.055404e-02 3 1  ON 45
ci_0047                -5.086790e-03 3 1  ON 46
ci_0048                -5.148681e-03 3 1  ON 47
ci_0049                -3.990101e-03 3 1  ON 48
ci_0050                -4.258414e-03 3 1  ON 49
ci_0051                -3.107795e-03 3 1  ON 50
ci_0052                -3.185581e-03 3 1  ON 51
ci_0053                -4.457700e-03 3 1  ON 52
ci_0054                -4.782132e-03 3 1  ON 53
ci_0055                 3.775945e-03 3 1  ON 54
ci_0056                 3.116049e-03 3 1  ON 55
ci_0057                 3.648438e-03 3 1  ON 56
ci_0058                 4.140766e-03 3 1  ON 57
ci_0059                -4.853509e-03 3 1  ON 58
ci_0060                -4.724146e-03 3 1  ON 59
ci_0061                -4.689392e-03 3 1  ON 60
ci_0062                -4.580251e-03 3 1  ON 61
ci_0063                -9.964604e-03 3 1  ON 62
ci_0064                -9.740199e-03 3 1  ON 63
ci_0065                -7.670951e-03 3 1  ON 64
ci_0066                -7.694760e-03 3 1  ON 65
ci_0067                -4.931651e-03 3 1  ON 66
ci_0068                -5.183043e-03 3 1  ON 67
ci_0069                 4.785694e-03 3 1  ON 68
ci_0070                 4.341161e-03 3 1  ON 69
ci_0071                 4.616444e-03 3 1  ON 70
ci_0072                 5.385838e-03 3 1  ON 71
ci_0073                 4.327223e-03 3 1  ON 72
ci_0074                 4.469014e-03 3 1  ON 73
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 37
    time step          = 0.05
    reference energy   = -16.9014
    reference variance = 0.151482
====================================================
  Execution time = 1.4590e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s037
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6904e+01
  VMC Evar = 3.2269e-01
  Total weights = 1.9516e+06
  Execution time = 1.9036e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.308819894955
                                         uncertainty =       0.001896585549

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.308819894955
                                         uncertainty =       0.001896585549

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000392902186
  error estimate for blocks of size 2^( 2) =       0.000406967364
  error estimate for blocks of size 2^( 3) =       0.000421825393
  error estimate for blocks of size 2^( 4) =       0.000435614915
  error estimate for blocks of size 2^( 5) =       0.000446225596
  error estimate for blocks of size 2^( 6) =       0.000452934593
  error estimate for blocks of size 2^( 7) =       0.000458089756

      target function =      -0.870440589785
              le_mean =     -16.903638583683
             les_mean =     286.060576536763
             stat err =       0.000448216215
             autocorr =       1.301386318689
   target nu stat err =       0.000448216215
   target dn stat err =       0.004946314881
      target stat err =       0.006049514513
              std dev =       0.555647600550
             le_variance =       0.308744255997

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.308435967285
                                         uncertainty =       0.001893650798

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.308435967285
                                         uncertainty =       0.001893650798

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000392657943
  error estimate for blocks of size 2^( 2) =       0.000406747908
  error estimate for blocks of size 2^( 3) =       0.000421634296
  error estimate for blocks of size 2^( 4) =       0.000435450218
  error estimate for blocks of size 2^( 5) =       0.000446086953
  error estimate for blocks of size 2^( 6) =       0.000452815495
  error estimate for blocks of size 2^( 7) =       0.000457974818

      target function =      -0.870902753187
              le_mean =     -16.903632429438
             les_mean =     286.059976214268
             stat err =       0.000448081871
             autocorr =       1.302224826021
   target nu stat err =       0.000448081871
   target dn stat err =       0.005738018824
      target stat err =       0.007015569273
              std dev =       0.555302188895
             le_variance =       0.308360520992

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.308607161908
                                         uncertainty =       0.001893491687

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.308607161908
                                         uncertainty =       0.001893491687

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000392766870
  error estimate for blocks of size 2^( 2) =       0.000406845121
  error estimate for blocks of size 2^( 3) =       0.000421720244
  error estimate for blocks of size 2^( 4) =       0.000435522993
  error estimate for blocks of size 2^( 5) =       0.000446148234
  error estimate for blocks of size 2^( 6) =       0.000452868832
  error estimate for blocks of size 2^( 7) =       0.000458023273

      target function =      -0.807439105534
              le_mean =     -16.903632645239
             les_mean =     286.112034494994
             stat err =       0.000448140833
             autocorr =       1.301845174916
   target nu stat err =       0.000448140833
   target dn stat err =       0.056855211522
      target stat err =       0.059838679726
              std dev =       0.555456234945
             le_variance =       0.308531628940

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.308790302380
                                         uncertainty =       0.001895838274

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.308790302380
                                         uncertainty =       0.001895838274

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000392883369
  error estimate for blocks of size 2^( 2) =       0.000406950616
  error estimate for blocks of size 2^( 3) =       0.000421810530
  error estimate for blocks of size 2^( 4) =       0.000435601957
  error estimate for blocks of size 2^( 5) =       0.000446214714
  error estimate for blocks of size 2^( 6) =       0.000452924951
  error estimate for blocks of size 2^( 7) =       0.000458077724

      target function =      -0.870962760242
              le_mean =     -16.903637468723
             les_mean =     286.060104208765
             stat err =       0.000448204836
             autocorr =       1.301444904405
   target nu stat err =       0.000448204836
   target dn stat err =       0.005320918471
      target stat err =       0.006510732193
              std dev =       0.555620988267
             le_variance =       0.308714682602


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.870440589785        initial
     9.7656e-01     9.7656e+00             3.9352e-04        -0.870902753187
     3.9062e+00     3.9062e+01             1.0108e-04        -0.807439105534
     1.5625e+01     1.5625e+02             2.5444e-05        -0.870962760242  <--

*****************************************************************************
Applying the update for shift_i =   1.5625e+01     and shift_s =   1.5625e+02
*****************************************************************************

  Execution time = 2.4194e+01
  </log>
  <optVariables href="H2O.s037.opt.xml">
ci_0001                 7.007525e-01 3 1  ON 0
ci_0002                 6.982227e-01 3 1  ON 1
ci_0003                -3.451009e-02 3 1  ON 2
ci_0004                -3.457065e-02 3 1  ON 3
ci_0005                -3.224251e-02 3 1  ON 4
ci_0006                -3.284417e-02 3 1  ON 5
ci_0007                -2.090515e-02 3 1  ON 6
ci_0008                -2.151882e-02 3 1  ON 7
ci_0009                -2.126025e-02 3 1  ON 8
ci_0010                -2.156175e-02 3 1  ON 9
ci_0011                -1.774850e-02 3 1  ON 10
ci_0012                -1.765746e-02 3 1  ON 11
ci_0013                 1.774612e-02 3 1  ON 12
ci_0014                 1.766633e-02 3 1  ON 13
ci_0015                 1.809276e-02 3 1  ON 14
ci_0016                 1.802633e-02 3 1  ON 15
ci_0017                 1.575649e-02 3 1  ON 16
ci_0018                 1.609942e-02 3 1  ON 17
ci_0019                 1.392198e-02 3 1  ON 18
ci_0020                 1.356629e-02 3 1  ON 19
ci_0021                 1.665373e-02 3 1  ON 20
ci_0022                 1.745293e-02 3 1  ON 21
ci_0023                -1.281889e-02 3 1  ON 22
ci_0024                -1.242994e-02 3 1  ON 23
ci_0025                -5.265956e-03 3 1  ON 24
ci_0026                -4.993081e-03 3 1  ON 25
ci_0027                -1.267376e-02 3 1  ON 26
ci_0028                -1.252176e-02 3 1  ON 27
ci_0029                -1.110710e-02 3 1  ON 28
ci_0030                -1.118077e-02 3 1  ON 29
ci_0031                 1.454695e-02 3 1  ON 30
ci_0032                 1.450366e-02 3 1  ON 31
ci_0033                 1.015556e-02 3 1  ON 32
ci_0034                 1.008803e-02 3 1  ON 33
ci_0035                 6.565304e-03 3 1  ON 34
ci_0036                 6.727740e-03 3 1  ON 35
ci_0037                -1.206935e-02 3 1  ON 36
ci_0038                -1.213718e-02 3 1  ON 37
ci_0039                -5.683996e-03 3 1  ON 38
ci_0040                -5.609937e-03 3 1  ON 39
ci_0041                 1.061021e-02 3 1  ON 40
ci_0042                 1.098006e-02 3 1  ON 41
ci_0043                -7.483738e-03 3 1  ON 42
ci_0044                -8.376977e-03 3 1  ON 43
ci_0045                 1.101743e-02 3 1  ON 44
ci_0046                 1.056623e-02 3 1  ON 45
ci_0047                -5.113849e-03 3 1  ON 46
ci_0048                -5.172008e-03 3 1  ON 47
ci_0049                -4.034254e-03 3 1  ON 48
ci_0050                -4.277441e-03 3 1  ON 49
ci_0051                -3.143046e-03 3 1  ON 50
ci_0052                -3.209416e-03 3 1  ON 51
ci_0053                -4.472486e-03 3 1  ON 52
ci_0054                -4.797144e-03 3 1  ON 53
ci_0055                 3.798376e-03 3 1  ON 54
ci_0056                 3.126081e-03 3 1  ON 55
ci_0057                 3.656733e-03 3 1  ON 56
ci_0058                 4.160904e-03 3 1  ON 57
ci_0059                -4.873453e-03 3 1  ON 58
ci_0060                -4.739635e-03 3 1  ON 59
ci_0061                -4.700684e-03 3 1  ON 60
ci_0062                -4.596661e-03 3 1  ON 61
ci_0063                -9.964850e-03 3 1  ON 62
ci_0064                -9.761148e-03 3 1  ON 63
ci_0065                -7.675315e-03 3 1  ON 64
ci_0066                -7.716642e-03 3 1  ON 65
ci_0067                -4.918877e-03 3 1  ON 66
ci_0068                -5.205396e-03 3 1  ON 67
ci_0069                 4.805263e-03 3 1  ON 68
ci_0070                 4.360874e-03 3 1  ON 69
ci_0071                 4.617087e-03 3 1  ON 70
ci_0072                 5.399850e-03 3 1  ON 71
ci_0073                 4.339258e-03 3 1  ON 72
ci_0074                 4.488645e-03 3 1  ON 73
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 4.1135e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s038 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s038 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=38  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6897e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 38
    time step          = 0.05
    reference energy   = -16.8881
    reference variance = 0.196451
====================================================
  Execution time = 1.4710e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s038
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5237e+04
  VMC Eavg = -1.6904e+01
  VMC Evar = 3.1415e-01
  Total weights = 1.951658190e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 2.5819e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.304468440675
                                         uncertainty =       0.002159673661

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.304468440675
                                         uncertainty =       0.002159673661

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000390139458
  error estimate for blocks of size 2^( 2) =       0.000404534898
  error estimate for blocks of size 2^( 3) =       0.000419324221
  error estimate for blocks of size 2^( 4) =       0.000433039822
  error estimate for blocks of size 2^( 5) =       0.000444740376
  error estimate for blocks of size 2^( 6) =       0.000452059887
  error estimate for blocks of size 2^( 7) =       0.000458267878

      target function =      -0.887164417251
              le_mean =     -16.903895130784
             les_mean =     286.055816715255
             stat err =       0.000447026991
             autocorr =       1.312888182390
   target nu stat err =       0.000447026991
   target dn stat err =       0.002370464999
      target stat err =       0.003063524433
              std dev =       0.551740512702
             le_variance =       0.304417593356


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690389513078e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 74
Check correct_vf_var_size: 225, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 3.9062e+00, overlap shift 3.9062e+01 and omega -1.7527e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.887173917266       residual = 5.33e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.887232477166       residual = 7.70e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.887241629049       residual = 1.98e-03           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.887244190521       residual = 6.72e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.887245475247       residual = 2.91e-04           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.887245861801       residual = 1.28e-04           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.887246027770       residual = 3.29e-05           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.887246089655       residual = 1.58e-05           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.887246095395       residual = 6.26e-06           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.887246104939       residual = 3.15e-06           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.887246136196       residual = 2.00e-06           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.887246131588       residual = 1.55e-06           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.887246146796       residual = 1.67e-06           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.887246158379       residual = 7.17e-07           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.887246164958       residual = 2.65e-07           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.887246164006       residual = 3.88e-08           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.887246164691       residual = 1.11e-08           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.887246164066       residual = 4.55e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         17 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 3.9062e+00 is 9.181159e-05

solving harmonic davidson linear method for identity shift 1.5625e+01, overlap shift 1.5625e+02 and omega -1.7527e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.887173917266       residual = 5.33e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.887188763140       residual = 7.68e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.887191075843       residual = 1.96e-03           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.887191720039       residual = 6.65e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.887192042743       residual = 2.87e-04           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.887192138688       residual = 1.25e-04           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.887192179873       residual = 3.21e-05           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.887192195264       residual = 1.54e-05           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.887192196615       residual = 6.09e-06           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.887192198983       residual = 3.07e-06           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.887192206778       residual = 1.95e-06           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.887192205609       residual = 1.51e-06           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.887192209428       residual = 1.61e-06           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.887192212233       residual = 6.73e-07           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.887192213813       residual = 2.44e-07           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.887192213574       residual = 3.55e-08           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.887192213733       residual = 1.03e-08           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.887192213580       residual = 4.19e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         17 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 1.5625e+01 is 2.315088e-05

solving harmonic davidson linear method for identity shift 6.2500e+01, overlap shift 6.2500e+02 and omega -1.7527e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.887173917266       residual = 5.33e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.887177641829       residual = 7.67e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.887178221570       residual = 1.96e-03           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.887178382858       residual = 6.63e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.887178463629       residual = 2.86e-04           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.887178487570       residual = 1.25e-04           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.887178497847       residual = 3.19e-05           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.887178501689       residual = 1.53e-05           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.887178502022       residual = 6.05e-06           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.887178502613       residual = 3.05e-06           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.887178504560       residual = 1.94e-06           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.887178504267       residual = 1.50e-06           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.887178505223       residual = 1.60e-06           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.887178505918       residual = 6.62e-07           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.887178506309       residual = 2.39e-07           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.887178506249       residual = 3.47e-08           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.887178506288       residual = 1.01e-08           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.887178506250       residual = 4.10e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         17 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 6.2500e+01 is 5.800229e-06

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.621930 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 75 and numParams is: 74

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.7307e+01
  </log>
  <optVariables href="H2O.s038.opt.xml">
ci_0001                 7.007663e-01 3 1  ON 0
ci_0002                 6.982203e-01 3 1  ON 1
ci_0003                -3.449482e-02 3 1  ON 2
ci_0004                -3.455624e-02 3 1  ON 3
ci_0005                -3.222433e-02 3 1  ON 4
ci_0006                -3.282102e-02 3 1  ON 5
ci_0007                -2.088573e-02 3 1  ON 6
ci_0008                -2.149996e-02 3 1  ON 7
ci_0009                -2.124818e-02 3 1  ON 8
ci_0010                -2.154814e-02 3 1  ON 9
ci_0011                -1.773641e-02 3 1  ON 10
ci_0012                -1.764358e-02 3 1  ON 11
ci_0013                 1.773483e-02 3 1  ON 12
ci_0014                 1.765585e-02 3 1  ON 13
ci_0015                 1.808587e-02 3 1  ON 14
ci_0016                 1.801850e-02 3 1  ON 15
ci_0017                 1.575037e-02 3 1  ON 16
ci_0018                 1.608752e-02 3 1  ON 17
ci_0019                 1.391595e-02 3 1  ON 18
ci_0020                 1.355885e-02 3 1  ON 19
ci_0021                 1.665026e-02 3 1  ON 20
ci_0022                 1.744828e-02 3 1  ON 21
ci_0023                -1.281622e-02 3 1  ON 22
ci_0024                -1.242267e-02 3 1  ON 23
ci_0025                -5.248255e-03 3 1  ON 24
ci_0026                -4.976121e-03 3 1  ON 25
ci_0027                -1.266635e-02 3 1  ON 26
ci_0028                -1.251876e-02 3 1  ON 27
ci_0029                -1.109819e-02 3 1  ON 28
ci_0030                -1.117174e-02 3 1  ON 29
ci_0031                 1.454312e-02 3 1  ON 30
ci_0032                 1.449828e-02 3 1  ON 31
ci_0033                 1.014863e-02 3 1  ON 32
ci_0034                 1.007890e-02 3 1  ON 33
ci_0035                 6.554416e-03 3 1  ON 34
ci_0036                 6.719116e-03 3 1  ON 35
ci_0037                -1.206655e-02 3 1  ON 36
ci_0038                -1.212965e-02 3 1  ON 37
ci_0039                -5.674534e-03 3 1  ON 38
ci_0040                -5.599480e-03 3 1  ON 39
ci_0041                 1.060550e-02 3 1  ON 40
ci_0042                 1.097205e-02 3 1  ON 41
ci_0043                -7.473638e-03 3 1  ON 42
ci_0044                -8.376097e-03 3 1  ON 43
ci_0045                 1.101165e-02 3 1  ON 44
ci_0046                 1.056281e-02 3 1  ON 45
ci_0047                -5.104956e-03 3 1  ON 46
ci_0048                -5.160047e-03 3 1  ON 47
ci_0049                -4.027086e-03 3 1  ON 48
ci_0050                -4.273742e-03 3 1  ON 49
ci_0051                -3.138805e-03 3 1  ON 50
ci_0052                -3.203805e-03 3 1  ON 51
ci_0053                -4.472163e-03 3 1  ON 52
ci_0054                -4.785337e-03 3 1  ON 53
ci_0055                 3.781882e-03 3 1  ON 54
ci_0056                 3.114401e-03 3 1  ON 55
ci_0057                 3.652077e-03 3 1  ON 56
ci_0058                 4.154534e-03 3 1  ON 57
ci_0059                -4.868769e-03 3 1  ON 58
ci_0060                -4.735066e-03 3 1  ON 59
ci_0061                -4.692593e-03 3 1  ON 60
ci_0062                -4.591563e-03 3 1  ON 61
ci_0063                -9.960286e-03 3 1  ON 62
ci_0064                -9.760578e-03 3 1  ON 63
ci_0065                -7.668670e-03 3 1  ON 64
ci_0066                -7.709814e-03 3 1  ON 65
ci_0067                -4.911152e-03 3 1  ON 66
ci_0068                -5.199544e-03 3 1  ON 67
ci_0069                 4.790915e-03 3 1  ON 68
ci_0070                 4.356341e-03 3 1  ON 69
ci_0071                 4.621525e-03 3 1  ON 70
ci_0072                 5.397203e-03 3 1  ON 71
ci_0073                 4.334522e-03 3 1  ON 72
ci_0074                 4.480529e-03 3 1  ON 73
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 38
    time step          = 0.05
    reference energy   = -16.8798
    reference variance = 0.188021
====================================================
  Execution time = 1.6241e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s038
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6904e+01
  VMC Evar = 3.1654e-01
  Total weights = 1.9513e+06
  Execution time = 1.8914e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.303923339468
                                         uncertainty =       0.001954975533

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.303923339468
                                         uncertainty =       0.001954975533

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000389777068
  error estimate for blocks of size 2^( 2) =       0.000404308718
  error estimate for blocks of size 2^( 3) =       0.000418604926
  error estimate for blocks of size 2^( 4) =       0.000431962741
  error estimate for blocks of size 2^( 5) =       0.000442875451
  error estimate for blocks of size 2^( 6) =       0.000450930787
  error estimate for blocks of size 2^( 7) =       0.000456644007

      target function =      -0.879021747514
              le_mean =     -16.903743993744
             les_mean =     286.057165637793
             stat err =       0.000445603247
             autocorr =       1.306965503628
   target nu stat err =       0.000445603247
   target dn stat err =       0.004929875742
      target stat err =       0.006149118592
              std dev =       0.551228015306
             le_variance =       0.303852324858

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.303826601997
                                         uncertainty =       0.001953474589

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.303826601997
                                         uncertainty =       0.001953474589

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000389714968
  error estimate for blocks of size 2^( 2) =       0.000404253047
  error estimate for blocks of size 2^( 3) =       0.000418556934
  error estimate for blocks of size 2^( 4) =       0.000431923230
  error estimate for blocks of size 2^( 5) =       0.000442837834
  error estimate for blocks of size 2^( 6) =       0.000450891830
  error estimate for blocks of size 2^( 7) =       0.000456605502

      target function =      -0.883321315015
              le_mean =     -16.903743744125
             les_mean =     286.053728394418
             stat err =       0.000445564599
             autocorr =       1.307155280772
   target nu stat err =       0.000445564599
   target dn stat err =       0.003204276051
      target stat err =       0.004064099931
              std dev =       0.551140193871
             le_variance =       0.303755513300

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.303873886084
                                         uncertainty =       0.001954202012

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.303873886084
                                         uncertainty =       0.001954202012

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000389745322
  error estimate for blocks of size 2^( 2) =       0.000404280234
  error estimate for blocks of size 2^( 3) =       0.000418580311
  error estimate for blocks of size 2^( 4) =       0.000431942403
  error estimate for blocks of size 2^( 5) =       0.000442856050
  error estimate for blocks of size 2^( 6) =       0.000450910647
  error estimate for blocks of size 2^( 7) =       0.000456624187

      target function =      -0.883950225522
              le_mean =     -16.903743878780
             les_mean =     286.053234169737
             stat err =       0.000445583322
             autocorr =       1.307061524850
   target nu stat err =       0.000445583322
   target dn stat err =       0.002875748481
      target stat err =       0.003663176588
              std dev =       0.551183120939
             le_variance =       0.303802832808

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.303917077155
                                         uncertainty =       0.001954875970

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.303917077155
                                         uncertainty =       0.001954875970

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000389773048
  error estimate for blocks of size 2^( 2) =       0.000404305130
  error estimate for blocks of size 2^( 3) =       0.000418601788
  error estimate for blocks of size 2^( 4) =       0.000431960129
  error estimate for blocks of size 2^( 5) =       0.000442872881
  error estimate for blocks of size 2^( 6) =       0.000450927897
  error estimate for blocks of size 2^( 7) =       0.000456641449

      target function =      -0.883470138812
              le_mean =     -16.903744094240
             les_mean =     286.053625043802
             stat err =       0.000445600589
             autocorr =       1.306976871797
   target nu stat err =       0.000445600589
   target dn stat err =       0.002786718579
      target stat err =       0.003549406336
              std dev =       0.551222330555
             le_variance =       0.303846057703


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.879021747514        initial
     3.9062e+00     3.9062e+01             9.1812e-05        -0.883321315015
     1.5625e+01     1.5625e+02             2.3151e-05        -0.883950225522  <--
     6.2500e+01     6.2500e+02             5.8002e-06        -0.883470138812

*****************************************************************************
Applying the update for shift_i =   1.5625e+01     and shift_s =   1.5625e+02
*****************************************************************************

  Execution time = 2.5884e+01
  </log>
  <optVariables href="H2O.s038.opt.xml">
ci_0001                 7.007663e-01 3 1  ON 0
ci_0002                 6.982203e-01 3 1  ON 1
ci_0003                -3.449482e-02 3 1  ON 2
ci_0004                -3.455624e-02 3 1  ON 3
ci_0005                -3.222433e-02 3 1  ON 4
ci_0006                -3.282102e-02 3 1  ON 5
ci_0007                -2.088573e-02 3 1  ON 6
ci_0008                -2.149996e-02 3 1  ON 7
ci_0009                -2.124818e-02 3 1  ON 8
ci_0010                -2.154814e-02 3 1  ON 9
ci_0011                -1.773641e-02 3 1  ON 10
ci_0012                -1.764358e-02 3 1  ON 11
ci_0013                 1.773483e-02 3 1  ON 12
ci_0014                 1.765585e-02 3 1  ON 13
ci_0015                 1.808587e-02 3 1  ON 14
ci_0016                 1.801850e-02 3 1  ON 15
ci_0017                 1.575037e-02 3 1  ON 16
ci_0018                 1.608752e-02 3 1  ON 17
ci_0019                 1.391595e-02 3 1  ON 18
ci_0020                 1.355885e-02 3 1  ON 19
ci_0021                 1.665026e-02 3 1  ON 20
ci_0022                 1.744828e-02 3 1  ON 21
ci_0023                -1.281622e-02 3 1  ON 22
ci_0024                -1.242267e-02 3 1  ON 23
ci_0025                -5.248255e-03 3 1  ON 24
ci_0026                -4.976121e-03 3 1  ON 25
ci_0027                -1.266635e-02 3 1  ON 26
ci_0028                -1.251876e-02 3 1  ON 27
ci_0029                -1.109819e-02 3 1  ON 28
ci_0030                -1.117174e-02 3 1  ON 29
ci_0031                 1.454312e-02 3 1  ON 30
ci_0032                 1.449828e-02 3 1  ON 31
ci_0033                 1.014863e-02 3 1  ON 32
ci_0034                 1.007890e-02 3 1  ON 33
ci_0035                 6.554416e-03 3 1  ON 34
ci_0036                 6.719116e-03 3 1  ON 35
ci_0037                -1.206655e-02 3 1  ON 36
ci_0038                -1.212965e-02 3 1  ON 37
ci_0039                -5.674534e-03 3 1  ON 38
ci_0040                -5.599480e-03 3 1  ON 39
ci_0041                 1.060550e-02 3 1  ON 40
ci_0042                 1.097205e-02 3 1  ON 41
ci_0043                -7.473638e-03 3 1  ON 42
ci_0044                -8.376097e-03 3 1  ON 43
ci_0045                 1.101165e-02 3 1  ON 44
ci_0046                 1.056281e-02 3 1  ON 45
ci_0047                -5.104956e-03 3 1  ON 46
ci_0048                -5.160047e-03 3 1  ON 47
ci_0049                -4.027086e-03 3 1  ON 48
ci_0050                -4.273742e-03 3 1  ON 49
ci_0051                -3.138805e-03 3 1  ON 50
ci_0052                -3.203805e-03 3 1  ON 51
ci_0053                -4.472163e-03 3 1  ON 52
ci_0054                -4.785337e-03 3 1  ON 53
ci_0055                 3.781882e-03 3 1  ON 54
ci_0056                 3.114401e-03 3 1  ON 55
ci_0057                 3.652077e-03 3 1  ON 56
ci_0058                 4.154534e-03 3 1  ON 57
ci_0059                -4.868769e-03 3 1  ON 58
ci_0060                -4.735066e-03 3 1  ON 59
ci_0061                -4.692593e-03 3 1  ON 60
ci_0062                -4.591563e-03 3 1  ON 61
ci_0063                -9.960286e-03 3 1  ON 62
ci_0064                -9.760578e-03 3 1  ON 63
ci_0065                -7.668670e-03 3 1  ON 64
ci_0066                -7.709814e-03 3 1  ON 65
ci_0067                -4.911152e-03 3 1  ON 66
ci_0068                -5.199544e-03 3 1  ON 67
ci_0069                 4.790915e-03 3 1  ON 68
ci_0070                 4.356341e-03 3 1  ON 69
ci_0071                 4.621525e-03 3 1  ON 70
ci_0072                 5.397203e-03 3 1  ON 71
ci_0073                 4.334522e-03 3 1  ON 72
ci_0074                 4.480529e-03 3 1  ON 73
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 4.3197e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s039 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s039 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=39  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6897e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 39
    time step          = 0.05
    reference energy   = -16.897
    reference variance = 0.191991
====================================================
  Execution time = 1.4705e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s039
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5225e+04
  VMC Eavg = -1.6903e+01
  VMC Evar = 3.1372e-01
  Total weights = 1.951499218e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 2.5586e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.302269632996
                                         uncertainty =       0.001707767162

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.302269632996
                                         uncertainty =       0.001707767162

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000388757963
  error estimate for blocks of size 2^( 2) =       0.000403271392
  error estimate for blocks of size 2^( 3) =       0.000418383738
  error estimate for blocks of size 2^( 4) =       0.000431996303
  error estimate for blocks of size 2^( 5) =       0.000444976509
  error estimate for blocks of size 2^( 6) =       0.000454777652
  error estimate for blocks of size 2^( 7) =       0.000461732011

      target function =      -0.887520500872
              le_mean =     -16.902650884118
             les_mean =     286.013322952486
             stat err =       0.000448370619
             autocorr =       1.330196183743
   target nu stat err =       0.000448370619
   target dn stat err =       0.002313730765
      target stat err =       0.002990188880
              std dev =       0.549786783230
             le_variance =       0.302265507014


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690265088412e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 74
Check correct_vf_var_size: 225, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 3.9062e+00, overlap shift 3.9062e+01 and omega -1.7527e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.887529376526       residual = 3.69e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.887571236543       residual = 6.49e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.887578842054       residual = 2.02e-03           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.887581543128       residual = 4.56e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.887582521853       residual = 2.33e-04           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.887582924969       residual = 1.01e-04           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.887583026838       residual = 3.74e-05           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.887583095746       residual = 1.41e-05           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.887583153009       residual = 8.26e-06           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.887583204366       residual = 6.45e-06           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.887583205286       residual = 5.32e-06           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.887583238758       residual = 3.32e-06           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.887583258802       residual = 2.72e-06           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.887583270659       residual = 7.28e-07           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.887583269608       residual = 2.15e-07           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.887583266770       residual = 2.68e-08           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.887583266890       residual = 8.21e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         16 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 3.9062e+00 is 8.739164e-05

solving harmonic davidson linear method for identity shift 1.5625e+01, overlap shift 1.5625e+02 and omega -1.7527e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.887529376526       residual = 3.69e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.887539988300       residual = 6.47e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.887541910088       residual = 2.01e-03           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.887542589487       residual = 4.52e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.887542835319       residual = 2.30e-04           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.887542935708       residual = 9.83e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.887542960965       residual = 3.65e-05           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.887542978081       residual = 1.37e-05           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.887542992359       residual = 8.08e-06           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.887543005158       residual = 6.32e-06           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.887543005328       residual = 5.17e-06           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.887543013628       residual = 3.21e-06           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.887543018500       residual = 2.57e-06           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.887543021346       residual = 6.77e-07           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.887543021056       residual = 1.97e-07           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.887543020359       residual = 2.45e-08           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.887543020389       residual = 7.58e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         16 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 1.5625e+01 is 2.203826e-05

solving harmonic davidson linear method for identity shift 6.2500e+01, overlap shift 6.2500e+02 and omega -1.7527e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.887529376526       residual = 3.69e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.887532038804       residual = 6.46e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.887532520542       residual = 2.00e-03           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.887532690650       residual = 4.50e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.887532752180       residual = 2.29e-04           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.887532777251       residual = 9.78e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.887532783552       residual = 3.63e-05           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.887532787824       residual = 1.37e-05           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.887532791391       residual = 8.04e-06           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.887532794588       residual = 6.29e-06           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.887532794627       residual = 5.13e-06           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.887532796698       residual = 3.18e-06           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.887532797907       residual = 2.53e-06           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.887532798611       residual = 6.64e-07           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.887532798537       residual = 1.93e-07           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.887532798364       residual = 2.39e-08           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.887532798371       residual = 7.43e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         16 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 6.2500e+01 is 5.521596e-06

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.631010 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 75 and numParams is: 74

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.7278e+01
  </log>
  <optVariables href="H2O.s039.opt.xml">
ci_0001                 7.007837e-01 3 1  ON 0
ci_0002                 6.982129e-01 3 1  ON 1
ci_0003                -3.448501e-02 3 1  ON 2
ci_0004                -3.453731e-02 3 1  ON 3
ci_0005                -3.220778e-02 3 1  ON 4
ci_0006                -3.279898e-02 3 1  ON 5
ci_0007                -2.086623e-02 3 1  ON 6
ci_0008                -2.148628e-02 3 1  ON 7
ci_0009                -2.123624e-02 3 1  ON 8
ci_0010                -2.153736e-02 3 1  ON 9
ci_0011                -1.772822e-02 3 1  ON 10
ci_0012                -1.763099e-02 3 1  ON 11
ci_0013                 1.771983e-02 3 1  ON 12
ci_0014                 1.764791e-02 3 1  ON 13
ci_0015                 1.807557e-02 3 1  ON 14
ci_0016                 1.800546e-02 3 1  ON 15
ci_0017                 1.574425e-02 3 1  ON 16
ci_0018                 1.607479e-02 3 1  ON 17
ci_0019                 1.390972e-02 3 1  ON 18
ci_0020                 1.355430e-02 3 1  ON 19
ci_0021                 1.664704e-02 3 1  ON 20
ci_0022                 1.744221e-02 3 1  ON 21
ci_0023                -1.281138e-02 3 1  ON 22
ci_0024                -1.241497e-02 3 1  ON 23
ci_0025                -5.240133e-03 3 1  ON 24
ci_0026                -4.964022e-03 3 1  ON 25
ci_0027                -1.265901e-02 3 1  ON 26
ci_0028                -1.251153e-02 3 1  ON 27
ci_0029                -1.109531e-02 3 1  ON 28
ci_0030                -1.116446e-02 3 1  ON 29
ci_0031                 1.454220e-02 3 1  ON 30
ci_0032                 1.449722e-02 3 1  ON 31
ci_0033                 1.013959e-02 3 1  ON 32
ci_0034                 1.007260e-02 3 1  ON 33
ci_0035                 6.549638e-03 3 1  ON 34
ci_0036                 6.708920e-03 3 1  ON 35
ci_0037                -1.206325e-02 3 1  ON 36
ci_0038                -1.212668e-02 3 1  ON 37
ci_0039                -5.662755e-03 3 1  ON 38
ci_0040                -5.589861e-03 3 1  ON 39
ci_0041                 1.060436e-02 3 1  ON 40
ci_0042                 1.096549e-02 3 1  ON 41
ci_0043                -7.470479e-03 3 1  ON 42
ci_0044                -8.371789e-03 3 1  ON 43
ci_0045                 1.100926e-02 3 1  ON 44
ci_0046                 1.055931e-02 3 1  ON 45
ci_0047                -5.095424e-03 3 1  ON 46
ci_0048                -5.150691e-03 3 1  ON 47
ci_0049                -4.023631e-03 3 1  ON 48
ci_0050                -4.270920e-03 3 1  ON 49
ci_0051                -3.133869e-03 3 1  ON 50
ci_0052                -3.197654e-03 3 1  ON 51
ci_0053                -4.468895e-03 3 1  ON 52
ci_0054                -4.782809e-03 3 1  ON 53
ci_0055                 3.769997e-03 3 1  ON 54
ci_0056                 3.119340e-03 3 1  ON 55
ci_0057                 3.646261e-03 3 1  ON 56
ci_0058                 4.148417e-03 3 1  ON 57
ci_0059                -4.864972e-03 3 1  ON 58
ci_0060                -4.726889e-03 3 1  ON 59
ci_0061                -4.684984e-03 3 1  ON 60
ci_0062                -4.585640e-03 3 1  ON 61
ci_0063                -9.960468e-03 3 1  ON 62
ci_0064                -9.761061e-03 3 1  ON 63
ci_0065                -7.664506e-03 3 1  ON 64
ci_0066                -7.707712e-03 3 1  ON 65
ci_0067                -4.906815e-03 3 1  ON 66
ci_0068                -5.190112e-03 3 1  ON 67
ci_0069                 4.784300e-03 3 1  ON 68
ci_0070                 4.350344e-03 3 1  ON 69
ci_0071                 4.622517e-03 3 1  ON 70
ci_0072                 5.391889e-03 3 1  ON 71
ci_0073                 4.330009e-03 3 1  ON 72
ci_0074                 4.475356e-03 3 1  ON 73
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 39
    time step          = 0.05
    reference energy   = -16.8576
    reference variance = 0.303586
====================================================
  Execution time = 1.4297e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s039
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6904e+01
  VMC Evar = 3.2192e-01
  Total weights = 1.9516e+06
  Execution time = 1.8944e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.308937221161
                                         uncertainty =       0.002663436188

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.308937221161
                                         uncertainty =       0.002663436188

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000393008562
  error estimate for blocks of size 2^( 2) =       0.000407331314
  error estimate for blocks of size 2^( 3) =       0.000421937631
  error estimate for blocks of size 2^( 4) =       0.000436060912
  error estimate for blocks of size 2^( 5) =       0.000449528867
  error estimate for blocks of size 2^( 6) =       0.000459079419
  error estimate for blocks of size 2^( 7) =       0.000463783179

      target function =      -0.877551095658
              le_mean =     -16.903675542636
             les_mean =     286.056047575766
             stat err =       0.000452113094
             autocorr =       1.323397005829
   target nu stat err =       0.000452113094
   target dn stat err =       0.003617002502
      target stat err =       0.004517427912
              std dev =       0.555798037827
             le_variance =       0.308911458853

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.308915257905
                                         uncertainty =       0.002660613839

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.308915257905
                                         uncertainty =       0.002660613839

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000392994597
  error estimate for blocks of size 2^( 2) =       0.000407322210
  error estimate for blocks of size 2^( 3) =       0.000421930158
  error estimate for blocks of size 2^( 4) =       0.000436060980
  error estimate for blocks of size 2^( 5) =       0.000449533501
  error estimate for blocks of size 2^( 6) =       0.000459079969
  error estimate for blocks of size 2^( 7) =       0.000463799654

      target function =      -0.153424965651
              le_mean =     -16.903670572633
             les_mean =     287.990318129462
             stat err =       0.000452118526
             autocorr =       1.323522858048
   target nu stat err =       0.000452118526
   target dn stat err =       1.935454871682
      target stat err =       0.112302556887
              std dev =       0.555778289497
             le_variance =       0.308889507076

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.308901419310
                                         uncertainty =       0.002663926676

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.308901419310
                                         uncertainty =       0.002663926676

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000392985812
  error estimate for blocks of size 2^( 2) =       0.000407311085
  error estimate for blocks of size 2^( 3) =       0.000421920210
  error estimate for blocks of size 2^( 4) =       0.000436047092
  error estimate for blocks of size 2^( 5) =       0.000449516035
  error estimate for blocks of size 2^( 6) =       0.000459068755
  error estimate for blocks of size 2^( 7) =       0.000463774326

      target function =      -0.876998822534
              le_mean =     -16.903675402438
             les_mean =     286.056489245589
             stat err =       0.000452101552
             autocorr =       1.323482650804
   target nu stat err =       0.000452101552
   target dn stat err =       0.003668892236
      target stat err =       0.004575247081
              std dev =       0.555765865562
             le_variance =       0.308875697324

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.308932696213
                                         uncertainty =       0.002663497270

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.308932696213
                                         uncertainty =       0.002663497270

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000393005686
  error estimate for blocks of size 2^( 2) =       0.000407328754
  error estimate for blocks of size 2^( 3) =       0.000421935423
  error estimate for blocks of size 2^( 4) =       0.000436059155
  error estimate for blocks of size 2^( 5) =       0.000449527232
  error estimate for blocks of size 2^( 6) =       0.000459078060
  error estimate for blocks of size 2^( 7) =       0.000463782040

      target function =      -0.877526164186
              le_mean =     -16.903675522964
             les_mean =     286.056067056303
             stat err =       0.000452111622
             autocorr =       1.323407750141
   target nu stat err =       0.000452111622
   target dn stat err =       0.003618701246
      target stat err =       0.004519252789
              std dev =       0.555793971697
             le_variance =       0.308906938975


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.877551095658        initial  <--
     3.9062e+00     3.9062e+01             8.7392e-05        -0.153424965651
     1.5625e+01     1.5625e+02             2.2038e-05        -0.876998822534
     6.2500e+01     6.2500e+02             5.5216e-06        -0.877526164186

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 23.9249
  </log>
  <optVariables href="H2O.s039.opt.xml">
ci_0001                 7.007663e-01 3 1  ON 0
ci_0002                 6.982203e-01 3 1  ON 1
ci_0003                -3.449482e-02 3 1  ON 2
ci_0004                -3.455624e-02 3 1  ON 3
ci_0005                -3.222433e-02 3 1  ON 4
ci_0006                -3.282102e-02 3 1  ON 5
ci_0007                -2.088573e-02 3 1  ON 6
ci_0008                -2.149996e-02 3 1  ON 7
ci_0009                -2.124818e-02 3 1  ON 8
ci_0010                -2.154814e-02 3 1  ON 9
ci_0011                -1.773641e-02 3 1  ON 10
ci_0012                -1.764358e-02 3 1  ON 11
ci_0013                 1.773483e-02 3 1  ON 12
ci_0014                 1.765585e-02 3 1  ON 13
ci_0015                 1.808587e-02 3 1  ON 14
ci_0016                 1.801850e-02 3 1  ON 15
ci_0017                 1.575037e-02 3 1  ON 16
ci_0018                 1.608752e-02 3 1  ON 17
ci_0019                 1.391595e-02 3 1  ON 18
ci_0020                 1.355885e-02 3 1  ON 19
ci_0021                 1.665026e-02 3 1  ON 20
ci_0022                 1.744828e-02 3 1  ON 21
ci_0023                -1.281622e-02 3 1  ON 22
ci_0024                -1.242267e-02 3 1  ON 23
ci_0025                -5.248255e-03 3 1  ON 24
ci_0026                -4.976121e-03 3 1  ON 25
ci_0027                -1.266635e-02 3 1  ON 26
ci_0028                -1.251876e-02 3 1  ON 27
ci_0029                -1.109819e-02 3 1  ON 28
ci_0030                -1.117174e-02 3 1  ON 29
ci_0031                 1.454312e-02 3 1  ON 30
ci_0032                 1.449828e-02 3 1  ON 31
ci_0033                 1.014863e-02 3 1  ON 32
ci_0034                 1.007890e-02 3 1  ON 33
ci_0035                 6.554416e-03 3 1  ON 34
ci_0036                 6.719116e-03 3 1  ON 35
ci_0037                -1.206655e-02 3 1  ON 36
ci_0038                -1.212965e-02 3 1  ON 37
ci_0039                -5.674534e-03 3 1  ON 38
ci_0040                -5.599480e-03 3 1  ON 39
ci_0041                 1.060550e-02 3 1  ON 40
ci_0042                 1.097205e-02 3 1  ON 41
ci_0043                -7.473638e-03 3 1  ON 42
ci_0044                -8.376097e-03 3 1  ON 43
ci_0045                 1.101165e-02 3 1  ON 44
ci_0046                 1.056281e-02 3 1  ON 45
ci_0047                -5.104956e-03 3 1  ON 46
ci_0048                -5.160047e-03 3 1  ON 47
ci_0049                -4.027086e-03 3 1  ON 48
ci_0050                -4.273742e-03 3 1  ON 49
ci_0051                -3.138805e-03 3 1  ON 50
ci_0052                -3.203805e-03 3 1  ON 51
ci_0053                -4.472163e-03 3 1  ON 52
ci_0054                -4.785337e-03 3 1  ON 53
ci_0055                 3.781882e-03 3 1  ON 54
ci_0056                 3.114401e-03 3 1  ON 55
ci_0057                 3.652077e-03 3 1  ON 56
ci_0058                 4.154534e-03 3 1  ON 57
ci_0059                -4.868769e-03 3 1  ON 58
ci_0060                -4.735066e-03 3 1  ON 59
ci_0061                -4.692593e-03 3 1  ON 60
ci_0062                -4.591563e-03 3 1  ON 61
ci_0063                -9.960286e-03 3 1  ON 62
ci_0064                -9.760578e-03 3 1  ON 63
ci_0065                -7.668670e-03 3 1  ON 64
ci_0066                -7.709814e-03 3 1  ON 65
ci_0067                -4.911152e-03 3 1  ON 66
ci_0068                -5.199544e-03 3 1  ON 67
ci_0069                 4.790915e-03 3 1  ON 68
ci_0070                 4.356341e-03 3 1  ON 69
ci_0071                 4.621525e-03 3 1  ON 70
ci_0072                 5.397203e-03 3 1  ON 71
ci_0073                 4.334522e-03 3 1  ON 72
ci_0074                 4.480529e-03 3 1  ON 73
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 4.1208e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s040 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s040 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=40  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6896e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 40
    time step          = 0.05
    reference energy   = -16.8931
    reference variance = 0.279459
====================================================
  Execution time = 1.4436e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s040
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5224e+04
  VMC Eavg = -1.6903e+01
  VMC Evar = 3.2379e-01
  Total weights = 1.951655390e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 2.5825e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.312083642745
                                         uncertainty =       0.002759379098

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.312083642745
                                         uncertainty =       0.002759379098

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000394978478
  error estimate for blocks of size 2^( 2) =       0.000408904255
  error estimate for blocks of size 2^( 3) =       0.000422693593
  error estimate for blocks of size 2^( 4) =       0.000435000208
  error estimate for blocks of size 2^( 5) =       0.000445867396
  error estimate for blocks of size 2^( 6) =       0.000452756161
  error estimate for blocks of size 2^( 7) =       0.000457312403

      target function =      -0.875041736187
              le_mean =     -16.903176196381
             les_mean =     286.041151662747
             stat err =       0.000447734042
             autocorr =       1.284971120114
   target nu stat err =       0.000447734042
   target dn stat err =       0.003420083796
      target stat err =       0.004248033746
              std dev =       0.558583920746
             le_variance =       0.312015996516


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690317619638e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 74
Check correct_vf_var_size: 225, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 3.9062e+01, overlap shift 3.9062e+02 and omega -1.7527e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.875061449796       residual = 5.32e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.875067968790       residual = 6.98e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.875068876605       residual = 2.38e-03           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.875069201127       residual = 8.41e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.875069369921       residual = 3.72e-04           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.875069437543       residual = 1.76e-04           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.875069454935       residual = 4.18e-05           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.875069455057       residual = 1.23e-05           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.875069459000       residual = 5.05e-06           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.875069459034       residual = 1.45e-06           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.875069458980       residual = 5.44e-07           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.875069459376       residual = 2.22e-07           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.875069459413       residual = 3.38e-07           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.875069459562       residual = 2.63e-07           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.875069459947       residual = 1.13e-07           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.875069459940       residual = 2.17e-08           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.875069459821       residual = 7.19e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         16 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 3.9062e+01 is 1.171288e-05

solving harmonic davidson linear method for identity shift 1.5625e+02, overlap shift 1.5625e+03 and omega -1.7527e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.875061449796       residual = 5.32e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.875063081804       residual = 6.98e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.875063309000       residual = 2.38e-03           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.875063390177       residual = 8.41e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.875063432391       residual = 3.71e-04           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.875063449289       residual = 1.76e-04           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.875063453631       residual = 4.17e-05           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.875063453660       residual = 1.23e-05           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.875063454645       residual = 5.03e-06           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.875063454653       residual = 1.45e-06           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.875063454639       residual = 5.42e-07           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.875063454738       residual = 2.21e-07           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.875063454748       residual = 3.38e-07           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.875063454785       residual = 2.62e-07           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.875063454881       residual = 1.13e-07           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.875063454879       residual = 2.16e-08           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.875063454849       residual = 7.13e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         16 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 1.5625e+02 is 2.930186e-06

solving harmonic davidson linear method for identity shift 6.2500e+02, overlap shift 6.2500e+03 and omega -1.7527e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.875061449796       residual = 5.32e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.875061857939       residual = 6.98e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.875061914753       residual = 2.38e-03           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.875061935050       residual = 8.40e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.875061945605       residual = 3.71e-04           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.875061949829       residual = 1.76e-04           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.875061950914       residual = 4.16e-05           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.875061950921       residual = 1.23e-05           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.875061951167       residual = 5.02e-06           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.875061951170       residual = 1.45e-06           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.875061951165       residual = 5.42e-07           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.875061951191       residual = 2.21e-07           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.875061951193       residual = 3.37e-07           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.875061951202       residual = 2.62e-07           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.875061951227       residual = 1.12e-07           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.875061951227       residual = 2.15e-08           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.875061951220       residual = 7.12e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         16 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 6.2500e+02 is 7.326693e-07

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.639992 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 75 and numParams is: 74

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.7033e+01
  </log>
  <optVariables href="H2O.s040.opt.xml">
ci_0001                 7.007665e-01 3 1  ON 0
ci_0002                 6.982212e-01 3 1  ON 1
ci_0003                -3.449323e-02 3 1  ON 2
ci_0004                -3.455543e-02 3 1  ON 3
ci_0005                -3.222163e-02 3 1  ON 4
ci_0006                -3.281890e-02 3 1  ON 5
ci_0007                -2.088396e-02 3 1  ON 6
ci_0008                -2.149703e-02 3 1  ON 7
ci_0009                -2.124653e-02 3 1  ON 8
ci_0010                -2.154721e-02 3 1  ON 9
ci_0011                -1.773557e-02 3 1  ON 10
ci_0012                -1.764264e-02 3 1  ON 11
ci_0013                 1.773388e-02 3 1  ON 12
ci_0014                 1.765459e-02 3 1  ON 13
ci_0015                 1.808451e-02 3 1  ON 14
ci_0016                 1.801750e-02 3 1  ON 15
ci_0017                 1.574942e-02 3 1  ON 16
ci_0018                 1.608612e-02 3 1  ON 17
ci_0019                 1.391551e-02 3 1  ON 18
ci_0020                 1.355843e-02 3 1  ON 19
ci_0021                 1.664993e-02 3 1  ON 20
ci_0022                 1.744790e-02 3 1  ON 21
ci_0023                -1.281564e-02 3 1  ON 22
ci_0024                -1.242248e-02 3 1  ON 23
ci_0025                -5.246680e-03 3 1  ON 24
ci_0026                -4.974918e-03 3 1  ON 25
ci_0027                -1.266540e-02 3 1  ON 26
ci_0028                -1.251811e-02 3 1  ON 27
ci_0029                -1.109746e-02 3 1  ON 28
ci_0030                -1.117120e-02 3 1  ON 29
ci_0031                 1.454305e-02 3 1  ON 30
ci_0032                 1.449697e-02 3 1  ON 31
ci_0033                 1.014785e-02 3 1  ON 32
ci_0034                 1.007802e-02 3 1  ON 33
ci_0035                 6.553332e-03 3 1  ON 34
ci_0036                 6.717326e-03 3 1  ON 35
ci_0037                -1.206574e-02 3 1  ON 36
ci_0038                -1.212911e-02 3 1  ON 37
ci_0039                -5.673552e-03 3 1  ON 38
ci_0040                -5.598513e-03 3 1  ON 39
ci_0041                 1.060483e-02 3 1  ON 40
ci_0042                 1.097176e-02 3 1  ON 41
ci_0043                -7.472761e-03 3 1  ON 42
ci_0044                -8.374668e-03 3 1  ON 43
ci_0045                 1.101147e-02 3 1  ON 44
ci_0046                 1.056275e-02 3 1  ON 45
ci_0047                -5.104051e-03 3 1  ON 46
ci_0048                -5.159038e-03 3 1  ON 47
ci_0049                -4.026161e-03 3 1  ON 48
ci_0050                -4.273498e-03 3 1  ON 49
ci_0051                -3.138470e-03 3 1  ON 50
ci_0052                -3.203241e-03 3 1  ON 51
ci_0053                -4.471665e-03 3 1  ON 52
ci_0054                -4.784241e-03 3 1  ON 53
ci_0055                 3.779544e-03 3 1  ON 54
ci_0056                 3.114161e-03 3 1  ON 55
ci_0057                 3.652721e-03 3 1  ON 56
ci_0058                 4.153475e-03 3 1  ON 57
ci_0059                -4.868064e-03 3 1  ON 58
ci_0060                -4.734634e-03 3 1  ON 59
ci_0061                -4.692458e-03 3 1  ON 60
ci_0062                -4.591028e-03 3 1  ON 61
ci_0063                -9.960050e-03 3 1  ON 62
ci_0064                -9.760434e-03 3 1  ON 63
ci_0065                -7.667823e-03 3 1  ON 64
ci_0066                -7.709390e-03 3 1  ON 65
ci_0067                -4.910282e-03 3 1  ON 66
ci_0068                -5.198314e-03 3 1  ON 67
ci_0069                 4.790507e-03 3 1  ON 68
ci_0070                 4.355426e-03 3 1  ON 69
ci_0071                 4.621166e-03 3 1  ON 70
ci_0072                 5.396443e-03 3 1  ON 71
ci_0073                 4.334220e-03 3 1  ON 72
ci_0074                 4.480338e-03 3 1  ON 73
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 40
    time step          = 0.05
    reference energy   = -16.8993
    reference variance = 0.356926
====================================================
  Execution time = 1.4398e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s040
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6904e+01
  VMC Evar = 3.1843e-01
  Total weights = 1.9514e+06
  Execution time = 1.8943e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.308251174706
                                         uncertainty =       0.002124104032

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.308251174706
                                         uncertainty =       0.002124104032

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000392575855
  error estimate for blocks of size 2^( 2) =       0.000406615075
  error estimate for blocks of size 2^( 3) =       0.000420728558
  error estimate for blocks of size 2^( 4) =       0.000433748758
  error estimate for blocks of size 2^( 5) =       0.000444808737
  error estimate for blocks of size 2^( 6) =       0.000453513563
  error estimate for blocks of size 2^( 7) =       0.000460000115

      target function =      -0.881764895265
              le_mean =     -16.903852199493
             les_mean =     286.058653572967
             stat err =       0.000448017793
             autocorr =       1.302396901517
   target nu stat err =       0.000448017793
   target dn stat err =       0.002963635683
      target stat err =       0.003754712799
              std dev =       0.555186098545
             le_variance =       0.308231604017

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.308243475835
                                         uncertainty =       0.002124378998

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.308243475835
                                         uncertainty =       0.002124378998

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000392570941
  error estimate for blocks of size 2^( 2) =       0.000406610816
  error estimate for blocks of size 2^( 3) =       0.000420725125
  error estimate for blocks of size 2^( 4) =       0.000433745858
  error estimate for blocks of size 2^( 5) =       0.000444806083
  error estimate for blocks of size 2^( 6) =       0.000453511420
  error estimate for blocks of size 2^( 7) =       0.000459998060

      target function =      -0.881773460064
              le_mean =     -16.903852303542
             les_mean =     286.058650238425
             stat err =       0.000448015355
             autocorr =       1.302415331927
   target nu stat err =       0.000448015355
   target dn stat err =       0.002964169460
      target stat err =       0.003755441731
              std dev =       0.555179149233
             le_variance =       0.308223887743

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.308247315544
                                         uncertainty =       0.002124241599

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.308247315544
                                         uncertainty =       0.002124241599

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000392573392
  error estimate for blocks of size 2^( 2) =       0.000406612940
  error estimate for blocks of size 2^( 3) =       0.000420726837
  error estimate for blocks of size 2^( 4) =       0.000433747303
  error estimate for blocks of size 2^( 5) =       0.000444807405
  error estimate for blocks of size 2^( 6) =       0.000453512487
  error estimate for blocks of size 2^( 7) =       0.000459999083

      target function =      -0.881769427841
              le_mean =     -16.903852250990
             les_mean =     286.058651687451
             stat err =       0.000448016569
             autocorr =       1.302406130044
   target nu stat err =       0.000448016569
   target dn stat err =       0.002963901256
      target stat err =       0.003755077738
              std dev =       0.555182615132
             le_variance =       0.308227736144

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.308250691628
                                         uncertainty =       0.002124121222

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.308250691628
                                         uncertainty =       0.002124121222

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000392575547
  error estimate for blocks of size 2^( 2) =       0.000406614808
  error estimate for blocks of size 2^( 3) =       0.000420728343
  error estimate for blocks of size 2^( 4) =       0.000433748575
  error estimate for blocks of size 2^( 5) =       0.000444808570
  error estimate for blocks of size 2^( 6) =       0.000453513428
  error estimate for blocks of size 2^( 7) =       0.000459999986

      target function =      -0.881765486063
              le_mean =     -16.903852205867
             les_mean =     286.058653315742
             stat err =       0.000448017640
             autocorr =       1.302398055687
   target nu stat err =       0.000448017640
   target dn stat err =       0.002963668723
      target stat err =       0.003754758426
              std dev =       0.555185662504
             le_variance =       0.308231119851


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.881764895265        initial
     3.9062e+01     3.9062e+02             1.1713e-05        -0.881773460064  <--
     1.5625e+02     1.5625e+03             2.9302e-06        -0.881769427841
     6.2500e+02     6.2500e+03             7.3267e-07        -0.881765486063

*****************************************************************************
Applying the update for shift_i =   3.9062e+01     and shift_s =   3.9062e+02
*****************************************************************************

  Execution time = 2.3971e+01
  </log>
  <optVariables href="H2O.s040.opt.xml">
ci_0001                 7.007672e-01 3 1  ON 0
ci_0002                 6.982241e-01 3 1  ON 1
ci_0003                -3.448848e-02 3 1  ON 2
ci_0004                -3.455298e-02 3 1  ON 3
ci_0005                -3.221353e-02 3 1  ON 4
ci_0006                -3.281255e-02 3 1  ON 5
ci_0007                -2.087864e-02 3 1  ON 6
ci_0008                -2.148825e-02 3 1  ON 7
ci_0009                -2.124158e-02 3 1  ON 8
ci_0010                -2.154443e-02 3 1  ON 9
ci_0011                -1.773307e-02 3 1  ON 10
ci_0012                -1.763983e-02 3 1  ON 11
ci_0013                 1.773103e-02 3 1  ON 12
ci_0014                 1.765080e-02 3 1  ON 13
ci_0015                 1.808043e-02 3 1  ON 14
ci_0016                 1.801450e-02 3 1  ON 15
ci_0017                 1.574657e-02 3 1  ON 16
ci_0018                 1.608192e-02 3 1  ON 17
ci_0019                 1.391418e-02 3 1  ON 18
ci_0020                 1.355720e-02 3 1  ON 19
ci_0021                 1.664892e-02 3 1  ON 20
ci_0022                 1.744678e-02 3 1  ON 21
ci_0023                -1.281389e-02 3 1  ON 22
ci_0024                -1.242190e-02 3 1  ON 23
ci_0025                -5.241964e-03 3 1  ON 24
ci_0026                -4.971316e-03 3 1  ON 25
ci_0027                -1.266255e-02 3 1  ON 26
ci_0028                -1.251616e-02 3 1  ON 27
ci_0029                -1.109527e-02 3 1  ON 28
ci_0030                -1.116957e-02 3 1  ON 29
ci_0031                 1.454284e-02 3 1  ON 30
ci_0032                 1.449306e-02 3 1  ON 31
ci_0033                 1.014551e-02 3 1  ON 32
ci_0034                 1.007536e-02 3 1  ON 33
ci_0035                 6.550085e-03 3 1  ON 34
ci_0036                 6.711965e-03 3 1  ON 35
ci_0037                -1.206333e-02 3 1  ON 36
ci_0038                -1.212748e-02 3 1  ON 37
ci_0039                -5.670612e-03 3 1  ON 38
ci_0040                -5.595618e-03 3 1  ON 39
ci_0041                 1.060283e-02 3 1  ON 40
ci_0042                 1.097090e-02 3 1  ON 41
ci_0043                -7.470134e-03 3 1  ON 42
ci_0044                -8.370387e-03 3 1  ON 43
ci_0045                 1.101093e-02 3 1  ON 44
ci_0046                 1.056257e-02 3 1  ON 45
ci_0047                -5.101341e-03 3 1  ON 46
ci_0048                -5.156014e-03 3 1  ON 47
ci_0049                -4.023391e-03 3 1  ON 48
ci_0050                -4.272766e-03 3 1  ON 49
ci_0051                -3.137464e-03 3 1  ON 50
ci_0052                -3.201552e-03 3 1  ON 51
ci_0053                -4.470174e-03 3 1  ON 52
ci_0054                -4.780959e-03 3 1  ON 53
ci_0055                 3.772544e-03 3 1  ON 54
ci_0056                 3.113441e-03 3 1  ON 55
ci_0057                 3.654647e-03 3 1  ON 56
ci_0058                 4.150303e-03 3 1  ON 57
ci_0059                -4.865951e-03 3 1  ON 58
ci_0060                -4.733341e-03 3 1  ON 59
ci_0061                -4.692055e-03 3 1  ON 60
ci_0062                -4.589423e-03 3 1  ON 61
ci_0063                -9.959346e-03 3 1  ON 62
ci_0064                -9.760003e-03 3 1  ON 63
ci_0065                -7.665284e-03 3 1  ON 64
ci_0066                -7.708118e-03 3 1  ON 65
ci_0067                -4.907677e-03 3 1  ON 66
ci_0068                -5.194630e-03 3 1  ON 67
ci_0069                 4.789284e-03 3 1  ON 68
ci_0070                 4.352688e-03 3 1  ON 69
ci_0071                 4.620092e-03 3 1  ON 70
ci_0072                 5.394167e-03 3 1  ON 71
ci_0073                 4.333315e-03 3 1  ON 72
ci_0074                 4.479769e-03 3 1  ON 73
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 4.1028e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s041 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s041 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=41  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6896e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 41
    time step          = 0.05
    reference energy   = -16.8091
    reference variance = 0.20101
====================================================
  Execution time = 1.4692e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s041
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5284e+04
  VMC Eavg = -1.6904e+01
  VMC Evar = 3.1718e-01
  Total weights = 1.951862086e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 2.5840e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.304749407008
                                         uncertainty =       0.001801620653

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.304749407008
                                         uncertainty =       0.001801620653

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000390347448
  error estimate for blocks of size 2^( 2) =       0.000404670102
  error estimate for blocks of size 2^( 3) =       0.000419045460
  error estimate for blocks of size 2^( 4) =       0.000432185349
  error estimate for blocks of size 2^( 5) =       0.000442601533
  error estimate for blocks of size 2^( 6) =       0.000451126384
  error estimate for blocks of size 2^( 7) =       0.000452730637

      target function =      -0.883287889397
              le_mean =     -16.903536537541
             les_mean =     286.046731784949
             stat err =       0.000444660976
             autocorr =       1.297643349104
   target nu stat err =       0.000444660976
   target dn stat err =       0.002540283250
      target stat err =       0.003243284930
              std dev =       0.552034654449
             le_variance =       0.304742259713


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690353653754e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 74
Check correct_vf_var_size: 225, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 9.7656e+00, overlap shift 9.7656e+01 and omega -1.7527e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.883298775917       residual = 4.92e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.883319617200       residual = 1.05e-02           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.883324606764       residual = 2.21e-03           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.883325881268       residual = 6.90e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.883326299084       residual = 3.94e-04           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.883326565314       residual = 1.89e-04           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.883326730001       residual = 3.38e-05           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.883326742450       residual = 1.25e-05           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.883326743815       residual = 5.47e-06           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.883326750077       residual = 3.51e-06           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.883326751555       residual = 2.39e-06           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.883326748369       residual = 1.81e-06           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.883326754995       residual = 1.61e-06           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.883326759734       residual = 6.00e-07           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.883326759214       residual = 1.54e-07           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.883326759233       residual = 2.38e-08           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.883326758370       residual = 9.88e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         16 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 9.7656e+00 is 3.786212e-05

solving harmonic davidson linear method for identity shift 3.9062e+01, overlap shift 3.9062e+02 and omega -1.7527e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.883298775917       residual = 4.92e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.883304015854       residual = 1.05e-02           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.883305268668       residual = 2.20e-03           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.883305588014       residual = 6.87e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.883305692642       residual = 3.92e-04           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.883305759193       residual = 1.87e-04           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.883305800274       residual = 3.34e-05           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.883305803352       residual = 1.24e-05           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.883305803678       residual = 5.42e-06           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.883305805238       residual = 3.48e-06           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.883305805602       residual = 2.37e-06           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.883305804808       residual = 1.79e-06           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.883305806464       residual = 1.58e-06           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.883305807638       residual = 5.83e-07           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.883305807503       residual = 1.48e-07           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.883305807507       residual = 2.31e-08           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.883305807293       residual = 9.54e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         16 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 3.9062e+01 is 9.498301e-06

solving harmonic davidson linear method for identity shift 1.5625e+02, overlap shift 1.5625e+03 and omega -1.7527e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.883298775917       residual = 4.92e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.883300087765       residual = 1.05e-02           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.883300401309       residual = 2.20e-03           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.883300481191       residual = 6.87e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.883300507359       residual = 3.91e-04           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.883300523996       residual = 1.87e-04           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.883300534260       residual = 3.34e-05           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.883300535028       residual = 1.24e-05           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.883300535108       residual = 5.40e-06           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.883300535498       residual = 3.47e-06           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.883300535589       residual = 2.36e-06           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.883300535390       residual = 1.79e-06           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.883300535804       residual = 1.57e-06           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.883300536097       residual = 5.79e-07           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.883300536063       residual = 1.47e-07           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.883300536064       residual = 2.29e-08           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.883300536010       residual = 9.46e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         16 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 1.5625e+02 is 2.376632e-06

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.649019 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 75 and numParams is: 74

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.7291e+01
  </log>
  <optVariables href="H2O.s041.opt.xml">
ci_0001                 7.007732e-01 3 1  ON 0
ci_0002                 6.982227e-01 3 1  ON 1
ci_0003                -3.448158e-02 3 1  ON 2
ci_0004                -3.454714e-02 3 1  ON 3
ci_0005                -3.220551e-02 3 1  ON 4
ci_0006                -3.280305e-02 3 1  ON 5
ci_0007                -2.087142e-02 3 1  ON 6
ci_0008                -2.147899e-02 3 1  ON 7
ci_0009                -2.123652e-02 3 1  ON 8
ci_0010                -2.153925e-02 3 1  ON 9
ci_0011                -1.772873e-02 3 1  ON 10
ci_0012                -1.763421e-02 3 1  ON 11
ci_0013                 1.772678e-02 3 1  ON 12
ci_0014                 1.764651e-02 3 1  ON 13
ci_0015                 1.807597e-02 3 1  ON 14
ci_0016                 1.801138e-02 3 1  ON 15
ci_0017                 1.574293e-02 3 1  ON 16
ci_0018                 1.607826e-02 3 1  ON 17
ci_0019                 1.391054e-02 3 1  ON 18
ci_0020                 1.355327e-02 3 1  ON 19
ci_0021                 1.664744e-02 3 1  ON 20
ci_0022                 1.744395e-02 3 1  ON 21
ci_0023                -1.281152e-02 3 1  ON 22
ci_0024                -1.241846e-02 3 1  ON 23
ci_0025                -5.237148e-03 3 1  ON 24
ci_0026                -4.963328e-03 3 1  ON 25
ci_0027                -1.265942e-02 3 1  ON 26
ci_0028                -1.251375e-02 3 1  ON 27
ci_0029                -1.109216e-02 3 1  ON 28
ci_0030                -1.116653e-02 3 1  ON 29
ci_0031                 1.454306e-02 3 1  ON 30
ci_0032                 1.449303e-02 3 1  ON 31
ci_0033                 1.014085e-02 3 1  ON 32
ci_0034                 1.007102e-02 3 1  ON 33
ci_0035                 6.545715e-03 3 1  ON 34
ci_0036                 6.707741e-03 3 1  ON 35
ci_0037                -1.206458e-02 3 1  ON 36
ci_0038                -1.212493e-02 3 1  ON 37
ci_0039                -5.667194e-03 3 1  ON 38
ci_0040                -5.591589e-03 3 1  ON 39
ci_0041                 1.059988e-02 3 1  ON 40
ci_0042                 1.096893e-02 3 1  ON 41
ci_0043                -7.469200e-03 3 1  ON 42
ci_0044                -8.367716e-03 3 1  ON 43
ci_0045                 1.100815e-02 3 1  ON 44
ci_0046                 1.056030e-02 3 1  ON 45
ci_0047                -5.097596e-03 3 1  ON 46
ci_0048                -5.152560e-03 3 1  ON 47
ci_0049                -4.020854e-03 3 1  ON 48
ci_0050                -4.269695e-03 3 1  ON 49
ci_0051                -3.133630e-03 3 1  ON 50
ci_0052                -3.196811e-03 3 1  ON 51
ci_0053                -4.468066e-03 3 1  ON 52
ci_0054                -4.780115e-03 3 1  ON 53
ci_0055                 3.769365e-03 3 1  ON 54
ci_0056                 3.112731e-03 3 1  ON 55
ci_0057                 3.653874e-03 3 1  ON 56
ci_0058                 4.146840e-03 3 1  ON 57
ci_0059                -4.864347e-03 3 1  ON 58
ci_0060                -4.731734e-03 3 1  ON 59
ci_0061                -4.688889e-03 3 1  ON 60
ci_0062                -4.586518e-03 3 1  ON 61
ci_0063                -9.958686e-03 3 1  ON 62
ci_0064                -9.759356e-03 3 1  ON 63
ci_0065                -7.663318e-03 3 1  ON 64
ci_0066                -7.705770e-03 3 1  ON 65
ci_0067                -4.905707e-03 3 1  ON 66
ci_0068                -5.192590e-03 3 1  ON 67
ci_0069                 4.786377e-03 3 1  ON 68
ci_0070                 4.349531e-03 3 1  ON 69
ci_0071                 4.619981e-03 3 1  ON 70
ci_0072                 5.390660e-03 3 1  ON 71
ci_0073                 4.331479e-03 3 1  ON 72
ci_0074                 4.477385e-03 3 1  ON 73
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 41
    time step          = 0.05
    reference energy   = -16.8747
    reference variance = 0.29729
====================================================
  Execution time = 1.4264e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s041
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6904e+01
  VMC Evar = 3.2047e-01
  Total weights = 1.9519e+06
  Execution time = 1.9800e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.309029094515
                                         uncertainty =       0.002460295384

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.309029094515
                                         uncertainty =       0.002460295384

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000393126292
  error estimate for blocks of size 2^( 2) =       0.000407290973
  error estimate for blocks of size 2^( 3) =       0.000422027606
  error estimate for blocks of size 2^( 4) =       0.000436289336
  error estimate for blocks of size 2^( 5) =       0.000448355980
  error estimate for blocks of size 2^( 6) =       0.000454396698
  error estimate for blocks of size 2^( 7) =       0.000459063768

      target function =      -0.879141860477
              le_mean =     -16.903507272615
             les_mean =     286.049063055953
             stat err =       0.000449526446
             autocorr =       1.307513896430
   target nu stat err =       0.000449526446
   target dn stat err =       0.002860863429
      target stat err =       0.003605437185
              std dev =       0.555964533310
             le_variance =       0.309096562299

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.308984988410
                                         uncertainty =       0.002456424682

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.308984988410
                                         uncertainty =       0.002456424682

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000393098237
  error estimate for blocks of size 2^( 2) =       0.000407265377
  error estimate for blocks of size 2^( 3) =       0.000422004953
  error estimate for blocks of size 2^( 4) =       0.000436269148
  error estimate for blocks of size 2^( 5) =       0.000448337649
  error estimate for blocks of size 2^( 6) =       0.000454378304
  error estimate for blocks of size 2^( 7) =       0.000459047425

      target function =      -0.879216405888
              le_mean =     -16.903507578516
             les_mean =     286.049013395137
             stat err =       0.000449508132
             autocorr =       1.307593978030
   target nu stat err =       0.000449508132
   target dn stat err =       0.002854823819
      target stat err =       0.003598659252
              std dev =       0.555924858775
             le_variance =       0.309052448604

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.309006864252
                                         uncertainty =       0.002458346510

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.309006864252
                                         uncertainty =       0.002458346510

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000393112152
  error estimate for blocks of size 2^( 2) =       0.000407278063
  error estimate for blocks of size 2^( 3) =       0.000422016172
  error estimate for blocks of size 2^( 4) =       0.000436279142
  error estimate for blocks of size 2^( 5) =       0.000448346720
  error estimate for blocks of size 2^( 6) =       0.000454387406
  error estimate for blocks of size 2^( 7) =       0.000459055504

      target function =      -0.879209333878
              le_mean =     -16.903507417058
             les_mean =     286.049013596872
             stat err =       0.000449517193
             autocorr =       1.307554127640
   target nu stat err =       0.000449517193
   target dn stat err =       0.002857530432
      target stat err =       0.003601909493
              std dev =       0.555944537012
             le_variance =       0.309074328234

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.309026305187
                                         uncertainty =       0.002460051016

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.309026305187
                                         uncertainty =       0.002460051016

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000393124517
  error estimate for blocks of size 2^( 2) =       0.000407289352
  error estimate for blocks of size 2^( 3) =       0.000422026170
  error estimate for blocks of size 2^( 4) =       0.000436288055
  error estimate for blocks of size 2^( 5) =       0.000448354816
  error estimate for blocks of size 2^( 6) =       0.000454395530
  error estimate for blocks of size 2^( 7) =       0.000459062729

      target function =      -0.879161654104
              le_mean =     -16.903507289846
             les_mean =     286.049047689477
             stat err =       0.000449525283
             autocorr =       1.307518933116
   target nu stat err =       0.000449525283
   target dn stat err =       0.002860360467
      target stat err =       0.003604982548
              std dev =       0.555962024330
             le_variance =       0.309093772497


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.879141860477        initial
     9.7656e+00     9.7656e+01             3.7862e-05        -0.879216405888  <--
     3.9062e+01     3.9062e+02             9.4983e-06        -0.879209333878
     1.5625e+02     1.5625e+03             2.3766e-06        -0.879161654104

*****************************************************************************
Applying the update for shift_i =   9.7656e+00     and shift_s =   9.7656e+01
*****************************************************************************

  Execution time = 2.3990e+01
  </log>
  <optVariables href="H2O.s041.opt.xml">
ci_0001                 7.007911e-01 3 1  ON 0
ci_0002                 6.982186e-01 3 1  ON 1
ci_0003                -3.446099e-02 3 1  ON 2
ci_0004                -3.452971e-02 3 1  ON 3
ci_0005                -3.218154e-02 3 1  ON 4
ci_0006                -3.277469e-02 3 1  ON 5
ci_0007                -2.084984e-02 3 1  ON 6
ci_0008                -2.145132e-02 3 1  ON 7
ci_0009                -2.122144e-02 3 1  ON 8
ci_0010                -2.152383e-02 3 1  ON 9
ci_0011                -1.771578e-02 3 1  ON 10
ci_0012                -1.761743e-02 3 1  ON 11
ci_0013                 1.771413e-02 3 1  ON 12
ci_0014                 1.763372e-02 3 1  ON 13
ci_0015                 1.806265e-02 3 1  ON 14
ci_0016                 1.800208e-02 3 1  ON 15
ci_0017                 1.573210e-02 3 1  ON 16
ci_0018                 1.606735e-02 3 1  ON 17
ci_0019                 1.389967e-02 3 1  ON 18
ci_0020                 1.354154e-02 3 1  ON 19
ci_0021                 1.664303e-02 3 1  ON 20
ci_0022                 1.743550e-02 3 1  ON 21
ci_0023                -1.280448e-02 3 1  ON 22
ci_0024                -1.240821e-02 3 1  ON 23
ci_0025                -5.222805e-03 3 1  ON 24
ci_0026                -4.939544e-03 3 1  ON 25
ci_0027                -1.265008e-02 3 1  ON 26
ci_0028                -1.250657e-02 3 1  ON 27
ci_0029                -1.108291e-02 3 1  ON 28
ci_0030                -1.115747e-02 3 1  ON 29
ci_0031                 1.454372e-02 3 1  ON 30
ci_0032                 1.449293e-02 3 1  ON 31
ci_0033                 1.012692e-02 3 1  ON 32
ci_0034                 1.005805e-02 3 1  ON 33
ci_0035                 6.532705e-03 3 1  ON 34
ci_0036                 6.695162e-03 3 1  ON 35
ci_0037                -1.206834e-02 3 1  ON 36
ci_0038                -1.211733e-02 3 1  ON 37
ci_0039                -5.657012e-03 3 1  ON 38
ci_0040                -5.579589e-03 3 1  ON 39
ci_0041                 1.059106e-02 3 1  ON 40
ci_0042                 1.096307e-02 3 1  ON 41
ci_0043                -7.466415e-03 3 1  ON 42
ci_0044                -8.359743e-03 3 1  ON 43
ci_0045                 1.099986e-02 3 1  ON 44
ci_0046                 1.055352e-02 3 1  ON 45
ci_0047                -5.086443e-03 3 1  ON 46
ci_0048                -5.142270e-03 3 1  ON 47
ci_0049                -4.013303e-03 3 1  ON 48
ci_0050                -4.260555e-03 3 1  ON 49
ci_0051                -3.122221e-03 3 1  ON 50
ci_0052                -3.182700e-03 3 1  ON 51
ci_0053                -4.461788e-03 3 1  ON 52
ci_0054                -4.777600e-03 3 1  ON 53
ci_0055                 3.759902e-03 3 1  ON 54
ci_0056                 3.110618e-03 3 1  ON 55
ci_0057                 3.651568e-03 3 1  ON 56
ci_0058                 4.136528e-03 3 1  ON 57
ci_0059                -4.859571e-03 3 1  ON 58
ci_0060                -4.726950e-03 3 1  ON 59
ci_0061                -4.679450e-03 3 1  ON 60
ci_0062                -4.577857e-03 3 1  ON 61
ci_0063                -9.956722e-03 3 1  ON 62
ci_0064                -9.757428e-03 3 1  ON 63
ci_0065                -7.657456e-03 3 1  ON 64
ci_0066                -7.698771e-03 3 1  ON 65
ci_0067                -4.899843e-03 3 1  ON 66
ci_0068                -5.186517e-03 3 1  ON 67
ci_0069                 4.777722e-03 3 1  ON 68
ci_0070                 4.340132e-03 3 1  ON 69
ci_0071                 4.619650e-03 3 1  ON 70
ci_0072                 5.380218e-03 3 1  ON 71
ci_0073                 4.326015e-03 3 1  ON 72
ci_0074                 4.470287e-03 3 1  ON 73
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 4.1286e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s042 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s042 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=42  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6895e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 42
    time step          = 0.05
    reference energy   = -16.9618
    reference variance = 0.451871
====================================================
  Execution time = 1.4639e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s042
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5268e+04
  VMC Eavg = -1.6903e+01
  VMC Evar = 3.1403e-01
  Total weights = 1.951898690e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 2.5749e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.301695031334
                                         uncertainty =       0.001804869944

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.301695031334
                                         uncertainty =       0.001804869944

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000388380719
  error estimate for blocks of size 2^( 2) =       0.000403079193
  error estimate for blocks of size 2^( 3) =       0.000418113942
  error estimate for blocks of size 2^( 4) =       0.000432617292
  error estimate for blocks of size 2^( 5) =       0.000444818520
  error estimate for blocks of size 2^( 6) =       0.000452740620
  error estimate for blocks of size 2^( 7) =       0.000458345265

      target function =      -0.887157363772
              le_mean =     -16.902881086971
             les_mean =     286.021419339026
             stat err =       0.000447130424
             autocorr =       1.325418779136
   target nu stat err =       0.000447130424
   target dn stat err =       0.002474707853
      target stat err =       0.003187330016
              std dev =       0.549253280822
             le_variance =       0.301679166493


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690288108697e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 74
Check correct_vf_var_size: 225, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.4414e+00, overlap shift 2.4414e+01 and omega -1.7527e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.887167702507       residual = 3.59e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.887239469317       residual = 5.82e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.887250774247       residual = 1.84e-03           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.887254786323       residual = 4.85e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.887256353768       residual = 2.31e-04           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.887256984226       residual = 8.95e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.887257172104       residual = 3.13e-05           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.887257251148       residual = 8.99e-06           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.887257244182       residual = 2.68e-06           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.887257239650       residual = 1.00e-06           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.887257247179       residual = 2.70e-07           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.887257253250       residual = 9.99e-08           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.887257251590       residual = 9.11e-08           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.887257256817       residual = 1.00e-07           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.887257259550       residual = 7.72e-08           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.887257264230       residual = 1.86e-08           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.887257262783       residual = 1.13e-08           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.887257262061       residual = 3.42e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         17 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 2.4414e+00 is 1.469996e-04

solving harmonic davidson linear method for identity shift 9.7656e+00, overlap shift 9.7656e+01 and omega -1.7527e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.887167702507       residual = 3.59e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.887186040460       residual = 5.79e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.887188915038       residual = 1.82e-03           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.887189927181       residual = 4.78e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.887190321234       residual = 2.26e-04           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.887190477433       residual = 8.62e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.887190523790       residual = 3.00e-05           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.887190543156       residual = 8.58e-06           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.887190541258       residual = 2.54e-06           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.887190540107       residual = 9.44e-07           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.887190541976       residual = 2.53e-07           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.887190543494       residual = 9.59e-08           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.887190543088       residual = 8.96e-08           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.887190544414       residual = 9.71e-08           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.887190545078       residual = 7.05e-08           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.887190546181       residual = 1.66e-08           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.887190545806       residual = 1.00e-08           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.887190545629       residual = 2.96e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         17 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 9.7656e+00 is 3.714418e-05

solving harmonic davidson linear method for identity shift 3.9062e+01, overlap shift 3.9062e+02 and omega -1.7527e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.887167702507       residual = 3.59e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.887172312446       residual = 5.78e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.887173034173       residual = 1.81e-03           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.887173287777       residual = 4.76e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.887173386424       residual = 2.25e-04           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.887173425380       residual = 8.54e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.887173436929       residual = 2.96e-05           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.887173441745       residual = 8.48e-06           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.887173441261       residual = 2.51e-06           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.887173440972       residual = 9.30e-07           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.887173441439       residual = 2.49e-07           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.887173441818       residual = 9.49e-08           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.887173441718       residual = 8.92e-08           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.887173442050       residual = 9.63e-08           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.887173442215       residual = 6.89e-08           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.887173442486       residual = 1.62e-08           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.887173442392       residual = 9.70e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         16 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 3.9062e+01 is 9.317993e-06

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.658903 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 75 and numParams is: 74

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.7230e+01
  </log>
  <optVariables href="H2O.s042.opt.xml">
ci_0001                 7.007959e-01 3 1  ON 0
ci_0002                 6.982307e-01 3 1  ON 1
ci_0003                -3.443934e-02 3 1  ON 2
ci_0004                -3.450282e-02 3 1  ON 3
ci_0005                -3.214747e-02 3 1  ON 4
ci_0006                -3.274170e-02 3 1  ON 5
ci_0007                -2.082263e-02 3 1  ON 6
ci_0008                -2.141417e-02 3 1  ON 7
ci_0009                -2.121095e-02 3 1  ON 8
ci_0010                -2.150811e-02 3 1  ON 9
ci_0011                -1.770020e-02 3 1  ON 10
ci_0012                -1.759896e-02 3 1  ON 11
ci_0013                 1.769985e-02 3 1  ON 12
ci_0014                 1.762380e-02 3 1  ON 13
ci_0015                 1.804421e-02 3 1  ON 14
ci_0016                 1.798364e-02 3 1  ON 15
ci_0017                 1.571334e-02 3 1  ON 16
ci_0018                 1.604597e-02 3 1  ON 17
ci_0019                 1.388354e-02 3 1  ON 18
ci_0020                 1.353423e-02 3 1  ON 19
ci_0021                 1.663477e-02 3 1  ON 20
ci_0022                 1.742754e-02 3 1  ON 21
ci_0023                -1.279635e-02 3 1  ON 22
ci_0024                -1.239769e-02 3 1  ON 23
ci_0025                -5.197040e-03 3 1  ON 24
ci_0026                -4.920314e-03 3 1  ON 25
ci_0027                -1.263950e-02 3 1  ON 26
ci_0028                -1.249627e-02 3 1  ON 27
ci_0029                -1.107562e-02 3 1  ON 28
ci_0030                -1.114921e-02 3 1  ON 29
ci_0031                 1.454598e-02 3 1  ON 30
ci_0032                 1.448745e-02 3 1  ON 31
ci_0033                 1.011432e-02 3 1  ON 32
ci_0034                 1.005526e-02 3 1  ON 33
ci_0035                 6.528387e-03 3 1  ON 34
ci_0036                 6.677489e-03 3 1  ON 35
ci_0037                -1.205920e-02 3 1  ON 36
ci_0038                -1.211143e-02 3 1  ON 37
ci_0039                -5.640677e-03 3 1  ON 38
ci_0040                -5.563052e-03 3 1  ON 39
ci_0041                 1.058433e-02 3 1  ON 40
ci_0042                 1.095671e-02 3 1  ON 41
ci_0043                -7.467186e-03 3 1  ON 42
ci_0044                -8.357411e-03 3 1  ON 43
ci_0045                 1.099203e-02 3 1  ON 44
ci_0046                 1.054747e-02 3 1  ON 45
ci_0047                -5.070658e-03 3 1  ON 46
ci_0048                -5.125529e-03 3 1  ON 47
ci_0049                -4.008245e-03 3 1  ON 48
ci_0050                -4.235734e-03 3 1  ON 49
ci_0051                -3.116003e-03 3 1  ON 50
ci_0052                -3.173014e-03 3 1  ON 51
ci_0053                -4.457125e-03 3 1  ON 52
ci_0054                -4.769012e-03 3 1  ON 53
ci_0055                 3.763169e-03 3 1  ON 54
ci_0056                 3.098291e-03 3 1  ON 55
ci_0057                 3.644256e-03 3 1  ON 56
ci_0058                 4.130146e-03 3 1  ON 57
ci_0059                -4.847524e-03 3 1  ON 58
ci_0060                -4.721600e-03 3 1  ON 59
ci_0061                -4.668466e-03 3 1  ON 60
ci_0062                -4.572170e-03 3 1  ON 61
ci_0063                -9.948727e-03 3 1  ON 62
ci_0064                -9.749229e-03 3 1  ON 63
ci_0065                -7.650665e-03 3 1  ON 64
ci_0066                -7.688458e-03 3 1  ON 65
ci_0067                -4.890853e-03 3 1  ON 66
ci_0068                -5.178008e-03 3 1  ON 67
ci_0069                 4.773738e-03 3 1  ON 68
ci_0070                 4.328740e-03 3 1  ON 69
ci_0071                 4.614253e-03 3 1  ON 70
ci_0072                 5.373228e-03 3 1  ON 71
ci_0073                 4.328641e-03 3 1  ON 72
ci_0074                 4.467029e-03 3 1  ON 73
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 42
    time step          = 0.05
    reference energy   = -16.8797
    reference variance = 0.210584
====================================================
  Execution time = 1.4445e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s042
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6903e+01
  VMC Evar = 3.1459e-01
  Total weights = 1.9516e+06
  Execution time = 1.8882e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.303807255966
                                         uncertainty =       0.001778804397

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.303807255966
                                         uncertainty =       0.001778804397

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000389724821
  error estimate for blocks of size 2^( 2) =       0.000403602321
  error estimate for blocks of size 2^( 3) =       0.000417489164
  error estimate for blocks of size 2^( 4) =       0.000430230821
  error estimate for blocks of size 2^( 5) =       0.000441084089
  error estimate for blocks of size 2^( 6) =       0.000447867155
  error estimate for blocks of size 2^( 7) =       0.000455708790

      target function =      -0.886406215462
              le_mean =     -16.903216115674
             les_mean =     286.033380597571
             stat err =       0.000443722714
             autocorr =       1.296304973989
   target nu stat err =       0.000443722714
   target dn stat err =       0.002491031565
      target stat err =       0.003202961122
              std dev =       0.551154127823
             le_variance =       0.303770872617

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.303676944753
                                         uncertainty =       0.001774965744

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.303676944753
                                         uncertainty =       0.001774965744

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000389641324
  error estimate for blocks of size 2^( 2) =       0.000403527450
  error estimate for blocks of size 2^( 3) =       0.000417423927
  error estimate for blocks of size 2^( 4) =       0.000430174655
  error estimate for blocks of size 2^( 5) =       0.000441029565
  error estimate for blocks of size 2^( 6) =       0.000447816947
  error estimate for blocks of size 2^( 7) =       0.000455666156

      target function =      -0.886617503545
              le_mean =     -16.903216545688
             les_mean =     286.033227685329
             stat err =       0.000443671831
             autocorr =       1.296563198228
   target nu stat err =       0.000443671831
   target dn stat err =       0.002480759171
      target stat err =       0.003191745510
              std dev =       0.551036045390
             le_variance =       0.303640723319

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.303740004908
                                         uncertainty =       0.001776823749

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.303740004908
                                         uncertainty =       0.001776823749

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000389681732
  error estimate for blocks of size 2^( 2) =       0.000403563620
  error estimate for blocks of size 2^( 3) =       0.000417455369
  error estimate for blocks of size 2^( 4) =       0.000430201667
  error estimate for blocks of size 2^( 5) =       0.000441055774
  error estimate for blocks of size 2^( 6) =       0.000447841042
  error estimate for blocks of size 2^( 7) =       0.000455686508

      target function =      -0.886567242494
              le_mean =     -16.903216223515
             les_mean =     286.033256587712
             stat err =       0.000443696248
             autocorr =       1.296437002442
   target nu stat err =       0.000443696248
   target dn stat err =       0.002483961856
      target stat err =       0.003195355140
              std dev =       0.551093190431
             le_variance =       0.303703704540

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.303798720830
                                         uncertainty =       0.001778552968

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.303798720830
                                         uncertainty =       0.001778552968

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000389719353
  error estimate for blocks of size 2^( 2) =       0.000403597402
  error estimate for blocks of size 2^( 3) =       0.000417484860
  error estimate for blocks of size 2^( 4) =       0.000430227104
  error estimate for blocks of size 2^( 5) =       0.000441080478
  error estimate for blocks of size 2^( 6) =       0.000447863819
  error estimate for blocks of size 2^( 7) =       0.000455705927

      target function =      -0.886436427012
              le_mean =     -16.903216115457
             les_mean =     286.033356633750
             stat err =       0.000443719332
             autocorr =       1.296321593374
   target nu stat err =       0.000443719332
   target dn stat err =       0.002489711055
      target stat err =       0.003201542135
              std dev =       0.551146394316
             le_variance =       0.303762347967


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.886406215462        initial
     2.4414e+00     2.4414e+01             1.4700e-04        -0.886617503545  <--
     9.7656e+00     9.7656e+01             3.7144e-05        -0.886567242494
     3.9062e+01     3.9062e+02             9.3180e-06        -0.886436427012

*****************************************************************************
Applying the update for shift_i =   2.4414e+00     and shift_s =   2.4414e+01
*****************************************************************************

  Execution time = 2.4333e+01
  </log>
  <optVariables href="H2O.s042.opt.xml">
ci_0001                 7.008098e-01 3 1  ON 0
ci_0002                 6.982663e-01 3 1  ON 1
ci_0003                -3.437591e-02 3 1  ON 2
ci_0004                -3.442403e-02 3 1  ON 3
ci_0005                -3.204710e-02 3 1  ON 4
ci_0006                -3.264457e-02 3 1  ON 5
ci_0007                -2.074224e-02 3 1  ON 6
ci_0008                -2.130432e-02 3 1  ON 7
ci_0009                -2.118030e-02 3 1  ON 8
ci_0010                -2.146219e-02 3 1  ON 9
ci_0011                -1.765465e-02 3 1  ON 10
ci_0012                -1.754492e-02 3 1  ON 11
ci_0013                 1.765809e-02 3 1  ON 12
ci_0014                 1.759485e-02 3 1  ON 13
ci_0015                 1.799023e-02 3 1  ON 14
ci_0016                 1.792971e-02 3 1  ON 15
ci_0017                 1.565847e-02 3 1  ON 16
ci_0018                 1.598348e-02 3 1  ON 17
ci_0019                 1.383640e-02 3 1  ON 18
ci_0020                 1.351291e-02 3 1  ON 19
ci_0021                 1.661030e-02 3 1  ON 20
ci_0022                 1.740396e-02 3 1  ON 21
ci_0023                -1.277264e-02 3 1  ON 22
ci_0024                -1.236696e-02 3 1  ON 23
ci_0025                -5.122025e-03 3 1  ON 24
ci_0026                -4.864308e-03 3 1  ON 25
ci_0027                -1.260863e-02 3 1  ON 26
ci_0028                -1.246618e-02 3 1  ON 27
ci_0029                -1.105441e-02 3 1  ON 28
ci_0030                -1.112514e-02 3 1  ON 29
ci_0031                 1.455266e-02 3 1  ON 30
ci_0032                 1.447124e-02 3 1  ON 31
ci_0033                 1.007727e-02 3 1  ON 32
ci_0034                 1.004708e-02 3 1  ON 33
ci_0035                 6.515814e-03 3 1  ON 34
ci_0036                 6.626047e-03 3 1  ON 35
ci_0037                -1.203241e-02 3 1  ON 36
ci_0038                -1.209412e-02 3 1  ON 37
ci_0039                -5.593054e-03 3 1  ON 38
ci_0040                -5.514843e-03 3 1  ON 39
ci_0041                 1.056456e-02 3 1  ON 40
ci_0042                 1.093805e-02 3 1  ON 41
ci_0043                -7.469586e-03 3 1  ON 42
ci_0044                -8.350644e-03 3 1  ON 43
ci_0045                 1.096900e-02 3 1  ON 44
ci_0046                 1.052968e-02 3 1  ON 45
ci_0047                -5.024628e-03 3 1  ON 46
ci_0048                -5.076718e-03 3 1  ON 47
ci_0049                -3.993552e-03 3 1  ON 48
ci_0050                -4.163485e-03 3 1  ON 49
ci_0051                -3.097915e-03 3 1  ON 50
ci_0052                -3.144860e-03 3 1  ON 51
ci_0053                -4.443551e-03 3 1  ON 52
ci_0054                -4.744016e-03 3 1  ON 53
ci_0055                 3.772689e-03 3 1  ON 54
ci_0056                 3.062411e-03 3 1  ON 55
ci_0057                 3.622921e-03 3 1  ON 56
ci_0058                 4.111518e-03 3 1  ON 57
ci_0059                -4.812458e-03 3 1  ON 58
ci_0060                -4.706034e-03 3 1  ON 59
ci_0061                -4.636330e-03 3 1  ON 60
ci_0062                -4.555533e-03 3 1  ON 61
ci_0063                -9.925355e-03 3 1  ON 62
ci_0064                -9.725291e-03 3 1  ON 63
ci_0065                -7.630800e-03 3 1  ON 64
ci_0066                -7.658284e-03 3 1  ON 65
ci_0067                -4.864676e-03 3 1  ON 66
ci_0068                -5.153262e-03 3 1  ON 67
ci_0069                 4.762127e-03 3 1  ON 68
ci_0070                 4.295599e-03 3 1  ON 69
ci_0071                 4.598521e-03 3 1  ON 70
ci_0072                 5.352838e-03 3 1  ON 71
ci_0073                 4.336259e-03 3 1  ON 72
ci_0074                 4.457541e-03 3 1  ON 73
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 4.1568e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s043 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s043 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=43  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6896e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 43
    time step          = 0.05
    reference energy   = -16.9164
    reference variance = 0.287003
====================================================
  Execution time = 1.4830e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s043
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5244e+04
  VMC Eavg = -1.6903e+01
  VMC Evar = 3.1880e-01
  Total weights = 1.951545692e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 2.6856e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.306097699669
                                         uncertainty =       0.001966810826

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.306097699669
                                         uncertainty =       0.001966810826

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000391171035
  error estimate for blocks of size 2^( 2) =       0.000405411866
  error estimate for blocks of size 2^( 3) =       0.000419874377
  error estimate for blocks of size 2^( 4) =       0.000433543031
  error estimate for blocks of size 2^( 5) =       0.000444721907
  error estimate for blocks of size 2^( 6) =       0.000454741241
  error estimate for blocks of size 2^( 7) =       0.000459842201

      target function =      -0.881190814549
              le_mean =     -16.903040960970
             les_mean =     286.031598100042
             stat err =       0.000448212095
             autocorr =       1.312906399532
   target nu stat err =       0.000448212095
   target dn stat err =       0.002941684979
      target stat err =       0.003718119075
              std dev =       0.553199382696
             le_variance =       0.306029557015


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690304096097e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 74
Check correct_vf_var_size: 225, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 6.1035e-01, overlap shift 6.1035e+00 and omega -1.7527e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.881205488194       residual = 4.63e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.881505006248       residual = 7.92e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.881556543429       residual = 2.14e-03           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.881574872866       residual = 6.06e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.881581992681       residual = 3.34e-04           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.881583886909       residual = 2.08e-04           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.881584820732       residual = 5.82e-05           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.881585262558       residual = 2.73e-05           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.881585242419       residual = 1.76e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.881585745884       residual = 1.41e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.881585936460       residual = 1.25e-05           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.881586192275       residual = 7.76e-06           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.881586428064       residual = 5.78e-06           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.881586531672       residual = 1.55e-06           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.881586564827       residual = 4.06e-07           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.881586519352       residual = 6.17e-08           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.881586521832       residual = 1.68e-08           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.881586524774       residual = 8.04e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         17 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 6.1035e-01 is 5.965446e-04

solving harmonic davidson linear method for identity shift 2.4414e+00, overlap shift 2.4414e+01 and omega -1.7527e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.881205488194       residual = 4.63e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.881286928440       residual = 7.79e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.881300696685       residual = 2.06e-03           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.881305452228       residual = 5.73e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.881307288664       residual = 3.09e-04           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.881307740671       residual = 1.86e-04           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.881307960212       residual = 5.10e-05           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.881308066285       residual = 2.42e-05           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.881308059197       residual = 1.58e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.881308189144       residual = 1.29e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.881308234659       residual = 1.07e-05           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.881308294190       residual = 6.26e-06           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.881308344987       residual = 4.15e-06           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.881308364232       residual = 1.01e-06           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.881308370194       residual = 2.49e-07           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.881308360474       residual = 3.71e-08           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.881308361042       residual = 1.07e-08           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.881308361682       residual = 4.88e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         17 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 2.4414e+00 is 1.557040e-04

solving harmonic davidson linear method for identity shift 9.7656e+00, overlap shift 9.7656e+01 and omega -1.7527e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.881205488194       residual = 4.63e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.881226304045       residual = 7.75e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.881229805892       residual = 2.04e-03           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.881231005595       residual = 5.64e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.881231468153       residual = 3.02e-04           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.881231579494       residual = 1.80e-04           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.881231633399       residual = 4.91e-05           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.881231659611       residual = 2.34e-05           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.881231657713       residual = 1.53e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.881231690470       residual = 1.26e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.881231701669       residual = 1.02e-05           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.881231716226       residual = 5.89e-06           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.881231728380       residual = 3.79e-06           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.881231732804       residual = 8.95e-07           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.881231734165       residual = 2.18e-07           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.881231731842       residual = 3.24e-08           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.881231731981       residual = 9.47e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         16 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 9.7656e+00 is 3.936284e-05

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.668827 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 75 and numParams is: 74

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.7531e+01
  </log>
  <optVariables href="H2O.s043.opt.xml">
ci_0001                 7.009571e-01 3 1  ON 0
ci_0002                 6.981839e-01 3 1  ON 1
ci_0003                -3.429195e-02 3 1  ON 2
ci_0004                -3.430959e-02 3 1  ON 3
ci_0005                -3.190456e-02 3 1  ON 4
ci_0006                -3.255735e-02 3 1  ON 5
ci_0007                -2.058653e-02 3 1  ON 6
ci_0008                -2.118112e-02 3 1  ON 7
ci_0009                -2.112440e-02 3 1  ON 8
ci_0010                -2.140569e-02 3 1  ON 9
ci_0011                -1.757237e-02 3 1  ON 10
ci_0012                -1.747533e-02 3 1  ON 11
ci_0013                 1.760870e-02 3 1  ON 12
ci_0014                 1.755475e-02 3 1  ON 13
ci_0015                 1.794383e-02 3 1  ON 14
ci_0016                 1.785974e-02 3 1  ON 15
ci_0017                 1.561138e-02 3 1  ON 16
ci_0018                 1.593947e-02 3 1  ON 17
ci_0019                 1.379442e-02 3 1  ON 18
ci_0020                 1.347456e-02 3 1  ON 19
ci_0021                 1.655151e-02 3 1  ON 20
ci_0022                 1.741474e-02 3 1  ON 21
ci_0023                -1.274562e-02 3 1  ON 22
ci_0024                -1.229324e-02 3 1  ON 23
ci_0025                -5.016520e-03 3 1  ON 24
ci_0026                -4.757439e-03 3 1  ON 25
ci_0027                -1.257646e-02 3 1  ON 26
ci_0028                -1.241983e-02 3 1  ON 27
ci_0029                -1.100348e-02 3 1  ON 28
ci_0030                -1.107489e-02 3 1  ON 29
ci_0031                 1.453301e-02 3 1  ON 30
ci_0032                 1.443087e-02 3 1  ON 31
ci_0033                 1.005853e-02 3 1  ON 32
ci_0034                 1.001067e-02 3 1  ON 33
ci_0035                 6.551709e-03 3 1  ON 34
ci_0036                 6.534982e-03 3 1  ON 35
ci_0037                -1.199965e-02 3 1  ON 36
ci_0038                -1.207174e-02 3 1  ON 37
ci_0039                -5.521719e-03 3 1  ON 38
ci_0040                -5.462977e-03 3 1  ON 39
ci_0041                 1.053207e-02 3 1  ON 40
ci_0042                 1.089848e-02 3 1  ON 41
ci_0043                -7.434419e-03 3 1  ON 42
ci_0044                -8.326583e-03 3 1  ON 43
ci_0045                 1.094173e-02 3 1  ON 44
ci_0046                 1.051183e-02 3 1  ON 45
ci_0047                -4.976619e-03 3 1  ON 46
ci_0048                -5.001817e-03 3 1  ON 47
ci_0049                -3.975430e-03 3 1  ON 48
ci_0050                -4.179955e-03 3 1  ON 49
ci_0051                -3.062081e-03 3 1  ON 50
ci_0052                -3.086540e-03 3 1  ON 51
ci_0053                -4.391529e-03 3 1  ON 52
ci_0054                -4.694628e-03 3 1  ON 53
ci_0055                 3.677380e-03 3 1  ON 54
ci_0056                 3.019635e-03 3 1  ON 55
ci_0057                 3.584793e-03 3 1  ON 56
ci_0058                 4.058112e-03 3 1  ON 57
ci_0059                -4.795622e-03 3 1  ON 58
ci_0060                -4.677790e-03 3 1  ON 59
ci_0061                -4.555738e-03 3 1  ON 60
ci_0062                -4.494443e-03 3 1  ON 61
ci_0063                -9.921699e-03 3 1  ON 62
ci_0064                -9.721142e-03 3 1  ON 63
ci_0065                -7.626492e-03 3 1  ON 64
ci_0066                -7.632223e-03 3 1  ON 65
ci_0067                -4.845911e-03 3 1  ON 66
ci_0068                -5.114736e-03 3 1  ON 67
ci_0069                 4.708891e-03 3 1  ON 68
ci_0070                 4.256939e-03 3 1  ON 69
ci_0071                 4.611071e-03 3 1  ON 70
ci_0072                 5.344365e-03 3 1  ON 71
ci_0073                 4.319414e-03 3 1  ON 72
ci_0074                 4.442695e-03 3 1  ON 73
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 43
    time step          = 0.05
    reference energy   = -16.9011
    reference variance = 0.205766
====================================================
  Execution time = 1.4596e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s043
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6903e+01
  VMC Evar = 3.1679e-01
  Total weights = 1.9517e+06
  Execution time = 1.9502e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.306416347127
                                         uncertainty =       0.002012391991

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.306416347127
                                         uncertainty =       0.002012391991

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000391390679
  error estimate for blocks of size 2^( 2) =       0.000405743406
  error estimate for blocks of size 2^( 3) =       0.000419993299
  error estimate for blocks of size 2^( 4) =       0.000433978493
  error estimate for blocks of size 2^( 5) =       0.000445969866
  error estimate for blocks of size 2^( 6) =       0.000453916681
  error estimate for blocks of size 2^( 7) =       0.000458416631

      target function =      -0.883479616001
              le_mean =     -16.903108151527
             les_mean =     286.032048148729
             stat err =       0.000448070418
             autocorr =       1.310604294576
   target nu stat err =       0.000448070418
   target dn stat err =       0.002441783958
      target stat err =       0.003122528225
              std dev =       0.553510006242
             le_variance =       0.306373327010

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.305933496125
                                         uncertainty =       0.002003029969

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.305933496125
                                         uncertainty =       0.002003029969

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000391082191
  error estimate for blocks of size 2^( 2) =       0.000405474017
  error estimate for blocks of size 2^( 3) =       0.000419762019
  error estimate for blocks of size 2^( 4) =       0.000433779471
  error estimate for blocks of size 2^( 5) =       0.000445783267
  error estimate for blocks of size 2^( 6) =       0.000453739848
  error estimate for blocks of size 2^( 7) =       0.000458255327

      target function =      -0.881486762438
              le_mean =     -16.903118992792
             les_mean =     286.034006152975
             stat err =       0.000447889478
             autocorr =       1.311612783698
   target nu stat err =       0.000447889478
   target dn stat err =       0.003079509475
      target stat err =       0.003890370022
              std dev =       0.553073738970
             le_variance =       0.305890560738

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.306142785313
                                         uncertainty =       0.002007075386

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.306142785313
                                         uncertainty =       0.002007075386

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000391215937
  error estimate for blocks of size 2^( 2) =       0.000405589638
  error estimate for blocks of size 2^( 3) =       0.000419859815
  error estimate for blocks of size 2^( 4) =       0.000433862478
  error estimate for blocks of size 2^( 5) =       0.000445860668
  error estimate for blocks of size 2^( 6) =       0.000453813125
  error estimate for blocks of size 2^( 7) =       0.000458321768

      target function =      -0.883763418776
              le_mean =     -16.903112552726
             les_mean =     286.031970944510
             stat err =       0.000447964510
             autocorr =       1.311155315875
   target nu stat err =       0.000447964510
   target dn stat err =       0.002426937384
      target stat err =       0.003106273886
              std dev =       0.553262883676
             le_variance =       0.306099818454

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.306379839512
                                         uncertainty =       0.002011681172

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.306379839512
                                         uncertainty =       0.002011681172

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000391367364
  error estimate for blocks of size 2^( 2) =       0.000405722729
  error estimate for blocks of size 2^( 3) =       0.000419975192
  error estimate for blocks of size 2^( 4) =       0.000433962594
  error estimate for blocks of size 2^( 5) =       0.000445954862
  error estimate for blocks of size 2^( 6) =       0.000453902373
  error estimate for blocks of size 2^( 7) =       0.000458403446

      target function =      -0.883551556446
              le_mean =     -16.903108490866
             les_mean =     286.032002224014
             stat err =       0.000448055819
             autocorr =       1.310675039802
   target nu stat err =       0.000448055819
   target dn stat err =       0.002439083498
      target stat err =       0.003119712688
              std dev =       0.553477034120
             le_variance =       0.306336827298


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.883479616001        initial
     6.1035e-01     6.1035e+00             5.9654e-04        -0.881486762438
     2.4414e+00     2.4414e+01             1.5570e-04        -0.883763418776  <--
     9.7656e+00     9.7656e+01             3.9363e-05        -0.883551556446

*****************************************************************************
Applying the update for shift_i =   2.4414e+00     and shift_s =   2.4414e+01
*****************************************************************************

  Execution time = 2.4451e+01
  </log>
  <optVariables href="H2O.s043.opt.xml">
ci_0001                 7.009571e-01 3 1  ON 0
ci_0002                 6.981839e-01 3 1  ON 1
ci_0003                -3.429195e-02 3 1  ON 2
ci_0004                -3.430959e-02 3 1  ON 3
ci_0005                -3.190456e-02 3 1  ON 4
ci_0006                -3.255735e-02 3 1  ON 5
ci_0007                -2.058653e-02 3 1  ON 6
ci_0008                -2.118112e-02 3 1  ON 7
ci_0009                -2.112440e-02 3 1  ON 8
ci_0010                -2.140569e-02 3 1  ON 9
ci_0011                -1.757237e-02 3 1  ON 10
ci_0012                -1.747533e-02 3 1  ON 11
ci_0013                 1.760870e-02 3 1  ON 12
ci_0014                 1.755475e-02 3 1  ON 13
ci_0015                 1.794383e-02 3 1  ON 14
ci_0016                 1.785974e-02 3 1  ON 15
ci_0017                 1.561138e-02 3 1  ON 16
ci_0018                 1.593947e-02 3 1  ON 17
ci_0019                 1.379442e-02 3 1  ON 18
ci_0020                 1.347456e-02 3 1  ON 19
ci_0021                 1.655151e-02 3 1  ON 20
ci_0022                 1.741474e-02 3 1  ON 21
ci_0023                -1.274562e-02 3 1  ON 22
ci_0024                -1.229324e-02 3 1  ON 23
ci_0025                -5.016520e-03 3 1  ON 24
ci_0026                -4.757439e-03 3 1  ON 25
ci_0027                -1.257646e-02 3 1  ON 26
ci_0028                -1.241983e-02 3 1  ON 27
ci_0029                -1.100348e-02 3 1  ON 28
ci_0030                -1.107489e-02 3 1  ON 29
ci_0031                 1.453301e-02 3 1  ON 30
ci_0032                 1.443087e-02 3 1  ON 31
ci_0033                 1.005853e-02 3 1  ON 32
ci_0034                 1.001067e-02 3 1  ON 33
ci_0035                 6.551709e-03 3 1  ON 34
ci_0036                 6.534982e-03 3 1  ON 35
ci_0037                -1.199965e-02 3 1  ON 36
ci_0038                -1.207174e-02 3 1  ON 37
ci_0039                -5.521719e-03 3 1  ON 38
ci_0040                -5.462977e-03 3 1  ON 39
ci_0041                 1.053207e-02 3 1  ON 40
ci_0042                 1.089848e-02 3 1  ON 41
ci_0043                -7.434419e-03 3 1  ON 42
ci_0044                -8.326583e-03 3 1  ON 43
ci_0045                 1.094173e-02 3 1  ON 44
ci_0046                 1.051183e-02 3 1  ON 45
ci_0047                -4.976619e-03 3 1  ON 46
ci_0048                -5.001817e-03 3 1  ON 47
ci_0049                -3.975430e-03 3 1  ON 48
ci_0050                -4.179955e-03 3 1  ON 49
ci_0051                -3.062081e-03 3 1  ON 50
ci_0052                -3.086540e-03 3 1  ON 51
ci_0053                -4.391529e-03 3 1  ON 52
ci_0054                -4.694628e-03 3 1  ON 53
ci_0055                 3.677380e-03 3 1  ON 54
ci_0056                 3.019635e-03 3 1  ON 55
ci_0057                 3.584793e-03 3 1  ON 56
ci_0058                 4.058112e-03 3 1  ON 57
ci_0059                -4.795622e-03 3 1  ON 58
ci_0060                -4.677790e-03 3 1  ON 59
ci_0061                -4.555738e-03 3 1  ON 60
ci_0062                -4.494443e-03 3 1  ON 61
ci_0063                -9.921699e-03 3 1  ON 62
ci_0064                -9.721142e-03 3 1  ON 63
ci_0065                -7.626492e-03 3 1  ON 64
ci_0066                -7.632223e-03 3 1  ON 65
ci_0067                -4.845911e-03 3 1  ON 66
ci_0068                -5.114736e-03 3 1  ON 67
ci_0069                 4.708891e-03 3 1  ON 68
ci_0070                 4.256939e-03 3 1  ON 69
ci_0071                 4.611071e-03 3 1  ON 70
ci_0072                 5.344365e-03 3 1  ON 71
ci_0073                 4.319414e-03 3 1  ON 72
ci_0074                 4.442695e-03 3 1  ON 73
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 4.1988e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s044 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s044 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=44  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6896e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 44
    time step          = 0.05
    reference energy   = -16.932
    reference variance = 0.295386
====================================================
  Execution time = 1.4820e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s044
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5214e+04
  VMC Eavg = -1.6904e+01
  VMC Evar = 3.2486e-01
  Total weights = 1.951484524e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 2.6932e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.305756992191
                                         uncertainty =       0.001809734147

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.305756992191
                                         uncertainty =       0.001809734147

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000390961331
  error estimate for blocks of size 2^( 2) =       0.000405040014
  error estimate for blocks of size 2^( 3) =       0.000420500551
  error estimate for blocks of size 2^( 4) =       0.000433859111
  error estimate for blocks of size 2^( 5) =       0.000445516643
  error estimate for blocks of size 2^( 6) =       0.000455250968
  error estimate for blocks of size 2^( 7) =       0.000463703706

      target function =      -0.873837132091
              le_mean =     -16.904410134163
             les_mean =     286.083940689538
             stat err =       0.000449582607
             autocorr =       1.322365144347
   target nu stat err =       0.000449582607
   target dn stat err =       0.006003831916
      target stat err =       0.007396847273
              std dev =       0.552902816869
             le_variance =       0.305701524902


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690441013416e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 74
Check correct_vf_var_size: 225, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 6.1035e-01, overlap shift 6.1035e+00 and omega -1.7527e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.873898717219       residual = 4.95e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.874217048998       residual = 7.85e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.874270657569       residual = 2.22e-03           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.874286056625       residual = 6.15e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.874293016114       residual = 3.67e-04           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.874297604774       residual = 2.76e-04           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.874300432271       residual = 1.25e-04           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.874302300862       residual = 7.80e-05           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.874303571873       residual = 8.48e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.874304829093       residual = 5.77e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.874305774812       residual = 3.48e-05           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.874306035178       residual = 1.17e-05           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.874306180774       residual = 6.93e-06           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.874306288828       residual = 1.27e-06           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.874306322576       residual = 3.72e-07           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.874306306950       residual = 5.23e-08           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.874306296700       residual = 1.76e-08           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.874306301362       residual = 7.49e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         17 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 6.1035e-01 is 1.053096e-03

solving harmonic davidson linear method for identity shift 2.4414e+00, overlap shift 2.4414e+01 and omega -1.7527e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.873898717219       residual = 4.95e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.873985210829       residual = 7.71e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.873999535263       residual = 2.14e-03           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.874003530448       residual = 5.82e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.874005332619       residual = 3.45e-04           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.874006499243       residual = 2.51e-04           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.874007195326       residual = 1.12e-04           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.874007659633       residual = 7.10e-05           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.874007966141       residual = 7.53e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.874008259987       residual = 4.84e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.874008464478       residual = 2.65e-05           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.874008514626       residual = 8.68e-06           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.874008542085       residual = 4.75e-06           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.874008563330       residual = 8.13e-07           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.874008569906       residual = 2.25e-07           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.874008566383       residual = 3.14e-08           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.874008564239       residual = 1.13e-08           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.874008565259       residual = 4.56e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         17 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 2.4414e+00 is 2.646950e-04

solving harmonic davidson linear method for identity shift 9.7656e+00, overlap shift 9.7656e+01 and omega -1.7527e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.873898717219       residual = 4.95e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.873920820268       residual = 7.68e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.873924463791       residual = 2.12e-03           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.873925471673       residual = 5.74e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.873925926127       residual = 3.39e-04           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.873926218798       residual = 2.45e-04           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.873926391915       residual = 1.09e-04           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.873926507715       residual = 6.93e-05           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.873926583484       residual = 7.29e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.873926655487       residual = 4.61e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.873926704538       residual = 2.46e-05           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.873926716185       residual = 8.01e-06           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.873926722527       residual = 4.28e-06           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.873926727507       residual = 7.20e-07           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.873926729044       residual = 1.96e-07           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.873926728191       residual = 2.73e-08           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.873926727680       residual = 1.00e-08           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.873926727926       residual = 3.98e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         17 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 9.7656e+00 is 6.627039e-05

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.679071 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 75 and numParams is: 74

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.7529e+01
  </log>
  <optVariables href="H2O.s044.opt.xml">
ci_0001                 7.007529e-01 3 1  ON 0
ci_0002                 6.984486e-01 3 1  ON 1
ci_0003                -3.417981e-02 3 1  ON 2
ci_0004                -3.424042e-02 3 1  ON 3
ci_0005                -3.175933e-02 3 1  ON 4
ci_0006                -3.250759e-02 3 1  ON 5
ci_0007                -2.048736e-02 3 1  ON 6
ci_0008                -2.104224e-02 3 1  ON 7
ci_0009                -2.104552e-02 3 1  ON 8
ci_0010                -2.135767e-02 3 1  ON 9
ci_0011                -1.750769e-02 3 1  ON 10
ci_0012                -1.742291e-02 3 1  ON 11
ci_0013                 1.754538e-02 3 1  ON 12
ci_0014                 1.748756e-02 3 1  ON 13
ci_0015                 1.786152e-02 3 1  ON 14
ci_0016                 1.779567e-02 3 1  ON 15
ci_0017                 1.553696e-02 3 1  ON 16
ci_0018                 1.587974e-02 3 1  ON 17
ci_0019                 1.375025e-02 3 1  ON 18
ci_0020                 1.342017e-02 3 1  ON 19
ci_0021                 1.659174e-02 3 1  ON 20
ci_0022                 1.740409e-02 3 1  ON 21
ci_0023                -1.267889e-02 3 1  ON 22
ci_0024                -1.225693e-02 3 1  ON 23
ci_0025                -4.933282e-03 3 1  ON 24
ci_0026                -4.624426e-03 3 1  ON 25
ci_0027                -1.254183e-02 3 1  ON 26
ci_0028                -1.241986e-02 3 1  ON 27
ci_0029                -1.097696e-02 3 1  ON 28
ci_0030                -1.102550e-02 3 1  ON 29
ci_0031                 1.451532e-02 3 1  ON 30
ci_0032                 1.443298e-02 3 1  ON 31
ci_0033                 1.000834e-02 3 1  ON 32
ci_0034                 9.996594e-03 3 1  ON 33
ci_0035                 6.505868e-03 3 1  ON 34
ci_0036                 6.523621e-03 3 1  ON 35
ci_0037                -1.201229e-02 3 1  ON 36
ci_0038                -1.205800e-02 3 1  ON 37
ci_0039                -5.459941e-03 3 1  ON 38
ci_0040                -5.404461e-03 3 1  ON 39
ci_0041                 1.049978e-02 3 1  ON 40
ci_0042                 1.084521e-02 3 1  ON 41
ci_0043                -7.391152e-03 3 1  ON 42
ci_0044                -8.314642e-03 3 1  ON 43
ci_0045                 1.094694e-02 3 1  ON 44
ci_0046                 1.050858e-02 3 1  ON 45
ci_0047                -4.909244e-03 3 1  ON 46
ci_0048                -4.948949e-03 3 1  ON 47
ci_0049                -3.920422e-03 3 1  ON 48
ci_0050                -4.102242e-03 3 1  ON 49
ci_0051                -3.014853e-03 3 1  ON 50
ci_0052                -3.042878e-03 3 1  ON 51
ci_0053                -4.375310e-03 3 1  ON 52
ci_0054                -4.667417e-03 3 1  ON 53
ci_0055                 3.631833e-03 3 1  ON 54
ci_0056                 2.943478e-03 3 1  ON 55
ci_0057                 3.525821e-03 3 1  ON 56
ci_0058                 4.002141e-03 3 1  ON 57
ci_0059                -4.773213e-03 3 1  ON 58
ci_0060                -4.593522e-03 3 1  ON 59
ci_0061                -4.510331e-03 3 1  ON 60
ci_0062                -4.465838e-03 3 1  ON 61
ci_0063                -9.937345e-03 3 1  ON 62
ci_0064                -9.722688e-03 3 1  ON 63
ci_0065                -7.585412e-03 3 1  ON 64
ci_0066                -7.609247e-03 3 1  ON 65
ci_0067                -4.806054e-03 3 1  ON 66
ci_0068                -5.071148e-03 3 1  ON 67
ci_0069                 4.675992e-03 3 1  ON 68
ci_0070                 4.197838e-03 3 1  ON 69
ci_0071                 4.641210e-03 3 1  ON 70
ci_0072                 5.303458e-03 3 1  ON 71
ci_0073                 4.294019e-03 3 1  ON 72
ci_0074                 4.435159e-03 3 1  ON 73
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 44
    time step          = 0.05
    reference energy   = -16.8711
    reference variance = 0.179577
====================================================
  Execution time = 1.4552e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s044
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6904e+01
  VMC Evar = 3.2121e-01
  Total weights = 1.9517e+06
  Execution time = 1.9539e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.307928817485
                                         uncertainty =       0.002173339613

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.307928817485
                                         uncertainty =       0.002173339613

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000392504276
  error estimate for blocks of size 2^( 2) =       0.000406832767
  error estimate for blocks of size 2^( 3) =       0.000421759546
  error estimate for blocks of size 2^( 4) =       0.000435166246
  error estimate for blocks of size 2^( 5) =       0.000448194903
  error estimate for blocks of size 2^( 6) =       0.000457212831
  error estimate for blocks of size 2^( 7) =       0.000464236231

      target function =      -0.877824060970
              le_mean =     -16.903596884188
             les_mean =     286.053162610991
             stat err =       0.000451202553
             autocorr =       1.321460879995
   target nu stat err =       0.000451202553
   target dn stat err =       0.003252149109
      target stat err =       0.004073073408
              std dev =       0.555084870761
             le_variance =       0.308119213748

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.307506505350
                                         uncertainty =       0.002177323037

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.307506505350
                                         uncertainty =       0.002177323037

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000392233277
  error estimate for blocks of size 2^( 2) =       0.000406606340
  error estimate for blocks of size 2^( 3) =       0.000421577858
  error estimate for blocks of size 2^( 4) =       0.000435012146
  error estimate for blocks of size 2^( 5) =       0.000448055188
  error estimate for blocks of size 2^( 6) =       0.000457095838
  error estimate for blocks of size 2^( 7) =       0.000464138284

      target function =      -0.878744959663
              le_mean =     -16.903604710500
             les_mean =     286.052685901750
             stat err =       0.000451075364
             autocorr =       1.322541604540
   target nu stat err =       0.000451075364
   target dn stat err =       0.003080670453
      target stat err =       0.003871697083
              std dev =       0.554701620531
             le_variance =       0.307693887819

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.307687111420
                                         uncertainty =       0.002174929176

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.307687111420
                                         uncertainty =       0.002174929176

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000392349280
  error estimate for blocks of size 2^( 2) =       0.000406701641
  error estimate for blocks of size 2^( 3) =       0.000421652400
  error estimate for blocks of size 2^( 4) =       0.000435074250
  error estimate for blocks of size 2^( 5) =       0.000448110501
  error estimate for blocks of size 2^( 6) =       0.000457140541
  error estimate for blocks of size 2^( 7) =       0.000464174422

      target function =      -0.878619069685
              le_mean =     -16.903599625768
             les_mean =     286.052614535932
             stat err =       0.000451124928
             autocorr =       1.322050154944
   target nu stat err =       0.000451124928
   target dn stat err =       0.003136246546
      target stat err =       0.003938540768
              std dev =       0.554865673517
             le_variance =       0.307875915647

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.307896238220
                                         uncertainty =       0.002173494593

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.307896238220
                                         uncertainty =       0.002173494593

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000392483397
  error estimate for blocks of size 2^( 2) =       0.000406814910
  error estimate for blocks of size 2^( 3) =       0.000421744726
  error estimate for blocks of size 2^( 4) =       0.000435153365
  error estimate for blocks of size 2^( 5) =       0.000448182980
  error estimate for blocks of size 2^( 6) =       0.000457202466
  error estimate for blocks of size 2^( 7) =       0.000464227243

      target function =      -0.877952615704
              le_mean =     -16.903597034059
             les_mean =     286.053063949829
             stat err =       0.000451191514
             autocorr =       1.321536814275
   target nu stat err =       0.000451191514
   target dn stat err =       0.003234219547
      target stat err =       0.004052336368
              std dev =       0.555055342741
             le_variance =       0.308086433505


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.877824060970        initial
     6.1035e-01     6.1035e+00             1.0531e-03        -0.878744959663  <--
     2.4414e+00     2.4414e+01             2.6469e-04        -0.878619069685
     9.7656e+00     9.7656e+01             6.6270e-05        -0.877952615704

*****************************************************************************
Applying the update for shift_i =   6.1035e-01     and shift_s =   6.1035e+00
*****************************************************************************

  Execution time = 2.4404e+01
  </log>
  <optVariables href="H2O.s044.opt.xml">
ci_0001                 7.001304e-01 3 1  ON 0
ci_0002                 6.992370e-01 3 1  ON 1
ci_0003                -3.386904e-02 3 1  ON 2
ci_0004                -3.405329e-02 3 1  ON 3
ci_0005                -3.135218e-02 3 1  ON 4
ci_0006                -3.237006e-02 3 1  ON 5
ci_0007                -2.020682e-02 3 1  ON 6
ci_0008                -2.064772e-02 3 1  ON 7
ci_0009                -2.082927e-02 3 1  ON 8
ci_0010                -2.122891e-02 3 1  ON 9
ci_0011                -1.733035e-02 3 1  ON 10
ci_0012                -1.728166e-02 3 1  ON 11
ci_0013                 1.737153e-02 3 1  ON 12
ci_0014                 1.730563e-02 3 1  ON 13
ci_0015                 1.763561e-02 3 1  ON 14
ci_0016                 1.762226e-02 3 1  ON 15
ci_0017                 1.533338e-02 3 1  ON 16
ci_0018                 1.571897e-02 3 1  ON 17
ci_0019                 1.362965e-02 3 1  ON 18
ci_0020                 1.327347e-02 3 1  ON 19
ci_0021                 1.670268e-02 3 1  ON 20
ci_0022                 1.737422e-02 3 1  ON 21
ci_0023                -1.249669e-02 3 1  ON 22
ci_0024                -1.215995e-02 3 1  ON 23
ci_0025                -4.709599e-03 3 1  ON 24
ci_0026                -4.268935e-03 3 1  ON 25
ci_0027                -1.244730e-02 3 1  ON 26
ci_0028                -1.242217e-02 3 1  ON 27
ci_0029                -1.090535e-02 3 1  ON 28
ci_0030                -1.089279e-02 3 1  ON 29
ci_0031                 1.446548e-02 3 1  ON 30
ci_0032                 1.443984e-02 3 1  ON 31
ci_0033                 9.867633e-03 3 1  ON 32
ci_0034                 9.959130e-03 3 1  ON 33
ci_0035                 6.382788e-03 3 1  ON 34
ci_0036                 6.494052e-03 3 1  ON 35
ci_0037                -1.204646e-02 3 1  ON 36
ci_0038                -1.202129e-02 3 1  ON 37
ci_0039                -5.293223e-03 3 1  ON 38
ci_0040                -5.247281e-03 3 1  ON 39
ci_0041                 1.041044e-02 3 1  ON 40
ci_0042                 1.069983e-02 3 1  ON 41
ci_0043                -7.271695e-03 3 1  ON 42
ci_0044                -8.282947e-03 3 1  ON 43
ci_0045                 1.096121e-02 3 1  ON 44
ci_0046                 1.050038e-02 3 1  ON 45
ci_0047                -4.727368e-03 3 1  ON 46
ci_0048                -4.806890e-03 3 1  ON 47
ci_0049                -3.773567e-03 3 1  ON 48
ci_0050                -3.894334e-03 3 1  ON 49
ci_0051                -2.888980e-03 3 1  ON 50
ci_0052                -2.926703e-03 3 1  ON 51
ci_0053                -4.331629e-03 3 1  ON 52
ci_0054                -4.594576e-03 3 1  ON 53
ci_0055                 3.510631e-03 3 1  ON 54
ci_0056                 2.739490e-03 3 1  ON 55
ci_0057                 3.366833e-03 3 1  ON 56
ci_0058                 3.851852e-03 3 1  ON 57
ci_0059                -4.712433e-03 3 1  ON 58
ci_0060                -4.368388e-03 3 1  ON 59
ci_0061                -4.386205e-03 3 1  ON 60
ci_0062                -4.388260e-03 3 1  ON 61
ci_0063                -9.979188e-03 3 1  ON 62
ci_0064                -9.727957e-03 3 1  ON 63
ci_0065                -7.472428e-03 3 1  ON 64
ci_0066                -7.547076e-03 3 1  ON 65
ci_0067                -4.699249e-03 3 1  ON 66
ci_0068                -4.954819e-03 3 1  ON 67
ci_0069                 4.587831e-03 3 1  ON 68
ci_0070                 4.039917e-03 3 1  ON 69
ci_0071                 4.720856e-03 3 1  ON 70
ci_0072                 5.193915e-03 3 1  ON 71
ci_0073                 4.225663e-03 3 1  ON 72
ci_0074                 4.415059e-03 3 1  ON 73
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 4.1939e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s045 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s045 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=45  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6896e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 45
    time step          = 0.05
    reference energy   = -16.9763
    reference variance = 0.401714
====================================================
  Execution time = 1.5036e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s045
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5230e+04
  VMC Eavg = -1.6904e+01
  VMC Evar = 3.1534e-01
  Total weights = 1.951926113e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 2.6572e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.302836231927
                                         uncertainty =       0.001928863593

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.302836231927
                                         uncertainty =       0.001928863593

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000389122005
  error estimate for blocks of size 2^( 2) =       0.000403513726
  error estimate for blocks of size 2^( 3) =       0.000417502851
  error estimate for blocks of size 2^( 4) =       0.000431033497
  error estimate for blocks of size 2^( 5) =       0.000441193444
  error estimate for blocks of size 2^( 6) =       0.000448142324
  error estimate for blocks of size 2^( 7) =       0.000450369822

      target function =      -0.885697886497
              le_mean =     -16.904225321043
             les_mean =     286.068176315837
             stat err =       0.000442684772
             autocorr =       1.294248240427
   target nu stat err =       0.000442684772
   target dn stat err =       0.002877739833
      target stat err =       0.003682070227
              std dev =       0.550301617080
             le_variance =       0.302831869760


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690422532104e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 74
Check correct_vf_var_size: 225, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.5259e-01, overlap shift 1.5259e+00 and omega -1.7527e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.885712160750       residual = 3.29e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.886358699855       residual = 6.97e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.886485135115       residual = 2.13e-03           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.886541445695       residual = 5.12e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.886560477435       residual = 2.58e-04           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.886568948835       residual = 1.88e-04           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.886571749076       residual = 5.22e-05           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.886574231658       residual = 1.37e-05           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.886575287167       residual = 4.95e-06           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.886575522494       residual = 1.96e-06           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.886575682346       residual = 1.02e-06           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.886575835482       residual = 3.39e-07           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.886575841856       residual = 4.34e-07           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.886575972878       residual = 4.84e-07           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.886576069190       residual = 5.01e-07           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.886576150462       residual = 1.04e-07           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.886576122397       residual = 4.12e-08           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.886576125789       residual = 1.50e-08           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.886576109454       residual = 5.11e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         18 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 1.5259e-01 is 1.407105e-03

solving harmonic davidson linear method for identity shift 6.1035e-01, overlap shift 6.1035e+00 and omega -1.7527e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.885712160750       residual = 3.29e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.885925741334       residual = 6.61e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.885965585276       residual = 1.92e-03           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.885982098844       residual = 4.35e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.885987541931       residual = 2.11e-04           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.885989733673       residual = 1.36e-04           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.885990343096       residual = 3.53e-05           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.885990938305       residual = 8.68e-06           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.885991169287       residual = 2.88e-06           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.885991213466       residual = 1.15e-06           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.885991246195       residual = 5.70e-07           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.885991282141       residual = 2.18e-07           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.885991284512       residual = 3.07e-07           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.885991319466       residual = 2.84e-07           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.885991331444       residual = 1.50e-07           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.885991339493       residual = 2.66e-08           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.885991332049       residual = 9.60e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         16 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 6.1035e-01 is 4.410957e-04

solving harmonic davidson linear method for identity shift 2.4414e+00, overlap shift 2.4414e+01 and omega -1.7527e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.885712160750       residual = 3.29e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.885770217065       residual = 6.48e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.885780863492       residual = 1.85e-03           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.885785162696       residual = 4.11e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.885786568290       residual = 1.96e-04           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.885787113589       residual = 1.21e-04           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.885787255630       residual = 3.07e-05           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.885787400479       residual = 7.39e-06           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.885787454822       residual = 2.39e-06           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.885787464610       residual = 9.60e-07           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.885787472218       residual = 4.69e-07           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.885787481022       residual = 1.91e-07           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.885787481699       residual = 2.71e-07           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.885787490246       residual = 2.24e-07           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.885787492264       residual = 9.51e-08           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.885787493652       residual = 1.69e-08           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.885787491847       residual = 5.91e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         16 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 2.4414e+00 is 1.177969e-04

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.689119 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 75 and numParams is: 74

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.7709e+01
  </log>
  <optVariables href="H2O.s045.opt.xml">
ci_0001                 7.001508e-01 3 1  ON 0
ci_0002                 6.994315e-01 3 1  ON 1
ci_0003                -3.342794e-02 3 1  ON 2
ci_0004                -3.376937e-02 3 1  ON 3
ci_0005                -3.099595e-02 3 1  ON 4
ci_0006                -3.199535e-02 3 1  ON 5
ci_0007                -1.988711e-02 3 1  ON 6
ci_0008                -2.026336e-02 3 1  ON 7
ci_0009                -2.071232e-02 3 1  ON 8
ci_0010                -2.094778e-02 3 1  ON 9
ci_0011                -1.720828e-02 3 1  ON 10
ci_0012                -1.698582e-02 3 1  ON 11
ci_0013                 1.715539e-02 3 1  ON 12
ci_0014                 1.719172e-02 3 1  ON 13
ci_0015                 1.737724e-02 3 1  ON 14
ci_0016                 1.750245e-02 3 1  ON 15
ci_0017                 1.507174e-02 3 1  ON 16
ci_0018                 1.547990e-02 3 1  ON 17
ci_0019                 1.353566e-02 3 1  ON 18
ci_0020                 1.308799e-02 3 1  ON 19
ci_0021                 1.654655e-02 3 1  ON 20
ci_0022                 1.726314e-02 3 1  ON 21
ci_0023                -1.242407e-02 3 1  ON 22
ci_0024                -1.209060e-02 3 1  ON 23
ci_0025                -4.391591e-03 3 1  ON 24
ci_0026                -4.061323e-03 3 1  ON 25
ci_0027                -1.234569e-02 3 1  ON 26
ci_0028                -1.220161e-02 3 1  ON 27
ci_0029                -1.074858e-02 3 1  ON 28
ci_0030                -1.071753e-02 3 1  ON 29
ci_0031                 1.438482e-02 3 1  ON 30
ci_0032                 1.439522e-02 3 1  ON 31
ci_0033                 9.814904e-03 3 1  ON 32
ci_0034                 9.611265e-03 3 1  ON 33
ci_0035                 6.387102e-03 3 1  ON 34
ci_0036                 6.428897e-03 3 1  ON 35
ci_0037                -1.200459e-02 3 1  ON 36
ci_0038                -1.186559e-02 3 1  ON 37
ci_0039                -4.967651e-03 3 1  ON 38
ci_0040                -5.082888e-03 3 1  ON 39
ci_0041                 1.024965e-02 3 1  ON 40
ci_0042                 1.064467e-02 3 1  ON 41
ci_0043                -7.111312e-03 3 1  ON 42
ci_0044                -8.041057e-03 3 1  ON 43
ci_0045                 1.096277e-02 3 1  ON 44
ci_0046                 1.037771e-02 3 1  ON 45
ci_0047                -4.572095e-03 3 1  ON 46
ci_0048                -4.628993e-03 3 1  ON 47
ci_0049                -3.504708e-03 3 1  ON 48
ci_0050                -3.674786e-03 3 1  ON 49
ci_0051                -2.774745e-03 3 1  ON 50
ci_0052                -2.782919e-03 3 1  ON 51
ci_0053                -4.126128e-03 3 1  ON 52
ci_0054                -4.471785e-03 3 1  ON 53
ci_0055                 3.325770e-03 3 1  ON 54
ci_0056                 2.670419e-03 3 1  ON 55
ci_0057                 3.181409e-03 3 1  ON 56
ci_0058                 3.650438e-03 3 1  ON 57
ci_0059                -4.604259e-03 3 1  ON 58
ci_0060                -4.302902e-03 3 1  ON 59
ci_0061                -4.100091e-03 3 1  ON 60
ci_0062                -4.237495e-03 3 1  ON 61
ci_0063                -9.936472e-03 3 1  ON 62
ci_0064                -9.746479e-03 3 1  ON 63
ci_0065                -7.501656e-03 3 1  ON 64
ci_0066                -7.467532e-03 3 1  ON 65
ci_0067                -4.588070e-03 3 1  ON 66
ci_0068                -4.879466e-03 3 1  ON 67
ci_0069                 4.503302e-03 3 1  ON 68
ci_0070                 3.916480e-03 3 1  ON 69
ci_0071                 4.743129e-03 3 1  ON 70
ci_0072                 5.068988e-03 3 1  ON 71
ci_0073                 4.101810e-03 3 1  ON 72
ci_0074                 4.367006e-03 3 1  ON 73
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 45
    time step          = 0.05
    reference energy   = -16.9296
    reference variance = 0.201118
====================================================
  Execution time = 1.6222e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s045
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6904e+01
  VMC Evar = 3.1451e-01
  Total weights = 1.9521e+06
  Execution time = 1.9616e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.303344388981
                                         uncertainty =       0.001933306484

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.303344388981
                                         uncertainty =       0.001933306484

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000389407721
  error estimate for blocks of size 2^( 2) =       0.000403443283
  error estimate for blocks of size 2^( 3) =       0.000417300996
  error estimate for blocks of size 2^( 4) =       0.000429843304
  error estimate for blocks of size 2^( 5) =       0.000440957827
  error estimate for blocks of size 2^( 6) =       0.000446638704
  error estimate for blocks of size 2^( 7) =       0.000450330983

      target function =      -0.880091876762
              le_mean =     -16.904073598406
             les_mean =     286.067480100676
             stat err =       0.000441942704
             autocorr =       1.288020635241
   target nu stat err =       0.000441942704
   target dn stat err =       0.005146297245
      target stat err =       0.006434787021
              std dev =       0.550705680476
             le_variance =       0.303276746509

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.302872406579
                                         uncertainty =       0.001979466746

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.302872406579
                                         uncertainty =       0.001979466746

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000389103468
  error estimate for blocks of size 2^( 2) =       0.000403243891
  error estimate for blocks of size 2^( 3) =       0.000417228844
  error estimate for blocks of size 2^( 4) =       0.000429860604
  error estimate for blocks of size 2^( 5) =       0.000441026861
  error estimate for blocks of size 2^( 6) =       0.000446757125
  error estimate for blocks of size 2^( 7) =       0.000450461609

      target function =      -0.874220281334
              le_mean =     -16.904096861061
             les_mean =     286.072945815121
             stat err =       0.000442026549
             autocorr =       1.290525252287
   target nu stat err =       0.000442026549
   target dn stat err =       0.008876924136
      target stat err =       0.010919278982
              std dev =       0.550275401617
             le_variance =       0.302803017625

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.303022290839
                                         uncertainty =       0.001951828679

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.303022290839
                                         uncertainty =       0.001951828679

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000389199981
  error estimate for blocks of size 2^( 2) =       0.000403301651
  error estimate for blocks of size 2^( 3) =       0.000417230616
  error estimate for blocks of size 2^( 4) =       0.000429827831
  error estimate for blocks of size 2^( 5) =       0.000440958842
  error estimate for blocks of size 2^( 6) =       0.000446682337
  error estimate for blocks of size 2^( 7) =       0.000450389560

      target function =      -0.771171019589
              le_mean =     -16.904083277360
             les_mean =     286.156613232594
             stat err =       0.000441964643
             autocorr =       1.289524010803
   target nu stat err =       0.000441964643
   target dn stat err =       0.094129979553
      target stat err =       0.091195474107
              std dev =       0.550411891732
             le_variance =       0.302953250560

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.303267144018
                                         uncertainty =       0.001934790378

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.303267144018
                                         uncertainty =       0.001934790378

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000389358013
  error estimate for blocks of size 2^( 2) =       0.000403401449
  error estimate for blocks of size 2^( 3) =       0.000417269479
  error estimate for blocks of size 2^( 4) =       0.000429818691
  error estimate for blocks of size 2^( 5) =       0.000440937566
  error estimate for blocks of size 2^( 6) =       0.000446622591
  error estimate for blocks of size 2^( 7) =       0.000450318483

      target function =      -0.885226183550
              le_mean =     -16.904072038509
             les_mean =     286.063353464951
             stat err =       0.000441924333
             autocorr =       1.288242424208
   target nu stat err =       0.000441924333
   target dn stat err =       0.002536896179
      target stat err =       0.003255131113
              std dev =       0.550635382101
             le_variance =       0.303199324021


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.880091876762        initial
     1.5259e-01     1.5259e+00             1.4071e-03        -0.874220281334
     6.1035e-01     6.1035e+00             4.4110e-04        -0.771171019589
     2.4414e+00     2.4414e+01             1.1780e-04        -0.885226183550  <--

*****************************************************************************
Applying the update for shift_i =   2.4414e+00     and shift_s =   2.4414e+01
*****************************************************************************

  Execution time = 2.6124e+01
  </log>
  <optVariables href="H2O.s045.opt.xml">
ci_0001                 7.001372e-01 3 1  ON 0
ci_0002                 6.992875e-01 3 1  ON 1
ci_0003                -3.375124e-02 3 1  ON 2
ci_0004                -3.397729e-02 3 1  ON 3
ci_0005                -3.125831e-02 3 1  ON 4
ci_0006                -3.227110e-02 3 1  ON 5
ci_0007                -2.012321e-02 3 1  ON 6
ci_0008                -2.054738e-02 3 1  ON 7
ci_0009                -2.079774e-02 3 1  ON 8
ci_0010                -2.115319e-02 3 1  ON 9
ci_0011                -1.729747e-02 3 1  ON 10
ci_0012                -1.720223e-02 3 1  ON 11
ci_0013                 1.731350e-02 3 1  ON 12
ci_0014                 1.727485e-02 3 1  ON 13
ci_0015                 1.756625e-02 3 1  ON 14
ci_0016                 1.758992e-02 3 1  ON 15
ci_0017                 1.526305e-02 3 1  ON 16
ci_0018                 1.565460e-02 3 1  ON 17
ci_0019                 1.360411e-02 3 1  ON 18
ci_0020                 1.322343e-02 3 1  ON 19
ci_0021                 1.666228e-02 3 1  ON 20
ci_0022                 1.734574e-02 3 1  ON 21
ci_0023                -1.247701e-02 3 1  ON 22
ci_0024                -1.214101e-02 3 1  ON 23
ci_0025                -4.623139e-03 3 1  ON 24
ci_0026                -4.212508e-03 3 1  ON 25
ci_0027                -1.241982e-02 3 1  ON 26
ci_0028                -1.236287e-02 3 1  ON 27
ci_0029                -1.086299e-02 3 1  ON 28
ci_0030                -1.084547e-02 3 1  ON 29
ci_0031                 1.444436e-02 3 1  ON 30
ci_0032                 1.442823e-02 3 1  ON 31
ci_0033                 9.853661e-03 3 1  ON 32
ci_0034                 9.867138e-03 3 1  ON 33
ci_0035                 6.384000e-03 3 1  ON 34
ci_0036                 6.476310e-03 3 1  ON 35
ci_0037                -1.203530e-02 3 1  ON 36
ci_0038                -1.197987e-02 3 1  ON 37
ci_0039                -5.204942e-03 3 1  ON 38
ci_0040                -5.202682e-03 3 1  ON 39
ci_0041                 1.036749e-02 3 1  ON 40
ci_0042                 1.068505e-02 3 1  ON 41
ci_0043                -7.229499e-03 3 1  ON 42
ci_0044                -8.219322e-03 3 1  ON 43
ci_0045                 1.096163e-02 3 1  ON 44
ci_0046                 1.046780e-02 3 1  ON 45
ci_0047                -4.685281e-03 3 1  ON 46
ci_0048                -4.758653e-03 3 1  ON 47
ci_0049                -3.700376e-03 3 1  ON 48
ci_0050                -3.834494e-03 3 1  ON 49
ci_0051                -2.857727e-03 3 1  ON 50
ci_0052                -2.887404e-03 3 1  ON 51
ci_0053                -4.275632e-03 3 1  ON 52
ci_0054                -4.561171e-03 3 1  ON 53
ci_0055                 3.460313e-03 3 1  ON 54
ci_0056                 2.720651e-03 3 1  ON 55
ci_0057                 3.316467e-03 3 1  ON 56
ci_0058                 3.797177e-03 3 1  ON 57
ci_0059                -4.682972e-03 3 1  ON 58
ci_0060                -4.350557e-03 3 1  ON 59
ci_0061                -4.309404e-03 3 1  ON 60
ci_0062                -4.347754e-03 3 1  ON 61
ci_0063                -9.967661e-03 3 1  ON 62
ci_0064                -9.732859e-03 3 1  ON 63
ci_0065                -7.480219e-03 3 1  ON 64
ci_0066                -7.525687e-03 3 1  ON 65
ci_0067                -4.668975e-03 3 1  ON 66
ci_0068                -4.934340e-03 3 1  ON 67
ci_0069                 4.564791e-03 3 1  ON 68
ci_0070                 4.006289e-03 3 1  ON 69
ci_0071                 4.727050e-03 3 1  ON 70
ci_0072                 5.159990e-03 3 1  ON 71
ci_0073                 4.191928e-03 3 1  ON 72
ci_0074                 4.401968e-03 3 1  ON 73
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 4.3841e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s046 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s046 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=46  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6897e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 46
    time step          = 0.05
    reference energy   = -16.9031
    reference variance = 0.258381
====================================================
  Execution time = 1.5246e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s046
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5233e+04
  VMC Eavg = -1.6902e+01
  VMC Evar = 3.2177e-01
  Total weights = 1.951417149e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 2.6840e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.308728029969
                                         uncertainty =       0.002382763360

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.308728029969
                                         uncertainty =       0.002382763360

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000392839327
  error estimate for blocks of size 2^( 2) =       0.000406728194
  error estimate for blocks of size 2^( 3) =       0.000421341397
  error estimate for blocks of size 2^( 4) =       0.000433939090
  error estimate for blocks of size 2^( 5) =       0.000444137008
  error estimate for blocks of size 2^( 6) =       0.000452237628
  error estimate for blocks of size 2^( 7) =       0.000456622477

      target function =      -0.877410603916
              le_mean =     -16.902323338268
             les_mean =     286.010306339453
             stat err =       0.000446734051
             autocorr =       1.293207442611
   target nu stat err =       0.000446734051
   target dn stat err =       0.003318628306
      target stat err =       0.004141034992
              std dev =       0.555558704399
             le_variance =       0.308645474033


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690232333827e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 74
Check correct_vf_var_size: 225, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 6.1035e-01, overlap shift 6.1035e+00 and omega -1.7527e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.877428979007       residual = 4.75e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.877746169688       residual = 7.85e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.877792248146       residual = 1.79e-03           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.877809391598       residual = 5.46e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.877815658745       residual = 1.96e-04           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.877819281227       residual = 9.78e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.877820245469       residual = 3.28e-05           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.877820483557       residual = 1.06e-05           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.877820278638       residual = 4.71e-06           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.877820494206       residual = 2.75e-06           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.877820605719       residual = 2.00e-06           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.877820604349       residual = 1.76e-06           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.877820583285       residual = 1.95e-06           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.877820617262       residual = 6.69e-07           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.877820629987       residual = 1.83e-07           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.877820623245       residual = 2.40e-08           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.877820621404       residual = 1.07e-08           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.877820626565       residual = 3.58e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         17 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 6.1035e-01 is 6.401052e-04

solving harmonic davidson linear method for identity shift 2.4414e+00, overlap shift 2.4414e+01 and omega -1.7527e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.877428979007       residual = 4.75e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.877515204436       residual = 7.72e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.877527561867       residual = 1.73e-03           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.877532035196       residual = 5.17e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.877533645341       residual = 1.81e-04           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.877534549632       residual = 8.56e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.877534782636       residual = 2.85e-05           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.877534836135       residual = 9.29e-06           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.877534781847       residual = 4.12e-06           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.877534835583       residual = 2.43e-06           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.877534862809       residual = 1.77e-06           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.877534861261       residual = 1.57e-06           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.877534855229       residual = 1.50e-06           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.877534862822       residual = 4.46e-07           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.877534865457       residual = 1.10e-07           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.877534863944       residual = 1.48e-08           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.877534863563       residual = 6.75e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         16 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 2.4414e+00 is 1.742276e-04

solving harmonic davidson linear method for identity shift 9.7656e+00, overlap shift 9.7656e+01 and omega -1.7527e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.877428979007       residual = 4.75e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.877451016497       residual = 7.68e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.877454162891       residual = 1.71e-03           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.877455293212       residual = 5.10e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.877455698331       residual = 1.77e-04           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.877455924052       residual = 8.25e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.877455981700       residual = 2.74e-05           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.877455994656       residual = 8.95e-06           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.877455980894       residual = 3.97e-06           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.877455994314       residual = 2.35e-06           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.877456001074       residual = 1.72e-06           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.877456000600       residual = 1.52e-06           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.877455999047       residual = 1.39e-06           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.877456000889       residual = 3.98e-07           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.877456001516       residual = 9.59e-08           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.877456001150       residual = 1.30e-08           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.877456001060       residual = 5.95e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         16 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 9.7656e+00 is 4.454537e-05

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.698700 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 75 and numParams is: 74

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.7946e+01
  </log>
  <optVariables href="H2O.s046.opt.xml">
ci_0001                 7.001133e-01 3 1  ON 0
ci_0002                 6.993671e-01 3 1  ON 1
ci_0003                -3.367041e-02 3 1  ON 2
ci_0004                -3.389041e-02 3 1  ON 3
ci_0005                -3.114169e-02 3 1  ON 4
ci_0006                -3.217691e-02 3 1  ON 5
ci_0007                -1.999881e-02 3 1  ON 6
ci_0008                -2.047039e-02 3 1  ON 7
ci_0009                -2.076280e-02 3 1  ON 8
ci_0010                -2.106422e-02 3 1  ON 9
ci_0011                -1.725233e-02 3 1  ON 10
ci_0012                -1.713856e-02 3 1  ON 11
ci_0013                 1.725232e-02 3 1  ON 12
ci_0014                 1.723578e-02 3 1  ON 13
ci_0015                 1.752338e-02 3 1  ON 14
ci_0016                 1.754936e-02 3 1  ON 15
ci_0017                 1.521657e-02 3 1  ON 16
ci_0018                 1.557570e-02 3 1  ON 17
ci_0019                 1.355593e-02 3 1  ON 18
ci_0020                 1.318291e-02 3 1  ON 19
ci_0021                 1.669727e-02 3 1  ON 20
ci_0022                 1.732946e-02 3 1  ON 21
ci_0023                -1.244381e-02 3 1  ON 22
ci_0024                -1.210920e-02 3 1  ON 23
ci_0025                -4.502423e-03 3 1  ON 24
ci_0026                -4.188265e-03 3 1  ON 25
ci_0027                -1.238193e-02 3 1  ON 26
ci_0028                -1.232778e-02 3 1  ON 27
ci_0029                -1.082724e-02 3 1  ON 28
ci_0030                -1.083819e-02 3 1  ON 29
ci_0031                 1.440995e-02 3 1  ON 30
ci_0032                 1.442618e-02 3 1  ON 31
ci_0033                 9.812385e-03 3 1  ON 32
ci_0034                 9.897717e-03 3 1  ON 33
ci_0035                 6.209772e-03 3 1  ON 34
ci_0036                 6.445693e-03 3 1  ON 35
ci_0037                -1.202602e-02 3 1  ON 36
ci_0038                -1.198182e-02 3 1  ON 37
ci_0039                -5.148499e-03 3 1  ON 38
ci_0040                -5.167150e-03 3 1  ON 39
ci_0041                 1.035335e-02 3 1  ON 40
ci_0042                 1.064685e-02 3 1  ON 41
ci_0043                -7.176116e-03 3 1  ON 42
ci_0044                -8.130300e-03 3 1  ON 43
ci_0045                 1.093082e-02 3 1  ON 44
ci_0046                 1.047083e-02 3 1  ON 45
ci_0047                -4.644088e-03 3 1  ON 46
ci_0048                -4.726125e-03 3 1  ON 47
ci_0049                -3.676409e-03 3 1  ON 48
ci_0050                -3.838539e-03 3 1  ON 49
ci_0051                -2.838640e-03 3 1  ON 50
ci_0052                -2.837977e-03 3 1  ON 51
ci_0053                -4.228891e-03 3 1  ON 52
ci_0054                -4.468135e-03 3 1  ON 53
ci_0055                 3.388811e-03 3 1  ON 54
ci_0056                 2.700281e-03 3 1  ON 55
ci_0057                 3.248651e-03 3 1  ON 56
ci_0058                 3.795603e-03 3 1  ON 57
ci_0059                -4.642572e-03 3 1  ON 58
ci_0060                -4.308252e-03 3 1  ON 59
ci_0061                -4.277155e-03 3 1  ON 60
ci_0062                -4.318035e-03 3 1  ON 61
ci_0063                -9.935788e-03 3 1  ON 62
ci_0064                -9.715081e-03 3 1  ON 63
ci_0065                -7.461216e-03 3 1  ON 64
ci_0066                -7.506187e-03 3 1  ON 65
ci_0067                -4.662308e-03 3 1  ON 66
ci_0068                -4.875834e-03 3 1  ON 67
ci_0069                 4.521159e-03 3 1  ON 68
ci_0070                 3.974827e-03 3 1  ON 69
ci_0071                 4.687891e-03 3 1  ON 70
ci_0072                 5.072852e-03 3 1  ON 71
ci_0073                 4.173397e-03 3 1  ON 72
ci_0074                 4.396704e-03 3 1  ON 73
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 46
    time step          = 0.05
    reference energy   = -16.9453
    reference variance = 0.166266
====================================================
  Execution time = 1.4833e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s046
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6903e+01
  VMC Evar = 3.1923e-01
  Total weights = 1.9517e+06
  Execution time = 1.9704e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.306010236308
                                         uncertainty =       0.001958270245

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.306010236308
                                         uncertainty =       0.001958270245

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000391151673
  error estimate for blocks of size 2^( 2) =       0.000405404720
  error estimate for blocks of size 2^( 3) =       0.000420057131
  error estimate for blocks of size 2^( 4) =       0.000432863383
  error estimate for blocks of size 2^( 5) =       0.000444193677
  error estimate for blocks of size 2^( 6) =       0.000451754178
  error estimate for blocks of size 2^( 7) =       0.000456746365

      target function =      -0.880344012376
              le_mean =     -16.903210787183
             les_mean =     286.038039346111
             stat err =       0.000446389401
             autocorr =       1.302378938860
   target nu stat err =       0.000446389401
   target dn stat err =       0.002876767091
      target stat err =       0.003632129331
              std dev =       0.553172000262
             le_variance =       0.305999261874

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.305641562682
                                         uncertainty =       0.001951216011

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.305641562682
                                         uncertainty =       0.001951216011

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000390916207
  error estimate for blocks of size 2^( 2) =       0.000405216289
  error estimate for blocks of size 2^( 3) =       0.000419913282
  error estimate for blocks of size 2^( 4) =       0.000432768170
  error estimate for blocks of size 2^( 5) =       0.000444117995
  error estimate for blocks of size 2^( 6) =       0.000451698161
  error estimate for blocks of size 2^( 7) =       0.000456672765

      target function =      -0.880667837120
              le_mean =     -16.903212026923
             les_mean =     286.037821748279
             stat err =       0.000446314273
             autocorr =       1.303509491180
   target nu stat err =       0.000446314273
   target dn stat err =       0.002789182326
      target stat err =       0.003527466687
              std dev =       0.552839002198
             le_variance =       0.305630962352

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.305798437845
                                         uncertainty =       0.001954284975

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.305798437845
                                         uncertainty =       0.001954284975

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000391016405
  error estimate for blocks of size 2^( 2) =       0.000405294668
  error estimate for blocks of size 2^( 3) =       0.000419971053
  error estimate for blocks of size 2^( 4) =       0.000432803439
  error estimate for blocks of size 2^( 5) =       0.000444145065
  error estimate for blocks of size 2^( 6) =       0.000451717417
  error estimate for blocks of size 2^( 7) =       0.000456701137

      target function =      -0.880832902611
              le_mean =     -16.903210276849
             les_mean =     286.037629565437
             stat err =       0.000446341765
             autocorr =       1.303002037229
   target nu stat err =       0.000446341765
   target dn stat err =       0.002813376544
      target stat err =       0.003558401645
              std dev =       0.552980703256
             le_variance =       0.305787658174

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.305981585701
                                         uncertainty =       0.001957735519

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.305981585701
                                         uncertainty =       0.001957735519

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000391133376
  error estimate for blocks of size 2^( 2) =       0.000405389625
  error estimate for blocks of size 2^( 3) =       0.000420045065
  error estimate for blocks of size 2^( 4) =       0.000432854606
  error estimate for blocks of size 2^( 5) =       0.000444186355
  error estimate for blocks of size 2^( 6) =       0.000451748340
  error estimate for blocks of size 2^( 7) =       0.000456739440

      target function =      -0.880458912290
              le_mean =     -16.903210509964
             les_mean =     286.037937622595
             stat err =       0.000446382185
             autocorr =       1.302458679804
   target nu stat err =       0.000446382185
   target dn stat err =       0.002867259263
      target stat err =       0.003621414333
              std dev =       0.553146125251
             le_variance =       0.305970635881


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.880344012376        initial
     6.1035e-01     6.1035e+00             6.4011e-04        -0.880667837120
     2.4414e+00     2.4414e+01             1.7423e-04        -0.880832902611  <--
     9.7656e+00     9.7656e+01             4.4545e-05        -0.880458912290

*****************************************************************************
Applying the update for shift_i =   2.4414e+00     and shift_s =   2.4414e+01
*****************************************************************************

  Execution time = 2.4691e+01
  </log>
  <optVariables href="H2O.s046.opt.xml">
ci_0001                 7.001133e-01 3 1  ON 0
ci_0002                 6.993671e-01 3 1  ON 1
ci_0003                -3.367041e-02 3 1  ON 2
ci_0004                -3.389041e-02 3 1  ON 3
ci_0005                -3.114169e-02 3 1  ON 4
ci_0006                -3.217691e-02 3 1  ON 5
ci_0007                -1.999881e-02 3 1  ON 6
ci_0008                -2.047039e-02 3 1  ON 7
ci_0009                -2.076280e-02 3 1  ON 8
ci_0010                -2.106422e-02 3 1  ON 9
ci_0011                -1.725233e-02 3 1  ON 10
ci_0012                -1.713856e-02 3 1  ON 11
ci_0013                 1.725232e-02 3 1  ON 12
ci_0014                 1.723578e-02 3 1  ON 13
ci_0015                 1.752338e-02 3 1  ON 14
ci_0016                 1.754936e-02 3 1  ON 15
ci_0017                 1.521657e-02 3 1  ON 16
ci_0018                 1.557570e-02 3 1  ON 17
ci_0019                 1.355593e-02 3 1  ON 18
ci_0020                 1.318291e-02 3 1  ON 19
ci_0021                 1.669727e-02 3 1  ON 20
ci_0022                 1.732946e-02 3 1  ON 21
ci_0023                -1.244381e-02 3 1  ON 22
ci_0024                -1.210920e-02 3 1  ON 23
ci_0025                -4.502423e-03 3 1  ON 24
ci_0026                -4.188265e-03 3 1  ON 25
ci_0027                -1.238193e-02 3 1  ON 26
ci_0028                -1.232778e-02 3 1  ON 27
ci_0029                -1.082724e-02 3 1  ON 28
ci_0030                -1.083819e-02 3 1  ON 29
ci_0031                 1.440995e-02 3 1  ON 30
ci_0032                 1.442618e-02 3 1  ON 31
ci_0033                 9.812385e-03 3 1  ON 32
ci_0034                 9.897717e-03 3 1  ON 33
ci_0035                 6.209772e-03 3 1  ON 34
ci_0036                 6.445693e-03 3 1  ON 35
ci_0037                -1.202602e-02 3 1  ON 36
ci_0038                -1.198182e-02 3 1  ON 37
ci_0039                -5.148499e-03 3 1  ON 38
ci_0040                -5.167150e-03 3 1  ON 39
ci_0041                 1.035335e-02 3 1  ON 40
ci_0042                 1.064685e-02 3 1  ON 41
ci_0043                -7.176116e-03 3 1  ON 42
ci_0044                -8.130300e-03 3 1  ON 43
ci_0045                 1.093082e-02 3 1  ON 44
ci_0046                 1.047083e-02 3 1  ON 45
ci_0047                -4.644088e-03 3 1  ON 46
ci_0048                -4.726125e-03 3 1  ON 47
ci_0049                -3.676409e-03 3 1  ON 48
ci_0050                -3.838539e-03 3 1  ON 49
ci_0051                -2.838640e-03 3 1  ON 50
ci_0052                -2.837977e-03 3 1  ON 51
ci_0053                -4.228891e-03 3 1  ON 52
ci_0054                -4.468135e-03 3 1  ON 53
ci_0055                 3.388811e-03 3 1  ON 54
ci_0056                 2.700281e-03 3 1  ON 55
ci_0057                 3.248651e-03 3 1  ON 56
ci_0058                 3.795603e-03 3 1  ON 57
ci_0059                -4.642572e-03 3 1  ON 58
ci_0060                -4.308252e-03 3 1  ON 59
ci_0061                -4.277155e-03 3 1  ON 60
ci_0062                -4.318035e-03 3 1  ON 61
ci_0063                -9.935788e-03 3 1  ON 62
ci_0064                -9.715081e-03 3 1  ON 63
ci_0065                -7.461216e-03 3 1  ON 64
ci_0066                -7.506187e-03 3 1  ON 65
ci_0067                -4.662308e-03 3 1  ON 66
ci_0068                -4.875834e-03 3 1  ON 67
ci_0069                 4.521159e-03 3 1  ON 68
ci_0070                 3.974827e-03 3 1  ON 69
ci_0071                 4.687891e-03 3 1  ON 70
ci_0072                 5.072852e-03 3 1  ON 71
ci_0073                 4.173397e-03 3 1  ON 72
ci_0074                 4.396704e-03 3 1  ON 73
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 4.2642e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s047 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s047 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=47  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6898e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 47
    time step          = 0.05
    reference energy   = -16.8496
    reference variance = 0.316067
====================================================
  Execution time = 1.5045e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s047
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5233e+04
  VMC Eavg = -1.6903e+01
  VMC Evar = 3.1619e-01
  Total weights = 1.951833494e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 2.6563e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.304338551706
                                         uncertainty =       0.001795263153

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.304338551706
                                         uncertainty =       0.001795263153

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000390091786
  error estimate for blocks of size 2^( 2) =       0.000404358971
  error estimate for blocks of size 2^( 3) =       0.000418727049
  error estimate for blocks of size 2^( 4) =       0.000431364526
  error estimate for blocks of size 2^( 5) =       0.000440992520
  error estimate for blocks of size 2^( 6) =       0.000447901407
  error estimate for blocks of size 2^( 7) =       0.000451479179

      target function =      -0.884513256204
              le_mean =     -16.903411208093
             les_mean =     286.041502703658
             stat err =       0.000442934408
             autocorr =       1.289274005683
   target nu stat err =       0.000442934408
   target dn stat err =       0.002621291236
      target stat err =       0.003350844896
              std dev =       0.551673093761
             le_variance =       0.304343202380


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690341120809e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 74
Check correct_vf_var_size: 225, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 6.1035e-01, overlap shift 6.1035e+00 and omega -1.7527e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.884524819230       residual = 2.97e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.884728797122       residual = 5.87e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.884771860518       residual = 1.70e-03           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.884785780533       residual = 4.15e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.884791701063       residual = 2.14e-04           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.884793618160       residual = 8.18e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.884794719067       residual = 2.84e-05           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.884794902522       residual = 2.97e-05           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.884795087235       residual = 2.47e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.884795336653       residual = 2.36e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.884795556502       residual = 1.28e-05           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.884795850526       residual = 7.90e-06           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.884795960401       residual = 3.86e-06           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.884796101987       residual = 7.66e-07           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.884796061184       residual = 1.91e-07           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.884796052650       residual = 3.44e-08           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.884796047649       residual = 1.09e-08           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.884796047100       residual = 2.80e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         17 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 6.1035e-01 is 6.336782e-04

solving harmonic davidson linear method for identity shift 2.4414e+00, overlap shift 2.4414e+01 and omega -1.7527e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.884524819230       residual = 2.97e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.884580265872       residual = 5.75e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.884591759823       residual = 1.63e-03           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.884595373680       residual = 3.93e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.884596895578       residual = 1.97e-04           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.884597357263       residual = 7.33e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.884597628648       residual = 2.55e-05           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.884597669038       residual = 2.66e-05           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.884597714290       residual = 2.22e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.884597776913       residual = 2.07e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.884597827550       residual = 1.02e-05           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.884597895426       residual = 6.00e-06           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.884597916947       residual = 2.63e-06           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.884597945505       residual = 4.91e-07           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.884597935958       residual = 1.13e-07           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.884597934144       residual = 2.09e-08           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.884597933042       residual = 6.56e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         16 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 2.4414e+00 is 1.603990e-04

solving harmonic davidson linear method for identity shift 9.7656e+00, overlap shift 9.7656e+01 and omega -1.7527e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.884524819230       residual = 2.97e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.884538990117       residual = 5.72e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.884541912779       residual = 1.61e-03           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.884542824640       residual = 3.88e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.884543207602       residual = 1.93e-04           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.884543321673       residual = 7.11e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.884543389202       residual = 2.47e-05           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.884543398910       residual = 2.59e-05           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.884543410169       residual = 2.15e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.884543425834       residual = 1.99e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.884543438188       residual = 9.64e-06           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.884543454770       residual = 5.55e-06           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.884543459783       residual = 2.37e-06           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.884543466508       residual = 4.35e-07           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.884543464175       residual = 9.84e-08           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.884543463742       residual = 1.83e-08           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.884543463477       residual = 5.72e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         16 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 9.7656e+00 is 4.023575e-05

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.708215 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 75 and numParams is: 74

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.7717e+01
  </log>
  <optVariables href="H2O.s047.opt.xml">
ci_0001                 7.000105e-01 3 1  ON 0
ci_0002                 6.995274e-01 3 1  ON 1
ci_0003                -3.358232e-02 3 1  ON 2
ci_0004                -3.382987e-02 3 1  ON 3
ci_0005                -3.104641e-02 3 1  ON 4
ci_0006                -3.206386e-02 3 1  ON 5
ci_0007                -1.991771e-02 3 1  ON 6
ci_0008                -2.034432e-02 3 1  ON 7
ci_0009                -2.069438e-02 3 1  ON 8
ci_0010                -2.097558e-02 3 1  ON 9
ci_0011                -1.716481e-02 3 1  ON 10
ci_0012                -1.709648e-02 3 1  ON 11
ci_0013                 1.720133e-02 3 1  ON 12
ci_0014                 1.717534e-02 3 1  ON 13
ci_0015                 1.748045e-02 3 1  ON 14
ci_0016                 1.747240e-02 3 1  ON 15
ci_0017                 1.516179e-02 3 1  ON 16
ci_0018                 1.551060e-02 3 1  ON 17
ci_0019                 1.351047e-02 3 1  ON 18
ci_0020                 1.315730e-02 3 1  ON 19
ci_0021                 1.667397e-02 3 1  ON 20
ci_0022                 1.732458e-02 3 1  ON 21
ci_0023                -1.243595e-02 3 1  ON 22
ci_0024                -1.210050e-02 3 1  ON 23
ci_0025                -4.456262e-03 3 1  ON 24
ci_0026                -4.145721e-03 3 1  ON 25
ci_0027                -1.233726e-02 3 1  ON 26
ci_0028                -1.229759e-02 3 1  ON 27
ci_0029                -1.078383e-02 3 1  ON 28
ci_0030                -1.082765e-02 3 1  ON 29
ci_0031                 1.439270e-02 3 1  ON 30
ci_0032                 1.439071e-02 3 1  ON 31
ci_0033                 9.763517e-03 3 1  ON 32
ci_0034                 9.843290e-03 3 1  ON 33
ci_0035                 6.135099e-03 3 1  ON 34
ci_0036                 6.375224e-03 3 1  ON 35
ci_0037                -1.199322e-02 3 1  ON 36
ci_0038                -1.194982e-02 3 1  ON 37
ci_0039                -5.094349e-03 3 1  ON 38
ci_0040                -5.121782e-03 3 1  ON 39
ci_0041                 1.033935e-02 3 1  ON 40
ci_0042                 1.062767e-02 3 1  ON 41
ci_0043                -7.121693e-03 3 1  ON 42
ci_0044                -8.097110e-03 3 1  ON 43
ci_0045                 1.088957e-02 3 1  ON 44
ci_0046                 1.044745e-02 3 1  ON 45
ci_0047                -4.598214e-03 3 1  ON 46
ci_0048                -4.693889e-03 3 1  ON 47
ci_0049                -3.641372e-03 3 1  ON 48
ci_0050                -3.821651e-03 3 1  ON 49
ci_0051                -2.785280e-03 3 1  ON 50
ci_0052                -2.833002e-03 3 1  ON 51
ci_0053                -4.155985e-03 3 1  ON 52
ci_0054                -4.440271e-03 3 1  ON 53
ci_0055                 3.339550e-03 3 1  ON 54
ci_0056                 2.684072e-03 3 1  ON 55
ci_0057                 3.238011e-03 3 1  ON 56
ci_0058                 3.766952e-03 3 1  ON 57
ci_0059                -4.620025e-03 3 1  ON 58
ci_0060                -4.275276e-03 3 1  ON 59
ci_0061                -4.223964e-03 3 1  ON 60
ci_0062                -4.267908e-03 3 1  ON 61
ci_0063                -9.913257e-03 3 1  ON 62
ci_0064                -9.720314e-03 3 1  ON 63
ci_0065                -7.427233e-03 3 1  ON 64
ci_0066                -7.467848e-03 3 1  ON 65
ci_0067                -4.637722e-03 3 1  ON 66
ci_0068                -4.854436e-03 3 1  ON 67
ci_0069                 4.477866e-03 3 1  ON 68
ci_0070                 3.953182e-03 3 1  ON 69
ci_0071                 4.700788e-03 3 1  ON 70
ci_0072                 5.051473e-03 3 1  ON 71
ci_0073                 4.159228e-03 3 1  ON 72
ci_0074                 4.348645e-03 3 1  ON 73
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 47
    time step          = 0.05
    reference energy   = -16.9605
    reference variance = 0.380557
====================================================
  Execution time = 1.4793e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s047
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6903e+01
  VMC Evar = 3.2113e-01
  Total weights = 1.9519e+06
  Execution time = 1.9494e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.307916644708
                                         uncertainty =       0.002523381603

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.307916644708
                                         uncertainty =       0.002523381603

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000392323946
  error estimate for blocks of size 2^( 2) =       0.000405909959
  error estimate for blocks of size 2^( 3) =       0.000419447955
  error estimate for blocks of size 2^( 4) =       0.000432416360
  error estimate for blocks of size 2^( 5) =       0.000444484238
  error estimate for blocks of size 2^( 6) =       0.000450691307
  error estimate for blocks of size 2^( 7) =       0.000456073449

      target function =      -0.877882522261
              le_mean =     -16.903281134814
             les_mean =     286.042405506675
             stat err =       0.000445916339
             autocorr =       1.291865013179
   target nu stat err =       0.000445916339
   target dn stat err =       0.003407046632
      target stat err =       0.004259754609
              std dev =       0.554829845769
             le_variance =       0.307836157756

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.307482208939
                                         uncertainty =       0.002503057913

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.307482208939
                                         uncertainty =       0.002503057913

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000392047234
  error estimate for blocks of size 2^( 2) =       0.000405678907
  error estimate for blocks of size 2^( 3) =       0.000419265583
  error estimate for blocks of size 2^( 4) =       0.000432263154
  error estimate for blocks of size 2^( 5) =       0.000444354286
  error estimate for blocks of size 2^( 6) =       0.000450567052
  error estimate for blocks of size 2^( 7) =       0.000455952408

      target function =      -0.877505606106
              le_mean =     -16.903283208490
             les_mean =     286.042780417925
             stat err =       0.000445784225
             autocorr =       1.292922830175
   target nu stat err =       0.000445784225
   target dn stat err =       0.003445480213
      target stat err =       0.004303099308
              std dev =       0.554438515351
             le_variance =       0.307402067304

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.307671938391
                                         uncertainty =       0.002511713935

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.307671938391
                                         uncertainty =       0.002511713935

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000392168107
  error estimate for blocks of size 2^( 2) =       0.000405778361
  error estimate for blocks of size 2^( 3) =       0.000419342618
  error estimate for blocks of size 2^( 4) =       0.000432326658
  error estimate for blocks of size 2^( 5) =       0.000444405938
  error estimate for blocks of size 2^( 6) =       0.000450616238
  error estimate for blocks of size 2^( 7) =       0.000456000365

      target function =      -0.877390080481
              le_mean =     -16.903281234075
             les_mean =     286.042806287251
             stat err =       0.000445837300
             autocorr =       1.292433647929
   target nu stat err =       0.000445837300
   target dn stat err =       0.003514264690
      target stat err =       0.004386052474
              std dev =       0.554609455545
             le_variance =       0.307591648180

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.307884174431
                                         uncertainty =       0.002521806754

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.307884174431
                                         uncertainty =       0.002521806754

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000392303271
  error estimate for blocks of size 2^( 2) =       0.000405892345
  error estimate for blocks of size 2^( 3) =       0.000419433663
  error estimate for blocks of size 2^( 4) =       0.000432404045
  error estimate for blocks of size 2^( 5) =       0.000444473346
  error estimate for blocks of size 2^( 6) =       0.000450680790
  error estimate for blocks of size 2^( 7) =       0.000456063175

      target function =      -0.878049243295
              le_mean =     -16.903280974914
             les_mean =     286.042265370389
             stat err =       0.000445905339
             autocorr =       1.291937442141
   target nu stat err =       0.000445905339
   target dn stat err =       0.003397930311
      target stat err =       0.004250197205
              std dev =       0.554800606925
             le_variance =       0.307803713444


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.877882522261        initial
     6.1035e-01     6.1035e+00             6.3368e-04        -0.877505606106
     2.4414e+00     2.4414e+01             1.6040e-04        -0.877390080481
     9.7656e+00     9.7656e+01             4.0236e-05        -0.878049243295  <--

*****************************************************************************
Applying the update for shift_i =   9.7656e+00     and shift_s =   9.7656e+01
*****************************************************************************

  Execution time = 2.4627e+01
  </log>
  <optVariables href="H2O.s047.opt.xml">
ci_0001                 7.000877e-01 3 1  ON 0
ci_0002                 6.994073e-01 3 1  ON 1
ci_0003                -3.364801e-02 3 1  ON 2
ci_0004                -3.387498e-02 3 1  ON 3
ci_0005                -3.111755e-02 3 1  ON 4
ci_0006                -3.214823e-02 3 1  ON 5
ci_0007                -1.997830e-02 3 1  ON 6
ci_0008                -2.043852e-02 3 1  ON 7
ci_0009                -2.074538e-02 3 1  ON 8
ci_0010                -2.104161e-02 3 1  ON 9
ci_0011                -1.723005e-02 3 1  ON 10
ci_0012                -1.712783e-02 3 1  ON 11
ci_0013                 1.723934e-02 3 1  ON 12
ci_0014                 1.722038e-02 3 1  ON 13
ci_0015                 1.751245e-02 3 1  ON 14
ci_0016                 1.752975e-02 3 1  ON 15
ci_0017                 1.520262e-02 3 1  ON 16
ci_0018                 1.555910e-02 3 1  ON 17
ci_0019                 1.354435e-02 3 1  ON 18
ci_0020                 1.317636e-02 3 1  ON 19
ci_0021                 1.669141e-02 3 1  ON 20
ci_0022                 1.732823e-02 3 1  ON 21
ci_0023                -1.244180e-02 3 1  ON 22
ci_0024                -1.210696e-02 3 1  ON 23
ci_0025                -4.490636e-03 3 1  ON 24
ci_0026                -4.177393e-03 3 1  ON 25
ci_0027                -1.237055e-02 3 1  ON 26
ci_0028                -1.232006e-02 3 1  ON 27
ci_0029                -1.081617e-02 3 1  ON 28
ci_0030                -1.083547e-02 3 1  ON 29
ci_0031                 1.440557e-02 3 1  ON 30
ci_0032                 1.441720e-02 3 1  ON 31
ci_0033                 9.799992e-03 3 1  ON 32
ci_0034                 9.883905e-03 3 1  ON 33
ci_0035                 6.190682e-03 3 1  ON 34
ci_0036                 6.427673e-03 3 1  ON 35
ci_0037                -1.201768e-02 3 1  ON 36
ci_0038                -1.197368e-02 3 1  ON 37
ci_0039                -5.134672e-03 3 1  ON 38
ci_0040                -5.155559e-03 3 1  ON 39
ci_0041                 1.034980e-02 3 1  ON 40
ci_0042                 1.064196e-02 3 1  ON 41
ci_0043                -7.162327e-03 3 1  ON 42
ci_0044                -8.121875e-03 3 1  ON 43
ci_0045                 1.092036e-02 3 1  ON 44
ci_0046                 1.046488e-02 3 1  ON 45
ci_0047                -4.632376e-03 3 1  ON 46
ci_0048                -4.717889e-03 3 1  ON 47
ci_0049                -3.667446e-03 3 1  ON 48
ci_0050                -3.834213e-03 3 1  ON 49
ci_0051                -2.824983e-03 3 1  ON 50
ci_0052                -2.836701e-03 3 1  ON 51
ci_0053                -4.210252e-03 3 1  ON 52
ci_0054                -4.461009e-03 3 1  ON 53
ci_0055                 3.376216e-03 3 1  ON 54
ci_0056                 2.696134e-03 3 1  ON 55
ci_0057                 3.245944e-03 3 1  ON 56
ci_0058                 3.788282e-03 3 1  ON 57
ci_0059                -4.636811e-03 3 1  ON 58
ci_0060                -4.299816e-03 3 1  ON 59
ci_0061                -4.263607e-03 3 1  ON 60
ci_0062                -4.305261e-03 3 1  ON 61
ci_0063                -9.930049e-03 3 1  ON 62
ci_0064                -9.716400e-03 3 1  ON 63
ci_0065                -7.452568e-03 3 1  ON 64
ci_0066                -7.496417e-03 3 1  ON 65
ci_0067                -4.656026e-03 3 1  ON 66
ci_0068                -4.870360e-03 3 1  ON 67
ci_0069                 4.510091e-03 3 1  ON 68
ci_0070                 3.969289e-03 3 1  ON 69
ci_0071                 4.691202e-03 3 1  ON 70
ci_0072                 5.067390e-03 3 1  ON 71
ci_0073                 4.169778e-03 3 1  ON 72
ci_0074                 4.384415e-03 3 1  ON 73
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 4.2349e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s048 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s048 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=48  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6898e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 48
    time step          = 0.05
    reference energy   = -16.9383
    reference variance = 0.291881
====================================================
  Execution time = 1.4840e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s048
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5257e+04
  VMC Eavg = -1.6904e+01
  VMC Evar = 3.2433e-01
  Total weights = 1.951517007e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 2.6756e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.308229534679
                                         uncertainty =       0.002732925098

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.308229534679
                                         uncertainty =       0.002732925098

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000392574378
  error estimate for blocks of size 2^( 2) =       0.000406954977
  error estimate for blocks of size 2^( 3) =       0.000421521492
  error estimate for blocks of size 2^( 4) =       0.000435452598
  error estimate for blocks of size 2^( 5) =       0.000445904624
  error estimate for blocks of size 2^( 6) =       0.000453835485
  error estimate for blocks of size 2^( 7) =       0.000458238142

      target function =      -0.874485649742
              le_mean =     -16.904129980506
             les_mean =     286.073942998687
             stat err =       0.000448357712
             autocorr =       1.304383768362
   target nu stat err =       0.000448357712
   target dn stat err =       0.003849873413
      target stat err =       0.004772256690
              std dev =       0.555184010088
             le_variance =       0.308229285058


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690412998051e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 74
Check correct_vf_var_size: 225, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.4414e+00, overlap shift 2.4414e+01 and omega -1.7527e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.874510265938       residual = 4.02e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.874571846566       residual = 8.16e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.874584814931       residual = 1.85e-03           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.874589873973       residual = 5.33e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.874591832892       residual = 1.89e-04           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.874592727512       residual = 7.83e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.874592960555       residual = 2.53e-05           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.874593016133       residual = 1.58e-05           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.874593084223       residual = 9.79e-06           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.874593123256       residual = 5.91e-06           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.874593191433       residual = 5.12e-06           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.874593225342       residual = 3.46e-06           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.874593231105       residual = 3.32e-06           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.874593257107       residual = 8.09e-07           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.874593263372       residual = 2.13e-07           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.874593268606       residual = 2.45e-08           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.874593267805       residual = 8.59e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         16 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 2.4414e+00 is 1.312466e-04

solving harmonic davidson linear method for identity shift 9.7656e+00, overlap shift 9.7656e+01 and omega -1.7527e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.874510265938       residual = 4.02e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.874526009883       residual = 8.13e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.874529309804       residual = 1.83e-03           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.874530588066       residual = 5.25e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.874531080516       residual = 1.85e-04           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.874531303186       residual = 7.59e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.874531360966       residual = 2.45e-05           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.874531374418       residual = 1.54e-05           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.874531391456       residual = 9.41e-06           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.874531401250       residual = 5.75e-06           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.874531418250       residual = 4.91e-06           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.874531426518       residual = 3.30e-06           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.874531427825       residual = 3.08e-06           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.874531434017       residual = 7.21e-07           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.874531435465       residual = 1.85e-07           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.874531436684       residual = 2.12e-08           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.874531436489       residual = 7.62e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         16 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 9.7656e+00 is 3.315958e-05

solving harmonic davidson linear method for identity shift 3.9062e+01, overlap shift 3.9062e+02 and omega -1.7527e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.874510265938       residual = 4.02e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.874514224343       residual = 8.12e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.874515053014       residual = 1.83e-03           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.874515373427       residual = 5.22e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.874515496706       residual = 1.84e-04           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.874515552306       residual = 7.53e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.874515566720       residual = 2.43e-05           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.874515570055       residual = 1.52e-05           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.874515574315       residual = 9.32e-06           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.874515576766       residual = 5.71e-06           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.874515581013       residual = 4.86e-06           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.874515583066       residual = 3.25e-06           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.874515583384       residual = 3.02e-06           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.874515584913       residual = 7.00e-07           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.874515585268       residual = 1.79e-07           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.874515585567       residual = 2.05e-08           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.874515585519       residual = 7.39e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         16 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 3.9062e+01 is 8.311927e-06

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.717274 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 75 and numParams is: 74

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.7530e+01
  </log>
  <optVariables href="H2O.s048.opt.xml">
ci_0001                 7.001147e-01 3 1  ON 0
ci_0002                 6.993938e-01 3 1  ON 1
ci_0003                -3.361807e-02 3 1  ON 2
ci_0004                -3.385192e-02 3 1  ON 3
ci_0005                -3.109098e-02 3 1  ON 4
ci_0006                -3.211710e-02 3 1  ON 5
ci_0007                -1.996118e-02 3 1  ON 6
ci_0008                -2.040536e-02 3 1  ON 7
ci_0009                -2.073005e-02 3 1  ON 8
ci_0010                -2.103025e-02 3 1  ON 9
ci_0011                -1.722041e-02 3 1  ON 10
ci_0012                -1.712208e-02 3 1  ON 11
ci_0013                 1.722934e-02 3 1  ON 12
ci_0014                 1.721081e-02 3 1  ON 13
ci_0015                 1.750672e-02 3 1  ON 14
ci_0016                 1.751653e-02 3 1  ON 15
ci_0017                 1.519331e-02 3 1  ON 16
ci_0018                 1.554994e-02 3 1  ON 17
ci_0019                 1.353389e-02 3 1  ON 18
ci_0020                 1.316993e-02 3 1  ON 19
ci_0021                 1.666824e-02 3 1  ON 20
ci_0022                 1.733759e-02 3 1  ON 21
ci_0023                -1.243605e-02 3 1  ON 22
ci_0024                -1.210456e-02 3 1  ON 23
ci_0025                -4.468371e-03 3 1  ON 24
ci_0026                -4.160719e-03 3 1  ON 25
ci_0027                -1.236052e-02 3 1  ON 26
ci_0028                -1.231067e-02 3 1  ON 27
ci_0029                -1.081517e-02 3 1  ON 28
ci_0030                -1.082618e-02 3 1  ON 29
ci_0031                 1.440779e-02 3 1  ON 30
ci_0032                 1.441439e-02 3 1  ON 31
ci_0033                 9.789258e-03 3 1  ON 32
ci_0034                 9.883166e-03 3 1  ON 33
ci_0035                 6.183836e-03 3 1  ON 34
ci_0036                 6.402080e-03 3 1  ON 35
ci_0037                -1.201727e-02 3 1  ON 36
ci_0038                -1.196984e-02 3 1  ON 37
ci_0039                -5.126893e-03 3 1  ON 38
ci_0040                -5.141245e-03 3 1  ON 39
ci_0041                 1.034033e-02 3 1  ON 40
ci_0042                 1.063388e-02 3 1  ON 41
ci_0043                -7.145404e-03 3 1  ON 42
ci_0044                -8.110509e-03 3 1  ON 43
ci_0045                 1.091091e-02 3 1  ON 44
ci_0046                 1.046555e-02 3 1  ON 45
ci_0047                -4.619312e-03 3 1  ON 46
ci_0048                -4.704583e-03 3 1  ON 47
ci_0049                -3.668478e-03 3 1  ON 48
ci_0050                -3.822714e-03 3 1  ON 49
ci_0051                -2.807502e-03 3 1  ON 50
ci_0052                -2.827740e-03 3 1  ON 51
ci_0053                -4.209355e-03 3 1  ON 52
ci_0054                -4.449417e-03 3 1  ON 53
ci_0055                 3.356618e-03 3 1  ON 54
ci_0056                 2.688119e-03 3 1  ON 55
ci_0057                 3.239156e-03 3 1  ON 56
ci_0058                 3.789763e-03 3 1  ON 57
ci_0059                -4.624960e-03 3 1  ON 58
ci_0060                -4.293696e-03 3 1  ON 59
ci_0061                -4.260794e-03 3 1  ON 60
ci_0062                -4.285750e-03 3 1  ON 61
ci_0063                -9.925408e-03 3 1  ON 62
ci_0064                -9.715821e-03 3 1  ON 63
ci_0065                -7.442996e-03 3 1  ON 64
ci_0066                -7.492585e-03 3 1  ON 65
ci_0067                -4.652267e-03 3 1  ON 66
ci_0068                -4.856142e-03 3 1  ON 67
ci_0069                 4.496623e-03 3 1  ON 68
ci_0070                 3.959200e-03 3 1  ON 69
ci_0071                 4.685757e-03 3 1  ON 70
ci_0072                 5.074036e-03 3 1  ON 71
ci_0073                 4.159805e-03 3 1  ON 72
ci_0074                 4.377009e-03 3 1  ON 73
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 48
    time step          = 0.05
    reference energy   = -16.9031
    reference variance = 0.156103
====================================================
  Execution time = 1.4435e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s048
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6904e+01
  VMC Evar = 3.1483e-01
  Total weights = 1.9515e+06
  Execution time = 1.9612e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.304375243080
                                         uncertainty =       0.001872096711

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.304375243080
                                         uncertainty =       0.001872096711

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000390133536
  error estimate for blocks of size 2^( 2) =       0.000404284388
  error estimate for blocks of size 2^( 3) =       0.000418676724
  error estimate for blocks of size 2^( 4) =       0.000431842398
  error estimate for blocks of size 2^( 5) =       0.000443108170
  error estimate for blocks of size 2^( 6) =       0.000452348958
  error estimate for blocks of size 2^( 7) =       0.000459539369

      target function =      -0.886274259397
              le_mean =     -16.903920915182
             les_mean =     286.057396832215
             stat err =       0.000446709724
             autocorr =       1.311065063108
   target nu stat err =       0.000446709724
   target dn stat err =       0.002306619229
      target stat err =       0.002978800905
              std dev =       0.551732137381
             le_variance =       0.304408351419

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.304275907443
                                         uncertainty =       0.001867788778

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.304275907443
                                         uncertainty =       0.001867788778

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000390069861
  error estimate for blocks of size 2^( 2) =       0.000404230274
  error estimate for blocks of size 2^( 3) =       0.000418635181
  error estimate for blocks of size 2^( 4) =       0.000431809549
  error estimate for blocks of size 2^( 5) =       0.000443083934
  error estimate for blocks of size 2^( 6) =       0.000452327652
  error estimate for blocks of size 2^( 7) =       0.000459516019

      target function =      -0.886058752596
              le_mean =     -16.903920781305
             les_mean =     286.057563115470
             stat err =       0.000446684289
             autocorr =       1.311343785791
   target nu stat err =       0.000446684289
   target dn stat err =       0.002311407111
      target stat err =       0.002983275907
              std dev =       0.551642088034
             le_variance =       0.304308993291

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.304323867082
                                         uncertainty =       0.001869880737

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.304323867082
                                         uncertainty =       0.001869880737

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000390100605
  error estimate for blocks of size 2^( 2) =       0.000404256309
  error estimate for blocks of size 2^( 3) =       0.000418655192
  error estimate for blocks of size 2^( 4) =       0.000431825213
  error estimate for blocks of size 2^( 5) =       0.000443095480
  error estimate for blocks of size 2^( 6) =       0.000452337546
  error estimate for blocks of size 2^( 7) =       0.000459526472

      target function =      -0.885973101207
              le_mean =     -16.903920828972
             les_mean =     286.057632549510
             stat err =       0.000446696178
             autocorr =       1.311206897063
   target nu stat err =       0.000446696178
   target dn stat err =       0.002328723567
      target stat err =       0.003004050974
              std dev =       0.551685566419
             le_variance =       0.304356964195

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.304368710169
                                         uncertainty =       0.001871816684

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.304368710169
                                         uncertainty =       0.001871816684

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000390129349
  error estimate for blocks of size 2^( 2) =       0.000404280810
  error estimate for blocks of size 2^( 3) =       0.000418673960
  error estimate for blocks of size 2^( 4) =       0.000431840184
  error estimate for blocks of size 2^( 5) =       0.000443106517
  error estimate for blocks of size 2^( 6) =       0.000452347475
  error estimate for blocks of size 2^( 7) =       0.000459537725

      target function =      -0.886288838485
              le_mean =     -16.903920889215
             les_mean =     286.057384401226
             stat err =       0.000446707975
             autocorr =       1.311082942837
   target nu stat err =       0.000446707975
   target dn stat err =       0.002305758430
      target stat err =       0.002977834982
              std dev =       0.551726215740
             le_variance =       0.304401817135


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.886274259397        initial
     2.4414e+00     2.4414e+01             1.3125e-04        -0.886058752596
     9.7656e+00     9.7656e+01             3.3160e-05        -0.885973101207
     3.9062e+01     3.9062e+02             8.3119e-06        -0.886288838485  <--

*****************************************************************************
Applying the update for shift_i =   3.9062e+01     and shift_s =   3.9062e+02
*****************************************************************************

  Execution time = 2.4351e+01
  </log>
  <optVariables href="H2O.s048.opt.xml">
ci_0001                 7.000945e-01 3 1  ON 0
ci_0002                 6.994039e-01 3 1  ON 1
ci_0003                -3.364049e-02 3 1  ON 2
ci_0004                -3.386919e-02 3 1  ON 3
ci_0005                -3.111088e-02 3 1  ON 4
ci_0006                -3.214042e-02 3 1  ON 5
ci_0007                -1.997401e-02 3 1  ON 6
ci_0008                -2.043021e-02 3 1  ON 7
ci_0009                -2.074153e-02 3 1  ON 8
ci_0010                -2.103876e-02 3 1  ON 9
ci_0011                -1.722763e-02 3 1  ON 10
ci_0012                -1.712638e-02 3 1  ON 11
ci_0013                 1.723683e-02 3 1  ON 12
ci_0014                 1.721797e-02 3 1  ON 13
ci_0015                 1.751101e-02 3 1  ON 14
ci_0016                 1.752643e-02 3 1  ON 15
ci_0017                 1.520028e-02 3 1  ON 16
ci_0018                 1.555680e-02 3 1  ON 17
ci_0019                 1.354172e-02 3 1  ON 18
ci_0020                 1.317474e-02 3 1  ON 19
ci_0021                 1.668561e-02 3 1  ON 20
ci_0022                 1.733058e-02 3 1  ON 21
ci_0023                -1.244035e-02 3 1  ON 22
ci_0024                -1.210636e-02 3 1  ON 23
ci_0025                -4.485038e-03 3 1  ON 24
ci_0026                -4.173202e-03 3 1  ON 25
ci_0027                -1.236803e-02 3 1  ON 26
ci_0028                -1.231771e-02 3 1  ON 27
ci_0029                -1.081592e-02 3 1  ON 28
ci_0030                -1.083313e-02 3 1  ON 29
ci_0031                 1.440613e-02 3 1  ON 30
ci_0032                 1.441649e-02 3 1  ON 31
ci_0033                 9.797298e-03 3 1  ON 32
ci_0034                 9.883720e-03 3 1  ON 33
ci_0035                 6.188961e-03 3 1  ON 34
ci_0036                 6.421239e-03 3 1  ON 35
ci_0037                -1.201758e-02 3 1  ON 36
ci_0038                -1.197272e-02 3 1  ON 37
ci_0039                -5.132717e-03 3 1  ON 38
ci_0040                -5.151962e-03 3 1  ON 39
ci_0041                 1.034742e-02 3 1  ON 40
ci_0042                 1.063993e-02 3 1  ON 41
ci_0043                -7.158083e-03 3 1  ON 42
ci_0044                -8.119023e-03 3 1  ON 43
ci_0045                 1.091799e-02 3 1  ON 44
ci_0046                 1.046505e-02 3 1  ON 45
ci_0047                -4.629093e-03 3 1  ON 46
ci_0048                -4.714545e-03 3 1  ON 47
ci_0049                -3.667705e-03 3 1  ON 48
ci_0050                -3.831322e-03 3 1  ON 49
ci_0051                -2.820587e-03 3 1  ON 50
ci_0052                -2.834448e-03 3 1  ON 51
ci_0053                -4.210027e-03 3 1  ON 52
ci_0054                -4.458095e-03 3 1  ON 53
ci_0055                 3.371289e-03 3 1  ON 54
ci_0056                 2.694119e-03 3 1  ON 55
ci_0057                 3.244238e-03 3 1  ON 56
ci_0058                 3.788655e-03 3 1  ON 57
ci_0059                -4.633831e-03 3 1  ON 58
ci_0060                -4.298278e-03 3 1  ON 59
ci_0061                -4.262900e-03 3 1  ON 60
ci_0062                -4.300360e-03 3 1  ON 61
ci_0063                -9.928882e-03 3 1  ON 62
ci_0064                -9.716254e-03 3 1  ON 63
ci_0065                -7.450164e-03 3 1  ON 64
ci_0066                -7.495455e-03 3 1  ON 65
ci_0067                -4.655080e-03 3 1  ON 66
ci_0068                -4.866785e-03 3 1  ON 67
ci_0069                 4.506705e-03 3 1  ON 68
ci_0070                 3.966753e-03 3 1  ON 69
ci_0071                 4.689833e-03 3 1  ON 70
ci_0072                 5.069062e-03 3 1  ON 71
ci_0073                 4.167270e-03 3 1  ON 72
ci_0074                 4.382553e-03 3 1  ON 73
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 4.1886e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s049 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s049 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=49  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6898e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 49
    time step          = 0.05
    reference energy   = -16.9097
    reference variance = 0.156204
====================================================
  Execution time = 1.4887e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s049
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5270e+04
  VMC Eavg = -1.6904e+01
  VMC Evar = 3.1922e-01
  Total weights = 1.951787353e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 2.6838e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.306695531941
                                         uncertainty =       0.002312171193

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.306695531941
                                         uncertainty =       0.002312171193

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000391613894
  error estimate for blocks of size 2^( 2) =       0.000405708798
  error estimate for blocks of size 2^( 3) =       0.000419774530
  error estimate for blocks of size 2^( 4) =       0.000433520813
  error estimate for blocks of size 2^( 5) =       0.000444485127
  error estimate for blocks of size 2^( 6) =       0.000452004209
  error estimate for blocks of size 2^( 7) =       0.000457045424

      target function =      -0.880818304114
              le_mean =     -16.904111172214
             les_mean =     286.068194577057
             stat err =       0.000446763893
             autocorr =       1.301487347788
   target nu stat err =       0.000446763893
   target dn stat err =       0.003171639541
      target stat err =       0.004003848994
              std dev =       0.553825680039
             le_variance =       0.306722883871


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690411117221e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 74
Check correct_vf_var_size: 225, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 9.7656e+00, overlap shift 9.7656e+01 and omega -1.7527e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.880835323717       residual = 3.58e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.880848915664       residual = 6.21e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.880851827985       residual = 1.49e-03           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.880852908647       residual = 3.83e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.880853207130       residual = 2.28e-04           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.880853388824       residual = 1.04e-04           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.880853445637       residual = 2.22e-05           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.880853469817       residual = 6.58e-06           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.880853490006       residual = 1.95e-06           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.880853490831       residual = 6.98e-07           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.880853490419       residual = 2.41e-07           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.880853490272       residual = 6.92e-08           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.880853490962       residual = 7.21e-08           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.880853490486       residual = 6.75e-08           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.880853492015       residual = 5.37e-08           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.880853492512       residual = 1.20e-08           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.880853492295       residual = 6.22e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         16 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 9.7656e+00 is 3.204251e-05

solving harmonic davidson linear method for identity shift 3.9062e+01, overlap shift 3.9062e+02 and omega -1.7527e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.880835323717       residual = 3.58e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.880838741114       residual = 6.20e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.880839472443       residual = 1.48e-03           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.880839743300       residual = 3.81e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.880839818056       residual = 2.26e-04           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.880839863487       residual = 1.03e-04           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.880839877615       residual = 2.20e-05           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.880839883639       residual = 6.50e-06           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.880839888671       residual = 1.92e-06           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.880839888871       residual = 6.88e-07           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.880839888766       residual = 2.37e-07           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.880839888729       residual = 6.82e-08           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.880839888902       residual = 7.15e-08           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.880839888783       residual = 6.67e-08           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.880839889165       residual = 5.23e-08           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.880839889286       residual = 1.16e-08           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.880839889231       residual = 6.02e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         16 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 3.9062e+01 is 8.033162e-06

solving harmonic davidson linear method for identity shift 1.5625e+02, overlap shift 1.5625e+03 and omega -1.7527e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.880835323717       residual = 3.58e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.880836179288       residual = 6.20e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.880836362324       residual = 1.48e-03           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.880836430082       residual = 3.81e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.880836448779       residual = 2.26e-04           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.880836460137       residual = 1.03e-04           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.880836463665       residual = 2.20e-05           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.880836465169       residual = 6.48e-06           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.880836466426       residual = 1.91e-06           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.880836466476       residual = 6.85e-07           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.880836466450       residual = 2.36e-07           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.880836466440       residual = 6.80e-08           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.880836466484       residual = 7.13e-08           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.880836466454       residual = 6.65e-08           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.880836466549       residual = 5.20e-08           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.880836466579       residual = 1.15e-08           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.880836466566       residual = 5.97e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         16 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 1.5625e+02 is 2.009704e-06

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.726388 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 75 and numParams is: 74

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.7586e+01
  </log>
  <optVariables href="H2O.s049.opt.xml">
ci_0001                 7.000952e-01 3 1  ON 0
ci_0002                 6.994065e-01 3 1  ON 1
ci_0003                -3.363537e-02 3 1  ON 2
ci_0004                -3.386259e-02 3 1  ON 3
ci_0005                -3.110646e-02 3 1  ON 4
ci_0006                -3.213315e-02 3 1  ON 5
ci_0007                -1.996598e-02 3 1  ON 6
ci_0008                -2.042409e-02 3 1  ON 7
ci_0009                -2.073734e-02 3 1  ON 8
ci_0010                -2.103550e-02 3 1  ON 9
ci_0011                -1.722481e-02 3 1  ON 10
ci_0012                -1.712412e-02 3 1  ON 11
ci_0013                 1.723177e-02 3 1  ON 12
ci_0014                 1.721462e-02 3 1  ON 13
ci_0015                 1.751032e-02 3 1  ON 14
ci_0016                 1.752192e-02 3 1  ON 15
ci_0017                 1.519703e-02 3 1  ON 16
ci_0018                 1.555450e-02 3 1  ON 17
ci_0019                 1.353869e-02 3 1  ON 18
ci_0020                 1.317226e-02 3 1  ON 19
ci_0021                 1.668857e-02 3 1  ON 20
ci_0022                 1.732918e-02 3 1  ON 21
ci_0023                -1.243979e-02 3 1  ON 22
ci_0024                -1.210370e-02 3 1  ON 23
ci_0025                -4.480020e-03 3 1  ON 24
ci_0026                -4.169397e-03 3 1  ON 25
ci_0027                -1.236721e-02 3 1  ON 26
ci_0028                -1.231697e-02 3 1  ON 27
ci_0029                -1.081510e-02 3 1  ON 28
ci_0030                -1.083280e-02 3 1  ON 29
ci_0031                 1.440510e-02 3 1  ON 30
ci_0032                 1.441349e-02 3 1  ON 31
ci_0033                 9.795039e-03 3 1  ON 32
ci_0034                 9.881351e-03 3 1  ON 33
ci_0035                 6.186421e-03 3 1  ON 34
ci_0036                 6.416156e-03 3 1  ON 35
ci_0037                -1.201710e-02 3 1  ON 36
ci_0038                -1.197116e-02 3 1  ON 37
ci_0039                -5.130146e-03 3 1  ON 38
ci_0040                -5.148726e-03 3 1  ON 39
ci_0041                 1.034763e-02 3 1  ON 40
ci_0042                 1.063804e-02 3 1  ON 41
ci_0043                -7.158136e-03 3 1  ON 42
ci_0044                -8.117708e-03 3 1  ON 43
ci_0045                 1.091605e-02 3 1  ON 44
ci_0046                 1.046363e-02 3 1  ON 45
ci_0047                -4.625951e-03 3 1  ON 46
ci_0048                -4.711478e-03 3 1  ON 47
ci_0049                -3.665438e-03 3 1  ON 48
ci_0050                -3.831489e-03 3 1  ON 49
ci_0051                -2.817252e-03 3 1  ON 50
ci_0052                -2.831178e-03 3 1  ON 51
ci_0053                -4.209131e-03 3 1  ON 52
ci_0054                -4.455123e-03 3 1  ON 53
ci_0055                 3.367832e-03 3 1  ON 54
ci_0056                 2.694298e-03 3 1  ON 55
ci_0057                 3.242069e-03 3 1  ON 56
ci_0058                 3.786689e-03 3 1  ON 57
ci_0059                -4.629329e-03 3 1  ON 58
ci_0060                -4.296144e-03 3 1  ON 59
ci_0061                -4.261637e-03 3 1  ON 60
ci_0062                -4.298699e-03 3 1  ON 61
ci_0063                -9.928545e-03 3 1  ON 62
ci_0064                -9.714808e-03 3 1  ON 63
ci_0065                -7.450434e-03 3 1  ON 64
ci_0066                -7.494963e-03 3 1  ON 65
ci_0067                -4.653389e-03 3 1  ON 66
ci_0068                -4.862504e-03 3 1  ON 67
ci_0069                 4.504804e-03 3 1  ON 68
ci_0070                 3.965223e-03 3 1  ON 69
ci_0071                 4.689479e-03 3 1  ON 70
ci_0072                 5.068254e-03 3 1  ON 71
ci_0073                 4.166331e-03 3 1  ON 72
ci_0074                 4.380961e-03 3 1  ON 73
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 49
    time step          = 0.05
    reference energy   = -16.8779
    reference variance = 0.196369
====================================================
  Execution time = 1.4512e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s049
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6903e+01
  VMC Evar = 3.1640e-01
  Total weights = 1.9519e+06
  Execution time = 1.9577e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.306054862586
                                         uncertainty =       0.002083412034

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.306054862586
                                         uncertainty =       0.002083412034

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000391197608
  error estimate for blocks of size 2^( 2) =       0.000404987448
  error estimate for blocks of size 2^( 3) =       0.000418831386
  error estimate for blocks of size 2^( 4) =       0.000431894963
  error estimate for blocks of size 2^( 5) =       0.000443299353
  error estimate for blocks of size 2^( 6) =       0.000450131617
  error estimate for blocks of size 2^( 7) =       0.000453374197

      target function =      -0.884206596346
              le_mean =     -16.903214025582
             les_mean =     286.035060307644
             stat err =       0.000444675032
             autocorr =       1.292091025968
   target nu stat err =       0.000444675032
   target dn stat err =       0.002300276375
      target stat err =       0.002953482552
              std dev =       0.553236962535
             le_variance =       0.306071136714

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.306033359096
                                         uncertainty =       0.002083843666

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.306033359096
                                         uncertainty =       0.002083843666

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000391183847
  error estimate for blocks of size 2^( 2) =       0.000404976182
  error estimate for blocks of size 2^( 3) =       0.000418823054
  error estimate for blocks of size 2^( 4) =       0.000431888143
  error estimate for blocks of size 2^( 5) =       0.000443293537
  error estimate for blocks of size 2^( 6) =       0.000450125720
  error estimate for blocks of size 2^( 7) =       0.000453370445

      target function =      -0.884253929259
              le_mean =     -16.903214242586
             les_mean =     286.035029910090
             stat err =       0.000444669461
             autocorr =       1.292149554196
   target nu stat err =       0.000444669461
   target dn stat err =       0.002304095726
      target stat err =       0.002958471915
              std dev =       0.553217501768
             le_variance =       0.306049604262

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.306044019637
                                         uncertainty =       0.002083628535

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.306044019637
                                         uncertainty =       0.002083628535

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000391190669
  error estimate for blocks of size 2^( 2) =       0.000404981762
  error estimate for blocks of size 2^( 3) =       0.000418827174
  error estimate for blocks of size 2^( 4) =       0.000431891511
  error estimate for blocks of size 2^( 5) =       0.000443296405
  error estimate for blocks of size 2^( 6) =       0.000450128627
  error estimate for blocks of size 2^( 7) =       0.000453372283

      target function =      -0.884235706767
              le_mean =     -16.903214130301
             les_mean =     286.035040640790
             stat err =       0.000444672206
             autocorr =       1.292120439222
   target nu stat err =       0.000444672206
   target dn stat err =       0.002302083983
      target stat err =       0.002955887508
              std dev =       0.553227149598
             le_variance =       0.306060279052

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.306053501563
                                         uncertainty =       0.002083439082

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.306053501563
                                         uncertainty =       0.002083439082

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000391196737
  error estimate for blocks of size 2^( 2) =       0.000404986733
  error estimate for blocks of size 2^( 3) =       0.000418830856
  error estimate for blocks of size 2^( 4) =       0.000431894528
  error estimate for blocks of size 2^( 5) =       0.000443298982
  error estimate for blocks of size 2^( 6) =       0.000450131239
  error estimate for blocks of size 2^( 7) =       0.000453373954

      target function =      -0.884210979300
              le_mean =     -16.903214038205
             les_mean =     286.035057240185
             stat err =       0.000444674676
             autocorr =       1.292094707359
   target nu stat err =       0.000444674676
   target dn stat err =       0.002300486286
      target stat err =       0.002953768350
              std dev =       0.553235730803
             le_variance =       0.306069773837


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.884206596346        initial
     9.7656e+00     9.7656e+01             3.2043e-05        -0.884253929259  <--
     3.9062e+01     3.9062e+02             8.0332e-06        -0.884235706767
     1.5625e+02     1.5625e+03             2.0097e-06        -0.884210979300

*****************************************************************************
Applying the update for shift_i =   9.7656e+00     and shift_s =   9.7656e+01
*****************************************************************************

  Execution time = 2.4385e+01
  </log>
  <optVariables href="H2O.s049.opt.xml">
ci_0001                 7.000973e-01 3 1  ON 0
ci_0002                 6.994140e-01 3 1  ON 1
ci_0003                -3.362011e-02 3 1  ON 2
ci_0004                -3.384292e-02 3 1  ON 3
ci_0005                -3.109325e-02 3 1  ON 4
ci_0006                -3.211143e-02 3 1  ON 5
ci_0007                -1.994197e-02 3 1  ON 6
ci_0008                -2.040578e-02 3 1  ON 7
ci_0009                -2.072484e-02 3 1  ON 8
ci_0010                -2.102578e-02 3 1  ON 9
ci_0011                -1.721642e-02 3 1  ON 10
ci_0012                -1.711737e-02 3 1  ON 11
ci_0013                 1.721670e-02 3 1  ON 12
ci_0014                 1.720461e-02 3 1  ON 13
ci_0015                 1.750826e-02 3 1  ON 14
ci_0016                 1.750848e-02 3 1  ON 15
ci_0017                 1.518732e-02 3 1  ON 16
ci_0018                 1.554764e-02 3 1  ON 17
ci_0019                 1.352966e-02 3 1  ON 18
ci_0020                 1.316485e-02 3 1  ON 19
ci_0021                 1.669744e-02 3 1  ON 20
ci_0022                 1.732499e-02 3 1  ON 21
ci_0023                -1.243812e-02 3 1  ON 22
ci_0024                -1.209577e-02 3 1  ON 23
ci_0025                -4.465078e-03 3 1  ON 24
ci_0026                -4.158065e-03 3 1  ON 25
ci_0027                -1.236477e-02 3 1  ON 26
ci_0028                -1.231479e-02 3 1  ON 27
ci_0029                -1.081265e-02 3 1  ON 28
ci_0030                -1.083182e-02 3 1  ON 29
ci_0031                 1.440201e-02 3 1  ON 30
ci_0032                 1.440453e-02 3 1  ON 31
ci_0033                 9.788291e-03 3 1  ON 32
ci_0034                 9.874281e-03 3 1  ON 33
ci_0035                 6.178858e-03 3 1  ON 34
ci_0036                 6.401023e-03 3 1  ON 35
ci_0037                -1.201566e-02 3 1  ON 36
ci_0038                -1.196652e-02 3 1  ON 37
ci_0039                -5.122488e-03 3 1  ON 38
ci_0040                -5.139089e-03 3 1  ON 39
ci_0041                 1.034827e-02 3 1  ON 40
ci_0042                 1.063240e-02 3 1  ON 41
ci_0043                -7.158304e-03 3 1  ON 42
ci_0044                -8.113783e-03 3 1  ON 43
ci_0045                 1.091025e-02 3 1  ON 44
ci_0046                 1.045937e-02 3 1  ON 45
ci_0047                -4.616594e-03 3 1  ON 46
ci_0048                -4.702341e-03 3 1  ON 47
ci_0049                -3.658689e-03 3 1  ON 48
ci_0050                -3.831988e-03 3 1  ON 49
ci_0051                -2.807326e-03 3 1  ON 50
ci_0052                -2.821448e-03 3 1  ON 51
ci_0053                -4.206465e-03 3 1  ON 52
ci_0054                -4.446274e-03 3 1  ON 53
ci_0055                 3.357542e-03 3 1  ON 54
ci_0056                 2.694831e-03 3 1  ON 55
ci_0057                 3.235608e-03 3 1  ON 56
ci_0058                 3.780833e-03 3 1  ON 57
ci_0059                -4.615926e-03 3 1  ON 58
ci_0060                -4.289789e-03 3 1  ON 59
ci_0061                -4.257871e-03 3 1  ON 60
ci_0062                -4.293748e-03 3 1  ON 61
ci_0063                -9.927541e-03 3 1  ON 62
ci_0064                -9.710497e-03 3 1  ON 63
ci_0065                -7.451240e-03 3 1  ON 64
ci_0066                -7.493498e-03 3 1  ON 65
ci_0067                -4.648354e-03 3 1  ON 66
ci_0068                -4.849757e-03 3 1  ON 67
ci_0069                 4.499143e-03 3 1  ON 68
ci_0070                 3.960667e-03 3 1  ON 69
ci_0071                 4.688424e-03 3 1  ON 70
ci_0072                 5.065845e-03 3 1  ON 71
ci_0073                 4.163533e-03 3 1  ON 72
ci_0074                 4.376223e-03 3 1  ON 73
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 4.1977e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s050 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s050 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=50  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6898e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 50
    time step          = 0.05
    reference energy   = -16.9287
    reference variance = 0.208905
====================================================
  Execution time = 1.5042e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s050
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5260e+04
  VMC Eavg = -1.6904e+01
  VMC Evar = 3.1196e-01
  Total weights = 1.951482749e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 2.6948e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.301499794687
                                         uncertainty =       0.001877116613

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.301499794687
                                         uncertainty =       0.001877116613

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000388205890
  error estimate for blocks of size 2^( 2) =       0.000402858477
  error estimate for blocks of size 2^( 3) =       0.000417804297
  error estimate for blocks of size 2^( 4) =       0.000431695607
  error estimate for blocks of size 2^( 5) =       0.000443513763
  error estimate for blocks of size 2^( 6) =       0.000452035290
  error estimate for blocks of size 2^( 7) =       0.000455270988

      target function =      -0.889895951486
              le_mean =     -16.903651842681
             les_mean =     286.045406214081
             stat err =       0.000445628912
             autocorr =       1.317718002515
   target nu stat err =       0.000445628912
   target dn stat err =       0.002595596289
      target stat err =       0.003360979011
              std dev =       0.549006034444
             le_variance =       0.301407625856


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690365184268e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 74
Check correct_vf_var_size: 225, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.4414e+00, overlap shift 2.4414e+01 and omega -1.7527e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.889907683690       residual = 2.40e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.889957019251       residual = 3.92e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.889966508793       residual = 1.60e-03           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.889969666557       residual = 4.40e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.889971276498       residual = 2.67e-04           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.889971930441       residual = 1.30e-04           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.889972436607       residual = 3.28e-05           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.889972559510       residual = 1.61e-05           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.889972539391       residual = 1.16e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.889972449742       residual = 1.08e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.889972576483       residual = 8.16e-06           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.889972641341       residual = 4.98e-06           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.889972660499       residual = 1.85e-06           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.889972664176       residual = 4.92e-07           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.889972660810       residual = 1.10e-07           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.889972655544       residual = 1.79e-08           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.889972650786       residual = 4.86e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         16 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 2.4414e+00 is 1.506221e-04

solving harmonic davidson linear method for identity shift 9.7656e+00, overlap shift 9.7656e+01 and omega -1.7527e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.889907683690       residual = 2.40e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.889920286526       residual = 3.90e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.889922696175       residual = 1.57e-03           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.889923490838       residual = 4.32e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.889923895443       residual = 2.61e-04           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.889924058675       residual = 1.26e-04           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.889924184659       residual = 3.16e-05           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.889924214325       residual = 1.56e-05           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.889924208777       residual = 1.12e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.889924186615       residual = 1.05e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.889924218704       residual = 7.71e-06           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.889924234374       residual = 4.63e-06           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.889924238502       residual = 1.66e-06           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.889924239372       residual = 4.38e-07           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.889924238573       residual = 9.50e-08           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.889924237260       residual = 1.57e-08           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.889924236120       residual = 4.22e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         16 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 9.7656e+00 is 3.808373e-05

solving harmonic davidson linear method for identity shift 3.9062e+01, overlap shift 3.9062e+02 and omega -1.7527e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.889907683690       residual = 2.40e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.889910851668       residual = 3.89e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.889911456450       residual = 1.57e-03           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.889911655436       residual = 4.31e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.889911756716       residual = 2.59e-04           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.889911797506       residual = 1.25e-04           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.889911828964       residual = 3.13e-05           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.889911836312       residual = 1.54e-05           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.889911834892       residual = 1.12e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.889911829369       residual = 1.04e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.889911837416       residual = 7.60e-06           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.889911841298       residual = 4.54e-06           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.889911842289       residual = 1.62e-06           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.889911842504       residual = 4.25e-07           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.889911842307       residual = 9.14e-08           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.889911841979       residual = 1.52e-08           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.889911841697       residual = 4.07e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         16 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 3.9062e+01 is 9.548076e-06

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.735408 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 75 and numParams is: 74

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.7754e+01
  </log>
  <optVariables href="H2O.s050.opt.xml">
ci_0001                 7.001306e-01 3 1  ON 0
ci_0002                 6.993936e-01 3 1  ON 1
ci_0003                -3.360001e-02 3 1  ON 2
ci_0004                -3.382206e-02 3 1  ON 3
ci_0005                -3.106883e-02 3 1  ON 4
ci_0006                -3.208008e-02 3 1  ON 5
ci_0007                -1.990388e-02 3 1  ON 6
ci_0008                -2.039078e-02 3 1  ON 7
ci_0009                -2.070954e-02 3 1  ON 8
ci_0010                -2.100899e-02 3 1  ON 9
ci_0011                -1.720300e-02 3 1  ON 10
ci_0012                -1.710174e-02 3 1  ON 11
ci_0013                 1.720137e-02 3 1  ON 12
ci_0014                 1.719465e-02 3 1  ON 13
ci_0015                 1.749822e-02 3 1  ON 14
ci_0016                 1.750255e-02 3 1  ON 15
ci_0017                 1.517611e-02 3 1  ON 16
ci_0018                 1.552769e-02 3 1  ON 17
ci_0019                 1.351907e-02 3 1  ON 18
ci_0020                 1.315070e-02 3 1  ON 19
ci_0021                 1.668737e-02 3 1  ON 20
ci_0022                 1.730472e-02 3 1  ON 21
ci_0023                -1.243283e-02 3 1  ON 22
ci_0024                -1.208641e-02 3 1  ON 23
ci_0025                -4.445204e-03 3 1  ON 24
ci_0026                -4.141559e-03 3 1  ON 25
ci_0027                -1.235681e-02 3 1  ON 26
ci_0028                -1.230589e-02 3 1  ON 27
ci_0029                -1.080957e-02 3 1  ON 28
ci_0030                -1.083026e-02 3 1  ON 29
ci_0031                 1.440306e-02 3 1  ON 30
ci_0032                 1.439583e-02 3 1  ON 31
ci_0033                 9.783155e-03 3 1  ON 32
ci_0034                 9.859295e-03 3 1  ON 33
ci_0035                 6.179058e-03 3 1  ON 34
ci_0036                 6.388547e-03 3 1  ON 35
ci_0037                -1.201344e-02 3 1  ON 36
ci_0038                -1.198358e-02 3 1  ON 37
ci_0039                -5.108601e-03 3 1  ON 38
ci_0040                -5.127960e-03 3 1  ON 39
ci_0041                 1.033821e-02 3 1  ON 40
ci_0042                 1.062252e-02 3 1  ON 41
ci_0043                -7.144253e-03 3 1  ON 42
ci_0044                -8.110385e-03 3 1  ON 43
ci_0045                 1.090710e-02 3 1  ON 44
ci_0046                 1.047181e-02 3 1  ON 45
ci_0047                -4.602246e-03 3 1  ON 46
ci_0048                -4.689958e-03 3 1  ON 47
ci_0049                -3.651526e-03 3 1  ON 48
ci_0050                -3.826325e-03 3 1  ON 49
ci_0051                -2.802809e-03 3 1  ON 50
ci_0052                -2.815086e-03 3 1  ON 51
ci_0053                -4.201019e-03 3 1  ON 52
ci_0054                -4.442854e-03 3 1  ON 53
ci_0055                 3.349080e-03 3 1  ON 54
ci_0056                 2.699792e-03 3 1  ON 55
ci_0057                 3.237130e-03 3 1  ON 56
ci_0058                 3.772703e-03 3 1  ON 57
ci_0059                -4.611461e-03 3 1  ON 58
ci_0060                -4.279391e-03 3 1  ON 59
ci_0061                -4.247817e-03 3 1  ON 60
ci_0062                -4.280401e-03 3 1  ON 61
ci_0063                -9.926462e-03 3 1  ON 62
ci_0064                -9.728459e-03 3 1  ON 63
ci_0065                -7.445594e-03 3 1  ON 64
ci_0066                -7.495768e-03 3 1  ON 65
ci_0067                -4.643329e-03 3 1  ON 66
ci_0068                -4.846725e-03 3 1  ON 67
ci_0069                 4.490718e-03 3 1  ON 68
ci_0070                 3.952948e-03 3 1  ON 69
ci_0071                 4.686521e-03 3 1  ON 70
ci_0072                 5.063315e-03 3 1  ON 71
ci_0073                 4.158362e-03 3 1  ON 72
ci_0074                 4.366838e-03 3 1  ON 73
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 50
    time step          = 0.05
    reference energy   = -16.8747
    reference variance = 0.25741
====================================================
  Execution time = 1.4321e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s050
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6903e+01
  VMC Evar = 3.1506e-01
  Total weights = 1.9517e+06
  Execution time = 1.9512e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.305297343009
                                         uncertainty =       0.001904294103

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.305297343009
                                         uncertainty =       0.001904294103

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000390834305
  error estimate for blocks of size 2^( 2) =       0.000405286384
  error estimate for blocks of size 2^( 3) =       0.000419874402
  error estimate for blocks of size 2^( 4) =       0.000433079320
  error estimate for blocks of size 2^( 5) =       0.000445222506
  error estimate for blocks of size 2^( 6) =       0.000453890979
  error estimate for blocks of size 2^( 7) =       0.000457449749

      target function =      -0.885864655502
              le_mean =     -16.903044142556
             les_mean =     286.027978507060
             stat err =       0.000447410638
             autocorr =       1.310470529581
   target nu stat err =       0.000447410638
   target dn stat err =       0.002183082535
      target stat err =       0.002820434114
              std dev =       0.552723175267
             le_variance =       0.305502908477

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.305219733689
                                         uncertainty =       0.001904794881

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.305219733689
                                         uncertainty =       0.001904794881

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000390784754
  error estimate for blocks of size 2^( 2) =       0.000405243515
  error estimate for blocks of size 2^( 3) =       0.000419838616
  error estimate for blocks of size 2^( 4) =       0.000433049724
  error estimate for blocks of size 2^( 5) =       0.000445194573
  error estimate for blocks of size 2^( 6) =       0.000453866731
  error estimate for blocks of size 2^( 7) =       0.000457423436

      target function =      -0.885626116183
              le_mean =     -16.903045097717
             les_mean =     286.028200383522
             stat err =       0.000447383616
             autocorr =       1.310644553185
   target nu stat err =       0.000447383616
   target dn stat err =       0.002197741938
      target stat err =       0.002836920229
              std dev =       0.552653098908
             le_variance =       0.305425447733

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.305257251363
                                         uncertainty =       0.001904539496

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.305257251363
                                         uncertainty =       0.001904539496

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000390808708
  error estimate for blocks of size 2^( 2) =       0.000405264202
  error estimate for blocks of size 2^( 3) =       0.000419855788
  error estimate for blocks of size 2^( 4) =       0.000433063861
  error estimate for blocks of size 2^( 5) =       0.000445207930
  error estimate for blocks of size 2^( 6) =       0.000453878364
  error estimate for blocks of size 2^( 7) =       0.000457436117

      target function =      -0.885878595147
              le_mean =     -16.903044583644
             les_mean =     286.027982385897
             stat err =       0.000447396568
             autocorr =       1.310559766050
   target nu stat err =       0.000447396568
   target dn stat err =       0.002184747541
      target stat err =       0.002822560085
              std dev =       0.552686975558
             le_variance =       0.305462892952

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.305292250309
                                         uncertainty =       0.001904323988

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.305292250309
                                         uncertainty =       0.001904323988

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000390831054
  error estimate for blocks of size 2^( 2) =       0.000405283556
  error estimate for blocks of size 2^( 3) =       0.000419872023
  error estimate for blocks of size 2^( 4) =       0.000433077337
  error estimate for blocks of size 2^( 5) =       0.000445220646
  error estimate for blocks of size 2^( 6) =       0.000453889359
  error estimate for blocks of size 2^( 7) =       0.000457447962

      target function =      -0.885716090106
              le_mean =     -16.903044194297
             les_mean =     286.028098292046
             stat err =       0.000447408826
             autocorr =       1.310481718272
   target nu stat err =       0.000447408826
   target dn stat err =       0.002186817598
      target stat err =       0.002824090933
              std dev =       0.552718577001
             le_variance =       0.305497825361


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.885864655502        initial
     2.4414e+00     2.4414e+01             1.5062e-04        -0.885626116183
     9.7656e+00     9.7656e+01             3.8084e-05        -0.885878595147  <--
     3.9062e+01     3.9062e+02             9.5481e-06        -0.885716090106

*****************************************************************************
Applying the update for shift_i =   9.7656e+00     and shift_s =   9.7656e+01
*****************************************************************************

  Execution time = 2.4188e+01
  </log>
  <optVariables href="H2O.s050.opt.xml">
ci_0001                 7.001306e-01 3 1  ON 0
ci_0002                 6.993936e-01 3 1  ON 1
ci_0003                -3.360001e-02 3 1  ON 2
ci_0004                -3.382206e-02 3 1  ON 3
ci_0005                -3.106883e-02 3 1  ON 4
ci_0006                -3.208008e-02 3 1  ON 5
ci_0007                -1.990388e-02 3 1  ON 6
ci_0008                -2.039078e-02 3 1  ON 7
ci_0009                -2.070954e-02 3 1  ON 8
ci_0010                -2.100899e-02 3 1  ON 9
ci_0011                -1.720300e-02 3 1  ON 10
ci_0012                -1.710174e-02 3 1  ON 11
ci_0013                 1.720137e-02 3 1  ON 12
ci_0014                 1.719465e-02 3 1  ON 13
ci_0015                 1.749822e-02 3 1  ON 14
ci_0016                 1.750255e-02 3 1  ON 15
ci_0017                 1.517611e-02 3 1  ON 16
ci_0018                 1.552769e-02 3 1  ON 17
ci_0019                 1.351907e-02 3 1  ON 18
ci_0020                 1.315070e-02 3 1  ON 19
ci_0021                 1.668737e-02 3 1  ON 20
ci_0022                 1.730472e-02 3 1  ON 21
ci_0023                -1.243283e-02 3 1  ON 22
ci_0024                -1.208641e-02 3 1  ON 23
ci_0025                -4.445204e-03 3 1  ON 24
ci_0026                -4.141559e-03 3 1  ON 25
ci_0027                -1.235681e-02 3 1  ON 26
ci_0028                -1.230589e-02 3 1  ON 27
ci_0029                -1.080957e-02 3 1  ON 28
ci_0030                -1.083026e-02 3 1  ON 29
ci_0031                 1.440306e-02 3 1  ON 30
ci_0032                 1.439583e-02 3 1  ON 31
ci_0033                 9.783155e-03 3 1  ON 32
ci_0034                 9.859295e-03 3 1  ON 33
ci_0035                 6.179058e-03 3 1  ON 34
ci_0036                 6.388547e-03 3 1  ON 35
ci_0037                -1.201344e-02 3 1  ON 36
ci_0038                -1.198358e-02 3 1  ON 37
ci_0039                -5.108601e-03 3 1  ON 38
ci_0040                -5.127960e-03 3 1  ON 39
ci_0041                 1.033821e-02 3 1  ON 40
ci_0042                 1.062252e-02 3 1  ON 41
ci_0043                -7.144253e-03 3 1  ON 42
ci_0044                -8.110385e-03 3 1  ON 43
ci_0045                 1.090710e-02 3 1  ON 44
ci_0046                 1.047181e-02 3 1  ON 45
ci_0047                -4.602246e-03 3 1  ON 46
ci_0048                -4.689958e-03 3 1  ON 47
ci_0049                -3.651526e-03 3 1  ON 48
ci_0050                -3.826325e-03 3 1  ON 49
ci_0051                -2.802809e-03 3 1  ON 50
ci_0052                -2.815086e-03 3 1  ON 51
ci_0053                -4.201019e-03 3 1  ON 52
ci_0054                -4.442854e-03 3 1  ON 53
ci_0055                 3.349080e-03 3 1  ON 54
ci_0056                 2.699792e-03 3 1  ON 55
ci_0057                 3.237130e-03 3 1  ON 56
ci_0058                 3.772703e-03 3 1  ON 57
ci_0059                -4.611461e-03 3 1  ON 58
ci_0060                -4.279391e-03 3 1  ON 59
ci_0061                -4.247817e-03 3 1  ON 60
ci_0062                -4.280401e-03 3 1  ON 61
ci_0063                -9.926462e-03 3 1  ON 62
ci_0064                -9.728459e-03 3 1  ON 63
ci_0065                -7.445594e-03 3 1  ON 64
ci_0066                -7.495768e-03 3 1  ON 65
ci_0067                -4.643329e-03 3 1  ON 66
ci_0068                -4.846725e-03 3 1  ON 67
ci_0069                 4.490718e-03 3 1  ON 68
ci_0070                 3.952948e-03 3 1  ON 69
ci_0071                 4.686521e-03 3 1  ON 70
ci_0072                 5.063315e-03 3 1  ON 71
ci_0073                 4.158362e-03 3 1  ON 72
ci_0074                 4.366838e-03 3 1  ON 73
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 4.1948e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s051 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s051 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=51  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6898e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 51
    time step          = 0.05
    reference energy   = -16.8313
    reference variance = 0.234974
====================================================
  Execution time = 1.5112e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s051
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5290e+04
  VMC Eavg = -1.6904e+01
  VMC Evar = 3.1618e-01
  Total weights = 1.951789105e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 2.7058e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.305302448736
                                         uncertainty =       0.001788302929

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.305302448736
                                         uncertainty =       0.001788302929

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000390659407
  error estimate for blocks of size 2^( 2) =       0.000405073041
  error estimate for blocks of size 2^( 3) =       0.000419212749
  error estimate for blocks of size 2^( 4) =       0.000432744971
  error estimate for blocks of size 2^( 5) =       0.000445265779
  error estimate for blocks of size 2^( 6) =       0.000453933485
  error estimate for blocks of size 2^( 7) =       0.000457520620

      target function =      -0.884561330313
              le_mean =     -16.903634326863
             les_mean =     286.049035042082
             stat err =       0.000447366214
             autocorr =       1.311383727840
   target nu stat err =       0.000447366214
   target dn stat err =       0.002354194704
      target stat err =       0.003024799522
              std dev =       0.552475832308
             le_variance =       0.305229545284


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690363432686e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 74
Check correct_vf_var_size: 225, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.4414e+00, overlap shift 2.4414e+01 and omega -1.7527e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.884570546557       residual = 2.89e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.884621432562       residual = 5.25e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.884631377875       residual = 1.58e-03           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.884635344570       residual = 4.48e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.884636496717       residual = 2.23e-04           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.884637230840       residual = 9.39e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.884637472616       residual = 4.25e-05           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.884637613030       residual = 1.91e-05           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.884637700832       residual = 1.16e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.884637644785       residual = 1.12e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.884637634243       residual = 9.50e-06           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.884637661876       residual = 5.16e-06           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.884637665754       residual = 3.50e-06           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.884637701633       residual = 6.25e-07           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.884637709307       residual = 1.61e-07           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.884637713858       residual = 2.16e-08           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.884637713020       residual = 6.29e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         16 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 2.4414e+00 is 1.327806e-04

solving harmonic davidson linear method for identity shift 9.7656e+00, overlap shift 9.7656e+01 and omega -1.7527e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.884570546557       residual = 2.89e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.884583552737       residual = 5.22e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.884586083175       residual = 1.57e-03           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.884587084321       residual = 4.41e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.884587373650       residual = 2.18e-04           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.884587556680       residual = 9.07e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.884587616748       residual = 4.11e-05           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.884587651372       residual = 1.85e-05           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.884587672997       residual = 1.12e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.884587658564       residual = 1.09e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.884587656014       residual = 9.02e-06           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.884587662974       residual = 4.84e-06           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.884587664003       residual = 3.17e-06           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.884587672617       residual = 5.54e-07           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.884587674418       residual = 1.39e-07           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.884587675489       residual = 1.87e-08           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.884587675283       residual = 5.51e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         16 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 9.7656e+00 is 3.331335e-05

solving harmonic davidson linear method for identity shift 3.9062e+01, overlap shift 3.9062e+02 and omega -1.7527e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.884570546557       residual = 2.89e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.884573816394       residual = 5.22e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.884574451819       residual = 1.56e-03           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.884574702697       residual = 4.39e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.884574775107       residual = 2.17e-04           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.884574820830       residual = 8.99e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.884574835822       residual = 4.07e-05           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.884574844447       residual = 1.83e-05           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.884574849832       residual = 1.12e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.884574846197       residual = 1.08e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.884574845565       residual = 8.90e-06           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.884574847308       residual = 4.76e-06           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.884574847569       residual = 3.09e-06           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.884574849701       residual = 5.37e-07           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.884574850143       residual = 1.34e-07           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.884574850407       residual = 1.80e-08           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.884574850356       residual = 5.33e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         16 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 3.9062e+01 is 8.335886e-06

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.744507 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 75 and numParams is: 74

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.7833e+01
  </log>
  <optVariables href="H2O.s051.opt.xml">
ci_0001                 7.001639e-01 3 1  ON 0
ci_0002                 6.993743e-01 3 1  ON 1
ci_0003                -3.358451e-02 3 1  ON 2
ci_0004                -3.379439e-02 3 1  ON 3
ci_0005                -3.104771e-02 3 1  ON 4
ci_0006                -3.204880e-02 3 1  ON 5
ci_0007                -1.987139e-02 3 1  ON 6
ci_0008                -2.037142e-02 3 1  ON 7
ci_0009                -2.069655e-02 3 1  ON 8
ci_0010                -2.098772e-02 3 1  ON 9
ci_0011                -1.719062e-02 3 1  ON 10
ci_0012                -1.708972e-02 3 1  ON 11
ci_0013                 1.718644e-02 3 1  ON 12
ci_0014                 1.717625e-02 3 1  ON 13
ci_0015                 1.748484e-02 3 1  ON 14
ci_0016                 1.749009e-02 3 1  ON 15
ci_0017                 1.516470e-02 3 1  ON 16
ci_0018                 1.551455e-02 3 1  ON 17
ci_0019                 1.351363e-02 3 1  ON 18
ci_0020                 1.314212e-02 3 1  ON 19
ci_0021                 1.668484e-02 3 1  ON 20
ci_0022                 1.728524e-02 3 1  ON 21
ci_0023                -1.242668e-02 3 1  ON 22
ci_0024                -1.207780e-02 3 1  ON 23
ci_0025                -4.429197e-03 3 1  ON 24
ci_0026                -4.119336e-03 3 1  ON 25
ci_0027                -1.234890e-02 3 1  ON 26
ci_0028                -1.230163e-02 3 1  ON 27
ci_0029                -1.081064e-02 3 1  ON 28
ci_0030                -1.082449e-02 3 1  ON 29
ci_0031                 1.439367e-02 3 1  ON 30
ci_0032                 1.439068e-02 3 1  ON 31
ci_0033                 9.769499e-03 3 1  ON 32
ci_0034                 9.858481e-03 3 1  ON 33
ci_0035                 6.170197e-03 3 1  ON 34
ci_0036                 6.371275e-03 3 1  ON 35
ci_0037                -1.201342e-02 3 1  ON 36
ci_0038                -1.198576e-02 3 1  ON 37
ci_0039                -5.090198e-03 3 1  ON 38
ci_0040                -5.120112e-03 3 1  ON 39
ci_0041                 1.033489e-02 3 1  ON 40
ci_0042                 1.062097e-02 3 1  ON 41
ci_0043                -7.130720e-03 3 1  ON 42
ci_0044                -8.089782e-03 3 1  ON 43
ci_0045                 1.089674e-02 3 1  ON 44
ci_0046                 1.046673e-02 3 1  ON 45
ci_0047                -4.592540e-03 3 1  ON 46
ci_0048                -4.678649e-03 3 1  ON 47
ci_0049                -3.637768e-03 3 1  ON 48
ci_0050                -3.824478e-03 3 1  ON 49
ci_0051                -2.796979e-03 3 1  ON 50
ci_0052                -2.803229e-03 3 1  ON 51
ci_0053                -4.196071e-03 3 1  ON 52
ci_0054                -4.439727e-03 3 1  ON 53
ci_0055                 3.343505e-03 3 1  ON 54
ci_0056                 2.693340e-03 3 1  ON 55
ci_0057                 3.230482e-03 3 1  ON 56
ci_0058                 3.769361e-03 3 1  ON 57
ci_0059                -4.600453e-03 3 1  ON 58
ci_0060                -4.267607e-03 3 1  ON 59
ci_0061                -4.239872e-03 3 1  ON 60
ci_0062                -4.267157e-03 3 1  ON 61
ci_0063                -9.923437e-03 3 1  ON 62
ci_0064                -9.726206e-03 3 1  ON 63
ci_0065                -7.442963e-03 3 1  ON 64
ci_0066                -7.490004e-03 3 1  ON 65
ci_0067                -4.632444e-03 3 1  ON 66
ci_0068                -4.843923e-03 3 1  ON 67
ci_0069                 4.480371e-03 3 1  ON 68
ci_0070                 3.951176e-03 3 1  ON 69
ci_0071                 4.673955e-03 3 1  ON 70
ci_0072                 5.053314e-03 3 1  ON 71
ci_0073                 4.155159e-03 3 1  ON 72
ci_0074                 4.360780e-03 3 1  ON 73
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 51
    time step          = 0.05
    reference energy   = -16.8907
    reference variance = 0.182332
====================================================
  Execution time = 1.4326e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s051
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6904e+01
  VMC Evar = 3.2061e-01
  Total weights = 1.9516e+06
  Execution time = 1.9605e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.306517431991
                                         uncertainty =       0.002279777999

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.306517431991
                                         uncertainty =       0.002279777999

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000391475492
  error estimate for blocks of size 2^( 2) =       0.000405224956
  error estimate for blocks of size 2^( 3) =       0.000419371119
  error estimate for blocks of size 2^( 4) =       0.000432383577
  error estimate for blocks of size 2^( 5) =       0.000443248791
  error estimate for blocks of size 2^( 6) =       0.000450793942
  error estimate for blocks of size 2^( 7) =       0.000454972644

      target function =      -0.878810356085
              le_mean =     -16.903594660009
             les_mean =     286.052286060751
             stat err =       0.000445349738
             autocorr =       1.294175715562
   target nu stat err =       0.000445349738
   target dn stat err =       0.003717693842
      target stat err =       0.004652027175
              std dev =       0.553629949616
             le_variance =       0.306506121112

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.306430486502
                                         uncertainty =       0.002279697147

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.306430486502
                                         uncertainty =       0.002279697147

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000391419925
  error estimate for blocks of size 2^( 2) =       0.000405177851
  error estimate for blocks of size 2^( 3) =       0.000419333902
  error estimate for blocks of size 2^( 4) =       0.000432354922
  error estimate for blocks of size 2^( 5) =       0.000443228031
  error estimate for blocks of size 2^( 6) =       0.000450774538
  error estimate for blocks of size 2^( 7) =       0.000454959654

      target function =      -0.879488460993
              le_mean =     -16.903592419826
             les_mean =     286.051664764120
             stat err =       0.000445329286
             autocorr =       1.294424290834
   target nu stat err =       0.000445329286
   target dn stat err =       0.003600660509
      target stat err =       0.004515159649
              std dev =       0.553551366884
             le_variance =       0.306419115779

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.306472481422
                                         uncertainty =       0.002279736936

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.306472481422
                                         uncertainty =       0.002279736936

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000391446765
  error estimate for blocks of size 2^( 2) =       0.000405200531
  error estimate for blocks of size 2^( 3) =       0.000419351732
  error estimate for blocks of size 2^( 4) =       0.000432368554
  error estimate for blocks of size 2^( 5) =       0.000443237788
  error estimate for blocks of size 2^( 6) =       0.000450783649
  error estimate for blocks of size 2^( 7) =       0.000454965599

      target function =      -0.879196550987
              le_mean =     -16.903593428071
             les_mean =     286.051933653148
             stat err =       0.000445338898
             autocorr =       1.294302657342
   target nu stat err =       0.000445338898
   target dn stat err =       0.003646818641
      target stat err =       0.004568932079
              std dev =       0.553589324307
             le_variance =       0.306461139987

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.306511714760
                                         uncertainty =       0.002279771863

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.306511714760
                                         uncertainty =       0.002279771863

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000391471838
  error estimate for blocks of size 2^( 2) =       0.000405221841
  error estimate for blocks of size 2^( 3) =       0.000419368637
  error estimate for blocks of size 2^( 4) =       0.000432381643
  error estimate for blocks of size 2^( 5) =       0.000443247362
  error estimate for blocks of size 2^( 6) =       0.000450792604
  error estimate for blocks of size 2^( 7) =       0.000454971711

      target function =      -0.878864277204
              le_mean =     -16.903594494827
             les_mean =     286.052237080415
             stat err =       0.000445348330
             autocorr =       1.294191686843
   target nu stat err =       0.000445348330
   target dn stat err =       0.003707082775
      target stat err =       0.004639553732
              std dev =       0.553624782744
             le_variance =       0.306500400069


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.878810356085        initial
     2.4414e+00     2.4414e+01             1.3278e-04        -0.879488460993  <--
     9.7656e+00     9.7656e+01             3.3313e-05        -0.879196550987
     3.9062e+01     3.9062e+02             8.3359e-06        -0.878864277204

*****************************************************************************
Applying the update for shift_i =   2.4414e+00     and shift_s =   2.4414e+01
*****************************************************************************

  Execution time = 2.4187e+01
  </log>
  <optVariables href="H2O.s051.opt.xml">
ci_0001                 7.002634e-01 3 1  ON 0
ci_0002                 6.993158e-01 3 1  ON 1
ci_0003                -3.353915e-02 3 1  ON 2
ci_0004                -3.371319e-02 3 1  ON 3
ci_0005                -3.098558e-02 3 1  ON 4
ci_0006                -3.195664e-02 3 1  ON 5
ci_0007                -1.977532e-02 3 1  ON 6
ci_0008                -2.031418e-02 3 1  ON 7
ci_0009                -2.065862e-02 3 1  ON 8
ci_0010                -2.092547e-02 3 1  ON 9
ci_0011                -1.715446e-02 3 1  ON 10
ci_0012                -1.705453e-02 3 1  ON 11
ci_0013                 1.714279e-02 3 1  ON 12
ci_0014                 1.712238e-02 3 1  ON 13
ci_0015                 1.744569e-02 3 1  ON 14
ci_0016                 1.745357e-02 3 1  ON 15
ci_0017                 1.513138e-02 3 1  ON 16
ci_0018                 1.547609e-02 3 1  ON 17
ci_0019                 1.349781e-02 3 1  ON 18
ci_0020                 1.311703e-02 3 1  ON 19
ci_0021                 1.667727e-02 3 1  ON 20
ci_0022                 1.722755e-02 3 1  ON 21
ci_0023                -1.240880e-02 3 1  ON 22
ci_0024                -1.205261e-02 3 1  ON 23
ci_0025                -4.382588e-03 3 1  ON 24
ci_0026                -4.054616e-03 3 1  ON 25
ci_0027                -1.232585e-02 3 1  ON 26
ci_0028                -1.228920e-02 3 1  ON 27
ci_0029                -1.081391e-02 3 1  ON 28
ci_0030                -1.080769e-02 3 1  ON 29
ci_0031                 1.436594e-02 3 1  ON 30
ci_0032                 1.437546e-02 3 1  ON 31
ci_0033                 9.729317e-03 3 1  ON 32
ci_0034                 9.856097e-03 3 1  ON 33
ci_0035                 6.144412e-03 3 1  ON 34
ci_0036                 6.320960e-03 3 1  ON 35
ci_0037                -1.201340e-02 3 1  ON 36
ci_0038                -1.199215e-02 3 1  ON 37
ci_0039                -5.036562e-03 3 1  ON 38
ci_0040                -5.097228e-03 3 1  ON 39
ci_0041                 1.032516e-02 3 1  ON 40
ci_0042                 1.061642e-02 3 1  ON 41
ci_0043                -7.090863e-03 3 1  ON 42
ci_0044                -8.028981e-03 3 1  ON 43
ci_0045                 1.086627e-02 3 1  ON 44
ci_0046                 1.045180e-02 3 1  ON 45
ci_0047                -4.564247e-03 3 1  ON 46
ci_0048                -4.645660e-03 3 1  ON 47
ci_0049                -3.597741e-03 3 1  ON 48
ci_0050                -3.819116e-03 3 1  ON 49
ci_0051                -2.780043e-03 3 1  ON 50
ci_0052                -2.768763e-03 3 1  ON 51
ci_0053                -4.181659e-03 3 1  ON 52
ci_0054                -4.430609e-03 3 1  ON 53
ci_0055                 3.327273e-03 3 1  ON 54
ci_0056                 2.674573e-03 3 1  ON 55
ci_0057                 3.211098e-03 3 1  ON 56
ci_0058                 3.759578e-03 3 1  ON 57
ci_0059                -4.568409e-03 3 1  ON 58
ci_0060                -4.233310e-03 3 1  ON 59
ci_0061                -4.216651e-03 3 1  ON 60
ci_0062                -4.228392e-03 3 1  ON 61
ci_0063                -9.914631e-03 3 1  ON 62
ci_0064                -9.719614e-03 3 1  ON 63
ci_0065                -7.435270e-03 3 1  ON 64
ci_0066                -7.473121e-03 3 1  ON 65
ci_0067                -4.600780e-03 3 1  ON 66
ci_0068                -4.835758e-03 3 1  ON 67
ci_0069                 4.450251e-03 3 1  ON 68
ci_0070                 3.946004e-03 3 1  ON 69
ci_0071                 4.637356e-03 3 1  ON 70
ci_0072                 5.024170e-03 3 1  ON 71
ci_0073                 4.145859e-03 3 1  ON 72
ci_0074                 4.343135e-03 3 1  ON 73
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 4.2026e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s052 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s052 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=52  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6898e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 52
    time step          = 0.05
    reference energy   = -16.8575
    reference variance = 0.204946
====================================================
  Execution time = 1.4988e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s052
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5288e+04
  VMC Eavg = -1.6903e+01
  VMC Evar = 3.2036e-01
  Total weights = 1.951651310e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 2.6602e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.310364923854
                                         uncertainty =       0.003875327352

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.310364923854
                                         uncertainty =       0.003875327352

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000393878918
  error estimate for blocks of size 2^( 2) =       0.000408058046
  error estimate for blocks of size 2^( 3) =       0.000422472579
  error estimate for blocks of size 2^( 4) =       0.000436064604
  error estimate for blocks of size 2^( 5) =       0.000447272223
  error estimate for blocks of size 2^( 6) =       0.000454679872
  error estimate for blocks of size 2^( 7) =       0.000460300954

      target function =      -0.879264809162
              le_mean =     -16.903124419629
             les_mean =     286.035970180301
             stat err =       0.000449579413
             autocorr =       1.302828831573
   target nu stat err =       0.000449579413
   target dn stat err =       0.003819406565
      target stat err =       0.004779097567
              std dev =       0.557028907069
             le_variance =       0.310281203311


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690312441963e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 74
Check correct_vf_var_size: 225, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 6.1035e-01, overlap shift 6.1035e+00 and omega -1.7527e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.879289730720       residual = 3.36e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.879474922098       residual = 7.31e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.879525013161       residual = 1.67e-03           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.879544442804       residual = 5.78e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.879550441562       residual = 3.09e-04           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.879553713322       residual = 1.39e-04           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.879555171455       residual = 2.64e-05           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.879555549341       residual = 8.45e-06           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.879555582911       residual = 4.28e-06           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.879555610227       residual = 1.48e-06           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.879555619884       residual = 6.00e-07           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.879555612633       residual = 2.89e-07           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.879555610915       residual = 4.49e-07           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.879555647030       residual = 3.35e-07           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.879555648445       residual = 1.27e-07           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.879555670051       residual = 3.24e-08           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.879555673387       residual = 1.65e-08           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.879555672754       residual = 4.37e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         17 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 6.1035e-01 is 5.668794e-04

solving harmonic davidson linear method for identity shift 2.4414e+00, overlap shift 2.4414e+01 and omega -1.7527e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.879289730720       residual = 3.36e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.879340147720       residual = 7.18e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.879353546202       residual = 1.62e-03           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.879358610334       residual = 5.45e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.879360143220       residual = 2.84e-04           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.879360959384       residual = 1.22e-04           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.879361312111       residual = 2.29e-05           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.879361401623       residual = 7.27e-06           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.879361407289       residual = 3.56e-06           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.879361413533       residual = 1.22e-06           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.879361415466       residual = 4.89e-07           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.879361413626       residual = 2.53e-07           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.879361413931       residual = 3.95e-07           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.879361422403       residual = 2.51e-07           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.879361422536       residual = 8.09e-08           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.879361427315       residual = 2.07e-08           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.879361427876       residual = 1.05e-08           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.879361427674       residual = 2.48e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         17 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 2.4414e+00 is 1.494632e-04

solving harmonic davidson linear method for identity shift 9.7656e+00, overlap shift 9.7656e+01 and omega -1.7527e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.879289730720       residual = 3.36e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.879302621635       residual = 7.14e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.879306030602       residual = 1.60e-03           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.879307309815       residual = 5.36e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.879307694921       residual = 2.77e-04           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.879307898609       residual = 1.18e-04           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.879307985909       residual = 2.20e-05           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.879308007929       residual = 6.97e-06           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.879308009165       residual = 3.38e-06           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.879308010691       residual = 1.15e-06           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.879308011142       residual = 4.63e-07           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.879308010682       residual = 2.45e-07           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.879308010812       residual = 3.81e-07           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.879308012883       residual = 2.31e-07           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.879308012904       residual = 7.14e-08           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.879308014059       residual = 1.83e-08           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.879308014183       residual = 9.24e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         16 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 9.7656e+00 is 3.790195e-05

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.754419 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 75 and numParams is: 74

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.7664e+01
  </log>
  <optVariables href="H2O.s052.opt.xml">
ci_0001                 7.003099e-01 3 1  ON 0
ci_0002                 6.993188e-01 3 1  ON 1
ci_0003                -3.351860e-02 3 1  ON 2
ci_0004                -3.362467e-02 3 1  ON 3
ci_0005                -3.087898e-02 3 1  ON 4
ci_0006                -3.180717e-02 3 1  ON 5
ci_0007                -1.964757e-02 3 1  ON 6
ci_0008                -2.022113e-02 3 1  ON 7
ci_0009                -2.060821e-02 3 1  ON 8
ci_0010                -2.086900e-02 3 1  ON 9
ci_0011                -1.710623e-02 3 1  ON 10
ci_0012                -1.702343e-02 3 1  ON 11
ci_0013                 1.709417e-02 3 1  ON 12
ci_0014                 1.705011e-02 3 1  ON 13
ci_0015                 1.737215e-02 3 1  ON 14
ci_0016                 1.741222e-02 3 1  ON 15
ci_0017                 1.508807e-02 3 1  ON 16
ci_0018                 1.543157e-02 3 1  ON 17
ci_0019                 1.345254e-02 3 1  ON 18
ci_0020                 1.310343e-02 3 1  ON 19
ci_0021                 1.670981e-02 3 1  ON 20
ci_0022                 1.723608e-02 3 1  ON 21
ci_0023                -1.239785e-02 3 1  ON 22
ci_0024                -1.204901e-02 3 1  ON 23
ci_0025                -4.349523e-03 3 1  ON 24
ci_0026                -3.947899e-03 3 1  ON 25
ci_0027                -1.228191e-02 3 1  ON 26
ci_0028                -1.226316e-02 3 1  ON 27
ci_0029                -1.079500e-02 3 1  ON 28
ci_0030                -1.078047e-02 3 1  ON 29
ci_0031                 1.438137e-02 3 1  ON 30
ci_0032                 1.433319e-02 3 1  ON 31
ci_0033                 9.693405e-03 3 1  ON 32
ci_0034                 9.758247e-03 3 1  ON 33
ci_0035                 6.094157e-03 3 1  ON 34
ci_0036                 6.301934e-03 3 1  ON 35
ci_0037                -1.203132e-02 3 1  ON 36
ci_0038                -1.198322e-02 3 1  ON 37
ci_0039                -4.974618e-03 3 1  ON 38
ci_0040                -5.050097e-03 3 1  ON 39
ci_0041                 1.031716e-02 3 1  ON 40
ci_0042                 1.058462e-02 3 1  ON 41
ci_0043                -7.018535e-03 3 1  ON 42
ci_0044                -7.983538e-03 3 1  ON 43
ci_0045                 1.087287e-02 3 1  ON 44
ci_0046                 1.045055e-02 3 1  ON 45
ci_0047                -4.521058e-03 3 1  ON 46
ci_0048                -4.597866e-03 3 1  ON 47
ci_0049                -3.592253e-03 3 1  ON 48
ci_0050                -3.764991e-03 3 1  ON 49
ci_0051                -2.716007e-03 3 1  ON 50
ci_0052                -2.753063e-03 3 1  ON 51
ci_0053                -4.131441e-03 3 1  ON 52
ci_0054                -4.392444e-03 3 1  ON 53
ci_0055                 3.279887e-03 3 1  ON 54
ci_0056                 2.683593e-03 3 1  ON 55
ci_0057                 3.230067e-03 3 1  ON 56
ci_0058                 3.707636e-03 3 1  ON 57
ci_0059                -4.572525e-03 3 1  ON 58
ci_0060                -4.217444e-03 3 1  ON 59
ci_0061                -4.220153e-03 3 1  ON 60
ci_0062                -4.213571e-03 3 1  ON 61
ci_0063                -9.886775e-03 3 1  ON 62
ci_0064                -9.708156e-03 3 1  ON 63
ci_0065                -7.408574e-03 3 1  ON 64
ci_0066                -7.438125e-03 3 1  ON 65
ci_0067                -4.579604e-03 3 1  ON 66
ci_0068                -4.828119e-03 3 1  ON 67
ci_0069                 4.425313e-03 3 1  ON 68
ci_0070                 3.915476e-03 3 1  ON 69
ci_0071                 4.623732e-03 3 1  ON 70
ci_0072                 4.984475e-03 3 1  ON 71
ci_0073                 4.102457e-03 3 1  ON 72
ci_0074                 4.298027e-03 3 1  ON 73
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 52
    time step          = 0.05
    reference energy   = -16.8033
    reference variance = 0.216449
====================================================
  Execution time = 1.6481e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s052
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6904e+01
  VMC Evar = 3.2208e-01
  Total weights = 1.9518e+06
  Execution time = 1.9526e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.309664388015
                                         uncertainty =       0.003350698737

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.309664388015
                                         uncertainty =       0.003350698737

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000393500848
  error estimate for blocks of size 2^( 2) =       0.000407925685
  error estimate for blocks of size 2^( 3) =       0.000422533841
  error estimate for blocks of size 2^( 4) =       0.000435946125
  error estimate for blocks of size 2^( 5) =       0.000447446404
  error estimate for blocks of size 2^( 6) =       0.000456327381
  error estimate for blocks of size 2^( 7) =       0.000461309513

      target function =      -0.877207688698
              le_mean =     -16.904369858160
             les_mean =     286.079869064614
             stat err =       0.000450257356
             autocorr =       1.309273230768
   target nu stat err =       0.000450257356
   target dn stat err =       0.003844110412
      target stat err =       0.004796895523
              std dev =       0.556494235655
             le_variance =       0.309685834317

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.309388048531
                                         uncertainty =       0.003336793908

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.309388048531
                                         uncertainty =       0.003336793908

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000393325480
  error estimate for blocks of size 2^( 2) =       0.000407786214
  error estimate for blocks of size 2^( 3) =       0.000422425000
  error estimate for blocks of size 2^( 4) =       0.000435870246
  error estimate for blocks of size 2^( 5) =       0.000447386543
  error estimate for blocks of size 2^( 6) =       0.000456283044
  error estimate for blocks of size 2^( 7) =       0.000461280028

      target function =      -0.797559822699
              le_mean =     -16.904375495918
             les_mean =     286.145619975064
             stat err =       0.000450204965
             autocorr =       1.310136052171
   target nu stat err =       0.000450204965
   target dn stat err =       0.064033238637
      target stat err =       0.065919822650
              std dev =       0.556246228820
             le_variance =       0.309409867076

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.309504747025
                                         uncertainty =       0.003342698996

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.309504747025
                                         uncertainty =       0.003342698996

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000393399541
  error estimate for blocks of size 2^( 2) =       0.000407843507
  error estimate for blocks of size 2^( 3) =       0.000422467089
  error estimate for blocks of size 2^( 4) =       0.000435896257
  error estimate for blocks of size 2^( 5) =       0.000447403225
  error estimate for blocks of size 2^( 6) =       0.000456295194
  error estimate for blocks of size 2^( 7) =       0.000461286756

      target function =      -0.778522390806
              le_mean =     -16.904373243306
             les_mean =     286.161458191300
             stat err =       0.000450220358
             autocorr =       1.309732366603
   target nu stat err =       0.000450220358
   target dn stat err =       0.081762978975
      target stat err =       0.080507645807
              std dev =       0.556350966314
             le_variance =       0.309526397719

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.309642731559
                                         uncertainty =       0.003349631016

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.309642731559
                                         uncertainty =       0.003349631016

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000393487106
  error estimate for blocks of size 2^( 2) =       0.000407914342
  error estimate for blocks of size 2^( 3) =       0.000422524542
  error estimate for blocks of size 2^( 4) =       0.000435939013
  error estimate for blocks of size 2^( 5) =       0.000447440075
  error estimate for blocks of size 2^( 6) =       0.000456322280
  error estimate for blocks of size 2^( 7) =       0.000461305326

      target function =      -0.877255633231
              le_mean =     -16.904370038521
             les_mean =     286.079836427396
             stat err =       0.000450251673
             autocorr =       1.309331633533
   target nu stat err =       0.000450251673
   target dn stat err =       0.003843312763
      target stat err =       0.004796437566
              std dev =       0.556474801441
             le_variance =       0.309664204638


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.877207688698        initial
     6.1035e-01     6.1035e+00             5.6688e-04        -0.797559822699
     2.4414e+00     2.4414e+01             1.4946e-04        -0.778522390806
     9.7656e+00     9.7656e+01             3.7902e-05        -0.877255633231  <--

*****************************************************************************
Applying the update for shift_i =   9.7656e+00     and shift_s =   9.7656e+01
*****************************************************************************

  Execution time = 2.6349e+01
  </log>
  <optVariables href="H2O.s052.opt.xml">
ci_0001                 7.002751e-01 3 1  ON 0
ci_0002                 6.993167e-01 3 1  ON 1
ci_0003                -3.353390e-02 3 1  ON 2
ci_0004                -3.369069e-02 3 1  ON 3
ci_0005                -3.095851e-02 3 1  ON 4
ci_0006                -3.191873e-02 3 1  ON 5
ci_0007                -1.974301e-02 3 1  ON 6
ci_0008                -2.029065e-02 3 1  ON 7
ci_0009                -2.064578e-02 3 1  ON 8
ci_0010                -2.091109e-02 3 1  ON 9
ci_0011                -1.714217e-02 3 1  ON 10
ci_0012                -1.704661e-02 3 1  ON 11
ci_0013                 1.713040e-02 3 1  ON 12
ci_0014                 1.710398e-02 3 1  ON 13
ci_0015                 1.742697e-02 3 1  ON 14
ci_0016                 1.744304e-02 3 1  ON 15
ci_0017                 1.512034e-02 3 1  ON 16
ci_0018                 1.546476e-02 3 1  ON 17
ci_0019                 1.348627e-02 3 1  ON 18
ci_0020                 1.311355e-02 3 1  ON 19
ci_0021                 1.668554e-02 3 1  ON 20
ci_0022                 1.722975e-02 3 1  ON 21
ci_0023                -1.240600e-02 3 1  ON 22
ci_0024                -1.205169e-02 3 1  ON 23
ci_0025                -4.374136e-03 3 1  ON 24
ci_0026                -4.027343e-03 3 1  ON 25
ci_0027                -1.231464e-02 3 1  ON 26
ci_0028                -1.228255e-02 3 1  ON 27
ci_0029                -1.080906e-02 3 1  ON 28
ci_0030                -1.080072e-02 3 1  ON 29
ci_0031                 1.436982e-02 3 1  ON 30
ci_0032                 1.436479e-02 3 1  ON 31
ci_0033                 9.720216e-03 3 1  ON 32
ci_0034                 9.831344e-03 3 1  ON 33
ci_0035                 6.131558e-03 3 1  ON 34
ci_0036                 6.316090e-03 3 1  ON 35
ci_0037                -1.201795e-02 3 1  ON 36
ci_0038                -1.198988e-02 3 1  ON 37
ci_0039                -5.020750e-03 3 1  ON 38
ci_0040                -5.085198e-03 3 1  ON 39
ci_0041                 1.032312e-02 3 1  ON 40
ci_0042                 1.060834e-02 3 1  ON 41
ci_0043                -7.072563e-03 3 1  ON 42
ci_0044                -8.017454e-03 3 1  ON 43
ci_0045                 1.086794e-02 3 1  ON 44
ci_0046                 1.045148e-02 3 1  ON 45
ci_0047                -4.553220e-03 3 1  ON 46
ci_0048                -4.633448e-03 3 1  ON 47
ci_0049                -3.596330e-03 3 1  ON 48
ci_0050                -3.805276e-03 3 1  ON 49
ci_0051                -2.763646e-03 3 1  ON 50
ci_0052                -2.764745e-03 3 1  ON 51
ci_0053                -4.168822e-03 3 1  ON 52
ci_0054                -4.420847e-03 3 1  ON 53
ci_0055                 3.315158e-03 3 1  ON 54
ci_0056                 2.676864e-03 3 1  ON 55
ci_0057                 3.215950e-03 3 1  ON 56
ci_0058                 3.746301e-03 3 1  ON 57
ci_0059                -4.569473e-03 3 1  ON 58
ci_0060                -4.229254e-03 3 1  ON 59
ci_0061                -4.217540e-03 3 1  ON 60
ci_0062                -4.224622e-03 3 1  ON 61
ci_0063                -9.907537e-03 3 1  ON 62
ci_0064                -9.716694e-03 3 1  ON 63
ci_0065                -7.428471e-03 3 1  ON 64
ci_0066                -7.464205e-03 3 1  ON 65
ci_0067                -4.595373e-03 3 1  ON 66
ci_0068                -4.833814e-03 3 1  ON 67
ci_0069                 4.443860e-03 3 1  ON 68
ci_0070                 3.938208e-03 3 1  ON 69
ci_0071                 4.633881e-03 3 1  ON 70
ci_0072                 5.014042e-03 3 1  ON 71
ci_0073                 4.134756e-03 3 1  ON 72
ci_0074                 4.331608e-03 3 1  ON 73
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 4.4018e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s053 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s053 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=53  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6896e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 53
    time step          = 0.05
    reference energy   = -16.9932
    reference variance = 0.342205
====================================================
  Execution time = 1.4806e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s053
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5272e+04
  VMC Eavg = -1.6903e+01
  VMC Evar = 3.1484e-01
  Total weights = 1.951813316e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 2.7037e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.302689368147
                                         uncertainty =       0.001477512847

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.302689368147
                                         uncertainty =       0.001477512847

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000389106829
  error estimate for blocks of size 2^( 2) =       0.000403464428
  error estimate for blocks of size 2^( 3) =       0.000417690537
  error estimate for blocks of size 2^( 4) =       0.000430672527
  error estimate for blocks of size 2^( 5) =       0.000441205391
  error estimate for blocks of size 2^( 6) =       0.000448414611
  error estimate for blocks of size 2^( 7) =       0.000455045590

      target function =      -0.886183836213
              le_mean =     -16.903261674202
             les_mean =     286.035099607147
             stat err =       0.000443834530
             autocorr =       1.301081394616
   target nu stat err =       0.000443834530
   target dn stat err =       0.002885610359
      target stat err =       0.003690404670
              std dev =       0.550280155437
             le_variance =       0.302808249468


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690326167420e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 74
Check correct_vf_var_size: 225, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.4414e+00, overlap shift 2.4414e+01 and omega -1.7527e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.886198238360       residual = 4.56e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.886264917685       residual = 5.44e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.886274015049       residual = 1.64e-03           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.886277616700       residual = 7.22e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.886279753441       residual = 2.63e-04           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.886280422789       residual = 1.35e-04           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.886280948252       residual = 3.16e-05           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.886281058125       residual = 2.23e-05           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.886281081604       residual = 1.63e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.886281126738       residual = 1.17e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.886281160360       residual = 1.11e-05           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.886281145895       residual = 5.79e-06           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.886281132758       residual = 4.38e-06           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.886281150730       residual = 1.10e-06           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.886281147110       residual = 2.55e-07           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.886281149226       residual = 6.75e-08           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.886281152589       residual = 1.57e-08           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.886281149166       residual = 7.76e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         17 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 2.4414e+00 is 1.357075e-04

solving harmonic davidson linear method for identity shift 9.7656e+00, overlap shift 9.7656e+01 and omega -1.7527e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.886198238360       residual = 4.56e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.886215292644       residual = 5.41e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.886217607313       residual = 1.62e-03           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.886218518697       residual = 7.11e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.886219057479       residual = 2.58e-04           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.886219223421       residual = 1.30e-04           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.886219354390       residual = 3.06e-05           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.886219381531       residual = 2.16e-05           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.886219387111       residual = 1.60e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.886219398182       residual = 1.14e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.886219406351       residual = 1.06e-05           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.886219402482       residual = 5.51e-06           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.886219399186       residual = 4.03e-06           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.886219403539       residual = 9.78e-07           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.886219402644       residual = 2.24e-07           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.886219403139       residual = 5.90e-08           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.886219403935       residual = 1.39e-08           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.886219403095       residual = 6.66e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         17 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 9.7656e+00 is 3.429265e-05

solving harmonic davidson linear method for identity shift 3.9062e+01, overlap shift 3.9062e+02 and omega -1.7527e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.886198238360       residual = 4.56e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.886202526654       residual = 5.41e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.886203107894       residual = 1.62e-03           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.886203336432       residual = 7.08e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.886203471414       residual = 2.57e-04           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.886203512806       residual = 1.29e-04           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.886203545521       residual = 3.03e-05           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.886203552285       residual = 2.14e-05           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.886203553662       residual = 1.59e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.886203556416       residual = 1.13e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.886203558442       residual = 1.05e-05           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.886203557459       residual = 5.43e-06           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.886203556635       residual = 3.94e-06           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.886203557715       residual = 9.49e-07           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.886203557491       residual = 2.17e-07           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.886203557613       residual = 5.70e-08           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.886203557809       residual = 1.35e-08           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.886203557601       residual = 6.40e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         17 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 3.9062e+01 is 8.596332e-06

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.764578 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 75 and numParams is: 74

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.7528e+01
  </log>
  <optVariables href="H2O.s053.opt.xml">
ci_0001                 7.002537e-01 3 1  ON 0
ci_0002                 6.993502e-01 3 1  ON 1
ci_0003                -3.352438e-02 3 1  ON 2
ci_0004                -3.366949e-02 3 1  ON 3
ci_0005                -3.093725e-02 3 1  ON 4
ci_0006                -3.189065e-02 3 1  ON 5
ci_0007                -1.971031e-02 3 1  ON 6
ci_0008                -2.025636e-02 3 1  ON 7
ci_0009                -2.063074e-02 3 1  ON 8
ci_0010                -2.089844e-02 3 1  ON 9
ci_0011                -1.712891e-02 3 1  ON 10
ci_0012                -1.703765e-02 3 1  ON 11
ci_0013                 1.711737e-02 3 1  ON 12
ci_0014                 1.708941e-02 3 1  ON 13
ci_0015                 1.741363e-02 3 1  ON 14
ci_0016                 1.743833e-02 3 1  ON 15
ci_0017                 1.510717e-02 3 1  ON 16
ci_0018                 1.545116e-02 3 1  ON 17
ci_0019                 1.347673e-02 3 1  ON 18
ci_0020                 1.310971e-02 3 1  ON 19
ci_0021                 1.669535e-02 3 1  ON 20
ci_0022                 1.722734e-02 3 1  ON 21
ci_0023                -1.239922e-02 3 1  ON 22
ci_0024                -1.204416e-02 3 1  ON 23
ci_0025                -4.357330e-03 3 1  ON 24
ci_0026                -3.996667e-03 3 1  ON 25
ci_0027                -1.231416e-02 3 1  ON 26
ci_0028                -1.227787e-02 3 1  ON 27
ci_0029                -1.079823e-02 3 1  ON 28
ci_0030                -1.079002e-02 3 1  ON 29
ci_0031                 1.437419e-02 3 1  ON 30
ci_0032                 1.435622e-02 3 1  ON 31
ci_0033                 9.711400e-03 3 1  ON 32
ci_0034                 9.827234e-03 3 1  ON 33
ci_0035                 6.130717e-03 3 1  ON 34
ci_0036                 6.307172e-03 3 1  ON 35
ci_0037                -1.201274e-02 3 1  ON 36
ci_0038                -1.198958e-02 3 1  ON 37
ci_0039                -5.009806e-03 3 1  ON 38
ci_0040                -5.072936e-03 3 1  ON 39
ci_0041                 1.032043e-02 3 1  ON 40
ci_0042                 1.060250e-02 3 1  ON 41
ci_0043                -7.057320e-03 3 1  ON 42
ci_0044                -8.018097e-03 3 1  ON 43
ci_0045                 1.086276e-02 3 1  ON 44
ci_0046                 1.044971e-02 3 1  ON 45
ci_0047                -4.541629e-03 3 1  ON 46
ci_0048                -4.624727e-03 3 1  ON 47
ci_0049                -3.591333e-03 3 1  ON 48
ci_0050                -3.804620e-03 3 1  ON 49
ci_0051                -2.759190e-03 3 1  ON 50
ci_0052                -2.753507e-03 3 1  ON 51
ci_0053                -4.169788e-03 3 1  ON 52
ci_0054                -4.415024e-03 3 1  ON 53
ci_0055                 3.307168e-03 3 1  ON 54
ci_0056                 2.657918e-03 3 1  ON 55
ci_0057                 3.208840e-03 3 1  ON 56
ci_0058                 3.744053e-03 3 1  ON 57
ci_0059                -4.561249e-03 3 1  ON 58
ci_0060                -4.222173e-03 3 1  ON 59
ci_0061                -4.202446e-03 3 1  ON 60
ci_0062                -4.214460e-03 3 1  ON 61
ci_0063                -9.902979e-03 3 1  ON 62
ci_0064                -9.716192e-03 3 1  ON 63
ci_0065                -7.422062e-03 3 1  ON 64
ci_0066                -7.456995e-03 3 1  ON 65
ci_0067                -4.602964e-03 3 1  ON 66
ci_0068                -4.820614e-03 3 1  ON 67
ci_0069                 4.416977e-03 3 1  ON 68
ci_0070                 3.926323e-03 3 1  ON 69
ci_0071                 4.621438e-03 3 1  ON 70
ci_0072                 5.012826e-03 3 1  ON 71
ci_0073                 4.131228e-03 3 1  ON 72
ci_0074                 4.319148e-03 3 1  ON 73
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 53
    time step          = 0.05
    reference energy   = -16.9963
    reference variance = 0.324046
====================================================
  Execution time = 1.4897e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s053
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6904e+01
  VMC Evar = 3.1803e-01
  Total weights = 1.9516e+06
  Execution time = 1.9606e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.307754616983
                                         uncertainty =       0.002376677712

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.307754616983
                                         uncertainty =       0.002376677712

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000392248080
  error estimate for blocks of size 2^( 2) =       0.000406362600
  error estimate for blocks of size 2^( 3) =       0.000420638076
  error estimate for blocks of size 2^( 4) =       0.000433345268
  error estimate for blocks of size 2^( 5) =       0.000443877722
  error estimate for blocks of size 2^( 6) =       0.000452802559
  error estimate for blocks of size 2^( 7) =       0.000457991731

      target function =      -0.882226479568
              le_mean =     -16.903551126448
             les_mean =     286.048072921566
             stat err =       0.000447004320
             autocorr =       1.298678906755
   target nu stat err =       0.000447004320
   target dn stat err =       0.002842445138
      target stat err =       0.003607363371
              std dev =       0.554722555178
             le_variance =       0.307717113223

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.307648455619
                                         uncertainty =       0.002370428055

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.307648455619
                                         uncertainty =       0.002370428055

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000392180542
  error estimate for blocks of size 2^( 2) =       0.000406304589
  error estimate for blocks of size 2^( 3) =       0.000420588734
  error estimate for blocks of size 2^( 4) =       0.000433302906
  error estimate for blocks of size 2^( 5) =       0.000443840738
  error estimate for blocks of size 2^( 6) =       0.000452768141
  error estimate for blocks of size 2^( 7) =       0.000457959763

      target function =      -0.879232358648
              le_mean =     -16.903551430480
             les_mean =     286.050479316079
             stat err =       0.000446967887
             autocorr =       1.298914479142
   target nu stat err =       0.000446967887
   target dn stat err =       0.003760621284
      target stat err =       0.004709229160
              std dev =       0.554627042026
             le_variance =       0.307611155746

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.307699738099
                                         uncertainty =       0.002373458467

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.307699738099
                                         uncertainty =       0.002373458467

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000392213168
  error estimate for blocks of size 2^( 2) =       0.000406332567
  error estimate for blocks of size 2^( 3) =       0.000420612461
  error estimate for blocks of size 2^( 4) =       0.000433323246
  error estimate for blocks of size 2^( 5) =       0.000443858553
  error estimate for blocks of size 2^( 6) =       0.000452784651
  error estimate for blocks of size 2^( 7) =       0.000457975080

      target function =      -0.882335441989
              le_mean =     -16.903551200316
             les_mean =     286.047988257190
             stat err =       0.000446985382
             autocorr =       1.298800059869
   target nu stat err =       0.000446985382
   target dn stat err =       0.002838372392
      target stat err =       0.003603225630
              std dev =       0.554673181894
             le_variance =       0.307662338713

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.307747643401
                                         uncertainty =       0.002376271145

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.307747643401
                                         uncertainty =       0.002376271145

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000392243644
  error estimate for blocks of size 2^( 2) =       0.000406358777
  error estimate for blocks of size 2^( 3) =       0.000420634807
  error estimate for blocks of size 2^( 4) =       0.000433342455
  error estimate for blocks of size 2^( 5) =       0.000443875265
  error estimate for blocks of size 2^( 6) =       0.000452800267
  error estimate for blocks of size 2^( 7) =       0.000457989598

      target function =      -0.882245095425
              le_mean =     -16.903551125415
             les_mean =     286.048057991113
             stat err =       0.000447001896
             autocorr =       1.298694197433
   target nu stat err =       0.000447001896
   target dn stat err =       0.002841898811
      target stat err =       0.003606840616
              std dev =       0.554716281360
             le_variance =       0.307710152806


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.882226479568        initial
     2.4414e+00     2.4414e+01             1.3571e-04        -0.879232358648
     9.7656e+00     9.7656e+01             3.4293e-05        -0.882335441989  <--
     3.9062e+01     3.9062e+02             8.5963e-06        -0.882245095425

*****************************************************************************
Applying the update for shift_i =   9.7656e+00     and shift_s =   9.7656e+01
*****************************************************************************

  Execution time = 2.4819e+01
  </log>
  <optVariables href="H2O.s053.opt.xml">
ci_0001                 7.002537e-01 3 1  ON 0
ci_0002                 6.993502e-01 3 1  ON 1
ci_0003                -3.352438e-02 3 1  ON 2
ci_0004                -3.366949e-02 3 1  ON 3
ci_0005                -3.093725e-02 3 1  ON 4
ci_0006                -3.189065e-02 3 1  ON 5
ci_0007                -1.971031e-02 3 1  ON 6
ci_0008                -2.025636e-02 3 1  ON 7
ci_0009                -2.063074e-02 3 1  ON 8
ci_0010                -2.089844e-02 3 1  ON 9
ci_0011                -1.712891e-02 3 1  ON 10
ci_0012                -1.703765e-02 3 1  ON 11
ci_0013                 1.711737e-02 3 1  ON 12
ci_0014                 1.708941e-02 3 1  ON 13
ci_0015                 1.741363e-02 3 1  ON 14
ci_0016                 1.743833e-02 3 1  ON 15
ci_0017                 1.510717e-02 3 1  ON 16
ci_0018                 1.545116e-02 3 1  ON 17
ci_0019                 1.347673e-02 3 1  ON 18
ci_0020                 1.310971e-02 3 1  ON 19
ci_0021                 1.669535e-02 3 1  ON 20
ci_0022                 1.722734e-02 3 1  ON 21
ci_0023                -1.239922e-02 3 1  ON 22
ci_0024                -1.204416e-02 3 1  ON 23
ci_0025                -4.357330e-03 3 1  ON 24
ci_0026                -3.996667e-03 3 1  ON 25
ci_0027                -1.231416e-02 3 1  ON 26
ci_0028                -1.227787e-02 3 1  ON 27
ci_0029                -1.079823e-02 3 1  ON 28
ci_0030                -1.079002e-02 3 1  ON 29
ci_0031                 1.437419e-02 3 1  ON 30
ci_0032                 1.435622e-02 3 1  ON 31
ci_0033                 9.711400e-03 3 1  ON 32
ci_0034                 9.827234e-03 3 1  ON 33
ci_0035                 6.130717e-03 3 1  ON 34
ci_0036                 6.307172e-03 3 1  ON 35
ci_0037                -1.201274e-02 3 1  ON 36
ci_0038                -1.198958e-02 3 1  ON 37
ci_0039                -5.009806e-03 3 1  ON 38
ci_0040                -5.072936e-03 3 1  ON 39
ci_0041                 1.032043e-02 3 1  ON 40
ci_0042                 1.060250e-02 3 1  ON 41
ci_0043                -7.057320e-03 3 1  ON 42
ci_0044                -8.018097e-03 3 1  ON 43
ci_0045                 1.086276e-02 3 1  ON 44
ci_0046                 1.044971e-02 3 1  ON 45
ci_0047                -4.541629e-03 3 1  ON 46
ci_0048                -4.624727e-03 3 1  ON 47
ci_0049                -3.591333e-03 3 1  ON 48
ci_0050                -3.804620e-03 3 1  ON 49
ci_0051                -2.759190e-03 3 1  ON 50
ci_0052                -2.753507e-03 3 1  ON 51
ci_0053                -4.169788e-03 3 1  ON 52
ci_0054                -4.415024e-03 3 1  ON 53
ci_0055                 3.307168e-03 3 1  ON 54
ci_0056                 2.657918e-03 3 1  ON 55
ci_0057                 3.208840e-03 3 1  ON 56
ci_0058                 3.744053e-03 3 1  ON 57
ci_0059                -4.561249e-03 3 1  ON 58
ci_0060                -4.222173e-03 3 1  ON 59
ci_0061                -4.202446e-03 3 1  ON 60
ci_0062                -4.214460e-03 3 1  ON 61
ci_0063                -9.902979e-03 3 1  ON 62
ci_0064                -9.716192e-03 3 1  ON 63
ci_0065                -7.422062e-03 3 1  ON 64
ci_0066                -7.456995e-03 3 1  ON 65
ci_0067                -4.602964e-03 3 1  ON 66
ci_0068                -4.820614e-03 3 1  ON 67
ci_0069                 4.416977e-03 3 1  ON 68
ci_0070                 3.926323e-03 3 1  ON 69
ci_0071                 4.621438e-03 3 1  ON 70
ci_0072                 5.012826e-03 3 1  ON 71
ci_0073                 4.131228e-03 3 1  ON 72
ci_0074                 4.319148e-03 3 1  ON 73
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 4.2352e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s054 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s054 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=54  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6898e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 54
    time step          = 0.05
    reference energy   = -16.8527
    reference variance = 0.159336
====================================================
  Execution time = 1.4808e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s054
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5255e+04
  VMC Eavg = -1.6903e+01
  VMC Evar = 3.1714e-01
  Total weights = 1.951540838e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 2.6862e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.304052787968
                                         uncertainty =       0.002118081602

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.304052787968
                                         uncertainty =       0.002118081602

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000390008347
  error estimate for blocks of size 2^( 2) =       0.000403947050
  error estimate for blocks of size 2^( 3) =       0.000418372791
  error estimate for blocks of size 2^( 4) =       0.000431068840
  error estimate for blocks of size 2^( 5) =       0.000441112054
  error estimate for blocks of size 2^( 6) =       0.000447186149
  error estimate for blocks of size 2^( 7) =       0.000450834043

      target function =      -0.883212543652
              le_mean =     -16.902670275916
             les_mean =     286.017402294774
             stat err =       0.000442550272
             autocorr =       1.287589476796
   target nu stat err =       0.000442550272
   target dn stat err =       0.003196737764
      target stat err =       0.004046145411
              std dev =       0.551555094130
             le_variance =       0.304213021861


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690267027592e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 74
Check correct_vf_var_size: 225, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.4414e+00, overlap shift 2.4414e+01 and omega -1.7527e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.883230133535       residual = 2.30e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.883274943538       residual = 4.72e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.883283900097       residual = 1.63e-03           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.883287138493       residual = 5.49e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.883289066177       residual = 2.48e-04           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.883289827164       residual = 6.98e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.883289969993       residual = 2.65e-05           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.883289915593       residual = 1.56e-05           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.883289901331       residual = 9.47e-06           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.883289918754       residual = 6.39e-06           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.883289922041       residual = 5.51e-06           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.883289909155       residual = 3.53e-06           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.883289919193       residual = 2.23e-06           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.883289955576       residual = 6.88e-07           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.883289969607       residual = 1.12e-07           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.883289973957       residual = 2.61e-08           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.883289973324       residual = 9.33e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         16 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 2.4414e+00 is 1.300938e-04

solving harmonic davidson linear method for identity shift 9.7656e+00, overlap shift 9.7656e+01 and omega -1.7527e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.883230133535       residual = 2.30e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.883241585235       residual = 4.70e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.883243862906       residual = 1.61e-03           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.883244679505       residual = 5.41e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.883245164304       residual = 2.42e-04           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.883245353079       residual = 6.74e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.883245388249       residual = 2.55e-05           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.883245374277       residual = 1.50e-05           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.883245370633       residual = 9.16e-06           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.883245374965       residual = 6.21e-06           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.883245375798       residual = 5.29e-06           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.883245372632       residual = 3.34e-06           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.883245375300       residual = 2.03e-06           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.883245384124       residual = 6.09e-07           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.883245387439       residual = 9.82e-08           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.883245388464       residual = 2.29e-08           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.883245388307       residual = 8.17e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         16 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 9.7656e+00 is 3.296728e-05

solving harmonic davidson linear method for identity shift 3.9062e+01, overlap shift 3.9062e+02 and omega -1.7527e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.883230133535       residual = 2.30e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.883233012470       residual = 4.69e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.883233584345       residual = 1.61e-03           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.883233788930       residual = 5.39e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.883233910306       residual = 2.41e-04           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.883233957402       residual = 6.68e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.883233966160       residual = 2.52e-05           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.883233962643       residual = 1.49e-05           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.883233961727       residual = 9.09e-06           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.883233962809       residual = 6.16e-06           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.883233963018       residual = 5.23e-06           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.883233962230       residual = 3.29e-06           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.883233962907       residual = 1.98e-06           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.883233965096       residual = 5.90e-07           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.883233965913       residual = 9.48e-08           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.883233966165       residual = 2.22e-08           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.883233966126       residual = 7.90e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         16 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 3.9062e+01 is 8.270052e-06

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.773584 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 75 and numParams is: 74

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.7509e+01
  </log>
  <optVariables href="H2O.s054.opt.xml">
ci_0001                 7.002815e-01 3 1  ON 0
ci_0002                 6.993364e-01 3 1  ON 1
ci_0003                -3.350912e-02 3 1  ON 2
ci_0004                -3.364300e-02 3 1  ON 3
ci_0005                -3.091472e-02 3 1  ON 4
ci_0006                -3.185768e-02 3 1  ON 5
ci_0007                -1.968964e-02 3 1  ON 6
ci_0008                -2.022853e-02 3 1  ON 7
ci_0009                -2.062354e-02 3 1  ON 8
ci_0010                -2.087743e-02 3 1  ON 9
ci_0011                -1.711835e-02 3 1  ON 10
ci_0012                -1.702474e-02 3 1  ON 11
ci_0013                 1.710388e-02 3 1  ON 12
ci_0014                 1.707732e-02 3 1  ON 13
ci_0015                 1.740098e-02 3 1  ON 14
ci_0016                 1.742768e-02 3 1  ON 15
ci_0017                 1.509729e-02 3 1  ON 16
ci_0018                 1.543677e-02 3 1  ON 17
ci_0019                 1.346767e-02 3 1  ON 18
ci_0020                 1.310080e-02 3 1  ON 19
ci_0021                 1.668515e-02 3 1  ON 20
ci_0022                 1.720826e-02 3 1  ON 21
ci_0023                -1.238876e-02 3 1  ON 22
ci_0024                -1.203560e-02 3 1  ON 23
ci_0025                -4.335566e-03 3 1  ON 24
ci_0026                -3.984397e-03 3 1  ON 25
ci_0027                -1.230877e-02 3 1  ON 26
ci_0028                -1.226960e-02 3 1  ON 27
ci_0029                -1.078687e-02 3 1  ON 28
ci_0030                -1.078629e-02 3 1  ON 29
ci_0031                 1.437143e-02 3 1  ON 30
ci_0032                 1.434735e-02 3 1  ON 31
ci_0033                 9.679009e-03 3 1  ON 32
ci_0034                 9.814611e-03 3 1  ON 33
ci_0035                 6.113781e-03 3 1  ON 34
ci_0036                 6.306926e-03 3 1  ON 35
ci_0037                -1.200587e-02 3 1  ON 36
ci_0038                -1.198748e-02 3 1  ON 37
ci_0039                -5.003111e-03 3 1  ON 38
ci_0040                -5.062214e-03 3 1  ON 39
ci_0041                 1.032154e-02 3 1  ON 40
ci_0042                 1.059620e-02 3 1  ON 41
ci_0043                -7.045416e-03 3 1  ON 42
ci_0044                -7.992792e-03 3 1  ON 43
ci_0045                 1.086031e-02 3 1  ON 44
ci_0046                 1.044288e-02 3 1  ON 45
ci_0047                -4.534696e-03 3 1  ON 46
ci_0048                -4.615245e-03 3 1  ON 47
ci_0049                -3.583372e-03 3 1  ON 48
ci_0050                -3.800154e-03 3 1  ON 49
ci_0051                -2.751255e-03 3 1  ON 50
ci_0052                -2.752335e-03 3 1  ON 51
ci_0053                -4.163659e-03 3 1  ON 52
ci_0054                -4.419633e-03 3 1  ON 53
ci_0055                 3.294799e-03 3 1  ON 54
ci_0056                 2.655075e-03 3 1  ON 55
ci_0057                 3.189874e-03 3 1  ON 56
ci_0058                 3.739231e-03 3 1  ON 57
ci_0059                -4.557906e-03 3 1  ON 58
ci_0060                -4.220095e-03 3 1  ON 59
ci_0061                -4.200481e-03 3 1  ON 60
ci_0062                -4.200008e-03 3 1  ON 61
ci_0063                -9.896771e-03 3 1  ON 62
ci_0064                -9.708379e-03 3 1  ON 63
ci_0065                -7.418116e-03 3 1  ON 64
ci_0066                -7.450944e-03 3 1  ON 65
ci_0067                -4.594266e-03 3 1  ON 66
ci_0068                -4.813809e-03 3 1  ON 67
ci_0069                 4.411366e-03 3 1  ON 68
ci_0070                 3.918460e-03 3 1  ON 69
ci_0071                 4.635799e-03 3 1  ON 70
ci_0072                 5.014353e-03 3 1  ON 71
ci_0073                 4.123226e-03 3 1  ON 72
ci_0074                 4.310015e-03 3 1  ON 73
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 54
    time step          = 0.05
    reference energy   = -16.8907
    reference variance = 0.447945
====================================================
  Execution time = 1.4621e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s054
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6903e+01
  VMC Evar = 3.1844e-01
  Total weights = 1.9517e+06
  Execution time = 1.9436e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.307866700001
                                         uncertainty =       0.001853441952

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.307866700001
                                         uncertainty =       0.001853441952

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000392401065
  error estimate for blocks of size 2^( 2) =       0.000406816682
  error estimate for blocks of size 2^( 3) =       0.000421733670
  error estimate for blocks of size 2^( 4) =       0.000434583951
  error estimate for blocks of size 2^( 5) =       0.000447027351
  error estimate for blocks of size 2^( 6) =       0.000454635362
  error estimate for blocks of size 2^( 7) =       0.000459314289

      target function =      -0.881618074457
              le_mean =     -16.903401098950
             les_mean =     286.043472855143
             stat err =       0.000448890238
             autocorr =       1.308639325471
   target nu stat err =       0.000448890238
   target dn stat err =       0.002657636437
      target stat err =       0.003375390138
              std dev =       0.554938908357
             le_variance =       0.307957192008

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.307796973943
                                         uncertainty =       0.001854205672

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.307796973943
                                         uncertainty =       0.001854205672

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000392356790
  error estimate for blocks of size 2^( 2) =       0.000406780288
  error estimate for blocks of size 2^( 3) =       0.000421707217
  error estimate for blocks of size 2^( 4) =       0.000434564424
  error estimate for blocks of size 2^( 5) =       0.000447011651
  error estimate for blocks of size 2^( 6) =       0.000454626456
  error estimate for blocks of size 2^( 7) =       0.000459301544

      target function =      -0.881895637783
              le_mean =     -16.903400449440
             les_mean =     286.043228641995
             stat err =       0.000448876019
             autocorr =       1.308851761770
   target nu stat err =       0.000448876019
   target dn stat err =       0.002621688305
      target stat err =       0.003333411909
              std dev =       0.554876293780
             le_variance =       0.307887701399

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.307830545072
                                         uncertainty =       0.001853803523

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.307830545072
                                         uncertainty =       0.001853803523

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000392378107
  error estimate for blocks of size 2^( 2) =       0.000406797736
  error estimate for blocks of size 2^( 3) =       0.000421719785
  error estimate for blocks of size 2^( 4) =       0.000434573598
  error estimate for blocks of size 2^( 5) =       0.000447018942
  error estimate for blocks of size 2^( 6) =       0.000454630421
  error estimate for blocks of size 2^( 7) =       0.000459307391

      target function =      -0.881773176837
              le_mean =     -16.903400686987
             les_mean =     286.043334710865
             stat err =       0.000448882588
             autocorr =       1.308747860027
   target nu stat err =       0.000448882588
   target dn stat err =       0.002637359745
      target stat err =       0.003351705321
              std dev =       0.554906440009
             le_variance =       0.307921157163

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.307862095478
                                         uncertainty =       0.001853485870

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.307862095478
                                         uncertainty =       0.001853485870

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000392398141
  error estimate for blocks of size 2^( 2) =       0.000406814261
  error estimate for blocks of size 2^( 3) =       0.000421731884
  error estimate for blocks of size 2^( 4) =       0.000434582609
  error estimate for blocks of size 2^( 5) =       0.000447026252
  error estimate for blocks of size 2^( 6) =       0.000454634700
  error estimate for blocks of size 2^( 7) =       0.000459313382

      target function =      -0.881639249957
              le_mean =     -16.903401037999
             les_mean =     286.043453832920
             stat err =       0.000448889236
             autocorr =       1.308652983082
   target nu stat err =       0.000448889236
   target dn stat err =       0.002654838332
      target stat err =       0.003372120645
              std dev =       0.554934773247
             le_variance =       0.307952602558


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.881618074457        initial
     2.4414e+00     2.4414e+01             1.3009e-04        -0.881895637783  <--
     9.7656e+00     9.7656e+01             3.2967e-05        -0.881773176837
     3.9062e+01     3.9062e+02             8.2701e-06        -0.881639249957

*****************************************************************************
Applying the update for shift_i =   2.4414e+00     and shift_s =   2.4414e+01
*****************************************************************************

  Execution time = 2.4444e+01
  </log>
  <optVariables href="H2O.s054.opt.xml">
ci_0001                 7.003643e-01 3 1  ON 0
ci_0002                 6.992947e-01 3 1  ON 1
ci_0003                -3.346449e-02 3 1  ON 2
ci_0004                -3.356529e-02 3 1  ON 3
ci_0005                -3.084842e-02 3 1  ON 4
ci_0006                -3.176055e-02 3 1  ON 5
ci_0007                -1.962859e-02 3 1  ON 6
ci_0008                -2.014634e-02 3 1  ON 7
ci_0009                -2.060259e-02 3 1  ON 8
ci_0010                -2.081595e-02 3 1  ON 9
ci_0011                -1.708750e-02 3 1  ON 10
ci_0012                -1.698693e-02 3 1  ON 11
ci_0013                 1.706444e-02 3 1  ON 12
ci_0014                 1.704194e-02 3 1  ON 13
ci_0015                 1.736398e-02 3 1  ON 14
ci_0016                 1.739647e-02 3 1  ON 15
ci_0017                 1.506848e-02 3 1  ON 16
ci_0018                 1.539466e-02 3 1  ON 17
ci_0019                 1.344123e-02 3 1  ON 18
ci_0020                 1.307478e-02 3 1  ON 19
ci_0021                 1.665493e-02 3 1  ON 20
ci_0022                 1.715169e-02 3 1  ON 21
ci_0023                -1.235822e-02 3 1  ON 22
ci_0024                -1.201060e-02 3 1  ON 23
ci_0025                -4.272204e-03 3 1  ON 24
ci_0026                -3.948639e-03 3 1  ON 25
ci_0027                -1.229307e-02 3 1  ON 26
ci_0028                -1.224542e-02 3 1  ON 27
ci_0029                -1.075369e-02 3 1  ON 28
ci_0030                -1.077547e-02 3 1  ON 29
ci_0031                 1.436329e-02 3 1  ON 30
ci_0032                 1.432113e-02 3 1  ON 31
ci_0033                 9.583682e-03 3 1  ON 32
ci_0034                 9.777447e-03 3 1  ON 33
ci_0035                 6.064467e-03 3 1  ON 34
ci_0036                 6.306180e-03 3 1  ON 35
ci_0037                -1.198573e-02 3 1  ON 36
ci_0038                -1.198132e-02 3 1  ON 37
ci_0039                -4.983599e-03 3 1  ON 38
ci_0040                -5.030951e-03 3 1  ON 39
ci_0041                 1.032483e-02 3 1  ON 40
ci_0042                 1.057771e-02 3 1  ON 41
ci_0043                -7.010330e-03 3 1  ON 42
ci_0044                -7.918071e-03 3 1  ON 43
ci_0045                 1.085314e-02 3 1  ON 44
ci_0046                 1.042278e-02 3 1  ON 45
ci_0047                -4.514486e-03 3 1  ON 46
ci_0048                -4.587583e-03 3 1  ON 47
ci_0049                -3.560234e-03 3 1  ON 48
ci_0050                -3.787177e-03 3 1  ON 49
ci_0051                -2.728201e-03 3 1  ON 50
ci_0052                -2.748919e-03 3 1  ON 51
ci_0053                -4.145844e-03 3 1  ON 52
ci_0054                -4.433045e-03 3 1  ON 53
ci_0055                 3.258778e-03 3 1  ON 54
ci_0056                 2.646769e-03 3 1  ON 55
ci_0057                 3.134627e-03 3 1  ON 56
ci_0058                 3.725160e-03 3 1  ON 57
ci_0059                -4.548174e-03 3 1  ON 58
ci_0060                -4.214037e-03 3 1  ON 59
ci_0061                -4.194755e-03 3 1  ON 60
ci_0062                -4.157711e-03 3 1  ON 61
ci_0063                -9.878656e-03 3 1  ON 62
ci_0064                -9.685541e-03 3 1  ON 63
ci_0065                -7.406598e-03 3 1  ON 64
ci_0066                -7.433203e-03 3 1  ON 65
ci_0067                -4.568963e-03 3 1  ON 66
ci_0068                -4.793980e-03 3 1  ON 67
ci_0069                 4.395039e-03 3 1  ON 68
ci_0070                 3.895564e-03 3 1  ON 69
ci_0071                 4.677588e-03 3 1  ON 70
ci_0072                 5.018769e-03 3 1  ON 71
ci_0073                 4.099952e-03 3 1  ON 72
ci_0074                 4.283425e-03 3 1  ON 73
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 4.1958e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s055 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s055 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=55  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6898e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 55
    time step          = 0.05
    reference energy   = -16.8652
    reference variance = 0.220602
====================================================
  Execution time = 1.5114e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s055
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5246e+04
  VMC Eavg = -1.6903e+01
  VMC Evar = 3.1457e-01
  Total weights = 1.951653383e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 2.6742e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.304372532165
                                         uncertainty =       0.002536962825

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.304372532165
                                         uncertainty =       0.002536962825

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000390179076
  error estimate for blocks of size 2^( 2) =       0.000404763119
  error estimate for blocks of size 2^( 3) =       0.000419003718
  error estimate for blocks of size 2^( 4) =       0.000432550727
  error estimate for blocks of size 2^( 5) =       0.000443386640
  error estimate for blocks of size 2^( 6) =       0.000452197931
  error estimate for blocks of size 2^( 7) =       0.000461792635

      target function =      -0.886522394091
              le_mean =     -16.903193281016
             les_mean =     286.032509712222
             stat err =       0.000447481983
             autocorr =       1.315294964304
   target nu stat err =       0.000447481983
   target dn stat err =       0.003031702288
      target stat err =       0.003875254779
              std dev =       0.551796540603
             le_variance =       0.304479422222


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690319328102e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 74
Check correct_vf_var_size: 225, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 6.1035e-01, overlap shift 6.1035e+00 and omega -1.7527e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.886538154977       residual = 3.27e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.886727978116       residual = 5.34e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.886764031924       residual = 1.41e-03           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.886775149292       residual = 4.56e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.886781113734       residual = 2.24e-04           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.886783840037       residual = 1.35e-04           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.886785067931       residual = 3.76e-05           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.886785378633       residual = 9.28e-06           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.886785636227       residual = 5.62e-06           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.886785672382       residual = 2.81e-06           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.886785680022       residual = 2.22e-06           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.886785737837       residual = 1.84e-06           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.886785755186       residual = 2.16e-06           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.886785858245       residual = 5.74e-07           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.886785899608       residual = 1.50e-07           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.886785877503       residual = 2.20e-08           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.886785870635       residual = 8.21e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         16 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 6.1035e-01 is 5.221168e-04

solving harmonic davidson linear method for identity shift 2.4414e+00, overlap shift 2.4414e+01 and omega -1.7527e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.886538154977       residual = 3.27e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.886589845097       residual = 5.25e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.886599491505       residual = 1.36e-03           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.886602387464       residual = 4.31e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.886603924262       residual = 2.07e-04           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.886604603057       residual = 1.18e-04           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.886604897665       residual = 3.26e-05           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.886604970308       residual = 8.02e-06           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.886605032432       residual = 4.84e-06           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.886605039245       residual = 2.50e-06           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.886605041131       residual = 1.96e-06           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.886605055650       residual = 1.61e-06           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.886605059653       residual = 1.59e-06           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.886605082487       residual = 3.75e-07           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.886605090326       residual = 9.03e-08           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.886605085521       residual = 1.34e-08           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.886605084013       residual = 5.20e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         16 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 2.4414e+00 is 1.361313e-04

solving harmonic davidson linear method for identity shift 9.7656e+00, overlap shift 9.7656e+01 and omega -1.7527e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.886538154977       residual = 3.27e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.886551372275       residual = 5.23e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.886553826786       residual = 1.35e-03           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.886554558180       residual = 4.24e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.886554945164       residual = 2.03e-04           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.886555114454       residual = 1.14e-04           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.886555187198       residual = 3.13e-05           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.886555205011       residual = 7.71e-06           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.886555220378       residual = 4.65e-06           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.886555221930       residual = 2.42e-06           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.886555222406       residual = 1.90e-06           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.886555226036       residual = 1.54e-06           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.886555227010       residual = 1.45e-06           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.886555232524       residual = 3.34e-07           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.886555234336       residual = 7.86e-08           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.886555233182       residual = 1.17e-08           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.886555232818       residual = 4.59e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         16 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 9.7656e+00 is 3.440208e-05

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.783631 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 75 and numParams is: 74

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.7804e+01
  </log>
  <optVariables href="H2O.s055.opt.xml">
ci_0001                 7.004418e-01 3 1  ON 0
ci_0002                 6.992657e-01 3 1  ON 1
ci_0003                -3.339374e-02 3 1  ON 2
ci_0004                -3.350028e-02 3 1  ON 3
ci_0005                -3.074306e-02 3 1  ON 4
ci_0006                -3.165809e-02 3 1  ON 5
ci_0007                -1.949246e-02 3 1  ON 6
ci_0008                -2.002979e-02 3 1  ON 7
ci_0009                -2.056246e-02 3 1  ON 8
ci_0010                -2.076659e-02 3 1  ON 9
ci_0011                -1.704905e-02 3 1  ON 10
ci_0012                -1.693786e-02 3 1  ON 11
ci_0013                 1.701132e-02 3 1  ON 12
ci_0014                 1.701812e-02 3 1  ON 13
ci_0015                 1.735433e-02 3 1  ON 14
ci_0016                 1.735286e-02 3 1  ON 15
ci_0017                 1.502138e-02 3 1  ON 16
ci_0018                 1.535785e-02 3 1  ON 17
ci_0019                 1.339477e-02 3 1  ON 18
ci_0020                 1.306732e-02 3 1  ON 19
ci_0021                 1.663193e-02 3 1  ON 20
ci_0022                 1.713888e-02 3 1  ON 21
ci_0023                -1.234525e-02 3 1  ON 22
ci_0024                -1.196590e-02 3 1  ON 23
ci_0025                -4.221419e-03 3 1  ON 24
ci_0026                -3.885645e-03 3 1  ON 25
ci_0027                -1.226793e-02 3 1  ON 26
ci_0028                -1.217654e-02 3 1  ON 27
ci_0029                -1.071232e-02 3 1  ON 28
ci_0030                -1.074759e-02 3 1  ON 29
ci_0031                 1.435455e-02 3 1  ON 30
ci_0032                 1.429550e-02 3 1  ON 31
ci_0033                 9.586109e-03 3 1  ON 32
ci_0034                 9.731870e-03 3 1  ON 33
ci_0035                 6.014522e-03 3 1  ON 34
ci_0036                 6.199428e-03 3 1  ON 35
ci_0037                -1.196946e-02 3 1  ON 36
ci_0038                -1.197826e-02 3 1  ON 37
ci_0039                -4.936536e-03 3 1  ON 38
ci_0040                -4.972293e-03 3 1  ON 39
ci_0041                 1.030290e-02 3 1  ON 40
ci_0042                 1.052448e-02 3 1  ON 41
ci_0043                -6.971537e-03 3 1  ON 42
ci_0044                -7.915389e-03 3 1  ON 43
ci_0045                 1.085128e-02 3 1  ON 44
ci_0046                 1.041677e-02 3 1  ON 45
ci_0047                -4.475174e-03 3 1  ON 46
ci_0048                -4.553349e-03 3 1  ON 47
ci_0049                -3.509561e-03 3 1  ON 48
ci_0050                -3.763872e-03 3 1  ON 49
ci_0051                -2.681375e-03 3 1  ON 50
ci_0052                -2.705460e-03 3 1  ON 51
ci_0053                -4.134830e-03 3 1  ON 52
ci_0054                -4.443772e-03 3 1  ON 53
ci_0055                 3.254612e-03 3 1  ON 54
ci_0056                 2.691766e-03 3 1  ON 55
ci_0057                 3.119723e-03 3 1  ON 56
ci_0058                 3.704320e-03 3 1  ON 57
ci_0059                -4.543134e-03 3 1  ON 58
ci_0060                -4.147899e-03 3 1  ON 59
ci_0061                -4.147229e-03 3 1  ON 60
ci_0062                -4.120418e-03 3 1  ON 61
ci_0063                -9.878131e-03 3 1  ON 62
ci_0064                -9.676205e-03 3 1  ON 63
ci_0065                -7.380631e-03 3 1  ON 64
ci_0066                -7.406889e-03 3 1  ON 65
ci_0067                -4.536641e-03 3 1  ON 66
ci_0068                -4.769686e-03 3 1  ON 67
ci_0069                 4.364657e-03 3 1  ON 68
ci_0070                 3.870434e-03 3 1  ON 69
ci_0071                 4.684267e-03 3 1  ON 70
ci_0072                 5.014311e-03 3 1  ON 71
ci_0073                 4.095605e-03 3 1  ON 72
ci_0074                 4.205583e-03 3 1  ON 73
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 55
    time step          = 0.05
    reference energy   = -16.8677
    reference variance = 0.264262
====================================================
  Execution time = 1.4770e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s055
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6903e+01
  VMC Evar = 3.2556e-01
  Total weights = 1.9513e+06
  Execution time = 1.9535e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.310171092068
                                         uncertainty =       0.004719378202

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.310171092068
                                         uncertainty =       0.004719378202

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000393786324
  error estimate for blocks of size 2^( 2) =       0.000408103490
  error estimate for blocks of size 2^( 3) =       0.000423043054
  error estimate for blocks of size 2^( 4) =       0.000436888895
  error estimate for blocks of size 2^( 5) =       0.000449446798
  error estimate for blocks of size 2^( 6) =       0.000460779376
  error estimate for blocks of size 2^( 7) =       0.000464225480

      target function =      -0.866175269865
              le_mean =     -16.903091336757
             les_mean =     286.045460615726
             stat err =       0.000452835137
             autocorr =       1.322388237139
   target nu stat err =       0.000452835137
   target dn stat err =       0.009432342988
      target stat err =       0.011370749454
              std dev =       0.556897960219
             le_variance =       0.310135338096

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.310079936724
                                         uncertainty =       0.004768281076

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.310079936724
                                         uncertainty =       0.004768281076

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000393728198
  error estimate for blocks of size 2^( 2) =       0.000408071978
  error estimate for blocks of size 2^( 3) =       0.000423044331
  error estimate for blocks of size 2^( 4) =       0.000436917835
  error estimate for blocks of size 2^( 5) =       0.000449475991
  error estimate for blocks of size 2^( 6) =       0.000460779896
  error estimate for blocks of size 2^( 7) =       0.000464251085

      target function =      -0.869409454938
              le_mean =     -16.903094037717
             les_mean =     286.042904965372
             stat err =       0.000452856202
             autocorr =       1.322901779445
   target nu stat err =       0.000452856202
   target dn stat err =       0.008185074841
      target stat err =       0.009945456679
              std dev =       0.556815757427
             le_variance =       0.310043787718

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.310111348854
                                         uncertainty =       0.004745795264

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.310111348854
                                         uncertainty =       0.004745795264

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000393748265
  error estimate for blocks of size 2^( 2) =       0.000408080005
  error estimate for blocks of size 2^( 3) =       0.000423037173
  error estimate for blocks of size 2^( 4) =       0.000436898042
  error estimate for blocks of size 2^( 5) =       0.000449456978
  error estimate for blocks of size 2^( 6) =       0.000460773323
  error estimate for blocks of size 2^( 7) =       0.000464232652

      target function =      -0.868213983529
              le_mean =     -16.903091291971
             les_mean =     286.043790128439
             stat err =       0.000452840249
             autocorr =       1.322673745104
   target nu stat err =       0.000452840249
   target dn stat err =       0.008578364898
      target stat err =       0.010392944242
              std dev =       0.556844137225
             le_variance =       0.310075393161

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.310162112035
                                         uncertainty =       0.004722722324

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.310162112035
                                         uncertainty =       0.004722722324

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000393780608
  error estimate for blocks of size 2^( 2) =       0.000408099655
  error estimate for blocks of size 2^( 3) =       0.000423041101
  error estimate for blocks of size 2^( 4) =       0.000436888973
  error estimate for blocks of size 2^( 5) =       0.000449448126
  error estimate for blocks of size 2^( 6) =       0.000460778568
  error estimate for blocks of size 2^( 7) =       0.000464227454

      target function =      -0.868194836223
              le_mean =     -16.903090705213
             les_mean =     286.043786133762
             stat err =       0.000452835780
             autocorr =       1.322430386458
   target nu stat err =       0.000452835780
   target dn stat err =       0.008576983716
      target stat err =       0.010390808506
              std dev =       0.556889876139
             le_variance =       0.310126334147


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.866175269865        initial
     6.1035e-01     6.1035e+00             5.2212e-04        -0.869409454938  <--
     2.4414e+00     2.4414e+01             1.3613e-04        -0.868213983529
     9.7656e+00     9.7656e+01             3.4402e-05        -0.868194836223

*****************************************************************************
Applying the update for shift_i =   6.1035e-01     and shift_s =   6.1035e+00
*****************************************************************************

  Execution time = 2.4646e+01
  </log>
  <optVariables href="H2O.s055.opt.xml">
ci_0001                 7.006675e-01 3 1  ON 0
ci_0002                 6.991733e-01 3 1  ON 1
ci_0003                -3.320074e-02 3 1  ON 2
ci_0004                -3.332177e-02 3 1  ON 3
ci_0005                -3.044950e-02 3 1  ON 4
ci_0006                -3.137193e-02 3 1  ON 5
ci_0007                -1.910647e-02 3 1  ON 6
ci_0008                -1.969972e-02 3 1  ON 7
ci_0009                -2.045415e-02 3 1  ON 8
ci_0010                -2.063232e-02 3 1  ON 9
ci_0011                -1.694509e-02 3 1  ON 10
ci_0012                -1.680408e-02 3 1  ON 11
ci_0013                 1.686692e-02 3 1  ON 12
ci_0014                 1.695351e-02 3 1  ON 13
ci_0015                 1.732898e-02 3 1  ON 14
ci_0016                 1.723401e-02 3 1  ON 15
ci_0017                 1.489375e-02 3 1  ON 16
ci_0018                 1.525768e-02 3 1  ON 17
ci_0019                 1.326895e-02 3 1  ON 18
ci_0020                 1.304788e-02 3 1  ON 19
ci_0021                 1.656589e-02 3 1  ON 20
ci_0022                 1.710227e-02 3 1  ON 21
ci_0023                -1.231095e-02 3 1  ON 22
ci_0024                -1.184462e-02 3 1  ON 23
ci_0025                -4.085284e-03 3 1  ON 24
ci_0026                -3.716686e-03 3 1  ON 25
ci_0027                -1.220016e-02 3 1  ON 26
ci_0028                -1.198873e-02 3 1  ON 27
ci_0029                -1.060032e-02 3 1  ON 28
ci_0030                -1.067237e-02 3 1  ON 29
ci_0031                 1.433036e-02 3 1  ON 30
ci_0032                 1.422282e-02 3 1  ON 31
ci_0033                 9.592986e-03 3 1  ON 32
ci_0034                 9.605135e-03 3 1  ON 33
ci_0035                 5.880996e-03 3 1  ON 34
ci_0036                 5.913862e-03 3 1  ON 35
ci_0037                -1.192480e-02 3 1  ON 36
ci_0038                -1.196962e-02 3 1  ON 37
ci_0039                -4.810174e-03 3 1  ON 38
ci_0040                -4.814585e-03 3 1  ON 39
ci_0041                 1.024321e-02 3 1  ON 40
ci_0042                 1.037842e-02 3 1  ON 41
ci_0043                -6.864222e-03 3 1  ON 42
ci_0044                -7.908975e-03 3 1  ON 43
ci_0045                 1.084624e-02 3 1  ON 44
ci_0046                 1.040019e-02 3 1  ON 45
ci_0047                -4.369556e-03 3 1  ON 46
ci_0048                -4.461158e-03 3 1  ON 47
ci_0049                -3.374459e-03 3 1  ON 48
ci_0050                -3.702056e-03 3 1  ON 49
ci_0051                -2.557064e-03 3 1  ON 50
ci_0052                -2.589949e-03 3 1  ON 51
ci_0053                -4.105618e-03 3 1  ON 52
ci_0054                -4.472233e-03 3 1  ON 53
ci_0055                 3.243488e-03 3 1  ON 54
ci_0056                 2.812012e-03 3 1  ON 55
ci_0057                 3.079457e-03 3 1  ON 56
ci_0058                 3.647855e-03 3 1  ON 57
ci_0059                -4.529810e-03 3 1  ON 58
ci_0060                -3.971335e-03 3 1  ON 59
ci_0061                -4.017831e-03 3 1  ON 60
ci_0062                -4.018694e-03 3 1  ON 61
ci_0063                -9.877098e-03 3 1  ON 62
ci_0064                -9.650695e-03 3 1  ON 63
ci_0065                -7.310150e-03 3 1  ON 64
ci_0066                -7.335105e-03 3 1  ON 65
ci_0067                -4.450370e-03 3 1  ON 66
ci_0068                -4.704628e-03 3 1  ON 67
ci_0069                 4.283621e-03 3 1  ON 68
ci_0070                 3.803290e-03 3 1  ON 69
ci_0071                 4.701815e-03 3 1  ON 70
ci_0072                 5.002105e-03 3 1  ON 71
ci_0073                 4.084045e-03 3 1  ON 72
ci_0074                 3.997939e-03 3 1  ON 73
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 4.2456e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s056 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s056 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=56  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6897e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 56
    time step          = 0.05
    reference energy   = -16.928
    reference variance = 0.241937
====================================================
  Execution time = 1.4927e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s056
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5245e+04
  VMC Eavg = -1.6904e+01
  VMC Evar = 3.1739e-01
  Total weights = 1.951923498e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 2.6822e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.303164560834
                                         uncertainty =       0.001985865384

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.303164560834
                                         uncertainty =       0.001985865384

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000389413077
  error estimate for blocks of size 2^( 2) =       0.000403470966
  error estimate for blocks of size 2^( 3) =       0.000418121010
  error estimate for blocks of size 2^( 4) =       0.000431992619
  error estimate for blocks of size 2^( 5) =       0.000443999398
  error estimate for blocks of size 2^( 6) =       0.000450355910
  error estimate for blocks of size 2^( 7) =       0.000454495658

      target function =      -0.883065198314
              le_mean =     -16.903849895332
             les_mean =     286.057533690147
             stat err =       0.000445210896
             autocorr =       1.307105090822
   target nu stat err =       0.000445210896
   target dn stat err =       0.003185799881
      target stat err =       0.004039529237
              std dev =       0.550713255081
             le_variance =       0.303285089322


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690384989533e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 74
Check correct_vf_var_size: 225, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.5259e-01, overlap shift 1.5259e+00 and omega -1.7527e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.883082648253       residual = 2.79e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.883608141577       residual = 5.57e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.883722204539       residual = 1.46e-03           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.883758941028       residual = 4.42e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.883774889723       residual = 1.58e-04           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.883781731244       residual = 8.38e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.883786170170       residual = 2.06e-05           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.883786409920       residual = 1.06e-05           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.883786631784       residual = 7.04e-06           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.883786734360       residual = 3.00e-06           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.883786676354       residual = 2.31e-06           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.883786807392       residual = 1.43e-06           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.883786828141       residual = 1.98e-06           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.883787048444       residual = 1.34e-06           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.883787003960       residual = 7.49e-07           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.883787116877       residual = 1.61e-07           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.883787109671       residual = 4.87e-08           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.883787107098       residual = 1.83e-08           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.883787095643       residual = 4.64e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         18 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 1.5259e-01 is 1.514312e-03

solving harmonic davidson linear method for identity shift 6.1035e-01, overlap shift 6.1035e+00 and omega -1.7527e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.883082648253       residual = 2.79e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.883256852234       residual = 5.32e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.883292908596       residual = 1.31e-03           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.883303675765       residual = 3.75e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.883308138498       residual = 1.29e-04           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.883309862802       residual = 5.96e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.883310961514       residual = 1.35e-05           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.883310980363       residual = 6.24e-06           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.883311032102       residual = 4.27e-06           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.883311042164       residual = 2.06e-06           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.883311023882       residual = 1.49e-06           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.883311056734       residual = 9.85e-07           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.883311063276       residual = 1.18e-06           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.883311107926       residual = 5.15e-07           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.883311095817       residual = 1.94e-07           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.883311112383       residual = 3.68e-08           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.883311110330       residual = 1.09e-08           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.883311109582       residual = 3.69e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         17 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 6.1035e-01 is 4.564007e-04

solving harmonic davidson linear method for identity shift 2.4414e+00, overlap shift 2.4414e+01 and omega -1.7527e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.883082648253       residual = 2.79e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.883130061489       residual = 5.23e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.883139706415       residual = 1.26e-03           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.883142509050       residual = 3.54e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.883143652055       residual = 1.19e-04           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.883144077175       residual = 5.28e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.883144347208       residual = 1.17e-05           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.883144348447       residual = 5.21e-06           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.883144361173       residual = 3.55e-06           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.883144362284       residual = 1.83e-06           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.883144357643       residual = 1.29e-06           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.883144365867       residual = 8.64e-07           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.883144367640       residual = 9.52e-07           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.883144377723       residual = 3.59e-07           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.883144374822       residual = 1.21e-07           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.883144378255       residual = 2.25e-08           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.883144377767       residual = 6.57e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         16 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 2.4414e+00 is 1.202881e-04

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.794055 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 75 and numParams is: 74

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.7625e+01
  </log>
  <optVariables href="H2O.s056.opt.xml">
ci_0001                 7.005972e-01 3 1  ON 0
ci_0002                 6.994140e-01 3 1  ON 1
ci_0003                -3.297044e-02 3 1  ON 2
ci_0004                -3.306610e-02 3 1  ON 3
ci_0005                -2.999310e-02 3 1  ON 4
ci_0006                -3.112664e-02 3 1  ON 5
ci_0007                -1.873421e-02 3 1  ON 6
ci_0008                -1.943901e-02 3 1  ON 7
ci_0009                -2.037189e-02 3 1  ON 8
ci_0010                -2.046917e-02 3 1  ON 9
ci_0011                -1.678294e-02 3 1  ON 10
ci_0012                -1.659137e-02 3 1  ON 11
ci_0013                 1.672392e-02 3 1  ON 12
ci_0014                 1.675278e-02 3 1  ON 13
ci_0015                 1.713925e-02 3 1  ON 14
ci_0016                 1.702545e-02 3 1  ON 15
ci_0017                 1.462825e-02 3 1  ON 16
ci_0018                 1.506664e-02 3 1  ON 17
ci_0019                 1.314455e-02 3 1  ON 18
ci_0020                 1.290546e-02 3 1  ON 19
ci_0021                 1.646638e-02 3 1  ON 20
ci_0022                 1.710873e-02 3 1  ON 21
ci_0023                -1.216008e-02 3 1  ON 22
ci_0024                -1.183240e-02 3 1  ON 23
ci_0025                -3.819906e-03 3 1  ON 24
ci_0026                -3.669384e-03 3 1  ON 25
ci_0027                -1.203721e-02 3 1  ON 26
ci_0028                -1.184640e-02 3 1  ON 27
ci_0029                -1.059606e-02 3 1  ON 28
ci_0030                -1.062579e-02 3 1  ON 29
ci_0031                 1.421493e-02 3 1  ON 30
ci_0032                 1.426831e-02 3 1  ON 31
ci_0033                 9.405908e-03 3 1  ON 32
ci_0034                 9.484431e-03 3 1  ON 33
ci_0035                 5.611925e-03 3 1  ON 34
ci_0036                 5.817601e-03 3 1  ON 35
ci_0037                -1.189044e-02 3 1  ON 36
ci_0038                -1.178912e-02 3 1  ON 37
ci_0039                -4.715051e-03 3 1  ON 38
ci_0040                -4.735364e-03 3 1  ON 39
ci_0041                 1.005697e-02 3 1  ON 40
ci_0042                 1.032707e-02 3 1  ON 41
ci_0043                -6.756059e-03 3 1  ON 42
ci_0044                -7.925925e-03 3 1  ON 43
ci_0045                 1.070729e-02 3 1  ON 44
ci_0046                 1.030787e-02 3 1  ON 45
ci_0047                -4.232114e-03 3 1  ON 46
ci_0048                -4.333351e-03 3 1  ON 47
ci_0049                -3.157090e-03 3 1  ON 48
ci_0050                -3.479878e-03 3 1  ON 49
ci_0051                -2.400537e-03 3 1  ON 50
ci_0052                -2.481835e-03 3 1  ON 51
ci_0053                -4.155704e-03 3 1  ON 52
ci_0054                -4.385834e-03 3 1  ON 53
ci_0055                 3.113320e-03 3 1  ON 54
ci_0056                 2.653958e-03 3 1  ON 55
ci_0057                 3.220451e-03 3 1  ON 56
ci_0058                 3.416170e-03 3 1  ON 57
ci_0059                -4.519563e-03 3 1  ON 58
ci_0060                -3.955843e-03 3 1  ON 59
ci_0061                -3.844788e-03 3 1  ON 60
ci_0062                -3.869926e-03 3 1  ON 61
ci_0063                -9.899464e-03 3 1  ON 62
ci_0064                -9.660075e-03 3 1  ON 63
ci_0065                -7.250466e-03 3 1  ON 64
ci_0066                -7.359624e-03 3 1  ON 65
ci_0067                -4.262888e-03 3 1  ON 66
ci_0068                -4.423161e-03 3 1  ON 67
ci_0069                 4.163263e-03 3 1  ON 68
ci_0070                 3.797404e-03 3 1  ON 69
ci_0071                 4.679755e-03 3 1  ON 70
ci_0072                 4.789643e-03 3 1  ON 71
ci_0073                 3.979661e-03 3 1  ON 72
ci_0074                 3.990334e-03 3 1  ON 73
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 56
    time step          = 0.05
    reference energy   = -16.883
    reference variance = 0.216193
====================================================
  Execution time = 1.4521e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s056
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6904e+01
  VMC Evar = 3.2057e-01
  Total weights = 1.9515e+06
  Execution time = 1.9457e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.308481863563
                                         uncertainty =       0.003196842815

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.308481863563
                                         uncertainty =       0.003196842815

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000392778883
  error estimate for blocks of size 2^( 2) =       0.000406900908
  error estimate for blocks of size 2^( 3) =       0.000421171733
  error estimate for blocks of size 2^( 4) =       0.000434013299
  error estimate for blocks of size 2^( 5) =       0.000444741267
  error estimate for blocks of size 2^( 6) =       0.000450488853
  error estimate for blocks of size 2^( 7) =       0.000453007470

      target function =      -0.855429404433
              le_mean =     -16.903675105605
             les_mean =     286.073904350581
             stat err =       0.000445562723
             autocorr =       1.286830766643
   target nu stat err =       0.000445562723
   target dn stat err =       0.019095693641
      target stat err =       0.022458915380
              std dev =       0.555473223821
             le_variance =       0.308550502383

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.307970499558
                                         uncertainty =       0.003276531095

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.307970499558
                                         uncertainty =       0.003276531095

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000392453578
  error estimate for blocks of size 2^( 2) =       0.000406680722
  error estimate for blocks of size 2^( 3) =       0.000421048556
  error estimate for blocks of size 2^( 4) =       0.000433960607
  error estimate for blocks of size 2^( 5) =       0.000444727716
  error estimate for blocks of size 2^( 6) =       0.000450552078
  error estimate for blocks of size 2^( 7) =       0.000453122509

      target function =      -0.867433535551
              le_mean =     -16.903697542423
             les_mean =     286.065032490231
             stat err =       0.000445590727
             autocorr =       1.289126996368
   target nu stat err =       0.000445590727
   target dn stat err =       0.006411678815
      target stat err =       0.007771566299
              std dev =       0.555013172842
             le_variance =       0.308039622028

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.308050000565
                                         uncertainty =       0.003238509875

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.308050000565
                                         uncertainty =       0.003238509875

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000392504188
  error estimate for blocks of size 2^( 2) =       0.000406691686
  error estimate for blocks of size 2^( 3) =       0.000421029872
  error estimate for blocks of size 2^( 4) =       0.000433919416
  error estimate for blocks of size 2^( 5) =       0.000444676686
  error estimate for blocks of size 2^( 6) =       0.000450477319
  error estimate for blocks of size 2^( 7) =       0.000453046144

      target function =      -0.877667225740
              le_mean =     -16.903686428794
             les_mean =     286.056319210942
             stat err =       0.000445529891
             autocorr =       1.288442683972
   target nu stat err =       0.000445529891
   target dn stat err =       0.003921749782
      target stat err =       0.004890954490
              std dev =       0.555084745867
             le_variance =       0.308119075094

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.308380609983
                                         uncertainty =       0.003199469564

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.308380609983
                                         uncertainty =       0.003199469564

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000392714501
  error estimate for blocks of size 2^( 2) =       0.000406848595
  error estimate for blocks of size 2^( 3) =       0.000421129998
  error estimate for blocks of size 2^( 4) =       0.000433975155
  error estimate for blocks of size 2^( 5) =       0.000444708924
  error estimate for blocks of size 2^( 6) =       0.000450468118
  error estimate for blocks of size 2^( 7) =       0.000453015951

      target function =      -0.878664876547
              le_mean =     -16.903678355893
             les_mean =     286.055240909093
             stat err =       0.000445542037
             autocorr =       1.287133207422
   target nu stat err =       0.000445542037
   target dn stat err =       0.003807643584
      target stat err =       0.004761673405
              std dev =       0.555382174006
             le_variance =       0.308449359204


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.855429404433        initial
     1.5259e-01     1.5259e+00             1.5143e-03        -0.867433535551
     6.1035e-01     6.1035e+00             4.5640e-04        -0.877667225740
     2.4414e+00     2.4414e+01             1.2029e-04        -0.878664876547  <--

*****************************************************************************
Applying the update for shift_i =   2.4414e+00     and shift_s =   2.4414e+01
*****************************************************************************

  Execution time = 2.4359e+01
  </log>
  <optVariables href="H2O.s056.opt.xml">
ci_0001                 7.006514e-01 3 1  ON 0
ci_0002                 6.992349e-01 3 1  ON 1
ci_0003                -3.313925e-02 3 1  ON 2
ci_0004                -3.325330e-02 3 1  ON 3
ci_0005                -3.032921e-02 3 1  ON 4
ci_0006                -3.130714e-02 3 1  ON 5
ci_0007                -1.900912e-02 3 1  ON 6
ci_0008                -1.963171e-02 3 1  ON 7
ci_0009                -2.043203e-02 3 1  ON 8
ci_0010                -2.058836e-02 3 1  ON 9
ci_0011                -1.690156e-02 3 1  ON 10
ci_0012                -1.674696e-02 3 1  ON 11
ci_0013                 1.682852e-02 3 1  ON 12
ci_0014                 1.689957e-02 3 1  ON 13
ci_0015                 1.727816e-02 3 1  ON 14
ci_0016                 1.717796e-02 3 1  ON 15
ci_0017                 1.482248e-02 3 1  ON 16
ci_0018                 1.520631e-02 3 1  ON 17
ci_0019                 1.323534e-02 3 1  ON 18
ci_0020                 1.300938e-02 3 1  ON 19
ci_0021                 1.654039e-02 3 1  ON 20
ci_0022                 1.710417e-02 3 1  ON 21
ci_0023                -1.227031e-02 3 1  ON 22
ci_0024                -1.184111e-02 3 1  ON 23
ci_0025                -4.013207e-03 3 1  ON 24
ci_0026                -3.703814e-03 3 1  ON 25
ci_0027                -1.215636e-02 3 1  ON 26
ci_0028                -1.195027e-02 3 1  ON 27
ci_0029                -1.059887e-02 3 1  ON 28
ci_0030                -1.065943e-02 3 1  ON 29
ci_0031                 1.430042e-02 3 1  ON 30
ci_0032                 1.423465e-02 3 1  ON 31
ci_0033                 9.543734e-03 3 1  ON 32
ci_0034                 9.573156e-03 3 1  ON 33
ci_0035                 5.807772e-03 3 1  ON 34
ci_0036                 5.887616e-03 3 1  ON 35
ci_0037                -1.191571e-02 3 1  ON 36
ci_0038                -1.192156e-02 3 1  ON 37
ci_0039                -4.784451e-03 3 1  ON 38
ci_0040                -4.793131e-03 3 1  ON 39
ci_0041                 1.019355e-02 3 1  ON 40
ci_0042                 1.036462e-02 3 1  ON 41
ci_0043                -6.835852e-03 3 1  ON 42
ci_0044                -7.913227e-03 3 1  ON 43
ci_0045                 1.080933e-02 3 1  ON 44
ci_0046                 1.037566e-02 3 1  ON 45
ci_0047                -4.332309e-03 3 1  ON 46
ci_0048                -4.426456e-03 3 1  ON 47
ci_0049                -3.315197e-03 3 1  ON 48
ci_0050                -3.641534e-03 3 1  ON 49
ci_0051                -2.514276e-03 3 1  ON 50
ci_0052                -2.560387e-03 3 1  ON 51
ci_0053                -4.119300e-03 3 1  ON 52
ci_0054                -4.448707e-03 3 1  ON 53
ci_0055                 3.208155e-03 3 1  ON 54
ci_0056                 2.768951e-03 3 1  ON 55
ci_0057                 3.117962e-03 3 1  ON 56
ci_0058                 3.584939e-03 3 1  ON 57
ci_0059                -4.527089e-03 3 1  ON 58
ci_0060                -3.967093e-03 3 1  ON 59
ci_0061                -3.971444e-03 3 1  ON 60
ci_0062                -3.978763e-03 3 1  ON 61
ci_0063                -9.883114e-03 3 1  ON 62
ci_0064                -9.653089e-03 3 1  ON 63
ci_0065                -7.294156e-03 3 1  ON 64
ci_0066                -7.341639e-03 3 1  ON 65
ci_0067                -4.399261e-03 3 1  ON 66
ci_0068                -4.627954e-03 3 1  ON 67
ci_0069                 4.250874e-03 3 1  ON 68
ci_0070                 3.801665e-03 3 1  ON 69
ci_0071                 4.695879e-03 3 1  ON 70
ci_0072                 4.944357e-03 3 1  ON 71
ci_0073                 4.055558e-03 3 1  ON 72
ci_0074                 3.995809e-03 3 1  ON 73
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 4.1990e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s057 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s057 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=57  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6897e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 57
    time step          = 0.05
    reference energy   = -16.9436
    reference variance = 0.194965
====================================================
  Execution time = 1.4934e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s057
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5212e+04
  VMC Eavg = -1.6903e+01
  VMC Evar = 3.2420e-01
  Total weights = 1.951521412e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 2.6785e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.309699293371
                                         uncertainty =       0.003216855397

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.309699293371
                                         uncertainty =       0.003216855397

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000393457386
  error estimate for blocks of size 2^( 2) =       0.000407422290
  error estimate for blocks of size 2^( 3) =       0.000421828965
  error estimate for blocks of size 2^( 4) =       0.000435464333
  error estimate for blocks of size 2^( 5) =       0.000446922371
  error estimate for blocks of size 2^( 6) =       0.000454562373
  error estimate for blocks of size 2^( 7) =       0.000460156526

      target function =      -0.874419058753
              le_mean =     -16.902575999067
             les_mean =     286.021274912700
             stat err =       0.000449276401
             autocorr =       1.303862544137
   target nu stat err =       0.000449276401
   target dn stat err =       0.005852130553
      target stat err =       0.007199609017
              std dev =       0.556432771437
             le_variance =       0.309617429129


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690257599907e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 74
Check correct_vf_var_size: 225, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 6.1035e-01, overlap shift 6.1035e+00 and omega -1.7527e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.874477551694       residual = 9.71e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.874978182682       residual = 8.51e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.875036322032       residual = 2.27e-03           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.875051625483       residual = 7.92e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.875061716330       residual = 3.35e-04           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.875065888080       residual = 2.45e-04           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.875067199476       residual = 1.51e-04           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.875068045369       residual = 9.62e-05           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.875070618601       residual = 1.14e-04           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.875072476735       residual = 7.35e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.875073228129       residual = 5.40e-05           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.875073591244       residual = 1.48e-05           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.875073997245       residual = 7.14e-06           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.875074291383       residual = 2.22e-06           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.875074416046       residual = 4.12e-07           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.875074435765       residual = 1.09e-07           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.875074455998       residual = 1.54e-08           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.875074463943       residual = 7.12e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         17 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 6.1035e-01 is 1.145834e-03

solving harmonic davidson linear method for identity shift 2.4414e+00, overlap shift 2.4414e+01 and omega -1.7527e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.874477551694       residual = 9.71e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.874614045601       residual = 8.42e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.874629651439       residual = 2.19e-03           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.874633637355       residual = 7.52e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.874636235568       residual = 3.14e-04           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.874637282425       residual = 2.21e-04           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.874637597164       residual = 1.35e-04           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.874637807079       residual = 8.77e-05           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.874638457569       residual = 1.01e-04           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.874638890461       residual = 6.08e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.874639045206       residual = 4.04e-05           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.874639116504       residual = 1.08e-05           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.874639205587       residual = 4.95e-06           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.874639269346       residual = 1.42e-06           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.874639294805       residual = 2.54e-07           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.874639298226       residual = 6.43e-08           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.874639302325       residual = 9.34e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         16 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 2.4414e+00 is 2.873575e-04

solving harmonic davidson linear method for identity shift 9.7656e+00, overlap shift 9.7656e+01 and omega -1.7527e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.874477551694       residual = 9.71e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.874512465277       residual = 8.39e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.874516439700       residual = 2.17e-03           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.874517446318       residual = 7.41e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.874518100452       residual = 3.09e-04           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.874518362141       residual = 2.15e-04           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.874518439867       residual = 1.31e-04           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.874518492231       residual = 8.55e-05           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.874518655185       residual = 9.82e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.874518761098       residual = 5.76e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.874518797670       residual = 3.73e-05           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.874518814347       residual = 9.92e-06           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.874518835859       residual = 4.48e-06           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.874518851197       residual = 1.26e-06           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.874518857218       residual = 2.23e-07           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.874518857988       residual = 5.58e-08           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.874518858956       residual = 8.16e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         16 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 9.7656e+00 is 7.189948e-05

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.803600 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 75 and numParams is: 74

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.7628e+01
  </log>
  <optVariables href="H2O.s057.opt.xml">
ci_0001                 7.009388e-01 3 1  ON 0
ci_0002                 6.990039e-01 3 1  ON 1
ci_0003                -3.305762e-02 3 1  ON 2
ci_0004                -3.316664e-02 3 1  ON 3
ci_0005                -3.021389e-02 3 1  ON 4
ci_0006                -3.117239e-02 3 1  ON 5
ci_0007                -1.890175e-02 3 1  ON 6
ci_0008                -1.956004e-02 3 1  ON 7
ci_0009                -2.038485e-02 3 1  ON 8
ci_0010                -2.053243e-02 3 1  ON 9
ci_0011                -1.681973e-02 3 1  ON 10
ci_0012                -1.668558e-02 3 1  ON 11
ci_0013                 1.676414e-02 3 1  ON 12
ci_0014                 1.685097e-02 3 1  ON 13
ci_0015                 1.725881e-02 3 1  ON 14
ci_0016                 1.713062e-02 3 1  ON 15
ci_0017                 1.480538e-02 3 1  ON 16
ci_0018                 1.514601e-02 3 1  ON 17
ci_0019                 1.319905e-02 3 1  ON 18
ci_0020                 1.296865e-02 3 1  ON 19
ci_0021                 1.644433e-02 3 1  ON 20
ci_0022                 1.706720e-02 3 1  ON 21
ci_0023                -1.225271e-02 3 1  ON 22
ci_0024                -1.179098e-02 3 1  ON 23
ci_0025                -3.819941e-03 3 1  ON 24
ci_0026                -3.635264e-03 3 1  ON 25
ci_0027                -1.212569e-02 3 1  ON 26
ci_0028                -1.192736e-02 3 1  ON 27
ci_0029                -1.063471e-02 3 1  ON 28
ci_0030                -1.064211e-02 3 1  ON 29
ci_0031                 1.428316e-02 3 1  ON 30
ci_0032                 1.418384e-02 3 1  ON 31
ci_0033                 9.509208e-03 3 1  ON 32
ci_0034                 9.552789e-03 3 1  ON 33
ci_0035                 5.790498e-03 3 1  ON 34
ci_0036                 5.731540e-03 3 1  ON 35
ci_0037                -1.187414e-02 3 1  ON 36
ci_0038                -1.190265e-02 3 1  ON 37
ci_0039                -4.746356e-03 3 1  ON 38
ci_0040                -4.751473e-03 3 1  ON 39
ci_0041                 1.017945e-02 3 1  ON 40
ci_0042                 1.031425e-02 3 1  ON 41
ci_0043                -6.817261e-03 3 1  ON 42
ci_0044                -7.913018e-03 3 1  ON 43
ci_0045                 1.079560e-02 3 1  ON 44
ci_0046                 1.034727e-02 3 1  ON 45
ci_0047                -4.297417e-03 3 1  ON 46
ci_0048                -4.393876e-03 3 1  ON 47
ci_0049                -3.298502e-03 3 1  ON 48
ci_0050                -3.498623e-03 3 1  ON 49
ci_0051                -2.456177e-03 3 1  ON 50
ci_0052                -2.512202e-03 3 1  ON 51
ci_0053                -4.123811e-03 3 1  ON 52
ci_0054                -4.417912e-03 3 1  ON 53
ci_0055                 3.191251e-03 3 1  ON 54
ci_0056                 2.739211e-03 3 1  ON 55
ci_0057                 3.013721e-03 3 1  ON 56
ci_0058                 3.548395e-03 3 1  ON 57
ci_0059                -4.396249e-03 3 1  ON 58
ci_0060                -3.925689e-03 3 1  ON 59
ci_0061                -3.934339e-03 3 1  ON 60
ci_0062                -3.964270e-03 3 1  ON 61
ci_0063                -9.871121e-03 3 1  ON 62
ci_0064                -9.661839e-03 3 1  ON 63
ci_0065                -7.276596e-03 3 1  ON 64
ci_0066                -7.304826e-03 3 1  ON 65
ci_0067                -4.404330e-03 3 1  ON 66
ci_0068                -4.625319e-03 3 1  ON 67
ci_0069                 4.221845e-03 3 1  ON 68
ci_0070                 3.770630e-03 3 1  ON 69
ci_0071                 4.692954e-03 3 1  ON 70
ci_0072                 4.897071e-03 3 1  ON 71
ci_0073                 4.027511e-03 3 1  ON 72
ci_0074                 3.973337e-03 3 1  ON 73
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 57
    time step          = 0.05
    reference energy   = -16.8195
    reference variance = 0.530268
====================================================
  Execution time = 1.4547e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s057
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6903e+01
  VMC Evar = 3.2582e-01
  Total weights = 1.9515e+06
  Execution time = 1.9523e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.309399452704
                                         uncertainty =       0.002389814721

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.309399452704
                                         uncertainty =       0.002389814721

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000393327857
  error estimate for blocks of size 2^( 2) =       0.000407776194
  error estimate for blocks of size 2^( 3) =       0.000422607512
  error estimate for blocks of size 2^( 4) =       0.000435973661
  error estimate for blocks of size 2^( 5) =       0.000448010590
  error estimate for blocks of size 2^( 6) =       0.000455296126
  error estimate for blocks of size 2^( 7) =       0.000459938952

      target function =      -0.871508692901
              le_mean =     -16.902766295839
             les_mean =     286.030072405461
             stat err =       0.000449804832
             autocorr =       1.307792433926
   target nu stat err =       0.000449804832
   target dn stat err =       0.007843837653
      target stat err =       0.009573121315
              std dev =       0.556249590356
             le_variance =       0.309413606772

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.309080758345
                                         uncertainty =       0.002408788061

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.309080758345
                                         uncertainty =       0.002408788061

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000393124703
  error estimate for blocks of size 2^( 2) =       0.000407610943
  error estimate for blocks of size 2^( 3) =       0.000422475522
  error estimate for blocks of size 2^( 4) =       0.000435882357
  error estimate for blocks of size 2^( 5) =       0.000447932510
  error estimate for blocks of size 2^( 6) =       0.000455206082
  error estimate for blocks of size 2^( 7) =       0.000459855898

      target function =      -0.872061089461
              le_mean =     -16.902770156550
             les_mean =     286.029745354846
             stat err =       0.000449719212
             autocorr =       1.308646090621
   target nu stat err =       0.000449719212
   target dn stat err =       0.008050417343
      target stat err =       0.009836720926
              std dev =       0.555962286678
             le_variance =       0.309094064209

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.309211875711
                                         uncertainty =       0.002400723093

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.309211875711
                                         uncertainty =       0.002400723093

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000393208330
  error estimate for blocks of size 2^( 2) =       0.000407677077
  error estimate for blocks of size 2^( 3) =       0.000422526460
  error estimate for blocks of size 2^( 4) =       0.000435915054
  error estimate for blocks of size 2^( 5) =       0.000447959279
  error estimate for blocks of size 2^( 6) =       0.000455238613
  error estimate for blocks of size 2^( 7) =       0.000459882376

      target function =      -0.872288400633
              le_mean =     -16.902766623813
             les_mean =     286.029441532358
             stat err =       0.000449748830
             autocorr =       1.308261816546
   target nu stat err =       0.000449748830
   target dn stat err =       0.007943620310
      target stat err =       0.009711730050
              std dev =       0.556080552878
             le_variance =       0.309225581290

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.309373464290
                                         uncertainty =       0.002391187512

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.309373464290
                                         uncertainty =       0.002391187512

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000393311303
  error estimate for blocks of size 2^( 2) =       0.000407762229
  error estimate for blocks of size 2^( 3) =       0.000422595867
  error estimate for blocks of size 2^( 4) =       0.000435964902
  error estimate for blocks of size 2^( 5) =       0.000448002678
  error estimate for blocks of size 2^( 6) =       0.000455287499
  error estimate for blocks of size 2^( 7) =       0.000459930261

      target function =      -0.872006246660
              le_mean =     -16.902766051338
             les_mean =     286.029655777625
             stat err =       0.000449796335
             autocorr =       1.307853111099
   target nu stat err =       0.000449796335
   target dn stat err =       0.007840699781
      target stat err =       0.009580209800
              std dev =       0.556226179345
             le_variance =       0.309387562589


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.871508692901        initial
     6.1035e-01     6.1035e+00             1.1458e-03        -0.872061089461
     2.4414e+00     2.4414e+01             2.8736e-04        -0.872288400633  <--
     9.7656e+00     9.7656e+01             7.1899e-05        -0.872006246660

*****************************************************************************
Applying the update for shift_i =   2.4414e+00     and shift_s =   2.4414e+01
*****************************************************************************

  Execution time = 2.4403e+01
  </log>
  <optVariables href="H2O.s057.opt.xml">
ci_0001                 7.009388e-01 3 1  ON 0
ci_0002                 6.990039e-01 3 1  ON 1
ci_0003                -3.305762e-02 3 1  ON 2
ci_0004                -3.316664e-02 3 1  ON 3
ci_0005                -3.021389e-02 3 1  ON 4
ci_0006                -3.117239e-02 3 1  ON 5
ci_0007                -1.890175e-02 3 1  ON 6
ci_0008                -1.956004e-02 3 1  ON 7
ci_0009                -2.038485e-02 3 1  ON 8
ci_0010                -2.053243e-02 3 1  ON 9
ci_0011                -1.681973e-02 3 1  ON 10
ci_0012                -1.668558e-02 3 1  ON 11
ci_0013                 1.676414e-02 3 1  ON 12
ci_0014                 1.685097e-02 3 1  ON 13
ci_0015                 1.725881e-02 3 1  ON 14
ci_0016                 1.713062e-02 3 1  ON 15
ci_0017                 1.480538e-02 3 1  ON 16
ci_0018                 1.514601e-02 3 1  ON 17
ci_0019                 1.319905e-02 3 1  ON 18
ci_0020                 1.296865e-02 3 1  ON 19
ci_0021                 1.644433e-02 3 1  ON 20
ci_0022                 1.706720e-02 3 1  ON 21
ci_0023                -1.225271e-02 3 1  ON 22
ci_0024                -1.179098e-02 3 1  ON 23
ci_0025                -3.819941e-03 3 1  ON 24
ci_0026                -3.635264e-03 3 1  ON 25
ci_0027                -1.212569e-02 3 1  ON 26
ci_0028                -1.192736e-02 3 1  ON 27
ci_0029                -1.063471e-02 3 1  ON 28
ci_0030                -1.064211e-02 3 1  ON 29
ci_0031                 1.428316e-02 3 1  ON 30
ci_0032                 1.418384e-02 3 1  ON 31
ci_0033                 9.509208e-03 3 1  ON 32
ci_0034                 9.552789e-03 3 1  ON 33
ci_0035                 5.790498e-03 3 1  ON 34
ci_0036                 5.731540e-03 3 1  ON 35
ci_0037                -1.187414e-02 3 1  ON 36
ci_0038                -1.190265e-02 3 1  ON 37
ci_0039                -4.746356e-03 3 1  ON 38
ci_0040                -4.751473e-03 3 1  ON 39
ci_0041                 1.017945e-02 3 1  ON 40
ci_0042                 1.031425e-02 3 1  ON 41
ci_0043                -6.817261e-03 3 1  ON 42
ci_0044                -7.913018e-03 3 1  ON 43
ci_0045                 1.079560e-02 3 1  ON 44
ci_0046                 1.034727e-02 3 1  ON 45
ci_0047                -4.297417e-03 3 1  ON 46
ci_0048                -4.393876e-03 3 1  ON 47
ci_0049                -3.298502e-03 3 1  ON 48
ci_0050                -3.498623e-03 3 1  ON 49
ci_0051                -2.456177e-03 3 1  ON 50
ci_0052                -2.512202e-03 3 1  ON 51
ci_0053                -4.123811e-03 3 1  ON 52
ci_0054                -4.417912e-03 3 1  ON 53
ci_0055                 3.191251e-03 3 1  ON 54
ci_0056                 2.739211e-03 3 1  ON 55
ci_0057                 3.013721e-03 3 1  ON 56
ci_0058                 3.548395e-03 3 1  ON 57
ci_0059                -4.396249e-03 3 1  ON 58
ci_0060                -3.925689e-03 3 1  ON 59
ci_0061                -3.934339e-03 3 1  ON 60
ci_0062                -3.964270e-03 3 1  ON 61
ci_0063                -9.871121e-03 3 1  ON 62
ci_0064                -9.661839e-03 3 1  ON 63
ci_0065                -7.276596e-03 3 1  ON 64
ci_0066                -7.304826e-03 3 1  ON 65
ci_0067                -4.404330e-03 3 1  ON 66
ci_0068                -4.625319e-03 3 1  ON 67
ci_0069                 4.221845e-03 3 1  ON 68
ci_0070                 3.770630e-03 3 1  ON 69
ci_0071                 4.692954e-03 3 1  ON 70
ci_0072                 4.897071e-03 3 1  ON 71
ci_0073                 4.027511e-03 3 1  ON 72
ci_0074                 3.973337e-03 3 1  ON 73
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 4.2037e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s058 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s058 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=58  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6897e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 58
    time step          = 0.05
    reference energy   = -16.952
    reference variance = 0.444358
====================================================
  Execution time = 1.5051e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s058
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5255e+04
  VMC Eavg = -1.6903e+01
  VMC Evar = 3.2077e-01
  Total weights = 1.951648137e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 2.6896e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.308458571973
                                         uncertainty =       0.002350551064

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.308458571973
                                         uncertainty =       0.002350551064

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000392716964
  error estimate for blocks of size 2^( 2) =       0.000406984630
  error estimate for blocks of size 2^( 3) =       0.000421960856
  error estimate for blocks of size 2^( 4) =       0.000434808530
  error estimate for blocks of size 2^( 5) =       0.000446794496
  error estimate for blocks of size 2^( 6) =       0.000454833332
  error estimate for blocks of size 2^( 7) =       0.000459599595

      target function =      -0.878704147530
              le_mean =     -16.902745982434
             les_mean =     286.023592736194
             stat err =       0.000449008988
             autocorr =       1.307226204343
   target nu stat err =       0.000449008988
   target dn stat err =       0.003348768702
      target stat err =       0.004193295013
              std dev =       0.555385657028
             le_variance =       0.308453228033


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690274598243e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 74
Check correct_vf_var_size: 225, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 6.1035e-01, overlap shift 6.1035e+00 and omega -1.7527e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.878722986572       residual = 2.48e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.878865021665       residual = 4.04e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.878894468016       residual = 1.37e-03           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.878906845032       residual = 4.02e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.878912013412       residual = 1.84e-04           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.878914132927       residual = 5.90e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.878914664563       residual = 1.81e-05           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.878914680229       residual = 8.38e-06           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.878914797943       residual = 2.37e-06           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.878914808210       residual = 9.46e-07           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.878914805216       residual = 3.53e-07           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.878914829026       residual = 1.65e-07           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.878914808961       residual = 1.59e-07           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.878914814456       residual = 1.59e-07           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.878914844203       residual = 1.07e-07           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.878914847346       residual = 2.71e-08           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.878914857833       residual = 1.43e-08           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.878914853104       residual = 4.57e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         17 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 6.1035e-01 is 4.795113e-04

solving harmonic davidson linear method for identity shift 2.4414e+00, overlap shift 2.4414e+01 and omega -1.7527e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.878722986572       residual = 2.48e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.878761613994       residual = 3.96e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.878769480831       residual = 1.32e-03           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.878772704003       residual = 3.79e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.878774031047       residual = 1.69e-04           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.878774545963       residual = 5.19e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.878774673736       residual = 1.55e-05           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.878774675807       residual = 7.08e-06           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.878774703976       residual = 1.96e-06           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.878774705688       residual = 7.77e-07           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.878774704774       residual = 2.83e-07           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.878774710417       residual = 1.40e-07           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.878774705314       residual = 1.38e-07           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.878774707249       residual = 1.27e-07           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.878774714090       residual = 7.19e-08           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.878774714743       residual = 1.75e-08           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.878774716935       residual = 8.97e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         16 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 2.4414e+00 is 1.250565e-04

solving harmonic davidson linear method for identity shift 9.7656e+00, overlap shift 9.7656e+01 and omega -1.7527e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.878722986572       residual = 2.48e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.878732860184       residual = 3.94e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.878734861075       residual = 1.31e-03           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.878735675062       residual = 3.73e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.878736008907       residual = 1.66e-04           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.878736136450       residual = 5.01e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.878736168018       residual = 1.48e-05           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.878736168416       residual = 6.76e-06           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.878736175371       residual = 1.85e-06           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.878736175743       residual = 7.36e-07           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.878736175505       residual = 2.66e-07           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.878736176895       residual = 1.33e-07           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.878736175615       residual = 1.33e-07           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.878736176137       residual = 1.19e-07           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.878736177803       residual = 6.44e-08           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.878736177959       residual = 1.56e-08           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.878736178480       residual = 7.90e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         16 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 9.7656e+00 is 3.160418e-05

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.813192 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 75 and numParams is: 74

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.7756e+01
  </log>
  <optVariables href="H2O.s058.opt.xml">
ci_0001                 7.009446e-01 3 1  ON 0
ci_0002                 6.990404e-01 3 1  ON 1
ci_0003                -3.298828e-02 3 1  ON 2
ci_0004                -3.308810e-02 3 1  ON 3
ci_0005                -3.010292e-02 3 1  ON 4
ci_0006                -3.114154e-02 3 1  ON 5
ci_0007                -1.877669e-02 3 1  ON 6
ci_0008                -1.947343e-02 3 1  ON 7
ci_0009                -2.032057e-02 3 1  ON 8
ci_0010                -2.050074e-02 3 1  ON 9
ci_0011                -1.679419e-02 3 1  ON 10
ci_0012                -1.663317e-02 3 1  ON 11
ci_0013                 1.671538e-02 3 1  ON 12
ci_0014                 1.682639e-02 3 1  ON 13
ci_0015                 1.721253e-02 3 1  ON 14
ci_0016                 1.710832e-02 3 1  ON 15
ci_0017                 1.481023e-02 3 1  ON 16
ci_0018                 1.509859e-02 3 1  ON 17
ci_0019                 1.314969e-02 3 1  ON 18
ci_0020                 1.292890e-02 3 1  ON 19
ci_0021                 1.645275e-02 3 1  ON 20
ci_0022                 1.708643e-02 3 1  ON 21
ci_0023                -1.221615e-02 3 1  ON 22
ci_0024                -1.174345e-02 3 1  ON 23
ci_0025                -3.817015e-03 3 1  ON 24
ci_0026                -3.578537e-03 3 1  ON 25
ci_0027                -1.209563e-02 3 1  ON 26
ci_0028                -1.190246e-02 3 1  ON 27
ci_0029                -1.062881e-02 3 1  ON 28
ci_0030                -1.061604e-02 3 1  ON 29
ci_0031                 1.427126e-02 3 1  ON 30
ci_0032                 1.414989e-02 3 1  ON 31
ci_0033                 9.423136e-03 3 1  ON 32
ci_0034                 9.506960e-03 3 1  ON 33
ci_0035                 5.776717e-03 3 1  ON 34
ci_0036                 5.785845e-03 3 1  ON 35
ci_0037                -1.187307e-02 3 1  ON 36
ci_0038                -1.187094e-02 3 1  ON 37
ci_0039                -4.706801e-03 3 1  ON 38
ci_0040                -4.704992e-03 3 1  ON 39
ci_0041                 1.017086e-02 3 1  ON 40
ci_0042                 1.028983e-02 3 1  ON 41
ci_0043                -6.780086e-03 3 1  ON 42
ci_0044                -7.839958e-03 3 1  ON 43
ci_0045                 1.076363e-02 3 1  ON 44
ci_0046                 1.033027e-02 3 1  ON 45
ci_0047                -4.250209e-03 3 1  ON 46
ci_0048                -4.351215e-03 3 1  ON 47
ci_0049                -3.286065e-03 3 1  ON 48
ci_0050                -3.511891e-03 3 1  ON 49
ci_0051                -2.413568e-03 3 1  ON 50
ci_0052                -2.487840e-03 3 1  ON 51
ci_0053                -4.087842e-03 3 1  ON 52
ci_0054                -4.403786e-03 3 1  ON 53
ci_0055                 3.161098e-03 3 1  ON 54
ci_0056                 2.709531e-03 3 1  ON 55
ci_0057                 2.982269e-03 3 1  ON 56
ci_0058                 3.539018e-03 3 1  ON 57
ci_0059                -4.336999e-03 3 1  ON 58
ci_0060                -3.916578e-03 3 1  ON 59
ci_0061                -3.909579e-03 3 1  ON 60
ci_0062                -3.937284e-03 3 1  ON 61
ci_0063                -9.846280e-03 3 1  ON 62
ci_0064                -9.654113e-03 3 1  ON 63
ci_0065                -7.258241e-03 3 1  ON 64
ci_0066                -7.289259e-03 3 1  ON 65
ci_0067                -4.358780e-03 3 1  ON 66
ci_0068                -4.624390e-03 3 1  ON 67
ci_0069                 4.216473e-03 3 1  ON 68
ci_0070                 3.751391e-03 3 1  ON 69
ci_0071                 4.644656e-03 3 1  ON 70
ci_0072                 4.907183e-03 3 1  ON 71
ci_0073                 3.958473e-03 3 1  ON 72
ci_0074                 3.951807e-03 3 1  ON 73
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 58
    time step          = 0.05
    reference energy   = -16.9049
    reference variance = 0.354303
====================================================
  Execution time = 1.4770e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s058
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6903e+01
  VMC Evar = 3.1564e-01
  Total weights = 1.9515e+06
  Execution time = 1.9568e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.304616151173
                                         uncertainty =       0.001983334407

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.304616151173
                                         uncertainty =       0.001983334407

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000390261593
  error estimate for blocks of size 2^( 2) =       0.000404697893
  error estimate for blocks of size 2^( 3) =       0.000419125134
  error estimate for blocks of size 2^( 4) =       0.000433009046
  error estimate for blocks of size 2^( 5) =       0.000445076406
  error estimate for blocks of size 2^( 6) =       0.000454110771
  error estimate for blocks of size 2^( 7) =       0.000461929310

      target function =      -0.884983476882
              le_mean =     -16.903329398128
             les_mean =     286.038352791112
             stat err =       0.000448531383
             autocorr =       1.320912485181
   target nu stat err =       0.000448531383
   target dn stat err =       0.002668442347
      target stat err =       0.003413606675
              std dev =       0.551913237450
             le_variance =       0.304608221673

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.304421974091
                                         uncertainty =       0.001984316762

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.304421974091
                                         uncertainty =       0.001984316762

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000390137419
  error estimate for blocks of size 2^( 2) =       0.000404606067
  error estimate for blocks of size 2^( 3) =       0.000419067438
  error estimate for blocks of size 2^( 4) =       0.000432981542
  error estimate for blocks of size 2^( 5) =       0.000445065550
  error estimate for blocks of size 2^( 6) =       0.000454124538
  error estimate for blocks of size 2^( 7) =       0.000461941047

      target function =      -0.885044926950
              le_mean =     -16.903326957250
             les_mean =     286.038221023883
             stat err =       0.000448528169
             autocorr =       1.321734525555
   target nu stat err =       0.000448528169
   target dn stat err =       0.002678863286
      target stat err =       0.003426928102
              std dev =       0.551737628922
             le_variance =       0.304414411168

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.304503565357
                                         uncertainty =       0.001983727116

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.304503565357
                                         uncertainty =       0.001983727116

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000390189595
  error estimate for blocks of size 2^( 2) =       0.000404643557
  error estimate for blocks of size 2^( 3) =       0.000419089127
  error estimate for blocks of size 2^( 4) =       0.000432988885
  error estimate for blocks of size 2^( 5) =       0.000445066801
  error estimate for blocks of size 2^( 6) =       0.000454114084
  error estimate for blocks of size 2^( 7) =       0.000461931113

      target function =      -0.885296506075
              le_mean =     -16.903327590509
             les_mean =     286.038042602868
             stat err =       0.000448525221
             autocorr =       1.321363692483
   target nu stat err =       0.000448525221
   target dn stat err =       0.002652596762
      target stat err =       0.003396391128
              std dev =       0.551811417013
             le_variance =       0.304495839946

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.304600939839
                                         uncertainty =       0.001983370155

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.304600939839
                                         uncertainty =       0.001983370155

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000390251865
  error estimate for blocks of size 2^( 2) =       0.000404690420
  error estimate for blocks of size 2^( 3) =       0.000419120001
  error estimate for blocks of size 2^( 4) =       0.000433005908
  error estimate for blocks of size 2^( 5) =       0.000445074685
  error estimate for blocks of size 2^( 6) =       0.000454110715
  error estimate for blocks of size 2^( 7) =       0.000461929014

      target function =      -0.885062264708
              le_mean =     -16.903329091095
             les_mean =     286.038279711753
             stat err =       0.000448530081
             autocorr =       1.320970665038
   target nu stat err =       0.000448530081
   target dn stat err =       0.002665558462
      target stat err =       0.003410640466
              std dev =       0.551899480778
             le_variance =       0.304593036883


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.884983476882        initial
     6.1035e-01     6.1035e+00             4.7951e-04        -0.885044926950
     2.4414e+00     2.4414e+01             1.2506e-04        -0.885296506075  <--
     9.7656e+00     9.7656e+01             3.1604e-05        -0.885062264708

*****************************************************************************
Applying the update for shift_i =   2.4414e+00     and shift_s =   2.4414e+01
*****************************************************************************

  Execution time = 2.4690e+01
  </log>
  <optVariables href="H2O.s058.opt.xml">
ci_0001                 7.009446e-01 3 1  ON 0
ci_0002                 6.990404e-01 3 1  ON 1
ci_0003                -3.298828e-02 3 1  ON 2
ci_0004                -3.308810e-02 3 1  ON 3
ci_0005                -3.010292e-02 3 1  ON 4
ci_0006                -3.114154e-02 3 1  ON 5
ci_0007                -1.877669e-02 3 1  ON 6
ci_0008                -1.947343e-02 3 1  ON 7
ci_0009                -2.032057e-02 3 1  ON 8
ci_0010                -2.050074e-02 3 1  ON 9
ci_0011                -1.679419e-02 3 1  ON 10
ci_0012                -1.663317e-02 3 1  ON 11
ci_0013                 1.671538e-02 3 1  ON 12
ci_0014                 1.682639e-02 3 1  ON 13
ci_0015                 1.721253e-02 3 1  ON 14
ci_0016                 1.710832e-02 3 1  ON 15
ci_0017                 1.481023e-02 3 1  ON 16
ci_0018                 1.509859e-02 3 1  ON 17
ci_0019                 1.314969e-02 3 1  ON 18
ci_0020                 1.292890e-02 3 1  ON 19
ci_0021                 1.645275e-02 3 1  ON 20
ci_0022                 1.708643e-02 3 1  ON 21
ci_0023                -1.221615e-02 3 1  ON 22
ci_0024                -1.174345e-02 3 1  ON 23
ci_0025                -3.817015e-03 3 1  ON 24
ci_0026                -3.578537e-03 3 1  ON 25
ci_0027                -1.209563e-02 3 1  ON 26
ci_0028                -1.190246e-02 3 1  ON 27
ci_0029                -1.062881e-02 3 1  ON 28
ci_0030                -1.061604e-02 3 1  ON 29
ci_0031                 1.427126e-02 3 1  ON 30
ci_0032                 1.414989e-02 3 1  ON 31
ci_0033                 9.423136e-03 3 1  ON 32
ci_0034                 9.506960e-03 3 1  ON 33
ci_0035                 5.776717e-03 3 1  ON 34
ci_0036                 5.785845e-03 3 1  ON 35
ci_0037                -1.187307e-02 3 1  ON 36
ci_0038                -1.187094e-02 3 1  ON 37
ci_0039                -4.706801e-03 3 1  ON 38
ci_0040                -4.704992e-03 3 1  ON 39
ci_0041                 1.017086e-02 3 1  ON 40
ci_0042                 1.028983e-02 3 1  ON 41
ci_0043                -6.780086e-03 3 1  ON 42
ci_0044                -7.839958e-03 3 1  ON 43
ci_0045                 1.076363e-02 3 1  ON 44
ci_0046                 1.033027e-02 3 1  ON 45
ci_0047                -4.250209e-03 3 1  ON 46
ci_0048                -4.351215e-03 3 1  ON 47
ci_0049                -3.286065e-03 3 1  ON 48
ci_0050                -3.511891e-03 3 1  ON 49
ci_0051                -2.413568e-03 3 1  ON 50
ci_0052                -2.487840e-03 3 1  ON 51
ci_0053                -4.087842e-03 3 1  ON 52
ci_0054                -4.403786e-03 3 1  ON 53
ci_0055                 3.161098e-03 3 1  ON 54
ci_0056                 2.709531e-03 3 1  ON 55
ci_0057                 2.982269e-03 3 1  ON 56
ci_0058                 3.539018e-03 3 1  ON 57
ci_0059                -4.336999e-03 3 1  ON 58
ci_0060                -3.916578e-03 3 1  ON 59
ci_0061                -3.909579e-03 3 1  ON 60
ci_0062                -3.937284e-03 3 1  ON 61
ci_0063                -9.846280e-03 3 1  ON 62
ci_0064                -9.654113e-03 3 1  ON 63
ci_0065                -7.258241e-03 3 1  ON 64
ci_0066                -7.289259e-03 3 1  ON 65
ci_0067                -4.358780e-03 3 1  ON 66
ci_0068                -4.624390e-03 3 1  ON 67
ci_0069                 4.216473e-03 3 1  ON 68
ci_0070                 3.751391e-03 3 1  ON 69
ci_0071                 4.644656e-03 3 1  ON 70
ci_0072                 4.907183e-03 3 1  ON 71
ci_0073                 3.958473e-03 3 1  ON 72
ci_0074                 3.951807e-03 3 1  ON 73
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 4.2451e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s059 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s059 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=59  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6898e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 59
    time step          = 0.05
    reference energy   = -16.9241
    reference variance = 0.252554
====================================================
  Execution time = 1.5053e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s059
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5266e+04
  VMC Eavg = -1.6902e+01
  VMC Evar = 3.2472e-01
  Total weights = 1.951973347e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 2.6876e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.309470530502
                                         uncertainty =       0.002668508635

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.309470530502
                                         uncertainty =       0.002668508635

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000393630632
  error estimate for blocks of size 2^( 2) =       0.000408276507
  error estimate for blocks of size 2^( 3) =       0.000423260447
  error estimate for blocks of size 2^( 4) =       0.000437285839
  error estimate for blocks of size 2^( 5) =       0.000449240328
  error estimate for blocks of size 2^( 6) =       0.000460400423
  error estimate for blocks of size 2^( 7) =       0.000464346067

      target function =      -0.873778482652
              le_mean =     -16.902383722218
             les_mean =     286.015293929023
             stat err =       0.000452818164
             autocorr =       1.323335323622
   target nu stat err =       0.000452818164
   target dn stat err =       0.004839648192
      target stat err =       0.005954386171
              std dev =       0.556677777982
             le_variance =       0.309890148499


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690238372222e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 74
Check correct_vf_var_size: 225, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 6.1035e-01, overlap shift 6.1035e+00 and omega -1.7527e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.873817611838       residual = 2.64e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.873989504617       residual = 3.61e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.874013014749       residual = 1.16e-03           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.874020484281       residual = 4.26e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.874025569454       residual = 1.99e-04           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.874029051358       residual = 1.31e-04           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.874030480225       residual = 6.37e-05           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.874030447818       residual = 3.87e-05           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.874030960968       residual = 5.03e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.874032075645       residual = 3.36e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.874032947904       residual = 1.66e-05           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.874033216207       residual = 5.94e-06           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.874033536495       residual = 2.98e-06           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.874033611990       residual = 5.51e-07           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.874033646903       residual = 1.88e-07           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.874033666848       residual = 5.66e-08           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.874033656907       residual = 1.51e-08           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.874033661808       residual = 4.52e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         17 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 6.1035e-01 is 7.838167e-04

solving harmonic davidson linear method for identity shift 2.4414e+00, overlap shift 2.4414e+01 and omega -1.7527e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.873817611838       residual = 2.64e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.873864317638       residual = 3.55e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.873870590285       residual = 1.11e-03           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.873872529923       residual = 4.05e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.873873852380       residual = 1.87e-04           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.873874726084       residual = 1.17e-04           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.873875077245       residual = 5.71e-05           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.873875060989       residual = 3.59e-05           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.873875195245       residual = 4.61e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.873875471487       residual = 2.76e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.873875667836       residual = 1.24e-05           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.873875726935       residual = 4.32e-06           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.873875795771       residual = 2.02e-06           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.873875809375       residual = 3.51e-07           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.873875816721       residual = 1.18e-07           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.873875820650       residual = 3.54e-08           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.873875818424       residual = 9.10e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         16 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 2.4414e+00 is 1.974819e-04

solving harmonic davidson linear method for identity shift 9.7656e+00, overlap shift 9.7656e+01 and omega -1.7527e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.873817611838       residual = 2.64e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.873829547411       residual = 3.53e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.873831142251       residual = 1.10e-03           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.873831631710       residual = 4.00e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.873831965590       residual = 1.84e-04           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.873832183992       residual = 1.13e-04           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.873832271303       residual = 5.54e-05           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.873832266688       residual = 3.52e-05           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.873832300670       residual = 4.50e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.873832369458       residual = 2.61e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.873832417105       residual = 1.15e-05           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.873832431386       residual = 3.96e-06           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.873832447888       residual = 1.81e-06           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.873832450986       residual = 3.11e-07           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.873832452740       residual = 1.05e-07           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.873832453659       residual = 3.11e-08           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.873832453120       residual = 7.92e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         16 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 9.7656e+00 is 4.947533e-05

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.822799 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 75 and numParams is: 74

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.7755e+01
  </log>
  <optVariables href="H2O.s059.opt.xml">
ci_0001                 7.007857e-01 3 1  ON 0
ci_0002                 6.992379e-01 3 1  ON 1
ci_0003                -3.294527e-02 3 1  ON 2
ci_0004                -3.304995e-02 3 1  ON 3
ci_0005                -3.006717e-02 3 1  ON 4
ci_0006                -3.110042e-02 3 1  ON 5
ci_0007                -1.868504e-02 3 1  ON 6
ci_0008                -1.937788e-02 3 1  ON 7
ci_0009                -2.030685e-02 3 1  ON 8
ci_0010                -2.044208e-02 3 1  ON 9
ci_0011                -1.671239e-02 3 1  ON 10
ci_0012                -1.659017e-02 3 1  ON 11
ci_0013                 1.668235e-02 3 1  ON 12
ci_0014                 1.679590e-02 3 1  ON 13
ci_0015                 1.716911e-02 3 1  ON 14
ci_0016                 1.705350e-02 3 1  ON 15
ci_0017                 1.476900e-02 3 1  ON 16
ci_0018                 1.506318e-02 3 1  ON 17
ci_0019                 1.306235e-02 3 1  ON 18
ci_0020                 1.290354e-02 3 1  ON 19
ci_0021                 1.644336e-02 3 1  ON 20
ci_0022                 1.708350e-02 3 1  ON 21
ci_0023                -1.219207e-02 3 1  ON 22
ci_0024                -1.173696e-02 3 1  ON 23
ci_0025                -3.760886e-03 3 1  ON 24
ci_0026                -3.506950e-03 3 1  ON 25
ci_0027                -1.208958e-02 3 1  ON 26
ci_0028                -1.189672e-02 3 1  ON 27
ci_0029                -1.060000e-02 3 1  ON 28
ci_0030                -1.056668e-02 3 1  ON 29
ci_0031                 1.426043e-02 3 1  ON 30
ci_0032                 1.413274e-02 3 1  ON 31
ci_0033                 9.366801e-03 3 1  ON 32
ci_0034                 9.466031e-03 3 1  ON 33
ci_0035                 5.776099e-03 3 1  ON 34
ci_0036                 5.737720e-03 3 1  ON 35
ci_0037                -1.186651e-02 3 1  ON 36
ci_0038                -1.185727e-02 3 1  ON 37
ci_0039                -4.690394e-03 3 1  ON 38
ci_0040                -4.686604e-03 3 1  ON 39
ci_0041                 1.014836e-02 3 1  ON 40
ci_0042                 1.027192e-02 3 1  ON 41
ci_0043                -6.651092e-03 3 1  ON 42
ci_0044                -7.852624e-03 3 1  ON 43
ci_0045                 1.075723e-02 3 1  ON 44
ci_0046                 1.030080e-02 3 1  ON 45
ci_0047                -4.229118e-03 3 1  ON 46
ci_0048                -4.304705e-03 3 1  ON 47
ci_0049                -3.228820e-03 3 1  ON 48
ci_0050                -3.468851e-03 3 1  ON 49
ci_0051                -2.389614e-03 3 1  ON 50
ci_0052                -2.464793e-03 3 1  ON 51
ci_0053                -4.097090e-03 3 1  ON 52
ci_0054                -4.352903e-03 3 1  ON 53
ci_0055                 3.146292e-03 3 1  ON 54
ci_0056                 2.677706e-03 3 1  ON 55
ci_0057                 2.942545e-03 3 1  ON 56
ci_0058                 3.492319e-03 3 1  ON 57
ci_0059                -4.343293e-03 3 1  ON 58
ci_0060                -3.922826e-03 3 1  ON 59
ci_0061                -3.870363e-03 3 1  ON 60
ci_0062                -3.902731e-03 3 1  ON 61
ci_0063                -9.835775e-03 3 1  ON 62
ci_0064                -9.637994e-03 3 1  ON 63
ci_0065                -7.245019e-03 3 1  ON 64
ci_0066                -7.265916e-03 3 1  ON 65
ci_0067                -4.325247e-03 3 1  ON 66
ci_0068                -4.642040e-03 3 1  ON 67
ci_0069                 4.180363e-03 3 1  ON 68
ci_0070                 3.705970e-03 3 1  ON 69
ci_0071                 4.608951e-03 3 1  ON 70
ci_0072                 4.797528e-03 3 1  ON 71
ci_0073                 3.940789e-03 3 1  ON 72
ci_0074                 3.899002e-03 3 1  ON 73
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 59
    time step          = 0.05
    reference energy   = -16.8637
    reference variance = 0.204435
====================================================
  Execution time = 1.5937e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s059
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6904e+01
  VMC Evar = 3.1761e-01
  Total weights = 1.9518e+06
  Execution time = 2.2073e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.304446755796
                                         uncertainty =       0.001994907119

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.304446755796
                                         uncertainty =       0.001994907119

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000390114861
  error estimate for blocks of size 2^( 2) =       0.000404368707
  error estimate for blocks of size 2^( 3) =       0.000419010679
  error estimate for blocks of size 2^( 4) =       0.000431943229
  error estimate for blocks of size 2^( 5) =       0.000443369187
  error estimate for blocks of size 2^( 6) =       0.000449437558
  error estimate for blocks of size 2^( 7) =       0.000454343598

      target function =      -0.882660043624
              le_mean =     -16.903523388931
             les_mean =     286.046781933558
             stat err =       0.000444773393
             autocorr =       1.299848114080
   target nu stat err =       0.000444773393
   target dn stat err =       0.003220585952
      target stat err =       0.004076632746
              std dev =       0.551705727710
             le_variance =       0.304379209988

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.304233954759
                                         uncertainty =       0.001993664386

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.304233954759
                                         uncertainty =       0.001993664386

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000389978695
  error estimate for blocks of size 2^( 2) =       0.000404260015
  error estimate for blocks of size 2^( 3) =       0.000418934465
  error estimate for blocks of size 2^( 4) =       0.000431895479
  error estimate for blocks of size 2^( 5) =       0.000443331721
  error estimate for blocks of size 2^( 6) =       0.000449414594
  error estimate for blocks of size 2^( 7) =       0.000454336199

      target function =      -0.882823115494
              le_mean =     -16.903521893651
             les_mean =     286.046600660587
             stat err =       0.000444744498
             autocorr =       1.300586991386
   target nu stat err =       0.000444744498
   target dn stat err =       0.003240576565
      target stat err =       0.004102816730
              std dev =       0.551513159238
             le_variance =       0.304166764813

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.304325356932
                                         uncertainty =       0.001993995764

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.304325356932
                                         uncertainty =       0.001993995764

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000390037180
  error estimate for blocks of size 2^( 2) =       0.000404305719
  error estimate for blocks of size 2^( 3) =       0.000418965149
  error estimate for blocks of size 2^( 4) =       0.000431913305
  error estimate for blocks of size 2^( 5) =       0.000443345233
  error estimate for blocks of size 2^( 6) =       0.000449422050
  error estimate for blocks of size 2^( 7) =       0.000454337719

      target function =      -0.877550123442
              le_mean =     -16.903521212923
             les_mean =     286.050805742753
             stat err =       0.000444754577
             autocorr =       1.300255906927
   target nu stat err =       0.000444754577
   target dn stat err =       0.004377594126
      target stat err =       0.005447590451
              std dev =       0.551595870445
             le_variance =       0.304258004292

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.304430332634
                                         uncertainty =       0.001994748932

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.304430332634
                                         uncertainty =       0.001994748932

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000390104353
  error estimate for blocks of size 2^( 2) =       0.000404360067
  error estimate for blocks of size 2^( 3) =       0.000419004266
  error estimate for blocks of size 2^( 4) =       0.000431938833
  error estimate for blocks of size 2^( 5) =       0.000443365538
  error estimate for blocks of size 2^( 6) =       0.000449434900
  error estimate for blocks of size 2^( 7) =       0.000454342003

      target function =      -0.882697318367
              le_mean =     -16.903523047201
             les_mean =     286.046740529999
             stat err =       0.000444770319
             autocorr =       1.299900175816
   target nu stat err =       0.000444770319
   target dn stat err =       0.003221335651
      target stat err =       0.004077896464
              std dev =       0.551690866170
             le_variance =       0.304362811815


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.882660043624        initial
     6.1035e-01     6.1035e+00             7.8382e-04        -0.882823115494  <--
     2.4414e+00     2.4414e+01             1.9748e-04        -0.877550123442
     9.7656e+00     9.7656e+01             4.9475e-05        -0.882697318367

*****************************************************************************
Applying the update for shift_i =   6.1035e-01     and shift_s =   6.1035e+00
*****************************************************************************

  Execution time = 2.6058e+01
  </log>
  <optVariables href="H2O.s059.opt.xml">
ci_0001                 7.003053e-01 3 1  ON 0
ci_0002                 6.998242e-01 3 1  ON 1
ci_0003                -3.282563e-02 3 1  ON 2
ci_0004                -3.294742e-02 3 1  ON 3
ci_0005                -2.996631e-02 3 1  ON 4
ci_0006                -3.098707e-02 3 1  ON 5
ci_0007                -1.842582e-02 3 1  ON 6
ci_0008                -1.910816e-02 3 1  ON 7
ci_0009                -2.026823e-02 3 1  ON 8
ci_0010                -2.028385e-02 3 1  ON 9
ci_0011                -1.648811e-02 3 1  ON 10
ci_0012                -1.647379e-02 3 1  ON 11
ci_0013                 1.659147e-02 3 1  ON 12
ci_0014                 1.671385e-02 3 1  ON 13
ci_0015                 1.704959e-02 3 1  ON 14
ci_0016                 1.690500e-02 3 1  ON 15
ci_0017                 1.465623e-02 3 1  ON 16
ci_0018                 1.496783e-02 3 1  ON 17
ci_0019                 1.282337e-02 3 1  ON 18
ci_0020                 1.283545e-02 3 1  ON 19
ci_0021                 1.641370e-02 3 1  ON 20
ci_0022                 1.707498e-02 3 1  ON 21
ci_0023                -1.212645e-02 3 1  ON 22
ci_0024                -1.172032e-02 3 1  ON 23
ci_0025                -3.609750e-03 3 1  ON 24
ci_0026                -3.315174e-03 3 1  ON 25
ci_0027                -1.207269e-02 3 1  ON 26
ci_0028                -1.188305e-02 3 1  ON 27
ci_0029                -1.052149e-02 3 1  ON 28
ci_0030                -1.043338e-02 3 1  ON 29
ci_0031                 1.422972e-02 3 1  ON 30
ci_0032                 1.408463e-02 3 1  ON 31
ci_0033                 9.209407e-03 3 1  ON 32
ci_0034                 9.352886e-03 3 1  ON 33
ci_0035                 5.774112e-03 3 1  ON 34
ci_0036                 5.609159e-03 3 1  ON 35
ci_0037                -1.184778e-02 3 1  ON 36
ci_0038                -1.182013e-02 3 1  ON 37
ci_0039                -4.645710e-03 3 1  ON 38
ci_0040                -4.637266e-03 3 1  ON 39
ci_0041                 1.008592e-02 3 1  ON 40
ci_0042                 1.022336e-02 3 1  ON 41
ci_0043                -6.288162e-03 3 1  ON 42
ci_0044                -7.889401e-03 3 1  ON 43
ci_0045                 1.073900e-02 3 1  ON 44
ci_0046                 1.021969e-02 3 1  ON 45
ci_0047                -4.172042e-03 3 1  ON 46
ci_0048                -4.179696e-03 3 1  ON 47
ci_0049                -3.075484e-03 3 1  ON 48
ci_0050                -3.354028e-03 3 1  ON 49
ci_0051                -2.325725e-03 3 1  ON 50
ci_0052                -2.403428e-03 3 1  ON 51
ci_0053                -4.121317e-03 3 1  ON 52
ci_0054                -4.216718e-03 3 1  ON 53
ci_0055                 3.106714e-03 3 1  ON 54
ci_0056                 2.592980e-03 3 1  ON 55
ci_0057                 2.835845e-03 3 1  ON 56
ci_0058                 3.367220e-03 3 1  ON 57
ci_0059                -4.359805e-03 3 1  ON 58
ci_0060                -3.939759e-03 3 1  ON 59
ci_0061                -3.763059e-03 3 1  ON 60
ci_0062                -3.808699e-03 3 1  ON 61
ci_0063                -9.806686e-03 3 1  ON 62
ci_0064                -9.594662e-03 3 1  ON 63
ci_0065                -7.208607e-03 3 1  ON 64
ci_0066                -7.202699e-03 3 1  ON 65
ci_0067                -4.235388e-03 3 1  ON 66
ci_0068                -4.689487e-03 3 1  ON 67
ci_0069                 4.083498e-03 3 1  ON 68
ci_0070                 3.584377e-03 3 1  ON 69
ci_0071                 4.512831e-03 3 1  ON 70
ci_0072                 4.504304e-03 3 1  ON 71
ci_0073                 3.893040e-03 3 1  ON 72
ci_0074                 3.758496e-03 3 1  ON 73
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 4.3819e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s060 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s060 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=60  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6898e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 60
    time step          = 0.05
    reference energy   = -16.8924
    reference variance = 0.621972
====================================================
  Execution time = 1.4900e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s060
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5262e+04
  VMC Eavg = -1.6903e+01
  VMC Evar = 3.1351e-01
  Total weights = 1.951471971e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 2.6815e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.303046405569
                                         uncertainty =       0.001527730819

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.303046405569
                                         uncertainty =       0.001527730819

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000389292212
  error estimate for blocks of size 2^( 2) =       0.000403415785
  error estimate for blocks of size 2^( 3) =       0.000417701958
  error estimate for blocks of size 2^( 4) =       0.000431090475
  error estimate for blocks of size 2^( 5) =       0.000442372373
  error estimate for blocks of size 2^( 6) =       0.000451406870
  error estimate for blocks of size 2^( 7) =       0.000454233434

      target function =      -0.887838107894
              le_mean =     -16.903035916473
             les_mean =     286.026134932627
             stat err =       0.000444775788
             autocorr =       1.305361632499
   target nu stat err =       0.000444775788
   target dn stat err =       0.002210934898
      target stat err =       0.002866148944
              std dev =       0.550542326451
             le_variance =       0.303096853215


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690303591647e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 74
Check correct_vf_var_size: 225, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.5259e-01, overlap shift 1.5259e+00 and omega -1.7527e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.887846283243       residual = 1.63e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.888138463846       residual = 3.81e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.888218630474       residual = 1.14e-03           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.888245870579       residual = 4.53e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.888258590558       residual = 2.90e-04           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.888262815665       residual = 1.23e-04           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.888266319032       residual = 3.55e-05           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.888266756320       residual = 1.15e-05           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.888266591057       residual = 5.59e-06           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.888266599452       residual = 2.09e-06           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.888266481848       residual = 2.05e-06           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.888266384647       residual = 1.08e-06           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.888266450487       residual = 1.49e-06           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.888266504909       residual = 1.10e-06           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.888266861210       residual = 7.21e-07           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.888266831561       residual = 1.88e-07           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.888266955982       residual = 5.86e-08           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.888266991220       residual = 2.48e-08           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.888266973913       residual = 5.98e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         18 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 1.5259e-01 is 1.256379e-03

solving harmonic davidson linear method for identity shift 6.1035e-01, overlap shift 6.1035e+00 and omega -1.7527e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.887846283243       residual = 1.63e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.887943367215       residual = 3.63e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.887968640944       residual = 1.03e-03           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.887976587335       residual = 3.81e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.887980212966       residual = 2.38e-04           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.887981198848       residual = 8.80e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.887982034503       residual = 2.37e-05           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.887982114092       residual = 7.21e-06           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.887982055469       residual = 3.49e-06           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.887982055515       residual = 1.39e-06           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.887982027373       residual = 1.29e-06           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.887982006190       residual = 7.75e-07           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.887982033761       residual = 9.24e-07           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.887982057823       residual = 4.59e-07           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.887982122871       residual = 2.08e-07           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.887982113883       residual = 4.34e-08           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.887982133662       residual = 1.45e-08           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.887982136265       residual = 4.86e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         17 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 6.1035e-01 is 3.797268e-04

solving harmonic davidson linear method for identity shift 2.4414e+00, overlap shift 2.4414e+01 and omega -1.7527e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.887846283243       residual = 1.63e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.887872729380       residual = 3.57e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.887879483444       residual = 9.93e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.887881548022       residual = 3.58e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.887882482968       residual = 2.22e-04           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.887882717609       residual = 7.80e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.887882920497       residual = 2.06e-05           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.887882937628       residual = 6.12e-06           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.887882921795       residual = 2.97e-06           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.887882921803       residual = 1.22e-06           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.887882915094       residual = 1.10e-06           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.887882910194       residual = 6.92e-07           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.887882918059       residual = 7.57e-07           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.887882924456       residual = 3.29e-07           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.887882938572       residual = 1.34e-07           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.887882936434       residual = 2.66e-08           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.887882940652       residual = 9.07e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         16 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 2.4414e+00 is 1.001783e-04

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.833148 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 75 and numParams is: 74

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.7597e+01
  </log>
  <optVariables href="H2O.s060.opt.xml">
ci_0001                 7.005192e-01 3 1  ON 0
ci_0002                 6.997587e-01 3 1  ON 1
ci_0003                -3.267269e-02 3 1  ON 2
ci_0004                -3.269609e-02 3 1  ON 3
ci_0005                -2.958658e-02 3 1  ON 4
ci_0006                -3.078967e-02 3 1  ON 5
ci_0007                -1.821032e-02 3 1  ON 6
ci_0008                -1.880416e-02 3 1  ON 7
ci_0009                -2.002770e-02 3 1  ON 8
ci_0010                -2.010329e-02 3 1  ON 9
ci_0011                -1.631467e-02 3 1  ON 10
ci_0012                -1.632782e-02 3 1  ON 11
ci_0013                 1.641699e-02 3 1  ON 12
ci_0014                 1.652209e-02 3 1  ON 13
ci_0015                 1.696231e-02 3 1  ON 14
ci_0016                 1.682644e-02 3 1  ON 15
ci_0017                 1.456190e-02 3 1  ON 16
ci_0018                 1.482904e-02 3 1  ON 17
ci_0019                 1.271062e-02 3 1  ON 18
ci_0020                 1.272590e-02 3 1  ON 19
ci_0021                 1.615893e-02 3 1  ON 20
ci_0022                 1.699364e-02 3 1  ON 21
ci_0023                -1.204204e-02 3 1  ON 22
ci_0024                -1.163191e-02 3 1  ON 23
ci_0025                -3.567158e-03 3 1  ON 24
ci_0026                -3.219109e-03 3 1  ON 25
ci_0027                -1.198486e-02 3 1  ON 26
ci_0028                -1.188631e-02 3 1  ON 27
ci_0029                -1.051511e-02 3 1  ON 28
ci_0030                -1.037495e-02 3 1  ON 29
ci_0031                 1.420207e-02 3 1  ON 30
ci_0032                 1.393544e-02 3 1  ON 31
ci_0033                 8.931795e-03 3 1  ON 32
ci_0034                 9.099413e-03 3 1  ON 33
ci_0035                 5.789409e-03 3 1  ON 34
ci_0036                 5.482602e-03 3 1  ON 35
ci_0037                -1.174098e-02 3 1  ON 36
ci_0038                -1.174404e-02 3 1  ON 37
ci_0039                -4.500798e-03 3 1  ON 38
ci_0040                -4.503100e-03 3 1  ON 39
ci_0041                 1.006422e-02 3 1  ON 40
ci_0042                 1.013321e-02 3 1  ON 41
ci_0043                -6.309714e-03 3 1  ON 42
ci_0044                -7.640997e-03 3 1  ON 43
ci_0045                 1.065428e-02 3 1  ON 44
ci_0046                 1.010298e-02 3 1  ON 45
ci_0047                -4.042658e-03 3 1  ON 46
ci_0048                -4.096486e-03 3 1  ON 47
ci_0049                -2.952481e-03 3 1  ON 48
ci_0050                -3.206413e-03 3 1  ON 49
ci_0051                -2.239345e-03 3 1  ON 50
ci_0052                -2.249064e-03 3 1  ON 51
ci_0053                -4.155100e-03 3 1  ON 52
ci_0054                -4.126558e-03 3 1  ON 53
ci_0055                 2.845275e-03 3 1  ON 54
ci_0056                 2.617280e-03 3 1  ON 55
ci_0057                 2.768865e-03 3 1  ON 56
ci_0058                 3.346153e-03 3 1  ON 57
ci_0059                -4.250081e-03 3 1  ON 58
ci_0060                -3.904050e-03 3 1  ON 59
ci_0061                -3.607091e-03 3 1  ON 60
ci_0062                -3.722294e-03 3 1  ON 61
ci_0063                -9.763151e-03 3 1  ON 62
ci_0064                -9.620890e-03 3 1  ON 63
ci_0065                -7.168531e-03 3 1  ON 64
ci_0066                -7.118957e-03 3 1  ON 65
ci_0067                -4.158577e-03 3 1  ON 66
ci_0068                -4.546718e-03 3 1  ON 67
ci_0069                 4.030142e-03 3 1  ON 68
ci_0070                 3.586767e-03 3 1  ON 69
ci_0071                 4.457425e-03 3 1  ON 70
ci_0072                 4.529552e-03 3 1  ON 71
ci_0073                 3.811102e-03 3 1  ON 72
ci_0074                 3.720953e-03 3 1  ON 73
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 60
    time step          = 0.05
    reference energy   = -16.8963
    reference variance = 0.126026
====================================================
  Execution time = 1.4772e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s060
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6904e+01
  VMC Evar = 3.2173e-01
  Total weights = 1.9513e+06
  Execution time = 1.9525e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.309219759869
                                         uncertainty =       0.003387077027

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.309219759869
                                         uncertainty =       0.003387077027

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000393180404
  error estimate for blocks of size 2^( 2) =       0.000407428792
  error estimate for blocks of size 2^( 3) =       0.000421891299
  error estimate for blocks of size 2^( 4) =       0.000434674999
  error estimate for blocks of size 2^( 5) =       0.000444635757
  error estimate for blocks of size 2^( 6) =       0.000451402360
  error estimate for blocks of size 2^( 7) =       0.000451767459

      target function =      -0.875092649474
              le_mean =     -16.903862606468
             les_mean =     286.064370053172
             stat err =       0.000445620144
             autocorr =       1.284534875565
   target nu stat err =       0.000445620144
   target dn stat err =       0.004841508575
      target stat err =       0.005987608305
              std dev =       0.556041059665
             le_variance =       0.309181660033

ERROR CostFunction-> Number of Effective Walkers is too small! 
  Number of effective walkers (samples) / total number of samples = 0.244031
  User specified threshold minwalkers = 0.3
  If this message appears frequently. You might have to be cautious. 
  Find info about parameter "minwalkers" in the user manual!
Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.308604812548
                                         uncertainty =       0.003324208471

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.308604812548
                                         uncertainty =       0.003324208471

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000392789280
  error estimate for blocks of size 2^( 2) =       0.000407137287
  error estimate for blocks of size 2^( 3) =       0.000421709432
  error estimate for blocks of size 2^( 4) =       0.000434590589
  error estimate for blocks of size 2^( 5) =       0.000444621780
  error estimate for blocks of size 2^( 6) =       0.000451405085
  error estimate for blocks of size 2^( 7) =       0.000451787989

      target function =      -0.879557190545
              le_mean =     -16.903875227932
             les_mean =     286.061202194238
             stat err =       0.000445601361
             autocorr =       1.286985823386
   target nu stat err =       0.000445601361
   target dn stat err =       0.003495671343
      target stat err =       0.004388815715
              std dev =       0.555487927519
             le_variance =       0.308566837620

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.308780799879
                                         uncertainty =       0.003344695489

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.308780799879
                                         uncertainty =       0.003344695489

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000392901212
  error estimate for blocks of size 2^( 2) =       0.000407213162
  error estimate for blocks of size 2^( 3) =       0.000421745832
  error estimate for blocks of size 2^( 4) =       0.000434591341
  error estimate for blocks of size 2^( 5) =       0.000444595698
  error estimate for blocks of size 2^( 6) =       0.000451374565
  error estimate for blocks of size 2^( 7) =       0.000451751281

      target function =      -0.870161763185
              le_mean =     -16.903864829328
             les_mean =     286.068394929737
             stat err =       0.000445578221
             autocorr =       1.286119057967
   target nu stat err =       0.000445578221
   target dn stat err =       0.009088243978
      target stat err =       0.011071214626
              std dev =       0.555646223050
             le_variance =       0.308742725189

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.309152690339
                                         uncertainty =       0.003381191872

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.309152690339
                                         uncertainty =       0.003381191872

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000393137759
  error estimate for blocks of size 2^( 2) =       0.000407395540
  error estimate for blocks of size 2^( 3) =       0.000421868000
  error estimate for blocks of size 2^( 4) =       0.000434660159
  error estimate for blocks of size 2^( 5) =       0.000444627964
  error estimate for blocks of size 2^( 6) =       0.000451399484
  error estimate for blocks of size 2^( 7) =       0.000451761898

      target function =      -0.832395514681
              le_mean =     -16.903860149950
             les_mean =     286.098947845641
             stat err =       0.000445612376
             autocorr =       1.284768776986
   target nu stat err =       0.000445612376
   target dn stat err =       0.037363270328
      target stat err =       0.041685905014
              std dev =       0.555980750222
             le_variance =       0.309114594617


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.875092649474        initial
     1.5259e-01     1.5259e+00             1.2564e-03        -0.879557190545  <--
     6.1035e-01     6.1035e+00             3.7973e-04        -0.870161763185
     2.4414e+00     2.4414e+01             1.0018e-04        -0.832395514681

*****************************************************************************
Applying the update for shift_i =   1.5259e-01     and shift_s =   1.5259e+00
*****************************************************************************

  Execution time = 2.4704e+01
  </log>
  <optVariables href="H2O.s060.opt.xml">
ci_0001                 7.011000e-01 3 1  ON 0
ci_0002                 6.995072e-01 3 1  ON 1
ci_0003                -3.234682e-02 3 1  ON 2
ci_0004                -3.214186e-02 3 1  ON 3
ci_0005                -2.870993e-02 3 1  ON 4
ci_0006                -3.033053e-02 3 1  ON 5
ci_0007                -1.769402e-02 3 1  ON 6
ci_0008                -1.806300e-02 3 1  ON 7
ci_0009                -1.952136e-02 3 1  ON 8
ci_0010                -1.971951e-02 3 1  ON 9
ci_0011                -1.594471e-02 3 1  ON 10
ci_0012                -1.601478e-02 3 1  ON 11
ci_0013                 1.604819e-02 3 1  ON 12
ci_0014                 1.611126e-02 3 1  ON 13
ci_0015                 1.678113e-02 3 1  ON 14
ci_0016                 1.665726e-02 3 1  ON 15
ci_0017                 1.436577e-02 3 1  ON 16
ci_0018                 1.453252e-02 3 1  ON 17
ci_0019                 1.247584e-02 3 1  ON 18
ci_0020                 1.249676e-02 3 1  ON 19
ci_0021                 1.553618e-02 3 1  ON 20
ci_0022                 1.678134e-02 3 1  ON 21
ci_0023                -1.186986e-02 3 1  ON 22
ci_0024                -1.144714e-02 3 1  ON 23
ci_0025                -3.481762e-03 3 1  ON 24
ci_0026                -3.021857e-03 3 1  ON 25
ci_0027                -1.180411e-02 3 1  ON 26
ci_0028                -1.189792e-02 3 1  ON 27
ci_0029                -1.051490e-02 3 1  ON 28
ci_0030                -1.025795e-02 3 1  ON 29
ci_0031                 1.414102e-02 3 1  ON 30
ci_0032                 1.357458e-02 3 1  ON 31
ci_0033                 8.296142e-03 3 1  ON 32
ci_0034                 8.517739e-03 3 1  ON 33
ci_0035                 5.820313e-03 3 1  ON 34
ci_0036                 5.228099e-03 3 1  ON 35
ci_0037                -1.150763e-02 3 1  ON 36
ci_0038                -1.157445e-02 3 1  ON 37
ci_0039                -4.204414e-03 3 1  ON 38
ci_0040                -4.228088e-03 3 1  ON 39
ci_0041                 1.001951e-02 3 1  ON 40
ci_0042                 9.934699e-03 3 1  ON 41
ci_0043                -6.364572e-03 3 1  ON 42
ci_0044                -7.051742e-03 3 1  ON 43
ci_0045                 1.046136e-02 3 1  ON 44
ci_0046                 9.838507e-03 3 1  ON 45
ci_0047                -3.777990e-03 3 1  ON 46
ci_0048                -3.925663e-03 3 1  ON 47
ci_0049                -2.707665e-03 3 1  ON 48
ci_0050                -2.913084e-03 3 1  ON 49
ci_0051                -2.069222e-03 3 1  ON 50
ci_0052                -1.944158e-03 3 1  ON 51
ci_0053                -4.224193e-03 3 1  ON 52
ci_0054                -3.945511e-03 3 1  ON 53
ci_0055                 2.319933e-03 3 1  ON 54
ci_0056                 2.666760e-03 3 1  ON 55
ci_0057                 2.630497e-03 3 1  ON 56
ci_0058                 3.300969e-03 3 1  ON 57
ci_0059                -4.031483e-03 3 1  ON 58
ci_0060                -3.831120e-03 3 1  ON 59
ci_0061                -3.275802e-03 3 1  ON 60
ci_0062                -3.538684e-03 3 1  ON 61
ci_0063                -9.672070e-03 3 1  ON 62
ci_0064                -9.676714e-03 3 1  ON 63
ci_0065                -7.084399e-03 3 1  ON 64
ci_0066                -6.940046e-03 3 1  ON 65
ci_0067                -4.004541e-03 3 1  ON 66
ci_0068                -4.260791e-03 3 1  ON 67
ci_0069                 3.924033e-03 3 1  ON 68
ci_0070                 3.589649e-03 3 1  ON 69
ci_0071                 4.345778e-03 3 1  ON 70
ci_0072                 4.576578e-03 3 1  ON 71
ci_0073                 3.646909e-03 3 1  ON 72
ci_0074                 3.645477e-03 3 1  ON 73
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 4.2311e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s061 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s061 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=61  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6898e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 61
    time step          = 0.05
    reference energy   = -16.8708
    reference variance = 0.132394
====================================================
  Execution time = 1.5016e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s061
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5251e+04
  VMC Eavg = -1.6904e+01
  VMC Evar = 3.1111e-01
  Total weights = 1.951550681e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 2.6815e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.301986058096
                                         uncertainty =       0.001617685967

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.301986058096
                                         uncertainty =       0.001617685967

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000388649627
  error estimate for blocks of size 2^( 2) =       0.000403371114
  error estimate for blocks of size 2^( 3) =       0.000418367756
  error estimate for blocks of size 2^( 4) =       0.000431984336
  error estimate for blocks of size 2^( 5) =       0.000442410671
  error estimate for blocks of size 2^( 6) =       0.000449904273
  error estimate for blocks of size 2^( 7) =       0.000454599375

      target function =      -0.890992082301
              le_mean =     -16.903698522420
             les_mean =     286.046132792726
             stat err =       0.000444724664
             autocorr =       1.309380655066
   target nu stat err =       0.000444724664
   target dn stat err =       0.002033573778
      target stat err =       0.002669040873
              std dev =       0.549633573669
             le_variance =       0.302097065304


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690369852242e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 74
Check correct_vf_var_size: 225, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 3.8147e-02, overlap shift 3.8147e-01 and omega -1.7527e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.890999030663       residual = 1.17e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.891456360691       residual = 2.63e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.891564818756       residual = 7.47e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.891597850559       residual = 2.42e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.891617052130       residual = 1.44e-04           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.891632085877       residual = 1.21e-04           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.891636781526       residual = 6.21e-05           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.891642297951       residual = 2.65e-05           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.891646217906       residual = 1.84e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.891649254806       residual = 1.92e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.891650674839       residual = 3.13e-05           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.891651556831       residual = 2.40e-05           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.891653650244       residual = 2.97e-05           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.891654211706       residual = 1.07e-05           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.891655244946       residual = 4.16e-06           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.891656194007       residual = 1.24e-06           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.891656205620       residual = 3.47e-07           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.891656219783       residual = 1.40e-07           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.891656125023       residual = 5.10e-08           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.891656093195       residual = 2.27e-08           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.891656095282       residual = 6.69e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         20 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 3.8147e-02 is 5.901099e-03

solving harmonic davidson linear method for identity shift 1.5259e-01, overlap shift 1.5259e+00 and omega -1.7527e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.890999030663       residual = 1.17e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.891225724648       residual = 2.44e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.891275384363       residual = 6.30e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.891288653214       residual = 1.91e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.891296332867       residual = 1.06e-04           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.891301615595       residual = 7.29e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.891302871533       residual = 3.51e-05           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.891304502692       residual = 1.43e-05           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.891305596431       residual = 1.06e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.891306489042       residual = 1.27e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.891306400805       residual = 1.18e-05           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.891306347379       residual = 6.37e-06           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.891306574738       residual = 3.88e-06           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.891306580383       residual = 8.95e-07           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.891306681266       residual = 2.60e-07           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.891306752881       residual = 6.85e-08           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.891306748175       residual = 2.09e-08           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.891306747164       residual = 6.78e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         17 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 1.5259e-01 is 1.543649e-03

solving harmonic davidson linear method for identity shift 6.1035e-01, overlap shift 6.1035e+00 and omega -1.7527e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.890999030663       residual = 1.17e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.891074155153       residual = 2.32e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.891089762229       residual = 5.62e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.891093583947       residual = 1.64e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.891095805303       residual = 8.68e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.891097210439       residual = 5.28e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.891097487331       residual = 2.46e-05           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.891097887441       residual = 1.01e-05           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.891098143836       residual = 7.95e-06           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.891098348620       residual = 9.34e-06           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.891098255924       residual = 6.01e-06           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.891098225385       residual = 2.73e-06           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.891098265792       residual = 1.13e-06           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.891098268955       residual = 2.33e-07           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.891098284364       residual = 6.02e-08           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.891098292369       residual = 1.52e-08           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.891098291477       residual = 4.70e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         16 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 6.1035e-01 is 3.958884e-04

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.850122 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 75 and numParams is: 74

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.7723e+01
  </log>
  <optVariables href="H2O.s061.opt.xml">
ci_0001                 7.026437e-01 3 1  ON 0
ci_0002                 6.983036e-01 3 1  ON 1
ci_0003                -3.183896e-02 3 1  ON 2
ci_0004                -3.151306e-02 3 1  ON 3
ci_0005                -2.844487e-02 3 1  ON 4
ci_0006                -2.963802e-02 3 1  ON 5
ci_0007                -1.648878e-02 3 1  ON 6
ci_0008                -1.725217e-02 3 1  ON 7
ci_0009                -1.896474e-02 3 1  ON 8
ci_0010                -1.911280e-02 3 1  ON 9
ci_0011                -1.578971e-02 3 1  ON 10
ci_0012                -1.580838e-02 3 1  ON 11
ci_0013                 1.569429e-02 3 1  ON 12
ci_0014                 1.562287e-02 3 1  ON 13
ci_0015                 1.648970e-02 3 1  ON 14
ci_0016                 1.620364e-02 3 1  ON 15
ci_0017                 1.384980e-02 3 1  ON 16
ci_0018                 1.417636e-02 3 1  ON 17
ci_0019                 1.243616e-02 3 1  ON 18
ci_0020                 1.205113e-02 3 1  ON 19
ci_0021                 1.539472e-02 3 1  ON 20
ci_0022                 1.640715e-02 3 1  ON 21
ci_0023                -1.179533e-02 3 1  ON 22
ci_0024                -1.104125e-02 3 1  ON 23
ci_0025                -3.006528e-03 3 1  ON 24
ci_0026                -2.667583e-03 3 1  ON 25
ci_0027                -1.175721e-02 3 1  ON 26
ci_0028                -1.173383e-02 3 1  ON 27
ci_0029                -1.035143e-02 3 1  ON 28
ci_0030                -1.029384e-02 3 1  ON 29
ci_0031                 1.406532e-02 3 1  ON 30
ci_0032                 1.309504e-02 3 1  ON 31
ci_0033                 8.466399e-03 3 1  ON 32
ci_0034                 8.682270e-03 3 1  ON 33
ci_0035                 5.055912e-03 3 1  ON 34
ci_0036                 4.824602e-03 3 1  ON 35
ci_0037                -1.143137e-02 3 1  ON 36
ci_0038                -1.141895e-02 3 1  ON 37
ci_0039                -3.807349e-03 3 1  ON 38
ci_0040                -3.935980e-03 3 1  ON 39
ci_0041                 9.637431e-03 3 1  ON 40
ci_0042                 9.535254e-03 3 1  ON 41
ci_0043                -6.347960e-03 3 1  ON 42
ci_0044                -6.781271e-03 3 1  ON 43
ci_0045                 1.048193e-02 3 1  ON 44
ci_0046                 9.369287e-03 3 1  ON 45
ci_0047                -3.654395e-03 3 1  ON 46
ci_0048                -3.598954e-03 3 1  ON 47
ci_0049                -2.484654e-03 3 1  ON 48
ci_0050                -2.826959e-03 3 1  ON 49
ci_0051                -1.833600e-03 3 1  ON 50
ci_0052                -1.710328e-03 3 1  ON 51
ci_0053                -4.048632e-03 3 1  ON 52
ci_0054                -3.939286e-03 3 1  ON 53
ci_0055                 2.503497e-03 3 1  ON 54
ci_0056                 2.147349e-03 3 1  ON 55
ci_0057                 2.393921e-03 3 1  ON 56
ci_0058                 3.132647e-03 3 1  ON 57
ci_0059                -4.069415e-03 3 1  ON 58
ci_0060                -3.652300e-03 3 1  ON 59
ci_0061                -2.866307e-03 3 1  ON 60
ci_0062                -3.082844e-03 3 1  ON 61
ci_0063                -9.746519e-03 3 1  ON 62
ci_0064                -9.718142e-03 3 1  ON 63
ci_0065                -7.193661e-03 3 1  ON 64
ci_0066                -6.647078e-03 3 1  ON 65
ci_0067                -3.930803e-03 3 1  ON 66
ci_0068                -3.961254e-03 3 1  ON 67
ci_0069                 3.825679e-03 3 1  ON 68
ci_0070                 3.595772e-03 3 1  ON 69
ci_0071                 4.387640e-03 3 1  ON 70
ci_0072                 4.648242e-03 3 1  ON 71
ci_0073                 3.387789e-03 3 1  ON 72
ci_0074                 3.186287e-03 3 1  ON 73
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 61
    time step          = 0.05
    reference energy   = -16.9145
    reference variance = 0.247664
====================================================
  Execution time = 1.4477e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s061
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6903e+01
  VMC Evar = 3.2273e-01
  Total weights = 1.9515e+06
  Execution time = 1.9589e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.308434538909
                                         uncertainty =       0.003349438262

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.308434538909
                                         uncertainty =       0.003349438262

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000392756839
  error estimate for blocks of size 2^( 2) =       0.000407101851
  error estimate for blocks of size 2^( 3) =       0.000421655444
  error estimate for blocks of size 2^( 4) =       0.000435630772
  error estimate for blocks of size 2^( 5) =       0.000447092466
  error estimate for blocks of size 2^( 6) =       0.000457087204
  error estimate for blocks of size 2^( 7) =       0.000464262897

      target function =      -0.868698069245
              le_mean =     -16.902569858891
             les_mean =     286.025755081474
             stat err =       0.000451018335
             autocorr =       1.318684443279
   target nu stat err =       0.000451018335
   target dn stat err =       0.006509948289
      target stat err =       0.007899187287
              std dev =       0.555442047953
             le_variance =       0.308515868635

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.332622919109
                                         uncertainty =       0.024377213339

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.332622919109
                                         uncertainty =       0.024377213339

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000407853724
  error estimate for blocks of size 2^( 2) =       0.000421820190
  error estimate for blocks of size 2^( 3) =       0.000435898671
  error estimate for blocks of size 2^( 4) =       0.000449592303
  error estimate for blocks of size 2^( 5) =       0.000460929345
  error estimate for blocks of size 2^( 6) =       0.000470034745
  error estimate for blocks of size 2^( 7) =       0.000477193483

      target function =      -0.183926218648
              le_mean =     -16.902666898490
             les_mean =     287.615933708862
             stat err =       0.000464437469
             autocorr =       1.296718283273
   target nu stat err =       0.000464437469
   target dn stat err =       1.583283545671
      target stat err =       0.126339015464
              std dev =       0.576792268341
             le_variance =       0.332689320818

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.308114701324
                                         uncertainty =       0.003424925602

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.308114701324
                                         uncertainty =       0.003424925602

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000392551290
  error estimate for blocks of size 2^( 2) =       0.000407065469
  error estimate for blocks of size 2^( 3) =       0.000421795950
  error estimate for blocks of size 2^( 4) =       0.000435908289
  error estimate for blocks of size 2^( 5) =       0.000447423380
  error estimate for blocks of size 2^( 6) =       0.000457423787
  error estimate for blocks of size 2^( 7) =       0.000464586532

      target function =      -0.870684456737
              le_mean =     -16.902548300047
             les_mean =     286.023410075095
             stat err =       0.000451335497
             autocorr =       1.321923022049
   target nu stat err =       0.000451335497
   target dn stat err =       0.004970655636
      target stat err =       0.006072180128
              std dev =       0.555151357839
             le_variance =       0.308193030110

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.308310048094
                                         uncertainty =       0.003363098866

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.308310048094
                                         uncertainty =       0.003363098866

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000392677303
  error estimate for blocks of size 2^( 2) =       0.000407048596
  error estimate for blocks of size 2^( 3) =       0.000421630285
  error estimate for blocks of size 2^( 4) =       0.000435630034
  error estimate for blocks of size 2^( 5) =       0.000447101673
  error estimate for blocks of size 2^( 6) =       0.000457102088
  error estimate for blocks of size 2^( 7) =       0.000464277002

      target function =      -0.869536382139
              le_mean =     -16.902559084279
             les_mean =     286.024708496648
             stat err =       0.000451027699
             autocorr =       1.319273471627
   target nu stat err =       0.000451027699
   target dn stat err =       0.005861919869
      target stat err =       0.007131569585
              std dev =       0.555329567507
             le_variance =       0.308390928548


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.868698069245        initial
     3.8147e-02     3.8147e-01             5.9011e-03        -0.183926218648
     1.5259e-01     1.5259e+00             1.5436e-03        -0.870684456737  <--
     6.1035e-01     6.1035e+00             3.9589e-04        -0.869536382139

*****************************************************************************
Applying the update for shift_i =   1.5259e-01     and shift_s =   1.5259e+00
*****************************************************************************

  Execution time = 2.4373e+01
  </log>
  <optVariables href="H2O.s061.opt.xml">
ci_0001                 7.026437e-01 3 1  ON 0
ci_0002                 6.983036e-01 3 1  ON 1
ci_0003                -3.183896e-02 3 1  ON 2
ci_0004                -3.151306e-02 3 1  ON 3
ci_0005                -2.844487e-02 3 1  ON 4
ci_0006                -2.963802e-02 3 1  ON 5
ci_0007                -1.648878e-02 3 1  ON 6
ci_0008                -1.725217e-02 3 1  ON 7
ci_0009                -1.896474e-02 3 1  ON 8
ci_0010                -1.911280e-02 3 1  ON 9
ci_0011                -1.578971e-02 3 1  ON 10
ci_0012                -1.580838e-02 3 1  ON 11
ci_0013                 1.569429e-02 3 1  ON 12
ci_0014                 1.562287e-02 3 1  ON 13
ci_0015                 1.648970e-02 3 1  ON 14
ci_0016                 1.620364e-02 3 1  ON 15
ci_0017                 1.384980e-02 3 1  ON 16
ci_0018                 1.417636e-02 3 1  ON 17
ci_0019                 1.243616e-02 3 1  ON 18
ci_0020                 1.205113e-02 3 1  ON 19
ci_0021                 1.539472e-02 3 1  ON 20
ci_0022                 1.640715e-02 3 1  ON 21
ci_0023                -1.179533e-02 3 1  ON 22
ci_0024                -1.104125e-02 3 1  ON 23
ci_0025                -3.006528e-03 3 1  ON 24
ci_0026                -2.667583e-03 3 1  ON 25
ci_0027                -1.175721e-02 3 1  ON 26
ci_0028                -1.173383e-02 3 1  ON 27
ci_0029                -1.035143e-02 3 1  ON 28
ci_0030                -1.029384e-02 3 1  ON 29
ci_0031                 1.406532e-02 3 1  ON 30
ci_0032                 1.309504e-02 3 1  ON 31
ci_0033                 8.466399e-03 3 1  ON 32
ci_0034                 8.682270e-03 3 1  ON 33
ci_0035                 5.055912e-03 3 1  ON 34
ci_0036                 4.824602e-03 3 1  ON 35
ci_0037                -1.143137e-02 3 1  ON 36
ci_0038                -1.141895e-02 3 1  ON 37
ci_0039                -3.807349e-03 3 1  ON 38
ci_0040                -3.935980e-03 3 1  ON 39
ci_0041                 9.637431e-03 3 1  ON 40
ci_0042                 9.535254e-03 3 1  ON 41
ci_0043                -6.347960e-03 3 1  ON 42
ci_0044                -6.781271e-03 3 1  ON 43
ci_0045                 1.048193e-02 3 1  ON 44
ci_0046                 9.369287e-03 3 1  ON 45
ci_0047                -3.654395e-03 3 1  ON 46
ci_0048                -3.598954e-03 3 1  ON 47
ci_0049                -2.484654e-03 3 1  ON 48
ci_0050                -2.826959e-03 3 1  ON 49
ci_0051                -1.833600e-03 3 1  ON 50
ci_0052                -1.710328e-03 3 1  ON 51
ci_0053                -4.048632e-03 3 1  ON 52
ci_0054                -3.939286e-03 3 1  ON 53
ci_0055                 2.503497e-03 3 1  ON 54
ci_0056                 2.147349e-03 3 1  ON 55
ci_0057                 2.393921e-03 3 1  ON 56
ci_0058                 3.132647e-03 3 1  ON 57
ci_0059                -4.069415e-03 3 1  ON 58
ci_0060                -3.652300e-03 3 1  ON 59
ci_0061                -2.866307e-03 3 1  ON 60
ci_0062                -3.082844e-03 3 1  ON 61
ci_0063                -9.746519e-03 3 1  ON 62
ci_0064                -9.718142e-03 3 1  ON 63
ci_0065                -7.193661e-03 3 1  ON 64
ci_0066                -6.647078e-03 3 1  ON 65
ci_0067                -3.930803e-03 3 1  ON 66
ci_0068                -3.961254e-03 3 1  ON 67
ci_0069                 3.825679e-03 3 1  ON 68
ci_0070                 3.595772e-03 3 1  ON 69
ci_0071                 4.387640e-03 3 1  ON 70
ci_0072                 4.648242e-03 3 1  ON 71
ci_0073                 3.387789e-03 3 1  ON 72
ci_0074                 3.186287e-03 3 1  ON 73
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 4.2110e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s062 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s062 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=62  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6897e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 62
    time step          = 0.05
    reference energy   = -16.8506
    reference variance = 0.171947
====================================================
  Execution time = 1.5046e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s062
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5248e+04
  VMC Eavg = -1.6902e+01
  VMC Evar = 3.1303e-01
  Total weights = 1.952187843e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 2.6978e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.302452721543
                                         uncertainty =       0.001880254677

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.302452721543
                                         uncertainty =       0.001880254677

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000388856116
  error estimate for blocks of size 2^( 2) =       0.000403907047
  error estimate for blocks of size 2^( 3) =       0.000418529726
  error estimate for blocks of size 2^( 4) =       0.000432446381
  error estimate for blocks of size 2^( 5) =       0.000443362490
  error estimate for blocks of size 2^( 6) =       0.000450705819
  error estimate for blocks of size 2^( 7) =       0.000455389527

      target function =      -0.888328887863
              le_mean =     -16.902316292303
             les_mean =     286.001326540943
             stat err =       0.000445476054
             autocorr =       1.312414018712
   target nu stat err =       0.000445476054
   target dn stat err =       0.002946746825
      target stat err =       0.003778990156
              std dev =       0.549925593075
             le_variance =       0.302418157919


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690231629230e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 74
Check correct_vf_var_size: 225, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 3.8147e-02, overlap shift 3.8147e-01 and omega -1.7527e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.888344020716       residual = 5.93e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.888583817837       residual = 1.16e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.888643215934       residual = 4.81e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.888671440956       residual = 1.53e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.888677861798       residual = 7.87e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.888684996714       residual = 7.48e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.888688775364       residual = 2.96e-05           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.888689672187       residual = 2.53e-05           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.888693776713       residual = 2.87e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.888696021397       residual = 3.56e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.888700270789       residual = 2.70e-05           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.888702280259       residual = 2.12e-05           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.888708013669       residual = 1.91e-05           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.888712484021       residual = 7.08e-06           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.888713122192       residual = 2.20e-06           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.888713338686       residual = 6.08e-07           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.888713498006       residual = 2.74e-07           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.888713435081       residual = 8.36e-08           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.888713386283       residual = 4.21e-08           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.888713335116       residual = 1.32e-08           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.888713309670       residual = 5.06e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         20 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 3.8147e-02 is 6.095922e-03

solving harmonic davidson linear method for identity shift 1.5259e-01, overlap shift 1.5259e+00 and omega -1.7527e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.888344020716       residual = 5.93e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.888462513796       residual = 1.08e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.888489904607       residual = 4.08e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.888501217244       residual = 1.19e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.888503380508       residual = 5.65e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.888506002032       residual = 4.55e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.888507180901       residual = 1.89e-05           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.888507368456       residual = 1.68e-05           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.888508768086       residual = 1.69e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.888509295871       residual = 1.46e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.888510144680       residual = 6.86e-06           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.888510452546       residual = 4.46e-06           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.888511340089       residual = 2.15e-06           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.888511749408       residual = 5.36e-07           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.888511714053       residual = 1.25e-07           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.888511721920       residual = 3.80e-08           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.888511727729       residual = 1.42e-08           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.888511716555       residual = 3.94e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         17 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 1.5259e-01 is 1.568071e-03

solving harmonic davidson linear method for identity shift 6.1035e-01, overlap shift 6.1035e+00 and omega -1.7527e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.888344020716       residual = 5.93e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.888383209820       residual = 1.02e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.888391862156       residual = 3.65e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.888395116732       residual = 1.02e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.888395667549       residual = 4.56e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.888396394710       residual = 3.33e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.888396689815       residual = 1.45e-05           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.888396720909       residual = 1.33e-05           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.888397093669       residual = 1.18e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.888397199553       residual = 7.86e-06           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.888397370184       residual = 3.12e-06           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.888397426616       residual = 1.81e-06           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.888397584470       residual = 6.11e-07           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.888397637656       residual = 1.34e-07           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.888397626666       residual = 2.84e-08           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.888397627367       residual = 8.88e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         15 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 6.1035e-01 is 3.981191e-04

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.866733 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 75 and numParams is: 74

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.7768e+01
  </log>
  <optVariables href="H2O.s062.opt.xml">
ci_0001                 7.012904e-01 3 1  ON 0
ci_0002                 6.998717e-01 3 1  ON 1
ci_0003                -3.164584e-02 3 1  ON 2
ci_0004                -3.109971e-02 3 1  ON 3
ci_0005                -2.764857e-02 3 1  ON 4
ci_0006                -2.890676e-02 3 1  ON 5
ci_0007                -1.615253e-02 3 1  ON 6
ci_0008                -1.663078e-02 3 1  ON 7
ci_0009                -1.892668e-02 3 1  ON 8
ci_0010                -1.886965e-02 3 1  ON 9
ci_0011                -1.554250e-02 3 1  ON 10
ci_0012                -1.569675e-02 3 1  ON 11
ci_0013                 1.555911e-02 3 1  ON 12
ci_0014                 1.567987e-02 3 1  ON 13
ci_0015                 1.604155e-02 3 1  ON 14
ci_0016                 1.582618e-02 3 1  ON 15
ci_0017                 1.360906e-02 3 1  ON 16
ci_0018                 1.427067e-02 3 1  ON 17
ci_0019                 1.215753e-02 3 1  ON 18
ci_0020                 1.230542e-02 3 1  ON 19
ci_0021                 1.555652e-02 3 1  ON 20
ci_0022                 1.630783e-02 3 1  ON 21
ci_0023                -1.142126e-02 3 1  ON 22
ci_0024                -1.076666e-02 3 1  ON 23
ci_0025                -3.001697e-03 3 1  ON 24
ci_0026                -2.351256e-03 3 1  ON 25
ci_0027                -1.176121e-02 3 1  ON 26
ci_0028                -1.154027e-02 3 1  ON 27
ci_0029                -1.009766e-02 3 1  ON 28
ci_0030                -1.032679e-02 3 1  ON 29
ci_0031                 1.407868e-02 3 1  ON 30
ci_0032                 1.295097e-02 3 1  ON 31
ci_0033                 8.405435e-03 3 1  ON 32
ci_0034                 8.813791e-03 3 1  ON 33
ci_0035                 4.956855e-03 3 1  ON 34
ci_0036                 4.847179e-03 3 1  ON 35
ci_0037                -1.136987e-02 3 1  ON 36
ci_0038                -1.141801e-02 3 1  ON 37
ci_0039                -3.625379e-03 3 1  ON 38
ci_0040                -3.824254e-03 3 1  ON 39
ci_0041                 9.400076e-03 3 1  ON 40
ci_0042                 9.255567e-03 3 1  ON 41
ci_0043                -6.207872e-03 3 1  ON 42
ci_0044                -7.003906e-03 3 1  ON 43
ci_0045                 1.010550e-02 3 1  ON 44
ci_0046                 9.447348e-03 3 1  ON 45
ci_0047                -3.398418e-03 3 1  ON 46
ci_0048                -3.425126e-03 3 1  ON 47
ci_0049                -2.323549e-03 3 1  ON 48
ci_0050                -2.565765e-03 3 1  ON 49
ci_0051                -1.675715e-03 3 1  ON 50
ci_0052                -1.845226e-03 3 1  ON 51
ci_0053                -3.634002e-03 3 1  ON 52
ci_0054                -3.634019e-03 3 1  ON 53
ci_0055                 2.649454e-03 3 1  ON 54
ci_0056                 2.258539e-03 3 1  ON 55
ci_0057                 2.195415e-03 3 1  ON 56
ci_0058                 2.821129e-03 3 1  ON 57
ci_0059                -3.778894e-03 3 1  ON 58
ci_0060                -3.469251e-03 3 1  ON 59
ci_0061                -2.753734e-03 3 1  ON 60
ci_0062                -3.082522e-03 3 1  ON 61
ci_0063                -9.901202e-03 3 1  ON 62
ci_0064                -9.546726e-03 3 1  ON 63
ci_0065                -6.828535e-03 3 1  ON 64
ci_0066                -6.695214e-03 3 1  ON 65
ci_0067                -3.934905e-03 3 1  ON 66
ci_0068                -3.990036e-03 3 1  ON 67
ci_0069                 3.761910e-03 3 1  ON 68
ci_0070                 3.750689e-03 3 1  ON 69
ci_0071                 4.212405e-03 3 1  ON 70
ci_0072                 4.164133e-03 3 1  ON 71
ci_0073                 3.508963e-03 3 1  ON 72
ci_0074                 3.156379e-03 3 1  ON 73
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 62
    time step          = 0.05
    reference energy   = -16.9282
    reference variance = 0.160708
====================================================
  Execution time = 1.4442e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s062
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6903e+01
  VMC Evar = 3.1482e-01
  Total weights = 1.9516e+06
  Execution time = 1.9482e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.303497558380
                                         uncertainty =       0.002103817556

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.303497558380
                                         uncertainty =       0.002103817556

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000389530748
  error estimate for blocks of size 2^( 2) =       0.000404269452
  error estimate for blocks of size 2^( 3) =       0.000419212914
  error estimate for blocks of size 2^( 4) =       0.000432356718
  error estimate for blocks of size 2^( 5) =       0.000442639614
  error estimate for blocks of size 2^( 6) =       0.000449932821
  error estimate for blocks of size 2^( 7) =       0.000455322196

      target function =      -0.886373778274
              le_mean =     -16.903420603266
             les_mean =     286.040340659946
             stat err =       0.000445062837
             autocorr =       1.305446789578
   target nu stat err =       0.000445062837
   target dn stat err =       0.002897099306
      target stat err =       0.003707476980
              std dev =       0.550879666944
             le_variance =       0.303468407452

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.304092671567
                                         uncertainty =       0.002112453040

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.304092671567
                                         uncertainty =       0.002112453040

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000389910074
  error estimate for blocks of size 2^( 2) =       0.000404736811
  error estimate for blocks of size 2^( 3) =       0.000419774391
  error estimate for blocks of size 2^( 4) =       0.000433000831
  error estimate for blocks of size 2^( 5) =       0.000443323728
  error estimate for blocks of size 2^( 6) =       0.000450661199
  error estimate for blocks of size 2^( 7) =       0.000456133454

      target function =      -0.846391016159
              le_mean =     -16.903414424021
             les_mean =     286.072689166033
             stat err =       0.000445779803
             autocorr =       1.307109176315
   target nu stat err =       0.000445779803
   target dn stat err =       0.022070583918
      target stat err =       0.025404630554
              std dev =       0.551416114858
             le_variance =       0.304059731725

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.303778291678
                                         uncertainty =       0.002101039428

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.303778291678
                                         uncertainty =       0.002101039428

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000389708755
  error estimate for blocks of size 2^( 2) =       0.000404540966
  error estimate for blocks of size 2^( 3) =       0.000419569058
  error estimate for blocks of size 2^( 4) =       0.000432793978
  error estimate for blocks of size 2^( 5) =       0.000443124051
  error estimate for blocks of size 2^( 6) =       0.000450432882
  error estimate for blocks of size 2^( 7) =       0.000455889932

      target function =      -0.874006159015
              le_mean =     -16.903415151372
             les_mean =     286.050040419285
             stat err =       0.000445560211
             autocorr =       1.307171215267
   target nu stat err =       0.000445560211
   target dn stat err =       0.007295869241
      target stat err =       0.008967108587
              std dev =       0.551131407013
             le_variance =       0.303745827796

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.303497598949
                                         uncertainty =       0.002102041989

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.303497598949
                                         uncertainty =       0.002102041989

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000389530399
  error estimate for blocks of size 2^( 2) =       0.000404284658
  error estimate for blocks of size 2^( 3) =       0.000419240461
  error estimate for blocks of size 2^( 4) =       0.000432396394
  error estimate for blocks of size 2^( 5) =       0.000442689989
  error estimate for blocks of size 2^( 6) =       0.000449987307
  error estimate for blocks of size 2^( 7) =       0.000455383977

      target function =      -0.885270669770
              le_mean =     -16.903414556688
             les_mean =     286.041010082677
             stat err =       0.000445114417
             autocorr =       1.305751733252
   target nu stat err =       0.000445114417
   target dn stat err =       0.003064306143
      target stat err =       0.003905749856
              std dev =       0.550879172996
             le_variance =       0.303467863241


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.886373778274        initial  <--
     3.8147e-02     3.8147e-01             6.0959e-03        -0.846391016159
     1.5259e-01     1.5259e+00             1.5681e-03        -0.874006159015
     6.1035e-01     6.1035e+00             3.9812e-04        -0.885270669770

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 24.2865
  </log>
  <optVariables href="H2O.s062.opt.xml">
ci_0001                 7.026437e-01 3 1  ON 0
ci_0002                 6.983036e-01 3 1  ON 1
ci_0003                -3.183896e-02 3 1  ON 2
ci_0004                -3.151306e-02 3 1  ON 3
ci_0005                -2.844487e-02 3 1  ON 4
ci_0006                -2.963802e-02 3 1  ON 5
ci_0007                -1.648878e-02 3 1  ON 6
ci_0008                -1.725217e-02 3 1  ON 7
ci_0009                -1.896474e-02 3 1  ON 8
ci_0010                -1.911280e-02 3 1  ON 9
ci_0011                -1.578971e-02 3 1  ON 10
ci_0012                -1.580838e-02 3 1  ON 11
ci_0013                 1.569429e-02 3 1  ON 12
ci_0014                 1.562287e-02 3 1  ON 13
ci_0015                 1.648970e-02 3 1  ON 14
ci_0016                 1.620364e-02 3 1  ON 15
ci_0017                 1.384980e-02 3 1  ON 16
ci_0018                 1.417636e-02 3 1  ON 17
ci_0019                 1.243616e-02 3 1  ON 18
ci_0020                 1.205113e-02 3 1  ON 19
ci_0021                 1.539472e-02 3 1  ON 20
ci_0022                 1.640715e-02 3 1  ON 21
ci_0023                -1.179533e-02 3 1  ON 22
ci_0024                -1.104125e-02 3 1  ON 23
ci_0025                -3.006528e-03 3 1  ON 24
ci_0026                -2.667583e-03 3 1  ON 25
ci_0027                -1.175721e-02 3 1  ON 26
ci_0028                -1.173383e-02 3 1  ON 27
ci_0029                -1.035143e-02 3 1  ON 28
ci_0030                -1.029384e-02 3 1  ON 29
ci_0031                 1.406532e-02 3 1  ON 30
ci_0032                 1.309504e-02 3 1  ON 31
ci_0033                 8.466399e-03 3 1  ON 32
ci_0034                 8.682270e-03 3 1  ON 33
ci_0035                 5.055912e-03 3 1  ON 34
ci_0036                 4.824602e-03 3 1  ON 35
ci_0037                -1.143137e-02 3 1  ON 36
ci_0038                -1.141895e-02 3 1  ON 37
ci_0039                -3.807349e-03 3 1  ON 38
ci_0040                -3.935980e-03 3 1  ON 39
ci_0041                 9.637431e-03 3 1  ON 40
ci_0042                 9.535254e-03 3 1  ON 41
ci_0043                -6.347960e-03 3 1  ON 42
ci_0044                -6.781271e-03 3 1  ON 43
ci_0045                 1.048193e-02 3 1  ON 44
ci_0046                 9.369287e-03 3 1  ON 45
ci_0047                -3.654395e-03 3 1  ON 46
ci_0048                -3.598954e-03 3 1  ON 47
ci_0049                -2.484654e-03 3 1  ON 48
ci_0050                -2.826959e-03 3 1  ON 49
ci_0051                -1.833600e-03 3 1  ON 50
ci_0052                -1.710328e-03 3 1  ON 51
ci_0053                -4.048632e-03 3 1  ON 52
ci_0054                -3.939286e-03 3 1  ON 53
ci_0055                 2.503497e-03 3 1  ON 54
ci_0056                 2.147349e-03 3 1  ON 55
ci_0057                 2.393921e-03 3 1  ON 56
ci_0058                 3.132647e-03 3 1  ON 57
ci_0059                -4.069415e-03 3 1  ON 58
ci_0060                -3.652300e-03 3 1  ON 59
ci_0061                -2.866307e-03 3 1  ON 60
ci_0062                -3.082844e-03 3 1  ON 61
ci_0063                -9.746519e-03 3 1  ON 62
ci_0064                -9.718142e-03 3 1  ON 63
ci_0065                -7.193661e-03 3 1  ON 64
ci_0066                -6.647078e-03 3 1  ON 65
ci_0067                -3.930803e-03 3 1  ON 66
ci_0068                -3.961254e-03 3 1  ON 67
ci_0069                 3.825679e-03 3 1  ON 68
ci_0070                 3.595772e-03 3 1  ON 69
ci_0071                 4.387640e-03 3 1  ON 70
ci_0072                 4.648242e-03 3 1  ON 71
ci_0073                 3.387789e-03 3 1  ON 72
ci_0074                 3.186287e-03 3 1  ON 73
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 4.2069e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s063 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s063 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=63  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6897e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 63
    time step          = 0.05
    reference energy   = -16.9557
    reference variance = 0.316603
====================================================
  Execution time = 1.4882e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s063
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5266e+04
  VMC Eavg = -1.6903e+01
  VMC Evar = 3.1416e-01
  Total weights = 1.951687400e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 2.6874e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.303125886258
                                         uncertainty =       0.002341744547

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.303125886258
                                         uncertainty =       0.002341744547

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000389289906
  error estimate for blocks of size 2^( 2) =       0.000403793292
  error estimate for blocks of size 2^( 3) =       0.000418382651
  error estimate for blocks of size 2^( 4) =       0.000431548952
  error estimate for blocks of size 2^( 5) =       0.000442137590
  error estimate for blocks of size 2^( 6) =       0.000449117657
  error estimate for blocks of size 2^( 7) =       0.000452926977

      target function =      -0.887055414369
              le_mean =     -16.903295990499
             les_mean =     286.035572660432
             stat err =       0.000443932794
             autocorr =       1.300433566878
   target nu stat err =       0.000443932794
   target dn stat err =       0.002888709705
      target stat err =       0.003701645175
              std dev =       0.550539064788
             le_variance =       0.303093261858


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690329599050e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 74
Check correct_vf_var_size: 225, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 3.8147e-01, overlap shift 3.8147e+00 and omega -1.7527e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.887070003397       residual = 6.89e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.887143431620       residual = 1.31e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.887160382464       residual = 5.02e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.887166614240       residual = 1.66e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.887170061168       residual = 6.73e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.887172460207       residual = 3.13e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.887172964745       residual = 1.31e-05           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.887173358220       residual = 7.28e-06           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.887173111108       residual = 2.41e-06           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.887173133523       residual = 2.27e-06           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.887173296581       residual = 2.13e-06           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.887173396302       residual = 1.85e-06           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.887173522156       residual = 9.49e-07           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.887173497632       residual = 3.31e-07           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.887173472721       residual = 1.16e-07           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.887173483190       residual = 3.19e-08           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.887173464477       residual = 9.75e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         16 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 3.8147e-01 is 5.644849e-04

solving harmonic davidson linear method for identity shift 1.5259e+00, overlap shift 1.5259e+01 and omega -1.7527e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.887070003397       residual = 6.89e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.887090889113       residual = 1.27e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.887095566797       residual = 4.69e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.887097230585       residual = 1.53e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.887098130826       residual = 5.92e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.887098728446       residual = 2.59e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.887098847151       residual = 1.08e-05           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.887098938752       residual = 5.84e-06           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.887098870525       residual = 1.99e-06           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.887098878171       residual = 1.96e-06           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.887098920672       residual = 1.70e-06           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.887098943671       residual = 1.32e-06           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.887098968035       residual = 5.69e-07           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.887098959723       residual = 1.76e-07           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.887098954434       residual = 5.64e-08           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.887098956334       residual = 1.56e-08           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.887098952612       residual = 4.28e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         16 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 1.5259e+00 is 1.509802e-04

solving harmonic davidson linear method for identity shift 6.1035e+00, overlap shift 6.1035e+01 and omega -1.7527e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.887070003397       residual = 6.89e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.887075411034       residual = 1.26e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.887076611390       residual = 4.59e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.887077034236       residual = 1.49e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.887077261559       residual = 5.70e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.887077410379       residual = 2.45e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.887077439442       residual = 1.02e-05           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.887077461804       residual = 5.49e-06           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.887077444344       residual = 1.88e-06           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.887077446434       residual = 1.88e-06           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.887077457153       residual = 1.58e-06           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.887077462728       residual = 1.19e-06           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.887077468337       residual = 4.89e-07           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.887077466165       residual = 1.47e-07           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.887077464917       residual = 4.59e-08           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.887077465350       residual = 1.27e-08           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.887077464481       residual = 3.38e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         16 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 6.1035e+00 is 3.841537e-05

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.881223 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 75 and numParams is: 74

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.7592e+01
  </log>
  <optVariables href="H2O.s063.opt.xml">
ci_0001                 7.025831e-01 3 1  ON 0
ci_0002                 6.983946e-01 3 1  ON 1
ci_0003                -3.177335e-02 3 1  ON 2
ci_0004                -3.143752e-02 3 1  ON 3
ci_0005                -2.837594e-02 3 1  ON 4
ci_0006                -2.961001e-02 3 1  ON 5
ci_0007                -1.633780e-02 3 1  ON 6
ci_0008                -1.714318e-02 3 1  ON 7
ci_0009                -1.894489e-02 3 1  ON 8
ci_0010                -1.905895e-02 3 1  ON 9
ci_0011                -1.577018e-02 3 1  ON 10
ci_0012                -1.575129e-02 3 1  ON 11
ci_0013                 1.566128e-02 3 1  ON 12
ci_0014                 1.559770e-02 3 1  ON 13
ci_0015                 1.645357e-02 3 1  ON 14
ci_0016                 1.618199e-02 3 1  ON 15
ci_0017                 1.384389e-02 3 1  ON 16
ci_0018                 1.409396e-02 3 1  ON 17
ci_0019                 1.245840e-02 3 1  ON 18
ci_0020                 1.205485e-02 3 1  ON 19
ci_0021                 1.541574e-02 3 1  ON 20
ci_0022                 1.644512e-02 3 1  ON 21
ci_0023                -1.173005e-02 3 1  ON 22
ci_0024                -1.102581e-02 3 1  ON 23
ci_0025                -2.958646e-03 3 1  ON 24
ci_0026                -2.639348e-03 3 1  ON 25
ci_0027                -1.172675e-02 3 1  ON 26
ci_0028                -1.169069e-02 3 1  ON 27
ci_0029                -1.031241e-02 3 1  ON 28
ci_0030                -1.027149e-02 3 1  ON 29
ci_0031                 1.408772e-02 3 1  ON 30
ci_0032                 1.311445e-02 3 1  ON 31
ci_0033                 8.458060e-03 3 1  ON 32
ci_0034                 8.619053e-03 3 1  ON 33
ci_0035                 5.008133e-03 3 1  ON 34
ci_0036                 4.843277e-03 3 1  ON 35
ci_0037                -1.143532e-02 3 1  ON 36
ci_0038                -1.136565e-02 3 1  ON 37
ci_0039                -3.799834e-03 3 1  ON 38
ci_0040                -3.931930e-03 3 1  ON 39
ci_0041                 9.637821e-03 3 1  ON 40
ci_0042                 9.536389e-03 3 1  ON 41
ci_0043                -6.333948e-03 3 1  ON 42
ci_0044                -6.749195e-03 3 1  ON 43
ci_0045                 1.040488e-02 3 1  ON 44
ci_0046                 9.422484e-03 3 1  ON 45
ci_0047                -3.623628e-03 3 1  ON 46
ci_0048                -3.592930e-03 3 1  ON 47
ci_0049                -2.568070e-03 3 1  ON 48
ci_0050                -2.819197e-03 3 1  ON 49
ci_0051                -1.836492e-03 3 1  ON 50
ci_0052                -1.733140e-03 3 1  ON 51
ci_0053                -4.021616e-03 3 1  ON 52
ci_0054                -3.945596e-03 3 1  ON 53
ci_0055                 2.531214e-03 3 1  ON 54
ci_0056                 2.129950e-03 3 1  ON 55
ci_0057                 2.393214e-03 3 1  ON 56
ci_0058                 3.113909e-03 3 1  ON 57
ci_0059                -4.034854e-03 3 1  ON 58
ci_0060                -3.667949e-03 3 1  ON 59
ci_0061                -2.875892e-03 3 1  ON 60
ci_0062                -3.080285e-03 3 1  ON 61
ci_0063                -9.727196e-03 3 1  ON 62
ci_0064                -9.702628e-03 3 1  ON 63
ci_0065                -7.150270e-03 3 1  ON 64
ci_0066                -6.609468e-03 3 1  ON 65
ci_0067                -3.991832e-03 3 1  ON 66
ci_0068                -3.956076e-03 3 1  ON 67
ci_0069                 3.833956e-03 3 1  ON 68
ci_0070                 3.553818e-03 3 1  ON 69
ci_0071                 4.359535e-03 3 1  ON 70
ci_0072                 4.664006e-03 3 1  ON 71
ci_0073                 3.413860e-03 3 1  ON 72
ci_0074                 3.199959e-03 3 1  ON 73
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 63
    time step          = 0.05
    reference energy   = -16.94
    reference variance = 0.37894
====================================================
  Execution time = 1.4609e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s063
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6903e+01
  VMC Evar = 3.2021e-01
  Total weights = 1.9519e+06
  Execution time = 1.9619e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.306647646979
                                         uncertainty =       0.002648032530

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.306647646979
                                         uncertainty =       0.002648032530

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000391559375
  error estimate for blocks of size 2^( 2) =       0.000406354058
  error estimate for blocks of size 2^( 3) =       0.000421111460
  error estimate for blocks of size 2^( 4) =       0.000433749057
  error estimate for blocks of size 2^( 5) =       0.000443729978
  error estimate for blocks of size 2^( 6) =       0.000452370913
  error estimate for blocks of size 2^( 7) =       0.000457181815

      target function =      -0.879561933266
              le_mean =     -16.903128569162
             les_mean =     286.035868519404
             stat err =       0.000446757941
             autocorr =       1.301815107021
   target nu stat err =       0.000446757941
   target dn stat err =       0.004091748505
      target stat err =       0.005117060136
              std dev =       0.553748578860
             le_variance =       0.306637488590

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.306672829028
                                         uncertainty =       0.002652727205

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.306672829028
                                         uncertainty =       0.002652727205

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000391575340
  error estimate for blocks of size 2^( 2) =       0.000406388047
  error estimate for blocks of size 2^( 3) =       0.000421170189
  error estimate for blocks of size 2^( 4) =       0.000433824037
  error estimate for blocks of size 2^( 5) =       0.000443810237
  error estimate for blocks of size 2^( 6) =       0.000452456473
  error estimate for blocks of size 2^( 7) =       0.000457278473

      target function =      -0.878007111962
              le_mean =     -16.903127697603
             les_mean =     286.037089488403
             stat err =       0.000446842305
             autocorr =       1.302200626202
   target nu stat err =       0.000446842305
   target dn stat err =       0.004473341483
      target stat err =       0.005567765663
              std dev =       0.553771155990
             le_variance =       0.306662493207

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.306655111190
                                         uncertainty =       0.002650666974

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.306655111190
                                         uncertainty =       0.002650666974

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000391564077
  error estimate for blocks of size 2^( 2) =       0.000406368733
  error estimate for blocks of size 2^( 3) =       0.000421139886
  error estimate for blocks of size 2^( 4) =       0.000433786245
  error estimate for blocks of size 2^( 5) =       0.000443769885
  error estimate for blocks of size 2^( 6) =       0.000452413589
  error estimate for blocks of size 2^( 7) =       0.000457229987

      target function =      -0.878955247217
              le_mean =     -16.903127433852
             les_mean =     286.036317085934
             stat err =       0.000446799927
             autocorr =       1.302028534072
   target nu stat err =       0.000446799927
   target dn stat err =       0.004273990966
      target stat err =       0.005334281115
              std dev =       0.553755228700
             le_variance =       0.306644853312

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.306647791118
                                         uncertainty =       0.002648372201

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.306647791118
                                         uncertainty =       0.002648372201

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000391559459
  error estimate for blocks of size 2^( 2) =       0.000406355451
  error estimate for blocks of size 2^( 3) =       0.000421114636
  error estimate for blocks of size 2^( 4) =       0.000433753469
  error estimate for blocks of size 2^( 5) =       0.000443734765
  error estimate for blocks of size 2^( 6) =       0.000452376097
  error estimate for blocks of size 2^( 7) =       0.000457187709

      target function =      -0.879634726498
              le_mean =     -16.903128307378
             les_mean =     286.035800761676
             stat err =       0.000446763010
             autocorr =       1.301844091757
   target nu stat err =       0.000446763010
   target dn stat err =       0.004110962413
      target stat err =       0.005141569778
              std dev =       0.553748697713
             le_variance =       0.306637620219


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.879561933266        initial
     3.8147e-01     3.8147e+00             5.6448e-04        -0.878007111962
     1.5259e+00     1.5259e+01             1.5098e-04        -0.878955247217
     6.1035e+00     6.1035e+01             3.8415e-05        -0.879634726498  <--

*****************************************************************************
Applying the update for shift_i =   6.1035e+00     and shift_s =   6.1035e+01
*****************************************************************************

  Execution time = 2.4477e+01
  </log>
  <optVariables href="H2O.s063.opt.xml">
ci_0001                 7.026286e-01 3 1  ON 0
ci_0002                 6.983264e-01 3 1  ON 1
ci_0003                -3.182212e-02 3 1  ON 2
ci_0004                -3.149363e-02 3 1  ON 3
ci_0005                -2.842724e-02 3 1  ON 4
ci_0006                -2.963082e-02 3 1  ON 5
ci_0007                -1.645036e-02 3 1  ON 6
ci_0008                -1.722444e-02 3 1  ON 7
ci_0009                -1.895962e-02 3 1  ON 8
ci_0010                -1.909889e-02 3 1  ON 9
ci_0011                -1.578468e-02 3 1  ON 10
ci_0012                -1.579367e-02 3 1  ON 11
ci_0013                 1.568579e-02 3 1  ON 12
ci_0014                 1.561636e-02 3 1  ON 13
ci_0015                 1.648041e-02 3 1  ON 14
ci_0016                 1.619804e-02 3 1  ON 15
ci_0017                 1.384828e-02 3 1  ON 16
ci_0018                 1.415512e-02 3 1  ON 17
ci_0019                 1.244187e-02 3 1  ON 18
ci_0020                 1.205205e-02 3 1  ON 19
ci_0021                 1.540008e-02 3 1  ON 20
ci_0022                 1.641682e-02 3 1  ON 21
ci_0023                -1.177852e-02 3 1  ON 22
ci_0024                -1.103724e-02 3 1  ON 23
ci_0025                -2.994138e-03 3 1  ON 24
ci_0026                -2.660265e-03 3 1  ON 25
ci_0027                -1.174937e-02 3 1  ON 26
ci_0028                -1.172271e-02 3 1  ON 27
ci_0029                -1.034138e-02 3 1  ON 28
ci_0030                -1.028806e-02 3 1  ON 29
ci_0031                 1.407103e-02 3 1  ON 30
ci_0032                 1.310000e-02 3 1  ON 31
ci_0033                 8.464276e-03 3 1  ON 32
ci_0034                 8.666095e-03 3 1  ON 33
ci_0035                 5.043533e-03 3 1  ON 34
ci_0036                 4.829420e-03 3 1  ON 35
ci_0037                -1.143239e-02 3 1  ON 36
ci_0038                -1.140526e-02 3 1  ON 37
ci_0039                -3.805407e-03 3 1  ON 38
ci_0040                -3.934927e-03 3 1  ON 39
ci_0041                 9.637541e-03 3 1  ON 40
ci_0042                 9.535544e-03 3 1  ON 41
ci_0043                -6.344353e-03 3 1  ON 42
ci_0044                -6.773043e-03 3 1  ON 43
ci_0045                 1.046221e-02 3 1  ON 44
ci_0046                 9.382885e-03 3 1  ON 45
ci_0047                -3.646442e-03 3 1  ON 46
ci_0048                -3.597391e-03 3 1  ON 47
ci_0049                -2.506265e-03 3 1  ON 48
ci_0050                -2.824941e-03 3 1  ON 49
ci_0051                -1.834355e-03 3 1  ON 50
ci_0052                -1.716246e-03 3 1  ON 51
ci_0053                -4.041641e-03 3 1  ON 52
ci_0054                -3.940921e-03 3 1  ON 53
ci_0055                 2.510681e-03 3 1  ON 54
ci_0056                 2.142832e-03 3 1  ON 55
ci_0057                 2.393750e-03 3 1  ON 56
ci_0058                 3.127813e-03 3 1  ON 57
ci_0059                -4.060462e-03 3 1  ON 58
ci_0060                -3.656349e-03 3 1  ON 59
ci_0061                -2.868779e-03 3 1  ON 60
ci_0062                -3.082180e-03 3 1  ON 61
ci_0063                -9.741539e-03 3 1  ON 62
ci_0064                -9.714120e-03 3 1  ON 63
ci_0065                -7.182499e-03 3 1  ON 64
ci_0066                -6.637393e-03 3 1  ON 65
ci_0067                -3.946627e-03 3 1  ON 66
ci_0068                -3.959907e-03 3 1  ON 67
ci_0069                 3.827822e-03 3 1  ON 68
ci_0070                 3.584902e-03 3 1  ON 69
ci_0071                 4.380370e-03 3 1  ON 70
ci_0072                 4.652321e-03 3 1  ON 71
ci_0073                 3.394552e-03 3 1  ON 72
ci_0074                 3.189830e-03 3 1  ON 73
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 4.2083e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s064 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s064 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=64  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6898e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 64
    time step          = 0.05
    reference energy   = -16.8662
    reference variance = 0.314779
====================================================
  Execution time = 1.4859e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s064
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5228e+04
  VMC Eavg = -1.6903e+01
  VMC Evar = 3.2857e-01
  Total weights = 1.951769270e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 2.6987e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.312368657576
                                         uncertainty =       0.005123567354

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.312368657576
                                         uncertainty =       0.005123567354

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000395158872
  error estimate for blocks of size 2^( 2) =       0.000409669516
  error estimate for blocks of size 2^( 3) =       0.000424309940
  error estimate for blocks of size 2^( 4) =       0.000437495192
  error estimate for blocks of size 2^( 5) =       0.000448271128
  error estimate for blocks of size 2^( 6) =       0.000456773735
  error estimate for blocks of size 2^( 7) =       0.000459307634

      target function =      -0.869110766279
              le_mean =     -16.902996597547
             les_mean =     286.039859099915
             stat err =       0.000450461922
             autocorr =       1.299489271675
   target nu stat err =       0.000450461922
   target dn stat err =       0.007670191942
      target stat err =       0.009314227837
              std dev =       0.558839035422
             le_variance =       0.312301067512


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690299659755e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 74
Check correct_vf_var_size: 225, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.5259e+00, overlap shift 1.5259e+01 and omega -1.7527e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.869208883903       residual = 2.46e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.869275089592       residual = 3.08e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.869284990574       residual = 1.29e-03           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.869288154845       residual = 5.46e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.869290985833       residual = 2.99e-04           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.869293111947       residual = 2.29e-04           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.869294766490       residual = 1.75e-04           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.869295576791       residual = 1.88e-04           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.869296100096       residual = 1.33e-04           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.869296771862       residual = 5.82e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.869297263661       residual = 2.30e-05           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.869297321869       residual = 5.45e-06           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.869297352822       residual = 2.10e-06           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.869297361964       residual = 4.75e-07           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.869297363081       residual = 1.23e-07           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.869297367077       residual = 1.66e-08           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.869297365277       residual = 6.72e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         16 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 1.5259e+00 is 5.524559e-04

solving harmonic davidson linear method for identity shift 6.1035e+00, overlap shift 6.1035e+01 and omega -1.7527e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.869208883903       residual = 2.46e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.869226020709       residual = 3.06e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.869228566081       residual = 1.27e-03           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.869229368740       residual = 5.35e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.869230086479       residual = 2.91e-04           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.869230620018       residual = 2.21e-04           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.869231034239       residual = 1.68e-04           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.869231234906       residual = 1.78e-04           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.869231360575       residual = 1.24e-04           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.869231520927       residual = 5.22e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.869231636146       residual = 2.00e-05           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.869231648406       residual = 4.67e-06           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.869231655189       residual = 1.77e-06           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.869231657123       residual = 3.90e-07           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.869231657360       residual = 9.86e-08           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.869231658281       residual = 1.34e-08           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.869231657855       residual = 5.46e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         16 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 6.1035e+00 is 1.383532e-04

solving harmonic davidson linear method for identity shift 2.4414e+01, overlap shift 2.4414e+02 and omega -1.7527e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.869208883903       residual = 2.46e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.869213206319       residual = 3.06e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.869213847195       residual = 1.26e-03           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.869214048583       residual = 5.33e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.869214228644       residual = 2.90e-04           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.869214362139       residual = 2.19e-04           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.869214465720       residual = 1.67e-04           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.869214515754       residual = 1.76e-04           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.869214546833       residual = 1.22e-04           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.869214586435       residual = 5.07e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.869214614756       residual = 1.93e-05           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.869214617684       residual = 4.49e-06           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.869214619322       residual = 1.69e-06           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.869214619785       residual = 3.71e-07           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.869214619842       residual = 9.31e-08           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.869214620067       residual = 1.27e-08           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.869214619962       residual = 5.18e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         16 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 2.4414e+01 is 3.460384e-05

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.895541 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 75 and numParams is: 74

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.7582e+01
  </log>
  <optVariables href="H2O.s064.opt.xml">
ci_0001                 7.025033e-01 3 1  ON 0
ci_0002                 6.984648e-01 3 1  ON 1
ci_0003                -3.180731e-02 3 1  ON 2
ci_0004                -3.145667e-02 3 1  ON 3
ci_0005                -2.840096e-02 3 1  ON 4
ci_0006                -2.960667e-02 3 1  ON 5
ci_0007                -1.640383e-02 3 1  ON 6
ci_0008                -1.720683e-02 3 1  ON 7
ci_0009                -1.895173e-02 3 1  ON 8
ci_0010                -1.910375e-02 3 1  ON 9
ci_0011                -1.578658e-02 3 1  ON 10
ci_0012                -1.579539e-02 3 1  ON 11
ci_0013                 1.566465e-02 3 1  ON 12
ci_0014                 1.559544e-02 3 1  ON 13
ci_0015                 1.647515e-02 3 1  ON 14
ci_0016                 1.618819e-02 3 1  ON 15
ci_0017                 1.382650e-02 3 1  ON 16
ci_0018                 1.414408e-02 3 1  ON 17
ci_0019                 1.242385e-02 3 1  ON 18
ci_0020                 1.205415e-02 3 1  ON 19
ci_0021                 1.538463e-02 3 1  ON 20
ci_0022                 1.643230e-02 3 1  ON 21
ci_0023                -1.175688e-02 3 1  ON 22
ci_0024                -1.103565e-02 3 1  ON 23
ci_0025                -2.962356e-03 3 1  ON 24
ci_0026                -2.638596e-03 3 1  ON 25
ci_0027                -1.172508e-02 3 1  ON 26
ci_0028                -1.171525e-02 3 1  ON 27
ci_0029                -1.033798e-02 3 1  ON 28
ci_0030                -1.028118e-02 3 1  ON 29
ci_0031                 1.405318e-02 3 1  ON 30
ci_0032                 1.309430e-02 3 1  ON 31
ci_0033                 8.441836e-03 3 1  ON 32
ci_0034                 8.654285e-03 3 1  ON 33
ci_0035                 5.044255e-03 3 1  ON 34
ci_0036                 4.807458e-03 3 1  ON 35
ci_0037                -1.142452e-02 3 1  ON 36
ci_0038                -1.139774e-02 3 1  ON 37
ci_0039                -3.806253e-03 3 1  ON 38
ci_0040                -3.936052e-03 3 1  ON 39
ci_0041                 9.635370e-03 3 1  ON 40
ci_0042                 9.536979e-03 3 1  ON 41
ci_0043                -6.310007e-03 3 1  ON 42
ci_0044                -6.787204e-03 3 1  ON 43
ci_0045                 1.044565e-02 3 1  ON 44
ci_0046                 9.383024e-03 3 1  ON 45
ci_0047                -3.634834e-03 3 1  ON 46
ci_0048                -3.601652e-03 3 1  ON 47
ci_0049                -2.473354e-03 3 1  ON 48
ci_0050                -2.826600e-03 3 1  ON 49
ci_0051                -1.842443e-03 3 1  ON 50
ci_0052                -1.716936e-03 3 1  ON 51
ci_0053                -4.040409e-03 3 1  ON 52
ci_0054                -3.920435e-03 3 1  ON 53
ci_0055                 2.489610e-03 3 1  ON 54
ci_0056                 2.132468e-03 3 1  ON 55
ci_0057                 2.398090e-03 3 1  ON 56
ci_0058                 3.117127e-03 3 1  ON 57
ci_0059                -4.053990e-03 3 1  ON 58
ci_0060                -3.670175e-03 3 1  ON 59
ci_0061                -2.854060e-03 3 1  ON 60
ci_0062                -3.084770e-03 3 1  ON 61
ci_0063                -9.727837e-03 3 1  ON 62
ci_0064                -9.703516e-03 3 1  ON 63
ci_0065                -7.169449e-03 3 1  ON 64
ci_0066                -6.644579e-03 3 1  ON 65
ci_0067                -3.910453e-03 3 1  ON 66
ci_0068                -3.954713e-03 3 1  ON 67
ci_0069                 3.851531e-03 3 1  ON 68
ci_0070                 3.579467e-03 3 1  ON 69
ci_0071                 4.356980e-03 3 1  ON 70
ci_0072                 4.659695e-03 3 1  ON 71
ci_0073                 3.387904e-03 3 1  ON 72
ci_0074                 3.191719e-03 3 1  ON 73
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 64
    time step          = 0.05
    reference energy   = -16.9641
    reference variance = 0.997845
====================================================
  Execution time = 1.4700e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s064
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6903e+01
  VMC Evar = 3.2059e-01
  Total weights = 1.9515e+06
  Execution time = 1.9777e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.305744914605
                                         uncertainty =       0.001839177246

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.305744914605
                                         uncertainty =       0.001839177246

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000390986830
  error estimate for blocks of size 2^( 2) =       0.000405565437
  error estimate for blocks of size 2^( 3) =       0.000419960676
  error estimate for blocks of size 2^( 4) =       0.000433438585
  error estimate for blocks of size 2^( 5) =       0.000444497604
  error estimate for blocks of size 2^( 6) =       0.000451694621
  error estimate for blocks of size 2^( 7) =       0.000456842090

      target function =      -0.878876376498
              le_mean =     -16.902566226971
             les_mean =     286.017334258212
             stat err =       0.000446618225
             autocorr =       1.304814052308
   target nu stat err =       0.000446618225
   target dn stat err =       0.005230739919
      target stat err =       0.006506303591
              std dev =       0.552938877426
             le_variance =       0.305741402169

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.305717473507
                                         uncertainty =       0.001839900006

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.305717473507
                                         uncertainty =       0.001839900006

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000390968343
  error estimate for blocks of size 2^( 2) =       0.000405558836
  error estimate for blocks of size 2^( 3) =       0.000419966043
  error estimate for blocks of size 2^( 4) =       0.000433454964
  error estimate for blocks of size 2^( 5) =       0.000444521330
  error estimate for blocks of size 2^( 6) =       0.000451716930
  error estimate for blocks of size 2^( 7) =       0.000456862721

      target function =      -0.878146692383
              le_mean =     -16.902564920621
             les_mean =     286.017868448609
             stat err =       0.000446638986
             autocorr =       1.305058775075
   target nu stat err =       0.000446638986
   target dn stat err =       0.005958022195
      target stat err =       0.007390856219
              std dev =       0.552912732928
             le_variance =       0.305712490234

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.305729531493
                                         uncertainty =       0.001839537065

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.305729531493
                                         uncertainty =       0.001839537065

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000390976505
  error estimate for blocks of size 2^( 2) =       0.000405561225
  error estimate for blocks of size 2^( 3) =       0.000419962618
  error estimate for blocks of size 2^( 4) =       0.000433446176
  error estimate for blocks of size 2^( 5) =       0.000444509119
  error estimate for blocks of size 2^( 6) =       0.000451705433
  error estimate for blocks of size 2^( 7) =       0.000456851701

      target function =      -0.878688020584
              le_mean =     -16.902565410783
             les_mean =     286.017453516552
             stat err =       0.000446628107
             autocorr =       1.304940716197
   target nu stat err =       0.000446628107
   target dn stat err =       0.005575770563
      target stat err =       0.006928668188
              std dev =       0.552924275245
             le_variance =       0.305725254155

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.305742850301
                                         uncertainty =       0.001839218615

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.305742850301
                                         uncertainty =       0.001839218615

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000390985448
  error estimate for blocks of size 2^( 2) =       0.000405564884
  error estimate for blocks of size 2^( 3) =       0.000419961084
  error estimate for blocks of size 2^( 4) =       0.000433439726
  error estimate for blocks of size 2^( 5) =       0.000444498771
  error estimate for blocks of size 2^( 6) =       0.000451695789
  error estimate for blocks of size 2^( 7) =       0.000456843210

      target function =      -0.875031626561
              le_mean =     -16.902566179284
             les_mean =     286.020436446124
             stat err =       0.000446619374
             autocorr =       1.304829988697
   target nu stat err =       0.000446619374
   target dn stat err =       0.006213081078
      target stat err =       0.007650681245
              std dev =       0.552936923018
             le_variance =       0.305739240837


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.878876376498        initial  <--
     1.5259e+00     1.5259e+01             5.5246e-04        -0.878146692383
     6.1035e+00     6.1035e+01             1.3835e-04        -0.878688020584
     2.4414e+01     2.4414e+02             3.4604e-05        -0.875031626561

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 24.5909
  </log>
  <optVariables href="H2O.s064.opt.xml">
ci_0001                 7.026286e-01 3 1  ON 0
ci_0002                 6.983264e-01 3 1  ON 1
ci_0003                -3.182212e-02 3 1  ON 2
ci_0004                -3.149363e-02 3 1  ON 3
ci_0005                -2.842724e-02 3 1  ON 4
ci_0006                -2.963082e-02 3 1  ON 5
ci_0007                -1.645036e-02 3 1  ON 6
ci_0008                -1.722444e-02 3 1  ON 7
ci_0009                -1.895962e-02 3 1  ON 8
ci_0010                -1.909889e-02 3 1  ON 9
ci_0011                -1.578468e-02 3 1  ON 10
ci_0012                -1.579367e-02 3 1  ON 11
ci_0013                 1.568579e-02 3 1  ON 12
ci_0014                 1.561636e-02 3 1  ON 13
ci_0015                 1.648041e-02 3 1  ON 14
ci_0016                 1.619804e-02 3 1  ON 15
ci_0017                 1.384828e-02 3 1  ON 16
ci_0018                 1.415512e-02 3 1  ON 17
ci_0019                 1.244187e-02 3 1  ON 18
ci_0020                 1.205205e-02 3 1  ON 19
ci_0021                 1.540008e-02 3 1  ON 20
ci_0022                 1.641682e-02 3 1  ON 21
ci_0023                -1.177852e-02 3 1  ON 22
ci_0024                -1.103724e-02 3 1  ON 23
ci_0025                -2.994138e-03 3 1  ON 24
ci_0026                -2.660265e-03 3 1  ON 25
ci_0027                -1.174937e-02 3 1  ON 26
ci_0028                -1.172271e-02 3 1  ON 27
ci_0029                -1.034138e-02 3 1  ON 28
ci_0030                -1.028806e-02 3 1  ON 29
ci_0031                 1.407103e-02 3 1  ON 30
ci_0032                 1.310000e-02 3 1  ON 31
ci_0033                 8.464276e-03 3 1  ON 32
ci_0034                 8.666095e-03 3 1  ON 33
ci_0035                 5.043533e-03 3 1  ON 34
ci_0036                 4.829420e-03 3 1  ON 35
ci_0037                -1.143239e-02 3 1  ON 36
ci_0038                -1.140526e-02 3 1  ON 37
ci_0039                -3.805407e-03 3 1  ON 38
ci_0040                -3.934927e-03 3 1  ON 39
ci_0041                 9.637541e-03 3 1  ON 40
ci_0042                 9.535544e-03 3 1  ON 41
ci_0043                -6.344353e-03 3 1  ON 42
ci_0044                -6.773043e-03 3 1  ON 43
ci_0045                 1.046221e-02 3 1  ON 44
ci_0046                 9.382885e-03 3 1  ON 45
ci_0047                -3.646442e-03 3 1  ON 46
ci_0048                -3.597391e-03 3 1  ON 47
ci_0049                -2.506265e-03 3 1  ON 48
ci_0050                -2.824941e-03 3 1  ON 49
ci_0051                -1.834355e-03 3 1  ON 50
ci_0052                -1.716246e-03 3 1  ON 51
ci_0053                -4.041641e-03 3 1  ON 52
ci_0054                -3.940921e-03 3 1  ON 53
ci_0055                 2.510681e-03 3 1  ON 54
ci_0056                 2.142832e-03 3 1  ON 55
ci_0057                 2.393750e-03 3 1  ON 56
ci_0058                 3.127813e-03 3 1  ON 57
ci_0059                -4.060462e-03 3 1  ON 58
ci_0060                -3.656349e-03 3 1  ON 59
ci_0061                -2.868779e-03 3 1  ON 60
ci_0062                -3.082180e-03 3 1  ON 61
ci_0063                -9.741539e-03 3 1  ON 62
ci_0064                -9.714120e-03 3 1  ON 63
ci_0065                -7.182499e-03 3 1  ON 64
ci_0066                -6.637393e-03 3 1  ON 65
ci_0067                -3.946627e-03 3 1  ON 66
ci_0068                -3.959907e-03 3 1  ON 67
ci_0069                 3.827822e-03 3 1  ON 68
ci_0070                 3.584902e-03 3 1  ON 69
ci_0071                 4.380370e-03 3 1  ON 70
ci_0072                 4.652321e-03 3 1  ON 71
ci_0073                 3.394552e-03 3 1  ON 72
ci_0074                 3.189830e-03 3 1  ON 73
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 4.2188e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s065 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s065 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=65  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6898e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 65
    time step          = 0.05
    reference energy   = -16.9621
    reference variance = 0.215965
====================================================
  Execution time = 1.4763e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s065
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5231e+04
  VMC Eavg = -1.6904e+01
  VMC Evar = 3.1622e-01
  Total weights = 1.951554202e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 2.6811e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.304452726149
                                         uncertainty =       0.002113954752

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.304452726149
                                         uncertainty =       0.002113954752

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000390132592
  error estimate for blocks of size 2^( 2) =       0.000404511254
  error estimate for blocks of size 2^( 3) =       0.000419261896
  error estimate for blocks of size 2^( 4) =       0.000432645760
  error estimate for blocks of size 2^( 5) =       0.000443564302
  error estimate for blocks of size 2^( 6) =       0.000449338133
  error estimate for blocks of size 2^( 7) =       0.000451858167

      target function =      -0.884546424710
              le_mean =     -16.903881654876
             les_mean =     286.057430065729
             stat err =       0.000444351591
             autocorr =       1.297265932007
   target nu stat err =       0.000444351591
   target dn stat err =       0.003219093493
      target stat err =       0.004094277763
              std dev =       0.551730802115
             le_variance =       0.304406878003


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690388165488e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 74
Check correct_vf_var_size: 225, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.5259e+01, overlap shift 1.5259e+02 and omega -1.7527e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.884564223718       residual = 9.02e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.884566869757       residual = 1.01e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.884567316058       residual = 2.48e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.884567421339       residual = 1.41e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.884567460810       residual = 6.68e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.884567501110       residual = 1.96e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.884567507797       residual = 5.58e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.884567506746       residual = 3.67e-06           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.884567510850       residual = 1.66e-06           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.884567517249       residual = 8.61e-07           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.884567516687       residual = 7.41e-07           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.884567517951       residual = 5.18e-07           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.884567516596       residual = 5.04e-07           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.884567516375       residual = 1.48e-07           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.884567515495       residual = 2.74e-08           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.884567515376       residual = 5.02e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         15 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 1.5259e+01 is 1.456136e-05

solving harmonic davidson linear method for identity shift 6.1035e+01, overlap shift 6.1035e+02 and omega -1.7527e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.884564223718       residual = 9.02e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.884564887593       residual = 1.01e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.884564999451       residual = 2.48e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.884565025805       residual = 1.40e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.884565035681       residual = 6.66e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.884565045755       residual = 1.95e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.884565047420       residual = 5.54e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.884565047156       residual = 3.64e-06           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.884565048182       residual = 1.65e-06           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.884565049781       residual = 8.57e-07           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.884565049637       residual = 7.37e-07           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.884565049951       residual = 5.15e-07           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.884565049611       residual = 4.97e-07           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.884565049556       residual = 1.45e-07           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.884565049338       residual = 2.68e-08           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.884565049308       residual = 4.92e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         15 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 6.1035e+01 is 3.646935e-06

solving harmonic davidson linear method for identity shift 2.4414e+02, overlap shift 2.4414e+03 and omega -1.7527e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.884564223718       residual = 9.02e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.884564389836       residual = 1.01e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.884564417818       residual = 2.47e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.884564424408       residual = 1.40e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.884564426878       residual = 6.65e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.884564429396       residual = 1.95e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.884564429812       residual = 5.54e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.884564429746       residual = 3.63e-06           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.884564430003       residual = 1.64e-06           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.884564430402       residual = 8.56e-07           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.884564430366       residual = 7.36e-07           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.884564430444       residual = 5.14e-07           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.884564430359       residual = 4.96e-07           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.884564430345       residual = 1.44e-07           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.884564430290       residual = 2.66e-08           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.884564430283       residual = 4.89e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         15 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 2.4414e+02 is 9.121468e-07

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.908625 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 75 and numParams is: 74

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.7465e+01
  </log>
  <optVariables href="H2O.s065.opt.xml">
ci_0001                 7.026277e-01 3 1  ON 0
ci_0002                 6.983281e-01 3 1  ON 1
ci_0003                -3.181927e-02 3 1  ON 2
ci_0004                -3.149201e-02 3 1  ON 3
ci_0005                -2.842400e-02 3 1  ON 4
ci_0006                -2.962994e-02 3 1  ON 5
ci_0007                -1.644672e-02 3 1  ON 6
ci_0008                -1.722316e-02 3 1  ON 7
ci_0009                -1.895914e-02 3 1  ON 8
ci_0010                -1.909759e-02 3 1  ON 9
ci_0011                -1.578411e-02 3 1  ON 10
ci_0012                -1.579329e-02 3 1  ON 11
ci_0013                 1.568458e-02 3 1  ON 12
ci_0014                 1.561558e-02 3 1  ON 13
ci_0015                 1.648063e-02 3 1  ON 14
ci_0016                 1.619716e-02 3 1  ON 15
ci_0017                 1.384779e-02 3 1  ON 16
ci_0018                 1.415319e-02 3 1  ON 17
ci_0019                 1.244231e-02 3 1  ON 18
ci_0020                 1.205162e-02 3 1  ON 19
ci_0021                 1.540164e-02 3 1  ON 20
ci_0022                 1.641679e-02 3 1  ON 21
ci_0023                -1.177751e-02 3 1  ON 22
ci_0024                -1.103797e-02 3 1  ON 23
ci_0025                -2.993586e-03 3 1  ON 24
ci_0026                -2.661688e-03 3 1  ON 25
ci_0027                -1.174976e-02 3 1  ON 26
ci_0028                -1.172180e-02 3 1  ON 27
ci_0029                -1.034064e-02 3 1  ON 28
ci_0030                -1.028755e-02 3 1  ON 29
ci_0031                 1.406991e-02 3 1  ON 30
ci_0032                 1.309947e-02 3 1  ON 31
ci_0033                 8.465207e-03 3 1  ON 32
ci_0034                 8.666221e-03 3 1  ON 33
ci_0035                 5.044160e-03 3 1  ON 34
ci_0036                 4.828361e-03 3 1  ON 35
ci_0037                -1.143282e-02 3 1  ON 36
ci_0038                -1.140510e-02 3 1  ON 37
ci_0039                -3.803867e-03 3 1  ON 38
ci_0040                -3.934290e-03 3 1  ON 39
ci_0041                 9.637454e-03 3 1  ON 40
ci_0042                 9.535188e-03 3 1  ON 41
ci_0043                -6.344650e-03 3 1  ON 42
ci_0044                -6.772878e-03 3 1  ON 43
ci_0045                 1.046161e-02 3 1  ON 44
ci_0046                 9.383167e-03 3 1  ON 45
ci_0047                -3.645088e-03 3 1  ON 46
ci_0048                -3.596573e-03 3 1  ON 47
ci_0049                -2.505490e-03 3 1  ON 48
ci_0050                -2.825852e-03 3 1  ON 49
ci_0051                -1.834656e-03 3 1  ON 50
ci_0052                -1.716047e-03 3 1  ON 51
ci_0053                -4.041599e-03 3 1  ON 52
ci_0054                -3.939796e-03 3 1  ON 53
ci_0055                 2.510001e-03 3 1  ON 54
ci_0056                 2.142058e-03 3 1  ON 55
ci_0057                 2.392977e-03 3 1  ON 56
ci_0058                 3.125343e-03 3 1  ON 57
ci_0059                -4.059220e-03 3 1  ON 58
ci_0060                -3.655101e-03 3 1  ON 59
ci_0061                -2.868640e-03 3 1  ON 60
ci_0062                -3.081966e-03 3 1  ON 61
ci_0063                -9.741462e-03 3 1  ON 62
ci_0064                -9.713881e-03 3 1  ON 63
ci_0065                -7.181438e-03 3 1  ON 64
ci_0066                -6.636552e-03 3 1  ON 65
ci_0067                -3.946669e-03 3 1  ON 66
ci_0068                -3.959256e-03 3 1  ON 67
ci_0069                 3.827691e-03 3 1  ON 68
ci_0070                 3.583320e-03 3 1  ON 69
ci_0071                 4.380641e-03 3 1  ON 70
ci_0072                 4.652553e-03 3 1  ON 71
ci_0073                 3.395888e-03 3 1  ON 72
ci_0074                 3.189647e-03 3 1  ON 73
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 65
    time step          = 0.05
    reference energy   = -16.9364
    reference variance = 0.228087
====================================================
  Execution time = 1.4359e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s065
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6903e+01
  VMC Evar = 3.1591e-01
  Total weights = 1.9519e+06
  Execution time = 1.9560e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.304169931667
                                         uncertainty =       0.002038832467

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.304169931667
                                         uncertainty =       0.002038832467

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000389952485
  error estimate for blocks of size 2^( 2) =       0.000404619215
  error estimate for blocks of size 2^( 3) =       0.000419096661
  error estimate for blocks of size 2^( 4) =       0.000432935256
  error estimate for blocks of size 2^( 5) =       0.000443827075
  error estimate for blocks of size 2^( 6) =       0.000452663750
  error estimate for blocks of size 2^( 7) =       0.000459212071

      target function =      -0.884820670323
              le_mean =     -16.903045865259
             les_mean =     286.028863070996
             stat err =       0.000447159538
             autocorr =       1.314926909263
   target nu stat err =       0.000447159538
   target dn stat err =       0.002802845386
      target stat err =       0.003576429938
              std dev =       0.551476092978
             le_variance =       0.304125881126

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.304169284776
                                         uncertainty =       0.002039767991

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.304169284776
                                         uncertainty =       0.002039767991

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000389952081
  error estimate for blocks of size 2^( 2) =       0.000404619703
  error estimate for blocks of size 2^( 3) =       0.000419098188
  error estimate for blocks of size 2^( 4) =       0.000432937433
  error estimate for blocks of size 2^( 5) =       0.000443829727
  error estimate for blocks of size 2^( 6) =       0.000452666246
  error estimate for blocks of size 2^( 7) =       0.000459214348

      target function =      -0.884797753372
              le_mean =     -16.903045766335
             les_mean =     286.028877953325
             stat err =       0.000447161939
             autocorr =       1.314943752594
   target nu stat err =       0.000447161939
   target dn stat err =       0.002804464096
      target stat err =       0.003578248046
              std dev =       0.551475521716
             le_variance =       0.304125251052

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.304169598423
                                         uncertainty =       0.002039299687

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.304169598423
                                         uncertainty =       0.002039299687

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000389952277
  error estimate for blocks of size 2^( 2) =       0.000404619453
  error estimate for blocks of size 2^( 3) =       0.000419097421
  error estimate for blocks of size 2^( 4) =       0.000432936342
  error estimate for blocks of size 2^( 5) =       0.000443828399
  error estimate for blocks of size 2^( 6) =       0.000452664997
  error estimate for blocks of size 2^( 7) =       0.000459213207

      target function =      -0.884782536473
              le_mean =     -16.903045814497
             les_mean =     286.028891711201
             stat err =       0.000447160736
             autocorr =       1.314935361326
   target nu stat err =       0.000447160736
   target dn stat err =       0.002803822935
      target stat err =       0.003577334547
              std dev =       0.551475798497
             le_variance =       0.304125556328

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.304169889173
                                         uncertainty =       0.002038890744

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.304169889173
                                         uncertainty =       0.002038890744

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000389952458
  error estimate for blocks of size 2^( 2) =       0.000404619244
  error estimate for blocks of size 2^( 3) =       0.000419096755
  error estimate for blocks of size 2^( 4) =       0.000432935391
  error estimate for blocks of size 2^( 5) =       0.000443827240
  error estimate for blocks of size 2^( 6) =       0.000452663906
  error estimate for blocks of size 2^( 7) =       0.000459212213

      target function =      -0.884819819893
              le_mean =     -16.903045858854
             les_mean =     286.028863530215
             stat err =       0.000447159687
             autocorr =       1.314927966905
   target nu stat err =       0.000447159687
   target dn stat err =       0.002802943741
      target stat err =       0.003576544725
              std dev =       0.551476055410
             le_variance =       0.304125839690


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.884820670323        initial  <--
     1.5259e+01     1.5259e+02             1.4561e-05        -0.884797753372
     6.1035e+01     6.1035e+02             3.6469e-06        -0.884782536473
     2.4414e+02     2.4414e+03             9.1215e-07        -0.884819819893

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 24.2235
  </log>
  <optVariables href="H2O.s065.opt.xml">
ci_0001                 7.026286e-01 3 1  ON 0
ci_0002                 6.983264e-01 3 1  ON 1
ci_0003                -3.182212e-02 3 1  ON 2
ci_0004                -3.149363e-02 3 1  ON 3
ci_0005                -2.842724e-02 3 1  ON 4
ci_0006                -2.963082e-02 3 1  ON 5
ci_0007                -1.645036e-02 3 1  ON 6
ci_0008                -1.722444e-02 3 1  ON 7
ci_0009                -1.895962e-02 3 1  ON 8
ci_0010                -1.909889e-02 3 1  ON 9
ci_0011                -1.578468e-02 3 1  ON 10
ci_0012                -1.579367e-02 3 1  ON 11
ci_0013                 1.568579e-02 3 1  ON 12
ci_0014                 1.561636e-02 3 1  ON 13
ci_0015                 1.648041e-02 3 1  ON 14
ci_0016                 1.619804e-02 3 1  ON 15
ci_0017                 1.384828e-02 3 1  ON 16
ci_0018                 1.415512e-02 3 1  ON 17
ci_0019                 1.244187e-02 3 1  ON 18
ci_0020                 1.205205e-02 3 1  ON 19
ci_0021                 1.540008e-02 3 1  ON 20
ci_0022                 1.641682e-02 3 1  ON 21
ci_0023                -1.177852e-02 3 1  ON 22
ci_0024                -1.103724e-02 3 1  ON 23
ci_0025                -2.994138e-03 3 1  ON 24
ci_0026                -2.660265e-03 3 1  ON 25
ci_0027                -1.174937e-02 3 1  ON 26
ci_0028                -1.172271e-02 3 1  ON 27
ci_0029                -1.034138e-02 3 1  ON 28
ci_0030                -1.028806e-02 3 1  ON 29
ci_0031                 1.407103e-02 3 1  ON 30
ci_0032                 1.310000e-02 3 1  ON 31
ci_0033                 8.464276e-03 3 1  ON 32
ci_0034                 8.666095e-03 3 1  ON 33
ci_0035                 5.043533e-03 3 1  ON 34
ci_0036                 4.829420e-03 3 1  ON 35
ci_0037                -1.143239e-02 3 1  ON 36
ci_0038                -1.140526e-02 3 1  ON 37
ci_0039                -3.805407e-03 3 1  ON 38
ci_0040                -3.934927e-03 3 1  ON 39
ci_0041                 9.637541e-03 3 1  ON 40
ci_0042                 9.535544e-03 3 1  ON 41
ci_0043                -6.344353e-03 3 1  ON 42
ci_0044                -6.773043e-03 3 1  ON 43
ci_0045                 1.046221e-02 3 1  ON 44
ci_0046                 9.382885e-03 3 1  ON 45
ci_0047                -3.646442e-03 3 1  ON 46
ci_0048                -3.597391e-03 3 1  ON 47
ci_0049                -2.506265e-03 3 1  ON 48
ci_0050                -2.824941e-03 3 1  ON 49
ci_0051                -1.834355e-03 3 1  ON 50
ci_0052                -1.716246e-03 3 1  ON 51
ci_0053                -4.041641e-03 3 1  ON 52
ci_0054                -3.940921e-03 3 1  ON 53
ci_0055                 2.510681e-03 3 1  ON 54
ci_0056                 2.142832e-03 3 1  ON 55
ci_0057                 2.393750e-03 3 1  ON 56
ci_0058                 3.127813e-03 3 1  ON 57
ci_0059                -4.060462e-03 3 1  ON 58
ci_0060                -3.656349e-03 3 1  ON 59
ci_0061                -2.868779e-03 3 1  ON 60
ci_0062                -3.082180e-03 3 1  ON 61
ci_0063                -9.741539e-03 3 1  ON 62
ci_0064                -9.714120e-03 3 1  ON 63
ci_0065                -7.182499e-03 3 1  ON 64
ci_0066                -6.637393e-03 3 1  ON 65
ci_0067                -3.946627e-03 3 1  ON 66
ci_0068                -3.959907e-03 3 1  ON 67
ci_0069                 3.827822e-03 3 1  ON 68
ci_0070                 3.584902e-03 3 1  ON 69
ci_0071                 4.380370e-03 3 1  ON 70
ci_0072                 4.652321e-03 3 1  ON 71
ci_0073                 3.394552e-03 3 1  ON 72
ci_0074                 3.189830e-03 3 1  ON 73
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 4.1703e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s066 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s066 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=66  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6899e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 66
    time step          = 0.05
    reference energy   = -16.7989
    reference variance = 0.250693
====================================================
  Execution time = 1.4706e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s066
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5250e+04
  VMC Eavg = -1.6903e+01
  VMC Evar = 3.1390e-01
  Total weights = 1.951573975e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 2.6669e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.301755145507
                                         uncertainty =       0.001996510430

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.301755145507
                                         uncertainty =       0.001996510430

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000388412472
  error estimate for blocks of size 2^( 2) =       0.000403008460
  error estimate for blocks of size 2^( 3) =       0.000418111171
  error estimate for blocks of size 2^( 4) =       0.000431698681
  error estimate for blocks of size 2^( 5) =       0.000442331640
  error estimate for blocks of size 2^( 6) =       0.000452382133
  error estimate for blocks of size 2^( 7) =       0.000459555858

      target function =      -0.887313492481
              le_mean =     -16.902846334716
             les_mean =     286.020116307239
             stat err =       0.000446492078
             autocorr =       1.321420934832
   target nu stat err =       0.000446492078
   target dn stat err =       0.002519655119
      target stat err =       0.003243696969
              std dev =       0.549298185232
             le_variance =       0.301728496300


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690284633472e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 74
Check correct_vf_var_size: 225, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.5259e+02, overlap shift 1.5259e+03 and omega -1.7527e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.887324258813       residual = 5.44e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.887324477606       residual = 9.55e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.887324511756       residual = 4.31e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.887324528071       residual = 1.55e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.887324540037       residual = 6.14e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.887324542272       residual = 4.34e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.887324544371       residual = 1.59e-05           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.887324545290       residual = 1.17e-05           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.887324546247       residual = 1.15e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.887324545539       residual = 7.27e-06           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.887324545628       residual = 4.12e-06           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.887324546457       residual = 1.80e-06           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.887324546590       residual = 6.56e-07           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.887324546738       residual = 1.13e-07           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.887324546771       residual = 3.46e-08           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.887324546758       residual = 7.80e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         15 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 1.5259e+02 is 1.741779e-06

solving harmonic davidson linear method for identity shift 6.1035e+02, overlap shift 6.1035e+03 and omega -1.7527e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.887324258813       residual = 5.44e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.887324313531       residual = 9.55e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.887324322070       residual = 4.30e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.887324326150       residual = 1.55e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.887324329141       residual = 6.14e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.887324329700       residual = 4.34e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.887324330224       residual = 1.59e-05           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.887324330454       residual = 1.17e-05           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.887324330693       residual = 1.15e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.887324330517       residual = 7.27e-06           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.887324330539       residual = 4.12e-06           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.887324330746       residual = 1.80e-06           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.887324330779       residual = 6.55e-07           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.887324330816       residual = 1.12e-07           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.887324330825       residual = 3.45e-08           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.887324330823       residual = 7.78e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         15 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 6.1035e+02 is 4.354529e-07

solving harmonic davidson linear method for identity shift 2.4414e+03, overlap shift 2.4414e+04 and omega -1.7527e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.887324258813       residual = 5.44e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.887324272493       residual = 9.55e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.887324274629       residual = 4.30e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.887324275648       residual = 1.55e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.887324276396       residual = 6.14e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.887324276536       residual = 4.34e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.887324276665       residual = 1.59e-05           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.887324276722       residual = 1.17e-05           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.887324276784       residual = 1.15e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.887324276740       residual = 7.27e-06           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.887324276746       residual = 4.12e-06           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.887324276800       residual = 1.80e-06           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.887324276800       residual = 6.55e-07           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.887324276813       residual = 1.12e-07           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.887324276811       residual = 3.45e-08           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.887324276816       residual = 7.78e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         15 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 2.4414e+03 is 1.088637e-07

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.921643 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 75 and numParams is: 74

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.7394e+01
  </log>
  <optVariables href="H2O.s066.opt.xml">
ci_0001                 7.026290e-01 3 1  ON 0
ci_0002                 6.983261e-01 3 1  ON 1
ci_0003                -3.182198e-02 3 1  ON 2
ci_0004                -3.149352e-02 3 1  ON 3
ci_0005                -2.842708e-02 3 1  ON 4
ci_0006                -2.963053e-02 3 1  ON 5
ci_0007                -1.645005e-02 3 1  ON 6
ci_0008                -1.722420e-02 3 1  ON 7
ci_0009                -1.895963e-02 3 1  ON 8
ci_0010                -1.909882e-02 3 1  ON 9
ci_0011                -1.578470e-02 3 1  ON 10
ci_0012                -1.579355e-02 3 1  ON 11
ci_0013                 1.568579e-02 3 1  ON 12
ci_0014                 1.561626e-02 3 1  ON 13
ci_0015                 1.648035e-02 3 1  ON 14
ci_0016                 1.619800e-02 3 1  ON 15
ci_0017                 1.384821e-02 3 1  ON 16
ci_0018                 1.415504e-02 3 1  ON 17
ci_0019                 1.244184e-02 3 1  ON 18
ci_0020                 1.205202e-02 3 1  ON 19
ci_0021                 1.540001e-02 3 1  ON 20
ci_0022                 1.641672e-02 3 1  ON 21
ci_0023                -1.177853e-02 3 1  ON 22
ci_0024                -1.103716e-02 3 1  ON 23
ci_0025                -2.994063e-03 3 1  ON 24
ci_0026                -2.660230e-03 3 1  ON 25
ci_0027                -1.174920e-02 3 1  ON 26
ci_0028                -1.172263e-02 3 1  ON 27
ci_0029                -1.034135e-02 3 1  ON 28
ci_0030                -1.028797e-02 3 1  ON 29
ci_0031                 1.407116e-02 3 1  ON 30
ci_0032                 1.309994e-02 3 1  ON 31
ci_0033                 8.464222e-03 3 1  ON 32
ci_0034                 8.665936e-03 3 1  ON 33
ci_0035                 5.043369e-03 3 1  ON 34
ci_0036                 4.829470e-03 3 1  ON 35
ci_0037                -1.143231e-02 3 1  ON 36
ci_0038                -1.140519e-02 3 1  ON 37
ci_0039                -3.805400e-03 3 1  ON 38
ci_0040                -3.934860e-03 3 1  ON 39
ci_0041                 9.637465e-03 3 1  ON 40
ci_0042                 9.535448e-03 3 1  ON 41
ci_0043                -6.344314e-03 3 1  ON 42
ci_0044                -6.772870e-03 3 1  ON 43
ci_0045                 1.046206e-02 3 1  ON 44
ci_0046                 9.382929e-03 3 1  ON 45
ci_0047                -3.646344e-03 3 1  ON 46
ci_0048                -3.597345e-03 3 1  ON 47
ci_0049                -2.506362e-03 3 1  ON 48
ci_0050                -2.824799e-03 3 1  ON 49
ci_0051                -1.834320e-03 3 1  ON 50
ci_0052                -1.716217e-03 3 1  ON 51
ci_0053                -4.041509e-03 3 1  ON 52
ci_0054                -3.940844e-03 3 1  ON 53
ci_0055                 2.510663e-03 3 1  ON 54
ci_0056                 2.142926e-03 3 1  ON 55
ci_0057                 2.393956e-03 3 1  ON 56
ci_0058                 3.127786e-03 3 1  ON 57
ci_0059                -4.060356e-03 3 1  ON 58
ci_0060                -3.656338e-03 3 1  ON 59
ci_0061                -2.868737e-03 3 1  ON 60
ci_0062                -3.082064e-03 3 1  ON 61
ci_0063                -9.741508e-03 3 1  ON 62
ci_0064                -9.714095e-03 3 1  ON 63
ci_0065                -7.182481e-03 3 1  ON 64
ci_0066                -6.637567e-03 3 1  ON 65
ci_0067                -3.946623e-03 3 1  ON 66
ci_0068                -3.959916e-03 3 1  ON 67
ci_0069                 3.827838e-03 3 1  ON 68
ci_0070                 3.584846e-03 3 1  ON 69
ci_0071                 4.380304e-03 3 1  ON 70
ci_0072                 4.652369e-03 3 1  ON 71
ci_0073                 3.394566e-03 3 1  ON 72
ci_0074                 3.189829e-03 3 1  ON 73
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 66
    time step          = 0.05
    reference energy   = -16.8811
    reference variance = 0.285804
====================================================
  Execution time = 1.4586e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s066
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6902e+01
  VMC Evar = 3.1967e-01
  Total weights = 1.9515e+06
  Execution time = 1.9569e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.308253022174
                                         uncertainty =       0.003259614531

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.308253022174
                                         uncertainty =       0.003259614531

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000392542138
  error estimate for blocks of size 2^( 2) =       0.000407087840
  error estimate for blocks of size 2^( 3) =       0.000422041443
  error estimate for blocks of size 2^( 4) =       0.000435874374
  error estimate for blocks of size 2^( 5) =       0.000447904387
  error estimate for blocks of size 2^( 6) =       0.000454783699
  error estimate for blocks of size 2^( 7) =       0.000460559714

      target function =      -0.879996197436
              le_mean =     -16.902331963577
             les_mean =     286.008494987526
             stat err =       0.000449780543
             autocorr =       1.312891274655
   target nu stat err =       0.000449780543
   target dn stat err =       0.004519261333
      target stat err =       0.005642815256
              std dev =       0.555138415750
             le_variance =       0.308178660642

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.308252728658
                                         uncertainty =       0.003259488038

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.308252728658
                                         uncertainty =       0.003259488038

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000392541951
  error estimate for blocks of size 2^( 2) =       0.000407087723
  error estimate for blocks of size 2^( 3) =       0.000422041402
  error estimate for blocks of size 2^( 4) =       0.000435874380
  error estimate for blocks of size 2^( 5) =       0.000447904443
  error estimate for blocks of size 2^( 6) =       0.000454783756
  error estimate for blocks of size 2^( 7) =       0.000460559824

      target function =      -0.879997291505
              le_mean =     -16.902331965667
             les_mean =     286.008494178499
             stat err =       0.000449780601
             autocorr =       1.312892857859
   target nu stat err =       0.000449780601
   target dn stat err =       0.004519106481
      target stat err =       0.005642638303
              std dev =       0.555138151427
             le_variance =       0.308178367170

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.308252875344
                                         uncertainty =       0.003259551271

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.308252875344
                                         uncertainty =       0.003259551271

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000392542045
  error estimate for blocks of size 2^( 2) =       0.000407087781
  error estimate for blocks of size 2^( 3) =       0.000422041422
  error estimate for blocks of size 2^( 4) =       0.000435874377
  error estimate for blocks of size 2^( 5) =       0.000447904415
  error estimate for blocks of size 2^( 6) =       0.000454783727
  error estimate for blocks of size 2^( 7) =       0.000460559769

      target function =      -0.879996747216
              le_mean =     -16.902331964618
             les_mean =     286.008494580675
             stat err =       0.000449780572
             autocorr =       1.312892066489
   target nu stat err =       0.000449780572
   target dn stat err =       0.004519183850
      target stat err =       0.005642726744
              std dev =       0.555138283524
             le_variance =       0.308178513834

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.308253003814
                                         uncertainty =       0.003259606623

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.308253003814
                                         uncertainty =       0.003259606623

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000392542127
  error estimate for blocks of size 2^( 2) =       0.000407087832
  error estimate for blocks of size 2^( 3) =       0.000422041440
  error estimate for blocks of size 2^( 4) =       0.000435874374
  error estimate for blocks of size 2^( 5) =       0.000447904390
  error estimate for blocks of size 2^( 6) =       0.000454783703
  error estimate for blocks of size 2^( 7) =       0.000460559721

      target function =      -0.879996266453
              le_mean =     -16.902331963707
             les_mean =     286.008494936415
             stat err =       0.000449780547
             autocorr =       1.312891373639
   target nu stat err =       0.000449780547
   target dn stat err =       0.004519251642
      target stat err =       0.005642804189
              std dev =       0.555138399217
             le_variance =       0.308178642285


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.879996197436        initial
     1.5259e+02     1.5259e+03             1.7418e-06        -0.879997291505  <--
     6.1035e+02     6.1035e+03             4.3545e-07        -0.879996747216
     2.4414e+03     2.4414e+04             1.0886e-07        -0.879996266453

*****************************************************************************
Applying the update for shift_i =   1.5259e+02     and shift_s =   1.5259e+03
*****************************************************************************

  Execution time = 2.8014e+01
  </log>
  <optVariables href="H2O.s066.opt.xml">
ci_0001                 7.026303e-01 3 1  ON 0
ci_0002                 6.983250e-01 3 1  ON 1
ci_0003                -3.182157e-02 3 1  ON 2
ci_0004                -3.149316e-02 3 1  ON 3
ci_0005                -2.842659e-02 3 1  ON 4
ci_0006                -2.962967e-02 3 1  ON 5
ci_0007                -1.644912e-02 3 1  ON 6
ci_0008                -1.722348e-02 3 1  ON 7
ci_0009                -1.895967e-02 3 1  ON 8
ci_0010                -1.909861e-02 3 1  ON 9
ci_0011                -1.578476e-02 3 1  ON 10
ci_0012                -1.579317e-02 3 1  ON 11
ci_0013                 1.568577e-02 3 1  ON 12
ci_0014                 1.561595e-02 3 1  ON 13
ci_0015                 1.648019e-02 3 1  ON 14
ci_0016                 1.619785e-02 3 1  ON 15
ci_0017                 1.384798e-02 3 1  ON 16
ci_0018                 1.415481e-02 3 1  ON 17
ci_0019                 1.244174e-02 3 1  ON 18
ci_0020                 1.205193e-02 3 1  ON 19
ci_0021                 1.539980e-02 3 1  ON 20
ci_0022                 1.641640e-02 3 1  ON 21
ci_0023                -1.177855e-02 3 1  ON 22
ci_0024                -1.103693e-02 3 1  ON 23
ci_0025                -2.993839e-03 3 1  ON 24
ci_0026                -2.660127e-03 3 1  ON 25
ci_0027                -1.174871e-02 3 1  ON 26
ci_0028                -1.172237e-02 3 1  ON 27
ci_0029                -1.034127e-02 3 1  ON 28
ci_0030                -1.028772e-02 3 1  ON 29
ci_0031                 1.407155e-02 3 1  ON 30
ci_0032                 1.309976e-02 3 1  ON 31
ci_0033                 8.464059e-03 3 1  ON 32
ci_0034                 8.665462e-03 3 1  ON 33
ci_0035                 5.042876e-03 3 1  ON 34
ci_0036                 4.829622e-03 3 1  ON 35
ci_0037                -1.143208e-02 3 1  ON 36
ci_0038                -1.140496e-02 3 1  ON 37
ci_0039                -3.805379e-03 3 1  ON 38
ci_0040                -3.934659e-03 3 1  ON 39
ci_0041                 9.637239e-03 3 1  ON 40
ci_0042                 9.535161e-03 3 1  ON 41
ci_0043                -6.344199e-03 3 1  ON 42
ci_0044                -6.772352e-03 3 1  ON 43
ci_0045                 1.046163e-02 3 1  ON 44
ci_0046                 9.383058e-03 3 1  ON 45
ci_0047                -3.646051e-03 3 1  ON 46
ci_0048                -3.597207e-03 3 1  ON 47
ci_0049                -2.506655e-03 3 1  ON 48
ci_0050                -2.824376e-03 3 1  ON 49
ci_0051                -1.834214e-03 3 1  ON 50
ci_0052                -1.716133e-03 3 1  ON 51
ci_0053                -4.041114e-03 3 1  ON 52
ci_0054                -3.940612e-03 3 1  ON 53
ci_0055                 2.510609e-03 3 1  ON 54
ci_0056                 2.143209e-03 3 1  ON 55
ci_0057                 2.394574e-03 3 1  ON 56
ci_0058                 3.127706e-03 3 1  ON 57
ci_0059                -4.060037e-03 3 1  ON 58
ci_0060                -3.656304e-03 3 1  ON 59
ci_0061                -2.868611e-03 3 1  ON 60
ci_0062                -3.081716e-03 3 1  ON 61
ci_0063                -9.741416e-03 3 1  ON 62
ci_0064                -9.714022e-03 3 1  ON 63
ci_0065                -7.182427e-03 3 1  ON 64
ci_0066                -6.638089e-03 3 1  ON 65
ci_0067                -3.946608e-03 3 1  ON 66
ci_0068                -3.959943e-03 3 1  ON 67
ci_0069                 3.827887e-03 3 1  ON 68
ci_0070                 3.584678e-03 3 1  ON 69
ci_0071                 4.380105e-03 3 1  ON 70
ci_0072                 4.652511e-03 3 1  ON 71
ci_0073                 3.394609e-03 3 1  ON 72
ci_0074                 3.189828e-03 3 1  ON 73
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 4.5418e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s067 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s067 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=67  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6898e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 67
    time step          = 0.05
    reference energy   = -16.8752
    reference variance = 0.229212
====================================================
  Execution time = 1.4932e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s067
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5252e+04
  VMC Eavg = -1.6903e+01
  VMC Evar = 3.1433e-01
  Total weights = 1.951512554e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 2.7021e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.302045064458
                                         uncertainty =       0.001892779903

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.302045064458
                                         uncertainty =       0.001892779903

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000388567305
  error estimate for blocks of size 2^( 2) =       0.000403325456
  error estimate for blocks of size 2^( 3) =       0.000418346034
  error estimate for blocks of size 2^( 4) =       0.000431681144
  error estimate for blocks of size 2^( 5) =       0.000441784194
  error estimate for blocks of size 2^( 6) =       0.000448962361
  error estimate for blocks of size 2^( 7) =       0.000452311099

      target function =      -0.886832265685
              le_mean =     -16.903257302038
             les_mean =     286.034436827546
             stat err =       0.000443684699
             autocorr =       1.303816261182
   target nu stat err =       0.000443684699
   target dn stat err =       0.002919931964
      target stat err =       0.003738348120
              std dev =       0.549517153037
             le_variance =       0.301969101482


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690325730204e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 74
Check correct_vf_var_size: 225, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 3.8147e+01, overlap shift 3.8147e+02 and omega -1.7527e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.886846964307       residual = 2.71e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.886849337931       residual = 2.42e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.886849710026       residual = 5.08e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.886849785566       residual = 2.49e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.886849828001       residual = 8.45e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.886849851489       residual = 3.28e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.886849862720       residual = 8.66e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.886849864043       residual = 3.60e-06           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.886849865989       residual = 3.97e-06           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.886849864774       residual = 3.11e-06           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.886849865144       residual = 2.24e-06           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.886849864965       residual = 1.40e-06           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.886849866651       residual = 4.68e-07           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.886849867652       residual = 1.61e-07           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.886849867944       residual = 4.82e-08           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.886849867851       residual = 1.17e-08           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.886849867969       residual = 3.78e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         16 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 3.8147e+01 is 5.528991e-06

solving harmonic davidson linear method for identity shift 1.5259e+02, overlap shift 1.5259e+03 and omega -1.7527e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.886846964307       residual = 2.71e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.886847558611       residual = 2.42e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.886847651748       residual = 5.07e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.886847670646       residual = 2.49e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.886847681258       residual = 8.44e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.886847687131       residual = 3.27e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.886847689938       residual = 8.64e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.886847690268       residual = 3.60e-06           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.886847690755       residual = 3.97e-06           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.886847690450       residual = 3.10e-06           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.886847690543       residual = 2.23e-06           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.886847690498       residual = 1.39e-06           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.886847690920       residual = 4.66e-07           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.886847691169       residual = 1.60e-07           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.886847691242       residual = 4.78e-08           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.886847691219       residual = 1.16e-08           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.886847691248       residual = 3.75e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         16 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 1.5259e+02 is 1.383524e-06

solving harmonic davidson linear method for identity shift 6.1035e+02, overlap shift 6.1035e+03 and omega -1.7527e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.886846964307       residual = 2.71e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.886847112939       residual = 2.42e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.886847136230       residual = 5.07e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.886847140956       residual = 2.48e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.886847143609       residual = 8.44e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.886847145078       residual = 3.27e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.886847145779       residual = 8.63e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.886847145861       residual = 3.60e-06           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.886847145984       residual = 3.96e-06           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.886847145907       residual = 3.10e-06           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.886847145930       residual = 2.23e-06           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.886847145919       residual = 1.39e-06           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.886847146024       residual = 4.65e-07           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.886847146088       residual = 1.59e-07           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.886847146104       residual = 4.77e-08           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.886847146099       residual = 1.15e-08           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.886847146106       residual = 3.74e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         16 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 6.1035e+02 is 3.459608e-07

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.930608 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 75 and numParams is: 74

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.7648e+01
  </log>
  <optVariables href="H2O.s067.opt.xml">
ci_0001                 7.026297e-01 3 1  ON 0
ci_0002                 6.983260e-01 3 1  ON 1
ci_0003                -3.182076e-02 3 1  ON 2
ci_0004                -3.149259e-02 3 1  ON 3
ci_0005                -2.842590e-02 3 1  ON 4
ci_0006                -2.962861e-02 3 1  ON 5
ci_0007                -1.644882e-02 3 1  ON 6
ci_0008                -1.722288e-02 3 1  ON 7
ci_0009                -1.895963e-02 3 1  ON 8
ci_0010                -1.909855e-02 3 1  ON 9
ci_0011                -1.578448e-02 3 1  ON 10
ci_0012                -1.579324e-02 3 1  ON 11
ci_0013                 1.568558e-02 3 1  ON 12
ci_0014                 1.561556e-02 3 1  ON 13
ci_0015                 1.647981e-02 3 1  ON 14
ci_0016                 1.619753e-02 3 1  ON 15
ci_0017                 1.384797e-02 3 1  ON 16
ci_0018                 1.415436e-02 3 1  ON 17
ci_0019                 1.244099e-02 3 1  ON 18
ci_0020                 1.205202e-02 3 1  ON 19
ci_0021                 1.539886e-02 3 1  ON 20
ci_0022                 1.641618e-02 3 1  ON 21
ci_0023                -1.177843e-02 3 1  ON 22
ci_0024                -1.103721e-02 3 1  ON 23
ci_0025                -2.992802e-03 3 1  ON 24
ci_0026                -2.659709e-03 3 1  ON 25
ci_0027                -1.174834e-02 3 1  ON 26
ci_0028                -1.172216e-02 3 1  ON 27
ci_0029                -1.034062e-02 3 1  ON 28
ci_0030                -1.028769e-02 3 1  ON 29
ci_0031                 1.407130e-02 3 1  ON 30
ci_0032                 1.309990e-02 3 1  ON 31
ci_0033                 8.464114e-03 3 1  ON 32
ci_0034                 8.664079e-03 3 1  ON 33
ci_0035                 5.043669e-03 3 1  ON 34
ci_0036                 4.829062e-03 3 1  ON 35
ci_0037                -1.143221e-02 3 1  ON 36
ci_0038                -1.140465e-02 3 1  ON 37
ci_0039                -3.805143e-03 3 1  ON 38
ci_0040                -3.934538e-03 3 1  ON 39
ci_0041                 9.637068e-03 3 1  ON 40
ci_0042                 9.534910e-03 3 1  ON 41
ci_0043                -6.344203e-03 3 1  ON 42
ci_0044                -6.772917e-03 3 1  ON 43
ci_0045                 1.046126e-02 3 1  ON 44
ci_0046                 9.382995e-03 3 1  ON 45
ci_0047                -3.645720e-03 3 1  ON 46
ci_0048                -3.596837e-03 3 1  ON 47
ci_0049                -2.506184e-03 3 1  ON 48
ci_0050                -2.823883e-03 3 1  ON 49
ci_0051                -1.834453e-03 3 1  ON 50
ci_0052                -1.716275e-03 3 1  ON 51
ci_0053                -4.039993e-03 3 1  ON 52
ci_0054                -3.940118e-03 3 1  ON 53
ci_0055                 2.509922e-03 3 1  ON 54
ci_0056                 2.144007e-03 3 1  ON 55
ci_0057                 2.393756e-03 3 1  ON 56
ci_0058                 3.127245e-03 3 1  ON 57
ci_0059                -4.060397e-03 3 1  ON 58
ci_0060                -3.656065e-03 3 1  ON 59
ci_0061                -2.867992e-03 3 1  ON 60
ci_0062                -3.081375e-03 3 1  ON 61
ci_0063                -9.741403e-03 3 1  ON 62
ci_0064                -9.713795e-03 3 1  ON 63
ci_0065                -7.182030e-03 3 1  ON 64
ci_0066                -6.637608e-03 3 1  ON 65
ci_0067                -3.947981e-03 3 1  ON 66
ci_0068                -3.959553e-03 3 1  ON 67
ci_0069                 3.827577e-03 3 1  ON 68
ci_0070                 3.584157e-03 3 1  ON 69
ci_0071                 4.380313e-03 3 1  ON 70
ci_0072                 4.651889e-03 3 1  ON 71
ci_0073                 3.394462e-03 3 1  ON 72
ci_0074                 3.189876e-03 3 1  ON 73
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 67
    time step          = 0.05
    reference energy   = -16.93
    reference variance = 0.356572
====================================================
  Execution time = 1.4513e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s067
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6903e+01
  VMC Evar = 3.1795e-01
  Total weights = 1.9519e+06
  Execution time = 1.9624e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.305969220726
                                         uncertainty =       0.002181000121

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.305969220726
                                         uncertainty =       0.002181000121

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000391127635
  error estimate for blocks of size 2^( 2) =       0.000405803297
  error estimate for blocks of size 2^( 3) =       0.000420136359
  error estimate for blocks of size 2^( 4) =       0.000434006736
  error estimate for blocks of size 2^( 5) =       0.000444959055
  error estimate for blocks of size 2^( 6) =       0.000453742027
  error estimate for blocks of size 2^( 7) =       0.000458354855

      target function =      -0.882287308099
              le_mean =     -16.903249736088
             les_mean =     286.037801539128
             stat err =       0.000447765668
             autocorr =       1.310583148815
   target nu stat err =       0.000447765668
   target dn stat err =       0.002820156762
      target stat err =       0.003578895075
              std dev =       0.553138005679
             le_variance =       0.305961653327

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.305969737364
                                         uncertainty =       0.002181097464

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.305969737364
                                         uncertainty =       0.002181097464

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000391127974
  error estimate for blocks of size 2^( 2) =       0.000405803848
  error estimate for blocks of size 2^( 3) =       0.000420137137
  error estimate for blocks of size 2^( 4) =       0.000434007691
  error estimate for blocks of size 2^( 5) =       0.000444960016
  error estimate for blocks of size 2^( 6) =       0.000453743059
  error estimate for blocks of size 2^( 7) =       0.000458355917

      target function =      -0.882294068914
              le_mean =     -16.903249732047
             les_mean =     286.037795988943
             stat err =       0.000447766671
             autocorr =       1.310586747035
   target nu stat err =       0.000447766671
   target dn stat err =       0.002820141930
      target stat err =       0.003578931060
              std dev =       0.553138484902
             le_variance =       0.305962183479

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.305969477885
                                         uncertainty =       0.002181048761

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.305969477885
                                         uncertainty =       0.002181048761

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000391127803
  error estimate for blocks of size 2^( 2) =       0.000405803572
  error estimate for blocks of size 2^( 3) =       0.000420136748
  error estimate for blocks of size 2^( 4) =       0.000434007213
  error estimate for blocks of size 2^( 5) =       0.000444959535
  error estimate for blocks of size 2^( 6) =       0.000453742543
  error estimate for blocks of size 2^( 7) =       0.000458355386

      target function =      -0.882290839080
              le_mean =     -16.903249733920
             les_mean =     286.037798638488
             stat err =       0.000447766169
             autocorr =       1.310584951861
   target nu stat err =       0.000447766169
   target dn stat err =       0.002820147078
      target stat err =       0.003578911481
              std dev =       0.553138244248
             le_variance =       0.305961917250

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.305969252712
                                         uncertainty =       0.002181006193

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.305969252712
                                         uncertainty =       0.002181006193

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000391127656
  error estimate for blocks of size 2^( 2) =       0.000405803332
  error estimate for blocks of size 2^( 3) =       0.000420136407
  error estimate for blocks of size 2^( 4) =       0.000434006795
  error estimate for blocks of size 2^( 5) =       0.000444959115
  error estimate for blocks of size 2^( 6) =       0.000453742092
  error estimate for blocks of size 2^( 7) =       0.000458354921

      target function =      -0.882287766787
              le_mean =     -16.903249735800
             les_mean =     286.037801162125
             stat err =       0.000447765731
             autocorr =       1.310583374457
   target nu stat err =       0.000447765731
   target dn stat err =       0.002820155275
      target stat err =       0.003578896924
              std dev =       0.553138035357
             le_variance =       0.305961686158


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.882287308099        initial
     3.8147e+01     3.8147e+02             5.5290e-06        -0.882294068914  <--
     1.5259e+02     1.5259e+03             1.3835e-06        -0.882290839080
     6.1035e+02     6.1035e+03             3.4596e-07        -0.882287766787

*****************************************************************************
Applying the update for shift_i =   3.8147e+01     and shift_s =   3.8147e+02
*****************************************************************************

  Execution time = 2.4420e+01
  </log>
  <optVariables href="H2O.s067.opt.xml">
ci_0001                 7.026276e-01 3 1  ON 0
ci_0002                 6.983291e-01 3 1  ON 1
ci_0003                -3.181832e-02 3 1  ON 2
ci_0004                -3.149088e-02 3 1  ON 3
ci_0005                -2.842382e-02 3 1  ON 4
ci_0006                -2.962543e-02 3 1  ON 5
ci_0007                -1.644793e-02 3 1  ON 6
ci_0008                -1.722110e-02 3 1  ON 7
ci_0009                -1.895951e-02 3 1  ON 8
ci_0010                -1.909838e-02 3 1  ON 9
ci_0011                -1.578365e-02 3 1  ON 10
ci_0012                -1.579343e-02 3 1  ON 11
ci_0013                 1.568500e-02 3 1  ON 12
ci_0014                 1.561439e-02 3 1  ON 13
ci_0015                 1.647866e-02 3 1  ON 14
ci_0016                 1.619659e-02 3 1  ON 15
ci_0017                 1.384792e-02 3 1  ON 16
ci_0018                 1.415301e-02 3 1  ON 17
ci_0019                 1.243874e-02 3 1  ON 18
ci_0020                 1.205227e-02 3 1  ON 19
ci_0021                 1.539603e-02 3 1  ON 20
ci_0022                 1.641551e-02 3 1  ON 21
ci_0023                -1.177808e-02 3 1  ON 22
ci_0024                -1.103804e-02 3 1  ON 23
ci_0025                -2.989699e-03 3 1  ON 24
ci_0026                -2.658459e-03 3 1  ON 25
ci_0027                -1.174723e-02 3 1  ON 26
ci_0028                -1.172153e-02 3 1  ON 27
ci_0029                -1.033867e-02 3 1  ON 28
ci_0030                -1.028763e-02 3 1  ON 29
ci_0031                 1.407055e-02 3 1  ON 30
ci_0032                 1.310031e-02 3 1  ON 31
ci_0033                 8.464281e-03 3 1  ON 32
ci_0034                 8.659933e-03 3 1  ON 33
ci_0035                 5.046043e-03 3 1  ON 34
ci_0036                 4.827386e-03 3 1  ON 35
ci_0037                -1.143260e-02 3 1  ON 36
ci_0038                -1.140373e-02 3 1  ON 37
ci_0039                -3.804439e-03 3 1  ON 38
ci_0040                -3.934174e-03 3 1  ON 39
ci_0041                 9.636554e-03 3 1  ON 40
ci_0042                 9.534158e-03 3 1  ON 41
ci_0043                -6.344212e-03 3 1  ON 42
ci_0044                -6.774611e-03 3 1  ON 43
ci_0045                 1.046015e-02 3 1  ON 44
ci_0046                 9.382806e-03 3 1  ON 45
ci_0047                -3.644728e-03 3 1  ON 46
ci_0048                -3.595727e-03 3 1  ON 47
ci_0049                -2.504776e-03 3 1  ON 48
ci_0050                -2.822409e-03 3 1  ON 49
ci_0051                -1.835167e-03 3 1  ON 50
ci_0052                -1.716702e-03 3 1  ON 51
ci_0053                -4.036638e-03 3 1  ON 52
ci_0054                -3.938637e-03 3 1  ON 53
ci_0055                 2.507865e-03 3 1  ON 54
ci_0056                 2.146398e-03 3 1  ON 55
ci_0057                 2.391305e-03 3 1  ON 56
ci_0058                 3.125867e-03 3 1  ON 57
ci_0059                -4.061475e-03 3 1  ON 58
ci_0060                -3.655349e-03 3 1  ON 59
ci_0061                -2.866138e-03 3 1  ON 60
ci_0062                -3.080353e-03 3 1  ON 61
ci_0063                -9.741364e-03 3 1  ON 62
ci_0064                -9.713115e-03 3 1  ON 63
ci_0065                -7.180841e-03 3 1  ON 64
ci_0066                -6.636168e-03 3 1  ON 65
ci_0067                -3.952089e-03 3 1  ON 66
ci_0068                -3.958386e-03 3 1  ON 67
ci_0069                 3.826649e-03 3 1  ON 68
ci_0070                 3.582595e-03 3 1  ON 69
ci_0071                 4.380936e-03 3 1  ON 70
ci_0072                 4.650027e-03 3 1  ON 71
ci_0073                 3.394022e-03 3 1  ON 72
ci_0074                 3.190021e-03 3 1  ON 73
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 4.2074e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s068 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s068 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=68  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6898e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 68
    time step          = 0.05
    reference energy   = -16.8796
    reference variance = 0.266559
====================================================
  Execution time = 1.4928e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s068
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5229e+04
  VMC Eavg = -1.6903e+01
  VMC Evar = 3.1966e-01
  Total weights = 1.951396778e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 2.6687e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.306640536331
                                         uncertainty =       0.002288551488

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.306640536331
                                         uncertainty =       0.002288551488

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000391547504
  error estimate for blocks of size 2^( 2) =       0.000406292460
  error estimate for blocks of size 2^( 3) =       0.000421345539
  error estimate for blocks of size 2^( 4) =       0.000435712139
  error estimate for blocks of size 2^( 5) =       0.000447900601
  error estimate for blocks of size 2^( 6) =       0.000457038542
  error estimate for blocks of size 2^( 7) =       0.000464361947

      target function =      -0.880055275989
              le_mean =     -16.902591497793
             les_mean =     286.017263373224
             stat err =       0.000451253307
             autocorr =       1.328225687556
   target nu stat err =       0.000451253307
   target dn stat err =       0.003312010923
      target stat err =       0.004160391277
              std dev =       0.553731790606
             le_variance =       0.306618895927


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690259149779e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 74
Check correct_vf_var_size: 225, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 9.5367e+00, overlap shift 9.5367e+01 and omega -1.7527e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.880074043467       residual = 9.93e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.880078362708       residual = 2.00e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.880079303996       residual = 6.56e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.880079917554       residual = 2.85e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.880080103815       residual = 1.30e-04           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.880080147796       residual = 9.52e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.880080187193       residual = 4.24e-05           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.880080218446       residual = 4.30e-05           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.880080271424       residual = 3.23e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.880080262644       residual = 1.93e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.880080285390       residual = 9.40e-06           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.880080312428       residual = 3.06e-06           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.880080327365       residual = 1.16e-06           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.880080333439       residual = 2.33e-07           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.880080336794       residual = 5.19e-08           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.880080336780       residual = 1.20e-08           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.880080337507       residual = 2.56e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         16 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 9.5367e+00 is 4.555776e-05

solving harmonic davidson linear method for identity shift 3.8147e+01, overlap shift 3.8147e+02 and omega -1.7527e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.880074043467       residual = 9.93e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.880075129588       residual = 2.00e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.880075365990       residual = 6.55e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.880075519832       residual = 2.83e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.880075566439       residual = 1.30e-04           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.880075577392       residual = 9.46e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.880075587223       residual = 4.22e-05           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.880075595047       residual = 4.28e-05           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.880075608274       residual = 3.20e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.880075606056       residual = 1.90e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.880075611731       residual = 9.22e-06           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.880075618453       residual = 2.99e-06           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.880075622149       residual = 1.13e-06           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.880075623648       residual = 2.26e-07           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.880075624475       residual = 5.01e-08           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.880075624470       residual = 1.16e-08           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.880075624649       residual = 2.46e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         16 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 3.8147e+01 is 1.139428e-05

solving harmonic davidson linear method for identity shift 1.5259e+02, overlap shift 1.5259e+03 and omega -1.7527e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.880074043467       residual = 9.93e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.880074315395       residual = 2.00e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.880074374563       residual = 6.54e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.880074413052       residual = 2.83e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.880074424706       residual = 1.29e-04           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.880074427442       residual = 9.44e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.880074429898       residual = 4.21e-05           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.880074431855       residual = 4.27e-05           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.880074435161       residual = 3.19e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.880074434605       residual = 1.89e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.880074436023       residual = 9.18e-06           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.880074437701       residual = 2.97e-06           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.880074438622       residual = 1.12e-06           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.880074438996       residual = 2.24e-07           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.880074439202       residual = 4.96e-08           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.880074439200       residual = 1.15e-08           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.880074439246       residual = 2.44e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         16 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 1.5259e+02 is 2.848875e-06

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.939588 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 75 and numParams is: 74

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.7611e+01
  </log>
  <optVariables href="H2O.s068.opt.xml">
ci_0001                 7.026390e-01 3 1  ON 0
ci_0002                 6.983192e-01 3 1  ON 1
ci_0003                -3.181632e-02 3 1  ON 2
ci_0004                -3.148928e-02 3 1  ON 3
ci_0005                -2.842017e-02 3 1  ON 4
ci_0006                -2.961948e-02 3 1  ON 5
ci_0007                -1.644557e-02 3 1  ON 6
ci_0008                -1.721592e-02 3 1  ON 7
ci_0009                -1.895942e-02 3 1  ON 8
ci_0010                -1.909764e-02 3 1  ON 9
ci_0011                -1.578152e-02 3 1  ON 10
ci_0012                -1.579378e-02 3 1  ON 11
ci_0013                 1.568283e-02 3 1  ON 12
ci_0014                 1.561236e-02 3 1  ON 13
ci_0015                 1.647652e-02 3 1  ON 14
ci_0016                 1.619437e-02 3 1  ON 15
ci_0017                 1.384724e-02 3 1  ON 16
ci_0018                 1.415101e-02 3 1  ON 17
ci_0019                 1.243863e-02 3 1  ON 18
ci_0020                 1.205360e-02 3 1  ON 19
ci_0021                 1.539278e-02 3 1  ON 20
ci_0022                 1.641547e-02 3 1  ON 21
ci_0023                -1.177716e-02 3 1  ON 22
ci_0024                -1.103806e-02 3 1  ON 23
ci_0025                -2.987034e-03 3 1  ON 24
ci_0026                -2.654901e-03 3 1  ON 25
ci_0027                -1.174788e-02 3 1  ON 26
ci_0028                -1.171894e-02 3 1  ON 27
ci_0029                -1.033828e-02 3 1  ON 28
ci_0030                -1.028486e-02 3 1  ON 29
ci_0031                 1.406876e-02 3 1  ON 30
ci_0032                 1.309930e-02 3 1  ON 31
ci_0033                 8.462654e-03 3 1  ON 32
ci_0034                 8.657097e-03 3 1  ON 33
ci_0035                 5.045989e-03 3 1  ON 34
ci_0036                 4.828975e-03 3 1  ON 35
ci_0037                -1.143057e-02 3 1  ON 36
ci_0038                -1.140205e-02 3 1  ON 37
ci_0039                -3.803940e-03 3 1  ON 38
ci_0040                -3.933385e-03 3 1  ON 39
ci_0041                 9.636523e-03 3 1  ON 40
ci_0042                 9.533038e-03 3 1  ON 41
ci_0043                -6.343050e-03 3 1  ON 42
ci_0044                -6.773350e-03 3 1  ON 43
ci_0045                 1.045701e-02 3 1  ON 44
ci_0046                 9.381353e-03 3 1  ON 45
ci_0047                -3.645199e-03 3 1  ON 46
ci_0048                -3.594895e-03 3 1  ON 47
ci_0049                -2.506066e-03 3 1  ON 48
ci_0050                -2.820565e-03 3 1  ON 49
ci_0051                -1.833335e-03 3 1  ON 50
ci_0052                -1.717759e-03 3 1  ON 51
ci_0053                -4.036419e-03 3 1  ON 52
ci_0054                -3.936070e-03 3 1  ON 53
ci_0055                 2.508098e-03 3 1  ON 54
ci_0056                 2.144444e-03 3 1  ON 55
ci_0057                 2.390886e-03 3 1  ON 56
ci_0058                 3.125297e-03 3 1  ON 57
ci_0059                -4.062002e-03 3 1  ON 58
ci_0060                -3.654381e-03 3 1  ON 59
ci_0061                -2.866630e-03 3 1  ON 60
ci_0062                -3.081224e-03 3 1  ON 61
ci_0063                -9.740035e-03 3 1  ON 62
ci_0064                -9.713101e-03 3 1  ON 63
ci_0065                -7.179519e-03 3 1  ON 64
ci_0066                -6.634697e-03 3 1  ON 65
ci_0067                -3.951741e-03 3 1  ON 66
ci_0068                -3.956068e-03 3 1  ON 67
ci_0069                 3.824523e-03 3 1  ON 68
ci_0070                 3.581924e-03 3 1  ON 69
ci_0071                 4.381512e-03 3 1  ON 70
ci_0072                 4.646726e-03 3 1  ON 71
ci_0073                 3.394075e-03 3 1  ON 72
ci_0074                 3.189215e-03 3 1  ON 73
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 68
    time step          = 0.05
    reference energy   = -16.9774
    reference variance = 0.246488
====================================================
  Execution time = 1.4593e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s068
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6903e+01
  VMC Evar = 3.1697e-01
  Total weights = 1.9517e+06
  Execution time = 1.9506e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.306344141102
                                         uncertainty =       0.002840242313

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.306344141102
                                         uncertainty =       0.002840242313

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000391334998
  error estimate for blocks of size 2^( 2) =       0.000405960583
  error estimate for blocks of size 2^( 3) =       0.000421664793
  error estimate for blocks of size 2^( 4) =       0.000435245603
  error estimate for blocks of size 2^( 5) =       0.000447271115
  error estimate for blocks of size 2^( 6) =       0.000456912111
  error estimate for blocks of size 2^( 7) =       0.000464282001

      target function =      -0.883462826193
              le_mean =     -16.902906861142
             les_mean =     286.025219620510
             stat err =       0.000450927708
             autocorr =       1.327750469191
   target nu stat err =       0.000450927708
   target dn stat err =       0.003959603732
      target stat err =       0.004997005623
              std dev =       0.553431261867
             le_variance =       0.306286161612

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.306340213105
                                         uncertainty =       0.002840709253

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.306340213105
                                         uncertainty =       0.002840709253

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000391332479
  error estimate for blocks of size 2^( 2) =       0.000405959556
  error estimate for blocks of size 2^( 3) =       0.000421665013
  error estimate for blocks of size 2^( 4) =       0.000435246775
  error estimate for blocks of size 2^( 5) =       0.000447272905
  error estimate for blocks of size 2^( 6) =       0.000456913411
  error estimate for blocks of size 2^( 7) =       0.000464283836

      target function =      -0.883403296285
              le_mean =     -16.902906989477
             les_mean =     286.025271531427
             stat err =       0.000450929232
             autocorr =       1.327776543094
   target nu stat err =       0.000450929232
   target dn stat err =       0.003960480737
      target stat err =       0.004997427622
              std dev =       0.553427698494
             le_variance =       0.306282217460

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.306342151154
                                         uncertainty =       0.002840476492

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.306342151154
                                         uncertainty =       0.002840476492

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000391333722
  error estimate for blocks of size 2^( 2) =       0.000405960054
  error estimate for blocks of size 2^( 3) =       0.000421664891
  error estimate for blocks of size 2^( 4) =       0.000435246179
  error estimate for blocks of size 2^( 5) =       0.000447272006
  error estimate for blocks of size 2^( 6) =       0.000456912753
  error estimate for blocks of size 2^( 7) =       0.000464282921

      target function =      -0.883219821861
              le_mean =     -16.902906923598
             les_mean =     286.025415900090
             stat err =       0.000450928465
             autocorr =       1.327763591058
   target nu stat err =       0.000450928465
   target dn stat err =       0.003964621114
      target stat err =       0.005000505485
              std dev =       0.553429456708
             le_variance =       0.306284163552

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.306343890199
                                         uncertainty =       0.002840271559

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.306343890199
                                         uncertainty =       0.002840271559

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000391334837
  error estimate for blocks of size 2^( 2) =       0.000405960515
  error estimate for blocks of size 2^( 3) =       0.000421664804
  error estimate for blocks of size 2^( 4) =       0.000435245674
  error estimate for blocks of size 2^( 5) =       0.000447271224
  error estimate for blocks of size 2^( 6) =       0.000456912188
  error estimate for blocks of size 2^( 7) =       0.000464282113

      target function =      -0.883461733818
              le_mean =     -16.902906868471
             les_mean =     286.025220741662
             stat err =       0.000450927800
             autocorr =       1.327752106363
   target nu stat err =       0.000450927800
   target dn stat err =       0.003959630270
      target stat err =       0.004997026387
              std dev =       0.553431034271
             le_variance =       0.306285909694


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.883462826193        initial  <--
     9.5367e+00     9.5367e+01             4.5558e-05        -0.883403296285
     3.8147e+01     3.8147e+02             1.1394e-05        -0.883219821861
     1.5259e+02     1.5259e+03             2.8489e-06        -0.883461733818

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 24.4506
  </log>
  <optVariables href="H2O.s068.opt.xml">
ci_0001                 7.026276e-01 3 1  ON 0
ci_0002                 6.983291e-01 3 1  ON 1
ci_0003                -3.181832e-02 3 1  ON 2
ci_0004                -3.149088e-02 3 1  ON 3
ci_0005                -2.842382e-02 3 1  ON 4
ci_0006                -2.962543e-02 3 1  ON 5
ci_0007                -1.644793e-02 3 1  ON 6
ci_0008                -1.722110e-02 3 1  ON 7
ci_0009                -1.895951e-02 3 1  ON 8
ci_0010                -1.909838e-02 3 1  ON 9
ci_0011                -1.578365e-02 3 1  ON 10
ci_0012                -1.579343e-02 3 1  ON 11
ci_0013                 1.568500e-02 3 1  ON 12
ci_0014                 1.561439e-02 3 1  ON 13
ci_0015                 1.647866e-02 3 1  ON 14
ci_0016                 1.619659e-02 3 1  ON 15
ci_0017                 1.384792e-02 3 1  ON 16
ci_0018                 1.415301e-02 3 1  ON 17
ci_0019                 1.243874e-02 3 1  ON 18
ci_0020                 1.205227e-02 3 1  ON 19
ci_0021                 1.539603e-02 3 1  ON 20
ci_0022                 1.641551e-02 3 1  ON 21
ci_0023                -1.177808e-02 3 1  ON 22
ci_0024                -1.103804e-02 3 1  ON 23
ci_0025                -2.989699e-03 3 1  ON 24
ci_0026                -2.658459e-03 3 1  ON 25
ci_0027                -1.174723e-02 3 1  ON 26
ci_0028                -1.172153e-02 3 1  ON 27
ci_0029                -1.033867e-02 3 1  ON 28
ci_0030                -1.028763e-02 3 1  ON 29
ci_0031                 1.407055e-02 3 1  ON 30
ci_0032                 1.310031e-02 3 1  ON 31
ci_0033                 8.464281e-03 3 1  ON 32
ci_0034                 8.659933e-03 3 1  ON 33
ci_0035                 5.046043e-03 3 1  ON 34
ci_0036                 4.827386e-03 3 1  ON 35
ci_0037                -1.143260e-02 3 1  ON 36
ci_0038                -1.140373e-02 3 1  ON 37
ci_0039                -3.804439e-03 3 1  ON 38
ci_0040                -3.934174e-03 3 1  ON 39
ci_0041                 9.636554e-03 3 1  ON 40
ci_0042                 9.534158e-03 3 1  ON 41
ci_0043                -6.344212e-03 3 1  ON 42
ci_0044                -6.774611e-03 3 1  ON 43
ci_0045                 1.046015e-02 3 1  ON 44
ci_0046                 9.382806e-03 3 1  ON 45
ci_0047                -3.644728e-03 3 1  ON 46
ci_0048                -3.595727e-03 3 1  ON 47
ci_0049                -2.504776e-03 3 1  ON 48
ci_0050                -2.822409e-03 3 1  ON 49
ci_0051                -1.835167e-03 3 1  ON 50
ci_0052                -1.716702e-03 3 1  ON 51
ci_0053                -4.036638e-03 3 1  ON 52
ci_0054                -3.938637e-03 3 1  ON 53
ci_0055                 2.507865e-03 3 1  ON 54
ci_0056                 2.146398e-03 3 1  ON 55
ci_0057                 2.391305e-03 3 1  ON 56
ci_0058                 3.125867e-03 3 1  ON 57
ci_0059                -4.061475e-03 3 1  ON 58
ci_0060                -3.655349e-03 3 1  ON 59
ci_0061                -2.866138e-03 3 1  ON 60
ci_0062                -3.080353e-03 3 1  ON 61
ci_0063                -9.741364e-03 3 1  ON 62
ci_0064                -9.713115e-03 3 1  ON 63
ci_0065                -7.180841e-03 3 1  ON 64
ci_0066                -6.636168e-03 3 1  ON 65
ci_0067                -3.952089e-03 3 1  ON 66
ci_0068                -3.958386e-03 3 1  ON 67
ci_0069                 3.826649e-03 3 1  ON 68
ci_0070                 3.582595e-03 3 1  ON 69
ci_0071                 4.380936e-03 3 1  ON 70
ci_0072                 4.650027e-03 3 1  ON 71
ci_0073                 3.394022e-03 3 1  ON 72
ci_0074                 3.190021e-03 3 1  ON 73
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 4.2067e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s069 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s069 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=69  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6899e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 69
    time step          = 0.05
    reference energy   = -16.9121
    reference variance = 0.190092
====================================================
  Execution time = 1.4842e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s069
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5268e+04
  VMC Eavg = -1.6903e+01
  VMC Evar = 3.1589e-01
  Total weights = 1.951652398e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 2.7279e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.303478409472
                                         uncertainty =       0.001759329775

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.303478409472
                                         uncertainty =       0.001759329775

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000389500494
  error estimate for blocks of size 2^( 2) =       0.000404094586
  error estimate for blocks of size 2^( 3) =       0.000418499636
  error estimate for blocks of size 2^( 4) =       0.000431728498
  error estimate for blocks of size 2^( 5) =       0.000443296227
  error estimate for blocks of size 2^( 6) =       0.000451605911
  error estimate for blocks of size 2^( 7) =       0.000456948781

      target function =      -0.884810918591
              le_mean =     -16.902886590125
             les_mean =     286.023467815321
             stat err =       0.000445894854
             autocorr =       1.310535820368
   target nu stat err =       0.000445894854
   target dn stat err =       0.002792303909
      target stat err =       0.003562096570
              std dev =       0.550836880874
             le_variance =       0.303421269331


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690288659012e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 74
Check correct_vf_var_size: 225, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 9.5367e+01, overlap shift 9.5367e+02 and omega -1.7527e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.884824196387       residual = 1.52e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.884824698757       residual = 4.31e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.884824825004       residual = 9.99e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.884824889316       residual = 3.70e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.884824906404       residual = 1.58e-04           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.884824917721       residual = 5.47e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.884824922037       residual = 2.01e-05           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.884824922926       residual = 7.09e-06           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.884824923247       residual = 3.61e-06           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.884824923249       residual = 2.99e-06           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.884824922549       residual = 2.86e-06           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.884824923077       residual = 1.69e-06           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.884824924053       residual = 1.13e-06           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.884824924431       residual = 2.68e-07           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.884824924533       residual = 1.07e-07           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.884824924550       residual = 1.55e-08           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.884824924570       residual = 4.54e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         16 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 9.5367e+01 is 2.203548e-06

solving harmonic davidson linear method for identity shift 3.8147e+02, overlap shift 3.8147e+03 and omega -1.7527e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.884824196387       residual = 1.52e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.884824322056       residual = 4.31e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.884824353633       residual = 9.99e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.884824369717       residual = 3.70e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.884824373990       residual = 1.58e-04           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.884824376819       residual = 5.46e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.884824377897       residual = 2.01e-05           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.884824378120       residual = 7.09e-06           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.884824378199       residual = 3.61e-06           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.884824378201       residual = 2.99e-06           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.884824378025       residual = 2.86e-06           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.884824378157       residual = 1.69e-06           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.884824378401       residual = 1.13e-06           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.884824378494       residual = 2.67e-07           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.884824378522       residual = 1.07e-07           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.884824378526       residual = 1.54e-08           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.884824378531       residual = 4.52e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         16 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 3.8147e+02 is 5.510373e-07

solving harmonic davidson linear method for identity shift 1.5259e+03, overlap shift 1.5259e+04 and omega -1.7527e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.884824196387       residual = 1.52e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.884824227809       residual = 4.31e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.884824235705       residual = 9.99e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.884824239726       residual = 3.70e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.884824240794       residual = 1.58e-04           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.884824241502       residual = 5.46e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.884824241767       residual = 2.01e-05           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.884824241824       residual = 7.09e-06           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.884824241845       residual = 3.61e-06           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.884824241846       residual = 2.99e-06           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.884824241804       residual = 2.86e-06           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.884824241835       residual = 1.69e-06           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.884824241898       residual = 1.13e-06           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.884824241922       residual = 2.67e-07           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.884824241926       residual = 1.07e-07           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.884824241928       residual = 1.54e-08           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.884824241929       residual = 4.52e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         16 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 1.5259e+03 is 1.377687e-07

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.948538 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 75 and numParams is: 74

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.7585e+01
  </log>
  <optVariables href="H2O.s069.opt.xml">
ci_0001                 7.026280e-01 3 1  ON 0
ci_0002                 6.983288e-01 3 1  ON 1
ci_0003                -3.181805e-02 3 1  ON 2
ci_0004                -3.149041e-02 3 1  ON 3
ci_0005                -2.842341e-02 3 1  ON 4
ci_0006                -2.962508e-02 3 1  ON 5
ci_0007                -1.644762e-02 3 1  ON 6
ci_0008                -1.722055e-02 3 1  ON 7
ci_0009                -1.895936e-02 3 1  ON 8
ci_0010                -1.909816e-02 3 1  ON 9
ci_0011                -1.578365e-02 3 1  ON 10
ci_0012                -1.579320e-02 3 1  ON 11
ci_0013                 1.568491e-02 3 1  ON 12
ci_0014                 1.561412e-02 3 1  ON 13
ci_0015                 1.647856e-02 3 1  ON 14
ci_0016                 1.619642e-02 3 1  ON 15
ci_0017                 1.384765e-02 3 1  ON 16
ci_0018                 1.415292e-02 3 1  ON 17
ci_0019                 1.243872e-02 3 1  ON 18
ci_0020                 1.205217e-02 3 1  ON 19
ci_0021                 1.539573e-02 3 1  ON 20
ci_0022                 1.641553e-02 3 1  ON 21
ci_0023                -1.177808e-02 3 1  ON 22
ci_0024                -1.103788e-02 3 1  ON 23
ci_0025                -2.989559e-03 3 1  ON 24
ci_0026                -2.658146e-03 3 1  ON 25
ci_0027                -1.174729e-02 3 1  ON 26
ci_0028                -1.172153e-02 3 1  ON 27
ci_0029                -1.033866e-02 3 1  ON 28
ci_0030                -1.028758e-02 3 1  ON 29
ci_0031                 1.407058e-02 3 1  ON 30
ci_0032                 1.310032e-02 3 1  ON 31
ci_0033                 8.463982e-03 3 1  ON 32
ci_0034                 8.659927e-03 3 1  ON 33
ci_0035                 5.045870e-03 3 1  ON 34
ci_0036                 4.827200e-03 3 1  ON 35
ci_0037                -1.143280e-02 3 1  ON 36
ci_0038                -1.140367e-02 3 1  ON 37
ci_0039                -3.804371e-03 3 1  ON 38
ci_0040                -3.934029e-03 3 1  ON 39
ci_0041                 9.636502e-03 3 1  ON 40
ci_0042                 9.533856e-03 3 1  ON 41
ci_0043                -6.343961e-03 3 1  ON 42
ci_0044                -6.774593e-03 3 1  ON 43
ci_0045                 1.045995e-02 3 1  ON 44
ci_0046                 9.382974e-03 3 1  ON 45
ci_0047                -3.644630e-03 3 1  ON 46
ci_0048                -3.595575e-03 3 1  ON 47
ci_0049                -2.504674e-03 3 1  ON 48
ci_0050                -2.822605e-03 3 1  ON 49
ci_0051                -1.835342e-03 3 1  ON 50
ci_0052                -1.716541e-03 3 1  ON 51
ci_0053                -4.036505e-03 3 1  ON 52
ci_0054                -3.938520e-03 3 1  ON 53
ci_0055                 2.507936e-03 3 1  ON 54
ci_0056                 2.146473e-03 3 1  ON 55
ci_0057                 2.391315e-03 3 1  ON 56
ci_0058                 3.125712e-03 3 1  ON 57
ci_0059                -4.061376e-03 3 1  ON 58
ci_0060                -3.655276e-03 3 1  ON 59
ci_0061                -2.866100e-03 3 1  ON 60
ci_0062                -3.080187e-03 3 1  ON 61
ci_0063                -9.741421e-03 3 1  ON 62
ci_0064                -9.713155e-03 3 1  ON 63
ci_0065                -7.180907e-03 3 1  ON 64
ci_0066                -6.636136e-03 3 1  ON 65
ci_0067                -3.951948e-03 3 1  ON 66
ci_0068                -3.958270e-03 3 1  ON 67
ci_0069                 3.826381e-03 3 1  ON 68
ci_0070                 3.582168e-03 3 1  ON 69
ci_0071                 4.380995e-03 3 1  ON 70
ci_0072                 4.650271e-03 3 1  ON 71
ci_0073                 3.394077e-03 3 1  ON 72
ci_0074                 3.189868e-03 3 1  ON 73
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 69
    time step          = 0.05
    reference energy   = -16.9613
    reference variance = 0.263969
====================================================
  Execution time = 1.4762e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s069
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6904e+01
  VMC Evar = 3.1553e-01
  Total weights = 1.9518e+06
  Execution time = 1.9453e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.303982270888
                                         uncertainty =       0.002117184696

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.303982270888
                                         uncertainty =       0.002117184696

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000389790579
  error estimate for blocks of size 2^( 2) =       0.000404361731
  error estimate for blocks of size 2^( 3) =       0.000418718785
  error estimate for blocks of size 2^( 4) =       0.000432016196
  error estimate for blocks of size 2^( 5) =       0.000444106299
  error estimate for blocks of size 2^( 6) =       0.000451602332
  error estimate for blocks of size 2^( 7) =       0.000455528069

      target function =      -0.885450307471
              le_mean =     -16.904147449979
             les_mean =     286.065732079351
             stat err =       0.000445813224
             autocorr =       1.308106838634
   target nu stat err =       0.000445813224
   target dn stat err =       0.002764243806
      target stat err =       0.003539587911
              std dev =       0.551247123898
             le_variance =       0.303873391606

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.303981703848
                                         uncertainty =       0.002117181019

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.303981703848
                                         uncertainty =       0.002117181019

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000389790216
  error estimate for blocks of size 2^( 2) =       0.000404361533
  error estimate for blocks of size 2^( 3) =       0.000418718727
  error estimate for blocks of size 2^( 4) =       0.000432016231
  error estimate for blocks of size 2^( 5) =       0.000444106371
  error estimate for blocks of size 2^( 6) =       0.000451602446
  error estimate for blocks of size 2^( 7) =       0.000455528115

      target function =      -0.885456412853
              le_mean =     -16.904147463725
             les_mean =     286.065727703401
             stat err =       0.000445813291
             autocorr =       1.308109669738
   target nu stat err =       0.000445813291
   target dn stat err =       0.002763698222
      target stat err =       0.003538959824
              std dev =       0.551246609752
             le_variance =       0.303872824763

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.303981987070
                                         uncertainty =       0.002117182857

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.303981987070
                                         uncertainty =       0.002117182857

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000389790397
  error estimate for blocks of size 2^( 2) =       0.000404361632
  error estimate for blocks of size 2^( 3) =       0.000418718756
  error estimate for blocks of size 2^( 4) =       0.000432016213
  error estimate for blocks of size 2^( 5) =       0.000444106335
  error estimate for blocks of size 2^( 6) =       0.000451602389
  error estimate for blocks of size 2^( 7) =       0.000455528092

      target function =      -0.885453389182
              le_mean =     -16.904147456840
             les_mean =     286.065729867929
             stat err =       0.000445813257
             autocorr =       1.308108254961
   target nu stat err =       0.000445813257
   target dn stat err =       0.002763970128
      target stat err =       0.003539272999
              std dev =       0.551246866555
             le_variance =       0.303873107887

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.303982235390
                                         uncertainty =       0.002117184466

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.303982235390
                                         uncertainty =       0.002117184466

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000389790557
  error estimate for blocks of size 2^( 2) =       0.000404361719
  error estimate for blocks of size 2^( 3) =       0.000418718782
  error estimate for blocks of size 2^( 4) =       0.000432016198
  error estimate for blocks of size 2^( 5) =       0.000444106303
  error estimate for blocks of size 2^( 6) =       0.000451602339
  error estimate for blocks of size 2^( 7) =       0.000455528072

      target function =      -0.885450695638
              le_mean =     -16.904147450835
             les_mean =     286.065731800525
             stat err =       0.000445813228
             autocorr =       1.308107015704
   target nu stat err =       0.000445813228
   target dn stat err =       0.002764209504
      target stat err =       0.003539548455
              std dev =       0.551247091711
             le_variance =       0.303873356120


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.885450307471        initial
     9.5367e+01     9.5367e+02             2.2035e-06        -0.885456412853  <--
     3.8147e+02     3.8147e+03             5.5104e-07        -0.885453389182
     1.5259e+03     1.5259e+04             1.3777e-07        -0.885450695638

*****************************************************************************
Applying the update for shift_i =   9.5367e+01     and shift_s =   9.5367e+02
*****************************************************************************

  Execution time = 2.4584e+01
  </log>
  <optVariables href="H2O.s069.opt.xml">
ci_0001                 7.026294e-01 3 1  ON 0
ci_0002                 6.983279e-01 3 1  ON 1
ci_0003                -3.181724e-02 3 1  ON 2
ci_0004                -3.148901e-02 3 1  ON 3
ci_0005                -2.842218e-02 3 1  ON 4
ci_0006                -2.962401e-02 3 1  ON 5
ci_0007                -1.644668e-02 3 1  ON 6
ci_0008                -1.721890e-02 3 1  ON 7
ci_0009                -1.895890e-02 3 1  ON 8
ci_0010                -1.909750e-02 3 1  ON 9
ci_0011                -1.578365e-02 3 1  ON 10
ci_0012                -1.579250e-02 3 1  ON 11
ci_0013                 1.568465e-02 3 1  ON 12
ci_0014                 1.561332e-02 3 1  ON 13
ci_0015                 1.647826e-02 3 1  ON 14
ci_0016                 1.619591e-02 3 1  ON 15
ci_0017                 1.384683e-02 3 1  ON 16
ci_0018                 1.415263e-02 3 1  ON 17
ci_0019                 1.243864e-02 3 1  ON 18
ci_0020                 1.205189e-02 3 1  ON 19
ci_0021                 1.539481e-02 3 1  ON 20
ci_0022                 1.641557e-02 3 1  ON 21
ci_0023                -1.177808e-02 3 1  ON 22
ci_0024                -1.103740e-02 3 1  ON 23
ci_0025                -2.989141e-03 3 1  ON 24
ci_0026                -2.657205e-03 3 1  ON 25
ci_0027                -1.174745e-02 3 1  ON 26
ci_0028                -1.172155e-02 3 1  ON 27
ci_0029                -1.033862e-02 3 1  ON 28
ci_0030                -1.028745e-02 3 1  ON 29
ci_0031                 1.407069e-02 3 1  ON 30
ci_0032                 1.310034e-02 3 1  ON 31
ci_0033                 8.463088e-03 3 1  ON 32
ci_0034                 8.659909e-03 3 1  ON 33
ci_0035                 5.045352e-03 3 1  ON 34
ci_0036                 4.826642e-03 3 1  ON 35
ci_0037                -1.143341e-02 3 1  ON 36
ci_0038                -1.140350e-02 3 1  ON 37
ci_0039                -3.804166e-03 3 1  ON 38
ci_0040                -3.933594e-03 3 1  ON 39
ci_0041                 9.636346e-03 3 1  ON 40
ci_0042                 9.532949e-03 3 1  ON 41
ci_0043                -6.343207e-03 3 1  ON 42
ci_0044                -6.774538e-03 3 1  ON 43
ci_0045                 1.045936e-02 3 1  ON 44
ci_0046                 9.383476e-03 3 1  ON 45
ci_0047                -3.644338e-03 3 1  ON 46
ci_0048                -3.595117e-03 3 1  ON 47
ci_0049                -2.504369e-03 3 1  ON 48
ci_0050                -2.823194e-03 3 1  ON 49
ci_0051                -1.835866e-03 3 1  ON 50
ci_0052                -1.716059e-03 3 1  ON 51
ci_0053                -4.036108e-03 3 1  ON 52
ci_0054                -3.938166e-03 3 1  ON 53
ci_0055                 2.508147e-03 3 1  ON 54
ci_0056                 2.146698e-03 3 1  ON 55
ci_0057                 2.391345e-03 3 1  ON 56
ci_0058                 3.125245e-03 3 1  ON 57
ci_0059                -4.061080e-03 3 1  ON 58
ci_0060                -3.655057e-03 3 1  ON 59
ci_0061                -2.865987e-03 3 1  ON 60
ci_0062                -3.079689e-03 3 1  ON 61
ci_0063                -9.741593e-03 3 1  ON 62
ci_0064                -9.713274e-03 3 1  ON 63
ci_0065                -7.181106e-03 3 1  ON 64
ci_0066                -6.636042e-03 3 1  ON 65
ci_0067                -3.951524e-03 3 1  ON 66
ci_0068                -3.957921e-03 3 1  ON 67
ci_0069                 3.825577e-03 3 1  ON 68
ci_0070                 3.580888e-03 3 1  ON 69
ci_0071                 4.381171e-03 3 1  ON 70
ci_0072                 4.651004e-03 3 1  ON 71
ci_0073                 3.394244e-03 3 1  ON 72
ci_0074                 3.189409e-03 3 1  ON 73
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 4.2174e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s070 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s070 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=70  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6899e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 70
    time step          = 0.05
    reference energy   = -16.922
    reference variance = 0.302669
====================================================
  Execution time = 1.5106e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s070
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5220e+04
  VMC Eavg = -1.6902e+01
  VMC Evar = 3.2064e-01
  Total weights = 1.951544717e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 2.6711e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.306789763453
                                         uncertainty =       0.003029344920

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.306789763453
                                         uncertainty =       0.003029344920

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000391616321
  error estimate for blocks of size 2^( 2) =       0.000406412092
  error estimate for blocks of size 2^( 3) =       0.000420652781
  error estimate for blocks of size 2^( 4) =       0.000434441310
  error estimate for blocks of size 2^( 5) =       0.000447543227
  error estimate for blocks of size 2^( 6) =       0.000457379887
  error estimate for blocks of size 2^( 7) =       0.000462922875

      target function =      -0.878756200820
              le_mean =     -16.902166468617
             les_mean =     286.003873644081
             stat err =       0.000450571825
             autocorr =       1.323751591284
   target nu stat err =       0.000450571825
   target dn stat err =       0.005243125855
      target stat err =       0.006516154325
              std dev =       0.553829112540
             le_variance =       0.306726685896


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690216646862e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 74
Check correct_vf_var_size: 225, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.3842e+01, overlap shift 2.3842e+02 and omega -1.7527e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.878803226338       residual = 1.13e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.878805359765       residual = 2.19e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.878805811208       residual = 1.06e-03           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.878806028311       residual = 4.08e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.878806164126       residual = 1.61e-04           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.878806215910       residual = 6.18e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.878806223944       residual = 2.42e-05           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.878806237101       residual = 2.17e-05           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.878806245080       residual = 2.73e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.878806256846       residual = 1.56e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.878806259409       residual = 9.98e-06           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.878806263190       residual = 4.52e-06           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.878806263438       residual = 1.73e-06           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.878806263466       residual = 2.98e-07           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.878806263610       residual = 6.86e-08           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.878806263465       residual = 1.12e-08           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.878806263390       residual = 4.72e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         16 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 2.3842e+01 is 1.651154e-05

solving harmonic davidson linear method for identity shift 9.5367e+01, overlap shift 9.5367e+02 and omega -1.7527e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.878803226338       residual = 1.13e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.878803760921       residual = 2.19e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.878803873967       residual = 1.06e-03           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.878803928288       residual = 4.07e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.878803962258       residual = 1.60e-04           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.878803975192       residual = 6.16e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.878803977194       residual = 2.41e-05           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.878803980484       residual = 2.16e-05           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.878803982477       residual = 2.72e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.878803985416       residual = 1.55e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.878803986051       residual = 9.91e-06           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.878803986992       residual = 4.48e-06           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.878803987051       residual = 1.71e-06           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.878803987058       residual = 2.94e-07           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.878803987093       residual = 6.76e-08           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.878803987057       residual = 1.10e-08           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.878803987039       residual = 4.66e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         16 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 9.5367e+01 is 4.132890e-06

solving harmonic davidson linear method for identity shift 3.8147e+02, overlap shift 3.8147e+03 and omega -1.7527e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.878803226338       residual = 1.13e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.878803360061       residual = 2.19e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.878803388334       residual = 1.06e-03           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.878803401918       residual = 4.07e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.878803410411       residual = 1.60e-04           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.878803413643       residual = 6.15e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.878803414143       residual = 2.41e-05           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.878803414967       residual = 2.16e-05           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.878803415463       residual = 2.71e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.878803416198       residual = 1.55e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.878803416357       residual = 9.90e-06           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.878803416592       residual = 4.47e-06           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.878803416608       residual = 1.70e-06           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.878803416609       residual = 2.93e-07           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.878803416617       residual = 6.73e-08           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.878803416609       residual = 1.10e-08           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.878803416602       residual = 4.64e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         16 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 3.8147e+02 is 1.033536e-06

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.957601 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 75 and numParams is: 74

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.7792e+01
  </log>
  <optVariables href="H2O.s070.opt.xml">
ci_0001                 7.026263e-01 3 1  ON 0
ci_0002                 6.983317e-01 3 1  ON 1
ci_0003                -3.181517e-02 3 1  ON 2
ci_0004                -3.148761e-02 3 1  ON 3
ci_0005                -2.841919e-02 3 1  ON 4
ci_0006                -2.962307e-02 3 1  ON 5
ci_0007                -1.644558e-02 3 1  ON 6
ci_0008                -1.721733e-02 3 1  ON 7
ci_0009                -1.895903e-02 3 1  ON 8
ci_0010                -1.909663e-02 3 1  ON 9
ci_0011                -1.578246e-02 3 1  ON 10
ci_0012                -1.579189e-02 3 1  ON 11
ci_0013                 1.568385e-02 3 1  ON 12
ci_0014                 1.561277e-02 3 1  ON 13
ci_0015                 1.647910e-02 3 1  ON 14
ci_0016                 1.619557e-02 3 1  ON 15
ci_0017                 1.384648e-02 3 1  ON 16
ci_0018                 1.415223e-02 3 1  ON 17
ci_0019                 1.243924e-02 3 1  ON 18
ci_0020                 1.205104e-02 3 1  ON 19
ci_0021                 1.539245e-02 3 1  ON 20
ci_0022                 1.641488e-02 3 1  ON 21
ci_0023                -1.177748e-02 3 1  ON 22
ci_0024                -1.103667e-02 3 1  ON 23
ci_0025                -2.987392e-03 3 1  ON 24
ci_0026                -2.656594e-03 3 1  ON 25
ci_0027                -1.174681e-02 3 1  ON 26
ci_0028                -1.172172e-02 3 1  ON 27
ci_0029                -1.033751e-02 3 1  ON 28
ci_0030                -1.028787e-02 3 1  ON 29
ci_0031                 1.407005e-02 3 1  ON 30
ci_0032                 1.309952e-02 3 1  ON 31
ci_0033                 8.463228e-03 3 1  ON 32
ci_0034                 8.660207e-03 3 1  ON 33
ci_0035                 5.045368e-03 3 1  ON 34
ci_0036                 4.826596e-03 3 1  ON 35
ci_0037                -1.143343e-02 3 1  ON 36
ci_0038                -1.140361e-02 3 1  ON 37
ci_0039                -3.804207e-03 3 1  ON 38
ci_0040                -3.932868e-03 3 1  ON 39
ci_0041                 9.635950e-03 3 1  ON 40
ci_0042                 9.533596e-03 3 1  ON 41
ci_0043                -6.339074e-03 3 1  ON 42
ci_0044                -6.773463e-03 3 1  ON 43
ci_0045                 1.045860e-02 3 1  ON 44
ci_0046                 9.383591e-03 3 1  ON 45
ci_0047                -3.643621e-03 3 1  ON 46
ci_0048                -3.594836e-03 3 1  ON 47
ci_0049                -2.504232e-03 3 1  ON 48
ci_0050                -2.821390e-03 3 1  ON 49
ci_0051                -1.836109e-03 3 1  ON 50
ci_0052                -1.715495e-03 3 1  ON 51
ci_0053                -4.035485e-03 3 1  ON 52
ci_0054                -3.937464e-03 3 1  ON 53
ci_0055                 2.507972e-03 3 1  ON 54
ci_0056                 2.146347e-03 3 1  ON 55
ci_0057                 2.391766e-03 3 1  ON 56
ci_0058                 3.125155e-03 3 1  ON 57
ci_0059                -4.059624e-03 3 1  ON 58
ci_0060                -3.654662e-03 3 1  ON 59
ci_0061                -2.865973e-03 3 1  ON 60
ci_0062                -3.079343e-03 3 1  ON 61
ci_0063                -9.741334e-03 3 1  ON 62
ci_0064                -9.713885e-03 3 1  ON 63
ci_0065                -7.181030e-03 3 1  ON 64
ci_0066                -6.635473e-03 3 1  ON 65
ci_0067                -3.951302e-03 3 1  ON 66
ci_0068                -3.957671e-03 3 1  ON 67
ci_0069                 3.825147e-03 3 1  ON 68
ci_0070                 3.580919e-03 3 1  ON 69
ci_0071                 4.380930e-03 3 1  ON 70
ci_0072                 4.651035e-03 3 1  ON 71
ci_0073                 3.394268e-03 3 1  ON 72
ci_0074                 3.188736e-03 3 1  ON 73
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 70
    time step          = 0.05
    reference energy   = -16.9449
    reference variance = 0.278168
====================================================
  Execution time = 1.4344e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s070
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6902e+01
  VMC Evar = 3.2319e-01
  Total weights = 1.9517e+06
  Execution time = 1.9676e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.310936028393
                                         uncertainty =       0.004870888219

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.310936028393
                                         uncertainty =       0.004870888219

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000394277328
  error estimate for blocks of size 2^( 2) =       0.000408843572
  error estimate for blocks of size 2^( 3) =       0.000423916800
  error estimate for blocks of size 2^( 4) =       0.000437557668
  error estimate for blocks of size 2^( 5) =       0.000449111703
  error estimate for blocks of size 2^( 6) =       0.000455408778
  error estimate for blocks of size 2^( 7) =       0.000461252410

      target function =      -0.875618196243
              le_mean =     -16.902211040564
             les_mean =     286.007925294735
             stat err =       0.000450832640
             autocorr =       1.307456031593
   target nu stat err =       0.000450832640
   target dn stat err =       0.005608854976
      target stat err =       0.006917640701
              std dev =       0.557592344141
             le_variance =       0.310909222245

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.310940965293
                                         uncertainty =       0.004876629291

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.310940965293
                                         uncertainty =       0.004876629291

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000394280465
  error estimate for blocks of size 2^( 2) =       0.000408847159
  error estimate for blocks of size 2^( 3) =       0.000423920763
  error estimate for blocks of size 2^( 4) =       0.000437561872
  error estimate for blocks of size 2^( 5) =       0.000449116201
  error estimate for blocks of size 2^( 6) =       0.000455413506
  error estimate for blocks of size 2^( 7) =       0.000461256747

      target function =      -0.875608321807
              le_mean =     -16.902211075532
             les_mean =     286.007934424888
             stat err =       0.000450837081
             autocorr =       1.307460986839
   target nu stat err =       0.000450837081
   target dn stat err =       0.005614936711
      target stat err =       0.006924925267
              std dev =       0.557596781002
             le_variance =       0.310914170183

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.310938491653
                                         uncertainty =       0.004873758035

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.310938491653
                                         uncertainty =       0.004873758035

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000394278893
  error estimate for blocks of size 2^( 2) =       0.000408845363
  error estimate for blocks of size 2^( 3) =       0.000423918779
  error estimate for blocks of size 2^( 4) =       0.000437559768
  error estimate for blocks of size 2^( 5) =       0.000449113950
  error estimate for blocks of size 2^( 6) =       0.000455411140
  error estimate for blocks of size 2^( 7) =       0.000461254577

      target function =      -0.875613444172
              le_mean =     -16.902211057606
             les_mean =     286.007929694038
             stat err =       0.000450834859
             autocorr =       1.307458520689
   target nu stat err =       0.000450834859
   target dn stat err =       0.005611894922
      target stat err =       0.006921284800
              std dev =       0.557594557931
             le_variance =       0.310911691034

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.310936335709
                                         uncertainty =       0.004871246690

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.310936335709
                                         uncertainty =       0.004871246690

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000394277523
  error estimate for blocks of size 2^( 2) =       0.000408843796
  error estimate for blocks of size 2^( 3) =       0.000423917047
  error estimate for blocks of size 2^( 4) =       0.000437557930
  error estimate for blocks of size 2^( 5) =       0.000449111983
  error estimate for blocks of size 2^( 6) =       0.000455409073
  error estimate for blocks of size 2^( 7) =       0.000461252680

      target function =      -0.875617621657
              le_mean =     -16.902211042646
             les_mean =     286.007925827184
             stat err =       0.000450832917
             autocorr =       1.307456343317
   target nu stat err =       0.000450832917
   target dn stat err =       0.005609234652
      target stat err =       0.006918096134
              std dev =       0.557592620335
             le_variance =       0.310909530252


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.875618196243        initial  <--
     2.3842e+01     2.3842e+02             1.6512e-05        -0.875608321807
     9.5367e+01     9.5367e+02             4.1329e-06        -0.875613444172
     3.8147e+02     3.8147e+03             1.0335e-06        -0.875617621657

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 24.1991
  </log>
  <optVariables href="H2O.s070.opt.xml">
ci_0001                 7.026294e-01 3 1  ON 0
ci_0002                 6.983279e-01 3 1  ON 1
ci_0003                -3.181724e-02 3 1  ON 2
ci_0004                -3.148901e-02 3 1  ON 3
ci_0005                -2.842218e-02 3 1  ON 4
ci_0006                -2.962401e-02 3 1  ON 5
ci_0007                -1.644668e-02 3 1  ON 6
ci_0008                -1.721890e-02 3 1  ON 7
ci_0009                -1.895890e-02 3 1  ON 8
ci_0010                -1.909750e-02 3 1  ON 9
ci_0011                -1.578365e-02 3 1  ON 10
ci_0012                -1.579250e-02 3 1  ON 11
ci_0013                 1.568465e-02 3 1  ON 12
ci_0014                 1.561332e-02 3 1  ON 13
ci_0015                 1.647826e-02 3 1  ON 14
ci_0016                 1.619591e-02 3 1  ON 15
ci_0017                 1.384683e-02 3 1  ON 16
ci_0018                 1.415263e-02 3 1  ON 17
ci_0019                 1.243864e-02 3 1  ON 18
ci_0020                 1.205189e-02 3 1  ON 19
ci_0021                 1.539481e-02 3 1  ON 20
ci_0022                 1.641557e-02 3 1  ON 21
ci_0023                -1.177808e-02 3 1  ON 22
ci_0024                -1.103740e-02 3 1  ON 23
ci_0025                -2.989141e-03 3 1  ON 24
ci_0026                -2.657205e-03 3 1  ON 25
ci_0027                -1.174745e-02 3 1  ON 26
ci_0028                -1.172155e-02 3 1  ON 27
ci_0029                -1.033862e-02 3 1  ON 28
ci_0030                -1.028745e-02 3 1  ON 29
ci_0031                 1.407069e-02 3 1  ON 30
ci_0032                 1.310034e-02 3 1  ON 31
ci_0033                 8.463088e-03 3 1  ON 32
ci_0034                 8.659909e-03 3 1  ON 33
ci_0035                 5.045352e-03 3 1  ON 34
ci_0036                 4.826642e-03 3 1  ON 35
ci_0037                -1.143341e-02 3 1  ON 36
ci_0038                -1.140350e-02 3 1  ON 37
ci_0039                -3.804166e-03 3 1  ON 38
ci_0040                -3.933594e-03 3 1  ON 39
ci_0041                 9.636346e-03 3 1  ON 40
ci_0042                 9.532949e-03 3 1  ON 41
ci_0043                -6.343207e-03 3 1  ON 42
ci_0044                -6.774538e-03 3 1  ON 43
ci_0045                 1.045936e-02 3 1  ON 44
ci_0046                 9.383476e-03 3 1  ON 45
ci_0047                -3.644338e-03 3 1  ON 46
ci_0048                -3.595117e-03 3 1  ON 47
ci_0049                -2.504369e-03 3 1  ON 48
ci_0050                -2.823194e-03 3 1  ON 49
ci_0051                -1.835866e-03 3 1  ON 50
ci_0052                -1.716059e-03 3 1  ON 51
ci_0053                -4.036108e-03 3 1  ON 52
ci_0054                -3.938166e-03 3 1  ON 53
ci_0055                 2.508147e-03 3 1  ON 54
ci_0056                 2.146698e-03 3 1  ON 55
ci_0057                 2.391345e-03 3 1  ON 56
ci_0058                 3.125245e-03 3 1  ON 57
ci_0059                -4.061080e-03 3 1  ON 58
ci_0060                -3.655057e-03 3 1  ON 59
ci_0061                -2.865987e-03 3 1  ON 60
ci_0062                -3.079689e-03 3 1  ON 61
ci_0063                -9.741593e-03 3 1  ON 62
ci_0064                -9.713274e-03 3 1  ON 63
ci_0065                -7.181106e-03 3 1  ON 64
ci_0066                -6.636042e-03 3 1  ON 65
ci_0067                -3.951524e-03 3 1  ON 66
ci_0068                -3.957921e-03 3 1  ON 67
ci_0069                 3.825577e-03 3 1  ON 68
ci_0070                 3.580888e-03 3 1  ON 69
ci_0071                 4.381171e-03 3 1  ON 70
ci_0072                 4.651004e-03 3 1  ON 71
ci_0073                 3.394244e-03 3 1  ON 72
ci_0074                 3.189409e-03 3 1  ON 73
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 4.1996e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s071 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s071 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=71  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6900e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 71
    time step          = 0.05
    reference energy   = -16.8968
    reference variance = 0.147693
====================================================
  Execution time = 1.4938e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s071
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5190e+04
  VMC Eavg = -1.6903e+01
  VMC Evar = 3.1533e-01
  Total weights = 1.952021799e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 2.6846e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.303249119577
                                         uncertainty =       0.001748889885

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.303249119577
                                         uncertainty =       0.001748889885

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000389364868
  error estimate for blocks of size 2^( 2) =       0.000404030878
  error estimate for blocks of size 2^( 3) =       0.000419011524
  error estimate for blocks of size 2^( 4) =       0.000432777306
  error estimate for blocks of size 2^( 5) =       0.000445738381
  error estimate for blocks of size 2^( 6) =       0.000454968018
  error estimate for blocks of size 2^( 7) =       0.000460922136

      target function =      -0.885474281261
              le_mean =     -16.902575288719
             les_mean =     286.012379228576
             stat err =       0.000448601460
             autocorr =       1.327418417604
   target nu stat err =       0.000448601460
   target dn stat err =       0.002800296478
      target stat err =       0.003576142749
              std dev =       0.550645077489
             le_variance =       0.303210001363


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690257528872e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 74
Check correct_vf_var_size: 225, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.3842e+02, overlap shift 2.3842e+03 and omega -1.7527e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.885487669314       residual = 8.20e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.885487822757       residual = 1.92e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.885487849154       residual = 4.56e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.885487864355       residual = 1.64e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.885487869862       residual = 5.50e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.885487872831       residual = 3.17e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.885487874232       residual = 1.07e-05           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.885487874461       residual = 2.81e-06           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.885487874773       residual = 1.51e-06           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.885487874727       residual = 8.35e-07           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.885487874565       residual = 7.82e-07           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.885487874694       residual = 4.63e-07           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.885487874769       residual = 4.63e-07           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.885487874743       residual = 1.29e-07           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.885487874724       residual = 3.85e-08           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.885487874741       residual = 9.74e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         15 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 2.3842e+02 is 8.554299e-07

solving harmonic davidson linear method for identity shift 9.5367e+02, overlap shift 9.5367e+03 and omega -1.7527e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.885487669314       residual = 8.20e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.885487707684       residual = 1.92e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.885487714284       residual = 4.56e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.885487718085       residual = 1.64e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.885487719462       residual = 5.50e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.885487720204       residual = 3.17e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.885487720555       residual = 1.07e-05           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.885487720613       residual = 2.81e-06           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.885487720691       residual = 1.51e-06           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.885487720679       residual = 8.35e-07           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.885487720636       residual = 7.81e-07           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.885487720672       residual = 4.62e-07           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.885487720687       residual = 4.63e-07           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.885487720682       residual = 1.28e-07           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.885487720675       residual = 3.84e-08           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.885487720684       residual = 9.73e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         15 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 9.5367e+02 is 2.138809e-07

solving harmonic davidson linear method for identity shift 3.8147e+03, overlap shift 3.8147e+04 and omega -1.7527e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.885487669314       residual = 8.20e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.885487678907       residual = 1.92e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.885487680558       residual = 4.56e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.885487681511       residual = 1.64e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.885487681846       residual = 5.50e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.885487682040       residual = 3.17e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.885487682130       residual = 1.07e-05           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.885487682138       residual = 2.81e-06           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.885487682157       residual = 1.51e-06           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.885487682150       residual = 8.35e-07           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.885487682146       residual = 7.81e-07           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.885487682153       residual = 4.62e-07           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.885487682152       residual = 4.63e-07           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.885487682152       residual = 1.28e-07           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.885487682154       residual = 3.84e-08           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.885487682161       residual = 9.73e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         15 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 3.8147e+03 is 5.347170e-08

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.965535 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 75 and numParams is: 74

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.7636e+01
  </log>
  <optVariables href="H2O.s071.opt.xml">
ci_0001                 7.026293e-01 3 1  ON 0
ci_0002                 6.983281e-01 3 1  ON 1
ci_0003                -3.181713e-02 3 1  ON 2
ci_0004                -3.148888e-02 3 1  ON 3
ci_0005                -2.842212e-02 3 1  ON 4
ci_0006                -2.962383e-02 3 1  ON 5
ci_0007                -1.644653e-02 3 1  ON 6
ci_0008                -1.721868e-02 3 1  ON 7
ci_0009                -1.895893e-02 3 1  ON 8
ci_0010                -1.909748e-02 3 1  ON 9
ci_0011                -1.578365e-02 3 1  ON 10
ci_0012                -1.579238e-02 3 1  ON 11
ci_0013                 1.568459e-02 3 1  ON 12
ci_0014                 1.561327e-02 3 1  ON 13
ci_0015                 1.647820e-02 3 1  ON 14
ci_0016                 1.619580e-02 3 1  ON 15
ci_0017                 1.384685e-02 3 1  ON 16
ci_0018                 1.415258e-02 3 1  ON 17
ci_0019                 1.243868e-02 3 1  ON 18
ci_0020                 1.205196e-02 3 1  ON 19
ci_0021                 1.539478e-02 3 1  ON 20
ci_0022                 1.641549e-02 3 1  ON 21
ci_0023                -1.177807e-02 3 1  ON 22
ci_0024                -1.103737e-02 3 1  ON 23
ci_0025                -2.989016e-03 3 1  ON 24
ci_0026                -2.657188e-03 3 1  ON 25
ci_0027                -1.174743e-02 3 1  ON 26
ci_0028                -1.172148e-02 3 1  ON 27
ci_0029                -1.033856e-02 3 1  ON 28
ci_0030                -1.028749e-02 3 1  ON 29
ci_0031                 1.407069e-02 3 1  ON 30
ci_0032                 1.310026e-02 3 1  ON 31
ci_0033                 8.463075e-03 3 1  ON 32
ci_0034                 8.659768e-03 3 1  ON 33
ci_0035                 5.045173e-03 3 1  ON 34
ci_0036                 4.826584e-03 3 1  ON 35
ci_0037                -1.143336e-02 3 1  ON 36
ci_0038                -1.140344e-02 3 1  ON 37
ci_0039                -3.804126e-03 3 1  ON 38
ci_0040                -3.933553e-03 3 1  ON 39
ci_0041                 9.636323e-03 3 1  ON 40
ci_0042                 9.532947e-03 3 1  ON 41
ci_0043                -6.343199e-03 3 1  ON 42
ci_0044                -6.774511e-03 3 1  ON 43
ci_0045                 1.045942e-02 3 1  ON 44
ci_0046                 9.383415e-03 3 1  ON 45
ci_0047                -3.644278e-03 3 1  ON 46
ci_0048                -3.595060e-03 3 1  ON 47
ci_0049                -2.504463e-03 3 1  ON 48
ci_0050                -2.823122e-03 3 1  ON 49
ci_0051                -1.835793e-03 3 1  ON 50
ci_0052                -1.716068e-03 3 1  ON 51
ci_0053                -4.036082e-03 3 1  ON 52
ci_0054                -3.938128e-03 3 1  ON 53
ci_0055                 2.508101e-03 3 1  ON 54
ci_0056                 2.146627e-03 3 1  ON 55
ci_0057                 2.391373e-03 3 1  ON 56
ci_0058                 3.125141e-03 3 1  ON 57
ci_0059                -4.061083e-03 3 1  ON 58
ci_0060                -3.655057e-03 3 1  ON 59
ci_0061                -2.865983e-03 3 1  ON 60
ci_0062                -3.079622e-03 3 1  ON 61
ci_0063                -9.741602e-03 3 1  ON 62
ci_0064                -9.713267e-03 3 1  ON 63
ci_0065                -7.181019e-03 3 1  ON 64
ci_0066                -6.635990e-03 3 1  ON 65
ci_0067                -3.951564e-03 3 1  ON 66
ci_0068                -3.957931e-03 3 1  ON 67
ci_0069                 3.825528e-03 3 1  ON 68
ci_0070                 3.580830e-03 3 1  ON 69
ci_0071                 4.381189e-03 3 1  ON 70
ci_0072                 4.650942e-03 3 1  ON 71
ci_0073                 3.394258e-03 3 1  ON 72
ci_0074                 3.189389e-03 3 1  ON 73
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 71
    time step          = 0.05
    reference energy   = -16.9092
    reference variance = 0.165746
====================================================
  Execution time = 1.4529e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s071
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6902e+01
  VMC Evar = 3.1592e-01
  Total weights = 1.9518e+06
  Execution time = 1.9459e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.303935154484
                                         uncertainty =       0.001504734380

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.303935154484
                                         uncertainty =       0.001504734380

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000389873408
  error estimate for blocks of size 2^( 2) =       0.000404082496
  error estimate for blocks of size 2^( 3) =       0.000419170693
  error estimate for blocks of size 2^( 4) =       0.000432348543
  error estimate for blocks of size 2^( 5) =       0.000442903325
  error estimate for blocks of size 2^( 6) =       0.000450450338
  error estimate for blocks of size 2^( 7) =       0.000456040985

      target function =      -0.884695656265
              le_mean =     -16.902331384526
             les_mean =     286.004726499000
             stat err =       0.000445435798
             autocorr =       1.305338069430
   target nu stat err =       0.000445435798
   target dn stat err =       0.002676930012
      target stat err =       0.003415613943
              std dev =       0.551364261415
             le_variance =       0.304002548765

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.303935054321
                                         uncertainty =       0.001504747677

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.303935054321
                                         uncertainty =       0.001504747677

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000389873345
  error estimate for blocks of size 2^( 2) =       0.000404082479
  error estimate for blocks of size 2^( 3) =       0.000419170720
  error estimate for blocks of size 2^( 4) =       0.000432348618
  error estimate for blocks of size 2^( 5) =       0.000442903428
  error estimate for blocks of size 2^( 6) =       0.000450450469
  error estimate for blocks of size 2^( 7) =       0.000456041060

      target function =      -0.884694986731
              le_mean =     -16.902331373164
             les_mean =     286.004726647084
             stat err =       0.000445435894
             autocorr =       1.305339052406
   target nu stat err =       0.000445435894
   target dn stat err =       0.002676986943
      target stat err =       0.003415678986
              std dev =       0.551364172738
             le_variance =       0.304002450979

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.303935104370
                                         uncertainty =       0.001504741029

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.303935104370
                                         uncertainty =       0.001504741029

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000389873377
  error estimate for blocks of size 2^( 2) =       0.000404082488
  error estimate for blocks of size 2^( 3) =       0.000419170707
  error estimate for blocks of size 2^( 4) =       0.000432348581
  error estimate for blocks of size 2^( 5) =       0.000442903377
  error estimate for blocks of size 2^( 6) =       0.000450450404
  error estimate for blocks of size 2^( 7) =       0.000456041023

      target function =      -0.884695327012
              le_mean =     -16.902331378841
             les_mean =     286.004726568505
             stat err =       0.000445435846
             autocorr =       1.305338561021
   target nu stat err =       0.000445435846
   target dn stat err =       0.002676958370
      target stat err =       0.003415646374
              std dev =       0.551364217047
             le_variance =       0.304002499840

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.303935148217
                                         uncertainty =       0.001504735211

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.303935148217
                                         uncertainty =       0.001504735211

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000389873404
  error estimate for blocks of size 2^( 2) =       0.000404082495
  error estimate for blocks of size 2^( 3) =       0.000419170695
  error estimate for blocks of size 2^( 4) =       0.000432348548
  error estimate for blocks of size 2^( 5) =       0.000442903332
  error estimate for blocks of size 2^( 6) =       0.000450450346
  error estimate for blocks of size 2^( 7) =       0.000456040990

      target function =      -0.884695615731
              le_mean =     -16.902331383815
             les_mean =     286.004726507179
             stat err =       0.000445435804
             autocorr =       1.305338130885
   target nu stat err =       0.000445435804
   target dn stat err =       0.002676933545
      target stat err =       0.003415617987
              std dev =       0.551364255866
             le_variance =       0.304002542647


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.884695656265        initial  <--
     2.3842e+02     2.3842e+03             8.5543e-07        -0.884694986731
     9.5367e+02     9.5367e+03             2.1388e-07        -0.884695327012
     3.8147e+03     3.8147e+04             5.3472e-08        -0.884695615731

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 24.3531
  </log>
  <optVariables href="H2O.s071.opt.xml">
ci_0001                 7.026294e-01 3 1  ON 0
ci_0002                 6.983279e-01 3 1  ON 1
ci_0003                -3.181724e-02 3 1  ON 2
ci_0004                -3.148901e-02 3 1  ON 3
ci_0005                -2.842218e-02 3 1  ON 4
ci_0006                -2.962401e-02 3 1  ON 5
ci_0007                -1.644668e-02 3 1  ON 6
ci_0008                -1.721890e-02 3 1  ON 7
ci_0009                -1.895890e-02 3 1  ON 8
ci_0010                -1.909750e-02 3 1  ON 9
ci_0011                -1.578365e-02 3 1  ON 10
ci_0012                -1.579250e-02 3 1  ON 11
ci_0013                 1.568465e-02 3 1  ON 12
ci_0014                 1.561332e-02 3 1  ON 13
ci_0015                 1.647826e-02 3 1  ON 14
ci_0016                 1.619591e-02 3 1  ON 15
ci_0017                 1.384683e-02 3 1  ON 16
ci_0018                 1.415263e-02 3 1  ON 17
ci_0019                 1.243864e-02 3 1  ON 18
ci_0020                 1.205189e-02 3 1  ON 19
ci_0021                 1.539481e-02 3 1  ON 20
ci_0022                 1.641557e-02 3 1  ON 21
ci_0023                -1.177808e-02 3 1  ON 22
ci_0024                -1.103740e-02 3 1  ON 23
ci_0025                -2.989141e-03 3 1  ON 24
ci_0026                -2.657205e-03 3 1  ON 25
ci_0027                -1.174745e-02 3 1  ON 26
ci_0028                -1.172155e-02 3 1  ON 27
ci_0029                -1.033862e-02 3 1  ON 28
ci_0030                -1.028745e-02 3 1  ON 29
ci_0031                 1.407069e-02 3 1  ON 30
ci_0032                 1.310034e-02 3 1  ON 31
ci_0033                 8.463088e-03 3 1  ON 32
ci_0034                 8.659909e-03 3 1  ON 33
ci_0035                 5.045352e-03 3 1  ON 34
ci_0036                 4.826642e-03 3 1  ON 35
ci_0037                -1.143341e-02 3 1  ON 36
ci_0038                -1.140350e-02 3 1  ON 37
ci_0039                -3.804166e-03 3 1  ON 38
ci_0040                -3.933594e-03 3 1  ON 39
ci_0041                 9.636346e-03 3 1  ON 40
ci_0042                 9.532949e-03 3 1  ON 41
ci_0043                -6.343207e-03 3 1  ON 42
ci_0044                -6.774538e-03 3 1  ON 43
ci_0045                 1.045936e-02 3 1  ON 44
ci_0046                 9.383476e-03 3 1  ON 45
ci_0047                -3.644338e-03 3 1  ON 46
ci_0048                -3.595117e-03 3 1  ON 47
ci_0049                -2.504369e-03 3 1  ON 48
ci_0050                -2.823194e-03 3 1  ON 49
ci_0051                -1.835866e-03 3 1  ON 50
ci_0052                -1.716059e-03 3 1  ON 51
ci_0053                -4.036108e-03 3 1  ON 52
ci_0054                -3.938166e-03 3 1  ON 53
ci_0055                 2.508147e-03 3 1  ON 54
ci_0056                 2.146698e-03 3 1  ON 55
ci_0057                 2.391345e-03 3 1  ON 56
ci_0058                 3.125245e-03 3 1  ON 57
ci_0059                -4.061080e-03 3 1  ON 58
ci_0060                -3.655057e-03 3 1  ON 59
ci_0061                -2.865987e-03 3 1  ON 60
ci_0062                -3.079689e-03 3 1  ON 61
ci_0063                -9.741593e-03 3 1  ON 62
ci_0064                -9.713274e-03 3 1  ON 63
ci_0065                -7.181106e-03 3 1  ON 64
ci_0066                -6.636042e-03 3 1  ON 65
ci_0067                -3.951524e-03 3 1  ON 66
ci_0068                -3.957921e-03 3 1  ON 67
ci_0069                 3.825577e-03 3 1  ON 68
ci_0070                 3.580888e-03 3 1  ON 69
ci_0071                 4.381171e-03 3 1  ON 70
ci_0072                 4.651004e-03 3 1  ON 71
ci_0073                 3.394244e-03 3 1  ON 72
ci_0074                 3.189409e-03 3 1  ON 73
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 4.1994e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s072 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s072 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=72  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6900e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 72
    time step          = 0.05
    reference energy   = -16.9181
    reference variance = 0.213522
====================================================
  Execution time = 1.5101e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s072
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5231e+04
  VMC Eavg = -1.6903e+01
  VMC Evar = 3.2159e-01
  Total weights = 1.951848255e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 2.6751e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.306400810751
                                         uncertainty =       0.001843939238

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.306400810751
                                         uncertainty =       0.001843939238

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000391439921
  error estimate for blocks of size 2^( 2) =       0.000405759282
  error estimate for blocks of size 2^( 3) =       0.000420670965
  error estimate for blocks of size 2^( 4) =       0.000434142951
  error estimate for blocks of size 2^( 5) =       0.000445712079
  error estimate for blocks of size 2^( 6) =       0.000453446976
  error estimate for blocks of size 2^( 7) =       0.000456106425

      target function =      -0.877659180538
              le_mean =     -16.902533394545
             les_mean =     286.017229010576
             stat err =       0.000447352108
             autocorr =       1.306076889788
   target nu stat err =       0.000447352108
   target dn stat err =       0.003267475507
      target stat err =       0.004082474359
              std dev =       0.553579645652
             le_variance =       0.306450424080


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690253339454e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 74
Check correct_vf_var_size: 225, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.3842e+03, overlap shift 2.3842e+04 and omega -1.7527e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.877677092696       residual = 7.64e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.877677108283       residual = 1.63e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.877677112065       residual = 6.35e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.877677114004       residual = 3.03e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.877677115197       residual = 1.11e-04           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.877677115780       residual = 6.20e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.877677116152       residual = 4.56e-05           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.877677116383       residual = 6.06e-05           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.877677116716       residual = 3.38e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.877677116898       residual = 1.84e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.877677116900       residual = 8.13e-06           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.877677116894       residual = 3.45e-06           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.877677116940       residual = 1.18e-06           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.877677116961       residual = 2.49e-07           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.877677116965       residual = 5.04e-08           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.877677116957       residual = 1.20e-08           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.877677116959       residual = 3.66e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         16 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 2.3842e+03 is 1.911980e-07

solving harmonic davidson linear method for identity shift 9.5367e+03, overlap shift 9.5367e+04 and omega -1.7527e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.877677092696       residual = 7.64e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.877677096593       residual = 1.63e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.877677097538       residual = 6.35e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.877677098022       residual = 3.03e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.877677098296       residual = 1.10e-04           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.877677098484       residual = 6.20e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.877677098570       residual = 4.56e-05           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.877677098626       residual = 6.06e-05           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.877677098701       residual = 3.38e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.877677098726       residual = 1.84e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.877677098743       residual = 8.13e-06           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.877677098731       residual = 3.45e-06           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.877677098766       residual = 1.18e-06           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.877677098754       residual = 2.49e-07           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.877677098755       residual = 5.04e-08           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.877677098757       residual = 1.20e-08           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.877677098737       residual = 3.66e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         16 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 9.5367e+03 is 4.779956e-08

solving harmonic davidson linear method for identity shift 3.8147e+04, overlap shift 3.8147e+05 and omega -1.7527e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.877677092696       residual = 7.64e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.877677093670       residual = 1.63e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.877677093907       residual = 6.35e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.877677094028       residual = 3.03e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.877677094058       residual = 1.10e-04           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.877677094162       residual = 6.20e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.877677094163       residual = 4.56e-05           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.877677094160       residual = 6.06e-05           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.877677094211       residual = 3.38e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.877677094222       residual = 1.84e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.877677094176       residual = 8.13e-06           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.877677094125       residual = 3.45e-06           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.877677094212       residual = 1.18e-06           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.877677094357       residual = 2.49e-07           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.877677094206       residual = 5.04e-08           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.877677094213       residual = 1.20e-08           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.877677094285       residual = 3.66e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         16 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 3.8147e+04 is 1.194989e-08

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.974547 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 75 and numParams is: 74

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.7791e+01
  </log>
  <optVariables href="H2O.s072.opt.xml">
ci_0001                 7.026294e-01 3 1  ON 0
ci_0002                 6.983279e-01 3 1  ON 1
ci_0003                -3.181723e-02 3 1  ON 2
ci_0004                -3.148900e-02 3 1  ON 3
ci_0005                -2.842217e-02 3 1  ON 4
ci_0006                -2.962399e-02 3 1  ON 5
ci_0007                -1.644666e-02 3 1  ON 6
ci_0008                -1.721887e-02 3 1  ON 7
ci_0009                -1.895890e-02 3 1  ON 8
ci_0010                -1.909748e-02 3 1  ON 9
ci_0011                -1.578364e-02 3 1  ON 10
ci_0012                -1.579250e-02 3 1  ON 11
ci_0013                 1.568465e-02 3 1  ON 12
ci_0014                 1.561332e-02 3 1  ON 13
ci_0015                 1.647826e-02 3 1  ON 14
ci_0016                 1.619591e-02 3 1  ON 15
ci_0017                 1.384683e-02 3 1  ON 16
ci_0018                 1.415264e-02 3 1  ON 17
ci_0019                 1.243863e-02 3 1  ON 18
ci_0020                 1.205189e-02 3 1  ON 19
ci_0021                 1.539482e-02 3 1  ON 20
ci_0022                 1.641558e-02 3 1  ON 21
ci_0023                -1.177808e-02 3 1  ON 22
ci_0024                -1.103740e-02 3 1  ON 23
ci_0025                -2.989140e-03 3 1  ON 24
ci_0026                -2.657205e-03 3 1  ON 25
ci_0027                -1.174745e-02 3 1  ON 26
ci_0028                -1.172153e-02 3 1  ON 27
ci_0029                -1.033862e-02 3 1  ON 28
ci_0030                -1.028745e-02 3 1  ON 29
ci_0031                 1.407068e-02 3 1  ON 30
ci_0032                 1.310034e-02 3 1  ON 31
ci_0033                 8.463097e-03 3 1  ON 32
ci_0034                 8.659908e-03 3 1  ON 33
ci_0035                 5.045337e-03 3 1  ON 34
ci_0036                 4.826639e-03 3 1  ON 35
ci_0037                -1.143341e-02 3 1  ON 36
ci_0038                -1.140350e-02 3 1  ON 37
ci_0039                -3.804161e-03 3 1  ON 38
ci_0040                -3.933594e-03 3 1  ON 39
ci_0041                 9.636342e-03 3 1  ON 40
ci_0042                 9.532952e-03 3 1  ON 41
ci_0043                -6.343206e-03 3 1  ON 42
ci_0044                -6.774536e-03 3 1  ON 43
ci_0045                 1.045935e-02 3 1  ON 44
ci_0046                 9.383475e-03 3 1  ON 45
ci_0047                -3.644330e-03 3 1  ON 46
ci_0048                -3.595116e-03 3 1  ON 47
ci_0049                -2.504370e-03 3 1  ON 48
ci_0050                -2.823185e-03 3 1  ON 49
ci_0051                -1.835864e-03 3 1  ON 50
ci_0052                -1.716062e-03 3 1  ON 51
ci_0053                -4.036108e-03 3 1  ON 52
ci_0054                -3.938163e-03 3 1  ON 53
ci_0055                 2.508145e-03 3 1  ON 54
ci_0056                 2.146692e-03 3 1  ON 55
ci_0057                 2.391356e-03 3 1  ON 56
ci_0058                 3.125232e-03 3 1  ON 57
ci_0059                -4.061078e-03 3 1  ON 58
ci_0060                -3.655057e-03 3 1  ON 59
ci_0061                -2.865993e-03 3 1  ON 60
ci_0062                -3.079687e-03 3 1  ON 61
ci_0063                -9.741586e-03 3 1  ON 62
ci_0064                -9.713271e-03 3 1  ON 63
ci_0065                -7.181109e-03 3 1  ON 64
ci_0066                -6.636044e-03 3 1  ON 65
ci_0067                -3.951521e-03 3 1  ON 66
ci_0068                -3.957921e-03 3 1  ON 67
ci_0069                 3.825576e-03 3 1  ON 68
ci_0070                 3.580881e-03 3 1  ON 69
ci_0071                 4.381164e-03 3 1  ON 70
ci_0072                 4.651009e-03 3 1  ON 71
ci_0073                 3.394243e-03 3 1  ON 72
ci_0074                 3.189418e-03 3 1  ON 73
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 72
    time step          = 0.05
    reference energy   = -16.9344
    reference variance = 0.222774
====================================================
  Execution time = 1.4343e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s072
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6903e+01
  VMC Evar = 3.1504e-01
  Total weights = 1.9520e+06
  Execution time = 1.9361e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.302790451974
                                         uncertainty =       0.001699060215

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.302790451974
                                         uncertainty =       0.001699060215

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000389065914
  error estimate for blocks of size 2^( 2) =       0.000403814112
  error estimate for blocks of size 2^( 3) =       0.000418110322
  error estimate for blocks of size 2^( 4) =       0.000431933031
  error estimate for blocks of size 2^( 5) =       0.000442372137
  error estimate for blocks of size 2^( 6) =       0.000449888067
  error estimate for blocks of size 2^( 7) =       0.000454392510

      target function =      -0.885952314899
              le_mean =     -16.903301523776
             les_mean =     286.036637699234
             stat err =       0.000444646436
             autocorr =       1.306120554409
   target nu stat err =       0.000444646436
   target dn stat err =       0.002571504308
      target stat err =       0.003299863367
              std dev =       0.550222292351
             le_variance =       0.302744570999

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.302790441581
                                         uncertainty =       0.001699060414

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.302790441581
                                         uncertainty =       0.001699060414

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000389065907
  error estimate for blocks of size 2^( 2) =       0.000403814110
  error estimate for blocks of size 2^( 3) =       0.000418110325
  error estimate for blocks of size 2^( 4) =       0.000431933037
  error estimate for blocks of size 2^( 5) =       0.000442372144
  error estimate for blocks of size 2^( 6) =       0.000449888076
  error estimate for blocks of size 2^( 7) =       0.000454392518

      target function =      -0.885952298512
              le_mean =     -16.903301523486
             les_mean =     286.036637702350
             stat err =       0.000444646444
             autocorr =       1.306120641356
   target nu stat err =       0.000444646444
   target dn stat err =       0.002571510340
      target stat err =       0.003299870705
              std dev =       0.550222282967
             le_variance =       0.302744560673

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.302790446777
                                         uncertainty =       0.001699060315

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.302790446777
                                         uncertainty =       0.001699060315

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000389065911
  error estimate for blocks of size 2^( 2) =       0.000403814111
  error estimate for blocks of size 2^( 3) =       0.000418110324
  error estimate for blocks of size 2^( 4) =       0.000431933034
  error estimate for blocks of size 2^( 5) =       0.000442372141
  error estimate for blocks of size 2^( 6) =       0.000449888071
  error estimate for blocks of size 2^( 7) =       0.000454392514

      target function =      -0.885952306751
              le_mean =     -16.903301523631
             les_mean =     286.036637700755
             stat err =       0.000444646440
             autocorr =       1.306120597884
   target nu stat err =       0.000444646440
   target dn stat err =       0.002571507323
      target stat err =       0.003299867035
              std dev =       0.550222287658
             le_variance =       0.302744565836

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.302790451324
                                         uncertainty =       0.001699060228

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.302790451324
                                         uncertainty =       0.001699060228

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000389065914
  error estimate for blocks of size 2^( 2) =       0.000403814112
  error estimate for blocks of size 2^( 3) =       0.000418110322
  error estimate for blocks of size 2^( 4) =       0.000431933032
  error estimate for blocks of size 2^( 5) =       0.000442372138
  error estimate for blocks of size 2^( 6) =       0.000449888067
  error estimate for blocks of size 2^( 7) =       0.000454392511

      target function =      -0.885952313885
              le_mean =     -16.903301523758
             les_mean =     286.036637699420
             stat err =       0.000444646437
             autocorr =       1.306120559835
   target nu stat err =       0.000444646437
   target dn stat err =       0.002571504685
      target stat err =       0.003299863826
              std dev =       0.550222291764
             le_variance =       0.302744570354


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.885952314899        initial  <--
     2.3842e+03     2.3842e+04             1.9120e-07        -0.885952298512
     9.5367e+03     9.5367e+04             4.7800e-08        -0.885952306751
     3.8147e+04     3.8147e+05             1.1950e-08        -0.885952313885

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 24.1382
  </log>
  <optVariables href="H2O.s072.opt.xml">
ci_0001                 7.026294e-01 3 1  ON 0
ci_0002                 6.983279e-01 3 1  ON 1
ci_0003                -3.181724e-02 3 1  ON 2
ci_0004                -3.148901e-02 3 1  ON 3
ci_0005                -2.842218e-02 3 1  ON 4
ci_0006                -2.962401e-02 3 1  ON 5
ci_0007                -1.644668e-02 3 1  ON 6
ci_0008                -1.721890e-02 3 1  ON 7
ci_0009                -1.895890e-02 3 1  ON 8
ci_0010                -1.909750e-02 3 1  ON 9
ci_0011                -1.578365e-02 3 1  ON 10
ci_0012                -1.579250e-02 3 1  ON 11
ci_0013                 1.568465e-02 3 1  ON 12
ci_0014                 1.561332e-02 3 1  ON 13
ci_0015                 1.647826e-02 3 1  ON 14
ci_0016                 1.619591e-02 3 1  ON 15
ci_0017                 1.384683e-02 3 1  ON 16
ci_0018                 1.415263e-02 3 1  ON 17
ci_0019                 1.243864e-02 3 1  ON 18
ci_0020                 1.205189e-02 3 1  ON 19
ci_0021                 1.539481e-02 3 1  ON 20
ci_0022                 1.641557e-02 3 1  ON 21
ci_0023                -1.177808e-02 3 1  ON 22
ci_0024                -1.103740e-02 3 1  ON 23
ci_0025                -2.989141e-03 3 1  ON 24
ci_0026                -2.657205e-03 3 1  ON 25
ci_0027                -1.174745e-02 3 1  ON 26
ci_0028                -1.172155e-02 3 1  ON 27
ci_0029                -1.033862e-02 3 1  ON 28
ci_0030                -1.028745e-02 3 1  ON 29
ci_0031                 1.407069e-02 3 1  ON 30
ci_0032                 1.310034e-02 3 1  ON 31
ci_0033                 8.463088e-03 3 1  ON 32
ci_0034                 8.659909e-03 3 1  ON 33
ci_0035                 5.045352e-03 3 1  ON 34
ci_0036                 4.826642e-03 3 1  ON 35
ci_0037                -1.143341e-02 3 1  ON 36
ci_0038                -1.140350e-02 3 1  ON 37
ci_0039                -3.804166e-03 3 1  ON 38
ci_0040                -3.933594e-03 3 1  ON 39
ci_0041                 9.636346e-03 3 1  ON 40
ci_0042                 9.532949e-03 3 1  ON 41
ci_0043                -6.343207e-03 3 1  ON 42
ci_0044                -6.774538e-03 3 1  ON 43
ci_0045                 1.045936e-02 3 1  ON 44
ci_0046                 9.383476e-03 3 1  ON 45
ci_0047                -3.644338e-03 3 1  ON 46
ci_0048                -3.595117e-03 3 1  ON 47
ci_0049                -2.504369e-03 3 1  ON 48
ci_0050                -2.823194e-03 3 1  ON 49
ci_0051                -1.835866e-03 3 1  ON 50
ci_0052                -1.716059e-03 3 1  ON 51
ci_0053                -4.036108e-03 3 1  ON 52
ci_0054                -3.938166e-03 3 1  ON 53
ci_0055                 2.508147e-03 3 1  ON 54
ci_0056                 2.146698e-03 3 1  ON 55
ci_0057                 2.391345e-03 3 1  ON 56
ci_0058                 3.125245e-03 3 1  ON 57
ci_0059                -4.061080e-03 3 1  ON 58
ci_0060                -3.655057e-03 3 1  ON 59
ci_0061                -2.865987e-03 3 1  ON 60
ci_0062                -3.079689e-03 3 1  ON 61
ci_0063                -9.741593e-03 3 1  ON 62
ci_0064                -9.713274e-03 3 1  ON 63
ci_0065                -7.181106e-03 3 1  ON 64
ci_0066                -6.636042e-03 3 1  ON 65
ci_0067                -3.951524e-03 3 1  ON 66
ci_0068                -3.957921e-03 3 1  ON 67
ci_0069                 3.825577e-03 3 1  ON 68
ci_0070                 3.580888e-03 3 1  ON 69
ci_0071                 4.381171e-03 3 1  ON 70
ci_0072                 4.651004e-03 3 1  ON 71
ci_0073                 3.394244e-03 3 1  ON 72
ci_0074                 3.189409e-03 3 1  ON 73
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 4.1934e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s073 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s073 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=73  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6900e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 73
    time step          = 0.05
    reference energy   = -16.8853
    reference variance = 0.278897
====================================================
  Execution time = 1.5167e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s073
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5235e+04
  VMC Eavg = -1.6903e+01
  VMC Evar = 3.1257e-01
  Total weights = 1.952187224e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 2.6856e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.303614828850
                                         uncertainty =       0.001777897391

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.303614828850
                                         uncertainty =       0.001777897391

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000389626146
  error estimate for blocks of size 2^( 2) =       0.000404424204
  error estimate for blocks of size 2^( 3) =       0.000419181721
  error estimate for blocks of size 2^( 4) =       0.000432343821
  error estimate for blocks of size 2^( 5) =       0.000443776104
  error estimate for blocks of size 2^( 6) =       0.000452448332
  error estimate for blocks of size 2^( 7) =       0.000456767111

      target function =      -0.889047119669
              le_mean =     -16.903129967441
             les_mean =     286.028370468024
             stat err =       0.000446333842
             autocorr =       1.312270752536
   target nu stat err =       0.000446333842
   target dn stat err =       0.002294714146
      target stat err =       0.002978379191
              std dev =       0.551014579522
             le_variance =       0.303617066846


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690312996744e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 74
Check correct_vf_var_size: 225, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.3842e+04, overlap shift 2.3842e+05 and omega -1.7527e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.889055917299       residual = 1.09e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.889055919026       residual = 1.50e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.889055919298       residual = 3.75e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.889055919383       residual = 1.25e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.889055919408       residual = 2.85e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.889055919520       residual = 1.41e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.889055919421       residual = 5.05e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.889055919422       residual = 3.01e-06           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.889055919404       residual = 2.98e-06           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.889055919428       residual = 2.09e-06           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.889055919372       residual = 1.84e-06           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.889055919428       residual = 6.57e-07           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.889055919475       residual = 3.79e-07           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.889055919433       residual = 1.01e-07           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.889055919377       residual = 3.80e-08           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.889055919430       residual = 7.91e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         15 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 2.3842e+04 is 1.015609e-08

solving harmonic davidson linear method for identity shift 9.5367e+04, overlap shift 9.5367e+05 and omega -1.7527e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.889055917299       residual = 1.09e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.889055917731       residual = 1.50e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.889055917799       residual = 3.75e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.889055917820       residual = 1.25e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.889055917827       residual = 2.85e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.889055917805       residual = 1.41e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.889055917830       residual = 5.05e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.889055917830       residual = 3.01e-06           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.889055917830       residual = 2.98e-06           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.889055917832       residual = 2.09e-06           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.889055917832       residual = 1.84e-06           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.889055917832       residual = 6.57e-07           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.889055917832       residual = 3.79e-07           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.889055917701       residual = 1.01e-07           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.889055917832       residual = 3.80e-08           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.889055917832       residual = 7.91e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         15 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 9.5367e+04 is 2.539029e-09

solving harmonic davidson linear method for identity shift 3.8147e+05, overlap shift 3.8147e+06 and omega -1.7527e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.889055917299       residual = 1.09e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.889055917407       residual = 1.50e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.889055917424       residual = 3.75e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.889055917430       residual = 1.25e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.889055917431       residual = 2.85e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.889055917432       residual = 1.41e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.889055917432       residual = 5.05e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.889055917432       residual = 3.01e-06           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.889055917432       residual = 2.98e-06           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.889055917433       residual = 2.09e-06           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.889055917433       residual = 1.84e-06           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.889055917433       residual = 6.57e-07           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.889055916622       residual = 3.79e-07           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.889055917433       residual = 1.01e-07           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.889055917433       residual = 3.80e-08           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.889055917433       residual = 7.91e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         15 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 3.8147e+05 is 6.347577e-10

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.982579 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 75 and numParams is: 74

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.7866e+01
  </log>
  <optVariables href="H2O.s073.opt.xml">
ci_0001                 7.026294e-01 3 1  ON 0
ci_0002                 6.983279e-01 3 1  ON 1
ci_0003                -3.181724e-02 3 1  ON 2
ci_0004                -3.148901e-02 3 1  ON 3
ci_0005                -2.842218e-02 3 1  ON 4
ci_0006                -2.962401e-02 3 1  ON 5
ci_0007                -1.644668e-02 3 1  ON 6
ci_0008                -1.721890e-02 3 1  ON 7
ci_0009                -1.895890e-02 3 1  ON 8
ci_0010                -1.909750e-02 3 1  ON 9
ci_0011                -1.578365e-02 3 1  ON 10
ci_0012                -1.579250e-02 3 1  ON 11
ci_0013                 1.568465e-02 3 1  ON 12
ci_0014                 1.561332e-02 3 1  ON 13
ci_0015                 1.647826e-02 3 1  ON 14
ci_0016                 1.619591e-02 3 1  ON 15
ci_0017                 1.384683e-02 3 1  ON 16
ci_0018                 1.415263e-02 3 1  ON 17
ci_0019                 1.243864e-02 3 1  ON 18
ci_0020                 1.205189e-02 3 1  ON 19
ci_0021                 1.539481e-02 3 1  ON 20
ci_0022                 1.641557e-02 3 1  ON 21
ci_0023                -1.177808e-02 3 1  ON 22
ci_0024                -1.103740e-02 3 1  ON 23
ci_0025                -2.989140e-03 3 1  ON 24
ci_0026                -2.657206e-03 3 1  ON 25
ci_0027                -1.174745e-02 3 1  ON 26
ci_0028                -1.172154e-02 3 1  ON 27
ci_0029                -1.033862e-02 3 1  ON 28
ci_0030                -1.028745e-02 3 1  ON 29
ci_0031                 1.407069e-02 3 1  ON 30
ci_0032                 1.310034e-02 3 1  ON 31
ci_0033                 8.463087e-03 3 1  ON 32
ci_0034                 8.659909e-03 3 1  ON 33
ci_0035                 5.045351e-03 3 1  ON 34
ci_0036                 4.826642e-03 3 1  ON 35
ci_0037                -1.143341e-02 3 1  ON 36
ci_0038                -1.140350e-02 3 1  ON 37
ci_0039                -3.804165e-03 3 1  ON 38
ci_0040                -3.933594e-03 3 1  ON 39
ci_0041                 9.636346e-03 3 1  ON 40
ci_0042                 9.532949e-03 3 1  ON 41
ci_0043                -6.343207e-03 3 1  ON 42
ci_0044                -6.774538e-03 3 1  ON 43
ci_0045                 1.045936e-02 3 1  ON 44
ci_0046                 9.383476e-03 3 1  ON 45
ci_0047                -3.644338e-03 3 1  ON 46
ci_0048                -3.595117e-03 3 1  ON 47
ci_0049                -2.504369e-03 3 1  ON 48
ci_0050                -2.823192e-03 3 1  ON 49
ci_0051                -1.835866e-03 3 1  ON 50
ci_0052                -1.716058e-03 3 1  ON 51
ci_0053                -4.036107e-03 3 1  ON 52
ci_0054                -3.938165e-03 3 1  ON 53
ci_0055                 2.508147e-03 3 1  ON 54
ci_0056                 2.146698e-03 3 1  ON 55
ci_0057                 2.391345e-03 3 1  ON 56
ci_0058                 3.125245e-03 3 1  ON 57
ci_0059                -4.061079e-03 3 1  ON 58
ci_0060                -3.655057e-03 3 1  ON 59
ci_0061                -2.865986e-03 3 1  ON 60
ci_0062                -3.079688e-03 3 1  ON 61
ci_0063                -9.741593e-03 3 1  ON 62
ci_0064                -9.713274e-03 3 1  ON 63
ci_0065                -7.181106e-03 3 1  ON 64
ci_0066                -6.636042e-03 3 1  ON 65
ci_0067                -3.951523e-03 3 1  ON 66
ci_0068                -3.957920e-03 3 1  ON 67
ci_0069                 3.825577e-03 3 1  ON 68
ci_0070                 3.580887e-03 3 1  ON 69
ci_0071                 4.381171e-03 3 1  ON 70
ci_0072                 4.651004e-03 3 1  ON 71
ci_0073                 3.394243e-03 3 1  ON 72
ci_0074                 3.189409e-03 3 1  ON 73
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 73
    time step          = 0.05
    reference energy   = -16.8407
    reference variance = 0.229055
====================================================
  Execution time = 1.4504e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s073
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6902e+01
  VMC Evar = 3.1645e-01
  Total weights = 1.9522e+06
  Execution time = 1.9519e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.305889462255
                                         uncertainty =       0.001788851248

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.305889462255
                                         uncertainty =       0.001788851248

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000391055558
  error estimate for blocks of size 2^( 2) =       0.000405618017
  error estimate for blocks of size 2^( 3) =       0.000420210443
  error estimate for blocks of size 2^( 4) =       0.000433127463
  error estimate for blocks of size 2^( 5) =       0.000444392516
  error estimate for blocks of size 2^( 6) =       0.000451716146
  error estimate for blocks of size 2^( 7) =       0.000455450804

      target function =      -0.884028431667
              le_mean =     -16.902313873974
             les_mean =     286.004666037386
             stat err =       0.000446171732
             autocorr =       1.301748773599
   target nu stat err =       0.000446171732
   target dn stat err =       0.002531584777
      target stat err =       0.003231994052
              std dev =       0.553036073850
             le_variance =       0.305848898980

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.305889461701
                                         uncertainty =       0.001788851301

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.305889461701
                                         uncertainty =       0.001788851301

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000391055558
  error estimate for blocks of size 2^( 2) =       0.000405618017
  error estimate for blocks of size 2^( 3) =       0.000420210444
  error estimate for blocks of size 2^( 4) =       0.000433127464
  error estimate for blocks of size 2^( 5) =       0.000444392517
  error estimate for blocks of size 2^( 6) =       0.000451716147
  error estimate for blocks of size 2^( 7) =       0.000455450805

      target function =      -0.884028452917
              le_mean =     -16.902313873906
             les_mean =     286.004666018115
             stat err =       0.000446171733
             autocorr =       1.301748782130
   target nu stat err =       0.000446171733
   target dn stat err =       0.002531583800
      target stat err =       0.003231993004
              std dev =       0.553036073348
             le_variance =       0.305848898424

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.305889461978
                                         uncertainty =       0.001788851275

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.305889461978
                                         uncertainty =       0.001788851275

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000391055558
  error estimate for blocks of size 2^( 2) =       0.000405618017
  error estimate for blocks of size 2^( 3) =       0.000420210443
  error estimate for blocks of size 2^( 4) =       0.000433127463
  error estimate for blocks of size 2^( 5) =       0.000444392517
  error estimate for blocks of size 2^( 6) =       0.000451716147
  error estimate for blocks of size 2^( 7) =       0.000455450804

      target function =      -0.884028442293
              le_mean =     -16.902313873940
             les_mean =     286.004666027750
             stat err =       0.000446171733
             autocorr =       1.301748777869
   target nu stat err =       0.000446171733
   target dn stat err =       0.002531584289
      target stat err =       0.003231993528
              std dev =       0.553036073599
             le_variance =       0.305848898702

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.305889462221
                                         uncertainty =       0.001788851252

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.305889462221
                                         uncertainty =       0.001788851252

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000391055558
  error estimate for blocks of size 2^( 2) =       0.000405618017
  error estimate for blocks of size 2^( 3) =       0.000420210443
  error estimate for blocks of size 2^( 4) =       0.000433127463
  error estimate for blocks of size 2^( 5) =       0.000444392516
  error estimate for blocks of size 2^( 6) =       0.000451716146
  error estimate for blocks of size 2^( 7) =       0.000455450804

      target function =      -0.884028432995
              le_mean =     -16.902313873970
             les_mean =     286.004666036182
             stat err =       0.000446171732
             autocorr =       1.301748774129
   target nu stat err =       0.000446171732
   target dn stat err =       0.002531584716
      target stat err =       0.003231993987
              std dev =       0.553036073819
             le_variance =       0.305848898945


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.884028431667        initial
     2.3842e+04     2.3842e+05             1.0156e-08        -0.884028452917  <--
     9.5367e+04     9.5367e+05             2.5390e-09        -0.884028442293
     3.8147e+05     3.8147e+06             6.3476e-10        -0.884028432995

*****************************************************************************
Applying the update for shift_i =   2.3842e+04     and shift_s =   2.3842e+05
*****************************************************************************

  Execution time = 2.7951e+01
  </log>
  <optVariables href="H2O.s073.opt.xml">
ci_0001                 7.026294e-01 3 1  ON 0
ci_0002                 6.983279e-01 3 1  ON 1
ci_0003                -3.181724e-02 3 1  ON 2
ci_0004                -3.148901e-02 3 1  ON 3
ci_0005                -2.842217e-02 3 1  ON 4
ci_0006                -2.962401e-02 3 1  ON 5
ci_0007                -1.644668e-02 3 1  ON 6
ci_0008                -1.721890e-02 3 1  ON 7
ci_0009                -1.895889e-02 3 1  ON 8
ci_0010                -1.909749e-02 3 1  ON 9
ci_0011                -1.578365e-02 3 1  ON 10
ci_0012                -1.579250e-02 3 1  ON 11
ci_0013                 1.568465e-02 3 1  ON 12
ci_0014                 1.561332e-02 3 1  ON 13
ci_0015                 1.647825e-02 3 1  ON 14
ci_0016                 1.619591e-02 3 1  ON 15
ci_0017                 1.384683e-02 3 1  ON 16
ci_0018                 1.415263e-02 3 1  ON 17
ci_0019                 1.243864e-02 3 1  ON 18
ci_0020                 1.205189e-02 3 1  ON 19
ci_0021                 1.539481e-02 3 1  ON 20
ci_0022                 1.641557e-02 3 1  ON 21
ci_0023                -1.177808e-02 3 1  ON 22
ci_0024                -1.103740e-02 3 1  ON 23
ci_0025                -2.989138e-03 3 1  ON 24
ci_0026                -2.657208e-03 3 1  ON 25
ci_0027                -1.174745e-02 3 1  ON 26
ci_0028                -1.172154e-02 3 1  ON 27
ci_0029                -1.033862e-02 3 1  ON 28
ci_0030                -1.028745e-02 3 1  ON 29
ci_0031                 1.407069e-02 3 1  ON 30
ci_0032                 1.310034e-02 3 1  ON 31
ci_0033                 8.463085e-03 3 1  ON 32
ci_0034                 8.659907e-03 3 1  ON 33
ci_0035                 5.045348e-03 3 1  ON 34
ci_0036                 4.826643e-03 3 1  ON 35
ci_0037                -1.143341e-02 3 1  ON 36
ci_0038                -1.140350e-02 3 1  ON 37
ci_0039                -3.804163e-03 3 1  ON 38
ci_0040                -3.933594e-03 3 1  ON 39
ci_0041                 9.636345e-03 3 1  ON 40
ci_0042                 9.532948e-03 3 1  ON 41
ci_0043                -6.343206e-03 3 1  ON 42
ci_0044                -6.774538e-03 3 1  ON 43
ci_0045                 1.045936e-02 3 1  ON 44
ci_0046                 9.383477e-03 3 1  ON 45
ci_0047                -3.644337e-03 3 1  ON 46
ci_0048                -3.595116e-03 3 1  ON 47
ci_0049                -2.504370e-03 3 1  ON 48
ci_0050                -2.823184e-03 3 1  ON 49
ci_0051                -1.835867e-03 3 1  ON 50
ci_0052                -1.716056e-03 3 1  ON 51
ci_0053                -4.036105e-03 3 1  ON 52
ci_0054                -3.938164e-03 3 1  ON 53
ci_0055                 2.508147e-03 3 1  ON 54
ci_0056                 2.146698e-03 3 1  ON 55
ci_0057                 2.391346e-03 3 1  ON 56
ci_0058                 3.125245e-03 3 1  ON 57
ci_0059                -4.061079e-03 3 1  ON 58
ci_0060                -3.655057e-03 3 1  ON 59
ci_0061                -2.865983e-03 3 1  ON 60
ci_0062                -3.079687e-03 3 1  ON 61
ci_0063                -9.741593e-03 3 1  ON 62
ci_0064                -9.713275e-03 3 1  ON 63
ci_0065                -7.181105e-03 3 1  ON 64
ci_0066                -6.636043e-03 3 1  ON 65
ci_0067                -3.951522e-03 3 1  ON 66
ci_0068                -3.957918e-03 3 1  ON 67
ci_0069                 3.825574e-03 3 1  ON 68
ci_0070                 3.580884e-03 3 1  ON 69
ci_0071                 4.381174e-03 3 1  ON 70
ci_0072                 4.651004e-03 3 1  ON 71
ci_0073                 3.394242e-03 3 1  ON 72
ci_0074                 3.189410e-03 3 1  ON 73
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 4.5822e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s074 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s074 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=74  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6900e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 74
    time step          = 0.05
    reference energy   = -16.7856
    reference variance = 0.260261
====================================================
  Execution time = 1.4841e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s074
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5243e+04
  VMC Eavg = -1.6902e+01
  VMC Evar = 3.1525e-01
  Total weights = 1.951716807e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 2.6802e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.304358387543
                                         uncertainty =       0.001723039721

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.304358387543
                                         uncertainty =       0.001723039721

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000390141145
  error estimate for blocks of size 2^( 2) =       0.000405147377
  error estimate for blocks of size 2^( 3) =       0.000420757392
  error estimate for blocks of size 2^( 4) =       0.000434159526
  error estimate for blocks of size 2^( 5) =       0.000445580831
  error estimate for blocks of size 2^( 6) =       0.000453766795
  error estimate for blocks of size 2^( 7) =       0.000457924188

      target function =      -0.885553328863
              le_mean =     -16.902423344166
             les_mean =     286.007166592038
             stat err =       0.000447857835
             autocorr =       1.317761590106
   target nu stat err =       0.000447857835
   target dn stat err =       0.002121683605
      target stat err =       0.002740733812
              std dev =       0.551742898026
             le_variance =       0.304420225522


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690242334417e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 74
Check correct_vf_var_size: 225, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 5.9605e+03, overlap shift 5.9605e+04 and omega -1.7527e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.885560689445       residual = 7.20e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.885560695963       residual = 8.96e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.885560697016       residual = 4.40e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.885560697670       residual = 2.30e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.885560697929       residual = 1.18e-04           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.885560698004       residual = 3.62e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.885560698070       residual = 2.20e-05           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.885560698108       residual = 2.67e-05           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.885560698143       residual = 1.87e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.885560698178       residual = 1.16e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.885560698185       residual = 5.65e-06           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.885560698189       residual = 3.31e-06           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.885560698211       residual = 7.44e-07           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.885560698209       residual = 1.79e-07           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.885560698207       residual = 3.74e-08           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.885560698207       residual = 9.08e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         15 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 5.9605e+03 is 5.519107e-08

solving harmonic davidson linear method for identity shift 2.3842e+04, overlap shift 2.3842e+05 and omega -1.7527e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.885560689445       residual = 7.20e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.885560691074       residual = 8.96e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.885560691338       residual = 4.40e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.885560691501       residual = 2.30e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.885560691566       residual = 1.18e-04           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.885560691585       residual = 3.62e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.885560691601       residual = 2.20e-05           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.885560691612       residual = 2.67e-05           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.885560691619       residual = 1.87e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.885560691561       residual = 1.16e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.885560691632       residual = 5.65e-06           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.885560691604       residual = 3.31e-06           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.885560691670       residual = 7.44e-07           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.885560691630       residual = 1.79e-07           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.885560691643       residual = 3.74e-08           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.885560691597       residual = 9.08e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         15 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 2.3842e+04 is 1.379778e-08

solving harmonic davidson linear method for identity shift 9.5367e+04, overlap shift 9.5367e+05 and omega -1.7527e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.885560689445       residual = 7.20e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.885560689852       residual = 8.96e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.885560689918       residual = 4.40e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.885560689959       residual = 2.30e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.885560689975       residual = 1.18e-04           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.885560689980       residual = 3.62e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.885560689928       residual = 2.20e-05           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.885560689986       residual = 2.67e-05           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.885560689940       residual = 1.87e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.885560690281       residual = 1.16e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.885560689991       residual = 5.65e-06           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.885560689992       residual = 3.31e-06           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.885560689992       residual = 7.44e-07           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.885560689899       residual = 1.79e-07           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.885560689992       residual = 3.74e-08           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.885560689992       residual = 9.08e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         15 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 9.5367e+04 is 3.449445e-09

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.990533 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 75 and numParams is: 74

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.7534e+01
  </log>
  <optVariables href="H2O.s074.opt.xml">
ci_0001                 7.026294e-01 3 1  ON 0
ci_0002                 6.983279e-01 3 1  ON 1
ci_0003                -3.181724e-02 3 1  ON 2
ci_0004                -3.148900e-02 3 1  ON 3
ci_0005                -2.842217e-02 3 1  ON 4
ci_0006                -2.962400e-02 3 1  ON 5
ci_0007                -1.644667e-02 3 1  ON 6
ci_0008                -1.721888e-02 3 1  ON 7
ci_0009                -1.895889e-02 3 1  ON 8
ci_0010                -1.909749e-02 3 1  ON 9
ci_0011                -1.578364e-02 3 1  ON 10
ci_0012                -1.579250e-02 3 1  ON 11
ci_0013                 1.568465e-02 3 1  ON 12
ci_0014                 1.561332e-02 3 1  ON 13
ci_0015                 1.647825e-02 3 1  ON 14
ci_0016                 1.619591e-02 3 1  ON 15
ci_0017                 1.384683e-02 3 1  ON 16
ci_0018                 1.415263e-02 3 1  ON 17
ci_0019                 1.243864e-02 3 1  ON 18
ci_0020                 1.205189e-02 3 1  ON 19
ci_0021                 1.539482e-02 3 1  ON 20
ci_0022                 1.641557e-02 3 1  ON 21
ci_0023                -1.177808e-02 3 1  ON 22
ci_0024                -1.103740e-02 3 1  ON 23
ci_0025                -2.989132e-03 3 1  ON 24
ci_0026                -2.657207e-03 3 1  ON 25
ci_0027                -1.174745e-02 3 1  ON 26
ci_0028                -1.172154e-02 3 1  ON 27
ci_0029                -1.033862e-02 3 1  ON 28
ci_0030                -1.028745e-02 3 1  ON 29
ci_0031                 1.407069e-02 3 1  ON 30
ci_0032                 1.310034e-02 3 1  ON 31
ci_0033                 8.463082e-03 3 1  ON 32
ci_0034                 8.659901e-03 3 1  ON 33
ci_0035                 5.045349e-03 3 1  ON 34
ci_0036                 4.826634e-03 3 1  ON 35
ci_0037                -1.143341e-02 3 1  ON 36
ci_0038                -1.140349e-02 3 1  ON 37
ci_0039                -3.804162e-03 3 1  ON 38
ci_0040                -3.933591e-03 3 1  ON 39
ci_0041                 9.636345e-03 3 1  ON 40
ci_0042                 9.532947e-03 3 1  ON 41
ci_0043                -6.343203e-03 3 1  ON 42
ci_0044                -6.774529e-03 3 1  ON 43
ci_0045                 1.045936e-02 3 1  ON 44
ci_0046                 9.383476e-03 3 1  ON 45
ci_0047                -3.644336e-03 3 1  ON 46
ci_0048                -3.595114e-03 3 1  ON 47
ci_0049                -2.504371e-03 3 1  ON 48
ci_0050                -2.823186e-03 3 1  ON 49
ci_0051                -1.835867e-03 3 1  ON 50
ci_0052                -1.716055e-03 3 1  ON 51
ci_0053                -4.036106e-03 3 1  ON 52
ci_0054                -3.938163e-03 3 1  ON 53
ci_0055                 2.508145e-03 3 1  ON 54
ci_0056                 2.146704e-03 3 1  ON 55
ci_0057                 2.391347e-03 3 1  ON 56
ci_0058                 3.125244e-03 3 1  ON 57
ci_0059                -4.061078e-03 3 1  ON 58
ci_0060                -3.655056e-03 3 1  ON 59
ci_0061                -2.865981e-03 3 1  ON 60
ci_0062                -3.079685e-03 3 1  ON 61
ci_0063                -9.741591e-03 3 1  ON 62
ci_0064                -9.713273e-03 3 1  ON 63
ci_0065                -7.181102e-03 3 1  ON 64
ci_0066                -6.636041e-03 3 1  ON 65
ci_0067                -3.951523e-03 3 1  ON 66
ci_0068                -3.957917e-03 3 1  ON 67
ci_0069                 3.825573e-03 3 1  ON 68
ci_0070                 3.580881e-03 3 1  ON 69
ci_0071                 4.381172e-03 3 1  ON 70
ci_0072                 4.651003e-03 3 1  ON 71
ci_0073                 3.394243e-03 3 1  ON 72
ci_0074                 3.189411e-03 3 1  ON 73
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 74
    time step          = 0.05
    reference energy   = -16.9795
    reference variance = 0.313803
====================================================
  Execution time = 1.4926e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s074
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6903e+01
  VMC Evar = 3.1773e-01
  Total weights = 1.9516e+06
  Execution time = 1.9499e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.306499929265
                                         uncertainty =       0.002293591074

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.306499929265
                                         uncertainty =       0.002293591074

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000391427173
  error estimate for blocks of size 2^( 2) =       0.000405961443
  error estimate for blocks of size 2^( 3) =       0.000420848110
  error estimate for blocks of size 2^( 4) =       0.000433468250
  error estimate for blocks of size 2^( 5) =       0.000444287566
  error estimate for blocks of size 2^( 6) =       0.000452649678
  error estimate for blocks of size 2^( 7) =       0.000458561926

      target function =      -0.882479030650
              le_mean =     -16.902626687549
             les_mean =     286.016514693649
             stat err =       0.000447241855
             autocorr =       1.305518225572
   target nu stat err =       0.000447241855
   target dn stat err =       0.002765023358
      target stat err =       0.003509002363
              std dev =       0.553561616197
             le_variance =       0.306430462927

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.306499924636
                                         uncertainty =       0.002293590298

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.306499924636
                                         uncertainty =       0.002293590298

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000391427170
  error estimate for blocks of size 2^( 2) =       0.000405961442
  error estimate for blocks of size 2^( 3) =       0.000420848112
  error estimate for blocks of size 2^( 4) =       0.000433468253
  error estimate for blocks of size 2^( 5) =       0.000444287571
  error estimate for blocks of size 2^( 6) =       0.000452649683
  error estimate for blocks of size 2^( 7) =       0.000458561931

      target function =      -0.882479063489
              le_mean =     -16.902626687425
             les_mean =     286.016514663145
             stat err =       0.000447241859
             autocorr =       1.305518268991
   target nu stat err =       0.000447241859
   target dn stat err =       0.002765020959
      target stat err =       0.003508999674
              std dev =       0.553561612074
             le_variance =       0.306430458362

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.306499926950
                                         uncertainty =       0.002293590686

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.306499926950
                                         uncertainty =       0.002293590686

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000391427171
  error estimate for blocks of size 2^( 2) =       0.000405961442
  error estimate for blocks of size 2^( 3) =       0.000420848111
  error estimate for blocks of size 2^( 4) =       0.000433468251
  error estimate for blocks of size 2^( 5) =       0.000444287568
  error estimate for blocks of size 2^( 6) =       0.000452649681
  error estimate for blocks of size 2^( 7) =       0.000458561929

      target function =      -0.882479047087
              le_mean =     -16.902626687487
             les_mean =     286.016514678383
             stat err =       0.000447241857
             autocorr =       1.305518247278
   target nu stat err =       0.000447241857
   target dn stat err =       0.002765022158
      target stat err =       0.003509001019
              std dev =       0.553561614136
             le_variance =       0.306430460644

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.306499928975
                                         uncertainty =       0.002293591026

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.306499928975
                                         uncertainty =       0.002293591026

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000391427172
  error estimate for blocks of size 2^( 2) =       0.000405961443
  error estimate for blocks of size 2^( 3) =       0.000420848110
  error estimate for blocks of size 2^( 4) =       0.000433468250
  error estimate for blocks of size 2^( 5) =       0.000444287567
  error estimate for blocks of size 2^( 6) =       0.000452649679
  error estimate for blocks of size 2^( 7) =       0.000458561927

      target function =      -0.882479032707
              le_mean =     -16.902626687541
             les_mean =     286.016514691740
             stat err =       0.000447241856
             autocorr =       1.305518228287
   target nu stat err =       0.000447241856
   target dn stat err =       0.002765023208
      target stat err =       0.003509002195
              std dev =       0.553561615939
             le_variance =       0.306430462642


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.882479030650        initial
     5.9605e+03     5.9605e+04             5.5191e-08        -0.882479063489  <--
     2.3842e+04     2.3842e+05             1.3798e-08        -0.882479047087
     9.5367e+04     9.5367e+05             3.4494e-09        -0.882479032707

*****************************************************************************
Applying the update for shift_i =   5.9605e+03     and shift_s =   5.9605e+04
*****************************************************************************

  Execution time = 2.4760e+01
  </log>
  <optVariables href="H2O.s074.opt.xml">
ci_0001                 7.026294e-01 3 1  ON 0
ci_0002                 6.983279e-01 3 1  ON 1
ci_0003                -3.181723e-02 3 1  ON 2
ci_0004                -3.148899e-02 3 1  ON 3
ci_0005                -2.842215e-02 3 1  ON 4
ci_0006                -2.962398e-02 3 1  ON 5
ci_0007                -1.644666e-02 3 1  ON 6
ci_0008                -1.721885e-02 3 1  ON 7
ci_0009                -1.895888e-02 3 1  ON 8
ci_0010                -1.909749e-02 3 1  ON 9
ci_0011                -1.578364e-02 3 1  ON 10
ci_0012                -1.579250e-02 3 1  ON 11
ci_0013                 1.568465e-02 3 1  ON 12
ci_0014                 1.561332e-02 3 1  ON 13
ci_0015                 1.647825e-02 3 1  ON 14
ci_0016                 1.619590e-02 3 1  ON 15
ci_0017                 1.384682e-02 3 1  ON 16
ci_0018                 1.415262e-02 3 1  ON 17
ci_0019                 1.243864e-02 3 1  ON 18
ci_0020                 1.205190e-02 3 1  ON 19
ci_0021                 1.539483e-02 3 1  ON 20
ci_0022                 1.641556e-02 3 1  ON 21
ci_0023                -1.177808e-02 3 1  ON 22
ci_0024                -1.103740e-02 3 1  ON 23
ci_0025                -2.989117e-03 3 1  ON 24
ci_0026                -2.657205e-03 3 1  ON 25
ci_0027                -1.174745e-02 3 1  ON 26
ci_0028                -1.172155e-02 3 1  ON 27
ci_0029                -1.033862e-02 3 1  ON 28
ci_0030                -1.028745e-02 3 1  ON 29
ci_0031                 1.407069e-02 3 1  ON 30
ci_0032                 1.310033e-02 3 1  ON 31
ci_0033                 8.463072e-03 3 1  ON 32
ci_0034                 8.659882e-03 3 1  ON 33
ci_0035                 5.045350e-03 3 1  ON 34
ci_0036                 4.826608e-03 3 1  ON 35
ci_0037                -1.143341e-02 3 1  ON 36
ci_0038                -1.140348e-02 3 1  ON 37
ci_0039                -3.804159e-03 3 1  ON 38
ci_0040                -3.933585e-03 3 1  ON 39
ci_0041                 9.636345e-03 3 1  ON 40
ci_0042                 9.532942e-03 3 1  ON 41
ci_0043                -6.343193e-03 3 1  ON 42
ci_0044                -6.774505e-03 3 1  ON 43
ci_0045                 1.045935e-02 3 1  ON 44
ci_0046                 9.383475e-03 3 1  ON 45
ci_0047                -3.644334e-03 3 1  ON 46
ci_0048                -3.595108e-03 3 1  ON 47
ci_0049                -2.504371e-03 3 1  ON 48
ci_0050                -2.823193e-03 3 1  ON 49
ci_0051                -1.835867e-03 3 1  ON 50
ci_0052                -1.716053e-03 3 1  ON 51
ci_0053                -4.036109e-03 3 1  ON 52
ci_0054                -3.938159e-03 3 1  ON 53
ci_0055                 2.508140e-03 3 1  ON 54
ci_0056                 2.146721e-03 3 1  ON 55
ci_0057                 2.391350e-03 3 1  ON 56
ci_0058                 3.125241e-03 3 1  ON 57
ci_0059                -4.061076e-03 3 1  ON 58
ci_0060                -3.655055e-03 3 1  ON 59
ci_0061                -2.865972e-03 3 1  ON 60
ci_0062                -3.079679e-03 3 1  ON 61
ci_0063                -9.741584e-03 3 1  ON 62
ci_0064                -9.713266e-03 3 1  ON 63
ci_0065                -7.181094e-03 3 1  ON 64
ci_0066                -6.636037e-03 3 1  ON 65
ci_0067                -3.951525e-03 3 1  ON 66
ci_0068                -3.957913e-03 3 1  ON 67
ci_0069                 3.825567e-03 3 1  ON 68
ci_0070                 3.580872e-03 3 1  ON 69
ci_0071                 4.381169e-03 3 1  ON 70
ci_0072                 4.651001e-03 3 1  ON 71
ci_0073                 3.394246e-03 3 1  ON 72
ci_0074                 3.189413e-03 3 1  ON 73
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 4.2300e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s075 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s075 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=75  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6899e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 75
    time step          = 0.05
    reference energy   = -16.892
    reference variance = 0.368364
====================================================
  Execution time = 1.5052e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s075
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5254e+04
  VMC Eavg = -1.6904e+01
  VMC Evar = 3.1696e-01
  Total weights = 1.951769088e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 2.7003e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.306048503069
                                         uncertainty =       0.001973303317

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.306048503069
                                         uncertainty =       0.001973303317

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000391178453
  error estimate for blocks of size 2^( 2) =       0.000405944441
  error estimate for blocks of size 2^( 3) =       0.000420799086
  error estimate for blocks of size 2^( 4) =       0.000434331810
  error estimate for blocks of size 2^( 5) =       0.000444971464
  error estimate for blocks of size 2^( 6) =       0.000452333034
  error estimate for blocks of size 2^( 7) =       0.000455515443

      target function =      -0.883578995712
              le_mean =     -16.903648312676
             les_mean =     286.050290312386
             stat err =       0.000446787938
             autocorr =       1.304526873891
   target nu stat err =       0.000446787938
   target dn stat err =       0.002631255338
      target stat err =       0.003358463356
              std dev =       0.553209873061
             le_variance =       0.306041163652


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690364831268e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 74
Check correct_vf_var_size: 225, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.4901e+03, overlap shift 1.4901e+04 and omega -1.7527e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.883590718317       residual = 6.02e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.883590739111       residual = 8.45e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.883590742708       residual = 2.31e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.883590743692       residual = 1.19e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.883590744410       residual = 4.34e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.883590744582       residual = 1.53e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.883590744690       residual = 4.99e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.883590744671       residual = 1.44e-06           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.883590744696       residual = 4.98e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.883590744703       residual = 2.65e-07           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.883590744697       residual = 1.63e-07           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.883590744688       residual = 1.40e-07           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.883590744696       residual = 1.24e-07           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.883590744710       residual = 7.58e-08           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.883590744705       residual = 1.55e-08           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.883590744704       residual = 4.05e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         15 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 1.4901e+03 is 1.197267e-07

solving harmonic davidson linear method for identity shift 5.9605e+03, overlap shift 5.9605e+04 and omega -1.7527e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.883590718317       residual = 6.02e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.883590723516       residual = 8.45e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.883590724415       residual = 2.31e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.883590724661       residual = 1.19e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.883590724836       residual = 4.34e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.883590724885       residual = 1.53e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.883590724908       residual = 4.99e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.883590724913       residual = 1.44e-06           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.883590724912       residual = 4.98e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.883590724914       residual = 2.65e-07           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.883590724912       residual = 1.63e-07           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.883590724904       residual = 1.40e-07           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.883590724918       residual = 1.24e-07           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.883590724915       residual = 7.58e-08           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.883590724914       residual = 1.55e-08           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.883590724914       residual = 4.05e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         15 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 5.9605e+03 is 2.993221e-08

solving harmonic davidson linear method for identity shift 2.3842e+04, overlap shift 2.3842e+05 and omega -1.7527e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.883590718317       residual = 6.02e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.883590719617       residual = 8.45e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.883590719841       residual = 2.31e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.883590719903       residual = 1.19e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.883590719945       residual = 4.34e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.883590719944       residual = 1.53e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.883590720016       residual = 4.99e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.883590719953       residual = 1.44e-06           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.883590719947       residual = 4.98e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.883590719966       residual = 2.65e-07           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.883590719978       residual = 1.63e-07           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.883590719965       residual = 1.40e-07           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.883590719948       residual = 1.24e-07           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.883590719924       residual = 7.58e-08           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.883590719966       residual = 1.55e-08           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.883590720005       residual = 4.05e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         15 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 2.3842e+04 is 7.483087e-09

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.998497 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 75 and numParams is: 74

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.7766e+01
  </log>
  <optVariables href="H2O.s075.opt.xml">
ci_0001                 7.026294e-01 3 1  ON 0
ci_0002                 6.983279e-01 3 1  ON 1
ci_0003                -3.181721e-02 3 1  ON 2
ci_0004                -3.148898e-02 3 1  ON 3
ci_0005                -2.842214e-02 3 1  ON 4
ci_0006                -2.962396e-02 3 1  ON 5
ci_0007                -1.644663e-02 3 1  ON 6
ci_0008                -1.721883e-02 3 1  ON 7
ci_0009                -1.895889e-02 3 1  ON 8
ci_0010                -1.909749e-02 3 1  ON 9
ci_0011                -1.578364e-02 3 1  ON 10
ci_0012                -1.579248e-02 3 1  ON 11
ci_0013                 1.568464e-02 3 1  ON 12
ci_0014                 1.561332e-02 3 1  ON 13
ci_0015                 1.647824e-02 3 1  ON 14
ci_0016                 1.619589e-02 3 1  ON 15
ci_0017                 1.384680e-02 3 1  ON 16
ci_0018                 1.415261e-02 3 1  ON 17
ci_0019                 1.243863e-02 3 1  ON 18
ci_0020                 1.205189e-02 3 1  ON 19
ci_0021                 1.539483e-02 3 1  ON 20
ci_0022                 1.641555e-02 3 1  ON 21
ci_0023                -1.177807e-02 3 1  ON 22
ci_0024                -1.103741e-02 3 1  ON 23
ci_0025                -2.989114e-03 3 1  ON 24
ci_0026                -2.657193e-03 3 1  ON 25
ci_0027                -1.174743e-02 3 1  ON 26
ci_0028                -1.172154e-02 3 1  ON 27
ci_0029                -1.033862e-02 3 1  ON 28
ci_0030                -1.028744e-02 3 1  ON 29
ci_0031                 1.407068e-02 3 1  ON 30
ci_0032                 1.310033e-02 3 1  ON 31
ci_0033                 8.463073e-03 3 1  ON 32
ci_0034                 8.659857e-03 3 1  ON 33
ci_0035                 5.045339e-03 3 1  ON 34
ci_0036                 4.826594e-03 3 1  ON 35
ci_0037                -1.143341e-02 3 1  ON 36
ci_0038                -1.140348e-02 3 1  ON 37
ci_0039                -3.804155e-03 3 1  ON 38
ci_0040                -3.933575e-03 3 1  ON 39
ci_0041                 9.636334e-03 3 1  ON 40
ci_0042                 9.532949e-03 3 1  ON 41
ci_0043                -6.343177e-03 3 1  ON 42
ci_0044                -6.774502e-03 3 1  ON 43
ci_0045                 1.045935e-02 3 1  ON 44
ci_0046                 9.383483e-03 3 1  ON 45
ci_0047                -3.644325e-03 3 1  ON 46
ci_0048                -3.595104e-03 3 1  ON 47
ci_0049                -2.504368e-03 3 1  ON 48
ci_0050                -2.823175e-03 3 1  ON 49
ci_0051                -1.835869e-03 3 1  ON 50
ci_0052                -1.716050e-03 3 1  ON 51
ci_0053                -4.036103e-03 3 1  ON 52
ci_0054                -3.938154e-03 3 1  ON 53
ci_0055                 2.508138e-03 3 1  ON 54
ci_0056                 2.146702e-03 3 1  ON 55
ci_0057                 2.391333e-03 3 1  ON 56
ci_0058                 3.125236e-03 3 1  ON 57
ci_0059                -4.061072e-03 3 1  ON 58
ci_0060                -3.655061e-03 3 1  ON 59
ci_0061                -2.865965e-03 3 1  ON 60
ci_0062                -3.079674e-03 3 1  ON 61
ci_0063                -9.741572e-03 3 1  ON 62
ci_0064                -9.713265e-03 3 1  ON 63
ci_0065                -7.181092e-03 3 1  ON 64
ci_0066                -6.636035e-03 3 1  ON 65
ci_0067                -3.951521e-03 3 1  ON 66
ci_0068                -3.957899e-03 3 1  ON 67
ci_0069                 3.825564e-03 3 1  ON 68
ci_0070                 3.580876e-03 3 1  ON 69
ci_0071                 4.381175e-03 3 1  ON 70
ci_0072                 4.651006e-03 3 1  ON 71
ci_0073                 3.394252e-03 3 1  ON 72
ci_0074                 3.189412e-03 3 1  ON 73
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 75
    time step          = 0.05
    reference energy   = -16.8915
    reference variance = 0.162618
====================================================
  Execution time = 1.4535e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s075
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6902e+01
  VMC Evar = 3.1930e-01
  Total weights = 1.9518e+06
  Execution time = 1.9495e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.305333413128
                                         uncertainty =       0.002175503743

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.305333413128
                                         uncertainty =       0.002175503743

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000390698762
  error estimate for blocks of size 2^( 2) =       0.000405547476
  error estimate for blocks of size 2^( 3) =       0.000420399177
  error estimate for blocks of size 2^( 4) =       0.000434782666
  error estimate for blocks of size 2^( 5) =       0.000446195182
  error estimate for blocks of size 2^( 6) =       0.000455615369
  error estimate for blocks of size 2^( 7) =       0.000461468188

      target function =      -0.880470666389
              le_mean =     -16.902349804493
             les_mean =     286.008731126067
             stat err =       0.000449515351
             autocorr =       1.323746989550
   target nu stat err =       0.000449515351
   target dn stat err =       0.003362219535
      target stat err =       0.004223932755
              std dev =       0.552531488057
             le_variance =       0.305291045294

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.305333412601
                                         uncertainty =       0.002175509858

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.305333412601
                                         uncertainty =       0.002175509858

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000390698762
  error estimate for blocks of size 2^( 2) =       0.000405547483
  error estimate for blocks of size 2^( 3) =       0.000420399190
  error estimate for blocks of size 2^( 4) =       0.000434782685
  error estimate for blocks of size 2^( 5) =       0.000446195203
  error estimate for blocks of size 2^( 6) =       0.000455615389
  error estimate for blocks of size 2^( 7) =       0.000461468210

      target function =      -0.880470981183
              le_mean =     -16.902349804832
             les_mean =     286.008730883694
             stat err =       0.000449515372
             autocorr =       1.323747112475
   target nu stat err =       0.000449515372
   target dn stat err =       0.003362264206
      target stat err =       0.004223990605
              std dev =       0.552531487598
             le_variance =       0.305291044788

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.305333412864
                                         uncertainty =       0.002175506800

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.305333412864
                                         uncertainty =       0.002175506800

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000390698762
  error estimate for blocks of size 2^( 2) =       0.000405547479
  error estimate for blocks of size 2^( 3) =       0.000420399183
  error estimate for blocks of size 2^( 4) =       0.000434782675
  error estimate for blocks of size 2^( 5) =       0.000446195192
  error estimate for blocks of size 2^( 6) =       0.000455615379
  error estimate for blocks of size 2^( 7) =       0.000461468199

      target function =      -0.880470824124
              le_mean =     -16.902349804662
             les_mean =     286.008731004606
             stat err =       0.000449515362
             autocorr =       1.323747051014
   target nu stat err =       0.000449515362
   target dn stat err =       0.003362241866
      target stat err =       0.004223961678
              std dev =       0.552531487827
             le_variance =       0.305291045040

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.305333413095
                                         uncertainty =       0.002175504125

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.305333413095
                                         uncertainty =       0.002175504125

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000390698762
  error estimate for blocks of size 2^( 2) =       0.000405547476
  error estimate for blocks of size 2^( 3) =       0.000420399177
  error estimate for blocks of size 2^( 4) =       0.000434782667
  error estimate for blocks of size 2^( 5) =       0.000446195183
  error estimate for blocks of size 2^( 6) =       0.000455615370
  error estimate for blocks of size 2^( 7) =       0.000461468190

      target function =      -0.880470686143
              le_mean =     -16.902349804514
             les_mean =     286.008731110855
             stat err =       0.000449515353
             autocorr =       1.323746997239
   target nu stat err =       0.000449515353
   target dn stat err =       0.003362222326
      target stat err =       0.004223936370
              std dev =       0.552531488028
             le_variance =       0.305291045262


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.880470666389        initial
     1.4901e+03     1.4901e+04             1.1973e-07        -0.880470981183  <--
     5.9605e+03     5.9605e+04             2.9932e-08        -0.880470824124
     2.3842e+04     2.3842e+05             7.4831e-09        -0.880470686143

*****************************************************************************
Applying the update for shift_i =   1.4901e+03     and shift_s =   1.4901e+04
*****************************************************************************

  Execution time = 2.4384e+01
  </log>
  <optVariables href="H2O.s075.opt.xml">
ci_0001                 7.026295e-01 3 1  ON 0
ci_0002                 6.983279e-01 3 1  ON 1
ci_0003                -3.181714e-02 3 1  ON 2
ci_0004                -3.148894e-02 3 1  ON 3
ci_0005                -2.842209e-02 3 1  ON 4
ci_0006                -2.962391e-02 3 1  ON 5
ci_0007                -1.644654e-02 3 1  ON 6
ci_0008                -1.721878e-02 3 1  ON 7
ci_0009                -1.895890e-02 3 1  ON 8
ci_0010                -1.909748e-02 3 1  ON 9
ci_0011                -1.578364e-02 3 1  ON 10
ci_0012                -1.579244e-02 3 1  ON 11
ci_0013                 1.568463e-02 3 1  ON 12
ci_0014                 1.561331e-02 3 1  ON 13
ci_0015                 1.647823e-02 3 1  ON 14
ci_0016                 1.619587e-02 3 1  ON 15
ci_0017                 1.384676e-02 3 1  ON 16
ci_0018                 1.415259e-02 3 1  ON 17
ci_0019                 1.243861e-02 3 1  ON 18
ci_0020                 1.205185e-02 3 1  ON 19
ci_0021                 1.539481e-02 3 1  ON 20
ci_0022                 1.641552e-02 3 1  ON 21
ci_0023                -1.177806e-02 3 1  ON 22
ci_0024                -1.103741e-02 3 1  ON 23
ci_0025                -2.989104e-03 3 1  ON 24
ci_0026                -2.657156e-03 3 1  ON 25
ci_0027                -1.174738e-02 3 1  ON 26
ci_0028                -1.172150e-02 3 1  ON 27
ci_0029                -1.033865e-02 3 1  ON 28
ci_0030                -1.028743e-02 3 1  ON 29
ci_0031                 1.407066e-02 3 1  ON 30
ci_0032                 1.310031e-02 3 1  ON 31
ci_0033                 8.463078e-03 3 1  ON 32
ci_0034                 8.659784e-03 3 1  ON 33
ci_0035                 5.045305e-03 3 1  ON 34
ci_0036                 4.826551e-03 3 1  ON 35
ci_0037                -1.143339e-02 3 1  ON 36
ci_0038                -1.140348e-02 3 1  ON 37
ci_0039                -3.804144e-03 3 1  ON 38
ci_0040                -3.933545e-03 3 1  ON 39
ci_0041                 9.636301e-03 3 1  ON 40
ci_0042                 9.532969e-03 3 1  ON 41
ci_0043                -6.343126e-03 3 1  ON 42
ci_0044                -6.774493e-03 3 1  ON 43
ci_0045                 1.045936e-02 3 1  ON 44
ci_0046                 9.383506e-03 3 1  ON 45
ci_0047                -3.644298e-03 3 1  ON 46
ci_0048                -3.595092e-03 3 1  ON 47
ci_0049                -2.504358e-03 3 1  ON 48
ci_0050                -2.823123e-03 3 1  ON 49
ci_0051                -1.835872e-03 3 1  ON 50
ci_0052                -1.716040e-03 3 1  ON 51
ci_0053                -4.036086e-03 3 1  ON 52
ci_0054                -3.938138e-03 3 1  ON 53
ci_0055                 2.508132e-03 3 1  ON 54
ci_0056                 2.146646e-03 3 1  ON 55
ci_0057                 2.391282e-03 3 1  ON 56
ci_0058                 3.125218e-03 3 1  ON 57
ci_0059                -4.061061e-03 3 1  ON 58
ci_0060                -3.655080e-03 3 1  ON 59
ci_0061                -2.865943e-03 3 1  ON 60
ci_0062                -3.079660e-03 3 1  ON 61
ci_0063                -9.741534e-03 3 1  ON 62
ci_0064                -9.713262e-03 3 1  ON 63
ci_0065                -7.181087e-03 3 1  ON 64
ci_0066                -6.636029e-03 3 1  ON 65
ci_0067                -3.951508e-03 3 1  ON 66
ci_0068                -3.957857e-03 3 1  ON 67
ci_0069                 3.825555e-03 3 1  ON 68
ci_0070                 3.580888e-03 3 1  ON 69
ci_0071                 4.381191e-03 3 1  ON 70
ci_0072                 4.651021e-03 3 1  ON 71
ci_0073                 3.394270e-03 3 1  ON 72
ci_0074                 3.189408e-03 3 1  ON 73
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 4.2155e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s076 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s076 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=76  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6899e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 76
    time step          = 0.05
    reference energy   = -16.9031
    reference variance = 0.280701
====================================================
  Execution time = 1.4864e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s076
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5248e+04
  VMC Eavg = -1.6904e+01
  VMC Evar = 3.1638e-01
  Total weights = 1.951671347e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 2.6749e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.303410732722
                                         uncertainty =       0.001862813676

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.303410732722
                                         uncertainty =       0.001862813676

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000389460285
  error estimate for blocks of size 2^( 2) =       0.000404459462
  error estimate for blocks of size 2^( 3) =       0.000419833170
  error estimate for blocks of size 2^( 4) =       0.000433435407
  error estimate for blocks of size 2^( 5) =       0.000445253798
  error estimate for blocks of size 2^( 6) =       0.000452451633
  error estimate for blocks of size 2^( 7) =       0.000458466297

      target function =      -0.884295936933
              le_mean =     -16.903521993284
             les_mean =     286.045431098514
             stat err =       0.000447401784
             autocorr =       1.319681317040
   target nu stat err =       0.000447401784
   target dn stat err =       0.002969103864
      target stat err =       0.003780608407
              std dev =       0.550780016783
             le_variance =       0.303358626888


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690352199328e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 74
Check correct_vf_var_size: 225, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 3.7253e+02, overlap shift 3.7253e+03 and omega -1.7527e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.884311014973       residual = 8.71e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.884311122131       residual = 1.65e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.884311143048       residual = 6.71e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.884311153615       residual = 1.75e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.884311159481       residual = 7.70e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.884311161032       residual = 3.86e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.884311161597       residual = 1.77e-05           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.884311161643       residual = 1.83e-05           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.884311161686       residual = 1.65e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.884311162181       residual = 1.24e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.884311162111       residual = 5.54e-06           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.884311162399       residual = 1.94e-06           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.884311162436       residual = 7.95e-07           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.884311162490       residual = 2.28e-07           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.884311162509       residual = 5.65e-08           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.884311162505       residual = 1.20e-08           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.884311162496       residual = 3.40e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         16 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 3.7253e+02 is 8.334863e-07

solving harmonic davidson linear method for identity shift 1.4901e+03, overlap shift 1.4901e+04 and omega -1.7527e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.884311014973       residual = 8.71e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.884311041767       residual = 1.65e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.884311046996       residual = 6.71e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.884311049638       residual = 1.75e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.884311051105       residual = 7.70e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.884311051493       residual = 3.86e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.884311051630       residual = 1.76e-05           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.884311051643       residual = 1.83e-05           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.884311051656       residual = 1.65e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.884311051780       residual = 1.24e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.884311051765       residual = 5.54e-06           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.884311051835       residual = 1.94e-06           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.884311051842       residual = 7.94e-07           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.884311051856       residual = 2.28e-07           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.884311051862       residual = 5.65e-08           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.884311051864       residual = 1.19e-08           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.884311051861       residual = 3.39e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         16 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 1.4901e+03 is 2.083745e-07

solving harmonic davidson linear method for identity shift 5.9605e+03, overlap shift 5.9605e+04 and omega -1.7527e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.884311014973       residual = 8.71e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.884311021672       residual = 1.65e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.884311022979       residual = 6.71e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.884311023645       residual = 1.75e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.884311024006       residual = 7.70e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.884311024097       residual = 3.86e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.884311024145       residual = 1.76e-05           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.884311024144       residual = 1.83e-05           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.884311024135       residual = 1.65e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.884311024178       residual = 1.24e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.884311024175       residual = 5.54e-06           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.884311024172       residual = 1.94e-06           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.884311024179       residual = 7.94e-07           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.884311024197       residual = 2.28e-07           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.884311024204       residual = 5.65e-08           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.884311024189       residual = 1.19e-08           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.884311024203       residual = 3.39e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         16 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 5.9605e+03 is 5.209380e-08

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               1.007392 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 75 and numParams is: 74

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.7556e+01
  </log>
  <optVariables href="H2O.s076.opt.xml">
ci_0001                 7.026297e-01 3 1  ON 0
ci_0002                 6.983277e-01 3 1  ON 1
ci_0003                -3.181701e-02 3 1  ON 2
ci_0004                -3.148888e-02 3 1  ON 3
ci_0005                -2.842197e-02 3 1  ON 4
ci_0006                -2.962389e-02 3 1  ON 5
ci_0007                -1.644641e-02 3 1  ON 6
ci_0008                -1.721866e-02 3 1  ON 7
ci_0009                -1.895885e-02 3 1  ON 8
ci_0010                -1.909746e-02 3 1  ON 9
ci_0011                -1.578359e-02 3 1  ON 10
ci_0012                -1.579245e-02 3 1  ON 11
ci_0013                 1.568464e-02 3 1  ON 12
ci_0014                 1.561333e-02 3 1  ON 13
ci_0015                 1.647819e-02 3 1  ON 14
ci_0016                 1.619582e-02 3 1  ON 15
ci_0017                 1.384675e-02 3 1  ON 16
ci_0018                 1.415250e-02 3 1  ON 17
ci_0019                 1.243863e-02 3 1  ON 18
ci_0020                 1.205187e-02 3 1  ON 19
ci_0021                 1.539477e-02 3 1  ON 20
ci_0022                 1.641543e-02 3 1  ON 21
ci_0023                -1.177803e-02 3 1  ON 22
ci_0024                -1.103741e-02 3 1  ON 23
ci_0025                -2.989086e-03 3 1  ON 24
ci_0026                -2.657081e-03 3 1  ON 25
ci_0027                -1.174733e-02 3 1  ON 26
ci_0028                -1.172157e-02 3 1  ON 27
ci_0029                -1.033863e-02 3 1  ON 28
ci_0030                -1.028735e-02 3 1  ON 29
ci_0031                 1.407067e-02 3 1  ON 30
ci_0032                 1.310034e-02 3 1  ON 31
ci_0033                 8.463093e-03 3 1  ON 32
ci_0034                 8.659791e-03 3 1  ON 33
ci_0035                 5.045295e-03 3 1  ON 34
ci_0036                 4.826478e-03 3 1  ON 35
ci_0037                -1.143335e-02 3 1  ON 36
ci_0038                -1.140344e-02 3 1  ON 37
ci_0039                -3.804143e-03 3 1  ON 38
ci_0040                -3.933527e-03 3 1  ON 39
ci_0041                 9.636282e-03 3 1  ON 40
ci_0042                 9.532983e-03 3 1  ON 41
ci_0043                -6.343195e-03 3 1  ON 42
ci_0044                -6.774505e-03 3 1  ON 43
ci_0045                 1.045935e-02 3 1  ON 44
ci_0046                 9.383549e-03 3 1  ON 45
ci_0047                -3.644287e-03 3 1  ON 46
ci_0048                -3.595056e-03 3 1  ON 47
ci_0049                -2.504417e-03 3 1  ON 48
ci_0050                -2.823122e-03 3 1  ON 49
ci_0051                -1.835857e-03 3 1  ON 50
ci_0052                -1.716070e-03 3 1  ON 51
ci_0053                -4.036063e-03 3 1  ON 52
ci_0054                -3.938109e-03 3 1  ON 53
ci_0055                 2.508158e-03 3 1  ON 54
ci_0056                 2.146611e-03 3 1  ON 55
ci_0057                 2.391307e-03 3 1  ON 56
ci_0058                 3.125219e-03 3 1  ON 57
ci_0059                -4.060999e-03 3 1  ON 58
ci_0060                -3.655061e-03 3 1  ON 59
ci_0061                -2.865941e-03 3 1  ON 60
ci_0062                -3.079659e-03 3 1  ON 61
ci_0063                -9.741492e-03 3 1  ON 62
ci_0064                -9.713250e-03 3 1  ON 63
ci_0065                -7.181085e-03 3 1  ON 64
ci_0066                -6.635999e-03 3 1  ON 65
ci_0067                -3.951523e-03 3 1  ON 66
ci_0068                -3.957781e-03 3 1  ON 67
ci_0069                 3.825535e-03 3 1  ON 68
ci_0070                 3.580894e-03 3 1  ON 69
ci_0071                 4.381197e-03 3 1  ON 70
ci_0072                 4.651083e-03 3 1  ON 71
ci_0073                 3.394250e-03 3 1  ON 72
ci_0074                 3.189418e-03 3 1  ON 73
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 76
    time step          = 0.05
    reference energy   = -16.8501
    reference variance = 0.323386
====================================================
  Execution time = 1.4464e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s076
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6903e+01
  VMC Evar = 3.1796e-01
  Total weights = 1.9516e+06
  Execution time = 1.9603e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.304454194579
                                         uncertainty =       0.002899887126

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.304454194579
                                         uncertainty =       0.002899887126

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000390188265
  error estimate for blocks of size 2^( 2) =       0.000404715709
  error estimate for blocks of size 2^( 3) =       0.000419523713
  error estimate for blocks of size 2^( 4) =       0.000432038334
  error estimate for blocks of size 2^( 5) =       0.000442671671
  error estimate for blocks of size 2^( 6) =       0.000449466429
  error estimate for blocks of size 2^( 7) =       0.000454045874

      target function =      -0.882251593972
              le_mean =     -16.903219730488
             les_mean =     286.036796874785
             stat err =       0.000444555577
             autocorr =       1.298086752671
   target nu stat err =       0.000444555577
   target dn stat err =       0.004346380975
      target stat err =       0.005464310236
              std dev =       0.551809536278
             le_variance =       0.304493764327

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.304454185805
                                         uncertainty =       0.002899896692

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.304454185805
                                         uncertainty =       0.002899896692

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000390188259
  error estimate for blocks of size 2^( 2) =       0.000404715726
  error estimate for blocks of size 2^( 3) =       0.000419523756
  error estimate for blocks of size 2^( 4) =       0.000432038385
  error estimate for blocks of size 2^( 5) =       0.000442671739
  error estimate for blocks of size 2^( 6) =       0.000449466495
  error estimate for blocks of size 2^( 7) =       0.000454045931

      target function =      -0.882250863147
              le_mean =     -16.903219733125
             les_mean =     286.036797548339
             stat err =       0.000444555637
             autocorr =       1.298087145033
   target nu stat err =       0.000444555637
   target dn stat err =       0.004346474160
      target stat err =       0.005464416884
              std dev =       0.551809528215
             le_variance =       0.304493755428

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.304454190182
                                         uncertainty =       0.002899891909

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.304454190182
                                         uncertainty =       0.002899891909

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000390188262
  error estimate for blocks of size 2^( 2) =       0.000404715718
  error estimate for blocks of size 2^( 3) =       0.000419523734
  error estimate for blocks of size 2^( 4) =       0.000432038359
  error estimate for blocks of size 2^( 5) =       0.000442671705
  error estimate for blocks of size 2^( 6) =       0.000449466462
  error estimate for blocks of size 2^( 7) =       0.000454045902

      target function =      -0.882251229390
              le_mean =     -16.903219731806
             les_mean =     286.036797210861
             stat err =       0.000444555607
             autocorr =       1.298086948889
   target nu stat err =       0.000444555607
   target dn stat err =       0.004346427560
      target stat err =       0.005464363561
              std dev =       0.551809532237
             le_variance =       0.304493759867

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.304454194028
                                         uncertainty =       0.002899887724

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.304454194028
                                         uncertainty =       0.002899887724

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000390188265
  error estimate for blocks of size 2^( 2) =       0.000404715710
  error estimate for blocks of size 2^( 3) =       0.000419523716
  error estimate for blocks of size 2^( 4) =       0.000432038337
  error estimate for blocks of size 2^( 5) =       0.000442671675
  error estimate for blocks of size 2^( 6) =       0.000449466433
  error estimate for blocks of size 2^( 7) =       0.000454045877

      target function =      -0.882251548495
              le_mean =     -16.903219730653
             les_mean =     286.036796916714
             stat err =       0.000444555581
             autocorr =       1.298086777208
   target nu stat err =       0.000444555581
   target dn stat err =       0.004346386797
      target stat err =       0.005464316902
              std dev =       0.551809535772
             le_variance =       0.304493763768


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.882251593972        initial  <--
     3.7253e+02     3.7253e+03             8.3349e-07        -0.882250863147
     1.4901e+03     1.4901e+04             2.0837e-07        -0.882251229390
     5.9605e+03     5.9605e+04             5.2094e-08        -0.882251548495

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 24.4005
  </log>
  <optVariables href="H2O.s076.opt.xml">
ci_0001                 7.026295e-01 3 1  ON 0
ci_0002                 6.983279e-01 3 1  ON 1
ci_0003                -3.181714e-02 3 1  ON 2
ci_0004                -3.148894e-02 3 1  ON 3
ci_0005                -2.842209e-02 3 1  ON 4
ci_0006                -2.962391e-02 3 1  ON 5
ci_0007                -1.644654e-02 3 1  ON 6
ci_0008                -1.721878e-02 3 1  ON 7
ci_0009                -1.895890e-02 3 1  ON 8
ci_0010                -1.909748e-02 3 1  ON 9
ci_0011                -1.578364e-02 3 1  ON 10
ci_0012                -1.579244e-02 3 1  ON 11
ci_0013                 1.568463e-02 3 1  ON 12
ci_0014                 1.561331e-02 3 1  ON 13
ci_0015                 1.647823e-02 3 1  ON 14
ci_0016                 1.619587e-02 3 1  ON 15
ci_0017                 1.384676e-02 3 1  ON 16
ci_0018                 1.415259e-02 3 1  ON 17
ci_0019                 1.243861e-02 3 1  ON 18
ci_0020                 1.205185e-02 3 1  ON 19
ci_0021                 1.539481e-02 3 1  ON 20
ci_0022                 1.641552e-02 3 1  ON 21
ci_0023                -1.177806e-02 3 1  ON 22
ci_0024                -1.103741e-02 3 1  ON 23
ci_0025                -2.989104e-03 3 1  ON 24
ci_0026                -2.657156e-03 3 1  ON 25
ci_0027                -1.174738e-02 3 1  ON 26
ci_0028                -1.172150e-02 3 1  ON 27
ci_0029                -1.033865e-02 3 1  ON 28
ci_0030                -1.028743e-02 3 1  ON 29
ci_0031                 1.407066e-02 3 1  ON 30
ci_0032                 1.310031e-02 3 1  ON 31
ci_0033                 8.463078e-03 3 1  ON 32
ci_0034                 8.659784e-03 3 1  ON 33
ci_0035                 5.045305e-03 3 1  ON 34
ci_0036                 4.826551e-03 3 1  ON 35
ci_0037                -1.143339e-02 3 1  ON 36
ci_0038                -1.140348e-02 3 1  ON 37
ci_0039                -3.804144e-03 3 1  ON 38
ci_0040                -3.933545e-03 3 1  ON 39
ci_0041                 9.636301e-03 3 1  ON 40
ci_0042                 9.532969e-03 3 1  ON 41
ci_0043                -6.343126e-03 3 1  ON 42
ci_0044                -6.774493e-03 3 1  ON 43
ci_0045                 1.045936e-02 3 1  ON 44
ci_0046                 9.383506e-03 3 1  ON 45
ci_0047                -3.644298e-03 3 1  ON 46
ci_0048                -3.595092e-03 3 1  ON 47
ci_0049                -2.504358e-03 3 1  ON 48
ci_0050                -2.823123e-03 3 1  ON 49
ci_0051                -1.835872e-03 3 1  ON 50
ci_0052                -1.716040e-03 3 1  ON 51
ci_0053                -4.036086e-03 3 1  ON 52
ci_0054                -3.938138e-03 3 1  ON 53
ci_0055                 2.508132e-03 3 1  ON 54
ci_0056                 2.146646e-03 3 1  ON 55
ci_0057                 2.391282e-03 3 1  ON 56
ci_0058                 3.125218e-03 3 1  ON 57
ci_0059                -4.061061e-03 3 1  ON 58
ci_0060                -3.655080e-03 3 1  ON 59
ci_0061                -2.865943e-03 3 1  ON 60
ci_0062                -3.079660e-03 3 1  ON 61
ci_0063                -9.741534e-03 3 1  ON 62
ci_0064                -9.713262e-03 3 1  ON 63
ci_0065                -7.181087e-03 3 1  ON 64
ci_0066                -6.636029e-03 3 1  ON 65
ci_0067                -3.951508e-03 3 1  ON 66
ci_0068                -3.957857e-03 3 1  ON 67
ci_0069                 3.825555e-03 3 1  ON 68
ci_0070                 3.580888e-03 3 1  ON 69
ci_0071                 4.381191e-03 3 1  ON 70
ci_0072                 4.651021e-03 3 1  ON 71
ci_0073                 3.394270e-03 3 1  ON 72
ci_0074                 3.189408e-03 3 1  ON 73
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 4.1962e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s077 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s077 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=77  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6899e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 77
    time step          = 0.05
    reference energy   = -16.9462
    reference variance = 0.208916
====================================================
  Execution time = 1.4960e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s077
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5250e+04
  VMC Eavg = -1.6904e+01
  VMC Evar = 3.1461e-01
  Total weights = 1.951812665e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 2.6977e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.304156779983
                                         uncertainty =       0.001555683746

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.304156779983
                                         uncertainty =       0.001555683746

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000389925585
  error estimate for blocks of size 2^( 2) =       0.000404590481
  error estimate for blocks of size 2^( 3) =       0.000420032509
  error estimate for blocks of size 2^( 4) =       0.000433940456
  error estimate for blocks of size 2^( 5) =       0.000445458721
  error estimate for blocks of size 2^( 6) =       0.000454480913
  error estimate for blocks of size 2^( 7) =       0.000458813282

      target function =      -0.886528736149
              le_mean =     -16.903528125643
             les_mean =     286.043869793900
             stat err =       0.000448173343
             autocorr =       1.321078357797
   target nu stat err =       0.000448173343
   target dn stat err =       0.002302273794
      target stat err =       0.002973684012
              std dev =       0.551438051021
             le_variance =       0.304083924114


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690352812564e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 74
Check correct_vf_var_size: 225, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 3.7253e+03, overlap shift 3.7253e+04 and omega -1.7527e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.886537569988       residual = 6.85e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.886537578706       residual = 1.22e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.886537580043       residual = 4.22e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.886537580789       residual = 1.55e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.886537581079       residual = 5.30e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.886537581219       residual = 2.18e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.886537581259       residual = 4.97e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.886537581291       residual = 1.97e-06           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.886537581297       residual = 5.96e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.886537581300       residual = 1.29e-07           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.886537581294       residual = 3.34e-08           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.886537581304       residual = 9.72e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         11 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 3.7253e+03 is 5.456738e-08

solving harmonic davidson linear method for identity shift 1.4901e+04, overlap shift 1.4901e+05 and omega -1.7527e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.886537569988       residual = 6.85e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.886537572167       residual = 1.22e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.886537572501       residual = 4.22e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.886537572688       residual = 1.55e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.886537572740       residual = 5.30e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.886537572756       residual = 2.18e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.886537572834       residual = 4.97e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.886537572814       residual = 1.97e-06           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.886537572815       residual = 5.96e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.886537572777       residual = 1.29e-07           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.886537572841       residual = 3.34e-08           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.886537572822       residual = 9.72e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         11 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 1.4901e+04 is 1.364194e-08

solving harmonic davidson linear method for identity shift 5.9605e+04, overlap shift 5.9605e+05 and omega -1.7527e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.886537569988       residual = 6.85e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.886537570533       residual = 1.22e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.886537570616       residual = 4.22e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.886537570668       residual = 1.55e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.886537570739       residual = 5.30e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.886537570653       residual = 2.18e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.886537570578       residual = 4.97e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.886537570742       residual = 1.97e-06           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.886537570735       residual = 5.96e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.886537570780       residual = 1.29e-07           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.886537570794       residual = 3.34e-08           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.886537570797       residual = 9.72e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         11 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 5.9605e+04 is 3.410492e-09

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               1.011927 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 75 and numParams is: 74

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.7667e+01
  </log>
  <optVariables href="H2O.s077.opt.xml">
ci_0001                 7.026295e-01 3 1  ON 0
ci_0002                 6.983279e-01 3 1  ON 1
ci_0003                -3.181714e-02 3 1  ON 2
ci_0004                -3.148893e-02 3 1  ON 3
ci_0005                -2.842208e-02 3 1  ON 4
ci_0006                -2.962389e-02 3 1  ON 5
ci_0007                -1.644653e-02 3 1  ON 6
ci_0008                -1.721876e-02 3 1  ON 7
ci_0009                -1.895890e-02 3 1  ON 8
ci_0010                -1.909748e-02 3 1  ON 9
ci_0011                -1.578363e-02 3 1  ON 10
ci_0012                -1.579244e-02 3 1  ON 11
ci_0013                 1.568463e-02 3 1  ON 12
ci_0014                 1.561331e-02 3 1  ON 13
ci_0015                 1.647823e-02 3 1  ON 14
ci_0016                 1.619587e-02 3 1  ON 15
ci_0017                 1.384675e-02 3 1  ON 16
ci_0018                 1.415259e-02 3 1  ON 17
ci_0019                 1.243860e-02 3 1  ON 18
ci_0020                 1.205185e-02 3 1  ON 19
ci_0021                 1.539481e-02 3 1  ON 20
ci_0022                 1.641552e-02 3 1  ON 21
ci_0023                -1.177805e-02 3 1  ON 22
ci_0024                -1.103742e-02 3 1  ON 23
ci_0025                -2.989092e-03 3 1  ON 24
ci_0026                -2.657154e-03 3 1  ON 25
ci_0027                -1.174738e-02 3 1  ON 26
ci_0028                -1.172150e-02 3 1  ON 27
ci_0029                -1.033865e-02 3 1  ON 28
ci_0030                -1.028743e-02 3 1  ON 29
ci_0031                 1.407066e-02 3 1  ON 30
ci_0032                 1.310031e-02 3 1  ON 31
ci_0033                 8.463078e-03 3 1  ON 32
ci_0034                 8.659781e-03 3 1  ON 33
ci_0035                 5.045302e-03 3 1  ON 34
ci_0036                 4.826552e-03 3 1  ON 35
ci_0037                -1.143339e-02 3 1  ON 36
ci_0038                -1.140348e-02 3 1  ON 37
ci_0039                -3.804142e-03 3 1  ON 38
ci_0040                -3.933543e-03 3 1  ON 39
ci_0041                 9.636301e-03 3 1  ON 40
ci_0042                 9.532968e-03 3 1  ON 41
ci_0043                -6.343120e-03 3 1  ON 42
ci_0044                -6.774487e-03 3 1  ON 43
ci_0045                 1.045935e-02 3 1  ON 44
ci_0046                 9.383503e-03 3 1  ON 45
ci_0047                -3.644296e-03 3 1  ON 46
ci_0048                -3.595089e-03 3 1  ON 47
ci_0049                -2.504359e-03 3 1  ON 48
ci_0050                -2.823121e-03 3 1  ON 49
ci_0051                -1.835874e-03 3 1  ON 50
ci_0052                -1.716036e-03 3 1  ON 51
ci_0053                -4.036083e-03 3 1  ON 52
ci_0054                -3.938136e-03 3 1  ON 53
ci_0055                 2.508127e-03 3 1  ON 54
ci_0056                 2.146649e-03 3 1  ON 55
ci_0057                 2.391283e-03 3 1  ON 56
ci_0058                 3.125220e-03 3 1  ON 57
ci_0059                -4.061058e-03 3 1  ON 58
ci_0060                -3.655082e-03 3 1  ON 59
ci_0061                -2.865943e-03 3 1  ON 60
ci_0062                -3.079661e-03 3 1  ON 61
ci_0063                -9.741533e-03 3 1  ON 62
ci_0064                -9.713260e-03 3 1  ON 63
ci_0065                -7.181087e-03 3 1  ON 64
ci_0066                -6.636030e-03 3 1  ON 65
ci_0067                -3.951506e-03 3 1  ON 66
ci_0068                -3.957855e-03 3 1  ON 67
ci_0069                 3.825553e-03 3 1  ON 68
ci_0070                 3.580886e-03 3 1  ON 69
ci_0071                 4.381188e-03 3 1  ON 70
ci_0072                 4.651015e-03 3 1  ON 71
ci_0073                 3.394266e-03 3 1  ON 72
ci_0074                 3.189406e-03 3 1  ON 73
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 77
    time step          = 0.05
    reference energy   = -16.9056
    reference variance = 0.207372
====================================================
  Execution time = 1.4609e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s077
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6904e+01
  VMC Evar = 3.1676e-01
  Total weights = 1.9518e+06
  Execution time = 1.9464e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.306097715417
                                         uncertainty =       0.002388778094

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.306097715417
                                         uncertainty =       0.002388778094

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000391207160
  error estimate for blocks of size 2^( 2) =       0.000405833308
  error estimate for blocks of size 2^( 3) =       0.000420735379
  error estimate for blocks of size 2^( 4) =       0.000433803620
  error estimate for blocks of size 2^( 5) =       0.000444567260
  error estimate for blocks of size 2^( 6) =       0.000453108671
  error estimate for blocks of size 2^( 7) =       0.000459751949

      target function =      -0.883844326780
              le_mean =     -16.903721920870
             les_mean =     286.052570142671
             stat err =       0.000447807875
             autocorr =       1.310297355072
   target nu stat err =       0.000447807875
   target dn stat err =       0.003299733464
      target stat err =       0.004187523056
              std dev =       0.553250471080
             le_variance =       0.306086083750

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.306097717729
                                         uncertainty =       0.002388778638

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.306097717729
                                         uncertainty =       0.002388778638

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000391207161
  error estimate for blocks of size 2^( 2) =       0.000405833312
  error estimate for blocks of size 2^( 3) =       0.000420735386
  error estimate for blocks of size 2^( 4) =       0.000433803630
  error estimate for blocks of size 2^( 5) =       0.000444567272
  error estimate for blocks of size 2^( 6) =       0.000453108684
  error estimate for blocks of size 2^( 7) =       0.000459751961

      target function =      -0.883844444824
              le_mean =     -16.903721920610
             les_mean =     286.052570039710
             stat err =       0.000447807887
             autocorr =       1.310297412675
   target nu stat err =       0.000447807887
   target dn stat err =       0.003299734804
      target stat err =       0.004187525823
              std dev =       0.553250473161
             le_variance =       0.306086086053

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.306097716573
                                         uncertainty =       0.002388778366

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.306097716573
                                         uncertainty =       0.002388778366

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000391207161
  error estimate for blocks of size 2^( 2) =       0.000405833310
  error estimate for blocks of size 2^( 3) =       0.000420735383
  error estimate for blocks of size 2^( 4) =       0.000433803625
  error estimate for blocks of size 2^( 5) =       0.000444567266
  error estimate for blocks of size 2^( 6) =       0.000453108678
  error estimate for blocks of size 2^( 7) =       0.000459751955

      target function =      -0.883844385839
              le_mean =     -16.903721920740
             les_mean =     286.052570091161
             stat err =       0.000447807881
             autocorr =       1.310297383878
   target nu stat err =       0.000447807881
   target dn stat err =       0.003299734134
      target stat err =       0.004187524439
              std dev =       0.553250472120
             le_variance =       0.306086084901

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.306097715562
                                         uncertainty =       0.002388778128

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.306097715562
                                         uncertainty =       0.002388778128

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000391207160
  error estimate for blocks of size 2^( 2) =       0.000405833308
  error estimate for blocks of size 2^( 3) =       0.000420735379
  error estimate for blocks of size 2^( 4) =       0.000433803621
  error estimate for blocks of size 2^( 5) =       0.000444567261
  error estimate for blocks of size 2^( 6) =       0.000453108672
  error estimate for blocks of size 2^( 7) =       0.000459751949

      target function =      -0.883844334167
              le_mean =     -16.903721920854
             les_mean =     286.052570136229
             stat err =       0.000447807876
             autocorr =       1.310297358678
   target nu stat err =       0.000447807876
   target dn stat err =       0.003299733548
      target stat err =       0.004187523229
              std dev =       0.553250471210
             le_variance =       0.306086083894


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.883844326780        initial
     3.7253e+03     3.7253e+04             5.4567e-08        -0.883844444824  <--
     1.4901e+04     1.4901e+05             1.3642e-08        -0.883844385839
     5.9605e+04     5.9605e+05             3.4105e-09        -0.883844334167

*****************************************************************************
Applying the update for shift_i =   3.7253e+03     and shift_s =   3.7253e+04
*****************************************************************************

  Execution time = 2.4456e+01
  </log>
  <optVariables href="H2O.s077.opt.xml">
ci_0001                 7.026295e-01 3 1  ON 0
ci_0002                 6.983279e-01 3 1  ON 1
ci_0003                -3.181712e-02 3 1  ON 2
ci_0004                -3.148893e-02 3 1  ON 3
ci_0005                -2.842205e-02 3 1  ON 4
ci_0006                -2.962386e-02 3 1  ON 5
ci_0007                -1.644650e-02 3 1  ON 6
ci_0008                -1.721872e-02 3 1  ON 7
ci_0009                -1.895889e-02 3 1  ON 8
ci_0010                -1.909747e-02 3 1  ON 9
ci_0011                -1.578363e-02 3 1  ON 10
ci_0012                -1.579242e-02 3 1  ON 11
ci_0013                 1.568462e-02 3 1  ON 12
ci_0014                 1.561330e-02 3 1  ON 13
ci_0015                 1.647821e-02 3 1  ON 14
ci_0016                 1.619586e-02 3 1  ON 15
ci_0017                 1.384674e-02 3 1  ON 16
ci_0018                 1.415259e-02 3 1  ON 17
ci_0019                 1.243860e-02 3 1  ON 18
ci_0020                 1.205185e-02 3 1  ON 19
ci_0021                 1.539482e-02 3 1  ON 20
ci_0022                 1.641551e-02 3 1  ON 21
ci_0023                -1.177805e-02 3 1  ON 22
ci_0024                -1.103742e-02 3 1  ON 23
ci_0025                -2.989055e-03 3 1  ON 24
ci_0026                -2.657149e-03 3 1  ON 25
ci_0027                -1.174736e-02 3 1  ON 26
ci_0028                -1.172147e-02 3 1  ON 27
ci_0029                -1.033865e-02 3 1  ON 28
ci_0030                -1.028741e-02 3 1  ON 29
ci_0031                 1.407065e-02 3 1  ON 30
ci_0032                 1.310030e-02 3 1  ON 31
ci_0033                 8.463080e-03 3 1  ON 32
ci_0034                 8.659769e-03 3 1  ON 33
ci_0035                 5.045291e-03 3 1  ON 34
ci_0036                 4.826554e-03 3 1  ON 35
ci_0037                -1.143339e-02 3 1  ON 36
ci_0038                -1.140350e-02 3 1  ON 37
ci_0039                -3.804136e-03 3 1  ON 38
ci_0040                -3.933536e-03 3 1  ON 39
ci_0041                 9.636303e-03 3 1  ON 40
ci_0042                 9.532966e-03 3 1  ON 41
ci_0043                -6.343100e-03 3 1  ON 42
ci_0044                -6.774469e-03 3 1  ON 43
ci_0045                 1.045934e-02 3 1  ON 44
ci_0046                 9.383494e-03 3 1  ON 45
ci_0047                -3.644290e-03 3 1  ON 46
ci_0048                -3.595082e-03 3 1  ON 47
ci_0049                -2.504363e-03 3 1  ON 48
ci_0050                -2.823117e-03 3 1  ON 49
ci_0051                -1.835877e-03 3 1  ON 50
ci_0052                -1.716024e-03 3 1  ON 51
ci_0053                -4.036077e-03 3 1  ON 52
ci_0054                -3.938128e-03 3 1  ON 53
ci_0055                 2.508113e-03 3 1  ON 54
ci_0056                 2.146658e-03 3 1  ON 55
ci_0057                 2.391287e-03 3 1  ON 56
ci_0058                 3.125228e-03 3 1  ON 57
ci_0059                -4.061047e-03 3 1  ON 58
ci_0060                -3.655090e-03 3 1  ON 59
ci_0061                -2.865943e-03 3 1  ON 60
ci_0062                -3.079665e-03 3 1  ON 61
ci_0063                -9.741532e-03 3 1  ON 62
ci_0064                -9.713256e-03 3 1  ON 63
ci_0065                -7.181086e-03 3 1  ON 64
ci_0066                -6.636035e-03 3 1  ON 65
ci_0067                -3.951501e-03 3 1  ON 66
ci_0068                -3.957848e-03 3 1  ON 67
ci_0069                 3.825547e-03 3 1  ON 68
ci_0070                 3.580881e-03 3 1  ON 69
ci_0071                 4.381182e-03 3 1  ON 70
ci_0072                 4.650995e-03 3 1  ON 71
ci_0073                 3.394252e-03 3 1  ON 72
ci_0074                 3.189403e-03 3 1  ON 73
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 4.2136e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s078 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s078 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=78  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6899e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 78
    time step          = 0.05
    reference energy   = -16.8883
    reference variance = 0.222751
====================================================
  Execution time = 1.4850e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s078
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5232e+04
  VMC Eavg = -1.6903e+01
  VMC Evar = 3.2005e-01
  Total weights = 1.951932828e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 2.6840e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.306324079917
                                         uncertainty =       0.003325538039

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.306324079917
                                         uncertainty =       0.003325538039

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000391302215
  error estimate for blocks of size 2^( 2) =       0.000405741679
  error estimate for blocks of size 2^( 3) =       0.000421013737
  error estimate for blocks of size 2^( 4) =       0.000434909308
  error estimate for blocks of size 2^( 5) =       0.000447319824
  error estimate for blocks of size 2^( 6) =       0.000455795572
  error estimate for blocks of size 2^( 7) =       0.000461237359

      target function =      -0.879580066365
              le_mean =     -16.902874916658
             les_mean =     286.027234109939
             stat err =       0.000449815516
             autocorr =       1.321430270957
   target nu stat err =       0.000449815516
   target dn stat err =       0.005338647898
      target stat err =       0.006653608517
              std dev =       0.553384899005
             le_variance =       0.306234846446


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690287491666e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 74
Check correct_vf_var_size: 225, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 9.3132e+02, overlap shift 9.3132e+03 and omega -1.7527e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.879629538645       residual = 4.00e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.879629705955       residual = 2.53e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.879629720029       residual = 4.35e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.879629723759       residual = 2.07e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.879629724207       residual = 1.18e-04           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.879629725008       residual = 4.30e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.879629725316       residual = 1.43e-05           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.879629725426       residual = 6.16e-06           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.879629725375       residual = 8.47e-06           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.879629725367       residual = 6.56e-06           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.879629725359       residual = 4.30e-06           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.879629725407       residual = 2.17e-06           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.879629725483       residual = 1.29e-06           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.879629725545       residual = 2.32e-07           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.879629725560       residual = 7.12e-08           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.879629725564       residual = 1.93e-08           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.879629725563       residual = 4.35e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         16 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 9.3132e+02 is 3.333289e-07

solving harmonic davidson linear method for identity shift 3.7253e+03, overlap shift 3.7253e+04 and omega -1.7527e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.879629538645       residual = 4.00e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.879629580475       residual = 2.53e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.879629583994       residual = 4.35e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.879629584926       residual = 2.07e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.879629585035       residual = 1.18e-04           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.879629585236       residual = 4.30e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.879629585323       residual = 1.43e-05           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.879629585344       residual = 6.16e-06           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.879629585332       residual = 8.47e-06           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.879629585321       residual = 6.56e-06           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.879629585326       residual = 4.30e-06           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.879629585350       residual = 2.17e-06           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.879629585355       residual = 1.29e-06           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.879629585370       residual = 2.32e-07           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.879629585389       residual = 7.12e-08           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.879629585379       residual = 1.93e-08           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.879629585382       residual = 4.34e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         16 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 3.7253e+03 is 8.333724e-08

solving harmonic davidson linear method for identity shift 1.4901e+04, overlap shift 1.4901e+05 and omega -1.7527e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.879629538645       residual = 4.00e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.879629549103       residual = 2.53e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.879629549983       residual = 4.35e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.879629550217       residual = 2.07e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.879629550223       residual = 1.18e-04           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.879629550275       residual = 4.30e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.879629550321       residual = 1.43e-05           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.879629550312       residual = 6.16e-06           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.879629550316       residual = 8.47e-06           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.879629550316       residual = 6.56e-06           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.879629550339       residual = 4.30e-06           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.879629550351       residual = 2.17e-06           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.879629550334       residual = 1.29e-06           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.879629550352       residual = 2.32e-07           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.879629550311       residual = 7.12e-08           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.879629550361       residual = 1.93e-08           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.879629550334       residual = 4.34e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         16 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 1.4901e+04 is 2.083462e-08

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               1.020877 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 75 and numParams is: 74

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.7549e+01
  </log>
  <optVariables href="H2O.s078.opt.xml">
ci_0001                 7.026294e-01 3 1  ON 0
ci_0002                 6.983279e-01 3 1  ON 1
ci_0003                -3.181709e-02 3 1  ON 2
ci_0004                -3.148891e-02 3 1  ON 3
ci_0005                -2.842200e-02 3 1  ON 4
ci_0006                -2.962382e-02 3 1  ON 5
ci_0007                -1.644648e-02 3 1  ON 6
ci_0008                -1.721868e-02 3 1  ON 7
ci_0009                -1.895884e-02 3 1  ON 8
ci_0010                -1.909747e-02 3 1  ON 9
ci_0011                -1.578360e-02 3 1  ON 10
ci_0012                -1.579242e-02 3 1  ON 11
ci_0013                 1.568459e-02 3 1  ON 12
ci_0014                 1.561327e-02 3 1  ON 13
ci_0015                 1.647819e-02 3 1  ON 14
ci_0016                 1.619585e-02 3 1  ON 15
ci_0017                 1.384673e-02 3 1  ON 16
ci_0018                 1.415258e-02 3 1  ON 17
ci_0019                 1.243860e-02 3 1  ON 18
ci_0020                 1.205184e-02 3 1  ON 19
ci_0021                 1.539477e-02 3 1  ON 20
ci_0022                 1.641555e-02 3 1  ON 21
ci_0023                -1.177805e-02 3 1  ON 22
ci_0024                -1.103742e-02 3 1  ON 23
ci_0025                -2.988972e-03 3 1  ON 24
ci_0026                -2.657117e-03 3 1  ON 25
ci_0027                -1.174738e-02 3 1  ON 26
ci_0028                -1.172146e-02 3 1  ON 27
ci_0029                -1.033864e-02 3 1  ON 28
ci_0030                -1.028741e-02 3 1  ON 29
ci_0031                 1.407064e-02 3 1  ON 30
ci_0032                 1.310031e-02 3 1  ON 31
ci_0033                 8.463065e-03 3 1  ON 32
ci_0034                 8.659787e-03 3 1  ON 33
ci_0035                 5.045217e-03 3 1  ON 34
ci_0036                 4.826526e-03 3 1  ON 35
ci_0037                -1.143339e-02 3 1  ON 36
ci_0038                -1.140349e-02 3 1  ON 37
ci_0039                -3.804134e-03 3 1  ON 38
ci_0040                -3.933521e-03 3 1  ON 39
ci_0041                 9.636292e-03 3 1  ON 40
ci_0042                 9.532961e-03 3 1  ON 41
ci_0043                -6.343082e-03 3 1  ON 42
ci_0044                -6.774484e-03 3 1  ON 43
ci_0045                 1.045932e-02 3 1  ON 44
ci_0046                 9.383492e-03 3 1  ON 45
ci_0047                -3.644279e-03 3 1  ON 46
ci_0048                -3.595073e-03 3 1  ON 47
ci_0049                -2.504368e-03 3 1  ON 48
ci_0050                -2.823144e-03 3 1  ON 49
ci_0051                -1.835875e-03 3 1  ON 50
ci_0052                -1.716023e-03 3 1  ON 51
ci_0053                -4.036044e-03 3 1  ON 52
ci_0054                -3.938112e-03 3 1  ON 53
ci_0055                 2.508081e-03 3 1  ON 54
ci_0056                 2.146700e-03 3 1  ON 55
ci_0057                 2.391311e-03 3 1  ON 56
ci_0058                 3.125191e-03 3 1  ON 57
ci_0059                -4.061000e-03 3 1  ON 58
ci_0060                -3.655098e-03 3 1  ON 59
ci_0061                -2.865967e-03 3 1  ON 60
ci_0062                -3.079671e-03 3 1  ON 61
ci_0063                -9.741525e-03 3 1  ON 62
ci_0064                -9.713255e-03 3 1  ON 63
ci_0065                -7.181080e-03 3 1  ON 64
ci_0066                -6.636023e-03 3 1  ON 65
ci_0067                -3.951483e-03 3 1  ON 66
ci_0068                -3.957844e-03 3 1  ON 67
ci_0069                 3.825544e-03 3 1  ON 68
ci_0070                 3.580858e-03 3 1  ON 69
ci_0071                 4.381162e-03 3 1  ON 70
ci_0072                 4.650979e-03 3 1  ON 71
ci_0073                 3.394178e-03 3 1  ON 72
ci_0074                 3.189406e-03 3 1  ON 73
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 78
    time step          = 0.05
    reference energy   = -16.8802
    reference variance = 0.338192
====================================================
  Execution time = 1.4504e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s078
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6902e+01
  VMC Evar = 3.1942e-01
  Total weights = 1.9517e+06
  Execution time = 1.9448e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.306715757048
                                         uncertainty =       0.002373154227

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.306715757048
                                         uncertainty =       0.002373154227

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000391612178
  error estimate for blocks of size 2^( 2) =       0.000406236829
  error estimate for blocks of size 2^( 3) =       0.000421413836
  error estimate for blocks of size 2^( 4) =       0.000435716051
  error estimate for blocks of size 2^( 5) =       0.000447559878
  error estimate for blocks of size 2^( 6) =       0.000456676141
  error estimate for blocks of size 2^( 7) =       0.000464630548

      target function =      -0.880340846275
              le_mean =     -16.902423985011
             les_mean =     286.011355393045
             stat err =       0.000451145655
             autocorr =       1.327153572048
   target nu stat err =       0.000451145655
   target dn stat err =       0.002938861329
      target stat err =       0.003704637430
              std dev =       0.553823253150
             le_variance =       0.306720195730

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.306715709430
                                         uncertainty =       0.002373150064

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.306715709430
                                         uncertainty =       0.002373150064

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000391612147
  error estimate for blocks of size 2^( 2) =       0.000406236817
  error estimate for blocks of size 2^( 3) =       0.000421413835
  error estimate for blocks of size 2^( 4) =       0.000435716058
  error estimate for blocks of size 2^( 5) =       0.000447559893
  error estimate for blocks of size 2^( 6) =       0.000456676155
  error estimate for blocks of size 2^( 7) =       0.000464630552

      target function =      -0.880340631769
              le_mean =     -16.902423985160
             les_mean =     286.011355570808
             stat err =       0.000451145665
             autocorr =       1.327153837119
   target nu stat err =       0.000451145665
   target dn stat err =       0.002938863746
      target stat err =       0.003704638612
              std dev =       0.553823209977
             le_variance =       0.306720147909

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.306715733234
                                         uncertainty =       0.002373152145

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.306715733234
                                         uncertainty =       0.002373152145

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000391612163
  error estimate for blocks of size 2^( 2) =       0.000406236823
  error estimate for blocks of size 2^( 3) =       0.000421413835
  error estimate for blocks of size 2^( 4) =       0.000435716055
  error estimate for blocks of size 2^( 5) =       0.000447559886
  error estimate for blocks of size 2^( 6) =       0.000456676148
  error estimate for blocks of size 2^( 7) =       0.000464630550

      target function =      -0.880340739190
              le_mean =     -16.902423985085
             les_mean =     286.011355481777
             stat err =       0.000451145660
             autocorr =       1.327153704583
   target nu stat err =       0.000451145660
   target dn stat err =       0.002938862533
      target stat err =       0.003704638017
              std dev =       0.553823231559
             le_variance =       0.306720171814

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.306715754071
                                         uncertainty =       0.002373153967

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.306715754071
                                         uncertainty =       0.002373153967

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000391612176
  error estimate for blocks of size 2^( 2) =       0.000406236828
  error estimate for blocks of size 2^( 3) =       0.000421413836
  error estimate for blocks of size 2^( 4) =       0.000435716052
  error estimate for blocks of size 2^( 5) =       0.000447559879
  error estimate for blocks of size 2^( 6) =       0.000456676141
  error estimate for blocks of size 2^( 7) =       0.000464630548

      target function =      -0.880340832909
              le_mean =     -16.902423985020
             les_mean =     286.011355404120
             stat err =       0.000451145655
             autocorr =       1.327153588619
   target nu stat err =       0.000451145655
   target dn stat err =       0.002938861479
      target stat err =       0.003704637503
              std dev =       0.553823250451
             le_variance =       0.306720192740


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.880340846275        initial  <--
     9.3132e+02     9.3132e+03             3.3333e-07        -0.880340631769
     3.7253e+03     3.7253e+04             8.3337e-08        -0.880340739190
     1.4901e+04     1.4901e+05             2.0835e-08        -0.880340832909

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 24.3211
  </log>
  <optVariables href="H2O.s078.opt.xml">
ci_0001                 7.026295e-01 3 1  ON 0
ci_0002                 6.983279e-01 3 1  ON 1
ci_0003                -3.181712e-02 3 1  ON 2
ci_0004                -3.148893e-02 3 1  ON 3
ci_0005                -2.842205e-02 3 1  ON 4
ci_0006                -2.962386e-02 3 1  ON 5
ci_0007                -1.644650e-02 3 1  ON 6
ci_0008                -1.721872e-02 3 1  ON 7
ci_0009                -1.895889e-02 3 1  ON 8
ci_0010                -1.909747e-02 3 1  ON 9
ci_0011                -1.578363e-02 3 1  ON 10
ci_0012                -1.579242e-02 3 1  ON 11
ci_0013                 1.568462e-02 3 1  ON 12
ci_0014                 1.561330e-02 3 1  ON 13
ci_0015                 1.647821e-02 3 1  ON 14
ci_0016                 1.619586e-02 3 1  ON 15
ci_0017                 1.384674e-02 3 1  ON 16
ci_0018                 1.415259e-02 3 1  ON 17
ci_0019                 1.243860e-02 3 1  ON 18
ci_0020                 1.205185e-02 3 1  ON 19
ci_0021                 1.539482e-02 3 1  ON 20
ci_0022                 1.641551e-02 3 1  ON 21
ci_0023                -1.177805e-02 3 1  ON 22
ci_0024                -1.103742e-02 3 1  ON 23
ci_0025                -2.989055e-03 3 1  ON 24
ci_0026                -2.657149e-03 3 1  ON 25
ci_0027                -1.174736e-02 3 1  ON 26
ci_0028                -1.172147e-02 3 1  ON 27
ci_0029                -1.033865e-02 3 1  ON 28
ci_0030                -1.028741e-02 3 1  ON 29
ci_0031                 1.407065e-02 3 1  ON 30
ci_0032                 1.310030e-02 3 1  ON 31
ci_0033                 8.463080e-03 3 1  ON 32
ci_0034                 8.659769e-03 3 1  ON 33
ci_0035                 5.045291e-03 3 1  ON 34
ci_0036                 4.826554e-03 3 1  ON 35
ci_0037                -1.143339e-02 3 1  ON 36
ci_0038                -1.140350e-02 3 1  ON 37
ci_0039                -3.804136e-03 3 1  ON 38
ci_0040                -3.933536e-03 3 1  ON 39
ci_0041                 9.636303e-03 3 1  ON 40
ci_0042                 9.532966e-03 3 1  ON 41
ci_0043                -6.343100e-03 3 1  ON 42
ci_0044                -6.774469e-03 3 1  ON 43
ci_0045                 1.045934e-02 3 1  ON 44
ci_0046                 9.383494e-03 3 1  ON 45
ci_0047                -3.644290e-03 3 1  ON 46
ci_0048                -3.595082e-03 3 1  ON 47
ci_0049                -2.504363e-03 3 1  ON 48
ci_0050                -2.823117e-03 3 1  ON 49
ci_0051                -1.835877e-03 3 1  ON 50
ci_0052                -1.716024e-03 3 1  ON 51
ci_0053                -4.036077e-03 3 1  ON 52
ci_0054                -3.938128e-03 3 1  ON 53
ci_0055                 2.508113e-03 3 1  ON 54
ci_0056                 2.146658e-03 3 1  ON 55
ci_0057                 2.391287e-03 3 1  ON 56
ci_0058                 3.125228e-03 3 1  ON 57
ci_0059                -4.061047e-03 3 1  ON 58
ci_0060                -3.655090e-03 3 1  ON 59
ci_0061                -2.865943e-03 3 1  ON 60
ci_0062                -3.079665e-03 3 1  ON 61
ci_0063                -9.741532e-03 3 1  ON 62
ci_0064                -9.713256e-03 3 1  ON 63
ci_0065                -7.181086e-03 3 1  ON 64
ci_0066                -6.636035e-03 3 1  ON 65
ci_0067                -3.951501e-03 3 1  ON 66
ci_0068                -3.957848e-03 3 1  ON 67
ci_0069                 3.825547e-03 3 1  ON 68
ci_0070                 3.580881e-03 3 1  ON 69
ci_0071                 4.381182e-03 3 1  ON 70
ci_0072                 4.650995e-03 3 1  ON 71
ci_0073                 3.394252e-03 3 1  ON 72
ci_0074                 3.189403e-03 3 1  ON 73
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 4.1876e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s079 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s079 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=79  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6899e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 79
    time step          = 0.05
    reference energy   = -16.9145
    reference variance = 0.152139
====================================================
  Execution time = 1.4840e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s079
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5255e+04
  VMC Eavg = -1.6903e+01
  VMC Evar = 3.1908e-01
  Total weights = 1.951828375e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 2.6917e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.306553836580
                                         uncertainty =       0.001990599317

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.306553836580
                                         uncertainty =       0.001990599317

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000391594302
  error estimate for blocks of size 2^( 2) =       0.000406951148
  error estimate for blocks of size 2^( 3) =       0.000422392913
  error estimate for blocks of size 2^( 4) =       0.000436329801
  error estimate for blocks of size 2^( 5) =       0.000448352360
  error estimate for blocks of size 2^( 6) =       0.000458070620
  error estimate for blocks of size 2^( 7) =       0.000464547540

      target function =      -0.880837721449
              le_mean =     -16.902950131458
             les_mean =     286.028799093735
             stat err =       0.000451825080
             autocorr =       1.331275499981
   target nu stat err =       0.000451825080
   target dn stat err =       0.003193137441
      target stat err =       0.004024111912
              std dev =       0.553797973497
             le_variance =       0.306692195449


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690295013146e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 74
Check correct_vf_var_size: 225, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 9.3132e+03, overlap shift 9.3132e+04 and omega -1.7527e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.880854741257       residual = 1.77e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.880854748424       residual = 2.62e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.880854749805       residual = 6.96e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.880854750400       residual = 2.42e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.880854750643       residual = 1.28e-04           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.880854750781       residual = 9.81e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.880854750851       residual = 6.61e-05           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.880854750896       residual = 4.06e-05           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.880854750945       residual = 4.07e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.880854751001       residual = 2.20e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.880854751022       residual = 6.78e-06           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.880854751083       residual = 3.20e-06           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.880854751005       residual = 6.47e-07           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.880854750999       residual = 1.67e-07           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.880854751027       residual = 3.57e-08           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.880854751049       residual = 1.26e-08           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.880854751046       residual = 2.64e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         16 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 9.3132e+03 is 5.266805e-08

solving harmonic davidson linear method for identity shift 3.7253e+04, overlap shift 3.7253e+05 and omega -1.7527e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.880854741257       residual = 1.77e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.880854743049       residual = 2.62e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.880854743394       residual = 6.96e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.880854743543       residual = 2.42e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.880854743589       residual = 1.28e-04           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.880854743659       residual = 9.81e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.880854743644       residual = 6.61e-05           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.880854743685       residual = 4.06e-05           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.880854743672       residual = 4.07e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.880854743708       residual = 2.20e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.880854743614       residual = 6.78e-06           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.880854743705       residual = 3.20e-06           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.880854743748       residual = 6.47e-07           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.880854743664       residual = 1.67e-07           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.880854743652       residual = 3.57e-08           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.880854743669       residual = 1.26e-08           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.880854743682       residual = 2.64e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         16 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 3.7253e+04 is 1.316702e-08

solving harmonic davidson linear method for identity shift 1.4901e+05, overlap shift 1.4901e+06 and omega -1.7527e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.880854741257       residual = 1.77e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.880854741705       residual = 2.62e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.880854741792       residual = 6.96e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.880854741815       residual = 2.42e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.880854741833       residual = 1.28e-04           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.880854741921       residual = 9.81e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.880854741844       residual = 6.61e-05           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.880854741969       residual = 4.06e-05           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.880854741864       residual = 4.07e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.880854741922       residual = 2.20e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.880854741493       residual = 6.78e-06           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.880854741814       residual = 3.20e-06           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.880854741831       residual = 6.47e-07           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.880854742292       residual = 1.67e-07           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.880854742252       residual = 3.57e-08           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.880854741773       residual = 1.26e-08           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.880854741739       residual = 2.64e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         16 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 1.4901e+05 is 3.291754e-09

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               1.029801 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 75 and numParams is: 74

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.7546e+01
  </log>
  <optVariables href="H2O.s079.opt.xml">
ci_0001                 7.026295e-01 3 1  ON 0
ci_0002                 6.983279e-01 3 1  ON 1
ci_0003                -3.181711e-02 3 1  ON 2
ci_0004                -3.148893e-02 3 1  ON 3
ci_0005                -2.842204e-02 3 1  ON 4
ci_0006                -2.962385e-02 3 1  ON 5
ci_0007                -1.644650e-02 3 1  ON 6
ci_0008                -1.721872e-02 3 1  ON 7
ci_0009                -1.895889e-02 3 1  ON 8
ci_0010                -1.909747e-02 3 1  ON 9
ci_0011                -1.578363e-02 3 1  ON 10
ci_0012                -1.579242e-02 3 1  ON 11
ci_0013                 1.568462e-02 3 1  ON 12
ci_0014                 1.561330e-02 3 1  ON 13
ci_0015                 1.647821e-02 3 1  ON 14
ci_0016                 1.619586e-02 3 1  ON 15
ci_0017                 1.384674e-02 3 1  ON 16
ci_0018                 1.415258e-02 3 1  ON 17
ci_0019                 1.243860e-02 3 1  ON 18
ci_0020                 1.205185e-02 3 1  ON 19
ci_0021                 1.539482e-02 3 1  ON 20
ci_0022                 1.641551e-02 3 1  ON 21
ci_0023                -1.177805e-02 3 1  ON 22
ci_0024                -1.103742e-02 3 1  ON 23
ci_0025                -2.989054e-03 3 1  ON 24
ci_0026                -2.657149e-03 3 1  ON 25
ci_0027                -1.174736e-02 3 1  ON 26
ci_0028                -1.172147e-02 3 1  ON 27
ci_0029                -1.033865e-02 3 1  ON 28
ci_0030                -1.028741e-02 3 1  ON 29
ci_0031                 1.407065e-02 3 1  ON 30
ci_0032                 1.310030e-02 3 1  ON 31
ci_0033                 8.463079e-03 3 1  ON 32
ci_0034                 8.659769e-03 3 1  ON 33
ci_0035                 5.045291e-03 3 1  ON 34
ci_0036                 4.826545e-03 3 1  ON 35
ci_0037                -1.143339e-02 3 1  ON 36
ci_0038                -1.140350e-02 3 1  ON 37
ci_0039                -3.804135e-03 3 1  ON 38
ci_0040                -3.933536e-03 3 1  ON 39
ci_0041                 9.636304e-03 3 1  ON 40
ci_0042                 9.532965e-03 3 1  ON 41
ci_0043                -6.343100e-03 3 1  ON 42
ci_0044                -6.774467e-03 3 1  ON 43
ci_0045                 1.045934e-02 3 1  ON 44
ci_0046                 9.383494e-03 3 1  ON 45
ci_0047                -3.644289e-03 3 1  ON 46
ci_0048                -3.595081e-03 3 1  ON 47
ci_0049                -2.504364e-03 3 1  ON 48
ci_0050                -2.823117e-03 3 1  ON 49
ci_0051                -1.835873e-03 3 1  ON 50
ci_0052                -1.716025e-03 3 1  ON 51
ci_0053                -4.036076e-03 3 1  ON 52
ci_0054                -3.938131e-03 3 1  ON 53
ci_0055                 2.508113e-03 3 1  ON 54
ci_0056                 2.146657e-03 3 1  ON 55
ci_0057                 2.391288e-03 3 1  ON 56
ci_0058                 3.125226e-03 3 1  ON 57
ci_0059                -4.061048e-03 3 1  ON 58
ci_0060                -3.655088e-03 3 1  ON 59
ci_0061                -2.865944e-03 3 1  ON 60
ci_0062                -3.079664e-03 3 1  ON 61
ci_0063                -9.741531e-03 3 1  ON 62
ci_0064                -9.713254e-03 3 1  ON 63
ci_0065                -7.181086e-03 3 1  ON 64
ci_0066                -6.636035e-03 3 1  ON 65
ci_0067                -3.951501e-03 3 1  ON 66
ci_0068                -3.957846e-03 3 1  ON 67
ci_0069                 3.825547e-03 3 1  ON 68
ci_0070                 3.580882e-03 3 1  ON 69
ci_0071                 4.381180e-03 3 1  ON 70
ci_0072                 4.650997e-03 3 1  ON 71
ci_0073                 3.394252e-03 3 1  ON 72
ci_0074                 3.189405e-03 3 1  ON 73
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 79
    time step          = 0.05
    reference energy   = -16.8202
    reference variance = 0.243222
====================================================
  Execution time = 1.4604e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s079
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6903e+01
  VMC Evar = 3.1671e-01
  Total weights = 1.9517e+06
  Execution time = 1.9464e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.304751422271
                                         uncertainty =       0.002144545708

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.304751422271
                                         uncertainty =       0.002144545708

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000390353202
  error estimate for blocks of size 2^( 2) =       0.000404635505
  error estimate for blocks of size 2^( 3) =       0.000419159602
  error estimate for blocks of size 2^( 4) =       0.000432074495
  error estimate for blocks of size 2^( 5) =       0.000443813797
  error estimate for blocks of size 2^( 6) =       0.000451357694
  error estimate for blocks of size 2^( 7) =       0.000457449167

      target function =      -0.883865086384
              le_mean =     -16.903491492293
             les_mean =     286.044738915667
             stat err =       0.000446173788
             autocorr =       1.306449458454
   target nu stat err =       0.000446173788
   target dn stat err =       0.003077644212
      target stat err =       0.003910749265
              std dev =       0.552042792726
             le_variance =       0.304751245001

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.304751422140
                                         uncertainty =       0.002144546240

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.304751422140
                                         uncertainty =       0.002144546240

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000390353202
  error estimate for blocks of size 2^( 2) =       0.000404635506
  error estimate for blocks of size 2^( 3) =       0.000419159604
  error estimate for blocks of size 2^( 4) =       0.000432074498
  error estimate for blocks of size 2^( 5) =       0.000443813801
  error estimate for blocks of size 2^( 6) =       0.000451357698
  error estimate for blocks of size 2^( 7) =       0.000457449171

      target function =      -0.883864402217
              le_mean =     -16.903491492435
             les_mean =     286.044739465912
             stat err =       0.000446173792
             autocorr =       1.306449480681
   target nu stat err =       0.000446173792
   target dn stat err =       0.003077667842
      target stat err =       0.003910772533
              std dev =       0.552042792484
             le_variance =       0.304751244733

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.304751422205
                                         uncertainty =       0.002144545974

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.304751422205
                                         uncertainty =       0.002144545974

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000390353202
  error estimate for blocks of size 2^( 2) =       0.000404635505
  error estimate for blocks of size 2^( 3) =       0.000419159603
  error estimate for blocks of size 2^( 4) =       0.000432074497
  error estimate for blocks of size 2^( 5) =       0.000443813799
  error estimate for blocks of size 2^( 6) =       0.000451357696
  error estimate for blocks of size 2^( 7) =       0.000457449169

      target function =      -0.883864744755
              le_mean =     -16.903491492364
             les_mean =     286.044739190427
             stat err =       0.000446173790
             autocorr =       1.306449469559
   target nu stat err =       0.000446173790
   target dn stat err =       0.003077656000
      target stat err =       0.003910760870
              std dev =       0.552042792605
             le_variance =       0.304751244867

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.304751422263
                                         uncertainty =       0.002144545741

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.304751422263
                                         uncertainty =       0.002144545741

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000390353202
  error estimate for blocks of size 2^( 2) =       0.000404635505
  error estimate for blocks of size 2^( 3) =       0.000419159602
  error estimate for blocks of size 2^( 4) =       0.000432074496
  error estimate for blocks of size 2^( 5) =       0.000443813797
  error estimate for blocks of size 2^( 6) =       0.000451357695
  error estimate for blocks of size 2^( 7) =       0.000457449167

      target function =      -0.883865043730
              le_mean =     -16.903491492302
             les_mean =     286.044738949973
             stat err =       0.000446173789
             autocorr =       1.306449459844
   target nu stat err =       0.000446173789
   target dn stat err =       0.003077645683
      target stat err =       0.003910750713
              std dev =       0.552042792711
             le_variance =       0.304751244984


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.883865086384        initial  <--
     9.3132e+03     9.3132e+04             5.2668e-08        -0.883864402217
     3.7253e+04     3.7253e+05             1.3167e-08        -0.883864744755
     1.4901e+05     1.4901e+06             3.2918e-09        -0.883865043730

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 24.4420
  </log>
  <optVariables href="H2O.s079.opt.xml">
ci_0001                 7.026295e-01 3 1  ON 0
ci_0002                 6.983279e-01 3 1  ON 1
ci_0003                -3.181712e-02 3 1  ON 2
ci_0004                -3.148893e-02 3 1  ON 3
ci_0005                -2.842205e-02 3 1  ON 4
ci_0006                -2.962386e-02 3 1  ON 5
ci_0007                -1.644650e-02 3 1  ON 6
ci_0008                -1.721872e-02 3 1  ON 7
ci_0009                -1.895889e-02 3 1  ON 8
ci_0010                -1.909747e-02 3 1  ON 9
ci_0011                -1.578363e-02 3 1  ON 10
ci_0012                -1.579242e-02 3 1  ON 11
ci_0013                 1.568462e-02 3 1  ON 12
ci_0014                 1.561330e-02 3 1  ON 13
ci_0015                 1.647821e-02 3 1  ON 14
ci_0016                 1.619586e-02 3 1  ON 15
ci_0017                 1.384674e-02 3 1  ON 16
ci_0018                 1.415259e-02 3 1  ON 17
ci_0019                 1.243860e-02 3 1  ON 18
ci_0020                 1.205185e-02 3 1  ON 19
ci_0021                 1.539482e-02 3 1  ON 20
ci_0022                 1.641551e-02 3 1  ON 21
ci_0023                -1.177805e-02 3 1  ON 22
ci_0024                -1.103742e-02 3 1  ON 23
ci_0025                -2.989055e-03 3 1  ON 24
ci_0026                -2.657149e-03 3 1  ON 25
ci_0027                -1.174736e-02 3 1  ON 26
ci_0028                -1.172147e-02 3 1  ON 27
ci_0029                -1.033865e-02 3 1  ON 28
ci_0030                -1.028741e-02 3 1  ON 29
ci_0031                 1.407065e-02 3 1  ON 30
ci_0032                 1.310030e-02 3 1  ON 31
ci_0033                 8.463080e-03 3 1  ON 32
ci_0034                 8.659769e-03 3 1  ON 33
ci_0035                 5.045291e-03 3 1  ON 34
ci_0036                 4.826554e-03 3 1  ON 35
ci_0037                -1.143339e-02 3 1  ON 36
ci_0038                -1.140350e-02 3 1  ON 37
ci_0039                -3.804136e-03 3 1  ON 38
ci_0040                -3.933536e-03 3 1  ON 39
ci_0041                 9.636303e-03 3 1  ON 40
ci_0042                 9.532966e-03 3 1  ON 41
ci_0043                -6.343100e-03 3 1  ON 42
ci_0044                -6.774469e-03 3 1  ON 43
ci_0045                 1.045934e-02 3 1  ON 44
ci_0046                 9.383494e-03 3 1  ON 45
ci_0047                -3.644290e-03 3 1  ON 46
ci_0048                -3.595082e-03 3 1  ON 47
ci_0049                -2.504363e-03 3 1  ON 48
ci_0050                -2.823117e-03 3 1  ON 49
ci_0051                -1.835877e-03 3 1  ON 50
ci_0052                -1.716024e-03 3 1  ON 51
ci_0053                -4.036077e-03 3 1  ON 52
ci_0054                -3.938128e-03 3 1  ON 53
ci_0055                 2.508113e-03 3 1  ON 54
ci_0056                 2.146658e-03 3 1  ON 55
ci_0057                 2.391287e-03 3 1  ON 56
ci_0058                 3.125228e-03 3 1  ON 57
ci_0059                -4.061047e-03 3 1  ON 58
ci_0060                -3.655090e-03 3 1  ON 59
ci_0061                -2.865943e-03 3 1  ON 60
ci_0062                -3.079665e-03 3 1  ON 61
ci_0063                -9.741532e-03 3 1  ON 62
ci_0064                -9.713256e-03 3 1  ON 63
ci_0065                -7.181086e-03 3 1  ON 64
ci_0066                -6.636035e-03 3 1  ON 65
ci_0067                -3.951501e-03 3 1  ON 66
ci_0068                -3.957848e-03 3 1  ON 67
ci_0069                 3.825547e-03 3 1  ON 68
ci_0070                 3.580881e-03 3 1  ON 69
ci_0071                 4.381182e-03 3 1  ON 70
ci_0072                 4.650995e-03 3 1  ON 71
ci_0073                 3.394252e-03 3 1  ON 72
ci_0074                 3.189403e-03 3 1  ON 73
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 4.1994e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s080 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s080 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=80  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6899e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 80
    time step          = 0.05
    reference energy   = -16.9057
    reference variance = 0.309452
====================================================
  Execution time = 1.5090e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s080
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5222e+04
  VMC Eavg = -1.6904e+01
  VMC Evar = 3.1491e-01
  Total weights = 1.951449676e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 2.6710e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.305006107045
                                         uncertainty =       0.001895779810

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.305006107045
                                         uncertainty =       0.001895779810

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000390548234
  error estimate for blocks of size 2^( 2) =       0.000404650253
  error estimate for blocks of size 2^( 3) =       0.000419327515
  error estimate for blocks of size 2^( 4) =       0.000432366095
  error estimate for blocks of size 2^( 5) =       0.000443676499
  error estimate for blocks of size 2^( 6) =       0.000450680679
  error estimate for blocks of size 2^( 7) =       0.000459006796

      target function =      -0.886176250125
              le_mean =     -16.903755815662
             les_mean =     286.051873238202
             stat err =       0.000446432517
             autocorr =       1.306659056320
   target nu stat err =       0.000446432517
   target dn stat err =       0.002345947084
      target stat err =       0.003025754925
              std dev =       0.552318609921
             le_variance =       0.305055846865


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690375581566e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 74
Check correct_vf_var_size: 225, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 9.3132e+04, overlap shift 9.3132e+05 and omega -1.7527e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.886185534747       residual = 7.73e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.886185535118       residual = 1.40e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.886185535203       residual = 5.24e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.886185535257       residual = 1.68e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.886185535321       residual = 5.85e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.886185535305       residual = 2.86e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.886185535420       residual = 7.40e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.886185535306       residual = 2.65e-06           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.886185535204       residual = 7.32e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.886185535165       residual = 2.31e-07           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.886185535473       residual = 7.24e-08           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.886185535205       residual = 3.57e-08           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.886185534855       residual = 3.63e-08           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.886185535423       residual = 3.03e-08           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.886185535236       residual = 2.03e-08           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.886185535077       residual = 5.40e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         15 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 9.3132e+04 is 2.050759e-09

solving harmonic davidson linear method for identity shift 3.7253e+05, overlap shift 3.7253e+06 and omega -1.7527e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.886185534747       residual = 7.73e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.886185534840       residual = 1.40e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.886185534861       residual = 5.24e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.886185534869       residual = 1.68e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.886185534969       residual = 5.85e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.886185534788       residual = 2.86e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.886185534374       residual = 7.40e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.886185534666       residual = 2.65e-06           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.886185535132       residual = 7.32e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.886185535469       residual = 2.31e-07           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.886185534701       residual = 7.24e-08           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.886185534461       residual = 3.57e-08           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.886185534960       residual = 3.63e-08           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.886185534970       residual = 3.03e-08           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.886185534836       residual = 2.03e-08           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.886185534928       residual = 5.40e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         15 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 3.7253e+05 is 5.126899e-10

solving harmonic davidson linear method for identity shift 1.4901e+06, overlap shift 1.4901e+07 and omega -1.7527e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.886185534747       residual = 7.73e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.886185534770       residual = 1.40e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.886185534776       residual = 5.24e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.886185534778       residual = 1.68e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.886185535802       residual = 5.85e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.886185534701       residual = 2.86e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.886185538576       residual = 7.40e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.886185532730       residual = 2.65e-06           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.886185535578       residual = 7.32e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.886185531995       residual = 2.31e-07           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.886185531030       residual = 7.24e-08           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.886185535860       residual = 3.57e-08           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.886185536938       residual = 3.63e-08           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.886185535262       residual = 3.02e-08           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.886185531807       residual = 2.03e-08           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.886185533713       residual = 5.40e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         15 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 1.4901e+06 is 1.281725e-10

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               1.037757 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 75 and numParams is: 74

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.7774e+01
  </log>
  <optVariables href="H2O.s080.opt.xml">
ci_0001                 7.026295e-01 3 1  ON 0
ci_0002                 6.983279e-01 3 1  ON 1
ci_0003                -3.181712e-02 3 1  ON 2
ci_0004                -3.148893e-02 3 1  ON 3
ci_0005                -2.842205e-02 3 1  ON 4
ci_0006                -2.962386e-02 3 1  ON 5
ci_0007                -1.644650e-02 3 1  ON 6
ci_0008                -1.721872e-02 3 1  ON 7
ci_0009                -1.895889e-02 3 1  ON 8
ci_0010                -1.909747e-02 3 1  ON 9
ci_0011                -1.578363e-02 3 1  ON 10
ci_0012                -1.579242e-02 3 1  ON 11
ci_0013                 1.568462e-02 3 1  ON 12
ci_0014                 1.561330e-02 3 1  ON 13
ci_0015                 1.647821e-02 3 1  ON 14
ci_0016                 1.619586e-02 3 1  ON 15
ci_0017                 1.384674e-02 3 1  ON 16
ci_0018                 1.415259e-02 3 1  ON 17
ci_0019                 1.243860e-02 3 1  ON 18
ci_0020                 1.205185e-02 3 1  ON 19
ci_0021                 1.539482e-02 3 1  ON 20
ci_0022                 1.641551e-02 3 1  ON 21
ci_0023                -1.177805e-02 3 1  ON 22
ci_0024                -1.103742e-02 3 1  ON 23
ci_0025                -2.989055e-03 3 1  ON 24
ci_0026                -2.657149e-03 3 1  ON 25
ci_0027                -1.174736e-02 3 1  ON 26
ci_0028                -1.172147e-02 3 1  ON 27
ci_0029                -1.033865e-02 3 1  ON 28
ci_0030                -1.028741e-02 3 1  ON 29
ci_0031                 1.407065e-02 3 1  ON 30
ci_0032                 1.310030e-02 3 1  ON 31
ci_0033                 8.463080e-03 3 1  ON 32
ci_0034                 8.659770e-03 3 1  ON 33
ci_0035                 5.045291e-03 3 1  ON 34
ci_0036                 4.826554e-03 3 1  ON 35
ci_0037                -1.143339e-02 3 1  ON 36
ci_0038                -1.140350e-02 3 1  ON 37
ci_0039                -3.804136e-03 3 1  ON 38
ci_0040                -3.933536e-03 3 1  ON 39
ci_0041                 9.636303e-03 3 1  ON 40
ci_0042                 9.532966e-03 3 1  ON 41
ci_0043                -6.343100e-03 3 1  ON 42
ci_0044                -6.774469e-03 3 1  ON 43
ci_0045                 1.045934e-02 3 1  ON 44
ci_0046                 9.383494e-03 3 1  ON 45
ci_0047                -3.644290e-03 3 1  ON 46
ci_0048                -3.595082e-03 3 1  ON 47
ci_0049                -2.504363e-03 3 1  ON 48
ci_0050                -2.823117e-03 3 1  ON 49
ci_0051                -1.835877e-03 3 1  ON 50
ci_0052                -1.716024e-03 3 1  ON 51
ci_0053                -4.036077e-03 3 1  ON 52
ci_0054                -3.938128e-03 3 1  ON 53
ci_0055                 2.508113e-03 3 1  ON 54
ci_0056                 2.146657e-03 3 1  ON 55
ci_0057                 2.391287e-03 3 1  ON 56
ci_0058                 3.125228e-03 3 1  ON 57
ci_0059                -4.061047e-03 3 1  ON 58
ci_0060                -3.655090e-03 3 1  ON 59
ci_0061                -2.865943e-03 3 1  ON 60
ci_0062                -3.079665e-03 3 1  ON 61
ci_0063                -9.741532e-03 3 1  ON 62
ci_0064                -9.713256e-03 3 1  ON 63
ci_0065                -7.181086e-03 3 1  ON 64
ci_0066                -6.636035e-03 3 1  ON 65
ci_0067                -3.951501e-03 3 1  ON 66
ci_0068                -3.957848e-03 3 1  ON 67
ci_0069                 3.825547e-03 3 1  ON 68
ci_0070                 3.580881e-03 3 1  ON 69
ci_0071                 4.381181e-03 3 1  ON 70
ci_0072                 4.650995e-03 3 1  ON 71
ci_0073                 3.394252e-03 3 1  ON 72
ci_0074                 3.189403e-03 3 1  ON 73
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 80
    time step          = 0.05
    reference energy   = -16.8559
    reference variance = 0.543517
====================================================
  Execution time = 1.4324e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s080
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6903e+01
  VMC Evar = 3.1694e-01
  Total weights = 1.9517e+06
  Execution time = 1.9471e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.304858670542
                                         uncertainty =       0.002991128224

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.304858670542
                                         uncertainty =       0.002991128224

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000390437020
  error estimate for blocks of size 2^( 2) =       0.000404847325
  error estimate for blocks of size 2^( 3) =       0.000419271554
  error estimate for blocks of size 2^( 4) =       0.000432591127
  error estimate for blocks of size 2^( 5) =       0.000443228811
  error estimate for blocks of size 2^( 6) =       0.000450995211
  error estimate for blocks of size 2^( 7) =       0.000456702605

      target function =      -0.883531254913
              le_mean =     -16.903185875737
             les_mean =     286.034635194433
             stat err =       0.000445879438
             autocorr =       1.304166116291
   target nu stat err =       0.000445879438
   target dn stat err =       0.003425428316
      target stat err =       0.004336260448
              std dev =       0.552161328787
             le_variance =       0.304882133008

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.304858670217
                                         uncertainty =       0.002991128267

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.304858670217
                                         uncertainty =       0.002991128267

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000390437020
  error estimate for blocks of size 2^( 2) =       0.000404847325
  error estimate for blocks of size 2^( 3) =       0.000419271554
  error estimate for blocks of size 2^( 4) =       0.000432591127
  error estimate for blocks of size 2^( 5) =       0.000443228811
  error estimate for blocks of size 2^( 6) =       0.000450995212
  error estimate for blocks of size 2^( 7) =       0.000456702605

      target function =      -0.883531253971
              le_mean =     -16.903185875743
             les_mean =     286.034635195403
             stat err =       0.000445879439
             autocorr =       1.304166119132
   target nu stat err =       0.000445879439
   target dn stat err =       0.003425428452
      target stat err =       0.004336260607
              std dev =       0.552161328493
             le_variance =       0.304882132684

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.304858670380
                                         uncertainty =       0.002991128246

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.304858670380
                                         uncertainty =       0.002991128246

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000390437020
  error estimate for blocks of size 2^( 2) =       0.000404847325
  error estimate for blocks of size 2^( 3) =       0.000419271554
  error estimate for blocks of size 2^( 4) =       0.000432591127
  error estimate for blocks of size 2^( 5) =       0.000443228811
  error estimate for blocks of size 2^( 6) =       0.000450995212
  error estimate for blocks of size 2^( 7) =       0.000456702605

      target function =      -0.883531254442
              le_mean =     -16.903185875740
             les_mean =     286.034635194918
             stat err =       0.000445879439
             autocorr =       1.304166117698
   target nu stat err =       0.000445879439
   target dn stat err =       0.003425428384
      target stat err =       0.004336260527
              std dev =       0.552161328640
             le_variance =       0.304882132846

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.304858670522
                                         uncertainty =       0.002991128227

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.304858670522
                                         uncertainty =       0.002991128227

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000390437020
  error estimate for blocks of size 2^( 2) =       0.000404847325
  error estimate for blocks of size 2^( 3) =       0.000419271554
  error estimate for blocks of size 2^( 4) =       0.000432591127
  error estimate for blocks of size 2^( 5) =       0.000443228811
  error estimate for blocks of size 2^( 6) =       0.000450995211
  error estimate for blocks of size 2^( 7) =       0.000456702605

      target function =      -0.883531254854
              le_mean =     -16.903185875737
             les_mean =     286.034635194494
             stat err =       0.000445879439
             autocorr =       1.304166116467
   target nu stat err =       0.000445879439
   target dn stat err =       0.003425428325
      target stat err =       0.004336260458
              std dev =       0.552161328769
             le_variance =       0.304882132988


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.883531254913        initial  <--
     9.3132e+04     9.3132e+05             2.0508e-09        -0.883531253971
     3.7253e+05     3.7253e+06             5.1269e-10        -0.883531254442
     1.4901e+06     1.4901e+07             1.2817e-10        -0.883531254854

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 28.2316
  </log>
  <optVariables href="H2O.s080.opt.xml">
ci_0001                 7.026295e-01 3 1  ON 0
ci_0002                 6.983279e-01 3 1  ON 1
ci_0003                -3.181712e-02 3 1  ON 2
ci_0004                -3.148893e-02 3 1  ON 3
ci_0005                -2.842205e-02 3 1  ON 4
ci_0006                -2.962386e-02 3 1  ON 5
ci_0007                -1.644650e-02 3 1  ON 6
ci_0008                -1.721872e-02 3 1  ON 7
ci_0009                -1.895889e-02 3 1  ON 8
ci_0010                -1.909747e-02 3 1  ON 9
ci_0011                -1.578363e-02 3 1  ON 10
ci_0012                -1.579242e-02 3 1  ON 11
ci_0013                 1.568462e-02 3 1  ON 12
ci_0014                 1.561330e-02 3 1  ON 13
ci_0015                 1.647821e-02 3 1  ON 14
ci_0016                 1.619586e-02 3 1  ON 15
ci_0017                 1.384674e-02 3 1  ON 16
ci_0018                 1.415259e-02 3 1  ON 17
ci_0019                 1.243860e-02 3 1  ON 18
ci_0020                 1.205185e-02 3 1  ON 19
ci_0021                 1.539482e-02 3 1  ON 20
ci_0022                 1.641551e-02 3 1  ON 21
ci_0023                -1.177805e-02 3 1  ON 22
ci_0024                -1.103742e-02 3 1  ON 23
ci_0025                -2.989055e-03 3 1  ON 24
ci_0026                -2.657149e-03 3 1  ON 25
ci_0027                -1.174736e-02 3 1  ON 26
ci_0028                -1.172147e-02 3 1  ON 27
ci_0029                -1.033865e-02 3 1  ON 28
ci_0030                -1.028741e-02 3 1  ON 29
ci_0031                 1.407065e-02 3 1  ON 30
ci_0032                 1.310030e-02 3 1  ON 31
ci_0033                 8.463080e-03 3 1  ON 32
ci_0034                 8.659769e-03 3 1  ON 33
ci_0035                 5.045291e-03 3 1  ON 34
ci_0036                 4.826554e-03 3 1  ON 35
ci_0037                -1.143339e-02 3 1  ON 36
ci_0038                -1.140350e-02 3 1  ON 37
ci_0039                -3.804136e-03 3 1  ON 38
ci_0040                -3.933536e-03 3 1  ON 39
ci_0041                 9.636303e-03 3 1  ON 40
ci_0042                 9.532966e-03 3 1  ON 41
ci_0043                -6.343100e-03 3 1  ON 42
ci_0044                -6.774469e-03 3 1  ON 43
ci_0045                 1.045934e-02 3 1  ON 44
ci_0046                 9.383494e-03 3 1  ON 45
ci_0047                -3.644290e-03 3 1  ON 46
ci_0048                -3.595082e-03 3 1  ON 47
ci_0049                -2.504363e-03 3 1  ON 48
ci_0050                -2.823117e-03 3 1  ON 49
ci_0051                -1.835877e-03 3 1  ON 50
ci_0052                -1.716024e-03 3 1  ON 51
ci_0053                -4.036077e-03 3 1  ON 52
ci_0054                -3.938128e-03 3 1  ON 53
ci_0055                 2.508113e-03 3 1  ON 54
ci_0056                 2.146658e-03 3 1  ON 55
ci_0057                 2.391287e-03 3 1  ON 56
ci_0058                 3.125228e-03 3 1  ON 57
ci_0059                -4.061047e-03 3 1  ON 58
ci_0060                -3.655090e-03 3 1  ON 59
ci_0061                -2.865943e-03 3 1  ON 60
ci_0062                -3.079665e-03 3 1  ON 61
ci_0063                -9.741532e-03 3 1  ON 62
ci_0064                -9.713256e-03 3 1  ON 63
ci_0065                -7.181086e-03 3 1  ON 64
ci_0066                -6.636035e-03 3 1  ON 65
ci_0067                -3.951501e-03 3 1  ON 66
ci_0068                -3.957848e-03 3 1  ON 67
ci_0069                 3.825547e-03 3 1  ON 68
ci_0070                 3.580881e-03 3 1  ON 69
ci_0071                 4.381182e-03 3 1  ON 70
ci_0072                 4.650995e-03 3 1  ON 71
ci_0073                 3.394252e-03 3 1  ON 72
ci_0074                 3.189403e-03 3 1  ON 73
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 4.6015e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s081 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s081 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=81  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6899e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 81
    time step          = 0.05
    reference energy   = -16.89
    reference variance = 0.160463
====================================================
  Execution time = 1.4832e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s081
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5240e+04
  VMC Eavg = -1.6904e+01
  VMC Evar = 3.1905e-01
  Total weights = 1.951799231e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 2.7120e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.306350454516
                                         uncertainty =       0.002924197347

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.306350454516
                                         uncertainty =       0.002924197347

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000391449913
  error estimate for blocks of size 2^( 2) =       0.000405878817
  error estimate for blocks of size 2^( 3) =       0.000420540723
  error estimate for blocks of size 2^( 4) =       0.000433147437
  error estimate for blocks of size 2^( 5) =       0.000444466209
  error estimate for blocks of size 2^( 6) =       0.000451023292
  error estimate for blocks of size 2^( 7) =       0.000455435542

      target function =      -0.880944042407
              le_mean =     -16.903605872906
             les_mean =     286.050945904861
             stat err =       0.000446018120
             autocorr =       1.298232877813
   target nu stat err =       0.000446018120
   target dn stat err =       0.004070065836
      target stat err =       0.005110026536
              std dev =       0.553593775977
             le_variance =       0.306466068800


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690360587291e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 74
Check correct_vf_var_size: 225, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 9.3132e+05, overlap shift 9.3132e+06 and omega -1.7527e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.880972434191       residual = 2.64e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.880972434277       residual = 2.96e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.880972434293       residual = 9.91e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.880972434300       residual = 4.48e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.880972434251       residual = 2.44e-04           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.880972435099       residual = 1.54e-04           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.880972434900       residual = 7.93e-05           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.880972433517       residual = 4.75e-05           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.880972432895       residual = 5.73e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.880972432102       residual = 2.75e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.880972434419       residual = 1.09e-05           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.880972434900       residual = 3.27e-06           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.880972436184       residual = 1.02e-06           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.880972430946       residual = 1.63e-07           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.880972432608       residual = 4.79e-08           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.880972435343       residual = 1.43e-08           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.880972433512       residual = 3.48e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         16 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 9.3132e+05 is 6.019327e-10

solving harmonic davidson linear method for identity shift 3.7253e+06, overlap shift 3.7253e+07 and omega -1.7527e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.880972434191       residual = 2.64e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.880972434213       residual = 2.96e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.880972434217       residual = 9.91e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.880972434219       residual = 4.48e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.880972434205       residual = 2.44e-04           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.880972436843       residual = 1.54e-04           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.880972434276       residual = 7.93e-05           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.880972425097       residual = 4.75e-05           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.880972431395       residual = 5.73e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.880972436357       residual = 2.75e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.880972433967       residual = 1.09e-05           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.880972434577       residual = 3.27e-06           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.880972444527       residual = 1.02e-06           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.880972429778       residual = 1.63e-07           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.880972431071       residual = 4.79e-08           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.880972427473       residual = 1.43e-08           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.880972435128       residual = 3.48e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         16 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 3.7253e+06 is 1.504832e-10

solving harmonic davidson linear method for identity shift 1.4901e+07, overlap shift 1.4901e+08 and omega -1.7527e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.880972434191       residual = 2.64e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.880972434196       residual = 2.96e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.880972434197       residual = 9.91e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.880972434198       residual = 4.48e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.880972434109       residual = 2.44e-04           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.880972434970       residual = 1.54e-04           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.880972432962       residual = 7.93e-05           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.880972439877       residual = 4.75e-05           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.880972433042       residual = 5.73e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.880972410217       residual = 2.75e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.880972440201       residual = 1.09e-05           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.880972428951       residual = 3.27e-06           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.880972435107       residual = 1.02e-06           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.880972452093       residual = 1.63e-07           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.880972383658       residual = 4.79e-08           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.880972409801       residual = 1.43e-08           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.880972413462       residual = 3.48e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         16 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 1.4901e+07 is 3.762068e-11

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               1.051947 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 75 and numParams is: 74

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.7568e+01
  </log>
  <optVariables href="H2O.s081.opt.xml">
ci_0001                 7.026295e-01 3 1  ON 0
ci_0002                 6.983279e-01 3 1  ON 1
ci_0003                -3.181712e-02 3 1  ON 2
ci_0004                -3.148893e-02 3 1  ON 3
ci_0005                -2.842205e-02 3 1  ON 4
ci_0006                -2.962386e-02 3 1  ON 5
ci_0007                -1.644650e-02 3 1  ON 6
ci_0008                -1.721872e-02 3 1  ON 7
ci_0009                -1.895889e-02 3 1  ON 8
ci_0010                -1.909747e-02 3 1  ON 9
ci_0011                -1.578363e-02 3 1  ON 10
ci_0012                -1.579242e-02 3 1  ON 11
ci_0013                 1.568462e-02 3 1  ON 12
ci_0014                 1.561330e-02 3 1  ON 13
ci_0015                 1.647821e-02 3 1  ON 14
ci_0016                 1.619586e-02 3 1  ON 15
ci_0017                 1.384674e-02 3 1  ON 16
ci_0018                 1.415259e-02 3 1  ON 17
ci_0019                 1.243860e-02 3 1  ON 18
ci_0020                 1.205185e-02 3 1  ON 19
ci_0021                 1.539482e-02 3 1  ON 20
ci_0022                 1.641551e-02 3 1  ON 21
ci_0023                -1.177805e-02 3 1  ON 22
ci_0024                -1.103742e-02 3 1  ON 23
ci_0025                -2.989055e-03 3 1  ON 24
ci_0026                -2.657149e-03 3 1  ON 25
ci_0027                -1.174736e-02 3 1  ON 26
ci_0028                -1.172147e-02 3 1  ON 27
ci_0029                -1.033865e-02 3 1  ON 28
ci_0030                -1.028741e-02 3 1  ON 29
ci_0031                 1.407065e-02 3 1  ON 30
ci_0032                 1.310030e-02 3 1  ON 31
ci_0033                 8.463080e-03 3 1  ON 32
ci_0034                 8.659769e-03 3 1  ON 33
ci_0035                 5.045291e-03 3 1  ON 34
ci_0036                 4.826554e-03 3 1  ON 35
ci_0037                -1.143339e-02 3 1  ON 36
ci_0038                -1.140350e-02 3 1  ON 37
ci_0039                -3.804136e-03 3 1  ON 38
ci_0040                -3.933536e-03 3 1  ON 39
ci_0041                 9.636303e-03 3 1  ON 40
ci_0042                 9.532966e-03 3 1  ON 41
ci_0043                -6.343100e-03 3 1  ON 42
ci_0044                -6.774469e-03 3 1  ON 43
ci_0045                 1.045934e-02 3 1  ON 44
ci_0046                 9.383494e-03 3 1  ON 45
ci_0047                -3.644290e-03 3 1  ON 46
ci_0048                -3.595082e-03 3 1  ON 47
ci_0049                -2.504363e-03 3 1  ON 48
ci_0050                -2.823117e-03 3 1  ON 49
ci_0051                -1.835877e-03 3 1  ON 50
ci_0052                -1.716024e-03 3 1  ON 51
ci_0053                -4.036077e-03 3 1  ON 52
ci_0054                -3.938128e-03 3 1  ON 53
ci_0055                 2.508113e-03 3 1  ON 54
ci_0056                 2.146658e-03 3 1  ON 55
ci_0057                 2.391287e-03 3 1  ON 56
ci_0058                 3.125228e-03 3 1  ON 57
ci_0059                -4.061047e-03 3 1  ON 58
ci_0060                -3.655090e-03 3 1  ON 59
ci_0061                -2.865943e-03 3 1  ON 60
ci_0062                -3.079665e-03 3 1  ON 61
ci_0063                -9.741532e-03 3 1  ON 62
ci_0064                -9.713256e-03 3 1  ON 63
ci_0065                -7.181086e-03 3 1  ON 64
ci_0066                -6.636035e-03 3 1  ON 65
ci_0067                -3.951501e-03 3 1  ON 66
ci_0068                -3.957848e-03 3 1  ON 67
ci_0069                 3.825547e-03 3 1  ON 68
ci_0070                 3.580881e-03 3 1  ON 69
ci_0071                 4.381182e-03 3 1  ON 70
ci_0072                 4.650995e-03 3 1  ON 71
ci_0073                 3.394252e-03 3 1  ON 72
ci_0074                 3.189403e-03 3 1  ON 73
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 81
    time step          = 0.05
    reference energy   = -16.9876
    reference variance = 1.15221
====================================================
  Execution time = 1.4356e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s081
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6902e+01
  VMC Evar = 3.1694e-01
  Total weights = 1.9519e+06
  Execution time = 1.9607e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.304709763562
                                         uncertainty =       0.001923900713

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.304709763562
                                         uncertainty =       0.001923900713

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000390341500
  error estimate for blocks of size 2^( 2) =       0.000404973850
  error estimate for blocks of size 2^( 3) =       0.000420336094
  error estimate for blocks of size 2^( 4) =       0.000433607447
  error estimate for blocks of size 2^( 5) =       0.000445967998
  error estimate for blocks of size 2^( 6) =       0.000453245612
  error estimate for blocks of size 2^( 7) =       0.000457518257

      target function =      -0.883420121920
              le_mean =     -16.902391074400
             les_mean =     286.007763117673
             stat err =       0.000447584828
             autocorr =       1.314804737055
   target nu stat err =       0.000447584828
   target dn stat err =       0.003464449692
      target stat err =       0.004378290845
              std dev =       0.552026243544
             le_variance =       0.304732973561

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.304709763550
                                         uncertainty =       0.001923900718

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.304709763550
                                         uncertainty =       0.001923900718

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000390341500
  error estimate for blocks of size 2^( 2) =       0.000404973850
  error estimate for blocks of size 2^( 3) =       0.000420336094
  error estimate for blocks of size 2^( 4) =       0.000433607447
  error estimate for blocks of size 2^( 5) =       0.000445967998
  error estimate for blocks of size 2^( 6) =       0.000453245612
  error estimate for blocks of size 2^( 7) =       0.000457518257

      target function =      -0.883420122112
              le_mean =     -16.902391074397
             les_mean =     286.007763117406
             stat err =       0.000447584828
             autocorr =       1.314804737203
   target nu stat err =       0.000447584828
   target dn stat err =       0.003464449704
      target stat err =       0.004378290861
              std dev =       0.552026243533
             le_variance =       0.304732973550

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.304709763556
                                         uncertainty =       0.001923900716

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.304709763556
                                         uncertainty =       0.001923900716

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000390341500
  error estimate for blocks of size 2^( 2) =       0.000404973850
  error estimate for blocks of size 2^( 3) =       0.000420336094
  error estimate for blocks of size 2^( 4) =       0.000433607447
  error estimate for blocks of size 2^( 5) =       0.000445967998
  error estimate for blocks of size 2^( 6) =       0.000453245612
  error estimate for blocks of size 2^( 7) =       0.000457518257

      target function =      -0.883420122016
              le_mean =     -16.902391074398
             les_mean =     286.007763117540
             stat err =       0.000447584828
             autocorr =       1.314804737134
   target nu stat err =       0.000447584828
   target dn stat err =       0.003464449698
      target stat err =       0.004378290853
              std dev =       0.552026243539
             le_variance =       0.304732973555

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.304709763562
                                         uncertainty =       0.001923900713

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.304709763562
                                         uncertainty =       0.001923900713

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000390341500
  error estimate for blocks of size 2^( 2) =       0.000404973850
  error estimate for blocks of size 2^( 3) =       0.000420336094
  error estimate for blocks of size 2^( 4) =       0.000433607447
  error estimate for blocks of size 2^( 5) =       0.000445967998
  error estimate for blocks of size 2^( 6) =       0.000453245612
  error estimate for blocks of size 2^( 7) =       0.000457518257

      target function =      -0.883420121932
              le_mean =     -16.902391074400
             les_mean =     286.007763117657
             stat err =       0.000447584828
             autocorr =       1.314804737062
   target nu stat err =       0.000447584828
   target dn stat err =       0.003464449693
      target stat err =       0.004378290846
              std dev =       0.552026243543
             le_variance =       0.304732973561


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.883420121920        initial
     9.3132e+05     9.3132e+06             6.0193e-10        -0.883420122112  <--
     3.7253e+06     3.7253e+07             1.5048e-10        -0.883420122016
     1.4901e+07     1.4901e+08             3.7621e-11        -0.883420121932

*****************************************************************************
Applying the update for shift_i =   9.3132e+05     and shift_s =   9.3132e+06
*****************************************************************************

  Execution time = 2.4244e+01
  </log>
  <optVariables href="H2O.s081.opt.xml">
ci_0001                 7.026295e-01 3 1  ON 0
ci_0002                 6.983279e-01 3 1  ON 1
ci_0003                -3.181712e-02 3 1  ON 2
ci_0004                -3.148893e-02 3 1  ON 3
ci_0005                -2.842205e-02 3 1  ON 4
ci_0006                -2.962386e-02 3 1  ON 5
ci_0007                -1.644650e-02 3 1  ON 6
ci_0008                -1.721872e-02 3 1  ON 7
ci_0009                -1.895889e-02 3 1  ON 8
ci_0010                -1.909747e-02 3 1  ON 9
ci_0011                -1.578363e-02 3 1  ON 10
ci_0012                -1.579242e-02 3 1  ON 11
ci_0013                 1.568462e-02 3 1  ON 12
ci_0014                 1.561330e-02 3 1  ON 13
ci_0015                 1.647821e-02 3 1  ON 14
ci_0016                 1.619586e-02 3 1  ON 15
ci_0017                 1.384674e-02 3 1  ON 16
ci_0018                 1.415259e-02 3 1  ON 17
ci_0019                 1.243860e-02 3 1  ON 18
ci_0020                 1.205185e-02 3 1  ON 19
ci_0021                 1.539482e-02 3 1  ON 20
ci_0022                 1.641551e-02 3 1  ON 21
ci_0023                -1.177805e-02 3 1  ON 22
ci_0024                -1.103742e-02 3 1  ON 23
ci_0025                -2.989055e-03 3 1  ON 24
ci_0026                -2.657149e-03 3 1  ON 25
ci_0027                -1.174736e-02 3 1  ON 26
ci_0028                -1.172147e-02 3 1  ON 27
ci_0029                -1.033865e-02 3 1  ON 28
ci_0030                -1.028741e-02 3 1  ON 29
ci_0031                 1.407065e-02 3 1  ON 30
ci_0032                 1.310030e-02 3 1  ON 31
ci_0033                 8.463080e-03 3 1  ON 32
ci_0034                 8.659769e-03 3 1  ON 33
ci_0035                 5.045291e-03 3 1  ON 34
ci_0036                 4.826554e-03 3 1  ON 35
ci_0037                -1.143339e-02 3 1  ON 36
ci_0038                -1.140350e-02 3 1  ON 37
ci_0039                -3.804136e-03 3 1  ON 38
ci_0040                -3.933536e-03 3 1  ON 39
ci_0041                 9.636303e-03 3 1  ON 40
ci_0042                 9.532966e-03 3 1  ON 41
ci_0043                -6.343100e-03 3 1  ON 42
ci_0044                -6.774469e-03 3 1  ON 43
ci_0045                 1.045934e-02 3 1  ON 44
ci_0046                 9.383494e-03 3 1  ON 45
ci_0047                -3.644290e-03 3 1  ON 46
ci_0048                -3.595082e-03 3 1  ON 47
ci_0049                -2.504363e-03 3 1  ON 48
ci_0050                -2.823117e-03 3 1  ON 49
ci_0051                -1.835877e-03 3 1  ON 50
ci_0052                -1.716024e-03 3 1  ON 51
ci_0053                -4.036077e-03 3 1  ON 52
ci_0054                -3.938128e-03 3 1  ON 53
ci_0055                 2.508113e-03 3 1  ON 54
ci_0056                 2.146658e-03 3 1  ON 55
ci_0057                 2.391287e-03 3 1  ON 56
ci_0058                 3.125228e-03 3 1  ON 57
ci_0059                -4.061047e-03 3 1  ON 58
ci_0060                -3.655089e-03 3 1  ON 59
ci_0061                -2.865943e-03 3 1  ON 60
ci_0062                -3.079665e-03 3 1  ON 61
ci_0063                -9.741532e-03 3 1  ON 62
ci_0064                -9.713256e-03 3 1  ON 63
ci_0065                -7.181086e-03 3 1  ON 64
ci_0066                -6.636035e-03 3 1  ON 65
ci_0067                -3.951501e-03 3 1  ON 66
ci_0068                -3.957848e-03 3 1  ON 67
ci_0069                 3.825547e-03 3 1  ON 68
ci_0070                 3.580881e-03 3 1  ON 69
ci_0071                 4.381182e-03 3 1  ON 70
ci_0072                 4.650995e-03 3 1  ON 71
ci_0073                 3.394252e-03 3 1  ON 72
ci_0074                 3.189403e-03 3 1  ON 73
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 4.1826e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s082 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s082 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=82  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6899e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 82
    time step          = 0.05
    reference energy   = -16.9446
    reference variance = 0.489689
====================================================
  Execution time = 1.4731e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s082
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5281e+04
  VMC Eavg = -1.6902e+01
  VMC Evar = 3.1685e-01
  Total weights = 1.951805199e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 2.6818e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.303919665523
                                         uncertainty =       0.001731070868

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.303919665523
                                         uncertainty =       0.001731070868

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000389804309
  error estimate for blocks of size 2^( 2) =       0.000404489829
  error estimate for blocks of size 2^( 3) =       0.000419404852
  error estimate for blocks of size 2^( 4) =       0.000433051971
  error estimate for blocks of size 2^( 5) =       0.000445768333
  error estimate for blocks of size 2^( 6) =       0.000455302276
  error estimate for blocks of size 2^( 7) =       0.000461963464

      target function =      -0.883522856510
              le_mean =     -16.902352181734
             les_mean =     286.006363415524
             stat err =       0.000449021511
             autocorr =       1.326908641660
   target nu stat err =       0.000449021511
   target dn stat err =       0.003286343976
      target stat err =       0.004159039876
              std dev =       0.551266541018
             le_variance =       0.303894799246


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690235218173e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 74
Check correct_vf_var_size: 225, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.3283e+05, overlap shift 2.3283e+06 and omega -1.7527e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.883541281714       residual = 4.81e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.883541282401       residual = 1.59e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.883541282441       residual = 3.94e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.883541282456       residual = 2.05e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.883541282130       residual = 8.63e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.883541282478       residual = 3.20e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.883541282167       residual = 9.31e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.883541282797       residual = 6.48e-06           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.883541282346       residual = 8.99e-06           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.883541282292       residual = 5.59e-06           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.883541282717       residual = 4.27e-06           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.883541282856       residual = 1.57e-06           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.883541282979       residual = 8.25e-07           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.883541282451       residual = 1.91e-07           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.883541282408       residual = 4.93e-08           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.883541282324       residual = 1.31e-08           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.883541282133       residual = 3.00e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         16 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 2.3283e+05 is 1.995673e-09

solving harmonic davidson linear method for identity shift 9.3132e+05, overlap shift 9.3132e+06 and omega -1.7527e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.883541281714       residual = 4.81e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.883541281886       residual = 1.59e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.883541281896       residual = 3.94e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.883541281900       residual = 2.05e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.883541281896       residual = 8.63e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.883541282054       residual = 3.20e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.883541280549       residual = 9.31e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.883541282400       residual = 6.48e-06           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.883541284175       residual = 8.99e-06           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.883541281946       residual = 5.59e-06           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.883541281686       residual = 4.27e-06           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.883541279838       residual = 1.57e-06           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.883541281897       residual = 8.25e-07           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.883541280900       residual = 1.91e-07           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.883541281398       residual = 4.93e-08           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.883541279725       residual = 1.31e-08           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.883541279864       residual = 3.00e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         16 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 9.3132e+05 is 4.989183e-10

solving harmonic davidson linear method for identity shift 3.7253e+06, overlap shift 3.7253e+07 and omega -1.7527e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.883541281714       residual = 4.81e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.883541281757       residual = 1.59e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.883541281760       residual = 3.94e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.883541281769       residual = 2.05e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.883541280720       residual = 8.63e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.883541283492       residual = 3.20e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.883541282532       residual = 9.31e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.883541284274       residual = 6.48e-06           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.883541284065       residual = 8.99e-06           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.883541284033       residual = 5.59e-06           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.883541287115       residual = 4.27e-06           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.883541279762       residual = 1.57e-06           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.883541284636       residual = 8.25e-07           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.883541280973       residual = 1.91e-07           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.883541281458       residual = 4.93e-08           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.883541279345       residual = 1.31e-08           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.883541267801       residual = 3.00e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         16 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 3.7253e+06 is 1.247296e-10

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               1.066158 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 75 and numParams is: 74

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.7436e+01
  </log>
  <optVariables href="H2O.s082.opt.xml">
ci_0001                 7.026295e-01 3 1  ON 0
ci_0002                 6.983279e-01 3 1  ON 1
ci_0003                -3.181712e-02 3 1  ON 2
ci_0004                -3.148893e-02 3 1  ON 3
ci_0005                -2.842205e-02 3 1  ON 4
ci_0006                -2.962386e-02 3 1  ON 5
ci_0007                -1.644650e-02 3 1  ON 6
ci_0008                -1.721872e-02 3 1  ON 7
ci_0009                -1.895889e-02 3 1  ON 8
ci_0010                -1.909747e-02 3 1  ON 9
ci_0011                -1.578363e-02 3 1  ON 10
ci_0012                -1.579242e-02 3 1  ON 11
ci_0013                 1.568462e-02 3 1  ON 12
ci_0014                 1.561330e-02 3 1  ON 13
ci_0015                 1.647821e-02 3 1  ON 14
ci_0016                 1.619586e-02 3 1  ON 15
ci_0017                 1.384674e-02 3 1  ON 16
ci_0018                 1.415259e-02 3 1  ON 17
ci_0019                 1.243860e-02 3 1  ON 18
ci_0020                 1.205185e-02 3 1  ON 19
ci_0021                 1.539482e-02 3 1  ON 20
ci_0022                 1.641551e-02 3 1  ON 21
ci_0023                -1.177805e-02 3 1  ON 22
ci_0024                -1.103742e-02 3 1  ON 23
ci_0025                -2.989055e-03 3 1  ON 24
ci_0026                -2.657149e-03 3 1  ON 25
ci_0027                -1.174736e-02 3 1  ON 26
ci_0028                -1.172147e-02 3 1  ON 27
ci_0029                -1.033865e-02 3 1  ON 28
ci_0030                -1.028741e-02 3 1  ON 29
ci_0031                 1.407065e-02 3 1  ON 30
ci_0032                 1.310030e-02 3 1  ON 31
ci_0033                 8.463080e-03 3 1  ON 32
ci_0034                 8.659769e-03 3 1  ON 33
ci_0035                 5.045291e-03 3 1  ON 34
ci_0036                 4.826554e-03 3 1  ON 35
ci_0037                -1.143339e-02 3 1  ON 36
ci_0038                -1.140350e-02 3 1  ON 37
ci_0039                -3.804136e-03 3 1  ON 38
ci_0040                -3.933536e-03 3 1  ON 39
ci_0041                 9.636303e-03 3 1  ON 40
ci_0042                 9.532966e-03 3 1  ON 41
ci_0043                -6.343100e-03 3 1  ON 42
ci_0044                -6.774469e-03 3 1  ON 43
ci_0045                 1.045934e-02 3 1  ON 44
ci_0046                 9.383494e-03 3 1  ON 45
ci_0047                -3.644290e-03 3 1  ON 46
ci_0048                -3.595082e-03 3 1  ON 47
ci_0049                -2.504362e-03 3 1  ON 48
ci_0050                -2.823117e-03 3 1  ON 49
ci_0051                -1.835877e-03 3 1  ON 50
ci_0052                -1.716024e-03 3 1  ON 51
ci_0053                -4.036077e-03 3 1  ON 52
ci_0054                -3.938128e-03 3 1  ON 53
ci_0055                 2.508113e-03 3 1  ON 54
ci_0056                 2.146658e-03 3 1  ON 55
ci_0057                 2.391287e-03 3 1  ON 56
ci_0058                 3.125228e-03 3 1  ON 57
ci_0059                -4.061047e-03 3 1  ON 58
ci_0060                -3.655089e-03 3 1  ON 59
ci_0061                -2.865943e-03 3 1  ON 60
ci_0062                -3.079665e-03 3 1  ON 61
ci_0063                -9.741532e-03 3 1  ON 62
ci_0064                -9.713256e-03 3 1  ON 63
ci_0065                -7.181086e-03 3 1  ON 64
ci_0066                -6.636035e-03 3 1  ON 65
ci_0067                -3.951501e-03 3 1  ON 66
ci_0068                -3.957848e-03 3 1  ON 67
ci_0069                 3.825547e-03 3 1  ON 68
ci_0070                 3.580881e-03 3 1  ON 69
ci_0071                 4.381182e-03 3 1  ON 70
ci_0072                 4.650995e-03 3 1  ON 71
ci_0073                 3.394252e-03 3 1  ON 72
ci_0074                 3.189403e-03 3 1  ON 73
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 82
    time step          = 0.05
    reference energy   = -16.8915
    reference variance = 0.34602
====================================================
  Execution time = 1.4849e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s082
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6903e+01
  VMC Evar = 3.1457e-01
  Total weights = 1.9518e+06
  Execution time = 1.9560e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.303951541409
                                         uncertainty =       0.001950429734

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.303951541409
                                         uncertainty =       0.001950429734

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000389851292
  error estimate for blocks of size 2^( 2) =       0.000404346712
  error estimate for blocks of size 2^( 3) =       0.000418987295
  error estimate for blocks of size 2^( 4) =       0.000433071568
  error estimate for blocks of size 2^( 5) =       0.000443980711
  error estimate for blocks of size 2^( 6) =       0.000450395811
  error estimate for blocks of size 2^( 7) =       0.000456980949

      target function =      -0.886512380201
              le_mean =     -16.903117814921
             les_mean =     286.029962329520
             stat err =       0.000446107260
             autocorr =       1.309424992535
   target nu stat err =       0.000446107260
   target dn stat err =       0.002392603003
      target stat err =       0.003082340757
              std dev =       0.551332984539
             le_variance =       0.303968059841

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.303951541313
                                         uncertainty =       0.001950429731

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.303951541313
                                         uncertainty =       0.001950429731

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000389851292
  error estimate for blocks of size 2^( 2) =       0.000404346712
  error estimate for blocks of size 2^( 3) =       0.000418987295
  error estimate for blocks of size 2^( 4) =       0.000433071568
  error estimate for blocks of size 2^( 5) =       0.000443980711
  error estimate for blocks of size 2^( 6) =       0.000450395811
  error estimate for blocks of size 2^( 7) =       0.000456980949

      target function =      -0.886512382269
              le_mean =     -16.903117814909
             les_mean =     286.029962327474
             stat err =       0.000446107260
             autocorr =       1.309424993452
   target nu stat err =       0.000446107260
   target dn stat err =       0.002392602971
      target stat err =       0.003082340732
              std dev =       0.551332984452
             le_variance =       0.303968059744

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.303951541361
                                         uncertainty =       0.001950429733

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.303951541361
                                         uncertainty =       0.001950429733

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000389851292
  error estimate for blocks of size 2^( 2) =       0.000404346712
  error estimate for blocks of size 2^( 3) =       0.000418987295
  error estimate for blocks of size 2^( 4) =       0.000433071568
  error estimate for blocks of size 2^( 5) =       0.000443980711
  error estimate for blocks of size 2^( 6) =       0.000450395811
  error estimate for blocks of size 2^( 7) =       0.000456980949

      target function =      -0.886512381235
              le_mean =     -16.903117814915
             les_mean =     286.029962328497
             stat err =       0.000446107260
             autocorr =       1.309424993001
   target nu stat err =       0.000446107260
   target dn stat err =       0.002392602987
      target stat err =       0.003082340744
              std dev =       0.551332984495
             le_variance =       0.303968059793

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.303951541403
                                         uncertainty =       0.001950429734

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.303951541403
                                         uncertainty =       0.001950429734

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000389851292
  error estimate for blocks of size 2^( 2) =       0.000404346712
  error estimate for blocks of size 2^( 3) =       0.000418987295
  error estimate for blocks of size 2^( 4) =       0.000433071568
  error estimate for blocks of size 2^( 5) =       0.000443980711
  error estimate for blocks of size 2^( 6) =       0.000450395811
  error estimate for blocks of size 2^( 7) =       0.000456980949

      target function =      -0.886512380330
              le_mean =     -16.903117814920
             les_mean =     286.029962329392
             stat err =       0.000446107260
             autocorr =       1.309424992596
   target nu stat err =       0.000446107260
   target dn stat err =       0.002392603001
      target stat err =       0.003082340756
              std dev =       0.551332984534
             le_variance =       0.303968059835


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.886512380201        initial
     2.3283e+05     2.3283e+06             1.9957e-09        -0.886512382269  <--
     9.3132e+05     9.3132e+06             4.9892e-10        -0.886512381235
     3.7253e+06     3.7253e+07             1.2473e-10        -0.886512380330

*****************************************************************************
Applying the update for shift_i =   2.3283e+05     and shift_s =   2.3283e+06
*****************************************************************************

  Execution time = 2.4710e+01
  </log>
  <optVariables href="H2O.s082.opt.xml">
ci_0001                 7.026295e-01 3 1  ON 0
ci_0002                 6.983279e-01 3 1  ON 1
ci_0003                -3.181712e-02 3 1  ON 2
ci_0004                -3.148893e-02 3 1  ON 3
ci_0005                -2.842205e-02 3 1  ON 4
ci_0006                -2.962386e-02 3 1  ON 5
ci_0007                -1.644650e-02 3 1  ON 6
ci_0008                -1.721872e-02 3 1  ON 7
ci_0009                -1.895889e-02 3 1  ON 8
ci_0010                -1.909747e-02 3 1  ON 9
ci_0011                -1.578363e-02 3 1  ON 10
ci_0012                -1.579242e-02 3 1  ON 11
ci_0013                 1.568462e-02 3 1  ON 12
ci_0014                 1.561330e-02 3 1  ON 13
ci_0015                 1.647821e-02 3 1  ON 14
ci_0016                 1.619586e-02 3 1  ON 15
ci_0017                 1.384674e-02 3 1  ON 16
ci_0018                 1.415259e-02 3 1  ON 17
ci_0019                 1.243860e-02 3 1  ON 18
ci_0020                 1.205185e-02 3 1  ON 19
ci_0021                 1.539482e-02 3 1  ON 20
ci_0022                 1.641551e-02 3 1  ON 21
ci_0023                -1.177805e-02 3 1  ON 22
ci_0024                -1.103742e-02 3 1  ON 23
ci_0025                -2.989055e-03 3 1  ON 24
ci_0026                -2.657149e-03 3 1  ON 25
ci_0027                -1.174736e-02 3 1  ON 26
ci_0028                -1.172147e-02 3 1  ON 27
ci_0029                -1.033865e-02 3 1  ON 28
ci_0030                -1.028741e-02 3 1  ON 29
ci_0031                 1.407065e-02 3 1  ON 30
ci_0032                 1.310030e-02 3 1  ON 31
ci_0033                 8.463080e-03 3 1  ON 32
ci_0034                 8.659769e-03 3 1  ON 33
ci_0035                 5.045289e-03 3 1  ON 34
ci_0036                 4.826554e-03 3 1  ON 35
ci_0037                -1.143339e-02 3 1  ON 36
ci_0038                -1.140350e-02 3 1  ON 37
ci_0039                -3.804136e-03 3 1  ON 38
ci_0040                -3.933536e-03 3 1  ON 39
ci_0041                 9.636303e-03 3 1  ON 40
ci_0042                 9.532966e-03 3 1  ON 41
ci_0043                -6.343100e-03 3 1  ON 42
ci_0044                -6.774469e-03 3 1  ON 43
ci_0045                 1.045934e-02 3 1  ON 44
ci_0046                 9.383495e-03 3 1  ON 45
ci_0047                -3.644290e-03 3 1  ON 46
ci_0048                -3.595082e-03 3 1  ON 47
ci_0049                -2.504361e-03 3 1  ON 48
ci_0050                -2.823117e-03 3 1  ON 49
ci_0051                -1.835877e-03 3 1  ON 50
ci_0052                -1.716024e-03 3 1  ON 51
ci_0053                -4.036077e-03 3 1  ON 52
ci_0054                -3.938128e-03 3 1  ON 53
ci_0055                 2.508112e-03 3 1  ON 54
ci_0056                 2.146657e-03 3 1  ON 55
ci_0057                 2.391287e-03 3 1  ON 56
ci_0058                 3.125227e-03 3 1  ON 57
ci_0059                -4.061046e-03 3 1  ON 58
ci_0060                -3.655089e-03 3 1  ON 59
ci_0061                -2.865943e-03 3 1  ON 60
ci_0062                -3.079665e-03 3 1  ON 61
ci_0063                -9.741532e-03 3 1  ON 62
ci_0064                -9.713256e-03 3 1  ON 63
ci_0065                -7.181086e-03 3 1  ON 64
ci_0066                -6.636035e-03 3 1  ON 65
ci_0067                -3.951501e-03 3 1  ON 66
ci_0068                -3.957848e-03 3 1  ON 67
ci_0069                 3.825547e-03 3 1  ON 68
ci_0070                 3.580881e-03 3 1  ON 69
ci_0071                 4.381182e-03 3 1  ON 70
ci_0072                 4.650995e-03 3 1  ON 71
ci_0073                 3.394252e-03 3 1  ON 72
ci_0074                 3.189403e-03 3 1  ON 73
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 4.2178e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s083 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s083 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=83  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6899e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 83
    time step          = 0.05
    reference energy   = -16.9472
    reference variance = 0.292015
====================================================
  Execution time = 1.4743e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s083
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5255e+04
  VMC Eavg = -1.6903e+01
  VMC Evar = 3.1751e-01
  Total weights = 1.951962134e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 2.6804e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.304490696998
                                         uncertainty =       0.002155179392

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.304490696998
                                         uncertainty =       0.002155179392

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000390140476
  error estimate for blocks of size 2^( 2) =       0.000404563088
  error estimate for blocks of size 2^( 3) =       0.000419581551
  error estimate for blocks of size 2^( 4) =       0.000433773341
  error estimate for blocks of size 2^( 5) =       0.000445188852
  error estimate for blocks of size 2^( 6) =       0.000453141349
  error estimate for blocks of size 2^( 7) =       0.000458470138

      target function =      -0.882754024579
              le_mean =     -16.902660577477
             les_mean =     286.017444658344
             stat err =       0.000447643420
             autocorr =       1.316504631788
   target nu stat err =       0.000447643420
   target dn stat err =       0.002677110743
      target stat err =       0.003403489963
              std dev =       0.551741952206
             le_variance =       0.304419181824


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690266057748e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 74
Check correct_vf_var_size: 225, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 5.8208e+04, overlap shift 5.8208e+05 and omega -1.7527e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.882766032489       residual = 1.55e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.882766033567       residual = 1.92e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.882766033693       residual = 5.76e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.882766033762       residual = 1.95e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.882766033733       residual = 5.68e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.882766033878       residual = 2.53e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.882766033825       residual = 6.13e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.882766033959       residual = 1.83e-06           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.882766033782       residual = 6.67e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.882766033718       residual = 2.02e-07           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.882766033737       residual = 8.93e-08           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.882766033745       residual = 1.68e-08           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.882766033803       residual = 4.35e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         12 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 5.8208e+04 is 4.058443e-09

solving harmonic davidson linear method for identity shift 2.3283e+05, overlap shift 2.3283e+06 and omega -1.7527e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.882766032489       residual = 1.55e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.882766032758       residual = 1.92e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.882766032790       residual = 5.76e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.882766032806       residual = 1.95e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.882766032685       residual = 5.68e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.882766032853       residual = 2.53e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.882766032919       residual = 6.13e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.882766033214       residual = 1.83e-06           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.882766032726       residual = 6.67e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.882766032554       residual = 2.02e-07           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.882766032707       residual = 8.93e-08           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.882766032268       residual = 1.68e-08           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.882766032875       residual = 4.35e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         12 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 2.3283e+05 is 1.014612e-09

solving harmonic davidson linear method for identity shift 9.3132e+05, overlap shift 9.3132e+06 and omega -1.7527e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.882766032489       residual = 1.55e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.882766032556       residual = 1.92e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.882766032564       residual = 5.76e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.882766032612       residual = 1.95e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.882766032270       residual = 5.68e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.882766032070       residual = 2.53e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.882766033211       residual = 6.13e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.882766031447       residual = 1.83e-06           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.882766033356       residual = 6.67e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.882766032010       residual = 2.02e-07           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.882766034604       residual = 8.93e-08           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.882766034400       residual = 1.68e-08           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.882766031684       residual = 4.34e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         12 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 9.3132e+05 is 2.536530e-10

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               1.075923 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 75 and numParams is: 74

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.7441e+01
  </log>
  <optVariables href="H2O.s083.opt.xml">
ci_0001                 7.026295e-01 3 1  ON 0
ci_0002                 6.983279e-01 3 1  ON 1
ci_0003                -3.181712e-02 3 1  ON 2
ci_0004                -3.148893e-02 3 1  ON 3
ci_0005                -2.842205e-02 3 1  ON 4
ci_0006                -2.962386e-02 3 1  ON 5
ci_0007                -1.644650e-02 3 1  ON 6
ci_0008                -1.721872e-02 3 1  ON 7
ci_0009                -1.895889e-02 3 1  ON 8
ci_0010                -1.909747e-02 3 1  ON 9
ci_0011                -1.578363e-02 3 1  ON 10
ci_0012                -1.579242e-02 3 1  ON 11
ci_0013                 1.568462e-02 3 1  ON 12
ci_0014                 1.561330e-02 3 1  ON 13
ci_0015                 1.647821e-02 3 1  ON 14
ci_0016                 1.619586e-02 3 1  ON 15
ci_0017                 1.384674e-02 3 1  ON 16
ci_0018                 1.415259e-02 3 1  ON 17
ci_0019                 1.243860e-02 3 1  ON 18
ci_0020                 1.205185e-02 3 1  ON 19
ci_0021                 1.539482e-02 3 1  ON 20
ci_0022                 1.641551e-02 3 1  ON 21
ci_0023                -1.177805e-02 3 1  ON 22
ci_0024                -1.103742e-02 3 1  ON 23
ci_0025                -2.989055e-03 3 1  ON 24
ci_0026                -2.657149e-03 3 1  ON 25
ci_0027                -1.174736e-02 3 1  ON 26
ci_0028                -1.172147e-02 3 1  ON 27
ci_0029                -1.033865e-02 3 1  ON 28
ci_0030                -1.028741e-02 3 1  ON 29
ci_0031                 1.407065e-02 3 1  ON 30
ci_0032                 1.310030e-02 3 1  ON 31
ci_0033                 8.463080e-03 3 1  ON 32
ci_0034                 8.659768e-03 3 1  ON 33
ci_0035                 5.045288e-03 3 1  ON 34
ci_0036                 4.826553e-03 3 1  ON 35
ci_0037                -1.143339e-02 3 1  ON 36
ci_0038                -1.140350e-02 3 1  ON 37
ci_0039                -3.804136e-03 3 1  ON 38
ci_0040                -3.933536e-03 3 1  ON 39
ci_0041                 9.636303e-03 3 1  ON 40
ci_0042                 9.532966e-03 3 1  ON 41
ci_0043                -6.343099e-03 3 1  ON 42
ci_0044                -6.774469e-03 3 1  ON 43
ci_0045                 1.045934e-02 3 1  ON 44
ci_0046                 9.383495e-03 3 1  ON 45
ci_0047                -3.644289e-03 3 1  ON 46
ci_0048                -3.595082e-03 3 1  ON 47
ci_0049                -2.504362e-03 3 1  ON 48
ci_0050                -2.823117e-03 3 1  ON 49
ci_0051                -1.835877e-03 3 1  ON 50
ci_0052                -1.716024e-03 3 1  ON 51
ci_0053                -4.036076e-03 3 1  ON 52
ci_0054                -3.938127e-03 3 1  ON 53
ci_0055                 2.508112e-03 3 1  ON 54
ci_0056                 2.146658e-03 3 1  ON 55
ci_0057                 2.391287e-03 3 1  ON 56
ci_0058                 3.125228e-03 3 1  ON 57
ci_0059                -4.061046e-03 3 1  ON 58
ci_0060                -3.655089e-03 3 1  ON 59
ci_0061                -2.865944e-03 3 1  ON 60
ci_0062                -3.079665e-03 3 1  ON 61
ci_0063                -9.741531e-03 3 1  ON 62
ci_0064                -9.713256e-03 3 1  ON 63
ci_0065                -7.181086e-03 3 1  ON 64
ci_0066                -6.636035e-03 3 1  ON 65
ci_0067                -3.951501e-03 3 1  ON 66
ci_0068                -3.957848e-03 3 1  ON 67
ci_0069                 3.825547e-03 3 1  ON 68
ci_0070                 3.580881e-03 3 1  ON 69
ci_0071                 4.381181e-03 3 1  ON 70
ci_0072                 4.650995e-03 3 1  ON 71
ci_0073                 3.394252e-03 3 1  ON 72
ci_0074                 3.189403e-03 3 1  ON 73
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 83
    time step          = 0.05
    reference energy   = -16.9363
    reference variance = 0.468333
====================================================
  Execution time = 1.4934e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s083
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6903e+01
  VMC Evar = 3.1562e-01
  Total weights = 1.9518e+06
  Execution time = 1.9367e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.303742541239
                                         uncertainty =       0.002854527122

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.303742541239
                                         uncertainty =       0.002854527122

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000389677805
  error estimate for blocks of size 2^( 2) =       0.000404065891
  error estimate for blocks of size 2^( 3) =       0.000418929611
  error estimate for blocks of size 2^( 4) =       0.000431753980
  error estimate for blocks of size 2^( 5) =       0.000443030810
  error estimate for blocks of size 2^( 6) =       0.000451379968
  error estimate for blocks of size 2^( 7) =       0.000456153105

      target function =      -0.885167506437
              le_mean =     -16.903002529990
             les_mean =     286.027112920483
             stat err =       0.000445579466
             autocorr =       1.307491871165
   target nu stat err =       0.000445579466
   target dn stat err =       0.003248878655
      target stat err =       0.004131435929
              std dev =       0.551087636323
             le_variance =       0.303697582908

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.303742540495
                                         uncertainty =       0.002854527076

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.303742540495
                                         uncertainty =       0.002854527076

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000389677804
  error estimate for blocks of size 2^( 2) =       0.000404065891
  error estimate for blocks of size 2^( 3) =       0.000418929611
  error estimate for blocks of size 2^( 4) =       0.000431753981
  error estimate for blocks of size 2^( 5) =       0.000443030810
  error estimate for blocks of size 2^( 6) =       0.000451379969
  error estimate for blocks of size 2^( 7) =       0.000456153106

      target function =      -0.885167506478
              le_mean =     -16.903002530013
             les_mean =     286.027112921250
             stat err =       0.000445579466
             autocorr =       1.307491876838
   target nu stat err =       0.000445579466
   target dn stat err =       0.003248878672
      target stat err =       0.004131435951
              std dev =       0.551087635651
             le_variance =       0.303697582168

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.303742540867
                                         uncertainty =       0.002854527099

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.303742540867
                                         uncertainty =       0.002854527099

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000389677804
  error estimate for blocks of size 2^( 2) =       0.000404065891
  error estimate for blocks of size 2^( 3) =       0.000418929611
  error estimate for blocks of size 2^( 4) =       0.000431753981
  error estimate for blocks of size 2^( 5) =       0.000443030810
  error estimate for blocks of size 2^( 6) =       0.000451379969
  error estimate for blocks of size 2^( 7) =       0.000456153105

      target function =      -0.885167506457
              le_mean =     -16.903002530001
             les_mean =     286.027112920867
             stat err =       0.000445579466
             autocorr =       1.307491874008
   target nu stat err =       0.000445579466
   target dn stat err =       0.003248878663
      target stat err =       0.004131435940
              std dev =       0.551087635987
             le_variance =       0.303697582538

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.303742541193
                                         uncertainty =       0.002854527119

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.303742541193
                                         uncertainty =       0.002854527119

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000389677805
  error estimate for blocks of size 2^( 2) =       0.000404065891
  error estimate for blocks of size 2^( 3) =       0.000418929611
  error estimate for blocks of size 2^( 4) =       0.000431753980
  error estimate for blocks of size 2^( 5) =       0.000443030810
  error estimate for blocks of size 2^( 6) =       0.000451379968
  error estimate for blocks of size 2^( 7) =       0.000456153105

      target function =      -0.885167506439
              le_mean =     -16.903002529991
             les_mean =     286.027112920531
             stat err =       0.000445579466
             autocorr =       1.307491871520
   target nu stat err =       0.000445579466
   target dn stat err =       0.003248878656
      target stat err =       0.004131435930
              std dev =       0.551087636281
             le_variance =       0.303697582862


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.885167506437        initial
     5.8208e+04     5.8208e+05             4.0584e-09        -0.885167506478  <--
     2.3283e+05     2.3283e+06             1.0146e-09        -0.885167506457
     9.3132e+05     9.3132e+06             2.5365e-10        -0.885167506439

*****************************************************************************
Applying the update for shift_i =   5.8208e+04     and shift_s =   5.8208e+05
*****************************************************************************

  Execution time = 2.4730e+01
  </log>
  <optVariables href="H2O.s083.opt.xml">
ci_0001                 7.026295e-01 3 1  ON 0
ci_0002                 6.983279e-01 3 1  ON 1
ci_0003                -3.181711e-02 3 1  ON 2
ci_0004                -3.148893e-02 3 1  ON 3
ci_0005                -2.842205e-02 3 1  ON 4
ci_0006                -2.962385e-02 3 1  ON 5
ci_0007                -1.644649e-02 3 1  ON 6
ci_0008                -1.721872e-02 3 1  ON 7
ci_0009                -1.895889e-02 3 1  ON 8
ci_0010                -1.909747e-02 3 1  ON 9
ci_0011                -1.578363e-02 3 1  ON 10
ci_0012                -1.579242e-02 3 1  ON 11
ci_0013                 1.568462e-02 3 1  ON 12
ci_0014                 1.561330e-02 3 1  ON 13
ci_0015                 1.647821e-02 3 1  ON 14
ci_0016                 1.619586e-02 3 1  ON 15
ci_0017                 1.384674e-02 3 1  ON 16
ci_0018                 1.415258e-02 3 1  ON 17
ci_0019                 1.243860e-02 3 1  ON 18
ci_0020                 1.205185e-02 3 1  ON 19
ci_0021                 1.539482e-02 3 1  ON 20
ci_0022                 1.641551e-02 3 1  ON 21
ci_0023                -1.177805e-02 3 1  ON 22
ci_0024                -1.103742e-02 3 1  ON 23
ci_0025                -2.989055e-03 3 1  ON 24
ci_0026                -2.657147e-03 3 1  ON 25
ci_0027                -1.174736e-02 3 1  ON 26
ci_0028                -1.172147e-02 3 1  ON 27
ci_0029                -1.033865e-02 3 1  ON 28
ci_0030                -1.028741e-02 3 1  ON 29
ci_0031                 1.407065e-02 3 1  ON 30
ci_0032                 1.310030e-02 3 1  ON 31
ci_0033                 8.463080e-03 3 1  ON 32
ci_0034                 8.659767e-03 3 1  ON 33
ci_0035                 5.045285e-03 3 1  ON 34
ci_0036                 4.826552e-03 3 1  ON 35
ci_0037                -1.143339e-02 3 1  ON 36
ci_0038                -1.140350e-02 3 1  ON 37
ci_0039                -3.804135e-03 3 1  ON 38
ci_0040                -3.933536e-03 3 1  ON 39
ci_0041                 9.636302e-03 3 1  ON 40
ci_0042                 9.532966e-03 3 1  ON 41
ci_0043                -6.343098e-03 3 1  ON 42
ci_0044                -6.774468e-03 3 1  ON 43
ci_0045                 1.045934e-02 3 1  ON 44
ci_0046                 9.383494e-03 3 1  ON 45
ci_0047                -3.644289e-03 3 1  ON 46
ci_0048                -3.595082e-03 3 1  ON 47
ci_0049                -2.504364e-03 3 1  ON 48
ci_0050                -2.823117e-03 3 1  ON 49
ci_0051                -1.835876e-03 3 1  ON 50
ci_0052                -1.716024e-03 3 1  ON 51
ci_0053                -4.036074e-03 3 1  ON 52
ci_0054                -3.938127e-03 3 1  ON 53
ci_0055                 2.508111e-03 3 1  ON 54
ci_0056                 2.146659e-03 3 1  ON 55
ci_0057                 2.391288e-03 3 1  ON 56
ci_0058                 3.125229e-03 3 1  ON 57
ci_0059                -4.061045e-03 3 1  ON 58
ci_0060                -3.655089e-03 3 1  ON 59
ci_0061                -2.865945e-03 3 1  ON 60
ci_0062                -3.079664e-03 3 1  ON 61
ci_0063                -9.741531e-03 3 1  ON 62
ci_0064                -9.713255e-03 3 1  ON 63
ci_0065                -7.181086e-03 3 1  ON 64
ci_0066                -6.636034e-03 3 1  ON 65
ci_0067                -3.951500e-03 3 1  ON 66
ci_0068                -3.957848e-03 3 1  ON 67
ci_0069                 3.825545e-03 3 1  ON 68
ci_0070                 3.580880e-03 3 1  ON 69
ci_0071                 4.381181e-03 3 1  ON 70
ci_0072                 4.650995e-03 3 1  ON 71
ci_0073                 3.394252e-03 3 1  ON 72
ci_0074                 3.189403e-03 3 1  ON 73
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 4.2186e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s084 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s084 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=84  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6900e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 84
    time step          = 0.05
    reference energy   = -16.9716
    reference variance = 0.359614
====================================================
  Execution time = 1.4947e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s084
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5253e+04
  VMC Eavg = -1.6904e+01
  VMC Evar = 3.1775e-01
  Total weights = 1.951924701e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 2.6896e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.307302063476
                                         uncertainty =       0.002738094872

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.307302063476
                                         uncertainty =       0.002738094872

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000392024648
  error estimate for blocks of size 2^( 2) =       0.000406543611
  error estimate for blocks of size 2^( 3) =       0.000421426529
  error estimate for blocks of size 2^( 4) =       0.000434452260
  error estimate for blocks of size 2^( 5) =       0.000445621650
  error estimate for blocks of size 2^( 6) =       0.000452115348
  error estimate for blocks of size 2^( 7) =       0.000456887963

      target function =      -0.882566612254
              le_mean =     -16.903515862975
             les_mean =     286.046600889706
             stat err =       0.000447269305
             autocorr =       1.301701612711
   target nu stat err =       0.000447269305
   target dn stat err =       0.003275736611
      target stat err =       0.004144412862
              std dev =       0.554406573584
             le_variance =       0.307366648833


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690351586298e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 74
Check correct_vf_var_size: 225, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.4552e+04, overlap shift 1.4552e+05 and omega -1.7527e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.882585002055       residual = 7.83e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.882585004796       residual = 1.27e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.882585005184       residual = 4.53e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.882585005441       residual = 1.48e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.882585005505       residual = 4.51e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.882585005534       residual = 1.75e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.882585005539       residual = 6.97e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.882585005536       residual = 2.61e-06           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.882585005539       residual = 1.21e-06           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.882585005541       residual = 7.96e-07           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.882585005517       residual = 5.23e-07           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.882585005540       residual = 5.04e-07           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.882585005525       residual = 4.06e-07           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.882585005539       residual = 1.38e-07           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.882585005526       residual = 3.33e-08           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.882585005514       residual = 6.29e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         15 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 1.4552e+04 is 1.284801e-08

solving harmonic davidson linear method for identity shift 5.8208e+04, overlap shift 5.8208e+05 and omega -1.7527e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.882585002055       residual = 7.83e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.882585002740       residual = 1.27e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.882585002837       residual = 4.53e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.882585002901       residual = 1.48e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.882585002917       residual = 4.51e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.882585002924       residual = 1.75e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.882585002926       residual = 6.97e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.882585002925       residual = 2.61e-06           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.882585002926       residual = 1.21e-06           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.882585002926       residual = 7.96e-07           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.882585003003       residual = 5.23e-07           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.882585002926       residual = 5.04e-07           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.882585002926       residual = 4.06e-07           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.882585002777       residual = 1.38e-07           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.882585002926       residual = 3.33e-08           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.882585003011       residual = 6.29e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         15 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 5.8208e+04 is 3.212011e-09

solving harmonic davidson linear method for identity shift 2.3283e+05, overlap shift 2.3283e+06 and omega -1.7527e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.882585002055       residual = 7.83e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.882585002226       residual = 1.27e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.882585002250       residual = 4.53e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.882585002266       residual = 1.48e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.882585002270       residual = 4.51e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.882585002272       residual = 1.75e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.882585002272       residual = 6.97e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.882585002689       residual = 2.61e-06           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.882585002414       residual = 1.21e-06           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.882585002272       residual = 7.96e-07           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.882585002272       residual = 5.23e-07           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.882585002272       residual = 5.04e-07           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.882585002700       residual = 4.06e-07           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.882585002273       residual = 1.38e-07           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.882585002272       residual = 3.33e-08           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.882585002212       residual = 6.29e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         15 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 2.3283e+05 is 8.030031e-10

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               1.088863 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 75 and numParams is: 74

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.7658e+01
  </log>
  <optVariables href="H2O.s084.opt.xml">
ci_0001                 7.026295e-01 3 1  ON 0
ci_0002                 6.983279e-01 3 1  ON 1
ci_0003                -3.181711e-02 3 1  ON 2
ci_0004                -3.148893e-02 3 1  ON 3
ci_0005                -2.842204e-02 3 1  ON 4
ci_0006                -2.962385e-02 3 1  ON 5
ci_0007                -1.644649e-02 3 1  ON 6
ci_0008                -1.721872e-02 3 1  ON 7
ci_0009                -1.895889e-02 3 1  ON 8
ci_0010                -1.909747e-02 3 1  ON 9
ci_0011                -1.578363e-02 3 1  ON 10
ci_0012                -1.579242e-02 3 1  ON 11
ci_0013                 1.568462e-02 3 1  ON 12
ci_0014                 1.561330e-02 3 1  ON 13
ci_0015                 1.647821e-02 3 1  ON 14
ci_0016                 1.619586e-02 3 1  ON 15
ci_0017                 1.384674e-02 3 1  ON 16
ci_0018                 1.415258e-02 3 1  ON 17
ci_0019                 1.243860e-02 3 1  ON 18
ci_0020                 1.205185e-02 3 1  ON 19
ci_0021                 1.539482e-02 3 1  ON 20
ci_0022                 1.641551e-02 3 1  ON 21
ci_0023                -1.177805e-02 3 1  ON 22
ci_0024                -1.103742e-02 3 1  ON 23
ci_0025                -2.989053e-03 3 1  ON 24
ci_0026                -2.657145e-03 3 1  ON 25
ci_0027                -1.174736e-02 3 1  ON 26
ci_0028                -1.172147e-02 3 1  ON 27
ci_0029                -1.033864e-02 3 1  ON 28
ci_0030                -1.028741e-02 3 1  ON 29
ci_0031                 1.407065e-02 3 1  ON 30
ci_0032                 1.310030e-02 3 1  ON 31
ci_0033                 8.463078e-03 3 1  ON 32
ci_0034                 8.659767e-03 3 1  ON 33
ci_0035                 5.045287e-03 3 1  ON 34
ci_0036                 4.826552e-03 3 1  ON 35
ci_0037                -1.143340e-02 3 1  ON 36
ci_0038                -1.140350e-02 3 1  ON 37
ci_0039                -3.804135e-03 3 1  ON 38
ci_0040                -3.933535e-03 3 1  ON 39
ci_0041                 9.636302e-03 3 1  ON 40
ci_0042                 9.532965e-03 3 1  ON 41
ci_0043                -6.343098e-03 3 1  ON 42
ci_0044                -6.774467e-03 3 1  ON 43
ci_0045                 1.045934e-02 3 1  ON 44
ci_0046                 9.383495e-03 3 1  ON 45
ci_0047                -3.644288e-03 3 1  ON 46
ci_0048                -3.595081e-03 3 1  ON 47
ci_0049                -2.504362e-03 3 1  ON 48
ci_0050                -2.823115e-03 3 1  ON 49
ci_0051                -1.835876e-03 3 1  ON 50
ci_0052                -1.716023e-03 3 1  ON 51
ci_0053                -4.036073e-03 3 1  ON 52
ci_0054                -3.938126e-03 3 1  ON 53
ci_0055                 2.508109e-03 3 1  ON 54
ci_0056                 2.146658e-03 3 1  ON 55
ci_0057                 2.391289e-03 3 1  ON 56
ci_0058                 3.125229e-03 3 1  ON 57
ci_0059                -4.061044e-03 3 1  ON 58
ci_0060                -3.655089e-03 3 1  ON 59
ci_0061                -2.865945e-03 3 1  ON 60
ci_0062                -3.079663e-03 3 1  ON 61
ci_0063                -9.741530e-03 3 1  ON 62
ci_0064                -9.713256e-03 3 1  ON 63
ci_0065                -7.181084e-03 3 1  ON 64
ci_0066                -6.636035e-03 3 1  ON 65
ci_0067                -3.951500e-03 3 1  ON 66
ci_0068                -3.957848e-03 3 1  ON 67
ci_0069                 3.825546e-03 3 1  ON 68
ci_0070                 3.580881e-03 3 1  ON 69
ci_0071                 4.381181e-03 3 1  ON 70
ci_0072                 4.650997e-03 3 1  ON 71
ci_0073                 3.394251e-03 3 1  ON 72
ci_0074                 3.189403e-03 3 1  ON 73
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 84
    time step          = 0.05
    reference energy   = -16.8958
    reference variance = 0.163931
====================================================
  Execution time = 1.4387e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s084
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6903e+01
  VMC Evar = 3.1723e-01
  Total weights = 1.9518e+06
  Execution time = 1.9480e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.305523257325
                                         uncertainty =       0.002634801871

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.305523257325
                                         uncertainty =       0.002634801871

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000391127555
  error estimate for blocks of size 2^( 2) =       0.000405653961
  error estimate for blocks of size 2^( 3) =       0.000420934597
  error estimate for blocks of size 2^( 4) =       0.000435143330
  error estimate for blocks of size 2^( 5) =       0.000446085582
  error estimate for blocks of size 2^( 6) =       0.000454684509
  error estimate for blocks of size 2^( 7) =       0.000460845955

      target function =      -0.883149306263
              le_mean =     -16.902966491069
             les_mean =     286.027501399021
             stat err =       0.000449189844
             autocorr =       1.318933897552
   target nu stat err =       0.000449189844
   target dn stat err =       0.003132507957
      target stat err =       0.003969633626
              std dev =       0.553137893245
             le_variance =       0.305961528944

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.305523252376
                                         uncertainty =       0.002634800716

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.305523252376
                                         uncertainty =       0.002634800716

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000391127552
  error estimate for blocks of size 2^( 2) =       0.000405653959
  error estimate for blocks of size 2^( 3) =       0.000420934595
  error estimate for blocks of size 2^( 4) =       0.000435143329
  error estimate for blocks of size 2^( 5) =       0.000446085582
  error estimate for blocks of size 2^( 6) =       0.000454684509
  error estimate for blocks of size 2^( 7) =       0.000460845955

      target function =      -0.883149319516
              le_mean =     -16.902966491027
             les_mean =     286.027501387013
             stat err =       0.000449189844
             autocorr =       1.318933917938
   target nu stat err =       0.000449189844
   target dn stat err =       0.003132506255
      target stat err =       0.003969631642
              std dev =       0.553137888631
             le_variance =       0.305961523840

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.305523254851
                                         uncertainty =       0.002634801294

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.305523254851
                                         uncertainty =       0.002634801294

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000391127554
  error estimate for blocks of size 2^( 2) =       0.000405653960
  error estimate for blocks of size 2^( 3) =       0.000420934596
  error estimate for blocks of size 2^( 4) =       0.000435143329
  error estimate for blocks of size 2^( 5) =       0.000446085582
  error estimate for blocks of size 2^( 6) =       0.000454684509
  error estimate for blocks of size 2^( 7) =       0.000460845955

      target function =      -0.883149312889
              le_mean =     -16.902966491048
             les_mean =     286.027501393017
             stat err =       0.000449189844
             autocorr =       1.318933907738
   target nu stat err =       0.000449189844
   target dn stat err =       0.003132507106
      target stat err =       0.003969632634
              std dev =       0.553137890938
             le_variance =       0.305961526392

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.305523257016
                                         uncertainty =       0.002634801799

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.305523257016
                                         uncertainty =       0.002634801799

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000391127555
  error estimate for blocks of size 2^( 2) =       0.000405653961
  error estimate for blocks of size 2^( 3) =       0.000420934597
  error estimate for blocks of size 2^( 4) =       0.000435143330
  error estimate for blocks of size 2^( 5) =       0.000446085582
  error estimate for blocks of size 2^( 6) =       0.000454684509
  error estimate for blocks of size 2^( 7) =       0.000460845955

      target function =      -0.883149307091
              le_mean =     -16.902966491066
             les_mean =     286.027501398271
             stat err =       0.000449189844
             autocorr =       1.318933898819
   target nu stat err =       0.000449189844
   target dn stat err =       0.003132507851
      target stat err =       0.003969633502
              std dev =       0.553137892957
             le_variance =       0.305961528625


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.883149306263        initial
     1.4552e+04     1.4552e+05             1.2848e-08        -0.883149319516  <--
     5.8208e+04     5.8208e+05             3.2120e-09        -0.883149312889
     2.3283e+05     2.3283e+06             8.0300e-10        -0.883149307091

*****************************************************************************
Applying the update for shift_i =   1.4552e+04     and shift_s =   1.4552e+05
*****************************************************************************

  Execution time = 2.4215e+01
  </log>
  <optVariables href="H2O.s084.opt.xml">
ci_0001                 7.026295e-01 3 1  ON 0
ci_0002                 6.983279e-01 3 1  ON 1
ci_0003                -3.181710e-02 3 1  ON 2
ci_0004                -3.148892e-02 3 1  ON 3
ci_0005                -2.842203e-02 3 1  ON 4
ci_0006                -2.962384e-02 3 1  ON 5
ci_0007                -1.644648e-02 3 1  ON 6
ci_0008                -1.721871e-02 3 1  ON 7
ci_0009                -1.895888e-02 3 1  ON 8
ci_0010                -1.909747e-02 3 1  ON 9
ci_0011                -1.578362e-02 3 1  ON 10
ci_0012                -1.579242e-02 3 1  ON 11
ci_0013                 1.568462e-02 3 1  ON 12
ci_0014                 1.561329e-02 3 1  ON 13
ci_0015                 1.647821e-02 3 1  ON 14
ci_0016                 1.619586e-02 3 1  ON 15
ci_0017                 1.384674e-02 3 1  ON 16
ci_0018                 1.415258e-02 3 1  ON 17
ci_0019                 1.243860e-02 3 1  ON 18
ci_0020                 1.205185e-02 3 1  ON 19
ci_0021                 1.539482e-02 3 1  ON 20
ci_0022                 1.641551e-02 3 1  ON 21
ci_0023                -1.177804e-02 3 1  ON 22
ci_0024                -1.103742e-02 3 1  ON 23
ci_0025                -2.989047e-03 3 1  ON 24
ci_0026                -2.657140e-03 3 1  ON 25
ci_0027                -1.174736e-02 3 1  ON 26
ci_0028                -1.172147e-02 3 1  ON 27
ci_0029                -1.033864e-02 3 1  ON 28
ci_0030                -1.028741e-02 3 1  ON 29
ci_0031                 1.407065e-02 3 1  ON 30
ci_0032                 1.310029e-02 3 1  ON 31
ci_0033                 8.463071e-03 3 1  ON 32
ci_0034                 8.659766e-03 3 1  ON 33
ci_0035                 5.045292e-03 3 1  ON 34
ci_0036                 4.826553e-03 3 1  ON 35
ci_0037                -1.143340e-02 3 1  ON 36
ci_0038                -1.140350e-02 3 1  ON 37
ci_0039                -3.804135e-03 3 1  ON 38
ci_0040                -3.933535e-03 3 1  ON 39
ci_0041                 9.636302e-03 3 1  ON 40
ci_0042                 9.532964e-03 3 1  ON 41
ci_0043                -6.343097e-03 3 1  ON 42
ci_0044                -6.774465e-03 3 1  ON 43
ci_0045                 1.045934e-02 3 1  ON 44
ci_0046                 9.383497e-03 3 1  ON 45
ci_0047                -3.644285e-03 3 1  ON 46
ci_0048                -3.595079e-03 3 1  ON 47
ci_0049                -2.504357e-03 3 1  ON 48
ci_0050                -2.823110e-03 3 1  ON 49
ci_0051                -1.835875e-03 3 1  ON 50
ci_0052                -1.716022e-03 3 1  ON 51
ci_0053                -4.036071e-03 3 1  ON 52
ci_0054                -3.938125e-03 3 1  ON 53
ci_0055                 2.508105e-03 3 1  ON 54
ci_0056                 2.146656e-03 3 1  ON 55
ci_0057                 2.391295e-03 3 1  ON 56
ci_0058                 3.125228e-03 3 1  ON 57
ci_0059                -4.061041e-03 3 1  ON 58
ci_0060                -3.655091e-03 3 1  ON 59
ci_0061                -2.865946e-03 3 1  ON 60
ci_0062                -3.079659e-03 3 1  ON 61
ci_0063                -9.741526e-03 3 1  ON 62
ci_0064                -9.713256e-03 3 1  ON 63
ci_0065                -7.181078e-03 3 1  ON 64
ci_0066                -6.636037e-03 3 1  ON 65
ci_0067                -3.951499e-03 3 1  ON 66
ci_0068                -3.957849e-03 3 1  ON 67
ci_0069                 3.825547e-03 3 1  ON 68
ci_0070                 3.580882e-03 3 1  ON 69
ci_0071                 4.381182e-03 3 1  ON 70
ci_0072                 4.651002e-03 3 1  ON 71
ci_0073                 3.394251e-03 3 1  ON 72
ci_0074                 3.189403e-03 3 1  ON 73
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 4.1887e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s085 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s085 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=85  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6900e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 85
    time step          = 0.05
    reference energy   = -16.8626
    reference variance = 0.198694
====================================================
  Execution time = 1.4926e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s085
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5267e+04
  VMC Eavg = -1.6903e+01
  VMC Evar = 3.1511e-01
  Total weights = 1.951431968e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 2.6814e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.305198166195
                                         uncertainty =       0.002162462321

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.305198166195
                                         uncertainty =       0.002162462321

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000390642072
  error estimate for blocks of size 2^( 2) =       0.000405161381
  error estimate for blocks of size 2^( 3) =       0.000419982022
  error estimate for blocks of size 2^( 4) =       0.000434407953
  error estimate for blocks of size 2^( 5) =       0.000445096169
  error estimate for blocks of size 2^( 6) =       0.000454974621
  error estimate for blocks of size 2^( 7) =       0.000459213700

      target function =      -0.885770596839
              le_mean =     -16.902670645106
             les_mean =     286.015380097332
             stat err =       0.000448423111
             autocorr =       1.317704244284
   target nu stat err =       0.000448423111
   target dn stat err =       0.002567698730
      target stat err =       0.003291534253
              std dev =       0.552451315954
             le_variance =       0.305202456499


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690267064511e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 74
Check correct_vf_var_size: 225, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 3.6380e+03, overlap shift 3.6380e+04 and omega -1.7527e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.885781842100       residual = 5.66e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.885781849403       residual = 1.38e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.885781851144       residual = 5.02e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.885781851838       residual = 1.92e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.885781852231       residual = 6.86e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.885781852332       residual = 2.20e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.885781852395       residual = 7.47e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.885781852424       residual = 8.69e-06           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.885781852419       residual = 5.83e-06           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.885781852415       residual = 4.50e-06           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.885781852435       residual = 2.97e-06           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.885781852490       residual = 1.81e-06           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.885781852492       residual = 8.16e-07           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.885781852495       residual = 1.59e-07           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.885781852504       residual = 3.18e-08           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.885781852502       residual = 7.03e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         15 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 3.6380e+03 is 7.546158e-08

solving harmonic davidson linear method for identity shift 1.4552e+04, overlap shift 1.4552e+05 and omega -1.7527e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.885781842100       residual = 5.66e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.885781843926       residual = 1.38e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.885781844361       residual = 5.02e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.885781844534       residual = 1.92e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.885781844617       residual = 6.86e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.885781844678       residual = 2.20e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.885781844677       residual = 7.47e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.885781844689       residual = 8.69e-06           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.885781844686       residual = 5.83e-06           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.885781844661       residual = 4.50e-06           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.885781844691       residual = 2.97e-06           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.885781844649       residual = 1.81e-06           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.885781844704       residual = 8.16e-07           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.885781844751       residual = 1.59e-07           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.885781844706       residual = 3.18e-08           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.885781844720       residual = 7.03e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         15 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 1.4552e+04 is 1.886553e-08

solving harmonic davidson linear method for identity shift 5.8208e+04, overlap shift 5.8208e+05 and omega -1.7527e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.885781842100       residual = 5.66e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.885781842557       residual = 1.38e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.885781842666       residual = 5.02e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.885781842709       residual = 1.92e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.885781842698       residual = 6.86e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.885781842748       residual = 2.20e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.885781842738       residual = 7.47e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.885781842717       residual = 8.69e-06           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.885781842746       residual = 5.83e-06           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.885781842688       residual = 4.50e-06           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.885781842754       residual = 2.97e-06           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.885781842598       residual = 1.81e-06           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.885781842750       residual = 8.16e-07           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.885781842853       residual = 1.59e-07           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.885781842750       residual = 3.18e-08           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.885781842752       residual = 7.03e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         15 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 5.8208e+04 is 4.716393e-09

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               1.101818 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 75 and numParams is: 74

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.7628e+01
  </log>
  <optVariables href="H2O.s085.opt.xml">
ci_0001                 7.026295e-01 3 1  ON 0
ci_0002                 6.983279e-01 3 1  ON 1
ci_0003                -3.181710e-02 3 1  ON 2
ci_0004                -3.148891e-02 3 1  ON 3
ci_0005                -2.842202e-02 3 1  ON 4
ci_0006                -2.962383e-02 3 1  ON 5
ci_0007                -1.644648e-02 3 1  ON 6
ci_0008                -1.721869e-02 3 1  ON 7
ci_0009                -1.895888e-02 3 1  ON 8
ci_0010                -1.909747e-02 3 1  ON 9
ci_0011                -1.578362e-02 3 1  ON 10
ci_0012                -1.579242e-02 3 1  ON 11
ci_0013                 1.568462e-02 3 1  ON 12
ci_0014                 1.561329e-02 3 1  ON 13
ci_0015                 1.647821e-02 3 1  ON 14
ci_0016                 1.619586e-02 3 1  ON 15
ci_0017                 1.384674e-02 3 1  ON 16
ci_0018                 1.415258e-02 3 1  ON 17
ci_0019                 1.243860e-02 3 1  ON 18
ci_0020                 1.205185e-02 3 1  ON 19
ci_0021                 1.539482e-02 3 1  ON 20
ci_0022                 1.641550e-02 3 1  ON 21
ci_0023                -1.177804e-02 3 1  ON 22
ci_0024                -1.103742e-02 3 1  ON 23
ci_0025                -2.989044e-03 3 1  ON 24
ci_0026                -2.657139e-03 3 1  ON 25
ci_0027                -1.174736e-02 3 1  ON 26
ci_0028                -1.172147e-02 3 1  ON 27
ci_0029                -1.033864e-02 3 1  ON 28
ci_0030                -1.028741e-02 3 1  ON 29
ci_0031                 1.407064e-02 3 1  ON 30
ci_0032                 1.310029e-02 3 1  ON 31
ci_0033                 8.463064e-03 3 1  ON 32
ci_0034                 8.659759e-03 3 1  ON 33
ci_0035                 5.045283e-03 3 1  ON 34
ci_0036                 4.826557e-03 3 1  ON 35
ci_0037                -1.143339e-02 3 1  ON 36
ci_0038                -1.140350e-02 3 1  ON 37
ci_0039                -3.804132e-03 3 1  ON 38
ci_0040                -3.933533e-03 3 1  ON 39
ci_0041                 9.636298e-03 3 1  ON 40
ci_0042                 9.532961e-03 3 1  ON 41
ci_0043                -6.343095e-03 3 1  ON 42
ci_0044                -6.774458e-03 3 1  ON 43
ci_0045                 1.045934e-02 3 1  ON 44
ci_0046                 9.383500e-03 3 1  ON 45
ci_0047                -3.644281e-03 3 1  ON 46
ci_0048                -3.595075e-03 3 1  ON 47
ci_0049                -2.504353e-03 3 1  ON 48
ci_0050                -2.823111e-03 3 1  ON 49
ci_0051                -1.835873e-03 3 1  ON 50
ci_0052                -1.716019e-03 3 1  ON 51
ci_0053                -4.036071e-03 3 1  ON 52
ci_0054                -3.938126e-03 3 1  ON 53
ci_0055                 2.508104e-03 3 1  ON 54
ci_0056                 2.146651e-03 3 1  ON 55
ci_0057                 2.391291e-03 3 1  ON 56
ci_0058                 3.125224e-03 3 1  ON 57
ci_0059                -4.061040e-03 3 1  ON 58
ci_0060                -3.655090e-03 3 1  ON 59
ci_0061                -2.865947e-03 3 1  ON 60
ci_0062                -3.079656e-03 3 1  ON 61
ci_0063                -9.741525e-03 3 1  ON 62
ci_0064                -9.713257e-03 3 1  ON 63
ci_0065                -7.181077e-03 3 1  ON 64
ci_0066                -6.636031e-03 3 1  ON 65
ci_0067                -3.951501e-03 3 1  ON 66
ci_0068                -3.957850e-03 3 1  ON 67
ci_0069                 3.825543e-03 3 1  ON 68
ci_0070                 3.580880e-03 3 1  ON 69
ci_0071                 4.381183e-03 3 1  ON 70
ci_0072                 4.651005e-03 3 1  ON 71
ci_0073                 3.394246e-03 3 1  ON 72
ci_0074                 3.189405e-03 3 1  ON 73
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 85
    time step          = 0.05
    reference energy   = -17.1132
    reference variance = 2.51099
====================================================
  Execution time = 1.4596e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s085
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6902e+01
  VMC Evar = 3.1115e-01
  Total weights = 1.9520e+06
  Execution time = 1.9588e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.301530402488
                                         uncertainty =       0.001666014140

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.301530402488
                                         uncertainty =       0.001666014140

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000388367690
  error estimate for blocks of size 2^( 2) =       0.000402740483
  error estimate for blocks of size 2^( 3) =       0.000418063882
  error estimate for blocks of size 2^( 4) =       0.000431076242
  error estimate for blocks of size 2^( 5) =       0.000443229641
  error estimate for blocks of size 2^( 6) =       0.000452075328
  error estimate for blocks of size 2^( 7) =       0.000457277387

      target function =      -0.890739218600
              le_mean =     -16.902443318716
             les_mean =     286.003740227724
             stat err =       0.000445914650
             autocorr =       1.318309244115
   target nu stat err =       0.000445914650
   target dn stat err =       0.002280009063
      target stat err =       0.002967787972
              std dev =       0.549234854268
             le_variance =       0.301658925142

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.301530391203
                                         uncertainty =       0.001666013539

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.301530391203
                                         uncertainty =       0.001666013539

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000388367683
  error estimate for blocks of size 2^( 2) =       0.000402740479
  error estimate for blocks of size 2^( 3) =       0.000418063882
  error estimate for blocks of size 2^( 4) =       0.000431076246
  error estimate for blocks of size 2^( 5) =       0.000443229647
  error estimate for blocks of size 2^( 6) =       0.000452075336
  error estimate for blocks of size 2^( 7) =       0.000457277398

      target function =      -0.890739226868
              le_mean =     -16.902443318459
             les_mean =     286.003740212513
             stat err =       0.000445914657
             autocorr =       1.318309334440
   target nu stat err =       0.000445914657
   target dn stat err =       0.002280007409
      target stat err =       0.002967785973
              std dev =       0.549234844023
             le_variance =       0.301658913889

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.301530396845
                                         uncertainty =       0.001666013839

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.301530396845
                                         uncertainty =       0.001666013839

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000388367686
  error estimate for blocks of size 2^( 2) =       0.000402740481
  error estimate for blocks of size 2^( 3) =       0.000418063882
  error estimate for blocks of size 2^( 4) =       0.000431076244
  error estimate for blocks of size 2^( 5) =       0.000443229644
  error estimate for blocks of size 2^( 6) =       0.000452075332
  error estimate for blocks of size 2^( 7) =       0.000457277392

      target function =      -0.890739222737
              le_mean =     -16.902443318587
             les_mean =     286.003740220115
             stat err =       0.000445914653
             autocorr =       1.318309289274
   target nu stat err =       0.000445914653
   target dn stat err =       0.002280008236
      target stat err =       0.002967786972
              std dev =       0.549234849145
             le_variance =       0.301658919515

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.301530401782
                                         uncertainty =       0.001666014103

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.301530401782
                                         uncertainty =       0.001666014103

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000388367689
  error estimate for blocks of size 2^( 2) =       0.000402740483
  error estimate for blocks of size 2^( 3) =       0.000418063882
  error estimate for blocks of size 2^( 4) =       0.000431076243
  error estimate for blocks of size 2^( 5) =       0.000443229642
  error estimate for blocks of size 2^( 6) =       0.000452075329
  error estimate for blocks of size 2^( 7) =       0.000457277388

      target function =      -0.890739219117
              le_mean =     -16.902443318700
             les_mean =     286.003740226772
             stat err =       0.000445914650
             autocorr =       1.318309249759
   target nu stat err =       0.000445914650
   target dn stat err =       0.002280008960
      target stat err =       0.002967787847
              std dev =       0.549234853627
             le_variance =       0.301658924439


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.890739218600        initial
     3.6380e+03     3.6380e+04             7.5462e-08        -0.890739226868  <--
     1.4552e+04     1.4552e+05             1.8866e-08        -0.890739222737
     5.8208e+04     5.8208e+05             4.7164e-09        -0.890739219117

*****************************************************************************
Applying the update for shift_i =   3.6380e+03     and shift_s =   3.6380e+04
*****************************************************************************

  Execution time = 2.4476e+01
  </log>
  <optVariables href="H2O.s085.opt.xml">
ci_0001                 7.026294e-01 3 1  ON 0
ci_0002                 6.983279e-01 3 1  ON 1
ci_0003                -3.181708e-02 3 1  ON 2
ci_0004                -3.148888e-02 3 1  ON 3
ci_0005                -2.842198e-02 3 1  ON 4
ci_0006                -2.962380e-02 3 1  ON 5
ci_0007                -1.644646e-02 3 1  ON 6
ci_0008                -1.721863e-02 3 1  ON 7
ci_0009                -1.895887e-02 3 1  ON 8
ci_0010                -1.909747e-02 3 1  ON 9
ci_0011                -1.578361e-02 3 1  ON 10
ci_0012                -1.579241e-02 3 1  ON 11
ci_0013                 1.568461e-02 3 1  ON 12
ci_0014                 1.561327e-02 3 1  ON 13
ci_0015                 1.647820e-02 3 1  ON 14
ci_0016                 1.619585e-02 3 1  ON 15
ci_0017                 1.384672e-02 3 1  ON 16
ci_0018                 1.415257e-02 3 1  ON 17
ci_0019                 1.243859e-02 3 1  ON 18
ci_0020                 1.205185e-02 3 1  ON 19
ci_0021                 1.539483e-02 3 1  ON 20
ci_0022                 1.641549e-02 3 1  ON 21
ci_0023                -1.177804e-02 3 1  ON 22
ci_0024                -1.103743e-02 3 1  ON 23
ci_0025                -2.989036e-03 3 1  ON 24
ci_0026                -2.657139e-03 3 1  ON 25
ci_0027                -1.174735e-02 3 1  ON 26
ci_0028                -1.172146e-02 3 1  ON 27
ci_0029                -1.033864e-02 3 1  ON 28
ci_0030                -1.028740e-02 3 1  ON 29
ci_0031                 1.407063e-02 3 1  ON 30
ci_0032                 1.310028e-02 3 1  ON 31
ci_0033                 8.463042e-03 3 1  ON 32
ci_0034                 8.659737e-03 3 1  ON 33
ci_0035                 5.045258e-03 3 1  ON 34
ci_0036                 4.826568e-03 3 1  ON 35
ci_0037                -1.143338e-02 3 1  ON 36
ci_0038                -1.140351e-02 3 1  ON 37
ci_0039                -3.804123e-03 3 1  ON 38
ci_0040                -3.933527e-03 3 1  ON 39
ci_0041                 9.636287e-03 3 1  ON 40
ci_0042                 9.532954e-03 3 1  ON 41
ci_0043                -6.343090e-03 3 1  ON 42
ci_0044                -6.774436e-03 3 1  ON 43
ci_0045                 1.045933e-02 3 1  ON 44
ci_0046                 9.383508e-03 3 1  ON 45
ci_0047                -3.644267e-03 3 1  ON 46
ci_0048                -3.595065e-03 3 1  ON 47
ci_0049                -2.504340e-03 3 1  ON 48
ci_0050                -2.823113e-03 3 1  ON 49
ci_0051                -1.835868e-03 3 1  ON 50
ci_0052                -1.716010e-03 3 1  ON 51
ci_0053                -4.036073e-03 3 1  ON 52
ci_0054                -3.938130e-03 3 1  ON 53
ci_0055                 2.508102e-03 3 1  ON 54
ci_0056                 2.146634e-03 3 1  ON 55
ci_0057                 2.391280e-03 3 1  ON 56
ci_0058                 3.125211e-03 3 1  ON 57
ci_0059                -4.061038e-03 3 1  ON 58
ci_0060                -3.655087e-03 3 1  ON 59
ci_0061                -2.865950e-03 3 1  ON 60
ci_0062                -3.079646e-03 3 1  ON 61
ci_0063                -9.741524e-03 3 1  ON 62
ci_0064                -9.713259e-03 3 1  ON 63
ci_0065                -7.181074e-03 3 1  ON 64
ci_0066                -6.636016e-03 3 1  ON 65
ci_0067                -3.951506e-03 3 1  ON 66
ci_0068                -3.957852e-03 3 1  ON 67
ci_0069                 3.825531e-03 3 1  ON 68
ci_0070                 3.580874e-03 3 1  ON 69
ci_0071                 4.381185e-03 3 1  ON 70
ci_0072                 4.651015e-03 3 1  ON 71
ci_0073                 3.394233e-03 3 1  ON 72
ci_0074                 3.189411e-03 3 1  ON 73
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 4.2119e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s086 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s086 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=86  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6901e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 86
    time step          = 0.05
    reference energy   = -16.9064
    reference variance = 0.282062
====================================================
  Execution time = 1.4807e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s086
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5225e+04
  VMC Eavg = -1.6903e+01
  VMC Evar = 3.1925e-01
  Total weights = 1.951993218e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 2.6744e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.305835518164
                                         uncertainty =       0.002703689614

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.305835518164
                                         uncertainty =       0.002703689614

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000391143491
  error estimate for blocks of size 2^( 2) =       0.000406275672
  error estimate for blocks of size 2^( 3) =       0.000421727422
  error estimate for blocks of size 2^( 4) =       0.000436165189
  error estimate for blocks of size 2^( 5) =       0.000447974332
  error estimate for blocks of size 2^( 6) =       0.000457724975
  error estimate for blocks of size 2^( 7) =       0.000465331584

      target function =      -0.880641205839
              le_mean =     -16.903107473543
             les_mean =     286.034289475870
             stat err =       0.000451799020
             autocorr =       1.334192068373
   target nu stat err =       0.000451799020
   target dn stat err =       0.003622344412
      target stat err =       0.004551355123
              std dev =       0.553160429529
             le_variance =       0.305986460797


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690310747354e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 74
Check correct_vf_var_size: 225, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 9.0949e+02, overlap shift 9.0949e+03 and omega -1.7527e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.880663495581       residual = 1.69e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.880663562735       residual = 3.92e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.880663579668       residual = 7.54e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.880663584704       residual = 2.55e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.880663586589       residual = 1.60e-04           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.880663587146       residual = 6.66e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.880663587332       residual = 1.86e-05           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.880663587444       residual = 5.36e-06           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.880663587591       residual = 2.68e-06           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.880663587674       residual = 1.82e-06           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.880663587736       residual = 1.30e-06           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.880663587754       residual = 1.24e-06           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.880663587770       residual = 8.47e-07           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.880663587833       residual = 2.60e-07           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.880663587834       residual = 6.46e-08           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.880663587837       residual = 1.87e-08           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.880663587832       residual = 4.92e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         16 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 9.0949e+02 is 2.696287e-07

solving harmonic davidson linear method for identity shift 3.6380e+03, overlap shift 3.6380e+04 and omega -1.7527e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.880663495581       residual = 1.69e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.880663512371       residual = 3.92e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.880663516604       residual = 7.54e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.880663517863       residual = 2.55e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.880663518334       residual = 1.60e-04           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.880663518474       residual = 6.66e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.880663518528       residual = 1.86e-05           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.880663518555       residual = 5.36e-06           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.880663518585       residual = 2.68e-06           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.880663518611       residual = 1.82e-06           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.880663518628       residual = 1.30e-06           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.880663518625       residual = 1.24e-06           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.880663518637       residual = 8.47e-07           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.880663518646       residual = 2.59e-07           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.880663518648       residual = 6.46e-08           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.880663518645       residual = 1.87e-08           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.880663518640       residual = 4.91e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         16 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 3.6380e+03 is 6.740909e-08

solving harmonic davidson linear method for identity shift 1.4552e+04, overlap shift 1.4552e+05 and omega -1.7527e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.880663495581       residual = 1.69e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.880663499779       residual = 3.92e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.880663500837       residual = 7.54e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.880663501152       residual = 2.55e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.880663501270       residual = 1.60e-04           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.880663501305       residual = 6.66e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.880663501316       residual = 1.86e-05           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.880663501323       residual = 5.36e-06           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.880663501332       residual = 2.68e-06           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.880663501337       residual = 1.82e-06           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.880663501365       residual = 1.30e-06           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.880663501318       residual = 1.24e-06           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.880663501344       residual = 8.47e-07           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.880663501359       residual = 2.59e-07           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.880663501347       residual = 6.46e-08           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.880663501348       residual = 1.87e-08           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.880663501359       residual = 4.91e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         16 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 1.4552e+04 is 1.685239e-08

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               1.116108 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 75 and numParams is: 74

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.7504e+01
  </log>
  <optVariables href="H2O.s086.opt.xml">
ci_0001                 7.026294e-01 3 1  ON 0
ci_0002                 6.983280e-01 3 1  ON 1
ci_0003                -3.181705e-02 3 1  ON 2
ci_0004                -3.148887e-02 3 1  ON 3
ci_0005                -2.842193e-02 3 1  ON 4
ci_0006                -2.962378e-02 3 1  ON 5
ci_0007                -1.644641e-02 3 1  ON 6
ci_0008                -1.721857e-02 3 1  ON 7
ci_0009                -1.895885e-02 3 1  ON 8
ci_0010                -1.909747e-02 3 1  ON 9
ci_0011                -1.578357e-02 3 1  ON 10
ci_0012                -1.579240e-02 3 1  ON 11
ci_0013                 1.568458e-02 3 1  ON 12
ci_0014                 1.561326e-02 3 1  ON 13
ci_0015                 1.647818e-02 3 1  ON 14
ci_0016                 1.619582e-02 3 1  ON 15
ci_0017                 1.384671e-02 3 1  ON 16
ci_0018                 1.415254e-02 3 1  ON 17
ci_0019                 1.243860e-02 3 1  ON 18
ci_0020                 1.205185e-02 3 1  ON 19
ci_0021                 1.539482e-02 3 1  ON 20
ci_0022                 1.641549e-02 3 1  ON 21
ci_0023                -1.177803e-02 3 1  ON 22
ci_0024                -1.103744e-02 3 1  ON 23
ci_0025                -2.989001e-03 3 1  ON 24
ci_0026                -2.657100e-03 3 1  ON 25
ci_0027                -1.174736e-02 3 1  ON 26
ci_0028                -1.172144e-02 3 1  ON 27
ci_0029                -1.033862e-02 3 1  ON 28
ci_0030                -1.028738e-02 3 1  ON 29
ci_0031                 1.407062e-02 3 1  ON 30
ci_0032                 1.310025e-02 3 1  ON 31
ci_0033                 8.463033e-03 3 1  ON 32
ci_0034                 8.659734e-03 3 1  ON 33
ci_0035                 5.045257e-03 3 1  ON 34
ci_0036                 4.826596e-03 3 1  ON 35
ci_0037                -1.143337e-02 3 1  ON 36
ci_0038                -1.140350e-02 3 1  ON 37
ci_0039                -3.804111e-03 3 1  ON 38
ci_0040                -3.933517e-03 3 1  ON 39
ci_0041                 9.636298e-03 3 1  ON 40
ci_0042                 9.532950e-03 3 1  ON 41
ci_0043                -6.343046e-03 3 1  ON 42
ci_0044                -6.774437e-03 3 1  ON 43
ci_0045                 1.045932e-02 3 1  ON 44
ci_0046                 9.383503e-03 3 1  ON 45
ci_0047                -3.644254e-03 3 1  ON 46
ci_0048                -3.595047e-03 3 1  ON 47
ci_0049                -2.504350e-03 3 1  ON 48
ci_0050                -2.823069e-03 3 1  ON 49
ci_0051                -1.835842e-03 3 1  ON 50
ci_0052                -1.716025e-03 3 1  ON 51
ci_0053                -4.036064e-03 3 1  ON 52
ci_0054                -3.938156e-03 3 1  ON 53
ci_0055                 2.508108e-03 3 1  ON 54
ci_0056                 2.146607e-03 3 1  ON 55
ci_0057                 2.391264e-03 3 1  ON 56
ci_0058                 3.125172e-03 3 1  ON 57
ci_0059                -4.060996e-03 3 1  ON 58
ci_0060                -3.655072e-03 3 1  ON 59
ci_0061                -2.865950e-03 3 1  ON 60
ci_0062                -3.079642e-03 3 1  ON 61
ci_0063                -9.741518e-03 3 1  ON 62
ci_0064                -9.713260e-03 3 1  ON 63
ci_0065                -7.181058e-03 3 1  ON 64
ci_0066                -6.636005e-03 3 1  ON 65
ci_0067                -3.951499e-03 3 1  ON 66
ci_0068                -3.957841e-03 3 1  ON 67
ci_0069                 3.825513e-03 3 1  ON 68
ci_0070                 3.580873e-03 3 1  ON 69
ci_0071                 4.381202e-03 3 1  ON 70
ci_0072                 4.651026e-03 3 1  ON 71
ci_0073                 3.394243e-03 3 1  ON 72
ci_0074                 3.189414e-03 3 1  ON 73
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 86
    time step          = 0.05
    reference energy   = -16.9082
    reference variance = 0.367113
====================================================
  Execution time = 1.4858e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s086
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6903e+01
  VMC Evar = 3.2045e-01
  Total weights = 1.9518e+06
  Execution time = 1.9488e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.305626403914
                                         uncertainty =       0.002110076361

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.305626403914
                                         uncertainty =       0.002110076361

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000390899697
  error estimate for blocks of size 2^( 2) =       0.000405807133
  error estimate for blocks of size 2^( 3) =       0.000420746554
  error estimate for blocks of size 2^( 4) =       0.000432914382
  error estimate for blocks of size 2^( 5) =       0.000444974194
  error estimate for blocks of size 2^( 6) =       0.000452479024
  error estimate for blocks of size 2^( 7) =       0.000457028922

      target function =      -0.879166069514
              le_mean =     -16.903317940649
             les_mean =     286.042603960068
             stat err =       0.000446849131
             autocorr =       1.306745959918
   target nu stat err =       0.000446849131
   target dn stat err =       0.004588186619
      target stat err =       0.005725656991
              std dev =       0.552815653570
             le_variance =       0.305605146832

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.305626436858
                                         uncertainty =       0.002110105735

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.305626436858
                                         uncertainty =       0.002110105735

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000390899719
  error estimate for blocks of size 2^( 2) =       0.000405807168
  error estimate for blocks of size 2^( 3) =       0.000420746603
  error estimate for blocks of size 2^( 4) =       0.000432914439
  error estimate for blocks of size 2^( 5) =       0.000444974256
  error estimate for blocks of size 2^( 6) =       0.000452479092
  error estimate for blocks of size 2^( 7) =       0.000457028986

      target function =      -0.879165627665
              le_mean =     -16.903317940916
             les_mean =     286.042604321413
             stat err =       0.000446849193
             autocorr =       1.306746183028
   target nu stat err =       0.000446849193
   target dn stat err =       0.004588492892
      target stat err =       0.005726028883
              std dev =       0.552815683744
             le_variance =       0.305605180193

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.305626420383
                                         uncertainty =       0.002110091048

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.305626420383
                                         uncertainty =       0.002110091048

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000390899708
  error estimate for blocks of size 2^( 2) =       0.000405807151
  error estimate for blocks of size 2^( 3) =       0.000420746578
  error estimate for blocks of size 2^( 4) =       0.000432914411
  error estimate for blocks of size 2^( 5) =       0.000444974225
  error estimate for blocks of size 2^( 6) =       0.000452479058
  error estimate for blocks of size 2^( 7) =       0.000457028954

      target function =      -0.879165848678
              le_mean =     -16.903317940782
             les_mean =     286.042604140659
             stat err =       0.000446849162
             autocorr =       1.306746071477
   target nu stat err =       0.000446849162
   target dn stat err =       0.004588339755
      target stat err =       0.005725842938
              std dev =       0.552815668654
             le_variance =       0.305605163510

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.305626405972
                                         uncertainty =       0.002110078196

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.305626405972
                                         uncertainty =       0.002110078196

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000390899699
  error estimate for blocks of size 2^( 2) =       0.000405807136
  error estimate for blocks of size 2^( 3) =       0.000420746557
  error estimate for blocks of size 2^( 4) =       0.000432914386
  error estimate for blocks of size 2^( 5) =       0.000444974198
  error estimate for blocks of size 2^( 6) =       0.000452479028
  error estimate for blocks of size 2^( 7) =       0.000457028926

      target function =      -0.879166041920
              le_mean =     -16.903317940666
             les_mean =     286.042603982632
             stat err =       0.000446849134
             autocorr =       1.306745973866
   target nu stat err =       0.000446849134
   target dn stat err =       0.004588205760
      target stat err =       0.005725680234
              std dev =       0.552815655455
             le_variance =       0.305605148916


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.879166069514        initial  <--
     9.0949e+02     9.0949e+03             2.6963e-07        -0.879165627665
     3.6380e+03     3.6380e+04             6.7409e-08        -0.879165848678
     1.4552e+04     1.4552e+05             1.6852e-08        -0.879166041920

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 24.7149
  </log>
  <optVariables href="H2O.s086.opt.xml">
ci_0001                 7.026294e-01 3 1  ON 0
ci_0002                 6.983279e-01 3 1  ON 1
ci_0003                -3.181708e-02 3 1  ON 2
ci_0004                -3.148888e-02 3 1  ON 3
ci_0005                -2.842198e-02 3 1  ON 4
ci_0006                -2.962380e-02 3 1  ON 5
ci_0007                -1.644646e-02 3 1  ON 6
ci_0008                -1.721863e-02 3 1  ON 7
ci_0009                -1.895887e-02 3 1  ON 8
ci_0010                -1.909747e-02 3 1  ON 9
ci_0011                -1.578361e-02 3 1  ON 10
ci_0012                -1.579241e-02 3 1  ON 11
ci_0013                 1.568461e-02 3 1  ON 12
ci_0014                 1.561327e-02 3 1  ON 13
ci_0015                 1.647820e-02 3 1  ON 14
ci_0016                 1.619585e-02 3 1  ON 15
ci_0017                 1.384672e-02 3 1  ON 16
ci_0018                 1.415257e-02 3 1  ON 17
ci_0019                 1.243859e-02 3 1  ON 18
ci_0020                 1.205185e-02 3 1  ON 19
ci_0021                 1.539483e-02 3 1  ON 20
ci_0022                 1.641549e-02 3 1  ON 21
ci_0023                -1.177804e-02 3 1  ON 22
ci_0024                -1.103743e-02 3 1  ON 23
ci_0025                -2.989036e-03 3 1  ON 24
ci_0026                -2.657139e-03 3 1  ON 25
ci_0027                -1.174735e-02 3 1  ON 26
ci_0028                -1.172146e-02 3 1  ON 27
ci_0029                -1.033864e-02 3 1  ON 28
ci_0030                -1.028740e-02 3 1  ON 29
ci_0031                 1.407063e-02 3 1  ON 30
ci_0032                 1.310028e-02 3 1  ON 31
ci_0033                 8.463042e-03 3 1  ON 32
ci_0034                 8.659737e-03 3 1  ON 33
ci_0035                 5.045258e-03 3 1  ON 34
ci_0036                 4.826568e-03 3 1  ON 35
ci_0037                -1.143338e-02 3 1  ON 36
ci_0038                -1.140351e-02 3 1  ON 37
ci_0039                -3.804123e-03 3 1  ON 38
ci_0040                -3.933527e-03 3 1  ON 39
ci_0041                 9.636287e-03 3 1  ON 40
ci_0042                 9.532954e-03 3 1  ON 41
ci_0043                -6.343090e-03 3 1  ON 42
ci_0044                -6.774436e-03 3 1  ON 43
ci_0045                 1.045933e-02 3 1  ON 44
ci_0046                 9.383508e-03 3 1  ON 45
ci_0047                -3.644267e-03 3 1  ON 46
ci_0048                -3.595065e-03 3 1  ON 47
ci_0049                -2.504340e-03 3 1  ON 48
ci_0050                -2.823113e-03 3 1  ON 49
ci_0051                -1.835868e-03 3 1  ON 50
ci_0052                -1.716010e-03 3 1  ON 51
ci_0053                -4.036073e-03 3 1  ON 52
ci_0054                -3.938130e-03 3 1  ON 53
ci_0055                 2.508102e-03 3 1  ON 54
ci_0056                 2.146634e-03 3 1  ON 55
ci_0057                 2.391280e-03 3 1  ON 56
ci_0058                 3.125211e-03 3 1  ON 57
ci_0059                -4.061038e-03 3 1  ON 58
ci_0060                -3.655087e-03 3 1  ON 59
ci_0061                -2.865950e-03 3 1  ON 60
ci_0062                -3.079646e-03 3 1  ON 61
ci_0063                -9.741524e-03 3 1  ON 62
ci_0064                -9.713259e-03 3 1  ON 63
ci_0065                -7.181074e-03 3 1  ON 64
ci_0066                -6.636016e-03 3 1  ON 65
ci_0067                -3.951506e-03 3 1  ON 66
ci_0068                -3.957852e-03 3 1  ON 67
ci_0069                 3.825531e-03 3 1  ON 68
ci_0070                 3.580874e-03 3 1  ON 69
ci_0071                 4.381185e-03 3 1  ON 70
ci_0072                 4.651015e-03 3 1  ON 71
ci_0073                 3.394233e-03 3 1  ON 72
ci_0074                 3.189411e-03 3 1  ON 73
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 4.2234e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s087 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s087 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=87  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6901e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 87
    time step          = 0.05
    reference energy   = -16.8543
    reference variance = 0.485161
====================================================
  Execution time = 1.4736e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s087
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5241e+04
  VMC Eavg = -1.6903e+01
  VMC Evar = 3.1655e-01
  Total weights = 1.951316139e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 2.6733e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.306239861367
                                         uncertainty =       0.003154466604

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.306239861367
                                         uncertainty =       0.003154466604

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000391292374
  error estimate for blocks of size 2^( 2) =       0.000405563984
  error estimate for blocks of size 2^( 3) =       0.000420600227
  error estimate for blocks of size 2^( 4) =       0.000433241808
  error estimate for blocks of size 2^( 5) =       0.000443661199
  error estimate for blocks of size 2^( 6) =       0.000450180021
  error estimate for blocks of size 2^( 7) =       0.000456658423

      target function =      -0.884047990169
              le_mean =     -16.903323729877
             les_mean =     286.038898167785
             stat err =       0.000445935363
             autocorr =       1.298796350874
   target nu stat err =       0.000445935363
   target dn stat err =       0.003539543789
      target stat err =       0.004483894915
              std dev =       0.553370981590
             le_variance =       0.306219443266


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690332372988e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 74
Check correct_vf_var_size: 225, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 9.0949e+03, overlap shift 9.0949e+04 and omega -1.7527e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.884069398728       residual = 9.27e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.884069403777       residual = 8.80e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.884069404247       residual = 3.42e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.884069404537       residual = 1.59e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.884069404632       residual = 4.10e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.884069404687       residual = 1.28e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.884069404684       residual = 5.84e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.884069404701       residual = 5.43e-06           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.884069404705       residual = 5.44e-06           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.884069404688       residual = 4.51e-06           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.884069404712       residual = 2.32e-06           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.884069404713       residual = 9.33e-07           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.884069404730       residual = 3.50e-07           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.884069404739       residual = 6.98e-08           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.884069404743       residual = 1.68e-08           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.884069404673       residual = 3.72e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         15 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 9.0949e+03 is 2.683705e-08

solving harmonic davidson linear method for identity shift 3.6380e+04, overlap shift 3.6380e+05 and omega -1.7527e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.884069398728       residual = 9.27e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.884069399990       residual = 8.80e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.884069400108       residual = 3.42e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.884069400180       residual = 1.59e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.884069400171       residual = 4.10e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.884069400239       residual = 1.28e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.884069400177       residual = 5.84e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.884069400196       residual = 5.43e-06           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.884069400223       residual = 5.44e-06           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.884069400181       residual = 4.51e-06           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.884069400116       residual = 2.32e-06           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.884069400173       residual = 9.33e-07           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.884069400267       residual = 3.50e-07           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.884069400135       residual = 6.98e-08           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.884069400182       residual = 1.68e-08           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.884069400152       residual = 3.72e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         15 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 3.6380e+04 is 6.709305e-09

solving harmonic davidson linear method for identity shift 1.4552e+05, overlap shift 1.4552e+06 and omega -1.7527e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.884069398728       residual = 9.27e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.884069399044       residual = 8.80e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.884069399073       residual = 3.42e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.884069399095       residual = 1.59e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.884069399097       residual = 4.10e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.884069399100       residual = 1.28e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.884069399100       residual = 5.84e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.884069399009       residual = 5.43e-06           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.884069399072       residual = 5.44e-06           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.884069399101       residual = 4.51e-06           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.884069399102       residual = 2.32e-06           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.884069399300       residual = 9.33e-07           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.884069399307       residual = 3.50e-07           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.884069399206       residual = 6.98e-08           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.884069398966       residual = 1.68e-08           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.884069399569       residual = 3.72e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         15 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 1.4552e+05 is 1.677329e-09

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               1.129130 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 75 and numParams is: 74

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.7431e+01
  </log>
  <optVariables href="H2O.s087.opt.xml">
ci_0001                 7.026294e-01 3 1  ON 0
ci_0002                 6.983279e-01 3 1  ON 1
ci_0003                -3.181708e-02 3 1  ON 2
ci_0004                -3.148888e-02 3 1  ON 3
ci_0005                -2.842197e-02 3 1  ON 4
ci_0006                -2.962379e-02 3 1  ON 5
ci_0007                -1.644646e-02 3 1  ON 6
ci_0008                -1.721863e-02 3 1  ON 7
ci_0009                -1.895886e-02 3 1  ON 8
ci_0010                -1.909747e-02 3 1  ON 9
ci_0011                -1.578360e-02 3 1  ON 10
ci_0012                -1.579241e-02 3 1  ON 11
ci_0013                 1.568461e-02 3 1  ON 12
ci_0014                 1.561327e-02 3 1  ON 13
ci_0015                 1.647820e-02 3 1  ON 14
ci_0016                 1.619584e-02 3 1  ON 15
ci_0017                 1.384672e-02 3 1  ON 16
ci_0018                 1.415257e-02 3 1  ON 17
ci_0019                 1.243859e-02 3 1  ON 18
ci_0020                 1.205185e-02 3 1  ON 19
ci_0021                 1.539483e-02 3 1  ON 20
ci_0022                 1.641550e-02 3 1  ON 21
ci_0023                -1.177804e-02 3 1  ON 22
ci_0024                -1.103743e-02 3 1  ON 23
ci_0025                -2.989033e-03 3 1  ON 24
ci_0026                -2.657142e-03 3 1  ON 25
ci_0027                -1.174735e-02 3 1  ON 26
ci_0028                -1.172146e-02 3 1  ON 27
ci_0029                -1.033864e-02 3 1  ON 28
ci_0030                -1.028740e-02 3 1  ON 29
ci_0031                 1.407063e-02 3 1  ON 30
ci_0032                 1.310028e-02 3 1  ON 31
ci_0033                 8.463038e-03 3 1  ON 32
ci_0034                 8.659735e-03 3 1  ON 33
ci_0035                 5.045258e-03 3 1  ON 34
ci_0036                 4.826564e-03 3 1  ON 35
ci_0037                -1.143338e-02 3 1  ON 36
ci_0038                -1.140351e-02 3 1  ON 37
ci_0039                -3.804123e-03 3 1  ON 38
ci_0040                -3.933527e-03 3 1  ON 39
ci_0041                 9.636288e-03 3 1  ON 40
ci_0042                 9.532954e-03 3 1  ON 41
ci_0043                -6.343086e-03 3 1  ON 42
ci_0044                -6.774434e-03 3 1  ON 43
ci_0045                 1.045933e-02 3 1  ON 44
ci_0046                 9.383509e-03 3 1  ON 45
ci_0047                -3.644266e-03 3 1  ON 46
ci_0048                -3.595064e-03 3 1  ON 47
ci_0049                -2.504341e-03 3 1  ON 48
ci_0050                -2.823106e-03 3 1  ON 49
ci_0051                -1.835868e-03 3 1  ON 50
ci_0052                -1.716009e-03 3 1  ON 51
ci_0053                -4.036073e-03 3 1  ON 52
ci_0054                -3.938130e-03 3 1  ON 53
ci_0055                 2.508100e-03 3 1  ON 54
ci_0056                 2.146637e-03 3 1  ON 55
ci_0057                 2.391279e-03 3 1  ON 56
ci_0058                 3.125212e-03 3 1  ON 57
ci_0059                -4.061037e-03 3 1  ON 58
ci_0060                -3.655087e-03 3 1  ON 59
ci_0061                -2.865951e-03 3 1  ON 60
ci_0062                -3.079646e-03 3 1  ON 61
ci_0063                -9.741523e-03 3 1  ON 62
ci_0064                -9.713260e-03 3 1  ON 63
ci_0065                -7.181073e-03 3 1  ON 64
ci_0066                -6.636015e-03 3 1  ON 65
ci_0067                -3.951506e-03 3 1  ON 66
ci_0068                -3.957852e-03 3 1  ON 67
ci_0069                 3.825531e-03 3 1  ON 68
ci_0070                 3.580875e-03 3 1  ON 69
ci_0071                 4.381184e-03 3 1  ON 70
ci_0072                 4.651015e-03 3 1  ON 71
ci_0073                 3.394231e-03 3 1  ON 72
ci_0074                 3.189410e-03 3 1  ON 73
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 87
    time step          = 0.05
    reference energy   = -16.8739
    reference variance = 0.17244
====================================================
  Execution time = 1.4653e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s087
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6904e+01
  VMC Evar = 3.1131e-01
  Total weights = 1.9516e+06
  Execution time = 1.9562e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.301475813041
                                         uncertainty =       0.001837714035

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.301475813041
                                         uncertainty =       0.001837714035

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000388226413
  error estimate for blocks of size 2^( 2) =       0.000403212445
  error estimate for blocks of size 2^( 3) =       0.000418521284
  error estimate for blocks of size 2^( 4) =       0.000431860721
  error estimate for blocks of size 2^( 5) =       0.000443108735
  error estimate for blocks of size 2^( 6) =       0.000450456379
  error estimate for blocks of size 2^( 7) =       0.000455823338

      target function =      -0.890787430491
              le_mean =     -16.904005169683
             les_mean =     286.056697106407
             stat err =       0.000445312293
             autocorr =       1.315707071192
   target nu stat err =       0.000445312293
   target dn stat err =       0.002190503716
      target stat err =       0.002864021114
              std dev =       0.549035059173
             le_variance =       0.301439496201

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.301475812033
                                         uncertainty =       0.001837714073

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.301475812033
                                         uncertainty =       0.001837714073

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000388226413
  error estimate for blocks of size 2^( 2) =       0.000403212445
  error estimate for blocks of size 2^( 3) =       0.000418521285
  error estimate for blocks of size 2^( 4) =       0.000431860722
  error estimate for blocks of size 2^( 5) =       0.000443108737
  error estimate for blocks of size 2^( 6) =       0.000450456381
  error estimate for blocks of size 2^( 7) =       0.000455823340

      target function =      -0.890787388798
              le_mean =     -16.904005169867
             les_mean =     286.056697145333
             stat err =       0.000445312295
             autocorr =       1.315707088396
   target nu stat err =       0.000445312295
   target dn stat err =       0.002190506606
      target stat err =       0.002864024445
              std dev =       0.549035058322
             le_variance =       0.301439495267

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.301475812537
                                         uncertainty =       0.001837714054

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.301475812537
                                         uncertainty =       0.001837714054

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000388226413
  error estimate for blocks of size 2^( 2) =       0.000403212445
  error estimate for blocks of size 2^( 3) =       0.000418521285
  error estimate for blocks of size 2^( 4) =       0.000431860721
  error estimate for blocks of size 2^( 5) =       0.000443108736
  error estimate for blocks of size 2^( 6) =       0.000450456380
  error estimate for blocks of size 2^( 7) =       0.000455823339

      target function =      -0.890787409650
              le_mean =     -16.904005169775
             les_mean =     286.056697125866
             stat err =       0.000445312294
             autocorr =       1.315707079788
   target nu stat err =       0.000445312294
   target dn stat err =       0.002190505161
      target stat err =       0.002864022779
              std dev =       0.549035058748
             le_variance =       0.301439495734

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.301475812978
                                         uncertainty =       0.001837714038

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.301475812978
                                         uncertainty =       0.001837714038

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000388226413
  error estimate for blocks of size 2^( 2) =       0.000403212445
  error estimate for blocks of size 2^( 3) =       0.000418521284
  error estimate for blocks of size 2^( 4) =       0.000431860721
  error estimate for blocks of size 2^( 5) =       0.000443108735
  error estimate for blocks of size 2^( 6) =       0.000450456379
  error estimate for blocks of size 2^( 7) =       0.000455823338

      target function =      -0.890787427886
              le_mean =     -16.904005169694
             les_mean =     286.056697108839
             stat err =       0.000445312293
             autocorr =       1.315707072267
   target nu stat err =       0.000445312293
   target dn stat err =       0.002190503897
      target stat err =       0.002864021322
              std dev =       0.549035059120
             le_variance =       0.301439496143


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.890787430491        initial  <--
     9.0949e+03     9.0949e+04             2.6837e-08        -0.890787388798
     3.6380e+04     3.6380e+05             6.7093e-09        -0.890787409650
     1.4552e+05     1.4552e+06             1.6773e-09        -0.890787427886

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 27.1918
  </log>
  <optVariables href="H2O.s087.opt.xml">
ci_0001                 7.026294e-01 3 1  ON 0
ci_0002                 6.983279e-01 3 1  ON 1
ci_0003                -3.181708e-02 3 1  ON 2
ci_0004                -3.148888e-02 3 1  ON 3
ci_0005                -2.842198e-02 3 1  ON 4
ci_0006                -2.962380e-02 3 1  ON 5
ci_0007                -1.644646e-02 3 1  ON 6
ci_0008                -1.721863e-02 3 1  ON 7
ci_0009                -1.895887e-02 3 1  ON 8
ci_0010                -1.909747e-02 3 1  ON 9
ci_0011                -1.578361e-02 3 1  ON 10
ci_0012                -1.579241e-02 3 1  ON 11
ci_0013                 1.568461e-02 3 1  ON 12
ci_0014                 1.561327e-02 3 1  ON 13
ci_0015                 1.647820e-02 3 1  ON 14
ci_0016                 1.619585e-02 3 1  ON 15
ci_0017                 1.384672e-02 3 1  ON 16
ci_0018                 1.415257e-02 3 1  ON 17
ci_0019                 1.243859e-02 3 1  ON 18
ci_0020                 1.205185e-02 3 1  ON 19
ci_0021                 1.539483e-02 3 1  ON 20
ci_0022                 1.641549e-02 3 1  ON 21
ci_0023                -1.177804e-02 3 1  ON 22
ci_0024                -1.103743e-02 3 1  ON 23
ci_0025                -2.989036e-03 3 1  ON 24
ci_0026                -2.657139e-03 3 1  ON 25
ci_0027                -1.174735e-02 3 1  ON 26
ci_0028                -1.172146e-02 3 1  ON 27
ci_0029                -1.033864e-02 3 1  ON 28
ci_0030                -1.028740e-02 3 1  ON 29
ci_0031                 1.407063e-02 3 1  ON 30
ci_0032                 1.310028e-02 3 1  ON 31
ci_0033                 8.463042e-03 3 1  ON 32
ci_0034                 8.659737e-03 3 1  ON 33
ci_0035                 5.045258e-03 3 1  ON 34
ci_0036                 4.826568e-03 3 1  ON 35
ci_0037                -1.143338e-02 3 1  ON 36
ci_0038                -1.140351e-02 3 1  ON 37
ci_0039                -3.804123e-03 3 1  ON 38
ci_0040                -3.933527e-03 3 1  ON 39
ci_0041                 9.636287e-03 3 1  ON 40
ci_0042                 9.532954e-03 3 1  ON 41
ci_0043                -6.343090e-03 3 1  ON 42
ci_0044                -6.774436e-03 3 1  ON 43
ci_0045                 1.045933e-02 3 1  ON 44
ci_0046                 9.383508e-03 3 1  ON 45
ci_0047                -3.644267e-03 3 1  ON 46
ci_0048                -3.595065e-03 3 1  ON 47
ci_0049                -2.504340e-03 3 1  ON 48
ci_0050                -2.823113e-03 3 1  ON 49
ci_0051                -1.835868e-03 3 1  ON 50
ci_0052                -1.716010e-03 3 1  ON 51
ci_0053                -4.036073e-03 3 1  ON 52
ci_0054                -3.938130e-03 3 1  ON 53
ci_0055                 2.508102e-03 3 1  ON 54
ci_0056                 2.146634e-03 3 1  ON 55
ci_0057                 2.391280e-03 3 1  ON 56
ci_0058                 3.125211e-03 3 1  ON 57
ci_0059                -4.061038e-03 3 1  ON 58
ci_0060                -3.655087e-03 3 1  ON 59
ci_0061                -2.865950e-03 3 1  ON 60
ci_0062                -3.079646e-03 3 1  ON 61
ci_0063                -9.741524e-03 3 1  ON 62
ci_0064                -9.713259e-03 3 1  ON 63
ci_0065                -7.181074e-03 3 1  ON 64
ci_0066                -6.636016e-03 3 1  ON 65
ci_0067                -3.951506e-03 3 1  ON 66
ci_0068                -3.957852e-03 3 1  ON 67
ci_0069                 3.825531e-03 3 1  ON 68
ci_0070                 3.580874e-03 3 1  ON 69
ci_0071                 4.381185e-03 3 1  ON 70
ci_0072                 4.651015e-03 3 1  ON 71
ci_0073                 3.394233e-03 3 1  ON 72
ci_0074                 3.189411e-03 3 1  ON 73
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 4.4633e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s088 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s088 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=88  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6901e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 88
    time step          = 0.05
    reference energy   = -17.0202
    reference variance = 0.274309
====================================================
  Execution time = 1.4775e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s088
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5241e+04
  VMC Eavg = -1.6903e+01
  VMC Evar = 3.1886e-01
  Total weights = 1.951792948e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 2.6700e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.305544717909
                                         uncertainty =       0.002074751887

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.305544717909
                                         uncertainty =       0.002074751887

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000390899918
  error estimate for blocks of size 2^( 2) =       0.000405369621
  error estimate for blocks of size 2^( 3) =       0.000419746993
  error estimate for blocks of size 2^( 4) =       0.000432950358
  error estimate for blocks of size 2^( 5) =       0.000443784037
  error estimate for blocks of size 2^( 6) =       0.000450693496
  error estimate for blocks of size 2^( 7) =       0.000457551049

      target function =      -0.881175961987
              le_mean =     -16.903398964351
             les_mean =     286.043754493230
             stat err =       0.000446244735
             autocorr =       1.303211944646
   target nu stat err =       0.000446244735
   target dn stat err =       0.002731843782
      target stat err =       0.003462235332
              std dev =       0.552815965524
             le_variance =       0.305605491738


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690339896435e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 74
Check correct_vf_var_size: 225, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 9.0949e+04, overlap shift 9.0949e+05 and omega -1.7527e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.881188593505       residual = 1.65e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.881188594344       residual = 2.53e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.881188594438       residual = 7.48e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.881188594506       residual = 2.28e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.881188594521       residual = 1.14e-04           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.881188594534       residual = 5.34e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.881188594471       residual = 1.44e-05           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.881188594671       residual = 6.28e-06           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.881188594479       residual = 8.34e-06           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.881188594497       residual = 6.66e-06           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.881188594239       residual = 4.78e-06           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.881188594545       residual = 1.96e-06           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.881188594597       residual = 1.17e-06           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.881188594318       residual = 4.37e-07           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.881188594545       residual = 8.86e-08           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.881188594291       residual = 1.59e-08           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.881188594620       residual = 5.14e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         16 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 9.0949e+04 is 2.811089e-09

solving harmonic davidson linear method for identity shift 3.6380e+05, overlap shift 3.6380e+06 and omega -1.7527e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.881188593505       residual = 1.65e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.881188593715       residual = 2.53e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.881188593738       residual = 7.48e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.881188593673       residual = 2.28e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.881188593759       residual = 1.14e-04           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.881188594112       residual = 5.34e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.881188593936       residual = 1.44e-05           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.881188594105       residual = 6.28e-06           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.881188594709       residual = 8.34e-06           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.881188593371       residual = 6.66e-06           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.881188593259       residual = 4.78e-06           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.881188593015       residual = 1.96e-06           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.881188593159       residual = 1.17e-06           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.881188593474       residual = 4.37e-07           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.881188593765       residual = 8.86e-08           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.881188593442       residual = 1.59e-08           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.881188593765       residual = 5.14e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         16 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 3.6380e+05 is 7.027725e-10

solving harmonic davidson linear method for identity shift 1.4552e+06, overlap shift 1.4552e+07 and omega -1.7527e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.881188593505       residual = 1.65e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.881188593558       residual = 2.53e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.881188593563       residual = 7.48e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.881188593592       residual = 2.28e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.881188593569       residual = 1.14e-04           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.881188593569       residual = 5.34e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.881188590885       residual = 1.44e-05           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.881188593570       residual = 6.28e-06           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.881188592721       residual = 8.34e-06           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.881188595644       residual = 6.66e-06           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.881188593570       residual = 4.78e-06           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.881188595649       residual = 1.96e-06           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.881188594149       residual = 1.17e-06           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.881188593570       residual = 4.37e-07           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.881188593570       residual = 8.86e-08           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.881188594960       residual = 1.59e-08           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.881188594524       residual = 5.14e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         16 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 1.4552e+06 is 1.756932e-10

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               1.138063 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 75 and numParams is: 74

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.7459e+01
  </log>
  <optVariables href="H2O.s088.opt.xml">
ci_0001                 7.026294e-01 3 1  ON 0
ci_0002                 6.983279e-01 3 1  ON 1
ci_0003                -3.181708e-02 3 1  ON 2
ci_0004                -3.148888e-02 3 1  ON 3
ci_0005                -2.842198e-02 3 1  ON 4
ci_0006                -2.962380e-02 3 1  ON 5
ci_0007                -1.644646e-02 3 1  ON 6
ci_0008                -1.721863e-02 3 1  ON 7
ci_0009                -1.895887e-02 3 1  ON 8
ci_0010                -1.909747e-02 3 1  ON 9
ci_0011                -1.578361e-02 3 1  ON 10
ci_0012                -1.579241e-02 3 1  ON 11
ci_0013                 1.568461e-02 3 1  ON 12
ci_0014                 1.561327e-02 3 1  ON 13
ci_0015                 1.647820e-02 3 1  ON 14
ci_0016                 1.619585e-02 3 1  ON 15
ci_0017                 1.384672e-02 3 1  ON 16
ci_0018                 1.415257e-02 3 1  ON 17
ci_0019                 1.243859e-02 3 1  ON 18
ci_0020                 1.205185e-02 3 1  ON 19
ci_0021                 1.539483e-02 3 1  ON 20
ci_0022                 1.641549e-02 3 1  ON 21
ci_0023                -1.177804e-02 3 1  ON 22
ci_0024                -1.103743e-02 3 1  ON 23
ci_0025                -2.989036e-03 3 1  ON 24
ci_0026                -2.657138e-03 3 1  ON 25
ci_0027                -1.174735e-02 3 1  ON 26
ci_0028                -1.172146e-02 3 1  ON 27
ci_0029                -1.033864e-02 3 1  ON 28
ci_0030                -1.028740e-02 3 1  ON 29
ci_0031                 1.407063e-02 3 1  ON 30
ci_0032                 1.310028e-02 3 1  ON 31
ci_0033                 8.463042e-03 3 1  ON 32
ci_0034                 8.659737e-03 3 1  ON 33
ci_0035                 5.045258e-03 3 1  ON 34
ci_0036                 4.826568e-03 3 1  ON 35
ci_0037                -1.143338e-02 3 1  ON 36
ci_0038                -1.140351e-02 3 1  ON 37
ci_0039                -3.804123e-03 3 1  ON 38
ci_0040                -3.933527e-03 3 1  ON 39
ci_0041                 9.636287e-03 3 1  ON 40
ci_0042                 9.532954e-03 3 1  ON 41
ci_0043                -6.343090e-03 3 1  ON 42
ci_0044                -6.774436e-03 3 1  ON 43
ci_0045                 1.045933e-02 3 1  ON 44
ci_0046                 9.383508e-03 3 1  ON 45
ci_0047                -3.644267e-03 3 1  ON 46
ci_0048                -3.595065e-03 3 1  ON 47
ci_0049                -2.504341e-03 3 1  ON 48
ci_0050                -2.823112e-03 3 1  ON 49
ci_0051                -1.835867e-03 3 1  ON 50
ci_0052                -1.716010e-03 3 1  ON 51
ci_0053                -4.036072e-03 3 1  ON 52
ci_0054                -3.938130e-03 3 1  ON 53
ci_0055                 2.508102e-03 3 1  ON 54
ci_0056                 2.146634e-03 3 1  ON 55
ci_0057                 2.391280e-03 3 1  ON 56
ci_0058                 3.125212e-03 3 1  ON 57
ci_0059                -4.061038e-03 3 1  ON 58
ci_0060                -3.655087e-03 3 1  ON 59
ci_0061                -2.865950e-03 3 1  ON 60
ci_0062                -3.079646e-03 3 1  ON 61
ci_0063                -9.741523e-03 3 1  ON 62
ci_0064                -9.713259e-03 3 1  ON 63
ci_0065                -7.181074e-03 3 1  ON 64
ci_0066                -6.636016e-03 3 1  ON 65
ci_0067                -3.951506e-03 3 1  ON 66
ci_0068                -3.957851e-03 3 1  ON 67
ci_0069                 3.825531e-03 3 1  ON 68
ci_0070                 3.580874e-03 3 1  ON 69
ci_0071                 4.381185e-03 3 1  ON 70
ci_0072                 4.651015e-03 3 1  ON 71
ci_0073                 3.394233e-03 3 1  ON 72
ci_0074                 3.189411e-03 3 1  ON 73
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 88
    time step          = 0.05
    reference energy   = -16.8912
    reference variance = 0.219428
====================================================
  Execution time = 1.4041e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s088
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6903e+01
  VMC Evar = 3.1364e-01
  Total weights = 1.9517e+06
  Execution time = 1.8916e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.303591493199
                                         uncertainty =       0.002048991134

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.303591493199
                                         uncertainty =       0.002048991134

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000389630137
  error estimate for blocks of size 2^( 2) =       0.000404430243
  error estimate for blocks of size 2^( 3) =       0.000419675212
  error estimate for blocks of size 2^( 4) =       0.000432946624
  error estimate for blocks of size 2^( 5) =       0.000442914207
  error estimate for blocks of size 2^( 6) =       0.000451077117
  error estimate for blocks of size 2^( 7) =       0.000455453520

      target function =      -0.887742286287
              le_mean =     -16.903481015637
             les_mean =     286.041306670987
             stat err =       0.000445597867
             autocorr =       1.307919826354
   target nu stat err =       0.000445597867
   target dn stat err =       0.002859581090
      target stat err =       0.003672504491
              std dev =       0.551020224622
             le_variance =       0.303623287942

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.303591492906
                                         uncertainty =       0.002048991210

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.303591492906
                                         uncertainty =       0.002048991210

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000389630137
  error estimate for blocks of size 2^( 2) =       0.000404430243
  error estimate for blocks of size 2^( 3) =       0.000419675212
  error estimate for blocks of size 2^( 4) =       0.000432946624
  error estimate for blocks of size 2^( 5) =       0.000442914208
  error estimate for blocks of size 2^( 6) =       0.000451077117
  error estimate for blocks of size 2^( 7) =       0.000455453520

      target function =      -0.887742285297
              le_mean =     -16.903481015601
             les_mean =     286.041306670537
             stat err =       0.000445597867
             autocorr =       1.307919830198
   target nu stat err =       0.000445597867
   target dn stat err =       0.002859580757
      target stat err =       0.003672504068
              std dev =       0.551020224355
             le_variance =       0.303623287649

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.303591493052
                                         uncertainty =       0.002048991172

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.303591493052
                                         uncertainty =       0.002048991172

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000389630137
  error estimate for blocks of size 2^( 2) =       0.000404430243
  error estimate for blocks of size 2^( 3) =       0.000419675212
  error estimate for blocks of size 2^( 4) =       0.000432946624
  error estimate for blocks of size 2^( 5) =       0.000442914208
  error estimate for blocks of size 2^( 6) =       0.000451077117
  error estimate for blocks of size 2^( 7) =       0.000455453520

      target function =      -0.887742285792
              le_mean =     -16.903481015619
             les_mean =     286.041306670762
             stat err =       0.000445597867
             autocorr =       1.307919828269
   target nu stat err =       0.000445597867
   target dn stat err =       0.002859580924
      target stat err =       0.003672504279
              std dev =       0.551020224488
             le_variance =       0.303623287795

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.303591493181
                                         uncertainty =       0.002048991139

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.303591493181
                                         uncertainty =       0.002048991139

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000389630137
  error estimate for blocks of size 2^( 2) =       0.000404430243
  error estimate for blocks of size 2^( 3) =       0.000419675212
  error estimate for blocks of size 2^( 4) =       0.000432946624
  error estimate for blocks of size 2^( 5) =       0.000442914207
  error estimate for blocks of size 2^( 6) =       0.000451077117
  error estimate for blocks of size 2^( 7) =       0.000455453520

      target function =      -0.887742286225
              le_mean =     -16.903481015635
             les_mean =     286.041306670959
             stat err =       0.000445597867
             autocorr =       1.307919826591
   target nu stat err =       0.000445597867
   target dn stat err =       0.002859581069
      target stat err =       0.003672504464
              std dev =       0.551020224605
             le_variance =       0.303623287924


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.887742286287        initial  <--
     9.0949e+04     9.0949e+05             2.8111e-09        -0.887742285297
     3.6380e+05     3.6380e+06             7.0277e-10        -0.887742285792
     1.4552e+06     1.4552e+07             1.7569e-10        -0.887742286225

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 23.5789
  </log>
  <optVariables href="H2O.s088.opt.xml">
ci_0001                 7.026294e-01 3 1  ON 0
ci_0002                 6.983279e-01 3 1  ON 1
ci_0003                -3.181708e-02 3 1  ON 2
ci_0004                -3.148888e-02 3 1  ON 3
ci_0005                -2.842198e-02 3 1  ON 4
ci_0006                -2.962380e-02 3 1  ON 5
ci_0007                -1.644646e-02 3 1  ON 6
ci_0008                -1.721863e-02 3 1  ON 7
ci_0009                -1.895887e-02 3 1  ON 8
ci_0010                -1.909747e-02 3 1  ON 9
ci_0011                -1.578361e-02 3 1  ON 10
ci_0012                -1.579241e-02 3 1  ON 11
ci_0013                 1.568461e-02 3 1  ON 12
ci_0014                 1.561327e-02 3 1  ON 13
ci_0015                 1.647820e-02 3 1  ON 14
ci_0016                 1.619585e-02 3 1  ON 15
ci_0017                 1.384672e-02 3 1  ON 16
ci_0018                 1.415257e-02 3 1  ON 17
ci_0019                 1.243859e-02 3 1  ON 18
ci_0020                 1.205185e-02 3 1  ON 19
ci_0021                 1.539483e-02 3 1  ON 20
ci_0022                 1.641549e-02 3 1  ON 21
ci_0023                -1.177804e-02 3 1  ON 22
ci_0024                -1.103743e-02 3 1  ON 23
ci_0025                -2.989036e-03 3 1  ON 24
ci_0026                -2.657139e-03 3 1  ON 25
ci_0027                -1.174735e-02 3 1  ON 26
ci_0028                -1.172146e-02 3 1  ON 27
ci_0029                -1.033864e-02 3 1  ON 28
ci_0030                -1.028740e-02 3 1  ON 29
ci_0031                 1.407063e-02 3 1  ON 30
ci_0032                 1.310028e-02 3 1  ON 31
ci_0033                 8.463042e-03 3 1  ON 32
ci_0034                 8.659737e-03 3 1  ON 33
ci_0035                 5.045258e-03 3 1  ON 34
ci_0036                 4.826568e-03 3 1  ON 35
ci_0037                -1.143338e-02 3 1  ON 36
ci_0038                -1.140351e-02 3 1  ON 37
ci_0039                -3.804123e-03 3 1  ON 38
ci_0040                -3.933527e-03 3 1  ON 39
ci_0041                 9.636287e-03 3 1  ON 40
ci_0042                 9.532954e-03 3 1  ON 41
ci_0043                -6.343090e-03 3 1  ON 42
ci_0044                -6.774436e-03 3 1  ON 43
ci_0045                 1.045933e-02 3 1  ON 44
ci_0046                 9.383508e-03 3 1  ON 45
ci_0047                -3.644267e-03 3 1  ON 46
ci_0048                -3.595065e-03 3 1  ON 47
ci_0049                -2.504340e-03 3 1  ON 48
ci_0050                -2.823113e-03 3 1  ON 49
ci_0051                -1.835868e-03 3 1  ON 50
ci_0052                -1.716010e-03 3 1  ON 51
ci_0053                -4.036073e-03 3 1  ON 52
ci_0054                -3.938130e-03 3 1  ON 53
ci_0055                 2.508102e-03 3 1  ON 54
ci_0056                 2.146634e-03 3 1  ON 55
ci_0057                 2.391280e-03 3 1  ON 56
ci_0058                 3.125211e-03 3 1  ON 57
ci_0059                -4.061038e-03 3 1  ON 58
ci_0060                -3.655087e-03 3 1  ON 59
ci_0061                -2.865950e-03 3 1  ON 60
ci_0062                -3.079646e-03 3 1  ON 61
ci_0063                -9.741524e-03 3 1  ON 62
ci_0064                -9.713259e-03 3 1  ON 63
ci_0065                -7.181074e-03 3 1  ON 64
ci_0066                -6.636016e-03 3 1  ON 65
ci_0067                -3.951506e-03 3 1  ON 66
ci_0068                -3.957852e-03 3 1  ON 67
ci_0069                 3.825531e-03 3 1  ON 68
ci_0070                 3.580874e-03 3 1  ON 69
ci_0071                 4.381185e-03 3 1  ON 70
ci_0072                 4.651015e-03 3 1  ON 71
ci_0073                 3.394233e-03 3 1  ON 72
ci_0074                 3.189411e-03 3 1  ON 73
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 4.1043e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s089 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s089 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=89  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6901e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 89
    time step          = 0.05
    reference energy   = -16.915
    reference variance = 0.196169
====================================================
  Execution time = 1.4418e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s089
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5243e+04
  VMC Eavg = -1.6903e+01
  VMC Evar = 3.2353e-01
  Total weights = 1.951896200e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 2.6409e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.310675180128
                                         uncertainty =       0.002940103223

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.310675180128
                                         uncertainty =       0.002940103223

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000394129167
  error estimate for blocks of size 2^( 2) =       0.000408699827
  error estimate for blocks of size 2^( 3) =       0.000423268383
  error estimate for blocks of size 2^( 4) =       0.000436104003
  error estimate for blocks of size 2^( 5) =       0.000447572140
  error estimate for blocks of size 2^( 6) =       0.000453912755
  error estimate for blocks of size 2^( 7) =       0.000458662618

      target function =      -0.875303498402
              le_mean =     -16.902803463661
             les_mean =     286.028297472467
             stat err =       0.000449062879
             autocorr =       1.298186717453
   target nu stat err =       0.000449062879
   target dn stat err =       0.003585260065
      target stat err =       0.004449055327
              std dev =       0.557382813596
             le_variance =       0.310675600892


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690280346366e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 74
Check correct_vf_var_size: 225, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 9.0949e+05, overlap shift 9.0949e+06 and omega -1.7527e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.875325155519       residual = 1.32e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.875325155583       residual = 1.43e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.875325155595       residual = 5.80e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.875325155599       residual = 2.99e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.875325155600       residual = 8.92e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.875325153963       residual = 2.72e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.875325155597       residual = 7.65e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.875325157334       residual = 3.65e-06           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.875325156313       residual = 1.35e-06           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.875325155968       residual = 3.57e-07           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.875325158741       residual = 8.39e-08           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.875325154215       residual = 1.47e-08           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.875325154412       residual = 3.96e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         12 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 9.0949e+05 is 2.861956e-10

solving harmonic davidson linear method for identity shift 3.6380e+06, overlap shift 3.6380e+07 and omega -1.7527e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.875325155519       residual = 1.32e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.875325155535       residual = 1.43e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.875325155538       residual = 5.80e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.875325155683       residual = 2.99e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.875325157085       residual = 8.92e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.875325156134       residual = 2.72e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.875325155539       residual = 7.65e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.875325150273       residual = 3.65e-06           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.875325156758       residual = 1.35e-06           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.875325151349       residual = 3.57e-07           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.875325160551       residual = 8.39e-08           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.875325159041       residual = 1.47e-08           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.875325157035       residual = 3.97e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         12 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 3.6380e+06 is 7.154903e-11

solving harmonic davidson linear method for identity shift 1.4552e+07, overlap shift 1.4552e+08 and omega -1.7527e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.875325155519       residual = 1.32e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.875325155523       residual = 1.43e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.875325155524       residual = 5.80e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.875325155558       residual = 2.99e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.875325153856       residual = 8.92e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.875325155524       residual = 2.72e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.875325142540       residual = 7.65e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.875325179304       residual = 3.65e-06           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.875325146767       residual = 1.35e-06           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.875325155524       residual = 3.57e-07           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.875325161019       residual = 8.39e-08           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.875325170302       residual = 1.47e-08           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.875325160087       residual = 3.97e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         12 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 1.4552e+07 is 1.788696e-11

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               1.143416 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 75 and numParams is: 74

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.7070e+01
  </log>
  <optVariables href="H2O.s089.opt.xml">
ci_0001                 7.026294e-01 3 1  ON 0
ci_0002                 6.983279e-01 3 1  ON 1
ci_0003                -3.181708e-02 3 1  ON 2
ci_0004                -3.148888e-02 3 1  ON 3
ci_0005                -2.842198e-02 3 1  ON 4
ci_0006                -2.962380e-02 3 1  ON 5
ci_0007                -1.644646e-02 3 1  ON 6
ci_0008                -1.721863e-02 3 1  ON 7
ci_0009                -1.895887e-02 3 1  ON 8
ci_0010                -1.909747e-02 3 1  ON 9
ci_0011                -1.578361e-02 3 1  ON 10
ci_0012                -1.579241e-02 3 1  ON 11
ci_0013                 1.568461e-02 3 1  ON 12
ci_0014                 1.561327e-02 3 1  ON 13
ci_0015                 1.647820e-02 3 1  ON 14
ci_0016                 1.619585e-02 3 1  ON 15
ci_0017                 1.384672e-02 3 1  ON 16
ci_0018                 1.415257e-02 3 1  ON 17
ci_0019                 1.243859e-02 3 1  ON 18
ci_0020                 1.205185e-02 3 1  ON 19
ci_0021                 1.539483e-02 3 1  ON 20
ci_0022                 1.641549e-02 3 1  ON 21
ci_0023                -1.177804e-02 3 1  ON 22
ci_0024                -1.103743e-02 3 1  ON 23
ci_0025                -2.989036e-03 3 1  ON 24
ci_0026                -2.657139e-03 3 1  ON 25
ci_0027                -1.174735e-02 3 1  ON 26
ci_0028                -1.172146e-02 3 1  ON 27
ci_0029                -1.033864e-02 3 1  ON 28
ci_0030                -1.028740e-02 3 1  ON 29
ci_0031                 1.407063e-02 3 1  ON 30
ci_0032                 1.310028e-02 3 1  ON 31
ci_0033                 8.463042e-03 3 1  ON 32
ci_0034                 8.659737e-03 3 1  ON 33
ci_0035                 5.045258e-03 3 1  ON 34
ci_0036                 4.826568e-03 3 1  ON 35
ci_0037                -1.143338e-02 3 1  ON 36
ci_0038                -1.140351e-02 3 1  ON 37
ci_0039                -3.804123e-03 3 1  ON 38
ci_0040                -3.933527e-03 3 1  ON 39
ci_0041                 9.636287e-03 3 1  ON 40
ci_0042                 9.532954e-03 3 1  ON 41
ci_0043                -6.343090e-03 3 1  ON 42
ci_0044                -6.774436e-03 3 1  ON 43
ci_0045                 1.045933e-02 3 1  ON 44
ci_0046                 9.383508e-03 3 1  ON 45
ci_0047                -3.644267e-03 3 1  ON 46
ci_0048                -3.595065e-03 3 1  ON 47
ci_0049                -2.504340e-03 3 1  ON 48
ci_0050                -2.823113e-03 3 1  ON 49
ci_0051                -1.835868e-03 3 1  ON 50
ci_0052                -1.716010e-03 3 1  ON 51
ci_0053                -4.036073e-03 3 1  ON 52
ci_0054                -3.938130e-03 3 1  ON 53
ci_0055                 2.508102e-03 3 1  ON 54
ci_0056                 2.146634e-03 3 1  ON 55
ci_0057                 2.391280e-03 3 1  ON 56
ci_0058                 3.125211e-03 3 1  ON 57
ci_0059                -4.061038e-03 3 1  ON 58
ci_0060                -3.655087e-03 3 1  ON 59
ci_0061                -2.865950e-03 3 1  ON 60
ci_0062                -3.079646e-03 3 1  ON 61
ci_0063                -9.741524e-03 3 1  ON 62
ci_0064                -9.713259e-03 3 1  ON 63
ci_0065                -7.181074e-03 3 1  ON 64
ci_0066                -6.636016e-03 3 1  ON 65
ci_0067                -3.951506e-03 3 1  ON 66
ci_0068                -3.957852e-03 3 1  ON 67
ci_0069                 3.825531e-03 3 1  ON 68
ci_0070                 3.580874e-03 3 1  ON 69
ci_0071                 4.381185e-03 3 1  ON 70
ci_0072                 4.651015e-03 3 1  ON 71
ci_0073                 3.394233e-03 3 1  ON 72
ci_0074                 3.189411e-03 3 1  ON 73
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 89
    time step          = 0.05
    reference energy   = -16.9032
    reference variance = 0.264351
====================================================
  Execution time = 1.4061e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s089
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6904e+01
  VMC Evar = 3.2096e-01
  Total weights = 1.9516e+06
  Execution time = 1.8952e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.304848836807
                                         uncertainty =       0.001959314929

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.304848836807
                                         uncertainty =       0.001959314929

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000390371282
  error estimate for blocks of size 2^( 2) =       0.000405013485
  error estimate for blocks of size 2^( 3) =       0.000420298378
  error estimate for blocks of size 2^( 4) =       0.000433565166
  error estimate for blocks of size 2^( 5) =       0.000446064299
  error estimate for blocks of size 2^( 6) =       0.000454668162
  error estimate for blocks of size 2^( 7) =       0.000458301593

      target function =      -0.878598160040
              le_mean =     -16.903746800528
             les_mean =     286.057611331722
             stat err =       0.000448149805
             autocorr =       1.317925013358
   target nu stat err =       0.000448149805
   target dn stat err =       0.004237606806
      target stat err =       0.005290722097
              std dev =       0.552068361821
             le_variance =       0.304779476124

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.304848836821
                                         uncertainty =       0.001959314932

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.304848836821
                                         uncertainty =       0.001959314932

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000390371282
  error estimate for blocks of size 2^( 2) =       0.000405013485
  error estimate for blocks of size 2^( 3) =       0.000420298378
  error estimate for blocks of size 2^( 4) =       0.000433565166
  error estimate for blocks of size 2^( 5) =       0.000446064299
  error estimate for blocks of size 2^( 6) =       0.000454668162
  error estimate for blocks of size 2^( 7) =       0.000458301593

      target function =      -0.878598159531
              le_mean =     -16.903746800528
             les_mean =     286.057611332141
             stat err =       0.000448149805
             autocorr =       1.317925013678
   target nu stat err =       0.000448149805
   target dn stat err =       0.004237606904
      target stat err =       0.005290722210
              std dev =       0.552068361834
             le_variance =       0.304779476139

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.304848836814
                                         uncertainty =       0.001959314930

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.304848836814
                                         uncertainty =       0.001959314930

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000390371282
  error estimate for blocks of size 2^( 2) =       0.000405013485
  error estimate for blocks of size 2^( 3) =       0.000420298378
  error estimate for blocks of size 2^( 4) =       0.000433565166
  error estimate for blocks of size 2^( 5) =       0.000446064299
  error estimate for blocks of size 2^( 6) =       0.000454668162
  error estimate for blocks of size 2^( 7) =       0.000458301593

      target function =      -0.878598159786
              le_mean =     -16.903746800528
             les_mean =     286.057611331931
             stat err =       0.000448149805
             autocorr =       1.317925013515
   target nu stat err =       0.000448149805
   target dn stat err =       0.004237606855
      target stat err =       0.005290722154
              std dev =       0.552068361828
             le_variance =       0.304779476131

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.304848836808
                                         uncertainty =       0.001959314929

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.304848836808
                                         uncertainty =       0.001959314929

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000390371282
  error estimate for blocks of size 2^( 2) =       0.000405013485
  error estimate for blocks of size 2^( 3) =       0.000420298378
  error estimate for blocks of size 2^( 4) =       0.000433565166
  error estimate for blocks of size 2^( 5) =       0.000446064299
  error estimate for blocks of size 2^( 6) =       0.000454668162
  error estimate for blocks of size 2^( 7) =       0.000458301593

      target function =      -0.878598160009
              le_mean =     -16.903746800528
             les_mean =     286.057611331748
             stat err =       0.000448149805
             autocorr =       1.317925013370
   target nu stat err =       0.000448149805
   target dn stat err =       0.004237606812
      target stat err =       0.005290722104
              std dev =       0.552068361822
             le_variance =       0.304779476125


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.878598160040        initial  <--
     9.0949e+05     9.0949e+06             2.8620e-10        -0.878598159531
     3.6380e+06     3.6380e+07             7.1549e-11        -0.878598159786
     1.4552e+07     1.4552e+08             1.7887e-11        -0.878598160009

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 23.6228
  </log>
  <optVariables href="H2O.s089.opt.xml">
ci_0001                 7.026294e-01 3 1  ON 0
ci_0002                 6.983279e-01 3 1  ON 1
ci_0003                -3.181708e-02 3 1  ON 2
ci_0004                -3.148888e-02 3 1  ON 3
ci_0005                -2.842198e-02 3 1  ON 4
ci_0006                -2.962380e-02 3 1  ON 5
ci_0007                -1.644646e-02 3 1  ON 6
ci_0008                -1.721863e-02 3 1  ON 7
ci_0009                -1.895887e-02 3 1  ON 8
ci_0010                -1.909747e-02 3 1  ON 9
ci_0011                -1.578361e-02 3 1  ON 10
ci_0012                -1.579241e-02 3 1  ON 11
ci_0013                 1.568461e-02 3 1  ON 12
ci_0014                 1.561327e-02 3 1  ON 13
ci_0015                 1.647820e-02 3 1  ON 14
ci_0016                 1.619585e-02 3 1  ON 15
ci_0017                 1.384672e-02 3 1  ON 16
ci_0018                 1.415257e-02 3 1  ON 17
ci_0019                 1.243859e-02 3 1  ON 18
ci_0020                 1.205185e-02 3 1  ON 19
ci_0021                 1.539483e-02 3 1  ON 20
ci_0022                 1.641549e-02 3 1  ON 21
ci_0023                -1.177804e-02 3 1  ON 22
ci_0024                -1.103743e-02 3 1  ON 23
ci_0025                -2.989036e-03 3 1  ON 24
ci_0026                -2.657139e-03 3 1  ON 25
ci_0027                -1.174735e-02 3 1  ON 26
ci_0028                -1.172146e-02 3 1  ON 27
ci_0029                -1.033864e-02 3 1  ON 28
ci_0030                -1.028740e-02 3 1  ON 29
ci_0031                 1.407063e-02 3 1  ON 30
ci_0032                 1.310028e-02 3 1  ON 31
ci_0033                 8.463042e-03 3 1  ON 32
ci_0034                 8.659737e-03 3 1  ON 33
ci_0035                 5.045258e-03 3 1  ON 34
ci_0036                 4.826568e-03 3 1  ON 35
ci_0037                -1.143338e-02 3 1  ON 36
ci_0038                -1.140351e-02 3 1  ON 37
ci_0039                -3.804123e-03 3 1  ON 38
ci_0040                -3.933527e-03 3 1  ON 39
ci_0041                 9.636287e-03 3 1  ON 40
ci_0042                 9.532954e-03 3 1  ON 41
ci_0043                -6.343090e-03 3 1  ON 42
ci_0044                -6.774436e-03 3 1  ON 43
ci_0045                 1.045933e-02 3 1  ON 44
ci_0046                 9.383508e-03 3 1  ON 45
ci_0047                -3.644267e-03 3 1  ON 46
ci_0048                -3.595065e-03 3 1  ON 47
ci_0049                -2.504340e-03 3 1  ON 48
ci_0050                -2.823113e-03 3 1  ON 49
ci_0051                -1.835868e-03 3 1  ON 50
ci_0052                -1.716010e-03 3 1  ON 51
ci_0053                -4.036073e-03 3 1  ON 52
ci_0054                -3.938130e-03 3 1  ON 53
ci_0055                 2.508102e-03 3 1  ON 54
ci_0056                 2.146634e-03 3 1  ON 55
ci_0057                 2.391280e-03 3 1  ON 56
ci_0058                 3.125211e-03 3 1  ON 57
ci_0059                -4.061038e-03 3 1  ON 58
ci_0060                -3.655087e-03 3 1  ON 59
ci_0061                -2.865950e-03 3 1  ON 60
ci_0062                -3.079646e-03 3 1  ON 61
ci_0063                -9.741524e-03 3 1  ON 62
ci_0064                -9.713259e-03 3 1  ON 63
ci_0065                -7.181074e-03 3 1  ON 64
ci_0066                -6.636016e-03 3 1  ON 65
ci_0067                -3.951506e-03 3 1  ON 66
ci_0068                -3.957852e-03 3 1  ON 67
ci_0069                 3.825531e-03 3 1  ON 68
ci_0070                 3.580874e-03 3 1  ON 69
ci_0071                 4.381185e-03 3 1  ON 70
ci_0072                 4.651015e-03 3 1  ON 71
ci_0073                 3.394233e-03 3 1  ON 72
ci_0074                 3.189411e-03 3 1  ON 73
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 4.0698e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s090 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s090 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=90  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6902e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 90
    time step          = 0.05
    reference energy   = -16.8708
    reference variance = 0.189729
====================================================
  Execution time = 1.4413e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s090
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5245e+04
  VMC Eavg = -1.6903e+01
  VMC Evar = 3.1782e-01
  Total weights = 1.952278655e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 2.5892e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.304567318878
                                         uncertainty =       0.001908139888

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.304567318878
                                         uncertainty =       0.001908139888

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000390199603
  error estimate for blocks of size 2^( 2) =       0.000404711386
  error estimate for blocks of size 2^( 3) =       0.000418919427
  error estimate for blocks of size 2^( 4) =       0.000431530669
  error estimate for blocks of size 2^( 5) =       0.000441952934
  error estimate for blocks of size 2^( 6) =       0.000449900073
  error estimate for blocks of size 2^( 7) =       0.000455491885

      target function =      -0.882464744930
              le_mean =     -16.903423814499
             les_mean =     286.043561523018
             stat err =       0.000444718890
             autocorr =       1.298965176379
   target nu stat err =       0.000444718890
   target dn stat err =       0.003116124143
      target stat err =       0.003945243204
              std dev =       0.551825570551
             le_variance =       0.304511460314


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690342381450e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 74
Check correct_vf_var_size: 225, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 9.0949e+06, overlap shift 9.0949e+07 and omega -1.7527e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.882481353856       residual = 1.95e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.882481353863       residual = 1.76e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.882481353864       residual = 5.54e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.882481353867       residual = 2.13e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.882481353972       residual = 6.31e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.882481354012       residual = 3.79e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.882481353722       residual = 1.53e-05           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.882481352154       residual = 1.46e-05           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.882481358364       residual = 1.83e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.882481347299       residual = 1.29e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.882481366512       residual = 6.05e-06           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.882481346757       residual = 2.38e-06           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.882481350973       residual = 9.38e-07           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.882481351406       residual = 3.08e-07           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.882481344431       residual = 7.61e-08           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.882481375069       residual = 1.56e-08           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.882481354664       residual = 4.40e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         16 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 9.0949e+06 is 3.008084e-11

solving harmonic davidson linear method for identity shift 3.6380e+07, overlap shift 3.6380e+08 and omega -1.7527e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.882481353856       residual = 1.95e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.882481353858       residual = 1.76e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.882481353858       residual = 5.54e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.882481356437       residual = 2.13e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.882481338860       residual = 6.31e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.882481315648       residual = 3.79e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.882481387293       residual = 1.53e-05           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.882481373480       residual = 1.46e-05           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.882481284454       residual = 1.83e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.882481423539       residual = 1.29e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.882481288430       residual = 6.05e-06           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.882481290536       residual = 2.38e-06           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.882481369434       residual = 9.38e-07           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.882481301791       residual = 3.08e-07           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.882481412990       residual = 7.61e-08           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.882481278547       residual = 1.55e-08           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.882481271246       residual = 4.38e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         16 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 3.6380e+07 is 7.520290e-12

solving harmonic davidson linear method for identity shift 1.4552e+08, overlap shift 1.4552e+09 and omega -1.7527e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.882481353856       residual = 1.95e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.882481353856       residual = 1.76e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.882481353856       residual = 5.54e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.882481353856       residual = 2.13e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.882481353856       residual = 6.31e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.882481363976       residual = 3.79e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.882481134401       residual = 1.53e-05           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.882481451076       residual = 1.46e-05           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.882481416843       residual = 1.83e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.882481311939       residual = 1.29e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.882481247199       residual = 6.05e-06           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.882481500352       residual = 2.38e-06           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.882481205527       residual = 9.38e-07           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.882481507485       residual = 3.08e-07           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.882481738529       residual = 7.61e-08           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.882481239205       residual = 1.56e-08           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.882481041014       residual = 4.37e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         16 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 1.4552e+08 is 1.879951e-12

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               1.152333 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 75 and numParams is: 74

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.7017e+01
  </log>
  <optVariables href="H2O.s090.opt.xml">
ci_0001                 7.026294e-01 3 1  ON 0
ci_0002                 6.983279e-01 3 1  ON 1
ci_0003                -3.181708e-02 3 1  ON 2
ci_0004                -3.148888e-02 3 1  ON 3
ci_0005                -2.842198e-02 3 1  ON 4
ci_0006                -2.962380e-02 3 1  ON 5
ci_0007                -1.644646e-02 3 1  ON 6
ci_0008                -1.721863e-02 3 1  ON 7
ci_0009                -1.895887e-02 3 1  ON 8
ci_0010                -1.909747e-02 3 1  ON 9
ci_0011                -1.578361e-02 3 1  ON 10
ci_0012                -1.579241e-02 3 1  ON 11
ci_0013                 1.568461e-02 3 1  ON 12
ci_0014                 1.561327e-02 3 1  ON 13
ci_0015                 1.647820e-02 3 1  ON 14
ci_0016                 1.619585e-02 3 1  ON 15
ci_0017                 1.384672e-02 3 1  ON 16
ci_0018                 1.415257e-02 3 1  ON 17
ci_0019                 1.243859e-02 3 1  ON 18
ci_0020                 1.205185e-02 3 1  ON 19
ci_0021                 1.539483e-02 3 1  ON 20
ci_0022                 1.641549e-02 3 1  ON 21
ci_0023                -1.177804e-02 3 1  ON 22
ci_0024                -1.103743e-02 3 1  ON 23
ci_0025                -2.989036e-03 3 1  ON 24
ci_0026                -2.657139e-03 3 1  ON 25
ci_0027                -1.174735e-02 3 1  ON 26
ci_0028                -1.172146e-02 3 1  ON 27
ci_0029                -1.033864e-02 3 1  ON 28
ci_0030                -1.028740e-02 3 1  ON 29
ci_0031                 1.407063e-02 3 1  ON 30
ci_0032                 1.310028e-02 3 1  ON 31
ci_0033                 8.463042e-03 3 1  ON 32
ci_0034                 8.659737e-03 3 1  ON 33
ci_0035                 5.045258e-03 3 1  ON 34
ci_0036                 4.826568e-03 3 1  ON 35
ci_0037                -1.143338e-02 3 1  ON 36
ci_0038                -1.140351e-02 3 1  ON 37
ci_0039                -3.804123e-03 3 1  ON 38
ci_0040                -3.933527e-03 3 1  ON 39
ci_0041                 9.636287e-03 3 1  ON 40
ci_0042                 9.532954e-03 3 1  ON 41
ci_0043                -6.343090e-03 3 1  ON 42
ci_0044                -6.774436e-03 3 1  ON 43
ci_0045                 1.045933e-02 3 1  ON 44
ci_0046                 9.383508e-03 3 1  ON 45
ci_0047                -3.644267e-03 3 1  ON 46
ci_0048                -3.595065e-03 3 1  ON 47
ci_0049                -2.504340e-03 3 1  ON 48
ci_0050                -2.823113e-03 3 1  ON 49
ci_0051                -1.835868e-03 3 1  ON 50
ci_0052                -1.716010e-03 3 1  ON 51
ci_0053                -4.036073e-03 3 1  ON 52
ci_0054                -3.938130e-03 3 1  ON 53
ci_0055                 2.508102e-03 3 1  ON 54
ci_0056                 2.146634e-03 3 1  ON 55
ci_0057                 2.391280e-03 3 1  ON 56
ci_0058                 3.125211e-03 3 1  ON 57
ci_0059                -4.061038e-03 3 1  ON 58
ci_0060                -3.655087e-03 3 1  ON 59
ci_0061                -2.865950e-03 3 1  ON 60
ci_0062                -3.079646e-03 3 1  ON 61
ci_0063                -9.741524e-03 3 1  ON 62
ci_0064                -9.713259e-03 3 1  ON 63
ci_0065                -7.181074e-03 3 1  ON 64
ci_0066                -6.636016e-03 3 1  ON 65
ci_0067                -3.951506e-03 3 1  ON 66
ci_0068                -3.957852e-03 3 1  ON 67
ci_0069                 3.825531e-03 3 1  ON 68
ci_0070                 3.580874e-03 3 1  ON 69
ci_0071                 4.381185e-03 3 1  ON 70
ci_0072                 4.651015e-03 3 1  ON 71
ci_0073                 3.394233e-03 3 1  ON 72
ci_0074                 3.189411e-03 3 1  ON 73
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 90
    time step          = 0.05
    reference energy   = -16.9257
    reference variance = 0.261258
====================================================
  Execution time = 1.4006e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s090
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6902e+01
  VMC Evar = 3.1428e-01
  Total weights = 1.9518e+06
  Execution time = 1.8994e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.302891965112
                                         uncertainty =       0.002238493880

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.302891965112
                                         uncertainty =       0.002238493880

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000389136243
  error estimate for blocks of size 2^( 2) =       0.000403829869
  error estimate for blocks of size 2^( 3) =       0.000418770759
  error estimate for blocks of size 2^( 4) =       0.000433343850
  error estimate for blocks of size 2^( 5) =       0.000446094865
  error estimate for blocks of size 2^( 6) =       0.000454283136
  error estimate for blocks of size 2^( 7) =       0.000458826222

      target function =      -0.886722433557
              le_mean =     -16.902112918861
             les_mean =     285.995701667658
             stat err =       0.000448137018
             autocorr =       1.326228258803
   target nu stat err =       0.000448137018
   target dn stat err =       0.002754063959
      target stat err =       0.003526019030
              std dev =       0.550321752398
             le_variance =       0.302854031163

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.302891965097
                                         uncertainty =       0.002238493877

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.302891965097
                                         uncertainty =       0.002238493877

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000389136243
  error estimate for blocks of size 2^( 2) =       0.000403829869
  error estimate for blocks of size 2^( 3) =       0.000418770759
  error estimate for blocks of size 2^( 4) =       0.000433343850
  error estimate for blocks of size 2^( 5) =       0.000446094865
  error estimate for blocks of size 2^( 6) =       0.000454283136
  error estimate for blocks of size 2^( 7) =       0.000458826222

      target function =      -0.886722433624
              le_mean =     -16.902112918861
             les_mean =     285.995701667604
             stat err =       0.000448137018
             autocorr =       1.326228258839
   target nu stat err =       0.000448137018
   target dn stat err =       0.002754063948
      target stat err =       0.003526019016
              std dev =       0.550321752384
             le_variance =       0.302854031147

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.302891965104
                                         uncertainty =       0.002238493878

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.302891965104
                                         uncertainty =       0.002238493878

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000389136243
  error estimate for blocks of size 2^( 2) =       0.000403829869
  error estimate for blocks of size 2^( 3) =       0.000418770759
  error estimate for blocks of size 2^( 4) =       0.000433343850
  error estimate for blocks of size 2^( 5) =       0.000446094865
  error estimate for blocks of size 2^( 6) =       0.000454283136
  error estimate for blocks of size 2^( 7) =       0.000458826222

      target function =      -0.886722433591
              le_mean =     -16.902112918861
             les_mean =     285.995701667631
             stat err =       0.000448137018
             autocorr =       1.326228258813
   target nu stat err =       0.000448137018
   target dn stat err =       0.002754063954
      target stat err =       0.003526019023
              std dev =       0.550321752391
             le_variance =       0.302854031155

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.302891965111
                                         uncertainty =       0.002238493879

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.302891965111
                                         uncertainty =       0.002238493879

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000389136243
  error estimate for blocks of size 2^( 2) =       0.000403829869
  error estimate for blocks of size 2^( 3) =       0.000418770759
  error estimate for blocks of size 2^( 4) =       0.000433343850
  error estimate for blocks of size 2^( 5) =       0.000446094865
  error estimate for blocks of size 2^( 6) =       0.000454283136
  error estimate for blocks of size 2^( 7) =       0.000458826222

      target function =      -0.886722433561
              le_mean =     -16.902112918861
             les_mean =     285.995701667654
             stat err =       0.000448137018
             autocorr =       1.326228258813
   target nu stat err =       0.000448137018
   target dn stat err =       0.002754063959
      target stat err =       0.003526019029
              std dev =       0.550321752397
             le_variance =       0.302854031161


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.886722433557        initial
     9.0949e+06     9.0949e+07             3.0081e-11        -0.886722433624  <--
     3.6380e+07     3.6380e+08             7.5203e-12        -0.886722433591
     1.4552e+08     1.4552e+09             1.8800e-12        -0.886722433561

*****************************************************************************
Applying the update for shift_i =   9.0949e+06     and shift_s =   9.0949e+07
*****************************************************************************

  Execution time = 2.3589e+01
  </log>
  <optVariables href="H2O.s090.opt.xml">
ci_0001                 7.026294e-01 3 1  ON 0
ci_0002                 6.983279e-01 3 1  ON 1
ci_0003                -3.181708e-02 3 1  ON 2
ci_0004                -3.148888e-02 3 1  ON 3
ci_0005                -2.842198e-02 3 1  ON 4
ci_0006                -2.962380e-02 3 1  ON 5
ci_0007                -1.644646e-02 3 1  ON 6
ci_0008                -1.721863e-02 3 1  ON 7
ci_0009                -1.895887e-02 3 1  ON 8
ci_0010                -1.909747e-02 3 1  ON 9
ci_0011                -1.578361e-02 3 1  ON 10
ci_0012                -1.579241e-02 3 1  ON 11
ci_0013                 1.568461e-02 3 1  ON 12
ci_0014                 1.561327e-02 3 1  ON 13
ci_0015                 1.647820e-02 3 1  ON 14
ci_0016                 1.619585e-02 3 1  ON 15
ci_0017                 1.384672e-02 3 1  ON 16
ci_0018                 1.415257e-02 3 1  ON 17
ci_0019                 1.243859e-02 3 1  ON 18
ci_0020                 1.205185e-02 3 1  ON 19
ci_0021                 1.539483e-02 3 1  ON 20
ci_0022                 1.641549e-02 3 1  ON 21
ci_0023                -1.177804e-02 3 1  ON 22
ci_0024                -1.103743e-02 3 1  ON 23
ci_0025                -2.989036e-03 3 1  ON 24
ci_0026                -2.657139e-03 3 1  ON 25
ci_0027                -1.174735e-02 3 1  ON 26
ci_0028                -1.172146e-02 3 1  ON 27
ci_0029                -1.033864e-02 3 1  ON 28
ci_0030                -1.028740e-02 3 1  ON 29
ci_0031                 1.407063e-02 3 1  ON 30
ci_0032                 1.310028e-02 3 1  ON 31
ci_0033                 8.463042e-03 3 1  ON 32
ci_0034                 8.659737e-03 3 1  ON 33
ci_0035                 5.045258e-03 3 1  ON 34
ci_0036                 4.826568e-03 3 1  ON 35
ci_0037                -1.143338e-02 3 1  ON 36
ci_0038                -1.140351e-02 3 1  ON 37
ci_0039                -3.804123e-03 3 1  ON 38
ci_0040                -3.933527e-03 3 1  ON 39
ci_0041                 9.636287e-03 3 1  ON 40
ci_0042                 9.532955e-03 3 1  ON 41
ci_0043                -6.343090e-03 3 1  ON 42
ci_0044                -6.774436e-03 3 1  ON 43
ci_0045                 1.045933e-02 3 1  ON 44
ci_0046                 9.383508e-03 3 1  ON 45
ci_0047                -3.644267e-03 3 1  ON 46
ci_0048                -3.595065e-03 3 1  ON 47
ci_0049                -2.504340e-03 3 1  ON 48
ci_0050                -2.823113e-03 3 1  ON 49
ci_0051                -1.835868e-03 3 1  ON 50
ci_0052                -1.716010e-03 3 1  ON 51
ci_0053                -4.036073e-03 3 1  ON 52
ci_0054                -3.938130e-03 3 1  ON 53
ci_0055                 2.508102e-03 3 1  ON 54
ci_0056                 2.146634e-03 3 1  ON 55
ci_0057                 2.391280e-03 3 1  ON 56
ci_0058                 3.125211e-03 3 1  ON 57
ci_0059                -4.061038e-03 3 1  ON 58
ci_0060                -3.655087e-03 3 1  ON 59
ci_0061                -2.865950e-03 3 1  ON 60
ci_0062                -3.079646e-03 3 1  ON 61
ci_0063                -9.741524e-03 3 1  ON 62
ci_0064                -9.713259e-03 3 1  ON 63
ci_0065                -7.181074e-03 3 1  ON 64
ci_0066                -6.636016e-03 3 1  ON 65
ci_0067                -3.951506e-03 3 1  ON 66
ci_0068                -3.957852e-03 3 1  ON 67
ci_0069                 3.825531e-03 3 1  ON 68
ci_0070                 3.580874e-03 3 1  ON 69
ci_0071                 4.381185e-03 3 1  ON 70
ci_0072                 4.651015e-03 3 1  ON 71
ci_0073                 3.394233e-03 3 1  ON 72
ci_0074                 3.189411e-03 3 1  ON 73
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 4.0611e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s091 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s091 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=91  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6902e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 91
    time step          = 0.05
    reference energy   = -16.8757
    reference variance = 0.455596
====================================================
  Execution time = 1.4401e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s091
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5233e+04
  VMC Eavg = -1.6904e+01
  VMC Evar = 3.1370e-01
  Total weights = 1.952064373e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 2.5745e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.304250163662
                                         uncertainty =       0.002546019636

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.304250163662
                                         uncertainty =       0.002546019636

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000390072409
  error estimate for blocks of size 2^( 2) =       0.000404464509
  error estimate for blocks of size 2^( 3) =       0.000418816273
  error estimate for blocks of size 2^( 4) =       0.000431028173
  error estimate for blocks of size 2^( 5) =       0.000442255949
  error estimate for blocks of size 2^( 6) =       0.000451482022
  error estimate for blocks of size 2^( 7) =       0.000456831885

      target function =      -0.887670171274
              le_mean =     -16.903573090704
             les_mean =     286.044487523981
             stat err =       0.000445399507
             autocorr =       1.303794061471
   target nu stat err =       0.000445399507
   target dn stat err =       0.002855972129
      target stat err =       0.003667914090
              std dev =       0.551645691610
             le_variance =       0.304312969072


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690357309070e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 74
Check correct_vf_var_size: 225, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.2737e+06, overlap shift 2.2737e+07 and omega -1.7527e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.887684291074       residual = 8.54e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.887684291090       residual = 1.50e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.887684291094       residual = 5.57e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.887684291096       residual = 2.45e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.887684291097       residual = 1.21e-04           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.887684291098       residual = 5.68e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.887684291098       residual = 1.95e-05           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.887684291098       residual = 1.03e-05           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.887684291098       residual = 8.61e-06           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.887684291098       residual = 9.54e-06           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.887684291098       residual = 5.48e-06           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.887684291098       residual = 2.34e-06           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.887684291371       residual = 9.97e-07           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.887684291098       residual = 2.60e-07           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.887684291098       residual = 6.42e-08           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.887684291098       residual = 1.74e-08           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.887684291098       residual = 4.88e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         16 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 2.2737e+06 is 1.056192e-10

solving harmonic davidson linear method for identity shift 9.0949e+06, overlap shift 9.0949e+07 and omega -1.7527e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.887684291074       residual = 8.54e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.887684291078       residual = 1.50e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.887684291079       residual = 5.57e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.887684288775       residual = 2.45e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.887684291080       residual = 1.21e-04           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.887684297330       residual = 5.68e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.887684288122       residual = 1.95e-05           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.887684287988       residual = 1.03e-05           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.887684291080       residual = 8.61e-06           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.887684286016       residual = 9.54e-06           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.887684291080       residual = 5.48e-06           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.887684291080       residual = 2.34e-06           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.887684301861       residual = 9.97e-07           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.887684286583       residual = 2.60e-07           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.887684303932       residual = 6.42e-08           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.887684300302       residual = 1.74e-08           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.887684283896       residual = 4.87e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         16 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 9.0949e+06 is 2.640478e-11

solving harmonic davidson linear method for identity shift 3.6380e+07, overlap shift 3.6380e+08 and omega -1.7527e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.887684291074       residual = 8.54e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.887684291075       residual = 1.50e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.887684291076       residual = 5.57e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.887684291076       residual = 2.45e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.887684291076       residual = 1.21e-04           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.887684291076       residual = 5.68e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.887684492211       residual = 1.95e-05           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.887684291076       residual = 1.03e-05           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.887684322188       residual = 8.61e-06           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.887684244450       residual = 9.54e-06           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.887684369636       residual = 5.48e-06           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.887684317329       residual = 2.34e-06           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.887684240975       residual = 9.97e-07           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.887684285051       residual = 2.60e-07           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.887684249835       residual = 6.42e-08           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.887684246083       residual = 1.74e-08           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.887684344100       residual = 4.90e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         16 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 3.6380e+07 is 6.601178e-12

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               1.161259 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 75 and numParams is: 74

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.6990e+01
  </log>
  <optVariables href="H2O.s091.opt.xml">
ci_0001                 7.026294e-01 3 1  ON 0
ci_0002                 6.983279e-01 3 1  ON 1
ci_0003                -3.181708e-02 3 1  ON 2
ci_0004                -3.148888e-02 3 1  ON 3
ci_0005                -2.842198e-02 3 1  ON 4
ci_0006                -2.962380e-02 3 1  ON 5
ci_0007                -1.644646e-02 3 1  ON 6
ci_0008                -1.721863e-02 3 1  ON 7
ci_0009                -1.895887e-02 3 1  ON 8
ci_0010                -1.909747e-02 3 1  ON 9
ci_0011                -1.578361e-02 3 1  ON 10
ci_0012                -1.579241e-02 3 1  ON 11
ci_0013                 1.568461e-02 3 1  ON 12
ci_0014                 1.561327e-02 3 1  ON 13
ci_0015                 1.647820e-02 3 1  ON 14
ci_0016                 1.619585e-02 3 1  ON 15
ci_0017                 1.384672e-02 3 1  ON 16
ci_0018                 1.415257e-02 3 1  ON 17
ci_0019                 1.243859e-02 3 1  ON 18
ci_0020                 1.205185e-02 3 1  ON 19
ci_0021                 1.539483e-02 3 1  ON 20
ci_0022                 1.641549e-02 3 1  ON 21
ci_0023                -1.177804e-02 3 1  ON 22
ci_0024                -1.103743e-02 3 1  ON 23
ci_0025                -2.989036e-03 3 1  ON 24
ci_0026                -2.657139e-03 3 1  ON 25
ci_0027                -1.174735e-02 3 1  ON 26
ci_0028                -1.172146e-02 3 1  ON 27
ci_0029                -1.033864e-02 3 1  ON 28
ci_0030                -1.028740e-02 3 1  ON 29
ci_0031                 1.407063e-02 3 1  ON 30
ci_0032                 1.310028e-02 3 1  ON 31
ci_0033                 8.463042e-03 3 1  ON 32
ci_0034                 8.659737e-03 3 1  ON 33
ci_0035                 5.045258e-03 3 1  ON 34
ci_0036                 4.826568e-03 3 1  ON 35
ci_0037                -1.143338e-02 3 1  ON 36
ci_0038                -1.140351e-02 3 1  ON 37
ci_0039                -3.804123e-03 3 1  ON 38
ci_0040                -3.933527e-03 3 1  ON 39
ci_0041                 9.636287e-03 3 1  ON 40
ci_0042                 9.532954e-03 3 1  ON 41
ci_0043                -6.343090e-03 3 1  ON 42
ci_0044                -6.774436e-03 3 1  ON 43
ci_0045                 1.045933e-02 3 1  ON 44
ci_0046                 9.383508e-03 3 1  ON 45
ci_0047                -3.644267e-03 3 1  ON 46
ci_0048                -3.595065e-03 3 1  ON 47
ci_0049                -2.504340e-03 3 1  ON 48
ci_0050                -2.823113e-03 3 1  ON 49
ci_0051                -1.835868e-03 3 1  ON 50
ci_0052                -1.716010e-03 3 1  ON 51
ci_0053                -4.036073e-03 3 1  ON 52
ci_0054                -3.938130e-03 3 1  ON 53
ci_0055                 2.508102e-03 3 1  ON 54
ci_0056                 2.146634e-03 3 1  ON 55
ci_0057                 2.391280e-03 3 1  ON 56
ci_0058                 3.125211e-03 3 1  ON 57
ci_0059                -4.061038e-03 3 1  ON 58
ci_0060                -3.655087e-03 3 1  ON 59
ci_0061                -2.865950e-03 3 1  ON 60
ci_0062                -3.079646e-03 3 1  ON 61
ci_0063                -9.741524e-03 3 1  ON 62
ci_0064                -9.713259e-03 3 1  ON 63
ci_0065                -7.181074e-03 3 1  ON 64
ci_0066                -6.636016e-03 3 1  ON 65
ci_0067                -3.951506e-03 3 1  ON 66
ci_0068                -3.957852e-03 3 1  ON 67
ci_0069                 3.825531e-03 3 1  ON 68
ci_0070                 3.580874e-03 3 1  ON 69
ci_0071                 4.381185e-03 3 1  ON 70
ci_0072                 4.651015e-03 3 1  ON 71
ci_0073                 3.394233e-03 3 1  ON 72
ci_0074                 3.189411e-03 3 1  ON 73
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 91
    time step          = 0.05
    reference energy   = -16.8464
    reference variance = 0.314803
====================================================
  Execution time = 1.3996e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s091
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6903e+01
  VMC Evar = 3.1532e-01
  Total weights = 1.9523e+06
  Execution time = 1.8919e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.305221363857
                                         uncertainty =       0.002266453691

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.305221363857
                                         uncertainty =       0.002266453691

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000390649536
  error estimate for blocks of size 2^( 2) =       0.000404985711
  error estimate for blocks of size 2^( 3) =       0.000419817897
  error estimate for blocks of size 2^( 4) =       0.000432854010
  error estimate for blocks of size 2^( 5) =       0.000442930303
  error estimate for blocks of size 2^( 6) =       0.000450701656
  error estimate for blocks of size 2^( 7) =       0.000455724861

      target function =      -0.885592905521
              le_mean =     -16.903250485199
             les_mean =     286.035192320609
             stat err =       0.000445552708
             autocorr =       1.300838997682
   target nu stat err =       0.000445552708
   target dn stat err =       0.002520675102
      target stat err =       0.003234462405
              std dev =       0.552461872349
             le_variance =       0.305214120400

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.305221363840
                                         uncertainty =       0.002266453690

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.305221363840
                                         uncertainty =       0.002266453690

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000390649536
  error estimate for blocks of size 2^( 2) =       0.000404985711
  error estimate for blocks of size 2^( 3) =       0.000419817897
  error estimate for blocks of size 2^( 4) =       0.000432854010
  error estimate for blocks of size 2^( 5) =       0.000442930303
  error estimate for blocks of size 2^( 6) =       0.000450701656
  error estimate for blocks of size 2^( 7) =       0.000455724861

      target function =      -0.885592905559
              le_mean =     -16.903250485199
             les_mean =     286.035192320566
             stat err =       0.000445552708
             autocorr =       1.300838997816
   target nu stat err =       0.000445552708
   target dn stat err =       0.002520675099
      target stat err =       0.003234462401
              std dev =       0.552461872334
             le_variance =       0.305214120383

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.305221363848
                                         uncertainty =       0.002266453690

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.305221363848
                                         uncertainty =       0.002266453690

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000390649536
  error estimate for blocks of size 2^( 2) =       0.000404985711
  error estimate for blocks of size 2^( 3) =       0.000419817897
  error estimate for blocks of size 2^( 4) =       0.000432854010
  error estimate for blocks of size 2^( 5) =       0.000442930303
  error estimate for blocks of size 2^( 6) =       0.000450701656
  error estimate for blocks of size 2^( 7) =       0.000455724861

      target function =      -0.885592905540
              le_mean =     -16.903250485199
             les_mean =     286.035192320588
             stat err =       0.000445552708
             autocorr =       1.300838997745
   target nu stat err =       0.000445552708
   target dn stat err =       0.002520675101
      target stat err =       0.003234462403
              std dev =       0.552461872342
             le_variance =       0.305214120391

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.305221363856
                                         uncertainty =       0.002266453691

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.305221363856
                                         uncertainty =       0.002266453691

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000390649536
  error estimate for blocks of size 2^( 2) =       0.000404985711
  error estimate for blocks of size 2^( 3) =       0.000419817897
  error estimate for blocks of size 2^( 4) =       0.000432854010
  error estimate for blocks of size 2^( 5) =       0.000442930303
  error estimate for blocks of size 2^( 6) =       0.000450701656
  error estimate for blocks of size 2^( 7) =       0.000455724861

      target function =      -0.885592905523
              le_mean =     -16.903250485199
             les_mean =     286.035192320606
             stat err =       0.000445552708
             autocorr =       1.300838997685
   target nu stat err =       0.000445552708
   target dn stat err =       0.002520675102
      target stat err =       0.003234462404
              std dev =       0.552461872348
             le_variance =       0.305214120398


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.885592905521        initial
     2.2737e+06     2.2737e+07             1.0562e-10        -0.885592905559  <--
     9.0949e+06     9.0949e+07             2.6405e-11        -0.885592905540
     3.6380e+07     3.6380e+08             6.6012e-12        -0.885592905523

*****************************************************************************
Applying the update for shift_i =   2.2737e+06     and shift_s =   2.2737e+07
*****************************************************************************

  Execution time = 2.3543e+01
  </log>
  <optVariables href="H2O.s091.opt.xml">
ci_0001                 7.026294e-01 3 1  ON 0
ci_0002                 6.983279e-01 3 1  ON 1
ci_0003                -3.181708e-02 3 1  ON 2
ci_0004                -3.148888e-02 3 1  ON 3
ci_0005                -2.842198e-02 3 1  ON 4
ci_0006                -2.962380e-02 3 1  ON 5
ci_0007                -1.644646e-02 3 1  ON 6
ci_0008                -1.721863e-02 3 1  ON 7
ci_0009                -1.895887e-02 3 1  ON 8
ci_0010                -1.909747e-02 3 1  ON 9
ci_0011                -1.578361e-02 3 1  ON 10
ci_0012                -1.579241e-02 3 1  ON 11
ci_0013                 1.568461e-02 3 1  ON 12
ci_0014                 1.561327e-02 3 1  ON 13
ci_0015                 1.647820e-02 3 1  ON 14
ci_0016                 1.619585e-02 3 1  ON 15
ci_0017                 1.384672e-02 3 1  ON 16
ci_0018                 1.415257e-02 3 1  ON 17
ci_0019                 1.243859e-02 3 1  ON 18
ci_0020                 1.205185e-02 3 1  ON 19
ci_0021                 1.539483e-02 3 1  ON 20
ci_0022                 1.641549e-02 3 1  ON 21
ci_0023                -1.177804e-02 3 1  ON 22
ci_0024                -1.103743e-02 3 1  ON 23
ci_0025                -2.989036e-03 3 1  ON 24
ci_0026                -2.657139e-03 3 1  ON 25
ci_0027                -1.174735e-02 3 1  ON 26
ci_0028                -1.172146e-02 3 1  ON 27
ci_0029                -1.033864e-02 3 1  ON 28
ci_0030                -1.028740e-02 3 1  ON 29
ci_0031                 1.407063e-02 3 1  ON 30
ci_0032                 1.310028e-02 3 1  ON 31
ci_0033                 8.463042e-03 3 1  ON 32
ci_0034                 8.659737e-03 3 1  ON 33
ci_0035                 5.045258e-03 3 1  ON 34
ci_0036                 4.826568e-03 3 1  ON 35
ci_0037                -1.143338e-02 3 1  ON 36
ci_0038                -1.140351e-02 3 1  ON 37
ci_0039                -3.804123e-03 3 1  ON 38
ci_0040                -3.933527e-03 3 1  ON 39
ci_0041                 9.636287e-03 3 1  ON 40
ci_0042                 9.532954e-03 3 1  ON 41
ci_0043                -6.343090e-03 3 1  ON 42
ci_0044                -6.774436e-03 3 1  ON 43
ci_0045                 1.045933e-02 3 1  ON 44
ci_0046                 9.383508e-03 3 1  ON 45
ci_0047                -3.644267e-03 3 1  ON 46
ci_0048                -3.595064e-03 3 1  ON 47
ci_0049                -2.504340e-03 3 1  ON 48
ci_0050                -2.823113e-03 3 1  ON 49
ci_0051                -1.835868e-03 3 1  ON 50
ci_0052                -1.716010e-03 3 1  ON 51
ci_0053                -4.036073e-03 3 1  ON 52
ci_0054                -3.938130e-03 3 1  ON 53
ci_0055                 2.508102e-03 3 1  ON 54
ci_0056                 2.146634e-03 3 1  ON 55
ci_0057                 2.391280e-03 3 1  ON 56
ci_0058                 3.125211e-03 3 1  ON 57
ci_0059                -4.061038e-03 3 1  ON 58
ci_0060                -3.655087e-03 3 1  ON 59
ci_0061                -2.865950e-03 3 1  ON 60
ci_0062                -3.079646e-03 3 1  ON 61
ci_0063                -9.741523e-03 3 1  ON 62
ci_0064                -9.713259e-03 3 1  ON 63
ci_0065                -7.181074e-03 3 1  ON 64
ci_0066                -6.636016e-03 3 1  ON 65
ci_0067                -3.951506e-03 3 1  ON 66
ci_0068                -3.957852e-03 3 1  ON 67
ci_0069                 3.825531e-03 3 1  ON 68
ci_0070                 3.580874e-03 3 1  ON 69
ci_0071                 4.381185e-03 3 1  ON 70
ci_0072                 4.651015e-03 3 1  ON 71
ci_0073                 3.394233e-03 3 1  ON 72
ci_0074                 3.189411e-03 3 1  ON 73
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 4.0538e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s092 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s092 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=92  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6901e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 92
    time step          = 0.05
    reference energy   = -16.9074
    reference variance = 0.228781
====================================================
  Execution time = 1.4465e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s092
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5258e+04
  VMC Eavg = -1.6903e+01
  VMC Evar = 3.1822e-01
  Total weights = 1.951984226e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 2.5818e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.306284856689
                                         uncertainty =       0.001923212160

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.306284856689
                                         uncertainty =       0.001923212160

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000391300014
  error estimate for blocks of size 2^( 2) =       0.000406208257
  error estimate for blocks of size 2^( 3) =       0.000421072433
  error estimate for blocks of size 2^( 4) =       0.000435253300
  error estimate for blocks of size 2^( 5) =       0.000448548662
  error estimate for blocks of size 2^( 6) =       0.000457655939
  error estimate for blocks of size 2^( 7) =       0.000465649972

      target function =      -0.881904411148
              le_mean =     -16.902908306574
             les_mean =     286.026526659575
             stat err =       0.000451776968
             autocorr =       1.332994772388
   target nu stat err =       0.000451776968
   target dn stat err =       0.002880673677
      target stat err =       0.003649179896
              std dev =       0.553381786934
             le_variance =       0.306231402110


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690290830657e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 74
Check correct_vf_var_size: 225, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 5.6843e+05, overlap shift 5.6843e+06 and omega -1.7527e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.881918379087       residual = 1.93e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.881918379231       residual = 1.75e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.881918379244       residual = 4.92e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.881918379299       residual = 2.37e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.881918379252       residual = 6.02e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.881918379252       residual = 3.91e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.881918379843       residual = 2.29e-05           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.881918379253       residual = 1.05e-05           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.881918380677       residual = 7.07e-06           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.881918378694       residual = 6.65e-06           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.881918379790       residual = 5.09e-06           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.881918379223       residual = 2.12e-06           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.881918379106       residual = 8.91e-07           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.881918378243       residual = 3.98e-07           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.881918380366       residual = 3.82e-08           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.881918380606       residual = 9.90e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         15 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 5.6843e+05 is 4.849111e-10

solving harmonic davidson linear method for identity shift 2.2737e+06, overlap shift 2.2737e+07 and omega -1.7527e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.881918379087       residual = 1.93e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.881918379123       residual = 1.75e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.881918379126       residual = 4.92e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.881918379127       residual = 2.37e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.881918379128       residual = 6.02e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.881918379128       residual = 3.91e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.881918379129       residual = 2.29e-05           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.881918377239       residual = 1.05e-05           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.881918379129       residual = 7.07e-06           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.881918379664       residual = 6.65e-06           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.881918378203       residual = 5.09e-06           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.881918378195       residual = 2.12e-06           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.881918383241       residual = 8.91e-07           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.881918380821       residual = 3.98e-07           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.881918376376       residual = 3.82e-08           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.881918381835       residual = 9.90e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         15 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 2.2737e+06 is 1.212278e-10

solving harmonic davidson linear method for identity shift 9.0949e+06, overlap shift 9.0949e+07 and omega -1.7527e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.881918379087       residual = 1.93e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.881918379096       residual = 1.75e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.881918379097       residual = 4.92e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.881918379097       residual = 2.37e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.881918379097       residual = 6.02e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.881918379097       residual = 3.91e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.881918386592       residual = 2.29e-05           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.881918382368       residual = 1.05e-05           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.881918375802       residual = 7.07e-06           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.881918386928       residual = 6.65e-06           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.881918399056       residual = 5.09e-06           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.881918387022       residual = 2.12e-06           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.881918387503       residual = 8.91e-07           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.881918380655       residual = 3.98e-07           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.881918395673       residual = 3.82e-08           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.881918375406       residual = 9.90e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         15 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 9.0949e+06 is 3.030696e-11

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               1.169388 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 75 and numParams is: 74

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.7062e+01
  </log>
  <optVariables href="H2O.s092.opt.xml">
ci_0001                 7.026294e-01 3 1  ON 0
ci_0002                 6.983279e-01 3 1  ON 1
ci_0003                -3.181708e-02 3 1  ON 2
ci_0004                -3.148888e-02 3 1  ON 3
ci_0005                -2.842198e-02 3 1  ON 4
ci_0006                -2.962380e-02 3 1  ON 5
ci_0007                -1.644646e-02 3 1  ON 6
ci_0008                -1.721863e-02 3 1  ON 7
ci_0009                -1.895887e-02 3 1  ON 8
ci_0010                -1.909747e-02 3 1  ON 9
ci_0011                -1.578361e-02 3 1  ON 10
ci_0012                -1.579241e-02 3 1  ON 11
ci_0013                 1.568461e-02 3 1  ON 12
ci_0014                 1.561327e-02 3 1  ON 13
ci_0015                 1.647820e-02 3 1  ON 14
ci_0016                 1.619585e-02 3 1  ON 15
ci_0017                 1.384672e-02 3 1  ON 16
ci_0018                 1.415257e-02 3 1  ON 17
ci_0019                 1.243859e-02 3 1  ON 18
ci_0020                 1.205185e-02 3 1  ON 19
ci_0021                 1.539483e-02 3 1  ON 20
ci_0022                 1.641549e-02 3 1  ON 21
ci_0023                -1.177804e-02 3 1  ON 22
ci_0024                -1.103743e-02 3 1  ON 23
ci_0025                -2.989036e-03 3 1  ON 24
ci_0026                -2.657139e-03 3 1  ON 25
ci_0027                -1.174735e-02 3 1  ON 26
ci_0028                -1.172146e-02 3 1  ON 27
ci_0029                -1.033864e-02 3 1  ON 28
ci_0030                -1.028740e-02 3 1  ON 29
ci_0031                 1.407063e-02 3 1  ON 30
ci_0032                 1.310028e-02 3 1  ON 31
ci_0033                 8.463042e-03 3 1  ON 32
ci_0034                 8.659737e-03 3 1  ON 33
ci_0035                 5.045258e-03 3 1  ON 34
ci_0036                 4.826568e-03 3 1  ON 35
ci_0037                -1.143338e-02 3 1  ON 36
ci_0038                -1.140351e-02 3 1  ON 37
ci_0039                -3.804123e-03 3 1  ON 38
ci_0040                -3.933527e-03 3 1  ON 39
ci_0041                 9.636287e-03 3 1  ON 40
ci_0042                 9.532954e-03 3 1  ON 41
ci_0043                -6.343090e-03 3 1  ON 42
ci_0044                -6.774436e-03 3 1  ON 43
ci_0045                 1.045933e-02 3 1  ON 44
ci_0046                 9.383508e-03 3 1  ON 45
ci_0047                -3.644267e-03 3 1  ON 46
ci_0048                -3.595064e-03 3 1  ON 47
ci_0049                -2.504340e-03 3 1  ON 48
ci_0050                -2.823113e-03 3 1  ON 49
ci_0051                -1.835868e-03 3 1  ON 50
ci_0052                -1.716010e-03 3 1  ON 51
ci_0053                -4.036073e-03 3 1  ON 52
ci_0054                -3.938130e-03 3 1  ON 53
ci_0055                 2.508102e-03 3 1  ON 54
ci_0056                 2.146634e-03 3 1  ON 55
ci_0057                 2.391280e-03 3 1  ON 56
ci_0058                 3.125211e-03 3 1  ON 57
ci_0059                -4.061038e-03 3 1  ON 58
ci_0060                -3.655087e-03 3 1  ON 59
ci_0061                -2.865950e-03 3 1  ON 60
ci_0062                -3.079646e-03 3 1  ON 61
ci_0063                -9.741524e-03 3 1  ON 62
ci_0064                -9.713259e-03 3 1  ON 63
ci_0065                -7.181074e-03 3 1  ON 64
ci_0066                -6.636016e-03 3 1  ON 65
ci_0067                -3.951506e-03 3 1  ON 66
ci_0068                -3.957852e-03 3 1  ON 67
ci_0069                 3.825531e-03 3 1  ON 68
ci_0070                 3.580874e-03 3 1  ON 69
ci_0071                 4.381185e-03 3 1  ON 70
ci_0072                 4.651015e-03 3 1  ON 71
ci_0073                 3.394233e-03 3 1  ON 72
ci_0074                 3.189411e-03 3 1  ON 73
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 92
    time step          = 0.05
    reference energy   = -16.8095
    reference variance = 0.435976
====================================================
  Execution time = 1.4015e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s092
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6903e+01
  VMC Evar = 3.1932e-01
  Total weights = 1.9514e+06
  Execution time = 1.8967e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.308312491324
                                         uncertainty =       0.002111462848

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.308312491324
                                         uncertainty =       0.002111462848

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000392624650
  error estimate for blocks of size 2^( 2) =       0.000406899635
  error estimate for blocks of size 2^( 3) =       0.000421659143
  error estimate for blocks of size 2^( 4) =       0.000435818992
  error estimate for blocks of size 2^( 5) =       0.000447047770
  error estimate for blocks of size 2^( 6) =       0.000456268738
  error estimate for blocks of size 2^( 7) =       0.000459428631

      target function =      -0.880505600246
              le_mean =     -16.902699902010
             les_mean =     286.020582728762
             stat err =       0.000449641033
             autocorr =       1.311525530807
   target nu stat err =       0.000449641033
   target dn stat err =       0.002742813246
      target stat err =       0.003467461661
              std dev =       0.555255104741
             le_variance =       0.308308231341

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.308312491257
                                         uncertainty =       0.002111462854

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.308312491257
                                         uncertainty =       0.002111462854

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000392624650
  error estimate for blocks of size 2^( 2) =       0.000406899635
  error estimate for blocks of size 2^( 3) =       0.000421659143
  error estimate for blocks of size 2^( 4) =       0.000435818992
  error estimate for blocks of size 2^( 5) =       0.000447047770
  error estimate for blocks of size 2^( 6) =       0.000456268738
  error estimate for blocks of size 2^( 7) =       0.000459428631

      target function =      -0.880505600449
              le_mean =     -16.902699902013
             les_mean =     286.020582728714
             stat err =       0.000449641033
             autocorr =       1.311525531453
   target nu stat err =       0.000449641033
   target dn stat err =       0.002742813234
      target stat err =       0.003467461648
              std dev =       0.555255104680
             le_variance =       0.308308231273

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.308312491290
                                         uncertainty =       0.002111462851

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.308312491290
                                         uncertainty =       0.002111462851

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000392624650
  error estimate for blocks of size 2^( 2) =       0.000406899635
  error estimate for blocks of size 2^( 3) =       0.000421659143
  error estimate for blocks of size 2^( 4) =       0.000435818992
  error estimate for blocks of size 2^( 5) =       0.000447047770
  error estimate for blocks of size 2^( 6) =       0.000456268738
  error estimate for blocks of size 2^( 7) =       0.000459428631

      target function =      -0.880505600348
              le_mean =     -16.902699902011
             les_mean =     286.020582728738
             stat err =       0.000449641033
             autocorr =       1.311525531123
   target nu stat err =       0.000449641033
   target dn stat err =       0.002742813240
      target stat err =       0.003467461655
              std dev =       0.555255104710
             le_variance =       0.308308231307

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.308312491320
                                         uncertainty =       0.002111462848

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.308312491320
                                         uncertainty =       0.002111462848

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000392624650
  error estimate for blocks of size 2^( 2) =       0.000406899635
  error estimate for blocks of size 2^( 3) =       0.000421659143
  error estimate for blocks of size 2^( 4) =       0.000435818992
  error estimate for blocks of size 2^( 5) =       0.000447047770
  error estimate for blocks of size 2^( 6) =       0.000456268738
  error estimate for blocks of size 2^( 7) =       0.000459428631

      target function =      -0.880505600259
              le_mean =     -16.902699902010
             les_mean =     286.020582728759
             stat err =       0.000449641033
             autocorr =       1.311525530836
   target nu stat err =       0.000449641033
   target dn stat err =       0.002742813245
      target stat err =       0.003467461660
              std dev =       0.555255104737
             le_variance =       0.308308231336


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.880505600246        initial
     5.6843e+05     5.6843e+06             4.8491e-10        -0.880505600449  <--
     2.2737e+06     2.2737e+07             1.2123e-10        -0.880505600348
     9.0949e+06     9.0949e+07             3.0307e-11        -0.880505600259

*****************************************************************************
Applying the update for shift_i =   5.6843e+05     and shift_s =   5.6843e+06
*****************************************************************************

  Execution time = 2.3579e+01
  </log>
  <optVariables href="H2O.s092.opt.xml">
ci_0001                 7.026294e-01 3 1  ON 0
ci_0002                 6.983279e-01 3 1  ON 1
ci_0003                -3.181708e-02 3 1  ON 2
ci_0004                -3.148888e-02 3 1  ON 3
ci_0005                -2.842198e-02 3 1  ON 4
ci_0006                -2.962380e-02 3 1  ON 5
ci_0007                -1.644646e-02 3 1  ON 6
ci_0008                -1.721863e-02 3 1  ON 7
ci_0009                -1.895887e-02 3 1  ON 8
ci_0010                -1.909747e-02 3 1  ON 9
ci_0011                -1.578361e-02 3 1  ON 10
ci_0012                -1.579241e-02 3 1  ON 11
ci_0013                 1.568461e-02 3 1  ON 12
ci_0014                 1.561327e-02 3 1  ON 13
ci_0015                 1.647820e-02 3 1  ON 14
ci_0016                 1.619585e-02 3 1  ON 15
ci_0017                 1.384672e-02 3 1  ON 16
ci_0018                 1.415257e-02 3 1  ON 17
ci_0019                 1.243859e-02 3 1  ON 18
ci_0020                 1.205185e-02 3 1  ON 19
ci_0021                 1.539483e-02 3 1  ON 20
ci_0022                 1.641549e-02 3 1  ON 21
ci_0023                -1.177804e-02 3 1  ON 22
ci_0024                -1.103743e-02 3 1  ON 23
ci_0025                -2.989036e-03 3 1  ON 24
ci_0026                -2.657138e-03 3 1  ON 25
ci_0027                -1.174735e-02 3 1  ON 26
ci_0028                -1.172146e-02 3 1  ON 27
ci_0029                -1.033864e-02 3 1  ON 28
ci_0030                -1.028740e-02 3 1  ON 29
ci_0031                 1.407063e-02 3 1  ON 30
ci_0032                 1.310028e-02 3 1  ON 31
ci_0033                 8.463042e-03 3 1  ON 32
ci_0034                 8.659737e-03 3 1  ON 33
ci_0035                 5.045258e-03 3 1  ON 34
ci_0036                 4.826568e-03 3 1  ON 35
ci_0037                -1.143338e-02 3 1  ON 36
ci_0038                -1.140351e-02 3 1  ON 37
ci_0039                -3.804123e-03 3 1  ON 38
ci_0040                -3.933527e-03 3 1  ON 39
ci_0041                 9.636287e-03 3 1  ON 40
ci_0042                 9.532954e-03 3 1  ON 41
ci_0043                -6.343090e-03 3 1  ON 42
ci_0044                -6.774436e-03 3 1  ON 43
ci_0045                 1.045933e-02 3 1  ON 44
ci_0046                 9.383508e-03 3 1  ON 45
ci_0047                -3.644267e-03 3 1  ON 46
ci_0048                -3.595064e-03 3 1  ON 47
ci_0049                -2.504340e-03 3 1  ON 48
ci_0050                -2.823113e-03 3 1  ON 49
ci_0051                -1.835868e-03 3 1  ON 50
ci_0052                -1.716009e-03 3 1  ON 51
ci_0053                -4.036073e-03 3 1  ON 52
ci_0054                -3.938130e-03 3 1  ON 53
ci_0055                 2.508102e-03 3 1  ON 54
ci_0056                 2.146634e-03 3 1  ON 55
ci_0057                 2.391280e-03 3 1  ON 56
ci_0058                 3.125211e-03 3 1  ON 57
ci_0059                -4.061038e-03 3 1  ON 58
ci_0060                -3.655087e-03 3 1  ON 59
ci_0061                -2.865950e-03 3 1  ON 60
ci_0062                -3.079646e-03 3 1  ON 61
ci_0063                -9.741524e-03 3 1  ON 62
ci_0064                -9.713259e-03 3 1  ON 63
ci_0065                -7.181074e-03 3 1  ON 64
ci_0066                -6.636016e-03 3 1  ON 65
ci_0067                -3.951506e-03 3 1  ON 66
ci_0068                -3.957851e-03 3 1  ON 67
ci_0069                 3.825531e-03 3 1  ON 68
ci_0070                 3.580874e-03 3 1  ON 69
ci_0071                 4.381185e-03 3 1  ON 70
ci_0072                 4.651015e-03 3 1  ON 71
ci_0073                 3.394233e-03 3 1  ON 72
ci_0074                 3.189411e-03 3 1  ON 73
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 4.0646e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s093 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s093 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=93  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6901e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 93
    time step          = 0.05
    reference energy   = -16.9234
    reference variance = 0.223947
====================================================
  Execution time = 1.4416e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s093
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5222e+04
  VMC Eavg = -1.6902e+01
  VMC Evar = 3.1893e-01
  Total weights = 1.951728610e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 2.5788e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.307774517465
                                         uncertainty =       0.002807947678

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.307774517465
                                         uncertainty =       0.002807947678

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000392259446
  error estimate for blocks of size 2^( 2) =       0.000406734277
  error estimate for blocks of size 2^( 3) =       0.000421855478
  error estimate for blocks of size 2^( 4) =       0.000435440426
  error estimate for blocks of size 2^( 5) =       0.000447560435
  error estimate for blocks of size 2^( 6) =       0.000457456885
  error estimate for blocks of size 2^( 7) =       0.000463971962

      target function =      -0.880945199660
              le_mean =     -16.902417329781
             les_mean =     286.010636882263
             stat err =       0.000451107427
             autocorr =       1.322553144654
   target nu stat err =       0.000451107427
   target dn stat err =       0.003644462485
      target stat err =       0.004576529761
              std dev =       0.554738628941
             le_variance =       0.307734946439


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690241732978e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 74
Check correct_vf_var_size: 225, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.4211e+05, overlap shift 1.4211e+06 and omega -1.7527e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.880967605541       residual = 1.17e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.880967605946       residual = 1.66e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.880967605990       residual = 1.15e-03           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.880967606033       residual = 3.15e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.880967606061       residual = 1.78e-04           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.880967606049       residual = 1.05e-04           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.880967606067       residual = 5.89e-05           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.880967605981       residual = 4.76e-05           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.880967606092       residual = 4.77e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.880967606064       residual = 2.26e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.880967605723       residual = 1.00e-05           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.880967606068       residual = 3.76e-06           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.880967606003       residual = 1.54e-06           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.880967606169       residual = 3.05e-07           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.880967605828       residual = 7.51e-08           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.880967606065       residual = 1.40e-08           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.880967605941       residual = 4.56e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         16 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 1.4211e+05 is 3.426471e-09

solving harmonic davidson linear method for identity shift 5.6843e+05, overlap shift 5.6843e+06 and omega -1.7527e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.880967605541       residual = 1.17e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.880967605642       residual = 1.66e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.880967605654       residual = 1.15e-03           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.880967605361       residual = 3.15e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.880967605794       residual = 1.78e-04           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.880967604450       residual = 1.05e-04           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.880967605416       residual = 5.89e-05           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.880967605458       residual = 4.76e-05           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.880967603980       residual = 4.77e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.880967606296       residual = 2.26e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.880967605703       residual = 1.00e-05           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.880967605673       residual = 3.76e-06           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.880967604916       residual = 1.54e-06           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.880967604044       residual = 3.05e-07           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.880967605666       residual = 7.51e-08           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.880967605612       residual = 1.40e-08           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.880967605107       residual = 4.56e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         16 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 5.6843e+05 is 8.566180e-10

solving harmonic davidson linear method for identity shift 2.2737e+06, overlap shift 2.2737e+07 and omega -1.7527e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.880967605541       residual = 1.17e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.880967605567       residual = 1.66e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.880967605569       residual = 1.15e-03           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.880967605442       residual = 3.15e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.880967605701       residual = 1.78e-04           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.880967605748       residual = 1.05e-04           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.880967606451       residual = 5.89e-05           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.880967602819       residual = 4.76e-05           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.880967604648       residual = 4.77e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.880967602089       residual = 2.26e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.880967602696       residual = 1.00e-05           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.880967606197       residual = 3.76e-06           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.880967604144       residual = 1.54e-06           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.880967611720       residual = 3.05e-07           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.880967602005       residual = 7.51e-08           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.880967614079       residual = 1.40e-08           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.880967604651       residual = 4.56e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         16 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 2.2737e+06 is 2.141544e-10

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               1.178343 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 75 and numParams is: 74

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.7009e+01
  </log>
  <optVariables href="H2O.s093.opt.xml">
ci_0001                 7.026294e-01 3 1  ON 0
ci_0002                 6.983279e-01 3 1  ON 1
ci_0003                -3.181708e-02 3 1  ON 2
ci_0004                -3.148888e-02 3 1  ON 3
ci_0005                -2.842198e-02 3 1  ON 4
ci_0006                -2.962380e-02 3 1  ON 5
ci_0007                -1.644646e-02 3 1  ON 6
ci_0008                -1.721863e-02 3 1  ON 7
ci_0009                -1.895887e-02 3 1  ON 8
ci_0010                -1.909747e-02 3 1  ON 9
ci_0011                -1.578361e-02 3 1  ON 10
ci_0012                -1.579241e-02 3 1  ON 11
ci_0013                 1.568461e-02 3 1  ON 12
ci_0014                 1.561327e-02 3 1  ON 13
ci_0015                 1.647820e-02 3 1  ON 14
ci_0016                 1.619585e-02 3 1  ON 15
ci_0017                 1.384672e-02 3 1  ON 16
ci_0018                 1.415257e-02 3 1  ON 17
ci_0019                 1.243859e-02 3 1  ON 18
ci_0020                 1.205185e-02 3 1  ON 19
ci_0021                 1.539483e-02 3 1  ON 20
ci_0022                 1.641549e-02 3 1  ON 21
ci_0023                -1.177804e-02 3 1  ON 22
ci_0024                -1.103743e-02 3 1  ON 23
ci_0025                -2.989036e-03 3 1  ON 24
ci_0026                -2.657138e-03 3 1  ON 25
ci_0027                -1.174735e-02 3 1  ON 26
ci_0028                -1.172146e-02 3 1  ON 27
ci_0029                -1.033864e-02 3 1  ON 28
ci_0030                -1.028740e-02 3 1  ON 29
ci_0031                 1.407063e-02 3 1  ON 30
ci_0032                 1.310028e-02 3 1  ON 31
ci_0033                 8.463042e-03 3 1  ON 32
ci_0034                 8.659737e-03 3 1  ON 33
ci_0035                 5.045258e-03 3 1  ON 34
ci_0036                 4.826568e-03 3 1  ON 35
ci_0037                -1.143338e-02 3 1  ON 36
ci_0038                -1.140351e-02 3 1  ON 37
ci_0039                -3.804123e-03 3 1  ON 38
ci_0040                -3.933527e-03 3 1  ON 39
ci_0041                 9.636287e-03 3 1  ON 40
ci_0042                 9.532954e-03 3 1  ON 41
ci_0043                -6.343090e-03 3 1  ON 42
ci_0044                -6.774436e-03 3 1  ON 43
ci_0045                 1.045933e-02 3 1  ON 44
ci_0046                 9.383508e-03 3 1  ON 45
ci_0047                -3.644267e-03 3 1  ON 46
ci_0048                -3.595064e-03 3 1  ON 47
ci_0049                -2.504341e-03 3 1  ON 48
ci_0050                -2.823113e-03 3 1  ON 49
ci_0051                -1.835868e-03 3 1  ON 50
ci_0052                -1.716009e-03 3 1  ON 51
ci_0053                -4.036073e-03 3 1  ON 52
ci_0054                -3.938129e-03 3 1  ON 53
ci_0055                 2.508102e-03 3 1  ON 54
ci_0056                 2.146634e-03 3 1  ON 55
ci_0057                 2.391280e-03 3 1  ON 56
ci_0058                 3.125211e-03 3 1  ON 57
ci_0059                -4.061038e-03 3 1  ON 58
ci_0060                -3.655087e-03 3 1  ON 59
ci_0061                -2.865950e-03 3 1  ON 60
ci_0062                -3.079646e-03 3 1  ON 61
ci_0063                -9.741523e-03 3 1  ON 62
ci_0064                -9.713259e-03 3 1  ON 63
ci_0065                -7.181074e-03 3 1  ON 64
ci_0066                -6.636015e-03 3 1  ON 65
ci_0067                -3.951506e-03 3 1  ON 66
ci_0068                -3.957851e-03 3 1  ON 67
ci_0069                 3.825531e-03 3 1  ON 68
ci_0070                 3.580874e-03 3 1  ON 69
ci_0071                 4.381186e-03 3 1  ON 70
ci_0072                 4.651015e-03 3 1  ON 71
ci_0073                 3.394233e-03 3 1  ON 72
ci_0074                 3.189411e-03 3 1  ON 73
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 93
    time step          = 0.05
    reference energy   = -16.9343
    reference variance = 0.164755
====================================================
  Execution time = 1.4276e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s093
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6903e+01
  VMC Evar = 3.1628e-01
  Total weights = 1.9516e+06
  Execution time = 1.8961e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.305381589915
                                         uncertainty =       0.002574252656

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.305381589915
                                         uncertainty =       0.002574252656

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000390823287
  error estimate for blocks of size 2^( 2) =       0.000405637084
  error estimate for blocks of size 2^( 3) =       0.000421036871
  error estimate for blocks of size 2^( 4) =       0.000435832205
  error estimate for blocks of size 2^( 5) =       0.000449529135
  error estimate for blocks of size 2^( 6) =       0.000459435875
  error estimate for blocks of size 2^( 7) =       0.000466370901

      target function =      -0.884296570718
              le_mean =     -16.902704156130
             les_mean =     286.017689369194
             stat err =       0.000452792029
             autocorr =       1.342260101568
   target nu stat err =       0.000452792029
   target dn stat err =       0.002781047279
      target stat err =       0.003544852091
              std dev =       0.552707592314
             le_variance =       0.305485682602

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.305381589702
                                         uncertainty =       0.002574252621

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.305381589702
                                         uncertainty =       0.002574252621

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000390823286
  error estimate for blocks of size 2^( 2) =       0.000405637084
  error estimate for blocks of size 2^( 3) =       0.000421036871
  error estimate for blocks of size 2^( 4) =       0.000435832205
  error estimate for blocks of size 2^( 5) =       0.000449529136
  error estimate for blocks of size 2^( 6) =       0.000459435875
  error estimate for blocks of size 2^( 7) =       0.000466370901

      target function =      -0.884297177264
              le_mean =     -16.902704156125
             les_mean =     286.017688885222
             stat err =       0.000452792029
             autocorr =       1.342260103526
   target nu stat err =       0.000452792029
   target dn stat err =       0.002781038420
      target stat err =       0.003544845952
              std dev =       0.552707592123
             le_variance =       0.305485682391

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.305381589809
                                         uncertainty =       0.002574252638

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.305381589809
                                         uncertainty =       0.002574252638

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000390823286
  error estimate for blocks of size 2^( 2) =       0.000405637084
  error estimate for blocks of size 2^( 3) =       0.000421036871
  error estimate for blocks of size 2^( 4) =       0.000435832205
  error estimate for blocks of size 2^( 5) =       0.000449529135
  error estimate for blocks of size 2^( 6) =       0.000459435875
  error estimate for blocks of size 2^( 7) =       0.000466370901

      target function =      -0.884296875082
              le_mean =     -16.902704156128
             les_mean =     286.017689126338
             stat err =       0.000452792029
             autocorr =       1.342260102547
   target nu stat err =       0.000452792029
   target dn stat err =       0.002781042824
      target stat err =       0.003544848998
              std dev =       0.552707592219
             le_variance =       0.305485682496

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.305381589902
                                         uncertainty =       0.002574252654

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.305381589902
                                         uncertainty =       0.002574252654

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000390823287
  error estimate for blocks of size 2^( 2) =       0.000405637084
  error estimate for blocks of size 2^( 3) =       0.000421036871
  error estimate for blocks of size 2^( 4) =       0.000435832205
  error estimate for blocks of size 2^( 5) =       0.000449529135
  error estimate for blocks of size 2^( 6) =       0.000459435875
  error estimate for blocks of size 2^( 7) =       0.000466370901

      target function =      -0.884296608885
              le_mean =     -16.902704156130
             les_mean =     286.017689338741
             stat err =       0.000452792029
             autocorr =       1.342260101691
   target nu stat err =       0.000452792029
   target dn stat err =       0.002781046720
      target stat err =       0.003544851702
              std dev =       0.552707592302
             le_variance =       0.305485682588


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.884296570718        initial
     1.4211e+05     1.4211e+06             3.4265e-09        -0.884297177264  <--
     5.6843e+05     5.6843e+06             8.5662e-10        -0.884296875082
     2.2737e+06     2.2737e+07             2.1415e-10        -0.884296608885

*****************************************************************************
Applying the update for shift_i =   1.4211e+05     and shift_s =   1.4211e+06
*****************************************************************************

  Execution time = 2.3835e+01
  </log>
  <optVariables href="H2O.s093.opt.xml">
ci_0001                 7.026294e-01 3 1  ON 0
ci_0002                 6.983279e-01 3 1  ON 1
ci_0003                -3.181708e-02 3 1  ON 2
ci_0004                -3.148888e-02 3 1  ON 3
ci_0005                -2.842198e-02 3 1  ON 4
ci_0006                -2.962380e-02 3 1  ON 5
ci_0007                -1.644646e-02 3 1  ON 6
ci_0008                -1.721863e-02 3 1  ON 7
ci_0009                -1.895887e-02 3 1  ON 8
ci_0010                -1.909747e-02 3 1  ON 9
ci_0011                -1.578360e-02 3 1  ON 10
ci_0012                -1.579241e-02 3 1  ON 11
ci_0013                 1.568461e-02 3 1  ON 12
ci_0014                 1.561327e-02 3 1  ON 13
ci_0015                 1.647820e-02 3 1  ON 14
ci_0016                 1.619584e-02 3 1  ON 15
ci_0017                 1.384672e-02 3 1  ON 16
ci_0018                 1.415257e-02 3 1  ON 17
ci_0019                 1.243859e-02 3 1  ON 18
ci_0020                 1.205185e-02 3 1  ON 19
ci_0021                 1.539483e-02 3 1  ON 20
ci_0022                 1.641549e-02 3 1  ON 21
ci_0023                -1.177804e-02 3 1  ON 22
ci_0024                -1.103743e-02 3 1  ON 23
ci_0025                -2.989036e-03 3 1  ON 24
ci_0026                -2.657138e-03 3 1  ON 25
ci_0027                -1.174735e-02 3 1  ON 26
ci_0028                -1.172146e-02 3 1  ON 27
ci_0029                -1.033864e-02 3 1  ON 28
ci_0030                -1.028740e-02 3 1  ON 29
ci_0031                 1.407063e-02 3 1  ON 30
ci_0032                 1.310028e-02 3 1  ON 31
ci_0033                 8.463042e-03 3 1  ON 32
ci_0034                 8.659737e-03 3 1  ON 33
ci_0035                 5.045258e-03 3 1  ON 34
ci_0036                 4.826567e-03 3 1  ON 35
ci_0037                -1.143338e-02 3 1  ON 36
ci_0038                -1.140351e-02 3 1  ON 37
ci_0039                -3.804123e-03 3 1  ON 38
ci_0040                -3.933526e-03 3 1  ON 39
ci_0041                 9.636287e-03 3 1  ON 40
ci_0042                 9.532954e-03 3 1  ON 41
ci_0043                -6.343089e-03 3 1  ON 42
ci_0044                -6.774436e-03 3 1  ON 43
ci_0045                 1.045933e-02 3 1  ON 44
ci_0046                 9.383508e-03 3 1  ON 45
ci_0047                -3.644267e-03 3 1  ON 46
ci_0048                -3.595064e-03 3 1  ON 47
ci_0049                -2.504342e-03 3 1  ON 48
ci_0050                -2.823113e-03 3 1  ON 49
ci_0051                -1.835868e-03 3 1  ON 50
ci_0052                -1.716010e-03 3 1  ON 51
ci_0053                -4.036072e-03 3 1  ON 52
ci_0054                -3.938128e-03 3 1  ON 53
ci_0055                 2.508102e-03 3 1  ON 54
ci_0056                 2.146634e-03 3 1  ON 55
ci_0057                 2.391279e-03 3 1  ON 56
ci_0058                 3.125210e-03 3 1  ON 57
ci_0059                -4.061037e-03 3 1  ON 58
ci_0060                -3.655087e-03 3 1  ON 59
ci_0061                -2.865950e-03 3 1  ON 60
ci_0062                -3.079645e-03 3 1  ON 61
ci_0063                -9.741523e-03 3 1  ON 62
ci_0064                -9.713259e-03 3 1  ON 63
ci_0065                -7.181074e-03 3 1  ON 64
ci_0066                -6.636015e-03 3 1  ON 65
ci_0067                -3.951506e-03 3 1  ON 66
ci_0068                -3.957851e-03 3 1  ON 67
ci_0069                 3.825531e-03 3 1  ON 68
ci_0070                 3.580873e-03 3 1  ON 69
ci_0071                 4.381186e-03 3 1  ON 70
ci_0072                 4.651015e-03 3 1  ON 71
ci_0073                 3.394233e-03 3 1  ON 72
ci_0074                 3.189411e-03 3 1  ON 73
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 4.0850e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s094 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s094 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=94  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6901e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 94
    time step          = 0.05
    reference energy   = -16.8503
    reference variance = 0.350345
====================================================
  Execution time = 1.4826e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s094
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5260e+04
  VMC Eavg = -1.6903e+01
  VMC Evar = 3.1066e-01
  Total weights = 1.952139557e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 2.5795e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.300511317282
                                         uncertainty =       0.001468317019

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.300511317282
                                         uncertainty =       0.001468317019

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000387618051
  error estimate for blocks of size 2^( 2) =       0.000402264600
  error estimate for blocks of size 2^( 3) =       0.000417102832
  error estimate for blocks of size 2^( 4) =       0.000430597464
  error estimate for blocks of size 2^( 5) =       0.000442347897
  error estimate for blocks of size 2^( 6) =       0.000451893834
  error estimate for blocks of size 2^( 7) =       0.000456716708

      target function =      -0.891399078297
              le_mean =     -16.902689210458
             les_mean =     286.011566809726
             stat err =       0.000445388976
             autocorr =       1.320294878380
   target nu stat err =       0.000445388976
   target dn stat err =       0.001987429416
      target stat err =       0.002610272156
              std dev =       0.548174704961
             le_variance =       0.300495507159


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690268921046e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 74
Check correct_vf_var_size: 225, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 3.5527e+04, overlap shift 3.5527e+05 and omega -1.7527e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.891405597863       residual = 8.65e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.891405599085       residual = 1.14e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.891405599251       residual = 4.38e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.891405599352       residual = 1.85e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.891405599360       residual = 6.49e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.891405599444       residual = 2.64e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.891405599461       residual = 1.34e-05           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.891405599497       residual = 1.01e-05           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.891405599428       residual = 9.43e-06           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.891405599343       residual = 6.54e-06           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.891405599452       residual = 4.18e-06           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.891405599353       residual = 1.81e-06           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.891405599382       residual = 6.90e-07           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.891405599433       residual = 1.77e-07           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.891405599348       residual = 3.95e-08           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.891405599407       residual = 7.33e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         15 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 3.5527e+04 is 7.325116e-09

solving harmonic davidson linear method for identity shift 1.4211e+05, overlap shift 1.4211e+06 and omega -1.7527e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.891405597863       residual = 8.65e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.891405598168       residual = 1.14e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.891405598210       residual = 4.38e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.891405598235       residual = 1.85e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.891405598242       residual = 6.49e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.891405598382       residual = 2.64e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.891405598363       residual = 1.34e-05           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.891405598096       residual = 1.01e-05           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.891405598467       residual = 9.43e-06           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.891405598328       residual = 6.54e-06           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.891405598175       residual = 4.18e-06           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.891405598100       residual = 1.81e-06           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.891405598044       residual = 6.90e-07           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.891405597772       residual = 1.77e-07           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.891405597990       residual = 3.95e-08           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.891405598083       residual = 7.33e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         15 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 1.4211e+05 is 1.831280e-09

solving harmonic davidson linear method for identity shift 5.6843e+05, overlap shift 5.6843e+06 and omega -1.7527e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.891405597863       residual = 8.65e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.891405597939       residual = 1.14e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.891405597950       residual = 4.38e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.891405597956       residual = 1.85e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.891405597908       residual = 6.49e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.891405597981       residual = 2.64e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.891405598220       residual = 1.34e-05           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.891405598278       residual = 1.01e-05           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.891405597745       residual = 9.43e-06           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.891405597488       residual = 6.54e-06           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.891405598423       residual = 4.18e-06           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.891405597712       residual = 1.81e-06           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.891405597921       residual = 6.90e-07           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.891405597914       residual = 1.77e-07           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.891405597173       residual = 3.95e-08           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.891405598722       residual = 7.33e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         15 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 5.6843e+05 is 4.578201e-10

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               1.186249 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 75 and numParams is: 74

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.7419e+01
  </log>
  <optVariables href="H2O.s094.opt.xml">
ci_0001                 7.026294e-01 3 1  ON 0
ci_0002                 6.983279e-01 3 1  ON 1
ci_0003                -3.181708e-02 3 1  ON 2
ci_0004                -3.148888e-02 3 1  ON 3
ci_0005                -2.842198e-02 3 1  ON 4
ci_0006                -2.962380e-02 3 1  ON 5
ci_0007                -1.644646e-02 3 1  ON 6
ci_0008                -1.721863e-02 3 1  ON 7
ci_0009                -1.895887e-02 3 1  ON 8
ci_0010                -1.909747e-02 3 1  ON 9
ci_0011                -1.578360e-02 3 1  ON 10
ci_0012                -1.579241e-02 3 1  ON 11
ci_0013                 1.568461e-02 3 1  ON 12
ci_0014                 1.561327e-02 3 1  ON 13
ci_0015                 1.647820e-02 3 1  ON 14
ci_0016                 1.619584e-02 3 1  ON 15
ci_0017                 1.384672e-02 3 1  ON 16
ci_0018                 1.415257e-02 3 1  ON 17
ci_0019                 1.243859e-02 3 1  ON 18
ci_0020                 1.205185e-02 3 1  ON 19
ci_0021                 1.539483e-02 3 1  ON 20
ci_0022                 1.641549e-02 3 1  ON 21
ci_0023                -1.177804e-02 3 1  ON 22
ci_0024                -1.103743e-02 3 1  ON 23
ci_0025                -2.989035e-03 3 1  ON 24
ci_0026                -2.657136e-03 3 1  ON 25
ci_0027                -1.174735e-02 3 1  ON 26
ci_0028                -1.172146e-02 3 1  ON 27
ci_0029                -1.033864e-02 3 1  ON 28
ci_0030                -1.028740e-02 3 1  ON 29
ci_0031                 1.407063e-02 3 1  ON 30
ci_0032                 1.310028e-02 3 1  ON 31
ci_0033                 8.463042e-03 3 1  ON 32
ci_0034                 8.659738e-03 3 1  ON 33
ci_0035                 5.045257e-03 3 1  ON 34
ci_0036                 4.826568e-03 3 1  ON 35
ci_0037                -1.143338e-02 3 1  ON 36
ci_0038                -1.140350e-02 3 1  ON 37
ci_0039                -3.804123e-03 3 1  ON 38
ci_0040                -3.933526e-03 3 1  ON 39
ci_0041                 9.636287e-03 3 1  ON 40
ci_0042                 9.532953e-03 3 1  ON 41
ci_0043                -6.343090e-03 3 1  ON 42
ci_0044                -6.774435e-03 3 1  ON 43
ci_0045                 1.045933e-02 3 1  ON 44
ci_0046                 9.383508e-03 3 1  ON 45
ci_0047                -3.644267e-03 3 1  ON 46
ci_0048                -3.595064e-03 3 1  ON 47
ci_0049                -2.504341e-03 3 1  ON 48
ci_0050                -2.823114e-03 3 1  ON 49
ci_0051                -1.835867e-03 3 1  ON 50
ci_0052                -1.716010e-03 3 1  ON 51
ci_0053                -4.036072e-03 3 1  ON 52
ci_0054                -3.938128e-03 3 1  ON 53
ci_0055                 2.508102e-03 3 1  ON 54
ci_0056                 2.146634e-03 3 1  ON 55
ci_0057                 2.391280e-03 3 1  ON 56
ci_0058                 3.125210e-03 3 1  ON 57
ci_0059                -4.061038e-03 3 1  ON 58
ci_0060                -3.655086e-03 3 1  ON 59
ci_0061                -2.865950e-03 3 1  ON 60
ci_0062                -3.079645e-03 3 1  ON 61
ci_0063                -9.741523e-03 3 1  ON 62
ci_0064                -9.713259e-03 3 1  ON 63
ci_0065                -7.181074e-03 3 1  ON 64
ci_0066                -6.636015e-03 3 1  ON 65
ci_0067                -3.951506e-03 3 1  ON 66
ci_0068                -3.957852e-03 3 1  ON 67
ci_0069                 3.825531e-03 3 1  ON 68
ci_0070                 3.580873e-03 3 1  ON 69
ci_0071                 4.381187e-03 3 1  ON 70
ci_0072                 4.651016e-03 3 1  ON 71
ci_0073                 3.394232e-03 3 1  ON 72
ci_0074                 3.189410e-03 3 1  ON 73
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 94
    time step          = 0.05
    reference energy   = -16.9656
    reference variance = 0.27384
====================================================
  Execution time = 1.4026e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s094
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6903e+01
  VMC Evar = 3.2014e-01
  Total weights = 1.9519e+06
  Execution time = 1.8947e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.307292402514
                                         uncertainty =       0.003603514057

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.307292402514
                                         uncertainty =       0.003603514057

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000391933854
  error estimate for blocks of size 2^( 2) =       0.000406367557
  error estimate for blocks of size 2^( 3) =       0.000421362675
  error estimate for blocks of size 2^( 4) =       0.000435096755
  error estimate for blocks of size 2^( 5) =       0.000446194540
  error estimate for blocks of size 2^( 6) =       0.000455508484
  error estimate for blocks of size 2^( 7) =       0.000459329194

      target function =      -0.879518145184
              le_mean =     -16.903063005700
             les_mean =     286.033675858545
             stat err =       0.000449032243
             autocorr =       1.312591230350
   target nu stat err =       0.000449032243
   target dn stat err =       0.004471260239
      target stat err =       0.005584025959
              std dev =       0.554278171593
             le_variance =       0.307224291504

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.307292401611
                                         uncertainty =       0.003603514045

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.307292401611
                                         uncertainty =       0.003603514045

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000391933853
  error estimate for blocks of size 2^( 2) =       0.000406367557
  error estimate for blocks of size 2^( 3) =       0.000421362675
  error estimate for blocks of size 2^( 4) =       0.000435096755
  error estimate for blocks of size 2^( 5) =       0.000446194540
  error estimate for blocks of size 2^( 6) =       0.000455508484
  error estimate for blocks of size 2^( 7) =       0.000459329194

      target function =      -0.879518142508
              le_mean =     -16.903063005769
             les_mean =     286.033675863010
             stat err =       0.000449032244
             autocorr =       1.312591236416
   target nu stat err =       0.000449032244
   target dn stat err =       0.004471260609
      target stat err =       0.005584026382
              std dev =       0.554278170782
             le_variance =       0.307224290606

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.307292402062
                                         uncertainty =       0.003603514051

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.307292402062
                                         uncertainty =       0.003603514051

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000391933854
  error estimate for blocks of size 2^( 2) =       0.000406367557
  error estimate for blocks of size 2^( 3) =       0.000421362675
  error estimate for blocks of size 2^( 4) =       0.000435096755
  error estimate for blocks of size 2^( 5) =       0.000446194540
  error estimate for blocks of size 2^( 6) =       0.000455508484
  error estimate for blocks of size 2^( 7) =       0.000459329194

      target function =      -0.879518143846
              le_mean =     -16.903063005735
             les_mean =     286.033675860777
             stat err =       0.000449032243
             autocorr =       1.312591233386
   target nu stat err =       0.000449032243
   target dn stat err =       0.004471260424
      target stat err =       0.005584026170
              std dev =       0.554278171187
             le_variance =       0.307224291055

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.307292402457
                                         uncertainty =       0.003603514056

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.307292402457
                                         uncertainty =       0.003603514056

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000391933854
  error estimate for blocks of size 2^( 2) =       0.000406367557
  error estimate for blocks of size 2^( 3) =       0.000421362675
  error estimate for blocks of size 2^( 4) =       0.000435096755
  error estimate for blocks of size 2^( 5) =       0.000446194540
  error estimate for blocks of size 2^( 6) =       0.000455508484
  error estimate for blocks of size 2^( 7) =       0.000459329194

      target function =      -0.879518145016
              le_mean =     -16.903063005705
             les_mean =     286.033675858824
             stat err =       0.000449032243
             autocorr =       1.312591230735
   target nu stat err =       0.000449032243
   target dn stat err =       0.004471260262
      target stat err =       0.005584025986
              std dev =       0.554278171542
             le_variance =       0.307224291448


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.879518145184        initial  <--
     3.5527e+04     3.5527e+05             7.3251e-09        -0.879518142508
     1.4211e+05     1.4211e+06             1.8313e-09        -0.879518143846
     5.6843e+05     5.6843e+06             4.5782e-10        -0.879518145016

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 23.5792
  </log>
  <optVariables href="H2O.s094.opt.xml">
ci_0001                 7.026294e-01 3 1  ON 0
ci_0002                 6.983279e-01 3 1  ON 1
ci_0003                -3.181708e-02 3 1  ON 2
ci_0004                -3.148888e-02 3 1  ON 3
ci_0005                -2.842198e-02 3 1  ON 4
ci_0006                -2.962380e-02 3 1  ON 5
ci_0007                -1.644646e-02 3 1  ON 6
ci_0008                -1.721863e-02 3 1  ON 7
ci_0009                -1.895887e-02 3 1  ON 8
ci_0010                -1.909747e-02 3 1  ON 9
ci_0011                -1.578360e-02 3 1  ON 10
ci_0012                -1.579241e-02 3 1  ON 11
ci_0013                 1.568461e-02 3 1  ON 12
ci_0014                 1.561327e-02 3 1  ON 13
ci_0015                 1.647820e-02 3 1  ON 14
ci_0016                 1.619584e-02 3 1  ON 15
ci_0017                 1.384672e-02 3 1  ON 16
ci_0018                 1.415257e-02 3 1  ON 17
ci_0019                 1.243859e-02 3 1  ON 18
ci_0020                 1.205185e-02 3 1  ON 19
ci_0021                 1.539483e-02 3 1  ON 20
ci_0022                 1.641549e-02 3 1  ON 21
ci_0023                -1.177804e-02 3 1  ON 22
ci_0024                -1.103743e-02 3 1  ON 23
ci_0025                -2.989036e-03 3 1  ON 24
ci_0026                -2.657138e-03 3 1  ON 25
ci_0027                -1.174735e-02 3 1  ON 26
ci_0028                -1.172146e-02 3 1  ON 27
ci_0029                -1.033864e-02 3 1  ON 28
ci_0030                -1.028740e-02 3 1  ON 29
ci_0031                 1.407063e-02 3 1  ON 30
ci_0032                 1.310028e-02 3 1  ON 31
ci_0033                 8.463042e-03 3 1  ON 32
ci_0034                 8.659737e-03 3 1  ON 33
ci_0035                 5.045258e-03 3 1  ON 34
ci_0036                 4.826567e-03 3 1  ON 35
ci_0037                -1.143338e-02 3 1  ON 36
ci_0038                -1.140351e-02 3 1  ON 37
ci_0039                -3.804123e-03 3 1  ON 38
ci_0040                -3.933526e-03 3 1  ON 39
ci_0041                 9.636287e-03 3 1  ON 40
ci_0042                 9.532954e-03 3 1  ON 41
ci_0043                -6.343089e-03 3 1  ON 42
ci_0044                -6.774436e-03 3 1  ON 43
ci_0045                 1.045933e-02 3 1  ON 44
ci_0046                 9.383508e-03 3 1  ON 45
ci_0047                -3.644267e-03 3 1  ON 46
ci_0048                -3.595064e-03 3 1  ON 47
ci_0049                -2.504342e-03 3 1  ON 48
ci_0050                -2.823113e-03 3 1  ON 49
ci_0051                -1.835868e-03 3 1  ON 50
ci_0052                -1.716010e-03 3 1  ON 51
ci_0053                -4.036072e-03 3 1  ON 52
ci_0054                -3.938128e-03 3 1  ON 53
ci_0055                 2.508102e-03 3 1  ON 54
ci_0056                 2.146634e-03 3 1  ON 55
ci_0057                 2.391279e-03 3 1  ON 56
ci_0058                 3.125210e-03 3 1  ON 57
ci_0059                -4.061037e-03 3 1  ON 58
ci_0060                -3.655087e-03 3 1  ON 59
ci_0061                -2.865950e-03 3 1  ON 60
ci_0062                -3.079645e-03 3 1  ON 61
ci_0063                -9.741523e-03 3 1  ON 62
ci_0064                -9.713259e-03 3 1  ON 63
ci_0065                -7.181074e-03 3 1  ON 64
ci_0066                -6.636015e-03 3 1  ON 65
ci_0067                -3.951506e-03 3 1  ON 66
ci_0068                -3.957851e-03 3 1  ON 67
ci_0069                 3.825531e-03 3 1  ON 68
ci_0070                 3.580873e-03 3 1  ON 69
ci_0071                 4.381186e-03 3 1  ON 70
ci_0072                 4.651015e-03 3 1  ON 71
ci_0073                 3.394233e-03 3 1  ON 72
ci_0074                 3.189411e-03 3 1  ON 73
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 4.1004e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s095 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s095 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=95  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6901e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 95
    time step          = 0.05
    reference energy   = -16.9294
    reference variance = 0.230087
====================================================
  Execution time = 1.6992e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s095
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5217e+04
  VMC Eavg = -1.6903e+01
  VMC Evar = 3.1688e-01
  Total weights = 1.951922613e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 2.5798e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.306005030481
                                         uncertainty =       0.002154492600

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.306005030481
                                         uncertainty =       0.002154492600

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000391099605
  error estimate for blocks of size 2^( 2) =       0.000405356092
  error estimate for blocks of size 2^( 3) =       0.000419558730
  error estimate for blocks of size 2^( 4) =       0.000432341594
  error estimate for blocks of size 2^( 5) =       0.000444522253
  error estimate for blocks of size 2^( 6) =       0.000452068203
  error estimate for blocks of size 2^( 7) =       0.000458089213

      target function =      -0.883633354089
              le_mean =     -16.903349417024
             les_mean =     286.040106137233
             stat err =       0.000446755315
             autocorr =       1.304862355123
   target nu stat err =       0.000446755315
   target dn stat err =       0.002873138674
      target stat err =       0.003655339491
              std dev =       0.553098365708
             le_variance =       0.305917802149


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690334941702e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 74
Check correct_vf_var_size: 225, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 3.5527e+05, overlap shift 3.5527e+06 and omega -1.7527e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.883647416193       residual = 5.89e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.883647416292       residual = 1.11e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.883647416310       residual = 4.84e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.883647416318       residual = 2.21e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.883647416323       residual = 6.39e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.883647416324       residual = 1.80e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.883647416324       residual = 8.65e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.883647416324       residual = 6.56e-06           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.883647416324       residual = 3.29e-06           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.883647416325       residual = 2.69e-06           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.883647417054       residual = 2.08e-06           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.883647414998       residual = 1.83e-06           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.883647416325       residual = 6.76e-07           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.883647416761       residual = 1.52e-07           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.883647415289       residual = 3.73e-08           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.883647416325       residual = 1.00e-08           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.883647416913       residual = 1.90e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         16 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 3.5527e+05 is 6.608771e-10

solving harmonic davidson linear method for identity shift 1.4211e+06, overlap shift 1.4211e+07 and omega -1.7527e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.883647416193       residual = 5.89e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.883647416218       residual = 1.11e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.883647416222       residual = 4.84e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.883647416127       residual = 2.21e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.883647416225       residual = 6.39e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.883647418690       residual = 1.80e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.883647416226       residual = 8.65e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.883647417097       residual = 6.56e-06           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.883647416226       residual = 3.29e-06           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.883647416226       residual = 2.69e-06           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.883647417200       residual = 2.08e-06           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.883647416226       residual = 1.83e-06           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.883647416226       residual = 6.76e-07           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.883647416820       residual = 1.52e-07           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.883647416226       residual = 3.73e-08           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.883647416088       residual = 1.00e-08           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.883647416226       residual = 1.90e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         16 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 1.4211e+06 is 1.652192e-10

solving harmonic davidson linear method for identity shift 5.6843e+06, overlap shift 5.6843e+07 and omega -1.7527e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.883647416193       residual = 5.89e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.883647416199       residual = 1.11e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.883647416200       residual = 4.84e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.883647416579       residual = 2.21e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.883647416201       residual = 6.39e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.883647423475       residual = 1.80e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.883647415981       residual = 8.65e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.883647417637       residual = 6.56e-06           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.883647416201       residual = 3.29e-06           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.883647413793       residual = 2.69e-06           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.883647429758       residual = 2.08e-06           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.883647411683       residual = 1.83e-06           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.883647416201       residual = 6.76e-07           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.883647416201       residual = 1.52e-07           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.883647416201       residual = 3.73e-08           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.883647405487       residual = 1.00e-08           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.883647417029       residual = 1.90e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         16 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 5.6843e+06 is 4.130487e-11

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               1.195238 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 75 and numParams is: 74

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.9586e+01
  </log>
  <optVariables href="H2O.s095.opt.xml">
ci_0001                 7.026294e-01 3 1  ON 0
ci_0002                 6.983279e-01 3 1  ON 1
ci_0003                -3.181708e-02 3 1  ON 2
ci_0004                -3.148888e-02 3 1  ON 3
ci_0005                -2.842198e-02 3 1  ON 4
ci_0006                -2.962380e-02 3 1  ON 5
ci_0007                -1.644646e-02 3 1  ON 6
ci_0008                -1.721863e-02 3 1  ON 7
ci_0009                -1.895887e-02 3 1  ON 8
ci_0010                -1.909747e-02 3 1  ON 9
ci_0011                -1.578360e-02 3 1  ON 10
ci_0012                -1.579241e-02 3 1  ON 11
ci_0013                 1.568461e-02 3 1  ON 12
ci_0014                 1.561327e-02 3 1  ON 13
ci_0015                 1.647820e-02 3 1  ON 14
ci_0016                 1.619584e-02 3 1  ON 15
ci_0017                 1.384672e-02 3 1  ON 16
ci_0018                 1.415257e-02 3 1  ON 17
ci_0019                 1.243859e-02 3 1  ON 18
ci_0020                 1.205185e-02 3 1  ON 19
ci_0021                 1.539483e-02 3 1  ON 20
ci_0022                 1.641549e-02 3 1  ON 21
ci_0023                -1.177804e-02 3 1  ON 22
ci_0024                -1.103743e-02 3 1  ON 23
ci_0025                -2.989036e-03 3 1  ON 24
ci_0026                -2.657138e-03 3 1  ON 25
ci_0027                -1.174735e-02 3 1  ON 26
ci_0028                -1.172146e-02 3 1  ON 27
ci_0029                -1.033864e-02 3 1  ON 28
ci_0030                -1.028740e-02 3 1  ON 29
ci_0031                 1.407063e-02 3 1  ON 30
ci_0032                 1.310028e-02 3 1  ON 31
ci_0033                 8.463042e-03 3 1  ON 32
ci_0034                 8.659737e-03 3 1  ON 33
ci_0035                 5.045258e-03 3 1  ON 34
ci_0036                 4.826567e-03 3 1  ON 35
ci_0037                -1.143338e-02 3 1  ON 36
ci_0038                -1.140351e-02 3 1  ON 37
ci_0039                -3.804123e-03 3 1  ON 38
ci_0040                -3.933527e-03 3 1  ON 39
ci_0041                 9.636287e-03 3 1  ON 40
ci_0042                 9.532954e-03 3 1  ON 41
ci_0043                -6.343089e-03 3 1  ON 42
ci_0044                -6.774436e-03 3 1  ON 43
ci_0045                 1.045933e-02 3 1  ON 44
ci_0046                 9.383508e-03 3 1  ON 45
ci_0047                -3.644267e-03 3 1  ON 46
ci_0048                -3.595064e-03 3 1  ON 47
ci_0049                -2.504341e-03 3 1  ON 48
ci_0050                -2.823113e-03 3 1  ON 49
ci_0051                -1.835868e-03 3 1  ON 50
ci_0052                -1.716010e-03 3 1  ON 51
ci_0053                -4.036072e-03 3 1  ON 52
ci_0054                -3.938128e-03 3 1  ON 53
ci_0055                 2.508102e-03 3 1  ON 54
ci_0056                 2.146634e-03 3 1  ON 55
ci_0057                 2.391279e-03 3 1  ON 56
ci_0058                 3.125210e-03 3 1  ON 57
ci_0059                -4.061037e-03 3 1  ON 58
ci_0060                -3.655087e-03 3 1  ON 59
ci_0061                -2.865950e-03 3 1  ON 60
ci_0062                -3.079645e-03 3 1  ON 61
ci_0063                -9.741523e-03 3 1  ON 62
ci_0064                -9.713259e-03 3 1  ON 63
ci_0065                -7.181074e-03 3 1  ON 64
ci_0066                -6.636015e-03 3 1  ON 65
ci_0067                -3.951506e-03 3 1  ON 66
ci_0068                -3.957851e-03 3 1  ON 67
ci_0069                 3.825531e-03 3 1  ON 68
ci_0070                 3.580873e-03 3 1  ON 69
ci_0071                 4.381186e-03 3 1  ON 70
ci_0072                 4.651015e-03 3 1  ON 71
ci_0073                 3.394233e-03 3 1  ON 72
ci_0074                 3.189411e-03 3 1  ON 73
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 95
    time step          = 0.05
    reference energy   = -16.9326
    reference variance = 0.333745
====================================================
  Execution time = 1.4042e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s095
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6903e+01
  VMC Evar = 3.1292e-01
  Total weights = 1.9516e+06
  Execution time = 1.8943e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.302358931221
                                         uncertainty =       0.001637959294

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.302358931221
                                         uncertainty =       0.001637959294

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000388776589
  error estimate for blocks of size 2^( 2) =       0.000403168592
  error estimate for blocks of size 2^( 3) =       0.000417760924
  error estimate for blocks of size 2^( 4) =       0.000431296514
  error estimate for blocks of size 2^( 5) =       0.000442962539
  error estimate for blocks of size 2^( 6) =       0.000450740411
  error estimate for blocks of size 2^( 7) =       0.000458624738

      target function =      -0.888574390685
              le_mean =     -16.902973159786
             les_mean =     286.023423673832
             stat err =       0.000445906050
             autocorr =       1.315486877507
   target nu stat err =       0.000445906050
   target dn stat err =       0.002239340308
      target stat err =       0.002905944255
              std dev =       0.549813125060
             le_variance =       0.302294472489

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.302358931196
                                         uncertainty =       0.001637959286

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.302358931196
                                         uncertainty =       0.001637959286

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000388776589
  error estimate for blocks of size 2^( 2) =       0.000403168592
  error estimate for blocks of size 2^( 3) =       0.000417760924
  error estimate for blocks of size 2^( 4) =       0.000431296514
  error estimate for blocks of size 2^( 5) =       0.000442962539
  error estimate for blocks of size 2^( 6) =       0.000450740411
  error estimate for blocks of size 2^( 7) =       0.000458624738

      target function =      -0.888574391501
              le_mean =     -16.902973159785
             les_mean =     286.023423673159
             stat err =       0.000445906051
             autocorr =       1.315486878141
   target nu stat err =       0.000445906051
   target dn stat err =       0.002239340296
      target stat err =       0.002905944246
              std dev =       0.549813125038
             le_variance =       0.302294472464

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.302358931208
                                         uncertainty =       0.001637959290

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.302358931208
                                         uncertainty =       0.001637959290

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000388776589
  error estimate for blocks of size 2^( 2) =       0.000403168592
  error estimate for blocks of size 2^( 3) =       0.000417760924
  error estimate for blocks of size 2^( 4) =       0.000431296514
  error estimate for blocks of size 2^( 5) =       0.000442962539
  error estimate for blocks of size 2^( 6) =       0.000450740411
  error estimate for blocks of size 2^( 7) =       0.000458624738

      target function =      -0.888574391093
              le_mean =     -16.902973159786
             les_mean =     286.023423673496
             stat err =       0.000445906051
             autocorr =       1.315486877826
   target nu stat err =       0.000445906051
   target dn stat err =       0.002239340302
      target stat err =       0.002905944250
              std dev =       0.549813125049
             le_variance =       0.302294472476

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.302358931219
                                         uncertainty =       0.001637959293

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.302358931219
                                         uncertainty =       0.001637959293

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000388776589
  error estimate for blocks of size 2^( 2) =       0.000403168592
  error estimate for blocks of size 2^( 3) =       0.000417760924
  error estimate for blocks of size 2^( 4) =       0.000431296514
  error estimate for blocks of size 2^( 5) =       0.000442962539
  error estimate for blocks of size 2^( 6) =       0.000450740411
  error estimate for blocks of size 2^( 7) =       0.000458624738

      target function =      -0.888574390736
              le_mean =     -16.902973159786
             les_mean =     286.023423673790
             stat err =       0.000445906050
             autocorr =       1.315486877556
   target nu stat err =       0.000445906050
   target dn stat err =       0.002239340307
      target stat err =       0.002905944254
              std dev =       0.549813125059
             le_variance =       0.302294472487


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.888574390685        initial
     3.5527e+05     3.5527e+06             6.6088e-10        -0.888574391501  <--
     1.4211e+06     1.4211e+07             1.6522e-10        -0.888574391093
     5.6843e+06     5.6843e+07             4.1305e-11        -0.888574390736

*****************************************************************************
Applying the update for shift_i =   3.5527e+05     and shift_s =   3.5527e+06
*****************************************************************************

  Execution time = 2.3600e+01
  </log>
  <optVariables href="H2O.s095.opt.xml">
ci_0001                 7.026294e-01 3 1  ON 0
ci_0002                 6.983279e-01 3 1  ON 1
ci_0003                -3.181708e-02 3 1  ON 2
ci_0004                -3.148888e-02 3 1  ON 3
ci_0005                -2.842198e-02 3 1  ON 4
ci_0006                -2.962380e-02 3 1  ON 5
ci_0007                -1.644646e-02 3 1  ON 6
ci_0008                -1.721863e-02 3 1  ON 7
ci_0009                -1.895887e-02 3 1  ON 8
ci_0010                -1.909747e-02 3 1  ON 9
ci_0011                -1.578360e-02 3 1  ON 10
ci_0012                -1.579241e-02 3 1  ON 11
ci_0013                 1.568461e-02 3 1  ON 12
ci_0014                 1.561327e-02 3 1  ON 13
ci_0015                 1.647820e-02 3 1  ON 14
ci_0016                 1.619584e-02 3 1  ON 15
ci_0017                 1.384672e-02 3 1  ON 16
ci_0018                 1.415257e-02 3 1  ON 17
ci_0019                 1.243859e-02 3 1  ON 18
ci_0020                 1.205185e-02 3 1  ON 19
ci_0021                 1.539483e-02 3 1  ON 20
ci_0022                 1.641549e-02 3 1  ON 21
ci_0023                -1.177804e-02 3 1  ON 22
ci_0024                -1.103743e-02 3 1  ON 23
ci_0025                -2.989036e-03 3 1  ON 24
ci_0026                -2.657137e-03 3 1  ON 25
ci_0027                -1.174735e-02 3 1  ON 26
ci_0028                -1.172146e-02 3 1  ON 27
ci_0029                -1.033864e-02 3 1  ON 28
ci_0030                -1.028740e-02 3 1  ON 29
ci_0031                 1.407063e-02 3 1  ON 30
ci_0032                 1.310028e-02 3 1  ON 31
ci_0033                 8.463042e-03 3 1  ON 32
ci_0034                 8.659737e-03 3 1  ON 33
ci_0035                 5.045258e-03 3 1  ON 34
ci_0036                 4.826567e-03 3 1  ON 35
ci_0037                -1.143338e-02 3 1  ON 36
ci_0038                -1.140351e-02 3 1  ON 37
ci_0039                -3.804123e-03 3 1  ON 38
ci_0040                -3.933527e-03 3 1  ON 39
ci_0041                 9.636287e-03 3 1  ON 40
ci_0042                 9.532954e-03 3 1  ON 41
ci_0043                -6.343089e-03 3 1  ON 42
ci_0044                -6.774435e-03 3 1  ON 43
ci_0045                 1.045933e-02 3 1  ON 44
ci_0046                 9.383508e-03 3 1  ON 45
ci_0047                -3.644267e-03 3 1  ON 46
ci_0048                -3.595064e-03 3 1  ON 47
ci_0049                -2.504341e-03 3 1  ON 48
ci_0050                -2.823113e-03 3 1  ON 49
ci_0051                -1.835868e-03 3 1  ON 50
ci_0052                -1.716010e-03 3 1  ON 51
ci_0053                -4.036072e-03 3 1  ON 52
ci_0054                -3.938128e-03 3 1  ON 53
ci_0055                 2.508102e-03 3 1  ON 54
ci_0056                 2.146634e-03 3 1  ON 55
ci_0057                 2.391279e-03 3 1  ON 56
ci_0058                 3.125210e-03 3 1  ON 57
ci_0059                -4.061037e-03 3 1  ON 58
ci_0060                -3.655086e-03 3 1  ON 59
ci_0061                -2.865950e-03 3 1  ON 60
ci_0062                -3.079645e-03 3 1  ON 61
ci_0063                -9.741523e-03 3 1  ON 62
ci_0064                -9.713259e-03 3 1  ON 63
ci_0065                -7.181074e-03 3 1  ON 64
ci_0066                -6.636015e-03 3 1  ON 65
ci_0067                -3.951506e-03 3 1  ON 66
ci_0068                -3.957852e-03 3 1  ON 67
ci_0069                 3.825531e-03 3 1  ON 68
ci_0070                 3.580873e-03 3 1  ON 69
ci_0071                 4.381186e-03 3 1  ON 70
ci_0072                 4.651016e-03 3 1  ON 71
ci_0073                 3.394233e-03 3 1  ON 72
ci_0074                 3.189410e-03 3 1  ON 73
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 4.3192e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s096 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s096 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=96  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6901e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 96
    time step          = 0.05
    reference energy   = -16.9747
    reference variance = 0.331763
====================================================
  Execution time = 1.4520e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s096
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5240e+04
  VMC Eavg = -1.6903e+01
  VMC Evar = 3.1753e-01
  Total weights = 1.952040129e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 2.5829e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.306308669623
                                         uncertainty =       0.002490960876

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.306308669623
                                         uncertainty =       0.002490960876

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000391374110
  error estimate for blocks of size 2^( 2) =       0.000406413899
  error estimate for blocks of size 2^( 3) =       0.000421646837
  error estimate for blocks of size 2^( 4) =       0.000435035866
  error estimate for blocks of size 2^( 5) =       0.000447882667
  error estimate for blocks of size 2^( 6) =       0.000455912169
  error estimate for blocks of size 2^( 7) =       0.000462552099

      target function =      -0.882809557747
              le_mean =     -16.903225010873
             les_mean =     286.036544735123
             stat err =       0.000450345700
             autocorr =       1.324060578075
   target nu stat err =       0.000450345700
   target dn stat err =       0.002828472786
      target stat err =       0.003593807212
              std dev =       0.553486574047
             le_variance =       0.306347387651


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690322501087e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 74
Check correct_vf_var_size: 225, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 8.8818e+04, overlap shift 8.8818e+05 and omega -1.7527e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.882823086545       residual = 1.07e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.882823087206       residual = 1.45e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.882823087278       residual = 6.17e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.882823087329       residual = 2.41e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.882823087348       residual = 7.40e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.882823087419       residual = 6.13e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.882823087387       residual = 1.79e-05           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.882823087588       residual = 1.27e-05           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.882823087248       residual = 1.59e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.882823087343       residual = 8.59e-06           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.882823087319       residual = 5.27e-06           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.882823087423       residual = 2.13e-06           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.882823087476       residual = 9.47e-07           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.882823087425       residual = 1.25e-07           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.882823087282       residual = 3.56e-08           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.882823087078       residual = 8.70e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         15 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 8.8818e+04 is 3.118711e-09

solving harmonic davidson linear method for identity shift 3.5527e+05, overlap shift 3.5527e+06 and omega -1.7527e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.882823086545       residual = 1.07e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.882823086711       residual = 1.45e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.882823086729       residual = 6.17e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.882823086742       residual = 2.41e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.882823087083       residual = 7.40e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.882823086668       residual = 6.13e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.882823085642       residual = 1.79e-05           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.882823085685       residual = 1.27e-05           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.882823087309       residual = 1.59e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.882823086970       residual = 8.59e-06           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.882823086374       residual = 5.27e-06           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.882823086545       residual = 2.13e-06           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.882823086377       residual = 9.47e-07           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.882823086769       residual = 1.25e-07           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.882823087096       residual = 3.56e-08           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.882823086456       residual = 8.70e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         15 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 3.5527e+05 is 7.796777e-10

solving harmonic davidson linear method for identity shift 1.4211e+06, overlap shift 1.4211e+07 and omega -1.7527e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.882823086545       residual = 1.07e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.882823086587       residual = 1.45e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.882823086591       residual = 6.17e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.882823086594       residual = 2.41e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.882823085969       residual = 7.40e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.882823086156       residual = 6.13e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.882823087323       residual = 1.79e-05           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.882823087833       residual = 1.27e-05           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.882823086251       residual = 1.59e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.882823085851       residual = 8.59e-06           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.882823088235       residual = 5.27e-06           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.882823089416       residual = 2.13e-06           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.882823090294       residual = 9.47e-07           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.882823083862       residual = 1.25e-07           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.882823084267       residual = 3.56e-08           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.882823090161       residual = 8.70e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         15 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 1.4211e+06 is 1.949192e-10

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               1.203220 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 75 and numParams is: 74

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.7116e+01
  </log>
  <optVariables href="H2O.s096.opt.xml">
ci_0001                 7.026294e-01 3 1  ON 0
ci_0002                 6.983279e-01 3 1  ON 1
ci_0003                -3.181708e-02 3 1  ON 2
ci_0004                -3.148888e-02 3 1  ON 3
ci_0005                -2.842198e-02 3 1  ON 4
ci_0006                -2.962380e-02 3 1  ON 5
ci_0007                -1.644646e-02 3 1  ON 6
ci_0008                -1.721863e-02 3 1  ON 7
ci_0009                -1.895887e-02 3 1  ON 8
ci_0010                -1.909747e-02 3 1  ON 9
ci_0011                -1.578360e-02 3 1  ON 10
ci_0012                -1.579241e-02 3 1  ON 11
ci_0013                 1.568461e-02 3 1  ON 12
ci_0014                 1.561327e-02 3 1  ON 13
ci_0015                 1.647820e-02 3 1  ON 14
ci_0016                 1.619584e-02 3 1  ON 15
ci_0017                 1.384672e-02 3 1  ON 16
ci_0018                 1.415257e-02 3 1  ON 17
ci_0019                 1.243859e-02 3 1  ON 18
ci_0020                 1.205185e-02 3 1  ON 19
ci_0021                 1.539483e-02 3 1  ON 20
ci_0022                 1.641549e-02 3 1  ON 21
ci_0023                -1.177804e-02 3 1  ON 22
ci_0024                -1.103743e-02 3 1  ON 23
ci_0025                -2.989035e-03 3 1  ON 24
ci_0026                -2.657137e-03 3 1  ON 25
ci_0027                -1.174735e-02 3 1  ON 26
ci_0028                -1.172146e-02 3 1  ON 27
ci_0029                -1.033864e-02 3 1  ON 28
ci_0030                -1.028740e-02 3 1  ON 29
ci_0031                 1.407063e-02 3 1  ON 30
ci_0032                 1.310028e-02 3 1  ON 31
ci_0033                 8.463041e-03 3 1  ON 32
ci_0034                 8.659737e-03 3 1  ON 33
ci_0035                 5.045258e-03 3 1  ON 34
ci_0036                 4.826568e-03 3 1  ON 35
ci_0037                -1.143338e-02 3 1  ON 36
ci_0038                -1.140351e-02 3 1  ON 37
ci_0039                -3.804123e-03 3 1  ON 38
ci_0040                -3.933526e-03 3 1  ON 39
ci_0041                 9.636287e-03 3 1  ON 40
ci_0042                 9.532954e-03 3 1  ON 41
ci_0043                -6.343089e-03 3 1  ON 42
ci_0044                -6.774435e-03 3 1  ON 43
ci_0045                 1.045933e-02 3 1  ON 44
ci_0046                 9.383508e-03 3 1  ON 45
ci_0047                -3.644267e-03 3 1  ON 46
ci_0048                -3.595064e-03 3 1  ON 47
ci_0049                -2.504341e-03 3 1  ON 48
ci_0050                -2.823112e-03 3 1  ON 49
ci_0051                -1.835868e-03 3 1  ON 50
ci_0052                -1.716010e-03 3 1  ON 51
ci_0053                -4.036072e-03 3 1  ON 52
ci_0054                -3.938128e-03 3 1  ON 53
ci_0055                 2.508101e-03 3 1  ON 54
ci_0056                 2.146634e-03 3 1  ON 55
ci_0057                 2.391279e-03 3 1  ON 56
ci_0058                 3.125211e-03 3 1  ON 57
ci_0059                -4.061037e-03 3 1  ON 58
ci_0060                -3.655087e-03 3 1  ON 59
ci_0061                -2.865950e-03 3 1  ON 60
ci_0062                -3.079645e-03 3 1  ON 61
ci_0063                -9.741523e-03 3 1  ON 62
ci_0064                -9.713259e-03 3 1  ON 63
ci_0065                -7.181074e-03 3 1  ON 64
ci_0066                -6.636015e-03 3 1  ON 65
ci_0067                -3.951506e-03 3 1  ON 66
ci_0068                -3.957852e-03 3 1  ON 67
ci_0069                 3.825531e-03 3 1  ON 68
ci_0070                 3.580873e-03 3 1  ON 69
ci_0071                 4.381186e-03 3 1  ON 70
ci_0072                 4.651016e-03 3 1  ON 71
ci_0073                 3.394232e-03 3 1  ON 72
ci_0074                 3.189410e-03 3 1  ON 73
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 96
    time step          = 0.05
    reference energy   = -16.9255
    reference variance = 0.244519
====================================================
  Execution time = 1.4246e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s096
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6903e+01
  VMC Evar = 3.2108e-01
  Total weights = 1.9516e+06
  Execution time = 1.8976e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.307484165684
                                         uncertainty =       0.004290586124

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.307484165684
                                         uncertainty =       0.004290586124

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000392101519
  error estimate for blocks of size 2^( 2) =       0.000406288364
  error estimate for blocks of size 2^( 3) =       0.000420742062
  error estimate for blocks of size 2^( 4) =       0.000432846570
  error estimate for blocks of size 2^( 5) =       0.000443856387
  error estimate for blocks of size 2^( 6) =       0.000452679647
  error estimate for blocks of size 2^( 7) =       0.000457069579

      target function =      -0.878312621933
              le_mean =     -16.903371468983
             les_mean =     286.045049085088
             stat err =       0.000446613046
             autocorr =       1.297375701212
   target nu stat err =       0.000446613046
   target dn stat err =       0.007962696984
      target stat err =       0.009878920651
              std dev =       0.554515286131
             le_variance =       0.307487202553

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.307484165831
                                         uncertainty =       0.004290586485

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.307484165831
                                         uncertainty =       0.004290586485

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000392101519
  error estimate for blocks of size 2^( 2) =       0.000406288364
  error estimate for blocks of size 2^( 3) =       0.000420742062
  error estimate for blocks of size 2^( 4) =       0.000432846570
  error estimate for blocks of size 2^( 5) =       0.000443856387
  error estimate for blocks of size 2^( 6) =       0.000452679647
  error estimate for blocks of size 2^( 7) =       0.000457069580

      target function =      -0.878312845460
              le_mean =     -16.903371468972
             les_mean =     286.045048904115
             stat err =       0.000446613046
             autocorr =       1.297375703069
   target nu stat err =       0.000446613046
   target dn stat err =       0.007962697240
      target stat err =       0.009878925986
              std dev =       0.554515286267
             le_variance =       0.307487202703

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.307484165757
                                         uncertainty =       0.004290586305

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.307484165757
                                         uncertainty =       0.004290586305

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000392101519
  error estimate for blocks of size 2^( 2) =       0.000406288364
  error estimate for blocks of size 2^( 3) =       0.000420742062
  error estimate for blocks of size 2^( 4) =       0.000432846570
  error estimate for blocks of size 2^( 5) =       0.000443856387
  error estimate for blocks of size 2^( 6) =       0.000452679647
  error estimate for blocks of size 2^( 7) =       0.000457069580

      target function =      -0.878312733931
              le_mean =     -16.903371468978
             les_mean =     286.045048994412
             stat err =       0.000446613046
             autocorr =       1.297375702148
   target nu stat err =       0.000446613046
   target dn stat err =       0.007962697111
      target stat err =       0.009878923322
              std dev =       0.554515286199
             le_variance =       0.307487202628

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.307484165693
                                         uncertainty =       0.004290586146

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.307484165693
                                         uncertainty =       0.004290586146

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000392101519
  error estimate for blocks of size 2^( 2) =       0.000406288364
  error estimate for blocks of size 2^( 3) =       0.000420742062
  error estimate for blocks of size 2^( 4) =       0.000432846570
  error estimate for blocks of size 2^( 5) =       0.000443856387
  error estimate for blocks of size 2^( 6) =       0.000452679647
  error estimate for blocks of size 2^( 7) =       0.000457069579

      target function =      -0.878312635958
              le_mean =     -16.903371468983
             les_mean =     286.045049073733
             stat err =       0.000446613046
             autocorr =       1.297375701333
   target nu stat err =       0.000446613046
   target dn stat err =       0.007962697000
      target stat err =       0.009878920985
              std dev =       0.554515286139
             le_variance =       0.307487202562


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.878312621933        initial
     8.8818e+04     8.8818e+05             3.1187e-09        -0.878312845460  <--
     3.5527e+05     3.5527e+06             7.7968e-10        -0.878312733931
     1.4211e+06     1.4211e+07             1.9492e-10        -0.878312635958

*****************************************************************************
Applying the update for shift_i =   8.8818e+04     and shift_s =   8.8818e+05
*****************************************************************************

  Execution time = 2.3927e+01
  </log>
  <optVariables href="H2O.s096.opt.xml">
ci_0001                 7.026294e-01 3 1  ON 0
ci_0002                 6.983279e-01 3 1  ON 1
ci_0003                -3.181708e-02 3 1  ON 2
ci_0004                -3.148888e-02 3 1  ON 3
ci_0005                -2.842197e-02 3 1  ON 4
ci_0006                -2.962380e-02 3 1  ON 5
ci_0007                -1.644646e-02 3 1  ON 6
ci_0008                -1.721863e-02 3 1  ON 7
ci_0009                -1.895887e-02 3 1  ON 8
ci_0010                -1.909747e-02 3 1  ON 9
ci_0011                -1.578360e-02 3 1  ON 10
ci_0012                -1.579241e-02 3 1  ON 11
ci_0013                 1.568461e-02 3 1  ON 12
ci_0014                 1.561327e-02 3 1  ON 13
ci_0015                 1.647820e-02 3 1  ON 14
ci_0016                 1.619584e-02 3 1  ON 15
ci_0017                 1.384672e-02 3 1  ON 16
ci_0018                 1.415258e-02 3 1  ON 17
ci_0019                 1.243859e-02 3 1  ON 18
ci_0020                 1.205185e-02 3 1  ON 19
ci_0021                 1.539483e-02 3 1  ON 20
ci_0022                 1.641549e-02 3 1  ON 21
ci_0023                -1.177804e-02 3 1  ON 22
ci_0024                -1.103743e-02 3 1  ON 23
ci_0025                -2.989035e-03 3 1  ON 24
ci_0026                -2.657137e-03 3 1  ON 25
ci_0027                -1.174735e-02 3 1  ON 26
ci_0028                -1.172146e-02 3 1  ON 27
ci_0029                -1.033864e-02 3 1  ON 28
ci_0030                -1.028740e-02 3 1  ON 29
ci_0031                 1.407063e-02 3 1  ON 30
ci_0032                 1.310028e-02 3 1  ON 31
ci_0033                 8.463040e-03 3 1  ON 32
ci_0034                 8.659737e-03 3 1  ON 33
ci_0035                 5.045258e-03 3 1  ON 34
ci_0036                 4.826570e-03 3 1  ON 35
ci_0037                -1.143338e-02 3 1  ON 36
ci_0038                -1.140351e-02 3 1  ON 37
ci_0039                -3.804123e-03 3 1  ON 38
ci_0040                -3.933526e-03 3 1  ON 39
ci_0041                 9.636287e-03 3 1  ON 40
ci_0042                 9.532954e-03 3 1  ON 41
ci_0043                -6.343088e-03 3 1  ON 42
ci_0044                -6.774434e-03 3 1  ON 43
ci_0045                 1.045933e-02 3 1  ON 44
ci_0046                 9.383508e-03 3 1  ON 45
ci_0047                -3.644266e-03 3 1  ON 46
ci_0048                -3.595064e-03 3 1  ON 47
ci_0049                -2.504342e-03 3 1  ON 48
ci_0050                -2.823112e-03 3 1  ON 49
ci_0051                -1.835868e-03 3 1  ON 50
ci_0052                -1.716010e-03 3 1  ON 51
ci_0053                -4.036071e-03 3 1  ON 52
ci_0054                -3.938128e-03 3 1  ON 53
ci_0055                 2.508100e-03 3 1  ON 54
ci_0056                 2.146633e-03 3 1  ON 55
ci_0057                 2.391280e-03 3 1  ON 56
ci_0058                 3.125211e-03 3 1  ON 57
ci_0059                -4.061037e-03 3 1  ON 58
ci_0060                -3.655087e-03 3 1  ON 59
ci_0061                -2.865950e-03 3 1  ON 60
ci_0062                -3.079645e-03 3 1  ON 61
ci_0063                -9.741523e-03 3 1  ON 62
ci_0064                -9.713259e-03 3 1  ON 63
ci_0065                -7.181074e-03 3 1  ON 64
ci_0066                -6.636015e-03 3 1  ON 65
ci_0067                -3.951506e-03 3 1  ON 66
ci_0068                -3.957852e-03 3 1  ON 67
ci_0069                 3.825530e-03 3 1  ON 68
ci_0070                 3.580873e-03 3 1  ON 69
ci_0071                 4.381187e-03 3 1  ON 70
ci_0072                 4.651015e-03 3 1  ON 71
ci_0073                 3.394232e-03 3 1  ON 72
ci_0074                 3.189410e-03 3 1  ON 73
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 4.1049e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s097 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s097 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=97  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6902e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 97
    time step          = 0.05
    reference energy   = -16.8641
    reference variance = 0.666306
====================================================
  Execution time = 1.4463e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s097
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5254e+04
  VMC Eavg = -1.6903e+01
  VMC Evar = 3.1738e-01
  Total weights = 1.951844539e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 2.5792e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.305967842534
                                         uncertainty =       0.002154753954

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.305967842534
                                         uncertainty =       0.002154753954

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000391166761
  error estimate for blocks of size 2^( 2) =       0.000405763404
  error estimate for blocks of size 2^( 3) =       0.000420842195
  error estimate for blocks of size 2^( 4) =       0.000434077349
  error estimate for blocks of size 2^( 5) =       0.000446596500
  error estimate for blocks of size 2^( 6) =       0.000455526557
  error estimate for blocks of size 2^( 7) =       0.000462298846

      target function =      -0.882978780141
              le_mean =     -16.903085993863
             les_mean =     286.031692489054
             stat err =       0.000449624813
             autocorr =       1.321224599343
   target nu stat err =       0.000449624813
   target dn stat err =       0.003004909299
      target stat err =       0.003811550698
              std dev =       0.553193339173
             le_variance =       0.306022870505


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690308599386e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 74
Check correct_vf_var_size: 225, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.2204e+04, overlap shift 2.2204e+05 and omega -1.7527e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.882994074959       residual = 6.50e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.882994076507       residual = 1.14e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.882994076725       residual = 4.24e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.882994076872       residual = 1.96e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.882994076942       residual = 7.39e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.882994076946       residual = 3.61e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.882994076964       residual = 9.68e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.882994076954       residual = 4.48e-06           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.882994076918       residual = 5.27e-06           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.882994077000       residual = 4.33e-06           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.882994076976       residual = 3.76e-06           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.882994076996       residual = 1.55e-06           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.882994076976       residual = 7.08e-07           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.882994077029       residual = 1.53e-07           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.882994077039       residual = 4.84e-08           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.882994076984       residual = 1.05e-08           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.882994077027       residual = 3.83e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         16 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 2.2204e+04 is 8.334771e-09

solving harmonic davidson linear method for identity shift 8.8818e+04, overlap shift 8.8818e+05 and omega -1.7527e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.882994074959       residual = 6.50e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.882994075346       residual = 1.14e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.882994075400       residual = 4.24e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.882994075417       residual = 1.96e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.882994075426       residual = 7.39e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.882994075606       residual = 3.61e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.882994075515       residual = 9.68e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.882994075684       residual = 4.48e-06           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.882994075633       residual = 5.27e-06           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.882994075597       residual = 4.33e-06           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.882994075539       residual = 3.76e-06           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.882994075484       residual = 1.55e-06           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.882994075252       residual = 7.08e-07           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.882994075346       residual = 1.53e-07           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.882994075431       residual = 4.84e-08           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.882994075499       residual = 1.05e-08           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.882994075632       residual = 3.83e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         16 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 8.8818e+04 is 2.083693e-09

solving harmonic davidson linear method for identity shift 3.5527e+05, overlap shift 3.5527e+06 and omega -1.7527e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.882994074959       residual = 6.50e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.882994075055       residual = 1.14e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.882994075069       residual = 4.24e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.882994075084       residual = 1.96e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.882994075091       residual = 7.39e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.882994074958       residual = 3.61e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.882994075144       residual = 9.68e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.882994074831       residual = 4.48e-06           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.882994075464       residual = 5.27e-06           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.882994075440       residual = 4.33e-06           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.882994074512       residual = 3.76e-06           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.882994075056       residual = 1.55e-06           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.882994075452       residual = 7.08e-07           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.882994074010       residual = 1.53e-07           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.882994075278       residual = 4.84e-08           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.882994074864       residual = 1.05e-08           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.882994075133       residual = 3.83e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         16 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 3.5527e+05 is 5.209234e-10

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               1.212103 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 75 and numParams is: 74

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.7057e+01
  </log>
  <optVariables href="H2O.s097.opt.xml">
ci_0001                 7.026294e-01 3 1  ON 0
ci_0002                 6.983279e-01 3 1  ON 1
ci_0003                -3.181708e-02 3 1  ON 2
ci_0004                -3.148888e-02 3 1  ON 3
ci_0005                -2.842197e-02 3 1  ON 4
ci_0006                -2.962379e-02 3 1  ON 5
ci_0007                -1.644645e-02 3 1  ON 6
ci_0008                -1.721863e-02 3 1  ON 7
ci_0009                -1.895886e-02 3 1  ON 8
ci_0010                -1.909747e-02 3 1  ON 9
ci_0011                -1.578360e-02 3 1  ON 10
ci_0012                -1.579241e-02 3 1  ON 11
ci_0013                 1.568461e-02 3 1  ON 12
ci_0014                 1.561327e-02 3 1  ON 13
ci_0015                 1.647820e-02 3 1  ON 14
ci_0016                 1.619584e-02 3 1  ON 15
ci_0017                 1.384672e-02 3 1  ON 16
ci_0018                 1.415257e-02 3 1  ON 17
ci_0019                 1.243859e-02 3 1  ON 18
ci_0020                 1.205185e-02 3 1  ON 19
ci_0021                 1.539483e-02 3 1  ON 20
ci_0022                 1.641549e-02 3 1  ON 21
ci_0023                -1.177804e-02 3 1  ON 22
ci_0024                -1.103743e-02 3 1  ON 23
ci_0025                -2.989034e-03 3 1  ON 24
ci_0026                -2.657138e-03 3 1  ON 25
ci_0027                -1.174735e-02 3 1  ON 26
ci_0028                -1.172146e-02 3 1  ON 27
ci_0029                -1.033864e-02 3 1  ON 28
ci_0030                -1.028740e-02 3 1  ON 29
ci_0031                 1.407063e-02 3 1  ON 30
ci_0032                 1.310028e-02 3 1  ON 31
ci_0033                 8.463040e-03 3 1  ON 32
ci_0034                 8.659736e-03 3 1  ON 33
ci_0035                 5.045256e-03 3 1  ON 34
ci_0036                 4.826570e-03 3 1  ON 35
ci_0037                -1.143338e-02 3 1  ON 36
ci_0038                -1.140351e-02 3 1  ON 37
ci_0039                -3.804123e-03 3 1  ON 38
ci_0040                -3.933526e-03 3 1  ON 39
ci_0041                 9.636287e-03 3 1  ON 40
ci_0042                 9.532954e-03 3 1  ON 41
ci_0043                -6.343087e-03 3 1  ON 42
ci_0044                -6.774434e-03 3 1  ON 43
ci_0045                 1.045933e-02 3 1  ON 44
ci_0046                 9.383508e-03 3 1  ON 45
ci_0047                -3.644266e-03 3 1  ON 46
ci_0048                -3.595063e-03 3 1  ON 47
ci_0049                -2.504342e-03 3 1  ON 48
ci_0050                -2.823112e-03 3 1  ON 49
ci_0051                -1.835868e-03 3 1  ON 50
ci_0052                -1.716010e-03 3 1  ON 51
ci_0053                -4.036071e-03 3 1  ON 52
ci_0054                -3.938128e-03 3 1  ON 53
ci_0055                 2.508099e-03 3 1  ON 54
ci_0056                 2.146632e-03 3 1  ON 55
ci_0057                 2.391280e-03 3 1  ON 56
ci_0058                 3.125212e-03 3 1  ON 57
ci_0059                -4.061036e-03 3 1  ON 58
ci_0060                -3.655086e-03 3 1  ON 59
ci_0061                -2.865949e-03 3 1  ON 60
ci_0062                -3.079645e-03 3 1  ON 61
ci_0063                -9.741523e-03 3 1  ON 62
ci_0064                -9.713259e-03 3 1  ON 63
ci_0065                -7.181073e-03 3 1  ON 64
ci_0066                -6.636014e-03 3 1  ON 65
ci_0067                -3.951506e-03 3 1  ON 66
ci_0068                -3.957852e-03 3 1  ON 67
ci_0069                 3.825530e-03 3 1  ON 68
ci_0070                 3.580873e-03 3 1  ON 69
ci_0071                 4.381187e-03 3 1  ON 70
ci_0072                 4.651014e-03 3 1  ON 71
ci_0073                 3.394233e-03 3 1  ON 72
ci_0074                 3.189411e-03 3 1  ON 73
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 97
    time step          = 0.05
    reference energy   = -16.8523
    reference variance = 0.205119
====================================================
  Execution time = 1.4298e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s097
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6903e+01
  VMC Evar = 3.0974e-01
  Total weights = 1.9515e+06
  Execution time = 1.8939e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.300306021464
                                         uncertainty =       0.001899308394

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.300306021464
                                         uncertainty =       0.001899308394

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000387485617
  error estimate for blocks of size 2^( 2) =       0.000402023425
  error estimate for blocks of size 2^( 3) =       0.000417374747
  error estimate for blocks of size 2^( 4) =       0.000431724561
  error estimate for blocks of size 2^( 5) =       0.000444322336
  error estimate for blocks of size 2^( 6) =       0.000455705959
  error estimate for blocks of size 2^( 7) =       0.000462080917

      target function =      -0.892564344854
              le_mean =     -16.902637342090
             les_mean =     286.008891246859
             stat err =       0.000448458443
             autocorr =       1.339470757995
   target nu stat err =       0.000448458443
   target dn stat err =       0.002293192411
      target stat err =       0.002997833251
              std dev =       0.547987414693
             le_variance =       0.300290206662

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.300306019861
                                         uncertainty =       0.001899308421

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.300306019861
                                         uncertainty =       0.001899308421

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000387485616
  error estimate for blocks of size 2^( 2) =       0.000402023424
  error estimate for blocks of size 2^( 3) =       0.000417374747
  error estimate for blocks of size 2^( 4) =       0.000431724561
  error estimate for blocks of size 2^( 5) =       0.000444322337
  error estimate for blocks of size 2^( 6) =       0.000455705960
  error estimate for blocks of size 2^( 7) =       0.000462080918

      target function =      -0.892564342468
              le_mean =     -16.902637342157
             les_mean =     286.008891250977
             stat err =       0.000448458444
             autocorr =       1.339470768768
   target nu stat err =       0.000448458444
   target dn stat err =       0.002293192289
      target stat err =       0.002997833083
              std dev =       0.547987413228
             le_variance =       0.300290205056

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.300306020663
                                         uncertainty =       0.001899308407

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.300306020663
                                         uncertainty =       0.001899308407

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000387485616
  error estimate for blocks of size 2^( 2) =       0.000402023424
  error estimate for blocks of size 2^( 3) =       0.000417374747
  error estimate for blocks of size 2^( 4) =       0.000431724561
  error estimate for blocks of size 2^( 5) =       0.000444322336
  error estimate for blocks of size 2^( 6) =       0.000455705960
  error estimate for blocks of size 2^( 7) =       0.000462080917

      target function =      -0.892564343663
              le_mean =     -16.902637342124
             les_mean =     286.008891248916
             stat err =       0.000448458444
             autocorr =       1.339470763379
   target nu stat err =       0.000448458444
   target dn stat err =       0.002293192350
      target stat err =       0.002997833167
              std dev =       0.547987413961
             le_variance =       0.300290205859

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.300306021364
                                         uncertainty =       0.001899308395

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.300306021364
                                         uncertainty =       0.001899308395

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000387485617
  error estimate for blocks of size 2^( 2) =       0.000402023425
  error estimate for blocks of size 2^( 3) =       0.000417374747
  error estimate for blocks of size 2^( 4) =       0.000431724561
  error estimate for blocks of size 2^( 5) =       0.000444322336
  error estimate for blocks of size 2^( 6) =       0.000455705960
  error estimate for blocks of size 2^( 7) =       0.000462080917

      target function =      -0.892564344706
              le_mean =     -16.902637342095
             les_mean =     286.008891247116
             stat err =       0.000448458443
             autocorr =       1.339470758659
   target nu stat err =       0.000448458443
   target dn stat err =       0.002293192404
      target stat err =       0.002997833240
              std dev =       0.547987414601
             le_variance =       0.300290206562


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.892564344854        initial  <--
     2.2204e+04     2.2204e+05             8.3348e-09        -0.892564342468
     8.8818e+04     8.8818e+05             2.0837e-09        -0.892564343663
     3.5527e+05     3.5527e+06             5.2092e-10        -0.892564344706

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 23.8417
  </log>
  <optVariables href="H2O.s097.opt.xml">
ci_0001                 7.026294e-01 3 1  ON 0
ci_0002                 6.983279e-01 3 1  ON 1
ci_0003                -3.181708e-02 3 1  ON 2
ci_0004                -3.148888e-02 3 1  ON 3
ci_0005                -2.842197e-02 3 1  ON 4
ci_0006                -2.962380e-02 3 1  ON 5
ci_0007                -1.644646e-02 3 1  ON 6
ci_0008                -1.721863e-02 3 1  ON 7
ci_0009                -1.895887e-02 3 1  ON 8
ci_0010                -1.909747e-02 3 1  ON 9
ci_0011                -1.578360e-02 3 1  ON 10
ci_0012                -1.579241e-02 3 1  ON 11
ci_0013                 1.568461e-02 3 1  ON 12
ci_0014                 1.561327e-02 3 1  ON 13
ci_0015                 1.647820e-02 3 1  ON 14
ci_0016                 1.619584e-02 3 1  ON 15
ci_0017                 1.384672e-02 3 1  ON 16
ci_0018                 1.415258e-02 3 1  ON 17
ci_0019                 1.243859e-02 3 1  ON 18
ci_0020                 1.205185e-02 3 1  ON 19
ci_0021                 1.539483e-02 3 1  ON 20
ci_0022                 1.641549e-02 3 1  ON 21
ci_0023                -1.177804e-02 3 1  ON 22
ci_0024                -1.103743e-02 3 1  ON 23
ci_0025                -2.989035e-03 3 1  ON 24
ci_0026                -2.657137e-03 3 1  ON 25
ci_0027                -1.174735e-02 3 1  ON 26
ci_0028                -1.172146e-02 3 1  ON 27
ci_0029                -1.033864e-02 3 1  ON 28
ci_0030                -1.028740e-02 3 1  ON 29
ci_0031                 1.407063e-02 3 1  ON 30
ci_0032                 1.310028e-02 3 1  ON 31
ci_0033                 8.463040e-03 3 1  ON 32
ci_0034                 8.659737e-03 3 1  ON 33
ci_0035                 5.045258e-03 3 1  ON 34
ci_0036                 4.826570e-03 3 1  ON 35
ci_0037                -1.143338e-02 3 1  ON 36
ci_0038                -1.140351e-02 3 1  ON 37
ci_0039                -3.804123e-03 3 1  ON 38
ci_0040                -3.933526e-03 3 1  ON 39
ci_0041                 9.636287e-03 3 1  ON 40
ci_0042                 9.532954e-03 3 1  ON 41
ci_0043                -6.343088e-03 3 1  ON 42
ci_0044                -6.774434e-03 3 1  ON 43
ci_0045                 1.045933e-02 3 1  ON 44
ci_0046                 9.383508e-03 3 1  ON 45
ci_0047                -3.644266e-03 3 1  ON 46
ci_0048                -3.595064e-03 3 1  ON 47
ci_0049                -2.504342e-03 3 1  ON 48
ci_0050                -2.823112e-03 3 1  ON 49
ci_0051                -1.835868e-03 3 1  ON 50
ci_0052                -1.716010e-03 3 1  ON 51
ci_0053                -4.036071e-03 3 1  ON 52
ci_0054                -3.938128e-03 3 1  ON 53
ci_0055                 2.508100e-03 3 1  ON 54
ci_0056                 2.146633e-03 3 1  ON 55
ci_0057                 2.391280e-03 3 1  ON 56
ci_0058                 3.125211e-03 3 1  ON 57
ci_0059                -4.061037e-03 3 1  ON 58
ci_0060                -3.655087e-03 3 1  ON 59
ci_0061                -2.865950e-03 3 1  ON 60
ci_0062                -3.079645e-03 3 1  ON 61
ci_0063                -9.741523e-03 3 1  ON 62
ci_0064                -9.713259e-03 3 1  ON 63
ci_0065                -7.181074e-03 3 1  ON 64
ci_0066                -6.636015e-03 3 1  ON 65
ci_0067                -3.951506e-03 3 1  ON 66
ci_0068                -3.957852e-03 3 1  ON 67
ci_0069                 3.825530e-03 3 1  ON 68
ci_0070                 3.580873e-03 3 1  ON 69
ci_0071                 4.381187e-03 3 1  ON 70
ci_0072                 4.651015e-03 3 1  ON 71
ci_0073                 3.394232e-03 3 1  ON 72
ci_0074                 3.189410e-03 3 1  ON 73
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 4.0904e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s098 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s098 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=98  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6901e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 98
    time step          = 0.05
    reference energy   = -16.9444
    reference variance = 0.302206
====================================================
  Execution time = 1.4326e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s098
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5226e+04
  VMC Eavg = -1.6904e+01
  VMC Evar = 3.1161e-01
  Total weights = 1.951918485e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 2.5808e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.302574614716
                                         uncertainty =       0.001950812932

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.302574614716
                                         uncertainty =       0.001950812932

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000388960065
  error estimate for blocks of size 2^( 2) =       0.000403812301
  error estimate for blocks of size 2^( 3) =       0.000418688991
  error estimate for blocks of size 2^( 4) =       0.000433536214
  error estimate for blocks of size 2^( 5) =       0.000446070631
  error estimate for blocks of size 2^( 6) =       0.000456935072
  error estimate for blocks of size 2^( 7) =       0.000465155048

      target function =      -0.890343578913
              le_mean =     -16.903640584088
             les_mean =     286.044674076844
             stat err =       0.000450424241
             autocorr =       1.341014528663
   target nu stat err =       0.000450424241
   target dn stat err =       0.002360633170
      target stat err =       0.003072557531
              std dev =       0.550072599042
             le_variance =       0.302579864217


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690364058409e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 74
Check correct_vf_var_size: 225, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.2204e+05, overlap shift 2.2204e+06 and omega -1.7527e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.890353085665       residual = 1.04e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.890353085875       residual = 1.43e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.890353085910       residual = 3.42e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.890353085924       residual = 1.76e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.890353085930       residual = 5.43e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.890353085931       residual = 2.21e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.890353085600       residual = 7.08e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.890353085934       residual = 2.45e-06           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.890353085934       residual = 8.10e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.890353085934       residual = 3.27e-07           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.890353085934       residual = 1.01e-07           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.890353085934       residual = 3.27e-08           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.890353085934       residual = 3.59e-08           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.890353085934       residual = 2.86e-08           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.890353085934       residual = 2.02e-08           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.890353085934       residual = 9.97e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         15 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 2.2204e+05 is 9.584759e-10

solving harmonic davidson linear method for identity shift 8.8818e+05, overlap shift 8.8818e+06 and omega -1.7527e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.890353085665       residual = 1.04e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.890353085717       residual = 1.43e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.890353085726       residual = 3.42e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.890353085730       residual = 1.76e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.890353086036       residual = 5.43e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.890353085731       residual = 2.21e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.890353083562       residual = 7.08e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.890353085732       residual = 2.45e-06           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.890353085732       residual = 8.10e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.890353085732       residual = 3.27e-07           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.890353085732       residual = 1.01e-07           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.890353085638       residual = 3.27e-08           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.890353085732       residual = 3.59e-08           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.890353086191       residual = 2.86e-08           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.890353085732       residual = 2.02e-08           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.890353086618       residual = 9.97e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         15 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 8.8818e+05 is 2.396190e-10

solving harmonic davidson linear method for identity shift 3.5527e+06, overlap shift 3.5527e+07 and omega -1.7527e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.890353085665       residual = 1.04e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.890353085678       residual = 1.43e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.890353085680       residual = 3.42e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.890353085681       residual = 1.76e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.890353085682       residual = 5.43e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.890353088134       residual = 2.21e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.890353085682       residual = 7.08e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.890353088366       residual = 2.45e-06           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.890353085215       residual = 8.10e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.890353085682       residual = 3.27e-07           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.890353086535       residual = 1.01e-07           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.890353085682       residual = 3.27e-08           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.890353085682       residual = 3.59e-08           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.890353085682       residual = 2.86e-08           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.890353085682       residual = 2.02e-08           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.890353074065       residual = 9.97e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         15 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 3.5527e+06 is 5.990466e-11

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               1.220087 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 75 and numParams is: 74

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.6921e+01
  </log>
  <optVariables href="H2O.s098.opt.xml">
ci_0001                 7.026294e-01 3 1  ON 0
ci_0002                 6.983279e-01 3 1  ON 1
ci_0003                -3.181708e-02 3 1  ON 2
ci_0004                -3.148888e-02 3 1  ON 3
ci_0005                -2.842197e-02 3 1  ON 4
ci_0006                -2.962379e-02 3 1  ON 5
ci_0007                -1.644646e-02 3 1  ON 6
ci_0008                -1.721863e-02 3 1  ON 7
ci_0009                -1.895887e-02 3 1  ON 8
ci_0010                -1.909747e-02 3 1  ON 9
ci_0011                -1.578360e-02 3 1  ON 10
ci_0012                -1.579241e-02 3 1  ON 11
ci_0013                 1.568461e-02 3 1  ON 12
ci_0014                 1.561327e-02 3 1  ON 13
ci_0015                 1.647820e-02 3 1  ON 14
ci_0016                 1.619584e-02 3 1  ON 15
ci_0017                 1.384672e-02 3 1  ON 16
ci_0018                 1.415257e-02 3 1  ON 17
ci_0019                 1.243859e-02 3 1  ON 18
ci_0020                 1.205185e-02 3 1  ON 19
ci_0021                 1.539483e-02 3 1  ON 20
ci_0022                 1.641549e-02 3 1  ON 21
ci_0023                -1.177804e-02 3 1  ON 22
ci_0024                -1.103743e-02 3 1  ON 23
ci_0025                -2.989035e-03 3 1  ON 24
ci_0026                -2.657137e-03 3 1  ON 25
ci_0027                -1.174735e-02 3 1  ON 26
ci_0028                -1.172146e-02 3 1  ON 27
ci_0029                -1.033864e-02 3 1  ON 28
ci_0030                -1.028740e-02 3 1  ON 29
ci_0031                 1.407063e-02 3 1  ON 30
ci_0032                 1.310028e-02 3 1  ON 31
ci_0033                 8.463040e-03 3 1  ON 32
ci_0034                 8.659737e-03 3 1  ON 33
ci_0035                 5.045258e-03 3 1  ON 34
ci_0036                 4.826570e-03 3 1  ON 35
ci_0037                -1.143338e-02 3 1  ON 36
ci_0038                -1.140351e-02 3 1  ON 37
ci_0039                -3.804123e-03 3 1  ON 38
ci_0040                -3.933526e-03 3 1  ON 39
ci_0041                 9.636287e-03 3 1  ON 40
ci_0042                 9.532954e-03 3 1  ON 41
ci_0043                -6.343088e-03 3 1  ON 42
ci_0044                -6.774434e-03 3 1  ON 43
ci_0045                 1.045933e-02 3 1  ON 44
ci_0046                 9.383508e-03 3 1  ON 45
ci_0047                -3.644266e-03 3 1  ON 46
ci_0048                -3.595064e-03 3 1  ON 47
ci_0049                -2.504342e-03 3 1  ON 48
ci_0050                -2.823112e-03 3 1  ON 49
ci_0051                -1.835868e-03 3 1  ON 50
ci_0052                -1.716010e-03 3 1  ON 51
ci_0053                -4.036071e-03 3 1  ON 52
ci_0054                -3.938128e-03 3 1  ON 53
ci_0055                 2.508100e-03 3 1  ON 54
ci_0056                 2.146633e-03 3 1  ON 55
ci_0057                 2.391280e-03 3 1  ON 56
ci_0058                 3.125211e-03 3 1  ON 57
ci_0059                -4.061037e-03 3 1  ON 58
ci_0060                -3.655087e-03 3 1  ON 59
ci_0061                -2.865950e-03 3 1  ON 60
ci_0062                -3.079645e-03 3 1  ON 61
ci_0063                -9.741523e-03 3 1  ON 62
ci_0064                -9.713259e-03 3 1  ON 63
ci_0065                -7.181073e-03 3 1  ON 64
ci_0066                -6.636015e-03 3 1  ON 65
ci_0067                -3.951506e-03 3 1  ON 66
ci_0068                -3.957852e-03 3 1  ON 67
ci_0069                 3.825530e-03 3 1  ON 68
ci_0070                 3.580873e-03 3 1  ON 69
ci_0071                 4.381187e-03 3 1  ON 70
ci_0072                 4.651015e-03 3 1  ON 71
ci_0073                 3.394232e-03 3 1  ON 72
ci_0074                 3.189410e-03 3 1  ON 73
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 98
    time step          = 0.05
    reference energy   = -16.9031
    reference variance = 0.254017
====================================================
  Execution time = 1.4338e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s098
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6903e+01
  VMC Evar = 3.1826e-01
  Total weights = 1.9516e+06
  Execution time = 1.8939e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.306347188499
                                         uncertainty =       0.002895358324

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.306347188499
                                         uncertainty =       0.002895358324

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000391391335
  error estimate for blocks of size 2^( 2) =       0.000405974454
  error estimate for blocks of size 2^( 3) =       0.000420193975
  error estimate for blocks of size 2^( 4) =       0.000432368324
  error estimate for blocks of size 2^( 5) =       0.000442820338
  error estimate for blocks of size 2^( 6) =       0.000449670254
  error estimate for blocks of size 2^( 7) =       0.000451534915

      target function =      -0.881854531848
              le_mean =     -16.903012441463
             les_mean =     286.030086306618
             stat err =       0.000444098458
             autocorr =       1.287467034494
   target nu stat err =       0.000444098458
   target dn stat err =       0.004132858998
      target stat err =       0.005193051435
              std dev =       0.553510933638
             le_variance =       0.306374353656

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.306347188580
                                         uncertainty =       0.002895358380

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.306347188580
                                         uncertainty =       0.002895358380

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000391391335
  error estimate for blocks of size 2^( 2) =       0.000405974454
  error estimate for blocks of size 2^( 3) =       0.000420193975
  error estimate for blocks of size 2^( 4) =       0.000432368324
  error estimate for blocks of size 2^( 5) =       0.000442820338
  error estimate for blocks of size 2^( 6) =       0.000449670255
  error estimate for blocks of size 2^( 7) =       0.000451534915

      target function =      -0.881854532023
              le_mean =     -16.903012441463
             les_mean =     286.030086306484
             stat err =       0.000444098458
             autocorr =       1.287467035276
   target nu stat err =       0.000444098458
   target dn stat err =       0.004132859122
      target stat err =       0.005193051590
              std dev =       0.553510933712
             le_variance =       0.306374353739

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.306347188540
                                         uncertainty =       0.002895358352

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.306347188540
                                         uncertainty =       0.002895358352

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000391391335
  error estimate for blocks of size 2^( 2) =       0.000405974454
  error estimate for blocks of size 2^( 3) =       0.000420193975
  error estimate for blocks of size 2^( 4) =       0.000432368324
  error estimate for blocks of size 2^( 5) =       0.000442820338
  error estimate for blocks of size 2^( 6) =       0.000449670255
  error estimate for blocks of size 2^( 7) =       0.000451534915

      target function =      -0.881854531935
              le_mean =     -16.903012441463
             les_mean =     286.030086306551
             stat err =       0.000444098458
             autocorr =       1.287467034875
   target nu stat err =       0.000444098458
   target dn stat err =       0.004132859060
      target stat err =       0.005193051512
              std dev =       0.553510933675
             le_variance =       0.306374353697

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.306347188504
                                         uncertainty =       0.002895358328

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.306347188504
                                         uncertainty =       0.002895358328

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000391391335
  error estimate for blocks of size 2^( 2) =       0.000405974454
  error estimate for blocks of size 2^( 3) =       0.000420193975
  error estimate for blocks of size 2^( 4) =       0.000432368324
  error estimate for blocks of size 2^( 5) =       0.000442820338
  error estimate for blocks of size 2^( 6) =       0.000449670254
  error estimate for blocks of size 2^( 7) =       0.000451534915

      target function =      -0.881854531859
              le_mean =     -16.903012441463
             les_mean =     286.030086306609
             stat err =       0.000444098458
             autocorr =       1.287467034535
   target nu stat err =       0.000444098458
   target dn stat err =       0.004132859006
      target stat err =       0.005193051444
              std dev =       0.553510933642
             le_variance =       0.306374353661


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.881854531848        initial
     2.2204e+05     2.2204e+06             9.5848e-10        -0.881854532023  <--
     8.8818e+05     8.8818e+06             2.3962e-10        -0.881854531935
     3.5527e+06     3.5527e+07             5.9905e-11        -0.881854531859

*****************************************************************************
Applying the update for shift_i =   2.2204e+05     and shift_s =   2.2204e+06
*****************************************************************************

  Execution time = 2.3873e+01
  </log>
  <optVariables href="H2O.s098.opt.xml">
ci_0001                 7.026294e-01 3 1  ON 0
ci_0002                 6.983279e-01 3 1  ON 1
ci_0003                -3.181708e-02 3 1  ON 2
ci_0004                -3.148888e-02 3 1  ON 3
ci_0005                -2.842197e-02 3 1  ON 4
ci_0006                -2.962379e-02 3 1  ON 5
ci_0007                -1.644646e-02 3 1  ON 6
ci_0008                -1.721863e-02 3 1  ON 7
ci_0009                -1.895887e-02 3 1  ON 8
ci_0010                -1.909747e-02 3 1  ON 9
ci_0011                -1.578360e-02 3 1  ON 10
ci_0012                -1.579241e-02 3 1  ON 11
ci_0013                 1.568461e-02 3 1  ON 12
ci_0014                 1.561327e-02 3 1  ON 13
ci_0015                 1.647820e-02 3 1  ON 14
ci_0016                 1.619584e-02 3 1  ON 15
ci_0017                 1.384672e-02 3 1  ON 16
ci_0018                 1.415257e-02 3 1  ON 17
ci_0019                 1.243859e-02 3 1  ON 18
ci_0020                 1.205185e-02 3 1  ON 19
ci_0021                 1.539483e-02 3 1  ON 20
ci_0022                 1.641550e-02 3 1  ON 21
ci_0023                -1.177804e-02 3 1  ON 22
ci_0024                -1.103743e-02 3 1  ON 23
ci_0025                -2.989034e-03 3 1  ON 24
ci_0026                -2.657137e-03 3 1  ON 25
ci_0027                -1.174735e-02 3 1  ON 26
ci_0028                -1.172146e-02 3 1  ON 27
ci_0029                -1.033864e-02 3 1  ON 28
ci_0030                -1.028740e-02 3 1  ON 29
ci_0031                 1.407063e-02 3 1  ON 30
ci_0032                 1.310028e-02 3 1  ON 31
ci_0033                 8.463040e-03 3 1  ON 32
ci_0034                 8.659737e-03 3 1  ON 33
ci_0035                 5.045258e-03 3 1  ON 34
ci_0036                 4.826569e-03 3 1  ON 35
ci_0037                -1.143338e-02 3 1  ON 36
ci_0038                -1.140351e-02 3 1  ON 37
ci_0039                -3.804123e-03 3 1  ON 38
ci_0040                -3.933526e-03 3 1  ON 39
ci_0041                 9.636288e-03 3 1  ON 40
ci_0042                 9.532954e-03 3 1  ON 41
ci_0043                -6.343088e-03 3 1  ON 42
ci_0044                -6.774434e-03 3 1  ON 43
ci_0045                 1.045933e-02 3 1  ON 44
ci_0046                 9.383508e-03 3 1  ON 45
ci_0047                -3.644266e-03 3 1  ON 46
ci_0048                -3.595064e-03 3 1  ON 47
ci_0049                -2.504342e-03 3 1  ON 48
ci_0050                -2.823111e-03 3 1  ON 49
ci_0051                -1.835868e-03 3 1  ON 50
ci_0052                -1.716010e-03 3 1  ON 51
ci_0053                -4.036072e-03 3 1  ON 52
ci_0054                -3.938127e-03 3 1  ON 53
ci_0055                 2.508100e-03 3 1  ON 54
ci_0056                 2.146633e-03 3 1  ON 55
ci_0057                 2.391280e-03 3 1  ON 56
ci_0058                 3.125211e-03 3 1  ON 57
ci_0059                -4.061037e-03 3 1  ON 58
ci_0060                -3.655087e-03 3 1  ON 59
ci_0061                -2.865950e-03 3 1  ON 60
ci_0062                -3.079645e-03 3 1  ON 61
ci_0063                -9.741523e-03 3 1  ON 62
ci_0064                -9.713259e-03 3 1  ON 63
ci_0065                -7.181073e-03 3 1  ON 64
ci_0066                -6.636015e-03 3 1  ON 65
ci_0067                -3.951506e-03 3 1  ON 66
ci_0068                -3.957852e-03 3 1  ON 67
ci_0069                 3.825530e-03 3 1  ON 68
ci_0070                 3.580873e-03 3 1  ON 69
ci_0071                 4.381187e-03 3 1  ON 70
ci_0072                 4.651015e-03 3 1  ON 71
ci_0073                 3.394232e-03 3 1  ON 72
ci_0074                 3.189410e-03 3 1  ON 73
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 4.0799e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s099 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s099 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=99  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6902e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 99
    time step          = 0.05
    reference energy   = -16.8055
    reference variance = 0.225622
====================================================
  Execution time = 1.4340e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s099
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5244e+04
  VMC Eavg = -1.6903e+01
  VMC Evar = 3.1467e-01
  Total weights = 1.952144683e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 2.5854e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.304119804125
                                         uncertainty =       0.002517255780

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.304119804125
                                         uncertainty =       0.002517255780

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000389917238
  error estimate for blocks of size 2^( 2) =       0.000404388866
  error estimate for blocks of size 2^( 3) =       0.000419092588
  error estimate for blocks of size 2^( 4) =       0.000432791296
  error estimate for blocks of size 2^( 5) =       0.000444206019
  error estimate for blocks of size 2^( 6) =       0.000451706199
  error estimate for blocks of size 2^( 7) =       0.000456475806

      target function =      -0.886385339121
              le_mean =     -16.903165079267
             les_mean =     286.031660993450
             stat err =       0.000446294830
             autocorr =       1.310083089783
   target nu stat err =       0.000446294830
   target dn stat err =       0.003092279177
      target stat err =       0.003948966146
              std dev =       0.551426246050
             le_variance =       0.304070904833


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690316507927e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 74
Check correct_vf_var_size: 225, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 5.5511e+04, overlap shift 5.5511e+05 and omega -1.7527e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.886401969730       residual = 1.60e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.886401970583       residual = 2.11e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.886401970792       residual = 5.67e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.886401970879       residual = 2.00e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.886401970916       residual = 1.13e-04           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.886401971038       residual = 4.93e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.886401971017       residual = 1.63e-05           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.886401970853       residual = 1.03e-05           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.886401970938       residual = 8.67e-06           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.886401970903       residual = 7.48e-06           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.886401970857       residual = 4.36e-06           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.886401970884       residual = 1.92e-06           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.886401970876       residual = 7.34e-07           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.886401970851       residual = 1.64e-07           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.886401971040       residual = 3.48e-08           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.886401970949       residual = 9.11e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         15 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 5.5511e+04 is 4.615697e-09

solving harmonic davidson linear method for identity shift 2.2204e+05, overlap shift 2.2204e+06 and omega -1.7527e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.886401969730       residual = 1.60e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.886401969943       residual = 2.11e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.886401969995       residual = 5.67e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.886401970017       residual = 2.00e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.886401970150       residual = 1.13e-04           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.886401970207       residual = 4.93e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.886401969878       residual = 1.63e-05           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.886401969949       residual = 1.03e-05           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.886401970077       residual = 8.67e-06           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.886401969679       residual = 7.48e-06           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.886401970212       residual = 4.36e-06           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.886401969731       residual = 1.92e-06           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.886401969873       residual = 7.34e-07           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.886401970203       residual = 1.64e-07           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.886401970529       residual = 3.48e-08           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.886401969858       residual = 9.11e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         15 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 2.2204e+05 is 1.153925e-09

solving harmonic davidson linear method for identity shift 8.8818e+05, overlap shift 8.8818e+06 and omega -1.7527e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.886401969730       residual = 1.60e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.886401969783       residual = 2.11e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.886401969796       residual = 5.67e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.886401969802       residual = 2.00e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.886401969721       residual = 1.13e-04           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.886401969804       residual = 4.93e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.886401969025       residual = 1.63e-05           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.886401969966       residual = 1.03e-05           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.886401972506       residual = 8.67e-06           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.886401969526       residual = 7.48e-06           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.886401968919       residual = 4.36e-06           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.886401969821       residual = 1.92e-06           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.886401968105       residual = 7.34e-07           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.886401968813       residual = 1.64e-07           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.886401969751       residual = 3.48e-08           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.886401969871       residual = 9.11e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         15 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 8.8818e+05 is 2.884813e-10

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               1.228079 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 75 and numParams is: 74

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.6939e+01
  </log>
  <optVariables href="H2O.s099.opt.xml">
ci_0001                 7.026294e-01 3 1  ON 0
ci_0002                 6.983279e-01 3 1  ON 1
ci_0003                -3.181708e-02 3 1  ON 2
ci_0004                -3.148888e-02 3 1  ON 3
ci_0005                -2.842197e-02 3 1  ON 4
ci_0006                -2.962379e-02 3 1  ON 5
ci_0007                -1.644646e-02 3 1  ON 6
ci_0008                -1.721863e-02 3 1  ON 7
ci_0009                -1.895887e-02 3 1  ON 8
ci_0010                -1.909747e-02 3 1  ON 9
ci_0011                -1.578360e-02 3 1  ON 10
ci_0012                -1.579241e-02 3 1  ON 11
ci_0013                 1.568461e-02 3 1  ON 12
ci_0014                 1.561327e-02 3 1  ON 13
ci_0015                 1.647820e-02 3 1  ON 14
ci_0016                 1.619584e-02 3 1  ON 15
ci_0017                 1.384672e-02 3 1  ON 16
ci_0018                 1.415257e-02 3 1  ON 17
ci_0019                 1.243859e-02 3 1  ON 18
ci_0020                 1.205185e-02 3 1  ON 19
ci_0021                 1.539483e-02 3 1  ON 20
ci_0022                 1.641550e-02 3 1  ON 21
ci_0023                -1.177804e-02 3 1  ON 22
ci_0024                -1.103743e-02 3 1  ON 23
ci_0025                -2.989034e-03 3 1  ON 24
ci_0026                -2.657137e-03 3 1  ON 25
ci_0027                -1.174735e-02 3 1  ON 26
ci_0028                -1.172146e-02 3 1  ON 27
ci_0029                -1.033864e-02 3 1  ON 28
ci_0030                -1.028740e-02 3 1  ON 29
ci_0031                 1.407063e-02 3 1  ON 30
ci_0032                 1.310028e-02 3 1  ON 31
ci_0033                 8.463040e-03 3 1  ON 32
ci_0034                 8.659736e-03 3 1  ON 33
ci_0035                 5.045259e-03 3 1  ON 34
ci_0036                 4.826569e-03 3 1  ON 35
ci_0037                -1.143338e-02 3 1  ON 36
ci_0038                -1.140351e-02 3 1  ON 37
ci_0039                -3.804123e-03 3 1  ON 38
ci_0040                -3.933526e-03 3 1  ON 39
ci_0041                 9.636287e-03 3 1  ON 40
ci_0042                 9.532954e-03 3 1  ON 41
ci_0043                -6.343088e-03 3 1  ON 42
ci_0044                -6.774434e-03 3 1  ON 43
ci_0045                 1.045933e-02 3 1  ON 44
ci_0046                 9.383508e-03 3 1  ON 45
ci_0047                -3.644266e-03 3 1  ON 46
ci_0048                -3.595064e-03 3 1  ON 47
ci_0049                -2.504342e-03 3 1  ON 48
ci_0050                -2.823111e-03 3 1  ON 49
ci_0051                -1.835867e-03 3 1  ON 50
ci_0052                -1.716010e-03 3 1  ON 51
ci_0053                -4.036071e-03 3 1  ON 52
ci_0054                -3.938127e-03 3 1  ON 53
ci_0055                 2.508099e-03 3 1  ON 54
ci_0056                 2.146633e-03 3 1  ON 55
ci_0057                 2.391280e-03 3 1  ON 56
ci_0058                 3.125211e-03 3 1  ON 57
ci_0059                -4.061036e-03 3 1  ON 58
ci_0060                -3.655087e-03 3 1  ON 59
ci_0061                -2.865950e-03 3 1  ON 60
ci_0062                -3.079644e-03 3 1  ON 61
ci_0063                -9.741523e-03 3 1  ON 62
ci_0064                -9.713259e-03 3 1  ON 63
ci_0065                -7.181073e-03 3 1  ON 64
ci_0066                -6.636014e-03 3 1  ON 65
ci_0067                -3.951506e-03 3 1  ON 66
ci_0068                -3.957852e-03 3 1  ON 67
ci_0069                 3.825530e-03 3 1  ON 68
ci_0070                 3.580873e-03 3 1  ON 69
ci_0071                 4.381187e-03 3 1  ON 70
ci_0072                 4.651015e-03 3 1  ON 71
ci_0073                 3.394232e-03 3 1  ON 72
ci_0074                 3.189410e-03 3 1  ON 73
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 99
    time step          = 0.05
    reference energy   = -16.9028
    reference variance = 0.174428
====================================================
  Execution time = 1.4012e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s099
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6903e+01
  VMC Evar = 3.1656e-01
  Total weights = 1.9515e+06
  Execution time = 1.8927e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.303653339384
                                         uncertainty =       0.001961779212

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.303653339384
                                         uncertainty =       0.001961779212

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000389586474
  error estimate for blocks of size 2^( 2) =       0.000404382779
  error estimate for blocks of size 2^( 3) =       0.000419050510
  error estimate for blocks of size 2^( 4) =       0.000432121826
  error estimate for blocks of size 2^( 5) =       0.000442544123
  error estimate for blocks of size 2^( 6) =       0.000451045626
  error estimate for blocks of size 2^( 7) =       0.000456237553

      target function =      -0.884027434921
              le_mean =     -16.903289728136
             les_mean =     286.037765679525
             stat err =       0.000445487282
             autocorr =       1.307563776440
   target nu stat err =       0.000445487282
   target dn stat err =       0.003024091839
      target stat err =       0.003844484323
              std dev =       0.550958474653
             le_variance =       0.303555240792

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.303653338838
                                         uncertainty =       0.001961779252

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.303653338838
                                         uncertainty =       0.001961779252

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000389586473
  error estimate for blocks of size 2^( 2) =       0.000404382779
  error estimate for blocks of size 2^( 3) =       0.000419050511
  error estimate for blocks of size 2^( 4) =       0.000432121826
  error estimate for blocks of size 2^( 5) =       0.000442544124
  error estimate for blocks of size 2^( 6) =       0.000451045627
  error estimate for blocks of size 2^( 7) =       0.000456237553

      target function =      -0.884027439073
              le_mean =     -16.903289728132
             les_mean =     286.037765676069
             stat err =       0.000445487282
             autocorr =       1.307563780715
   target nu stat err =       0.000445487282
   target dn stat err =       0.003024091379
      target stat err =       0.003844483790
              std dev =       0.550958474157
             le_variance =       0.303555240245

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.303653339111
                                         uncertainty =       0.001961779232

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.303653339111
                                         uncertainty =       0.001961779232

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000389586473
  error estimate for blocks of size 2^( 2) =       0.000404382779
  error estimate for blocks of size 2^( 3) =       0.000419050510
  error estimate for blocks of size 2^( 4) =       0.000432121826
  error estimate for blocks of size 2^( 5) =       0.000442544124
  error estimate for blocks of size 2^( 6) =       0.000451045626
  error estimate for blocks of size 2^( 7) =       0.000456237553

      target function =      -0.884027436997
              le_mean =     -16.903289728134
             les_mean =     286.037765677797
             stat err =       0.000445487282
             autocorr =       1.307563778575
   target nu stat err =       0.000445487282
   target dn stat err =       0.003024091609
      target stat err =       0.003844484057
              std dev =       0.550958474405
             le_variance =       0.303555240519

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.303653339350
                                         uncertainty =       0.001961779214

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.303653339350
                                         uncertainty =       0.001961779214

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000389586474
  error estimate for blocks of size 2^( 2) =       0.000404382779
  error estimate for blocks of size 2^( 3) =       0.000419050510
  error estimate for blocks of size 2^( 4) =       0.000432121826
  error estimate for blocks of size 2^( 5) =       0.000442544123
  error estimate for blocks of size 2^( 6) =       0.000451045626
  error estimate for blocks of size 2^( 7) =       0.000456237553

      target function =      -0.884027435181
              le_mean =     -16.903289728136
             les_mean =     286.037765679309
             stat err =       0.000445487282
             autocorr =       1.307563776715
   target nu stat err =       0.000445487282
   target dn stat err =       0.003024091810
      target stat err =       0.003844484290
              std dev =       0.550958474622
             le_variance =       0.303555240758


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.884027434921        initial
     5.5511e+04     5.5511e+05             4.6157e-09        -0.884027439073  <--
     2.2204e+05     2.2204e+06             1.1539e-09        -0.884027436997
     8.8818e+05     8.8818e+06             2.8848e-10        -0.884027435181

*****************************************************************************
Applying the update for shift_i =   5.5511e+04     and shift_s =   5.5511e+05
*****************************************************************************

  Execution time = 2.3556e+01
  </log>
  <optVariables href="H2O.s099.opt.xml">
ci_0001                 7.026294e-01 3 1  ON 0
ci_0002                 6.983279e-01 3 1  ON 1
ci_0003                -3.181707e-02 3 1  ON 2
ci_0004                -3.148887e-02 3 1  ON 3
ci_0005                -2.842197e-02 3 1  ON 4
ci_0006                -2.962379e-02 3 1  ON 5
ci_0007                -1.644645e-02 3 1  ON 6
ci_0008                -1.721862e-02 3 1  ON 7
ci_0009                -1.895887e-02 3 1  ON 8
ci_0010                -1.909747e-02 3 1  ON 9
ci_0011                -1.578360e-02 3 1  ON 10
ci_0012                -1.579241e-02 3 1  ON 11
ci_0013                 1.568461e-02 3 1  ON 12
ci_0014                 1.561327e-02 3 1  ON 13
ci_0015                 1.647820e-02 3 1  ON 14
ci_0016                 1.619584e-02 3 1  ON 15
ci_0017                 1.384672e-02 3 1  ON 16
ci_0018                 1.415257e-02 3 1  ON 17
ci_0019                 1.243859e-02 3 1  ON 18
ci_0020                 1.205185e-02 3 1  ON 19
ci_0021                 1.539483e-02 3 1  ON 20
ci_0022                 1.641550e-02 3 1  ON 21
ci_0023                -1.177804e-02 3 1  ON 22
ci_0024                -1.103743e-02 3 1  ON 23
ci_0025                -2.989032e-03 3 1  ON 24
ci_0026                -2.657137e-03 3 1  ON 25
ci_0027                -1.174735e-02 3 1  ON 26
ci_0028                -1.172146e-02 3 1  ON 27
ci_0029                -1.033864e-02 3 1  ON 28
ci_0030                -1.028740e-02 3 1  ON 29
ci_0031                 1.407063e-02 3 1  ON 30
ci_0032                 1.310028e-02 3 1  ON 31
ci_0033                 8.463039e-03 3 1  ON 32
ci_0034                 8.659735e-03 3 1  ON 33
ci_0035                 5.045260e-03 3 1  ON 34
ci_0036                 4.826569e-03 3 1  ON 35
ci_0037                -1.143338e-02 3 1  ON 36
ci_0038                -1.140351e-02 3 1  ON 37
ci_0039                -3.804123e-03 3 1  ON 38
ci_0040                -3.933525e-03 3 1  ON 39
ci_0041                 9.636287e-03 3 1  ON 40
ci_0042                 9.532953e-03 3 1  ON 41
ci_0043                -6.343086e-03 3 1  ON 42
ci_0044                -6.774433e-03 3 1  ON 43
ci_0045                 1.045933e-02 3 1  ON 44
ci_0046                 9.383509e-03 3 1  ON 45
ci_0047                -3.644266e-03 3 1  ON 46
ci_0048                -3.595063e-03 3 1  ON 47
ci_0049                -2.504343e-03 3 1  ON 48
ci_0050                -2.823111e-03 3 1  ON 49
ci_0051                -1.835865e-03 3 1  ON 50
ci_0052                -1.716010e-03 3 1  ON 51
ci_0053                -4.036071e-03 3 1  ON 52
ci_0054                -3.938127e-03 3 1  ON 53
ci_0055                 2.508099e-03 3 1  ON 54
ci_0056                 2.146634e-03 3 1  ON 55
ci_0057                 2.391280e-03 3 1  ON 56
ci_0058                 3.125210e-03 3 1  ON 57
ci_0059                -4.061034e-03 3 1  ON 58
ci_0060                -3.655087e-03 3 1  ON 59
ci_0061                -2.865951e-03 3 1  ON 60
ci_0062                -3.079644e-03 3 1  ON 61
ci_0063                -9.741523e-03 3 1  ON 62
ci_0064                -9.713258e-03 3 1  ON 63
ci_0065                -7.181073e-03 3 1  ON 64
ci_0066                -6.636014e-03 3 1  ON 65
ci_0067                -3.951506e-03 3 1  ON 66
ci_0068                -3.957852e-03 3 1  ON 67
ci_0069                 3.825530e-03 3 1  ON 68
ci_0070                 3.580873e-03 3 1  ON 69
ci_0071                 4.381188e-03 3 1  ON 70
ci_0072                 4.651014e-03 3 1  ON 71
ci_0073                 3.394232e-03 3 1  ON 72
ci_0074                 3.189411e-03 3 1  ON 73
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 4.0500e+01 secs
  Total Execution time = 4.2185e+03 secs

=========================================================
  A new xml input file : H2O.s099.cont.xml
