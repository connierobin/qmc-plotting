Rank =    0  Free Memory = 89840 MB
Rank =    1  Free Memory = 89840 MB
Rank =    2  Free Memory = 89840 MB
Rank =    3  Free Memory = 89840 MB
Rank =    4  Free Memory = 89840 MB
Rank =    5  Free Memory = 89840 MB
Rank =    6  Free Memory = 89840 MB
Rank =    7  Free Memory = 89840 MB
Rank =    8  Free Memory = 89840 MB
Rank =    9  Free Memory = 89840 MB
Rank =   10  Free Memory = 89840 MB
Rank =   11  Free Memory = 89840 MB
Rank =   12  Free Memory = 89839 MB
Rank =   13  Free Memory = 89839 MB
Rank =   14  Free Memory = 89838 MB
Rank =   15  Free Memory = 89824 MB
Rank =   16  Free Memory = 89824 MB
Rank =   17  Free Memory = 89824 MB
Rank =   18  Free Memory = 89824 MB
Rank =   19  Free Memory = 89824 MB
Rank =   20  Free Memory = 89824 MB
Rank =   21  Free Memory = 89824 MB
Rank =   22  Free Memory = 89824 MB
Rank =   23  Free Memory = 89824 MB
Rank =   24  Free Memory = 89824 MB
Rank =   25  Free Memory = 89824 MB
Rank =   26  Free Memory = 89824 MB
Rank =   27  Free Memory = 89824 MB
Rank =   28  Free Memory = 89824 MB
Rank =   29  Free Memory = 89824 MB
Rank =   30  Free Memory = 89824 MB
Rank =   31  Free Memory = 89824 MB
Rank =   32  Free Memory = 90372 MB
Rank =   33  Free Memory = 90372 MB
Rank =   34  Free Memory = 90372 MB
Rank =   35  Free Memory = 90372 MB
Rank =   36  Free Memory = 90372 MB
Rank =   37  Free Memory = 90372 MB
Rank =   38  Free Memory = 90372 MB
Rank =   39  Free Memory = 90372 MB
Rank =   40  Free Memory = 90372 MB
Rank =   41  Free Memory = 90372 MB
Rank =   42  Free Memory = 90372 MB
Rank =   43  Free Memory = 90372 MB
Rank =   44  Free Memory = 90372 MB
Rank =   45  Free Memory = 90372 MB
Rank =   46  Free Memory = 90372 MB
Rank =   47  Free Memory = 90372 MB
Rank =   48  Free Memory = 90372 MB
Rank =   49  Free Memory = 90372 MB
Rank =   50  Free Memory = 90372 MB
Rank =   51  Free Memory = 90372 MB
Rank =   52  Free Memory = 90372 MB
Rank =   53  Free Memory = 90372 MB
Rank =   54  Free Memory = 90372 MB
Rank =   55  Free Memory = 90372 MB
Rank =   56  Free Memory = 90372 MB
Rank =   57  Free Memory = 90372 MB
Rank =   58  Free Memory = 90372 MB
Rank =   59  Free Memory = 90372 MB
Rank =   60  Free Memory = 90372 MB
Rank =   61  Free Memory = 90372 MB
Rank =   62  Free Memory = 90372 MB
Rank =   63  Free Memory = 90372 MB
Rank =   64  Free Memory = 90175 MB
Rank =   65  Free Memory = 90175 MB
Rank =   66  Free Memory = 90175 MB
Rank =   67  Free Memory = 90175 MB
Rank =   68  Free Memory = 90175 MB
Rank =   69  Free Memory = 90175 MB
Rank =   70  Free Memory = 90175 MB
Rank =   71  Free Memory = 90175 MB
Rank =   72  Free Memory = 90175 MB
Rank =   73  Free Memory = 90175 MB
Rank =   74  Free Memory = 90175 MB
Rank =   75  Free Memory = 90175 MB
Rank =   76  Free Memory = 90175 MB
Rank =   77  Free Memory = 90175 MB
Rank =   78  Free Memory = 90175 MB
Rank =   79  Free Memory = 90175 MB
Rank =   80  Free Memory = 90175 MB
Rank =   81  Free Memory = 90174 MB
Rank =   82  Free Memory = 90174 MB
Rank =   83  Free Memory = 90174 MB
Rank =   84  Free Memory = 90174 MB
Rank =   85  Free Memory = 90174 MB
Rank =   86  Free Memory = 90174 MB
Rank =   87  Free Memory = 90174 MB
Rank =   88  Free Memory = 90174 MB
Rank =   89  Free Memory = 90174 MB
Rank =   90  Free Memory = 90174 MB
Rank =   91  Free Memory = 90174 MB
Rank =   92  Free Memory = 90174 MB
Rank =   93  Free Memory = 90174 MB
Rank =   94  Free Memory = 90174 MB
Rank =   95  Free Memory = 90174 MB
Rank =   96  Free Memory = 90354 MB
Rank =   97  Free Memory = 90354 MB
Rank =   98  Free Memory = 90354 MB
Rank =   99  Free Memory = 90354 MB
Rank =  100  Free Memory = 90354 MB
Rank =  101  Free Memory = 90354 MB
Rank =  102  Free Memory = 90354 MB
Rank =  103  Free Memory = 90354 MB
Rank =  104  Free Memory = 90354 MB
Rank =  105  Free Memory = 90354 MB
Rank =  106  Free Memory = 90354 MB
Rank =  107  Free Memory = 90354 MB
Rank =  108  Free Memory = 90354 MB
Rank =  109  Free Memory = 90354 MB
Rank =  110  Free Memory = 90354 MB
Rank =  111  Free Memory = 90354 MB
Rank =  112  Free Memory = 90354 MB
Rank =  113  Free Memory = 90354 MB
Rank =  114  Free Memory = 90354 MB
Rank =  115  Free Memory = 90354 MB
Rank =  116  Free Memory = 90354 MB
Rank =  117  Free Memory = 90354 MB
Rank =  118  Free Memory = 90354 MB
Rank =  119  Free Memory = 90354 MB
Rank =  120  Free Memory = 90354 MB
Rank =  121  Free Memory = 90354 MB
Rank =  122  Free Memory = 90354 MB
Rank =  123  Free Memory = 90354 MB
Rank =  124  Free Memory = 90354 MB
Rank =  125  Free Memory = 90354 MB
Rank =  126  Free Memory = 90354 MB
Rank =  127  Free Memory = 90354 MB
  Input file(s): opt_h2o_1b1_tett_run001e.xml 

=====================================================
                    QMCPACK 3.7.9

       (c) Copyright 2003-  QMCPACK developers

                    Please cite:
 J. Kim et al. J. Phys. Cond. Mat. 30 195901 (2018)
      https://doi.org/10.1088/1361-648X/aab9c3

  Git branch: gvp
  Last git commit: a1d851bbe8d902a0d3168a885b757a378aeaab54-dirty
  Last git commit date: Mon Feb 13 11:52:39 2023 -0800
  Last git commit subject: Print param update magnitude and largest update
=====================================================
  Global options 

  Total number of MPI ranks = 128
  Number of MPI groups      = 1
  MPI group ID              = 0
  Number of ranks in group  = 128
  MPI ranks per node        = 32
  OMP 1st level threads     = 1
  OMP nested threading disabled or only 1 thread on the 2nd level

  Precision used in this calculation, see definitions in the manual:
  Base precision      = double
  Full precision      = double

  Structure-of-arrays (SoA) optimization enabled

  Input XML = opt_h2o_1b1_tett_run001e.xml

  Project = H2O
  date    = 2023-03-08 17:13:08 PST
  host    = n0091.savio3

 Random Number
 -------------
  Offset for the random number seeds based on time: 676

  Range of prime numbers to use as seeds over processors and threads = 5077-6199


 Particle Set 
 ------------
  Name: e
  All the species have the same mass 1
  Particle set size: 8

 Particle Set 
 ------------
  Name: ion0
  All the species have the same mass 1
  Particle set size: 3

 Wavefunction setup: 
 ------------------- 
  Name: psi0

   Jastrow
   -------
    Name: J2   Type: Two-Body   Function: Bspline

    Radial function for species: u - u
     Number of parameters: 10
     Cusp: -0.25
     Cutoff radius: 10

     Name                        Value Type Recompute Use Index
     ---- ---------------------------- ---- --------- --- -----
     uu_0                 2.517233e-01    1         1 OFF
     uu_1                 1.009440e-01    1         1 OFF
     uu_2                 1.617079e-02    1         1 OFF
     uu_3                -3.223684e-02    1         1 OFF
     uu_4                -6.387117e-02    1         1 OFF
     uu_5                -8.576607e-02    1         1 OFF
     uu_6                -1.001312e-01    1         1 OFF
     uu_7                -1.065673e-01    1         1 OFF
     uu_8                -9.668739e-02    1         1 OFF
     uu_9                -6.389513e-02    1         1 OFF

    Radial function for species: u - d
     Number of parameters: 10
     Cusp: -5.000000e-01
     Cutoff radius: 1.000000e+01

     Name                        Value Type Recompute Use Index
     ---- ---------------------------- ---- --------- --- -----
     ud_0                 3.492134e-01    1         1 OFF
     ud_1                 1.235409e-01    1         1 OFF
     ud_2                 2.392782e-02    1         1 OFF
     ud_3                -3.019578e-02    1         1 OFF
     ud_4                -6.975615e-02    1         1 OFF
     ud_5                -9.484122e-02    1         1 OFF
     ud_6                -1.085598e-01    1         1 OFF
     ud_7                -1.109505e-01    1         1 OFF
     ud_8                -9.792103e-02    1         1 OFF
     ud_9                -6.281979e-02    1         1 OFF


   Jastrow
   -------
    Name: J1   Type: One-Body   Function: Bspline

    Radial function for element: O
     Number of parameters: 10
     Cusp: 0.000000e+00
     Cutoff radius: 1.000000e+01

     Name                        Value Type Recompute Use Index
     ---- ---------------------------- ---- --------- --- -----
     eO_0                -5.692885e-01    1         1 OFF
     eO_1                -3.060844e-01    1         1 OFF
     eO_2                 4.730127e-02    1         1 OFF
     eO_3                 2.840620e-01    1         1 OFF
     eO_4                 3.913445e-01    1         1 OFF
     eO_5                 3.212389e-01    1         1 OFF
     eO_6                 1.205694e-01    1         1 OFF
     eO_7                -7.888705e-02    1         1 OFF
     eO_8                -1.549102e-01    1         1 OFF
     eO_9                -6.122098e-02    1         1 OFF

    Radial function for element: H1
     Number of parameters: 10
     Cusp: 0.000000e+00
     Cutoff radius: 1.000000e+01

      Name                        Value Type Recompute Use Index
     ----- ---------------------------- ---- --------- --- -----
     eH1_0                -2.277697e-01    1         1 OFF
     eH1_1                -1.106400e-01    1         1 OFF
     eH1_2                -6.162952e-02    1         1 OFF
     eH1_3                -2.530653e-02    1         1 OFF
     eH1_4                 4.247832e-03    1         1 OFF
     eH1_5                 2.367079e-02    1         1 OFF
     eH1_6                 6.569443e-02    1         1 OFF
     eH1_7                 1.154361e-01    1         1 OFF
     eH1_8                 1.435221e-01    1         1 OFF
     eH1_9                 7.467419e-02    1         1 OFF

    Radial function for element: H2
     Number of parameters: 10
     Cusp: 0.000000e+00
     Cutoff radius: 1.000000e+01

      Name                        Value Type Recompute Use Index
     ----- ---------------------------- ---- --------- --- -----
     eH2_0                -2.307043e-01    1         1 OFF
     eH2_1                -1.139386e-01    1         1 OFF
     eH2_2                -6.444539e-02    1         1 OFF
     eH2_3                -2.722663e-02    1         1 OFF
     eH2_4                 1.073593e-03    1         1 OFF
     eH2_5                 2.532957e-02    1         1 OFF
     eH2_6                 7.564477e-02    1         1 OFF
     eH2_7                 1.260027e-01    1         1 OFF
     eH2_8                 1.609124e-01    1         1 OFF
     eH2_9                 6.417217e-02    1         1 OFF

  Created SPOSet builder named 'LCAOBSet' of type molecularorbital
  LCAO: SoaAtomicBasisSet<MultiQuintic,0>
  AO BasisSet for O
   Angular momentum expanded in cartesian functions x^lx y^ly z^lz according to Gamess
Using log grid with default values: ri = 1.000000e-06 rf = 1.000000e+02 npts = 1001
   R(n,l,m,s) 0 0 0 0
   R(n,l,m,s) 1 0 0 0
   R(n,l,m,s) 2 1 0 0
   R(n,l,m,s) 3 1 0 0
   R(n,l,m,s) 4 2 0 0
Expanding Ylm (angular function) according to Gamess using cartesian gaussians
Adding 1 cartesian gaussian orbitals for l= 0
Adding 1 cartesian gaussian orbitals for l= 0
Adding 3 cartesian gaussian orbitals for l= 1
Adding 3 cartesian gaussian orbitals for l= 1
Adding 6 cartesian gaussian orbitals for l= 2
  Setting cutoff radius 1.018591e+01

   Maximum Angular Momentum  = 2
   Number of Radial functors = 5
   Basis size                = 14

  AO BasisSet for H1
   Angular momentum expanded in cartesian functions x^lx y^ly z^lz according to Gamess
Using log grid with default values: ri = 1.000000e-06 rf = 1.000000e+02 npts = 1001
   R(n,l,m,s) 0 0 0 0
   R(n,l,m,s) 1 0 0 0
   R(n,l,m,s) 2 1 0 0
Expanding Ylm (angular function) according to Gamess using cartesian gaussians
Adding 1 cartesian gaussian orbitals for l= 0
Adding 1 cartesian gaussian orbitals for l= 0
Adding 3 cartesian gaussian orbitals for l= 1
  Setting cutoff radius 1.270574e+01

   Maximum Angular Momentum  = 1
   Number of Radial functors = 3
   Basis size                = 5

  AO BasisSet for H2
   Angular momentum expanded in cartesian functions x^lx y^ly z^lz according to Gamess
Using log grid with default values: ri = 1.000000e-06 rf = 1.000000e+02 npts = 1001
   R(n,l,m,s) 0 0 0 0
   R(n,l,m,s) 1 0 0 0
   R(n,l,m,s) 2 1 0 0
Expanding Ylm (angular function) according to Gamess using cartesian gaussians
Adding 1 cartesian gaussian orbitals for l= 0
Adding 1 cartesian gaussian orbitals for l= 0
Adding 3 cartesian gaussian orbitals for l= 1
  Setting cutoff radius 1.270574e+01

   Maximum Angular Momentum  = 1
   Number of Radial functors = 3
   Basis size                = 5

Creating SPOSet in SlaterDetBuilder::put(xmlNodePtr cur).
spo_name = spo-up
  Building SPOSet 'spo-up' with '' basis set.
Creating SPOSet in SlaterDetBuilder::put(xmlNodePtr cur).
spo_name = spo-dn
  Building SPOSet 'spo-dn' with '' basis set.
Using Bryan's algorithm for MultiSlaterDeterminant expansion. 
Creating base determinant (up) for MSD expansion. 
Creating base determinant (down) for MSD expansion. 
Found determinant list. 
Reading CI expansion.
Found 75 terms in the MSD expansion.
Norm of ci vector (sum of ci^2): 9.917803e-01
Norm of qchem ci vector (sum of qchem_ci^2): 0.000000e+00
Found 30 unique up determinants.
Found 30 unique down determinants.
Number of terms in pairs array: 20
Number of terms in pairs array: 20
CI coefficients are optimizable. 
  FermionWF = MultiSlaterDeterminantFast
  QMCHamiltonian::addOperator Kinetic to H, physical Hamiltonian 
  QMCHamiltonian::addOperator ElecElec to H, physical Hamiltonian 
QMCHamiltonian::addOperatorType added type coulomb named ElecElec

  ECPotential builder for pseudopotential 

  Adding pseudopotential for O
   Linear grid  ri=0.000000e+00 rf=1.000000e+01 npts = 10001
    ECPComponentBuilder::buildSemiLocalAndLocal 
    Assuming Hartree unit
   Number of angular momentum channels 2
   Maximum angular momentum channel 1
   Creating a Linear Grid Rmax=1.075000e+00
  Using global grid with delta = 1.000000e-03
   Making L=1 a local potential with a radial cutoff of 9.999000e+00
    Non-local pseudopotential parameters
    Maximum angular mementum = 0
    Number of non-local channels = 1
       l(0)=0
    Cutoff radius = 1.075000e+00
    Spherical grids and weights: 
         1.0000000000e+00  0.0000000000e+00  0.0000000000e+00    8.3333333333e-02
        -1.0000000000e+00  1.2246467991e-16  0.0000000000e+00    8.3333333333e-02
         4.4721359550e-01  8.9442719100e-01  0.0000000000e+00    8.3333333333e-02
        -4.4721359550e-01  7.2360679775e-01  5.2573111212e-01    8.3333333333e-02
         4.4721359550e-01  2.7639320225e-01  8.5065080835e-01    8.3333333333e-02
        -4.4721359550e-01 -2.7639320225e-01  8.5065080835e-01    8.3333333333e-02
         4.4721359550e-01 -7.2360679775e-01  5.2573111212e-01    8.3333333333e-02
        -4.4721359550e-01 -8.9442719100e-01  1.0953573965e-16    8.3333333333e-02
         4.4721359550e-01 -7.2360679775e-01 -5.2573111212e-01    8.3333333333e-02
        -4.4721359550e-01 -2.7639320225e-01 -8.5065080835e-01    8.3333333333e-02
         4.4721359550e-01  2.7639320225e-01 -8.5065080835e-01    8.3333333333e-02
        -4.4721359550e-01  7.2360679775e-01 -5.2573111212e-01    8.3333333333e-02
    Maximum cutoff radius 1.0750000000e+00

  Adding pseudopotential for H1
   Linear grid  ri=0.0000000000e+00 rf=1.0000000000e+01 npts = 10001
    ECPComponentBuilder::buildSemiLocalAndLocal 
    Assuming Hartree unit
   Number of angular momentum channels 2
   Maximum angular momentum channel 1
   Creating a Linear Grid Rmax=1.0000000000e-10
  Using global grid with delta = 1.0000000000e-03
   Making L=1 a local potential with a radial cutoff of 9.9990000000e+00
    Non-local pseudopotential parameters
    Maximum angular mementum = 0
    Number of non-local channels = 1
       l(0)=0
    Cutoff radius = 1.0000000000e-03
    Spherical grids and weights: 
         1.0000000000e+00  0.0000000000e+00  0.0000000000e+00    8.3333333333e-02
        -1.0000000000e+00  1.2246467991e-16  0.0000000000e+00    8.3333333333e-02
         4.4721359550e-01  8.9442719100e-01  0.0000000000e+00    8.3333333333e-02
        -4.4721359550e-01  7.2360679775e-01  5.2573111212e-01    8.3333333333e-02
         4.4721359550e-01  2.7639320225e-01  8.5065080835e-01    8.3333333333e-02
        -4.4721359550e-01 -2.7639320225e-01  8.5065080835e-01    8.3333333333e-02
         4.4721359550e-01 -7.2360679775e-01  5.2573111212e-01    8.3333333333e-02
        -4.4721359550e-01 -8.9442719100e-01  1.0953573965e-16    8.3333333333e-02
         4.4721359550e-01 -7.2360679775e-01 -5.2573111212e-01    8.3333333333e-02
        -4.4721359550e-01 -2.7639320225e-01 -8.5065080835e-01    8.3333333333e-02
         4.4721359550e-01  2.7639320225e-01 -8.5065080835e-01    8.3333333333e-02
        -4.4721359550e-01  7.2360679775e-01 -5.2573111212e-01    8.3333333333e-02
    Maximum cutoff radius 1.0000000000e-03

  Adding pseudopotential for H2
   Linear grid  ri=0.0000000000e+00 rf=1.0000000000e+01 npts = 10001
    ECPComponentBuilder::buildSemiLocalAndLocal 
    Assuming Hartree unit
   Number of angular momentum channels 2
   Maximum angular momentum channel 1
   Creating a Linear Grid Rmax=1.0000000000e-10
  Using global grid with delta = 1.0000000000e-03
   Making L=1 a local potential with a radial cutoff of 9.9990000000e+00
    Non-local pseudopotential parameters
    Maximum angular mementum = 0
    Number of non-local channels = 1
       l(0)=0
    Cutoff radius = 1.0000000000e-03
    Spherical grids and weights: 
         1.0000000000e+00  0.0000000000e+00  0.0000000000e+00    8.3333333333e-02
        -1.0000000000e+00  1.2246467991e-16  0.0000000000e+00    8.3333333333e-02
         4.4721359550e-01  8.9442719100e-01  0.0000000000e+00    8.3333333333e-02
        -4.4721359550e-01  7.2360679775e-01  5.2573111212e-01    8.3333333333e-02
         4.4721359550e-01  2.7639320225e-01  8.5065080835e-01    8.3333333333e-02
        -4.4721359550e-01 -2.7639320225e-01  8.5065080835e-01    8.3333333333e-02
         4.4721359550e-01 -7.2360679775e-01  5.2573111212e-01    8.3333333333e-02
        -4.4721359550e-01 -8.9442719100e-01  1.0953573965e-16    8.3333333333e-02
         4.4721359550e-01 -7.2360679775e-01 -5.2573111212e-01    8.3333333333e-02
        -4.4721359550e-01 -2.7639320225e-01 -8.5065080835e-01    8.3333333333e-02
         4.4721359550e-01  2.7639320225e-01 -8.5065080835e-01    8.3333333333e-02
        -4.4721359550e-01  7.2360679775e-01 -5.2573111212e-01    8.3333333333e-02
    Maximum cutoff radius 1.0000000000e-03
  QMCHamiltonian::addOperator LocalECP to H, physical Hamiltonian 

  Using NonLocalECP potential 
    Maximum grid on a sphere for NonLocalECPotential: 12
  QMCHamiltonian::addOperator NonLocalECP to H, physical Hamiltonian 
QMCHamiltonian::addOperatorType added type pseudo named NonLocalECP
  QMCHamiltonian::addOperator IonIon to H, physical Hamiltonian 
QMCHamiltonian::addOperatorType added type coulomb named IonIon

  QMCHamiltonian::add2WalkerProperty added
    5 to P::PropertyList 
    0 to P::Collectables 
    starting Index of the observables in P::PropertyList = 10
ParticleSetPool::randomize 
  Initialization Execution time = 3.8860e-01 secs
=========================================================
 Summary of QMC systems 
=========================================================
ParticleSetPool has: 

  ParticleSet 'e' contains 8 particles :  u(4) d(4)

    u  6.1002844054e-01  1.3250453608e-01 -4.2267217978e-01
    u -4.3494847795e-01 -2.3203549626e-01  1.0876787134e-01
    u -1.5984350305e-01  8.1842956548e-01  5.1837161342e-02
    u  1.1948334779e+00  1.4453040952e+00  1.6346730752e+00
    d -9.5054657961e-01  2.3768909128e-01 -6.0876959125e-01
    d -2.0429807517e-01  1.5546410594e+00 -1.0292769217e-01
    d  4.7451519973e-01  3.4811618685e-02  3.5425821429e-01
    d -8.6403568621e-02 -1.8286319639e+00  9.9844026831e-01

  Distance table for similar particles (A-A):
    source/target: e
    Using structure-of-arrays (SoA) data layout
    Distance computations use open boundary conditions in 3D.

  Distance table for dissimilar particles (A-B):
    source: ion0  target: e
    Using structure-of-arrays (SoA) data layout
    Distance computations use open boundary conditions in 3D.


  ParticleSet 'ion0' contains 3 particles :  O(1) H1(1) H2(1)

    O  0.0000000000e+00  0.0000000000e+00 -1.3209751581e-01
    H1  0.0000000000e+00  1.4315279079e+00  9.7970009311e-01
    H2  0.0000000000e+00 -1.4315279079e+00  9.7970009311e-01

  Distance table for similar particles (A-A):
    source/target: ion0
    Using structure-of-arrays (SoA) data layout
    Distance computations use open boundary conditions in 3D.


  Hamiltonian h0
  Kinetic         Kinetic energy
  ElecElec        CoulombAA source/target e

  LocalECP        LocalECPotential: ion0
  NonLocalECP     NonLocalECPotential: ion0
  IonIon          CoulombAA source/target ion0


Loop execution max-interations = 100
Inside LM engine constructor, num_params is: 0 and _total_num_params is: 0

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s000 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15
  Adding 1 walkers to 0 existing sets
  Total number of walkers: 1.2800000000e+02
  Total weight: 1.2800000000e+02

=========================================================
  Start VMC
  File Root H2O.s000 append = no 
=========================================================
Resetting walkers
  Using the current 1 walkers.
  Total number of walkers: 1.2800000000e+02
  Total weight: 1.2800000000e+02
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=0  my_counter=0
  time step      = 5.0000000000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000000000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625000000e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000000000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000000000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000000000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000000000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000000000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000000000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000000000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625000000e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000000000e-02</parameter>
<parameter name="time_step" condition="au">5.0000000000e-02</parameter>
<parameter name="timestep" condition="au">5.0000000000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
  Set drift_modifier UNR parameter a = 1.0000000000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000000000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: 0 and ratio_threshold_: 0.0000000000e+00
Allocating full size _hmat_temp and _smat_temp
Inside LM engine's get_param, num_params is: 74
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 0
    time step          = 0.05
    reference energy   = -16.8881
    reference variance = 0.211018
====================================================
  Execution time = 1.5700e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s000
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5242e+04
  VMC Eavg = -1.6899e+01
  VMC Evar = 2.8735e-01
  Total weights = 1.950868784e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 2.6775e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.279932273203
                                         uncertainty =       0.001475557956

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.279932273203
                                         uncertainty =       0.001475557956

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000374124484
  error estimate for blocks of size 2^( 2) =       0.000391148471
  error estimate for blocks of size 2^( 3) =       0.000407977499
  error estimate for blocks of size 2^( 4) =       0.000423257230
  error estimate for blocks of size 2^( 5) =       0.000435065381
  error estimate for blocks of size 2^( 6) =       0.000443143649
  error estimate for blocks of size 2^( 7) =       0.000446306138

      target function =      -0.932619931327
              le_mean =     -16.899061740642
             les_mean =     285.865635138645
             stat err =       0.000436943099
             autocorr =       1.364009853887
   target nu stat err =       0.000436943099
   target dn stat err =       0.001724962366
      target stat err =       0.002853211517
              std dev =       0.529091919471
             le_variance =       0.279938259250


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy-1.689906174064e+01 
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 74
Check correct_vf_var_size: 225, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.5000e-01, overlap shift 2.5000e+00 and omega -1.7444e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.932627340559       residual = 6.05e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.932720676686       residual = 9.44e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.932736145723       residual = 4.09e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.932741932831       residual = 2.47e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.932747042556       residual = 7.31e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.932749070164       residual = 4.01e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.932749885340       residual = 1.08e-05           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.932749826302       residual = 3.99e-06           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.932749952341       residual = 1.34e-06           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.932750035842       residual = 8.57e-07           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.932750055287       residual = 5.17e-07           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.932750085197       residual = 4.16e-07           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.932750187093       residual = 4.64e-07           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.932750206407       residual = 3.97e-07           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.932750150883       residual = 2.01e-07           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.932750102021       residual = 9.29e-08           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.932750143850       residual = 2.56e-08           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.932750145521       residual = 9.92e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         17 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 2.5000e-01 is 7.979309e-04

solving harmonic davidson linear method for identity shift 1.0000e+00, overlap shift 1.0000e+01 and omega -1.7444e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.932627340559       residual = 6.05e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.932655765283       residual = 9.17e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.932660332485       residual = 3.78e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.932661887644       residual = 2.20e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.932663236171       residual = 5.99e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.932663732092       residual = 3.02e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.932663929601       residual = 7.68e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.932663908085       residual = 2.78e-06           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.932663934142       residual = 9.68e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.932663953748       residual = 6.24e-07           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.932663959562       residual = 3.98e-07           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.932663968131       residual = 3.39e-07           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.932663992271       residual = 3.31e-07           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.932663991741       residual = 2.22e-07           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.932663977297       residual = 8.44e-08           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.932663969220       residual = 3.51e-08           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.932663977382       residual = 8.44e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         16 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 1.0000e+00 is 2.214032e-04

solving harmonic davidson linear method for identity shift 4.0000e+00, overlap shift 4.0000e+01 and omega -1.7444e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.932627340559       residual = 6.05e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.932634856636       residual = 9.09e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.932636052276       residual = 3.68e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.932636447035       residual = 2.12e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.932636787712       residual = 5.62e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.932636910147       residual = 2.76e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.932636958818       residual = 6.89e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.932636952953       residual = 2.48e-06           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.932636959013       residual = 8.78e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.932636963821       residual = 5.67e-07           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.932636965373       residual = 3.68e-07           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.932636967593       residual = 3.17e-07           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.932636973405       residual = 2.93e-07           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.932636972881       residual = 1.82e-07           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.932636969347       residual = 6.39e-08           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.932636967617       residual = 2.58e-08           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.932636969492       residual = 6.02e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         16 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 4.0000e+00 is 5.689123e-05

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.149629 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 75 and numParams is: 74

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.8537e+01
  </log>
  <optVariables href="H2O.s000.opt.xml">
ci_0001 7.079328e-01                 3 1 ON  0
ci_0002 6.933800e-01                 3 1 ON  1
ci_0003 -3.120393e-02                3 1 ON  2
ci_0004 -3.033200e-02                3 1 ON  3
ci_0005 -3.055799e-02                3 1 ON  4
ci_0006 -3.072998e-02                3 1 ON  5
ci_0007 -1.367168e-02                3 1 ON  6
ci_0008 -1.348884e-02                3 1 ON  7
ci_0009 -1.884144e-02                3 1 ON  8
ci_0010 -1.816192e-02                3 1 ON  9
ci_0011 -1.473895e-02                3 1 ON  10
ci_0012 -1.467619e-02                3 1 ON  11
ci_0013 1.530642e-02                 3 1 ON  12
ci_0014 1.483785e-02                 3 1 ON  13
ci_0015 1.592648e-02                 3 1 ON  14
ci_0016 1.553688e-02                 3 1 ON  15
ci_0017 1.345051e-02                 3 1 ON  16
ci_0018 1.316787e-02                 3 1 ON  17
ci_0019 1.300998e-02                 3 1 ON  18
ci_0020 1.260985e-02                 3 1 ON  19
ci_0021 7.629252e-03                 3 1 ON  20
ci_0022 8.174817e-03                 3 1 ON  21
ci_0023 -1.182644e-02                3 1 ON  22
ci_0024 -1.135037e-02                3 1 ON  23
ci_0025 -2.009396e-03                3 1 ON  24
ci_0026 -2.737375e-03                3 1 ON  25
ci_0027 -1.205373e-02                3 1 ON  26
ci_0028 -1.156426e-02                3 1 ON  27
ci_0029 -1.051338e-02                3 1 ON  28
ci_0030 -1.044892e-02                3 1 ON  29
ci_0031 1.353797e-02                 3 1 ON  30
ci_0032 1.221342e-02                 3 1 ON  31
ci_0033 7.941751e-03                 3 1 ON  32
ci_0034 8.503672e-03                 3 1 ON  33
ci_0035 5.009265e-03                 3 1 ON  34
ci_0036 5.033953e-03                 3 1 ON  35
ci_0037 -1.131006e-02                3 1 ON  36
ci_0038 -1.149029e-02                3 1 ON  37
ci_0039 -4.020443e-03                3 1 ON  38
ci_0040 -4.017190e-03                3 1 ON  39
ci_0041 8.956985e-03                 3 1 ON  40
ci_0042 8.751527e-03                 3 1 ON  41
ci_0043 -1.260991e-02                3 1 ON  42
ci_0044 -1.324949e-02                3 1 ON  43
ci_0045 1.066728e-02                 3 1 ON  44
ci_0046 1.016061e-02                 3 1 ON  45
ci_0047 -3.630618e-03                3 1 ON  46
ci_0048 -3.431305e-03                3 1 ON  47
ci_0049 -2.588836e-03                3 1 ON  48
ci_0050 -2.865537e-03                3 1 ON  49
ci_0051 -1.761110e-03                3 1 ON  50
ci_0052 -2.096836e-03                3 1 ON  51
ci_0053 -4.019615e-03                3 1 ON  52
ci_0054 -3.329159e-03                3 1 ON  53
ci_0055 2.757209e-03                 3 1 ON  54
ci_0056 2.259449e-03                 3 1 ON  55
ci_0057 2.369714e-03                 3 1 ON  56
ci_0058 3.171381e-03                 3 1 ON  57
ci_0059 -3.341466e-03                3 1 ON  58
ci_0060 -3.277268e-03                3 1 ON  59
ci_0061 -3.944280e-03                3 1 ON  60
ci_0062 -3.920455e-03                3 1 ON  61
ci_0063 -9.976769e-03                3 1 ON  62
ci_0064 -9.429587e-03                3 1 ON  63
ci_0065 -6.381482e-03                3 1 ON  64
ci_0066 -6.228064e-03                3 1 ON  65
ci_0067 -3.649646e-03                3 1 ON  66
ci_0068 -3.386576e-03                3 1 ON  67
ci_0069 3.747346e-03                 3 1 ON  68
ci_0070 3.428237e-03                 3 1 ON  69
ci_0071 2.949056e-03                 3 1 ON  70
ci_0072 3.646360e-03                 3 1 ON  71
ci_0073 3.636094e-03                 3 1 ON  72
ci_0074 3.624532e-03                 3 1 ON  73
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 0
    time step          = 0.05
    reference energy   = -16.881
    reference variance = 0.327208
====================================================
  Execution time = 1.4835e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s000
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6899e+01
  VMC Evar = 2.9060e-01
  Total weights = 1.9507e+06
  Execution time = 1.9422e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.280486341415
                                         uncertainty =       0.001589524588

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.280486341415
                                         uncertainty =       0.001589524588

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000374573328
  error estimate for blocks of size 2^( 2) =       0.000391519324
  error estimate for blocks of size 2^( 3) =       0.000408478030
  error estimate for blocks of size 2^( 4) =       0.000423694476
  error estimate for blocks of size 2^( 5) =       0.000434145673
  error estimate for blocks of size 2^( 6) =       0.000441736408
  error estimate for blocks of size 2^( 7) =       0.000445816353

      target function =      -0.921607662644
              le_mean =     -16.898879883227
             les_mean =     285.866444051527
             stat err =       0.000436348228
             autocorr =       1.357040265214
   target nu stat err =       0.000436348228
   target dn stat err =       0.004243662412
      target stat err =       0.006653988615
              std dev =       0.529726680044
             le_variance =       0.280610355550

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.280430675028
                                         uncertainty =       0.001580254673

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.280430675028
                                         uncertainty =       0.001580254673

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000374536456
  error estimate for blocks of size 2^( 2) =       0.000391478340
  error estimate for blocks of size 2^( 3) =       0.000408426330
  error estimate for blocks of size 2^( 4) =       0.000423639834
  error estimate for blocks of size 2^( 5) =       0.000434087976
  error estimate for blocks of size 2^( 6) =       0.000441672593
  error estimate for blocks of size 2^( 7) =       0.000445753933

      target function =      -0.926851520696
              le_mean =     -16.898883416733
             les_mean =     285.863237628813
             stat err =       0.000436288584
             autocorr =       1.356936436677
   target nu stat err =       0.000436288584
   target dn stat err =       0.002413103894
      target stat err =       0.003874864873
              std dev =       0.529674536070
             le_variance =       0.280555114161

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.280446285492
                                         uncertainty =       0.001584079014

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.280446285492
                                         uncertainty =       0.001584079014

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000374546781
  error estimate for blocks of size 2^( 2) =       0.000391490271
  error estimate for blocks of size 2^( 3) =       0.000408442540
  error estimate for blocks of size 2^( 4) =       0.000423657002
  error estimate for blocks of size 2^( 5) =       0.000434107239
  error estimate for blocks of size 2^( 6) =       0.000441696359
  error estimate for blocks of size 2^( 7) =       0.000445777174

      target function =      -0.927375187988
              le_mean =     -16.898881047576
             les_mean =     285.862826235749
             stat err =       0.000436309444
             autocorr =       1.356991376553
   target nu stat err =       0.000436309444
   target dn stat err =       0.002314056929
      target stat err =       0.003725878486
              std dev =       0.529689137656
             le_variance =       0.280570582551

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.280479605537
                                         uncertainty =       0.001588800423

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.280479605537
                                         uncertainty =       0.001588800423

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000374568858
  error estimate for blocks of size 2^( 2) =       0.000391514703
  error estimate for blocks of size 2^( 3) =       0.000408472643
  error estimate for blocks of size 2^( 4) =       0.000423688609
  error estimate for blocks of size 2^( 5) =       0.000434141274
  error estimate for blocks of size 2^( 6) =       0.000441734762
  error estimate for blocks of size 2^( 7) =       0.000445814825

      target function =      -0.927045228472
              le_mean =     -16.898879729558
             les_mean =     285.862991410279
             stat err =       0.000436344867
             autocorr =       1.357051751614
   target nu stat err =       0.000436344867
   target dn stat err =       0.002246349980
      target stat err =       0.003618731044
              std dev =       0.529720358950
             le_variance =       0.280603658686


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.921607662644        initial
     2.5000e-01     2.5000e+00             7.9793e-04        -0.926851520696
     1.0000e+00     1.0000e+01             2.2140e-04        -0.927375187988  <--
     4.0000e+00     4.0000e+01             5.6891e-05        -0.927045228472

*****************************************************************************
Applying the update for shift_i =   1.0000e+00     and shift_s =   1.0000e+01
*****************************************************************************

  Execution time = 2.4624e+01
  </log>
  <optVariables href="H2O.s000.opt.xml">
ci_0001                 7.079328e-01 3 1  ON 0
ci_0002                 6.933800e-01 3 1  ON 1
ci_0003                -3.120393e-02 3 1  ON 2
ci_0004                -3.033200e-02 3 1  ON 3
ci_0005                -3.055799e-02 3 1  ON 4
ci_0006                -3.072998e-02 3 1  ON 5
ci_0007                -1.367168e-02 3 1  ON 6
ci_0008                -1.348884e-02 3 1  ON 7
ci_0009                -1.884144e-02 3 1  ON 8
ci_0010                -1.816192e-02 3 1  ON 9
ci_0011                -1.473895e-02 3 1  ON 10
ci_0012                -1.467619e-02 3 1  ON 11
ci_0013                 1.530642e-02 3 1  ON 12
ci_0014                 1.483785e-02 3 1  ON 13
ci_0015                 1.592648e-02 3 1  ON 14
ci_0016                 1.553688e-02 3 1  ON 15
ci_0017                 1.345051e-02 3 1  ON 16
ci_0018                 1.316787e-02 3 1  ON 17
ci_0019                 1.300998e-02 3 1  ON 18
ci_0020                 1.260985e-02 3 1  ON 19
ci_0021                 7.629252e-03 3 1  ON 20
ci_0022                 8.174817e-03 3 1  ON 21
ci_0023                -1.182644e-02 3 1  ON 22
ci_0024                -1.135037e-02 3 1  ON 23
ci_0025                -2.009396e-03 3 1  ON 24
ci_0026                -2.737375e-03 3 1  ON 25
ci_0027                -1.205373e-02 3 1  ON 26
ci_0028                -1.156426e-02 3 1  ON 27
ci_0029                -1.051338e-02 3 1  ON 28
ci_0030                -1.044892e-02 3 1  ON 29
ci_0031                 1.353797e-02 3 1  ON 30
ci_0032                 1.221342e-02 3 1  ON 31
ci_0033                 7.941751e-03 3 1  ON 32
ci_0034                 8.503672e-03 3 1  ON 33
ci_0035                 5.009265e-03 3 1  ON 34
ci_0036                 5.033953e-03 3 1  ON 35
ci_0037                -1.131006e-02 3 1  ON 36
ci_0038                -1.149029e-02 3 1  ON 37
ci_0039                -4.020443e-03 3 1  ON 38
ci_0040                -4.017190e-03 3 1  ON 39
ci_0041                 8.956985e-03 3 1  ON 40
ci_0042                 8.751527e-03 3 1  ON 41
ci_0043                -1.260991e-02 3 1  ON 42
ci_0044                -1.324949e-02 3 1  ON 43
ci_0045                 1.066728e-02 3 1  ON 44
ci_0046                 1.016061e-02 3 1  ON 45
ci_0047                -3.630618e-03 3 1  ON 46
ci_0048                -3.431305e-03 3 1  ON 47
ci_0049                -2.588836e-03 3 1  ON 48
ci_0050                -2.865537e-03 3 1  ON 49
ci_0051                -1.761110e-03 3 1  ON 50
ci_0052                -2.096836e-03 3 1  ON 51
ci_0053                -4.019615e-03 3 1  ON 52
ci_0054                -3.329159e-03 3 1  ON 53
ci_0055                 2.757209e-03 3 1  ON 54
ci_0056                 2.259449e-03 3 1  ON 55
ci_0057                 2.369714e-03 3 1  ON 56
ci_0058                 3.171381e-03 3 1  ON 57
ci_0059                -3.341466e-03 3 1  ON 58
ci_0060                -3.277268e-03 3 1  ON 59
ci_0061                -3.944280e-03 3 1  ON 60
ci_0062                -3.920455e-03 3 1  ON 61
ci_0063                -9.976769e-03 3 1  ON 62
ci_0064                -9.429587e-03 3 1  ON 63
ci_0065                -6.381482e-03 3 1  ON 64
ci_0066                -6.228064e-03 3 1  ON 65
ci_0067                -3.649646e-03 3 1  ON 66
ci_0068                -3.386576e-03 3 1  ON 67
ci_0069                 3.747346e-03 3 1  ON 68
ci_0070                 3.428237e-03 3 1  ON 69
ci_0071                 2.949056e-03 3 1  ON 70
ci_0072                 3.646360e-03 3 1  ON 71
ci_0073                 3.636094e-03 3 1  ON 72
ci_0074                 3.624532e-03 3 1  ON 73
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 4.3167e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s001 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s001 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=1  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6885e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 1
    time step          = 0.05
    reference energy   = -16.9832
    reference variance = 0.278072
====================================================
  Execution time = 1.4994e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s001
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5199e+04
  VMC Eavg = -1.6900e+01
  VMC Evar = 2.9362e-01
  Total weights = 1.951259962e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 2.6175e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.280965071268
                                         uncertainty =       0.001615290993

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.280965071268
                                         uncertainty =       0.001615290993

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000374793569
  error estimate for blocks of size 2^( 2) =       0.000392078616
  error estimate for blocks of size 2^( 3) =       0.000409443335
  error estimate for blocks of size 2^( 4) =       0.000424614563
  error estimate for blocks of size 2^( 5) =       0.000435294892
  error estimate for blocks of size 2^( 6) =       0.000442417002
  error estimate for blocks of size 2^( 7) =       0.000448372720

      target function =      -0.922695466483
              le_mean =     -16.899615960899
             les_mean =     285.890644197385
             stat err =       0.000437674794
             autocorr =       1.363699907777
   target nu stat err =       0.000437674794
   target dn stat err =       0.003006178989
      target stat err =       0.004760038974
              std dev =       0.530038148619
             le_variance =       0.280940438991


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.689961596090e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 74
Check correct_vf_var_size: 225, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.5000e-01, overlap shift 2.5000e+00 and omega -1.7444e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.922718664531       residual = 9.33e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.922847398958       residual = 1.07e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.922864959609       residual = 2.97e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.922871479819       residual = 2.44e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.922877528873       residual = 7.39e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.922878442422       residual = 1.17e-04           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.922879242274       residual = 6.58e-05           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.922880495094       residual = 5.85e-05           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.922883106730       residual = 4.92e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.922885215691       residual = 4.62e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.922886700598       residual = 2.17e-05           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.922886833812       residual = 5.75e-06           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.922887444258       residual = 2.05e-06           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.922887573952       residual = 6.45e-07           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.922887500687       residual = 2.93e-07           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.922887559227       residual = 5.77e-08           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.922887578996       residual = 2.26e-08           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.922887565691       residual = 6.23e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         17 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 2.5000e-01 is 1.714976e-03

solving harmonic davidson linear method for identity shift 1.0000e+00, overlap shift 1.0000e+01 and omega -1.7444e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.922718664531       residual = 9.33e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.922757832480       residual = 1.05e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.922762987496       residual = 2.71e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.922764795742       residual = 2.18e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.922766432836       residual = 6.64e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.922766641681       residual = 9.75e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.922766825280       residual = 5.16e-05           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.922767159456       residual = 4.78e-05           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.922767843182       residual = 3.92e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.922768315466       residual = 2.89e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.922768562317       residual = 1.03e-05           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.922768565757       residual = 2.63e-06           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.922768679348       residual = 8.81e-07           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.922768699578       residual = 2.54e-07           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.922768683325       residual = 1.09e-07           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.922768693732       residual = 1.94e-08           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.922768696692       residual = 6.94e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         16 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 1.0000e+00 is 4.296069e-04

solving harmonic davidson linear method for identity shift 4.0000e+00, overlap shift 4.0000e+01 and omega -1.7444e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.922718664531       residual = 9.33e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.922729018164       residual = 1.04e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.922730365291       residual = 2.63e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.922730829294       residual = 2.10e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.922731246262       residual = 6.42e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.922731296367       residual = 9.19e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.922731340783       residual = 4.79e-05           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.922731425913       residual = 4.50e-05           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.922731598417       residual = 3.64e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.922731710892       residual = 2.48e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.922731764402       residual = 8.22e-06           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.922731763932       residual = 2.07e-06           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.922731789920       residual = 6.82e-07           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.922731794284       residual = 1.92e-07           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.922731790418       residual = 8.06e-08           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.922731792770       residual = 1.39e-08           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.922731793397       residual = 4.85e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         16 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 4.0000e+00 is 1.074668e-04

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.159604 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 75 and numParams is: 74

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.7627e+01
  </log>
  <optVariables href="H2O.s001.opt.xml">
ci_0001                 7.083624e-01 3 1  ON 0
ci_0002                 6.929668e-01 3 1  ON 1
ci_0003                -3.111982e-02 3 1  ON 2
ci_0004                -3.021285e-02 3 1  ON 3
ci_0005                -3.055449e-02 3 1  ON 4
ci_0006                -3.070924e-02 3 1  ON 5
ci_0007                -1.356256e-02 3 1  ON 6
ci_0008                -1.345036e-02 3 1  ON 7
ci_0009                -1.880933e-02 3 1  ON 8
ci_0010                -1.811535e-02 3 1  ON 9
ci_0011                -1.471655e-02 3 1  ON 10
ci_0012                -1.460805e-02 3 1  ON 11
ci_0013                 1.530066e-02 3 1  ON 12
ci_0014                 1.482614e-02 3 1  ON 13
ci_0015                 1.590250e-02 3 1  ON 14
ci_0016                 1.546732e-02 3 1  ON 15
ci_0017                 1.343986e-02 3 1  ON 16
ci_0018                 1.318335e-02 3 1  ON 17
ci_0019                 1.302834e-02 3 1  ON 18
ci_0020                 1.260181e-02 3 1  ON 19
ci_0021                 7.480715e-03 3 1  ON 20
ci_0022                 8.100627e-03 3 1  ON 21
ci_0023                -1.179639e-02 3 1  ON 22
ci_0024                -1.133078e-02 3 1  ON 23
ci_0025                -1.984623e-03 3 1  ON 24
ci_0026                -2.707484e-03 3 1  ON 25
ci_0027                -1.207846e-02 3 1  ON 26
ci_0028                -1.155622e-02 3 1  ON 27
ci_0029                -1.056449e-02 3 1  ON 28
ci_0030                -1.053243e-02 3 1  ON 29
ci_0031                 1.349405e-02 3 1  ON 30
ci_0032                 1.220078e-02 3 1  ON 31
ci_0033                 7.979949e-03 3 1  ON 32
ci_0034                 8.442405e-03 3 1  ON 33
ci_0035                 4.954375e-03 3 1  ON 34
ci_0036                 5.008871e-03 3 1  ON 35
ci_0037                -1.132606e-02 3 1  ON 36
ci_0038                -1.147035e-02 3 1  ON 37
ci_0039                -4.022221e-03 3 1  ON 38
ci_0040                -3.998023e-03 3 1  ON 39
ci_0041                 9.001806e-03 3 1  ON 40
ci_0042                 8.684606e-03 3 1  ON 41
ci_0043                -1.259923e-02 3 1  ON 42
ci_0044                -1.329207e-02 3 1  ON 43
ci_0045                 1.061804e-02 3 1  ON 44
ci_0046                 1.011631e-02 3 1  ON 45
ci_0047                -3.639337e-03 3 1  ON 46
ci_0048                -3.466089e-03 3 1  ON 47
ci_0049                -2.544330e-03 3 1  ON 48
ci_0050                -2.730520e-03 3 1  ON 49
ci_0051                -1.774883e-03 3 1  ON 50
ci_0052                -2.106752e-03 3 1  ON 51
ci_0053                -3.936421e-03 3 1  ON 52
ci_0054                -3.293159e-03 3 1  ON 53
ci_0055                 2.681782e-03 3 1  ON 54
ci_0056                 2.268787e-03 3 1  ON 55
ci_0057                 2.554303e-03 3 1  ON 56
ci_0058                 3.095762e-03 3 1  ON 57
ci_0059                -3.371503e-03 3 1  ON 58
ci_0060                -3.208654e-03 3 1  ON 59
ci_0061                -3.940043e-03 3 1  ON 60
ci_0062                -3.932058e-03 3 1  ON 61
ci_0063                -9.983265e-03 3 1  ON 62
ci_0064                -9.391535e-03 3 1  ON 63
ci_0065                -6.424258e-03 3 1  ON 64
ci_0066                -6.209996e-03 3 1  ON 65
ci_0067                -3.660175e-03 3 1  ON 66
ci_0068                -3.436842e-03 3 1  ON 67
ci_0069                 3.763236e-03 3 1  ON 68
ci_0070                 3.439323e-03 3 1  ON 69
ci_0071                 2.964852e-03 3 1  ON 70
ci_0072                 3.569221e-03 3 1  ON 71
ci_0073                 3.587201e-03 3 1  ON 72
ci_0074                 3.565197e-03 3 1  ON 73
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 1
    time step          = 0.05
    reference energy   = -16.8288
    reference variance = 0.183426
====================================================
  Execution time = 1.4748e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s001
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6898e+01
  VMC Evar = 2.9436e-01
  Total weights = 1.9509e+06
  Execution time = 1.9198e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.281669285776
                                         uncertainty =       0.001654594397

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.281669285776
                                         uncertainty =       0.001654594397

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000375276533
  error estimate for blocks of size 2^( 2) =       0.000392733384
  error estimate for blocks of size 2^( 3) =       0.000410455046
  error estimate for blocks of size 2^( 4) =       0.000426531415
  error estimate for blocks of size 2^( 5) =       0.000439075469
  error estimate for blocks of size 2^( 6) =       0.000447315587
  error estimate for blocks of size 2^( 7) =       0.000453040850

      target function =      -0.867543480867
              le_mean =     -16.898250439647
             les_mean =     285.881086360173
             stat err =       0.000441490830
             autocorr =       1.384014243180
   target nu stat err =       0.000441490830
   target dn stat err =       0.025234142078
      target stat err =       0.034865633563
              std dev =       0.530721162605
             le_variance =       0.281664952437

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.281530536478
                                         uncertainty =       0.001647088825

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.281530536478
                                         uncertainty =       0.001647088825

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000375185613
  error estimate for blocks of size 2^( 2) =       0.000392665461
  error estimate for blocks of size 2^( 3) =       0.000410415561
  error estimate for blocks of size 2^( 4) =       0.000426506540
  error estimate for blocks of size 2^( 5) =       0.000439062565
  error estimate for blocks of size 2^( 6) =       0.000447299308
  error estimate for blocks of size 2^( 7) =       0.000453027241

      target function =      -0.921892027641
              le_mean =     -16.898250129021
             les_mean =     285.844987674558
             stat err =       0.000441473914
             autocorr =       1.384578997439
   target nu stat err =       0.000441473914
   target dn stat err =       0.003172026098
      target stat err =       0.004996220969
              std dev =       0.530592582863
             le_variance =       0.281528488989

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.281576548708
                                         uncertainty =       0.001650265163

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.281576548708
                                         uncertainty =       0.001650265163

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000375215522
  error estimate for blocks of size 2^( 2) =       0.000392686577
  error estimate for blocks of size 2^( 3) =       0.000410425024
  error estimate for blocks of size 2^( 4) =       0.000426510648
  error estimate for blocks of size 2^( 5) =       0.000439061987
  error estimate for blocks of size 2^( 6) =       0.000447300790
  error estimate for blocks of size 2^( 7) =       0.000453029785

      target function =      -0.921993268229
              le_mean =     -16.898248722231
             les_mean =     285.844874563958
             stat err =       0.000441475802
             autocorr =       1.384370119567
   target nu stat err =       0.000441475802
   target dn stat err =       0.003224898803
      target stat err =       0.005078754684
              std dev =       0.530634880196
             le_variance =       0.281573376081

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.281655211326
                                         uncertainty =       0.001654005801

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.281655211326
                                         uncertainty =       0.001654005801

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000375267255
  error estimate for blocks of size 2^( 2) =       0.000392726586
  error estimate for blocks of size 2^( 3) =       0.000410450397
  error estimate for blocks of size 2^( 4) =       0.000426527469
  error estimate for blocks of size 2^( 5) =       0.000439073693
  error estimate for blocks of size 2^( 6) =       0.000447314517
  error estimate for blocks of size 2^( 7) =       0.000453041644

      target function =      -0.920712194079
              le_mean =     -16.898249884966
             les_mean =     285.845735811649
             stat err =       0.000441489331
             autocorr =       1.384073282655
   target nu stat err =       0.000441489331
   target dn stat err =       0.003372331118
      target stat err =       0.005291477688
              std dev =       0.530708040997
             le_variance =       0.281651024779


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.867543480867        initial
     2.5000e-01     2.5000e+00             1.7150e-03        -0.921892027641
     1.0000e+00     1.0000e+01             4.2961e-04        -0.921993268229  <--
     4.0000e+00     4.0000e+01             1.0747e-04        -0.920712194079

*****************************************************************************
Applying the update for shift_i =   1.0000e+00     and shift_s =   1.0000e+01
*****************************************************************************

  Execution time = 2.4450e+01
  </log>
  <optVariables href="H2O.s001.opt.xml">
ci_0001                 7.083624e-01 3 1  ON 0
ci_0002                 6.929668e-01 3 1  ON 1
ci_0003                -3.111982e-02 3 1  ON 2
ci_0004                -3.021285e-02 3 1  ON 3
ci_0005                -3.055449e-02 3 1  ON 4
ci_0006                -3.070924e-02 3 1  ON 5
ci_0007                -1.356256e-02 3 1  ON 6
ci_0008                -1.345036e-02 3 1  ON 7
ci_0009                -1.880933e-02 3 1  ON 8
ci_0010                -1.811535e-02 3 1  ON 9
ci_0011                -1.471655e-02 3 1  ON 10
ci_0012                -1.460805e-02 3 1  ON 11
ci_0013                 1.530066e-02 3 1  ON 12
ci_0014                 1.482614e-02 3 1  ON 13
ci_0015                 1.590250e-02 3 1  ON 14
ci_0016                 1.546732e-02 3 1  ON 15
ci_0017                 1.343986e-02 3 1  ON 16
ci_0018                 1.318335e-02 3 1  ON 17
ci_0019                 1.302834e-02 3 1  ON 18
ci_0020                 1.260181e-02 3 1  ON 19
ci_0021                 7.480715e-03 3 1  ON 20
ci_0022                 8.100627e-03 3 1  ON 21
ci_0023                -1.179639e-02 3 1  ON 22
ci_0024                -1.133078e-02 3 1  ON 23
ci_0025                -1.984623e-03 3 1  ON 24
ci_0026                -2.707484e-03 3 1  ON 25
ci_0027                -1.207846e-02 3 1  ON 26
ci_0028                -1.155622e-02 3 1  ON 27
ci_0029                -1.056449e-02 3 1  ON 28
ci_0030                -1.053243e-02 3 1  ON 29
ci_0031                 1.349405e-02 3 1  ON 30
ci_0032                 1.220078e-02 3 1  ON 31
ci_0033                 7.979949e-03 3 1  ON 32
ci_0034                 8.442405e-03 3 1  ON 33
ci_0035                 4.954375e-03 3 1  ON 34
ci_0036                 5.008871e-03 3 1  ON 35
ci_0037                -1.132606e-02 3 1  ON 36
ci_0038                -1.147035e-02 3 1  ON 37
ci_0039                -4.022221e-03 3 1  ON 38
ci_0040                -3.998023e-03 3 1  ON 39
ci_0041                 9.001806e-03 3 1  ON 40
ci_0042                 8.684606e-03 3 1  ON 41
ci_0043                -1.259923e-02 3 1  ON 42
ci_0044                -1.329207e-02 3 1  ON 43
ci_0045                 1.061804e-02 3 1  ON 44
ci_0046                 1.011631e-02 3 1  ON 45
ci_0047                -3.639337e-03 3 1  ON 46
ci_0048                -3.466089e-03 3 1  ON 47
ci_0049                -2.544330e-03 3 1  ON 48
ci_0050                -2.730520e-03 3 1  ON 49
ci_0051                -1.774883e-03 3 1  ON 50
ci_0052                -2.106752e-03 3 1  ON 51
ci_0053                -3.936421e-03 3 1  ON 52
ci_0054                -3.293159e-03 3 1  ON 53
ci_0055                 2.681782e-03 3 1  ON 54
ci_0056                 2.268787e-03 3 1  ON 55
ci_0057                 2.554303e-03 3 1  ON 56
ci_0058                 3.095762e-03 3 1  ON 57
ci_0059                -3.371503e-03 3 1  ON 58
ci_0060                -3.208654e-03 3 1  ON 59
ci_0061                -3.940043e-03 3 1  ON 60
ci_0062                -3.932058e-03 3 1  ON 61
ci_0063                -9.983265e-03 3 1  ON 62
ci_0064                -9.391535e-03 3 1  ON 63
ci_0065                -6.424258e-03 3 1  ON 64
ci_0066                -6.209996e-03 3 1  ON 65
ci_0067                -3.660175e-03 3 1  ON 66
ci_0068                -3.436842e-03 3 1  ON 67
ci_0069                 3.763236e-03 3 1  ON 68
ci_0070                 3.439323e-03 3 1  ON 69
ci_0071                 2.964852e-03 3 1  ON 70
ci_0072                 3.569221e-03 3 1  ON 71
ci_0073                 3.587201e-03 3 1  ON 72
ci_0074                 3.565197e-03 3 1  ON 73
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 4.2086e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s002 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s002 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=2  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6895e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 2
    time step          = 0.05
    reference energy   = -16.8436
    reference variance = 0.2829
====================================================
  Execution time = 1.4978e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s002
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5234e+04
  VMC Eavg = -1.6898e+01
  VMC Evar = 2.9714e-01
  Total weights = 1.950959450e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 2.6276e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.286640019612
                                         uncertainty =       0.007215223930

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.286640019612
                                         uncertainty =       0.007215223930

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000378533233
  error estimate for blocks of size 2^( 2) =       0.000395240440
  error estimate for blocks of size 2^( 3) =       0.000412665912
  error estimate for blocks of size 2^( 4) =       0.000428034443
  error estimate for blocks of size 2^( 5) =       0.000439840566
  error estimate for blocks of size 2^( 6) =       0.000447668814
  error estimate for blocks of size 2^( 7) =       0.000452326330

      target function =      -0.917097450886
              le_mean =     -16.898417096377
             les_mean =     285.853644536792
             stat err =       0.000441967538
             autocorr =       1.363241245953
   target nu stat err =       0.000441967538
   target dn stat err =       0.007588729916
      target stat err =       0.011725114360
              std dev =       0.535326831339
             le_variance =       0.286574816351


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.689841709638e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 74
Check correct_vf_var_size: 225, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.5000e-01, overlap shift 2.5000e+00 and omega -1.7444e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.917246900659       residual = 4.69e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.917982700889       residual = 4.26e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.918127361741       residual = 1.80e-03           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.918185849035       residual = 6.26e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.918202088874       residual = 4.04e-04           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.918213821236       residual = 1.71e-04           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.918212201857       residual = 8.86e-05           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.918213137325       residual = 1.04e-04           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.918210181345       residual = 8.48e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.918207257177       residual = 8.21e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.918209571882       residual = 4.63e-05           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.918213590819       residual = 2.99e-05           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.918215448567       residual = 1.31e-05           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.918216202900       residual = 5.12e-06           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.918215220754       residual = 1.64e-06           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.918214024595       residual = 5.59e-07           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.918213691240       residual = 1.43e-07           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.918213444090       residual = 2.93e-08           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.918213363167       residual = 1.35e-08           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.918213321343       residual = 5.54e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         19 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 2.5000e-01 is 1.995315e-03

solving harmonic davidson linear method for identity shift 1.0000e+00, overlap shift 1.0000e+01 and omega -1.7444e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.917246900659       residual = 4.69e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.917468490603       residual = 4.05e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.917508498850       residual = 1.60e-03           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.917524030132       residual = 5.72e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.917528185044       residual = 3.54e-04           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.917530764766       residual = 1.47e-04           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.917529920434       residual = 7.45e-05           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.917530109565       residual = 9.34e-05           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.917529215869       residual = 7.61e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.917528506593       residual = 6.49e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.917529359419       residual = 2.97e-05           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.917530246609       residual = 1.44e-05           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.917530583200       residual = 5.93e-06           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.917530670954       residual = 2.21e-06           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.917530435893       residual = 5.92e-07           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.917530213387       residual = 1.71e-07           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.917530159033       residual = 4.01e-08           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.917530121836       residual = 9.68e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         17 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 1.0000e+00 is 5.096100e-04

solving harmonic davidson linear method for identity shift 4.0000e+00, overlap shift 4.0000e+01 and omega -1.7444e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.917246900659       residual = 4.69e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.917305282084       residual = 3.99e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.917315535935       residual = 1.54e-03           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.917319468523       residual = 5.57e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.917320505839       residual = 3.40e-04           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.917321112674       residual = 1.41e-04           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.917320866684       residual = 7.06e-05           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.917320912638       residual = 9.05e-05           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.917320681042       residual = 7.35e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.917320512108       residual = 5.96e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.917320743669       residual = 2.55e-05           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.917320952261       residual = 1.15e-05           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.917321027573       residual = 4.67e-06           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.917321043129       residual = 1.70e-06           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.917320986519       residual = 4.31e-07           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.917320936284       residual = 1.18e-07           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.917320924407       residual = 2.74e-08           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.917320916494       residual = 6.98e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         17 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 4.0000e+00 is 1.282540e-04

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.171655 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 75 and numParams is: 74

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.7623e+01
  </log>
  <optVariables href="H2O.s002.opt.xml">
ci_0001                 7.078600e-01 3 1  ON 0
ci_0002                 6.934764e-01 3 1  ON 1
ci_0003                -3.108870e-02 3 1  ON 2
ci_0004                -3.019971e-02 3 1  ON 3
ci_0005                -3.046062e-02 3 1  ON 4
ci_0006                -3.116515e-02 3 1  ON 5
ci_0007                -1.356565e-02 3 1  ON 6
ci_0008                -1.310189e-02 3 1  ON 7
ci_0009                -1.874755e-02 3 1  ON 8
ci_0010                -1.807328e-02 3 1  ON 9
ci_0011                -1.485820e-02 3 1  ON 10
ci_0012                -1.439385e-02 3 1  ON 11
ci_0013                 1.537564e-02 3 1  ON 12
ci_0014                 1.485973e-02 3 1  ON 13
ci_0015                 1.585788e-02 3 1  ON 14
ci_0016                 1.545849e-02 3 1  ON 15
ci_0017                 1.344520e-02 3 1  ON 16
ci_0018                 1.311395e-02 3 1  ON 17
ci_0019                 1.299673e-02 3 1  ON 18
ci_0020                 1.282387e-02 3 1  ON 19
ci_0021                 7.275796e-03 3 1  ON 20
ci_0022                 8.165824e-03 3 1  ON 21
ci_0023                -1.165936e-02 3 1  ON 22
ci_0024                -1.122870e-02 3 1  ON 23
ci_0025                -1.835379e-03 3 1  ON 24
ci_0026                -2.706996e-03 3 1  ON 25
ci_0027                -1.196877e-02 3 1  ON 26
ci_0028                -1.160060e-02 3 1  ON 27
ci_0029                -1.057687e-02 3 1  ON 28
ci_0030                -1.059911e-02 3 1  ON 29
ci_0031                 1.357150e-02 3 1  ON 30
ci_0032                 1.244206e-02 3 1  ON 31
ci_0033                 7.994460e-03 3 1  ON 32
ci_0034                 8.540258e-03 3 1  ON 33
ci_0035                 4.804390e-03 3 1  ON 34
ci_0036                 5.087049e-03 3 1  ON 35
ci_0037                -1.130354e-02 3 1  ON 36
ci_0038                -1.146016e-02 3 1  ON 37
ci_0039                -3.978934e-03 3 1  ON 38
ci_0040                -4.142304e-03 3 1  ON 39
ci_0041                 9.032562e-03 3 1  ON 40
ci_0042                 8.646258e-03 3 1  ON 41
ci_0043                -1.261371e-02 3 1  ON 42
ci_0044                -1.337830e-02 3 1  ON 43
ci_0045                 1.029324e-02 3 1  ON 44
ci_0046                 1.013128e-02 3 1  ON 45
ci_0047                -3.636117e-03 3 1  ON 46
ci_0048                -3.812133e-03 3 1  ON 47
ci_0049                -2.651191e-03 3 1  ON 48
ci_0050                -2.770092e-03 3 1  ON 49
ci_0051                -1.746013e-03 3 1  ON 50
ci_0052                -2.093602e-03 3 1  ON 51
ci_0053                -3.950680e-03 3 1  ON 52
ci_0054                -3.334643e-03 3 1  ON 53
ci_0055                 2.645204e-03 3 1  ON 54
ci_0056                 2.373179e-03 3 1  ON 55
ci_0057                 2.525492e-03 3 1  ON 56
ci_0058                 3.118571e-03 3 1  ON 57
ci_0059                -3.372923e-03 3 1  ON 58
ci_0060                -3.255501e-03 3 1  ON 59
ci_0061                -3.803474e-03 3 1  ON 60
ci_0062                -3.947740e-03 3 1  ON 61
ci_0063                -9.857614e-03 3 1  ON 62
ci_0064                -9.487538e-03 3 1  ON 63
ci_0065                -6.323002e-03 3 1  ON 64
ci_0066                -6.208685e-03 3 1  ON 65
ci_0067                -3.633065e-03 3 1  ON 66
ci_0068                -3.315768e-03 3 1  ON 67
ci_0069                 3.705885e-03 3 1  ON 68
ci_0070                 3.429154e-03 3 1  ON 69
ci_0071                 2.926332e-03 3 1  ON 70
ci_0072                 3.640482e-03 3 1  ON 71
ci_0073                 3.582896e-03 3 1  ON 72
ci_0074                 3.519965e-03 3 1  ON 73
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 2
    time step          = 0.05
    reference energy   = -16.9297
    reference variance = 0.255266
====================================================
  Execution time = 1.4864e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s002
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6898e+01
  VMC Evar = 2.9430e-01
  Total weights = 1.9510e+06
  Execution time = 1.9324e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.284070869995
                                         uncertainty =       0.001845676069

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.284070869995
                                         uncertainty =       0.001845676069

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000376842297
  error estimate for blocks of size 2^( 2) =       0.000393973665
  error estimate for blocks of size 2^( 3) =       0.000411261802
  error estimate for blocks of size 2^( 4) =       0.000426699116
  error estimate for blocks of size 2^( 5) =       0.000438949026
  error estimate for blocks of size 2^( 6) =       0.000446231863
  error estimate for blocks of size 2^( 7) =       0.000449984430

      target function =      -0.920978604479
              le_mean =     -16.897742048485
             les_mean =     285.828406210790
             stat err =       0.000440466109
             autocorr =       1.366173041782
   target nu stat err =       0.000440466109
   target dn stat err =       0.002534112343
      target stat err =       0.004004678693
              std dev =       0.532935486743
             le_variance =       0.284020233030

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.283947765465
                                         uncertainty =       0.001839699464

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.283947765465
                                         uncertainty =       0.001839699464

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000376761168
  error estimate for blocks of size 2^( 2) =       0.000393901823
  error estimate for blocks of size 2^( 3) =       0.000411192638
  error estimate for blocks of size 2^( 4) =       0.000426629771
  error estimate for blocks of size 2^( 5) =       0.000438868058
  error estimate for blocks of size 2^( 6) =       0.000446126475
  error estimate for blocks of size 2^( 7) =       0.000449841117

      target function =      -0.906472581561
              le_mean =     -16.897751927076
             les_mean =     285.838122870551
             stat err =       0.000440366355
             autocorr =       1.366142472119
   target nu stat err =       0.000440366355
   target dn stat err =       0.008463356256
      target stat err =       0.012755417709
              std dev =       0.532820752904
             le_variance =       0.283897954726

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.283960275405
                                         uncertainty =       0.001842989720

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.283960275405
                                         uncertainty =       0.001842989720

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000376769232
  error estimate for blocks of size 2^( 2) =       0.000393905245
  error estimate for blocks of size 2^( 3) =       0.000411191093
  error estimate for blocks of size 2^( 4) =       0.000426625437
  error estimate for blocks of size 2^( 5) =       0.000438870511
  error estimate for blocks of size 2^( 6) =       0.000446146610
  error estimate for blocks of size 2^( 7) =       0.000449876847

      target function =      -0.705847771612
              le_mean =     -16.897744067087
             les_mean =     285.979281728672
             stat err =       0.000440379851
             autocorr =       1.366167727528
   target nu stat err =       0.000440379851
   target dn stat err =       0.149364398286
      target stat err =       0.141729586552
              std dev =       0.532832157303
             le_variance =       0.283910107856

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.284049070590
                                         uncertainty =       0.001845133130

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.284049070590
                                         uncertainty =       0.001845133130

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000376827879
  error estimate for blocks of size 2^( 2) =       0.000393960025
  error estimate for blocks of size 2^( 3) =       0.000411248138
  error estimate for blocks of size 2^( 4) =       0.000426685508
  error estimate for blocks of size 2^( 5) =       0.000438935233
  error estimate for blocks of size 2^( 6) =       0.000446216478
  error estimate for blocks of size 2^( 7) =       0.000449966558

      target function =      -0.920084046952
              le_mean =     -16.897741105555
             les_mean =     285.828950158771
             stat err =       0.000440450944
             autocorr =       1.366183511672
   target nu stat err =       0.000440450944
   target dn stat err =       0.002629105403
      target stat err =       0.004141789550
              std dev =       0.532915096564
             le_variance =       0.283998500146


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.920978604479        initial  <--
     2.5000e-01     2.5000e+00             1.9953e-03        -0.906472581561
     1.0000e+00     1.0000e+01             5.0961e-04        -0.705847771612
     4.0000e+00     4.0000e+01             1.2825e-04        -0.920084046952

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 24.6153
  </log>
  <optVariables href="H2O.s002.opt.xml">
ci_0001                 7.083624e-01 3 1  ON 0
ci_0002                 6.929668e-01 3 1  ON 1
ci_0003                -3.111982e-02 3 1  ON 2
ci_0004                -3.021285e-02 3 1  ON 3
ci_0005                -3.055449e-02 3 1  ON 4
ci_0006                -3.070924e-02 3 1  ON 5
ci_0007                -1.356256e-02 3 1  ON 6
ci_0008                -1.345036e-02 3 1  ON 7
ci_0009                -1.880933e-02 3 1  ON 8
ci_0010                -1.811535e-02 3 1  ON 9
ci_0011                -1.471655e-02 3 1  ON 10
ci_0012                -1.460805e-02 3 1  ON 11
ci_0013                 1.530066e-02 3 1  ON 12
ci_0014                 1.482614e-02 3 1  ON 13
ci_0015                 1.590250e-02 3 1  ON 14
ci_0016                 1.546732e-02 3 1  ON 15
ci_0017                 1.343986e-02 3 1  ON 16
ci_0018                 1.318335e-02 3 1  ON 17
ci_0019                 1.302834e-02 3 1  ON 18
ci_0020                 1.260181e-02 3 1  ON 19
ci_0021                 7.480715e-03 3 1  ON 20
ci_0022                 8.100627e-03 3 1  ON 21
ci_0023                -1.179639e-02 3 1  ON 22
ci_0024                -1.133078e-02 3 1  ON 23
ci_0025                -1.984623e-03 3 1  ON 24
ci_0026                -2.707484e-03 3 1  ON 25
ci_0027                -1.207846e-02 3 1  ON 26
ci_0028                -1.155622e-02 3 1  ON 27
ci_0029                -1.056449e-02 3 1  ON 28
ci_0030                -1.053243e-02 3 1  ON 29
ci_0031                 1.349405e-02 3 1  ON 30
ci_0032                 1.220078e-02 3 1  ON 31
ci_0033                 7.979949e-03 3 1  ON 32
ci_0034                 8.442405e-03 3 1  ON 33
ci_0035                 4.954375e-03 3 1  ON 34
ci_0036                 5.008871e-03 3 1  ON 35
ci_0037                -1.132606e-02 3 1  ON 36
ci_0038                -1.147035e-02 3 1  ON 37
ci_0039                -4.022221e-03 3 1  ON 38
ci_0040                -3.998023e-03 3 1  ON 39
ci_0041                 9.001806e-03 3 1  ON 40
ci_0042                 8.684606e-03 3 1  ON 41
ci_0043                -1.259923e-02 3 1  ON 42
ci_0044                -1.329207e-02 3 1  ON 43
ci_0045                 1.061804e-02 3 1  ON 44
ci_0046                 1.011631e-02 3 1  ON 45
ci_0047                -3.639337e-03 3 1  ON 46
ci_0048                -3.466089e-03 3 1  ON 47
ci_0049                -2.544330e-03 3 1  ON 48
ci_0050                -2.730520e-03 3 1  ON 49
ci_0051                -1.774883e-03 3 1  ON 50
ci_0052                -2.106752e-03 3 1  ON 51
ci_0053                -3.936421e-03 3 1  ON 52
ci_0054                -3.293159e-03 3 1  ON 53
ci_0055                 2.681782e-03 3 1  ON 54
ci_0056                 2.268787e-03 3 1  ON 55
ci_0057                 2.554303e-03 3 1  ON 56
ci_0058                 3.095762e-03 3 1  ON 57
ci_0059                -3.371503e-03 3 1  ON 58
ci_0060                -3.208654e-03 3 1  ON 59
ci_0061                -3.940043e-03 3 1  ON 60
ci_0062                -3.932058e-03 3 1  ON 61
ci_0063                -9.983265e-03 3 1  ON 62
ci_0064                -9.391535e-03 3 1  ON 63
ci_0065                -6.424258e-03 3 1  ON 64
ci_0066                -6.209996e-03 3 1  ON 65
ci_0067                -3.660175e-03 3 1  ON 66
ci_0068                -3.436842e-03 3 1  ON 67
ci_0069                 3.763236e-03 3 1  ON 68
ci_0070                 3.439323e-03 3 1  ON 69
ci_0071                 2.964852e-03 3 1  ON 70
ci_0072                 3.569221e-03 3 1  ON 71
ci_0073                 3.587201e-03 3 1  ON 72
ci_0074                 3.565197e-03 3 1  ON 73
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 4.2244e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s003 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s003 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=3  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6892e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 3
    time step          = 0.05
    reference energy   = -16.8269
    reference variance = 0.164431
====================================================
  Execution time = 1.4805e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s003
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5260e+04
  VMC Eavg = -1.6899e+01
  VMC Evar = 2.9184e-01
  Total weights = 1.950871387e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 2.6140e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.283320932529
                                         uncertainty =       0.001727015218

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.283320932529
                                         uncertainty =       0.001727015218

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000376333410
  error estimate for blocks of size 2^( 2) =       0.000393201674
  error estimate for blocks of size 2^( 3) =       0.000410397005
  error estimate for blocks of size 2^( 4) =       0.000424965431
  error estimate for blocks of size 2^( 5) =       0.000437261650
  error estimate for blocks of size 2^( 6) =       0.000445551245
  error estimate for blocks of size 2^( 7) =       0.000448548923

      target function =      -0.925497851482
              le_mean =     -16.898821642711
             les_mean =     285.862011937849
             stat err =       0.000439081812
             autocorr =       1.361273356596
   target nu stat err =       0.000439081812
   target dn stat err =       0.002093051828
      target stat err =       0.003372173490
              std dev =       0.532215812495
             le_variance =       0.283253671070


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.689882164271e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 74
Check correct_vf_var_size: 225, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.5000e+00, overlap shift 2.5000e+01 and omega -1.7444e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.925508692838       residual = 5.66e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.925518242447       residual = 9.16e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.925519783696       residual = 3.65e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.925520786712       residual = 1.25e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.925521191880       residual = 5.26e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.925521373874       residual = 2.97e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.925521446390       residual = 6.58e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.925521440819       residual = 1.20e-06           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.925521433884       residual = 5.77e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.925521442403       residual = 5.35e-07           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.925521460825       residual = 4.27e-07           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.925521473757       residual = 2.75e-07           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.925521466092       residual = 2.58e-07           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.925521470895       residual = 1.38e-07           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.925521472947       residual = 5.67e-08           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.925521473612       residual = 2.17e-08           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.925521473866       residual = 4.91e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         16 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 2.5000e+00 is 8.869184e-05

solving harmonic davidson linear method for identity shift 1.0000e+01, overlap shift 1.0000e+02 and omega -1.7444e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.925508692838       residual = 5.66e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.925511135649       residual = 9.12e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.925511527971       residual = 3.60e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.925511781647       residual = 1.23e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.925511883373       residual = 5.14e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.925511928734       residual = 2.86e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.925511946574       residual = 6.30e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.925511945125       residual = 1.15e-06           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.925511943413       residual = 5.57e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.925511945590       residual = 5.19e-07           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.925511950194       residual = 4.09e-07           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.925511953369       residual = 2.63e-07           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.925511951417       residual = 2.42e-07           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.925511952599       residual = 1.25e-07           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.925511953090       residual = 5.05e-08           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.925511953238       residual = 1.91e-08           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.925511953292       residual = 4.27e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         16 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 1.0000e+01 is 2.244559e-05

solving harmonic davidson linear method for identity shift 4.0000e+01, overlap shift 4.0000e+02 and omega -1.7444e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.925508692838       residual = 5.66e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.925509307105       residual = 9.11e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.925509405633       residual = 3.59e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.925509469236       residual = 1.22e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.925509494693       residual = 5.10e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.925509506024       residual = 2.83e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.925509510465       residual = 6.23e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.925509510099       residual = 1.14e-06           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.925509509673       residual = 5.52e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.925509510220       residual = 5.15e-07           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.925509511371       residual = 4.05e-07           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.925509512161       residual = 2.60e-07           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.925509511671       residual = 2.39e-07           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.925509511965       residual = 1.22e-07           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.925509512086       residual = 4.91e-08           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.925509512122       residual = 1.85e-08           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.925509512135       residual = 4.12e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         16 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 4.0000e+01 is 5.628703e-06

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.180870 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 75 and numParams is: 74

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.7433e+01
  </log>
  <optVariables href="H2O.s003.opt.xml">
ci_0001                 7.083579e-01 3 1  ON 0
ci_0002                 6.929719e-01 3 1  ON 1
ci_0003                -3.111823e-02 3 1  ON 2
ci_0004                -3.020805e-02 3 1  ON 3
ci_0005                -3.055494e-02 3 1  ON 4
ci_0006                -3.070157e-02 3 1  ON 5
ci_0007                -1.355762e-02 3 1  ON 6
ci_0008                -1.345322e-02 3 1  ON 7
ci_0009                -1.880255e-02 3 1  ON 8
ci_0010                -1.812225e-02 3 1  ON 9
ci_0011                -1.471356e-02 3 1  ON 10
ci_0012                -1.460502e-02 3 1  ON 11
ci_0013                 1.529618e-02 3 1  ON 12
ci_0014                 1.482682e-02 3 1  ON 13
ci_0015                 1.589929e-02 3 1  ON 14
ci_0016                 1.547003e-02 3 1  ON 15
ci_0017                 1.344158e-02 3 1  ON 16
ci_0018                 1.318253e-02 3 1  ON 17
ci_0019                 1.302057e-02 3 1  ON 18
ci_0020                 1.260425e-02 3 1  ON 19
ci_0021                 7.476324e-03 3 1  ON 20
ci_0022                 8.094532e-03 3 1  ON 21
ci_0023                -1.179513e-02 3 1  ON 22
ci_0024                -1.133679e-02 3 1  ON 23
ci_0025                -1.985943e-03 3 1  ON 24
ci_0026                -2.707483e-03 3 1  ON 25
ci_0027                -1.207443e-02 3 1  ON 26
ci_0028                -1.155006e-02 3 1  ON 27
ci_0029                -1.057114e-02 3 1  ON 28
ci_0030                -1.053519e-02 3 1  ON 29
ci_0031                 1.349581e-02 3 1  ON 30
ci_0032                 1.220310e-02 3 1  ON 31
ci_0033                 7.989641e-03 3 1  ON 32
ci_0034                 8.432670e-03 3 1  ON 33
ci_0035                 4.950249e-03 3 1  ON 34
ci_0036                 5.009252e-03 3 1  ON 35
ci_0037                -1.132450e-02 3 1  ON 36
ci_0038                -1.146858e-02 3 1  ON 37
ci_0039                -4.021466e-03 3 1  ON 38
ci_0040                -3.994512e-03 3 1  ON 39
ci_0041                 8.998970e-03 3 1  ON 40
ci_0042                 8.686655e-03 3 1  ON 41
ci_0043                -1.260992e-02 3 1  ON 42
ci_0044                -1.331452e-02 3 1  ON 43
ci_0045                 1.061678e-02 3 1  ON 44
ci_0046                 1.011849e-02 3 1  ON 45
ci_0047                -3.640596e-03 3 1  ON 46
ci_0048                -3.465988e-03 3 1  ON 47
ci_0049                -2.552826e-03 3 1  ON 48
ci_0050                -2.729513e-03 3 1  ON 49
ci_0051                -1.771244e-03 3 1  ON 50
ci_0052                -2.103472e-03 3 1  ON 51
ci_0053                -3.940020e-03 3 1  ON 52
ci_0054                -3.297421e-03 3 1  ON 53
ci_0055                 2.685372e-03 3 1  ON 54
ci_0056                 2.276206e-03 3 1  ON 55
ci_0057                 2.546452e-03 3 1  ON 56
ci_0058                 3.092107e-03 3 1  ON 57
ci_0059                -3.368884e-03 3 1  ON 58
ci_0060                -3.213690e-03 3 1  ON 59
ci_0061                -3.934796e-03 3 1  ON 60
ci_0062                -3.935452e-03 3 1  ON 61
ci_0063                -9.981520e-03 3 1  ON 62
ci_0064                -9.392425e-03 3 1  ON 63
ci_0065                -6.423752e-03 3 1  ON 64
ci_0066                -6.214812e-03 3 1  ON 65
ci_0067                -3.663276e-03 3 1  ON 66
ci_0068                -3.439046e-03 3 1  ON 67
ci_0069                 3.754801e-03 3 1  ON 68
ci_0070                 3.437192e-03 3 1  ON 69
ci_0071                 2.969487e-03 3 1  ON 70
ci_0072                 3.571394e-03 3 1  ON 71
ci_0073                 3.579541e-03 3 1  ON 72
ci_0074                 3.562947e-03 3 1  ON 73
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 3
    time step          = 0.05
    reference energy   = -16.8606
    reference variance = 0.234706
====================================================
  Execution time = 1.4198e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s003
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6899e+01
  VMC Evar = 2.9339e-01
  Total weights = 1.9509e+06
  Execution time = 1.8848e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.281697343533
                                         uncertainty =       0.001622756563

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.281697343533
                                         uncertainty =       0.001622756563

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000375311961
  error estimate for blocks of size 2^( 2) =       0.000392178202
  error estimate for blocks of size 2^( 3) =       0.000409140075
  error estimate for blocks of size 2^( 4) =       0.000424325808
  error estimate for blocks of size 2^( 5) =       0.000436494489
  error estimate for blocks of size 2^( 6) =       0.000445096344
  error estimate for blocks of size 2^( 7) =       0.000448527489

      target function =      -0.923057866263
              le_mean =     -16.898828810743
             les_mean =     285.863805935945
             stat err =       0.000438611033
             autocorr =       1.365759696219
   target nu stat err =       0.000438611033
   target dn stat err =       0.002731760381
      target stat err =       0.004333933800
              std dev =       0.530771265218
             le_variance =       0.281718135981

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.281690064723
                                         uncertainty =       0.001622936505

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.281690064723
                                         uncertainty =       0.001622936505

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000375307148
  error estimate for blocks of size 2^( 2) =       0.000392173195
  error estimate for blocks of size 2^( 3) =       0.000409135066
  error estimate for blocks of size 2^( 4) =       0.000424320578
  error estimate for blocks of size 2^( 5) =       0.000436488227
  error estimate for blocks of size 2^( 6) =       0.000445089737
  error estimate for blocks of size 2^( 7) =       0.000448521155

      target function =      -0.923016123689
              le_mean =     -16.898828434721
             les_mean =     285.863819925843
             stat err =       0.000438604924
             autocorr =       1.365756680400
   target nu stat err =       0.000438604924
   target dn stat err =       0.002732507157
      target stat err =       0.004334692733
              std dev =       0.530764459335
             le_variance =       0.281710911293

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.281693548225
                                         uncertainty =       0.001622845707

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.281693548225
                                         uncertainty =       0.001622845707

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000375309451
  error estimate for blocks of size 2^( 2) =       0.000392175598
  error estimate for blocks of size 2^( 3) =       0.000409137477
  error estimate for blocks of size 2^( 4) =       0.000424323104
  error estimate for blocks of size 2^( 5) =       0.000436491264
  error estimate for blocks of size 2^( 6) =       0.000445092942
  error estimate for blocks of size 2^( 7) =       0.000448524225

      target function =      -0.923044484550
              le_mean =     -16.898828605118
             les_mean =     285.863807544286
             stat err =       0.000438607884
             autocorr =       1.365758351647
   target nu stat err =       0.000438607884
   target dn stat err =       0.002732002882
      target stat err =       0.004334180872
              std dev =       0.530767715873
             le_variance =       0.281714368213

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.281696856727
                                         uncertainty =       0.001622767527

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.281696856727
                                         uncertainty =       0.001622767527

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000375311639
  error estimate for blocks of size 2^( 2) =       0.000392177868
  error estimate for blocks of size 2^( 3) =       0.000409139742
  error estimate for blocks of size 2^( 4) =       0.000424325462
  error estimate for blocks of size 2^( 5) =       0.000436494078
  error estimate for blocks of size 2^( 6) =       0.000445095911
  error estimate for blocks of size 2^( 7) =       0.000448527073

      target function =      -0.923057365840
              le_mean =     -16.898828783301
             les_mean =     285.863805328270
             stat err =       0.000438610631
             autocorr =       1.365759536591
   target nu stat err =       0.000438610631
   target dn stat err =       0.002731776558
      target stat err =       0.004333953747
              std dev =       0.530770809896
             le_variance =       0.281717652638


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.923057866263        initial  <--
     2.5000e+00     2.5000e+01             8.8692e-05        -0.923016123689
     1.0000e+01     1.0000e+02             2.2446e-05        -0.923044484550
     4.0000e+01     4.0000e+02             5.6287e-06        -0.923057365840

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 23.6905
  </log>
  <optVariables href="H2O.s003.opt.xml">
ci_0001                 7.083624e-01 3 1  ON 0
ci_0002                 6.929668e-01 3 1  ON 1
ci_0003                -3.111982e-02 3 1  ON 2
ci_0004                -3.021285e-02 3 1  ON 3
ci_0005                -3.055449e-02 3 1  ON 4
ci_0006                -3.070924e-02 3 1  ON 5
ci_0007                -1.356256e-02 3 1  ON 6
ci_0008                -1.345036e-02 3 1  ON 7
ci_0009                -1.880933e-02 3 1  ON 8
ci_0010                -1.811535e-02 3 1  ON 9
ci_0011                -1.471655e-02 3 1  ON 10
ci_0012                -1.460805e-02 3 1  ON 11
ci_0013                 1.530066e-02 3 1  ON 12
ci_0014                 1.482614e-02 3 1  ON 13
ci_0015                 1.590250e-02 3 1  ON 14
ci_0016                 1.546732e-02 3 1  ON 15
ci_0017                 1.343986e-02 3 1  ON 16
ci_0018                 1.318335e-02 3 1  ON 17
ci_0019                 1.302834e-02 3 1  ON 18
ci_0020                 1.260181e-02 3 1  ON 19
ci_0021                 7.480715e-03 3 1  ON 20
ci_0022                 8.100627e-03 3 1  ON 21
ci_0023                -1.179639e-02 3 1  ON 22
ci_0024                -1.133078e-02 3 1  ON 23
ci_0025                -1.984623e-03 3 1  ON 24
ci_0026                -2.707484e-03 3 1  ON 25
ci_0027                -1.207846e-02 3 1  ON 26
ci_0028                -1.155622e-02 3 1  ON 27
ci_0029                -1.056449e-02 3 1  ON 28
ci_0030                -1.053243e-02 3 1  ON 29
ci_0031                 1.349405e-02 3 1  ON 30
ci_0032                 1.220078e-02 3 1  ON 31
ci_0033                 7.979949e-03 3 1  ON 32
ci_0034                 8.442405e-03 3 1  ON 33
ci_0035                 4.954375e-03 3 1  ON 34
ci_0036                 5.008871e-03 3 1  ON 35
ci_0037                -1.132606e-02 3 1  ON 36
ci_0038                -1.147035e-02 3 1  ON 37
ci_0039                -4.022221e-03 3 1  ON 38
ci_0040                -3.998023e-03 3 1  ON 39
ci_0041                 9.001806e-03 3 1  ON 40
ci_0042                 8.684606e-03 3 1  ON 41
ci_0043                -1.259923e-02 3 1  ON 42
ci_0044                -1.329207e-02 3 1  ON 43
ci_0045                 1.061804e-02 3 1  ON 44
ci_0046                 1.011631e-02 3 1  ON 45
ci_0047                -3.639337e-03 3 1  ON 46
ci_0048                -3.466089e-03 3 1  ON 47
ci_0049                -2.544330e-03 3 1  ON 48
ci_0050                -2.730520e-03 3 1  ON 49
ci_0051                -1.774883e-03 3 1  ON 50
ci_0052                -2.106752e-03 3 1  ON 51
ci_0053                -3.936421e-03 3 1  ON 52
ci_0054                -3.293159e-03 3 1  ON 53
ci_0055                 2.681782e-03 3 1  ON 54
ci_0056                 2.268787e-03 3 1  ON 55
ci_0057                 2.554303e-03 3 1  ON 56
ci_0058                 3.095762e-03 3 1  ON 57
ci_0059                -3.371503e-03 3 1  ON 58
ci_0060                -3.208654e-03 3 1  ON 59
ci_0061                -3.940043e-03 3 1  ON 60
ci_0062                -3.932058e-03 3 1  ON 61
ci_0063                -9.983265e-03 3 1  ON 62
ci_0064                -9.391535e-03 3 1  ON 63
ci_0065                -6.424258e-03 3 1  ON 64
ci_0066                -6.209996e-03 3 1  ON 65
ci_0067                -3.660175e-03 3 1  ON 66
ci_0068                -3.436842e-03 3 1  ON 67
ci_0069                 3.763236e-03 3 1  ON 68
ci_0070                 3.439323e-03 3 1  ON 69
ci_0071                 2.964852e-03 3 1  ON 70
ci_0072                 3.569221e-03 3 1  ON 71
ci_0073                 3.587201e-03 3 1  ON 72
ci_0074                 3.565197e-03 3 1  ON 73
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 4.1148e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s004 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s004 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=4  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6880e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 4
    time step          = 0.05
    reference energy   = -16.9592
    reference variance = 0.25931
====================================================
  Execution time = 1.6935e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s004
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5258e+04
  VMC Eavg = -1.6899e+01
  VMC Evar = 2.8936e-01
  Total weights = 1.951034254e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 2.6300e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.279466175496
                                         uncertainty =       0.001480544825

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.279466175496
                                         uncertainty =       0.001480544825

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000373789948
  error estimate for blocks of size 2^( 2) =       0.000390644355
  error estimate for blocks of size 2^( 3) =       0.000407903667
  error estimate for blocks of size 2^( 4) =       0.000423196574
  error estimate for blocks of size 2^( 5) =       0.000435550592
  error estimate for blocks of size 2^( 6) =       0.000441679359
  error estimate for blocks of size 2^( 7) =       0.000444240819

      target function =      -0.929414309772
              le_mean =     -16.899220158478
             les_mean =     285.873000518266
             stat err =       0.000436166836
             autocorr =       1.361601575453
   target nu stat err =       0.000436166836
   target dn stat err =       0.002586389038
      target stat err =       0.004168373814
              std dev =       0.528618813934
             le_variance =       0.279437850445


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.689922015848e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 74
Check correct_vf_var_size: 225, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.5000e+01, overlap shift 2.5000e+02 and omega -1.7444e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.929431518488       residual = 9.19e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.929433099624       residual = 1.63e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.929433383402       residual = 4.27e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.929433466514       residual = 1.78e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.929433514592       residual = 8.23e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.929433557935       residual = 6.29e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.929433570603       residual = 4.49e-05           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.929433575463       residual = 4.41e-05           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.929433587955       residual = 4.75e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.929433611510       residual = 2.06e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.929433627716       residual = 1.00e-05           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.929433635741       residual = 2.14e-06           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.929433641555       residual = 8.40e-07           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.929433640829       residual = 2.60e-07           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.929433641614       residual = 8.34e-08           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.929433641834       residual = 3.43e-08           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.929433641594       residual = 6.20e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         16 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 2.5000e+01 is 1.656868e-05

solving harmonic davidson linear method for identity shift 1.0000e+02, overlap shift 1.0000e+03 and omega -1.7444e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.929431518488       residual = 9.19e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.929431914712       residual = 1.63e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.929431985790       residual = 4.26e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.929432006587       residual = 1.78e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.929432018614       residual = 8.22e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.929432029456       residual = 6.27e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.929432032621       residual = 4.48e-05           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.929432033836       residual = 4.40e-05           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.929432036964       residual = 4.73e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.929432042848       residual = 2.05e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.929432046886       residual = 9.93e-06           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.929432048884       residual = 2.11e-06           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.929432050332       residual = 8.31e-07           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.929432050149       residual = 2.57e-07           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.929432050345       residual = 8.24e-08           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.929432050399       residual = 3.38e-08           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.929432050340       residual = 6.11e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         16 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 1.0000e+02 is 4.142230e-06

solving harmonic davidson linear method for identity shift 4.0000e+02, overlap shift 4.0000e+03 and omega -1.7444e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.929431518488       residual = 9.19e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.929431617603       residual = 1.63e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.929431635381       residual = 4.26e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.929431640581       residual = 1.78e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.929431643588       residual = 8.21e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.929431646299       residual = 6.27e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.929431647090       residual = 4.47e-05           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.929431647394       residual = 4.40e-05           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.929431648176       residual = 4.72e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.929431649646       residual = 2.05e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.929431650655       residual = 9.91e-06           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.929431651154       residual = 2.11e-06           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.929431651517       residual = 8.29e-07           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.929431651472       residual = 2.56e-07           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.929431651520       residual = 8.22e-08           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.929431651533       residual = 3.37e-08           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.929431651518       residual = 6.09e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         16 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 4.0000e+02 is 1.035561e-06

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.189918 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 75 and numParams is: 74

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.9580e+01
  </log>
  <optVariables href="H2O.s004.opt.xml">
ci_0001                 7.083584e-01 3 1  ON 0
ci_0002                 6.929710e-01 3 1  ON 1
ci_0003                -3.111965e-02 3 1  ON 2
ci_0004                -3.021356e-02 3 1  ON 3
ci_0005                -3.055344e-02 3 1  ON 4
ci_0006                -3.070971e-02 3 1  ON 5
ci_0007                -1.356206e-02 3 1  ON 6
ci_0008                -1.345082e-02 3 1  ON 7
ci_0009                -1.880893e-02 3 1  ON 8
ci_0010                -1.811562e-02 3 1  ON 9
ci_0011                -1.471687e-02 3 1  ON 10
ci_0012                -1.460786e-02 3 1  ON 11
ci_0013                 1.529990e-02 3 1  ON 12
ci_0014                 1.482592e-02 3 1  ON 13
ci_0015                 1.590198e-02 3 1  ON 14
ci_0016                 1.546715e-02 3 1  ON 15
ci_0017                 1.343935e-02 3 1  ON 16
ci_0018                 1.318193e-02 3 1  ON 17
ci_0019                 1.302860e-02 3 1  ON 18
ci_0020                 1.260211e-02 3 1  ON 19
ci_0021                 7.479047e-03 3 1  ON 20
ci_0022                 8.099273e-03 3 1  ON 21
ci_0023                -1.179595e-02 3 1  ON 22
ci_0024                -1.133076e-02 3 1  ON 23
ci_0025                -1.983941e-03 3 1  ON 24
ci_0026                -2.707971e-03 3 1  ON 25
ci_0027                -1.207888e-02 3 1  ON 26
ci_0028                -1.155627e-02 3 1  ON 27
ci_0029                -1.056517e-02 3 1  ON 28
ci_0030                -1.053236e-02 3 1  ON 29
ci_0031                 1.349432e-02 3 1  ON 30
ci_0032                 1.220103e-02 3 1  ON 31
ci_0033                 7.980283e-03 3 1  ON 32
ci_0034                 8.443323e-03 3 1  ON 33
ci_0035                 4.954922e-03 3 1  ON 34
ci_0036                 5.010119e-03 3 1  ON 35
ci_0037                -1.132518e-02 3 1  ON 36
ci_0038                -1.146984e-02 3 1  ON 37
ci_0039                -4.022124e-03 3 1  ON 38
ci_0040                -3.997960e-03 3 1  ON 39
ci_0041                 9.002099e-03 3 1  ON 40
ci_0042                 8.684860e-03 3 1  ON 41
ci_0043                -1.259974e-02 3 1  ON 42
ci_0044                -1.329309e-02 3 1  ON 43
ci_0045                 1.061751e-02 3 1  ON 44
ci_0046                 1.011609e-02 3 1  ON 45
ci_0047                -3.639644e-03 3 1  ON 46
ci_0048                -3.466018e-03 3 1  ON 47
ci_0049                -2.544806e-03 3 1  ON 48
ci_0050                -2.731200e-03 3 1  ON 49
ci_0051                -1.775629e-03 3 1  ON 50
ci_0052                -2.106885e-03 3 1  ON 51
ci_0053                -3.936545e-03 3 1  ON 52
ci_0054                -3.293823e-03 3 1  ON 53
ci_0055                 2.681638e-03 3 1  ON 54
ci_0056                 2.267676e-03 3 1  ON 55
ci_0057                 2.555280e-03 3 1  ON 56
ci_0058                 3.094984e-03 3 1  ON 57
ci_0059                -3.371718e-03 3 1  ON 58
ci_0060                -3.208971e-03 3 1  ON 59
ci_0061                -3.939437e-03 3 1  ON 60
ci_0062                -3.931794e-03 3 1  ON 61
ci_0063                -9.983159e-03 3 1  ON 62
ci_0064                -9.391547e-03 3 1  ON 63
ci_0065                -6.424259e-03 3 1  ON 64
ci_0066                -6.209322e-03 3 1  ON 65
ci_0067                -3.660212e-03 3 1  ON 66
ci_0068                -3.437539e-03 3 1  ON 67
ci_0069                 3.762440e-03 3 1  ON 68
ci_0070                 3.439241e-03 3 1  ON 69
ci_0071                 2.964894e-03 3 1  ON 70
ci_0072                 3.570130e-03 3 1  ON 71
ci_0073                 3.586582e-03 3 1  ON 72
ci_0074                 3.564906e-03 3 1  ON 73
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 4
    time step          = 0.05
    reference energy   = -16.9027
    reference variance = 0.254689
====================================================
  Execution time = 1.6326e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s004
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6899e+01
  VMC Evar = 2.9637e-01
  Total weights = 1.9508e+06
  Execution time = 1.8896e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.284296622020
                                         uncertainty =       0.001899260547

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.284296622020
                                         uncertainty =       0.001899260547

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000377040361
  error estimate for blocks of size 2^( 2) =       0.000393978079
  error estimate for blocks of size 2^( 3) =       0.000411588878
  error estimate for blocks of size 2^( 4) =       0.000427494617
  error estimate for blocks of size 2^( 5) =       0.000439425463
  error estimate for blocks of size 2^( 6) =       0.000448307742
  error estimate for blocks of size 2^( 7) =       0.000452639083

      target function =      -0.918415423033
              le_mean =     -16.898636748026
             les_mean =     285.860299825099
             stat err =       0.000441966727
             autocorr =       1.374052938059
   target nu stat err =       0.000441966727
   target dn stat err =       0.002727486752
      target stat err =       0.004284041144
              std dev =       0.533215591577
             le_variance =       0.284318867101

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.284295654482
                                         uncertainty =       0.001899191490

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.284295654482
                                         uncertainty =       0.001899191490

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000377039722
  error estimate for blocks of size 2^( 2) =       0.000393977368
  error estimate for blocks of size 2^( 3) =       0.000411588042
  error estimate for blocks of size 2^( 4) =       0.000427493641
  error estimate for blocks of size 2^( 5) =       0.000439424390
  error estimate for blocks of size 2^( 6) =       0.000448306654
  error estimate for blocks of size 2^( 7) =       0.000452637825

      target function =      -0.918118292011
              le_mean =     -16.898636664507
             les_mean =     285.860489090769
             stat err =       0.000441965628
             autocorr =       1.374050761249
   target nu stat err =       0.000441965628
   target dn stat err =       0.002735443584
      target stat err =       0.004293423939
              std dev =       0.533214688071
             le_variance =       0.284317903574

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.284296135617
                                         uncertainty =       0.001899225896

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.284296135617
                                         uncertainty =       0.001899225896

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000377040039
  error estimate for blocks of size 2^( 2) =       0.000393977722
  error estimate for blocks of size 2^( 3) =       0.000411588458
  error estimate for blocks of size 2^( 4) =       0.000427494127
  error estimate for blocks of size 2^( 5) =       0.000439424928
  error estimate for blocks of size 2^( 6) =       0.000448307201
  error estimate for blocks of size 2^( 7) =       0.000452638461

      target function =      -0.918419148036
              le_mean =     -16.898636706973
             les_mean =     285.860296036731
             stat err =       0.000441966179
             autocorr =       1.374051876154
   target nu stat err =       0.000441966179
   target dn stat err =       0.002726659871
      target stat err =       0.004282815265
              std dev =       0.533215137351
             le_variance =       0.284318382701

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.284296560991
                                         uncertainty =       0.001899256207

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.284296560991
                                         uncertainty =       0.001899256207

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000377040320
  error estimate for blocks of size 2^( 2) =       0.000393978034
  error estimate for blocks of size 2^( 3) =       0.000411588825
  error estimate for blocks of size 2^( 4) =       0.000427494556
  error estimate for blocks of size 2^( 5) =       0.000439425396
  error estimate for blocks of size 2^( 6) =       0.000448307675
  error estimate for blocks of size 2^( 7) =       0.000452639005

      target function =      -0.918417680600
              le_mean =     -16.898636742902
             les_mean =     285.860298193469
             stat err =       0.000441966658
             autocorr =       1.374052805916
   target nu stat err =       0.000441966658
   target dn stat err =       0.002727364446
      target stat err =       0.004283875513
              std dev =       0.533215534584
             le_variance =       0.284318806322


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.918415423033        initial
     2.5000e+01     2.5000e+02             1.6569e-05        -0.918118292011
     1.0000e+02     1.0000e+03             4.1422e-06        -0.918419148036  <--
     4.0000e+02     4.0000e+03             1.0356e-06        -0.918417680600

*****************************************************************************
Applying the update for shift_i =   1.0000e+02     and shift_s =   1.0000e+03
*****************************************************************************

  Execution time = 2.5815e+01
  </log>
  <optVariables href="H2O.s004.opt.xml">
ci_0001                 7.083584e-01 3 1  ON 0
ci_0002                 6.929710e-01 3 1  ON 1
ci_0003                -3.111965e-02 3 1  ON 2
ci_0004                -3.021356e-02 3 1  ON 3
ci_0005                -3.055344e-02 3 1  ON 4
ci_0006                -3.070971e-02 3 1  ON 5
ci_0007                -1.356206e-02 3 1  ON 6
ci_0008                -1.345082e-02 3 1  ON 7
ci_0009                -1.880893e-02 3 1  ON 8
ci_0010                -1.811562e-02 3 1  ON 9
ci_0011                -1.471687e-02 3 1  ON 10
ci_0012                -1.460786e-02 3 1  ON 11
ci_0013                 1.529990e-02 3 1  ON 12
ci_0014                 1.482592e-02 3 1  ON 13
ci_0015                 1.590198e-02 3 1  ON 14
ci_0016                 1.546715e-02 3 1  ON 15
ci_0017                 1.343935e-02 3 1  ON 16
ci_0018                 1.318193e-02 3 1  ON 17
ci_0019                 1.302860e-02 3 1  ON 18
ci_0020                 1.260211e-02 3 1  ON 19
ci_0021                 7.479047e-03 3 1  ON 20
ci_0022                 8.099273e-03 3 1  ON 21
ci_0023                -1.179595e-02 3 1  ON 22
ci_0024                -1.133076e-02 3 1  ON 23
ci_0025                -1.983941e-03 3 1  ON 24
ci_0026                -2.707971e-03 3 1  ON 25
ci_0027                -1.207888e-02 3 1  ON 26
ci_0028                -1.155627e-02 3 1  ON 27
ci_0029                -1.056517e-02 3 1  ON 28
ci_0030                -1.053236e-02 3 1  ON 29
ci_0031                 1.349432e-02 3 1  ON 30
ci_0032                 1.220103e-02 3 1  ON 31
ci_0033                 7.980283e-03 3 1  ON 32
ci_0034                 8.443323e-03 3 1  ON 33
ci_0035                 4.954922e-03 3 1  ON 34
ci_0036                 5.010119e-03 3 1  ON 35
ci_0037                -1.132518e-02 3 1  ON 36
ci_0038                -1.146984e-02 3 1  ON 37
ci_0039                -4.022124e-03 3 1  ON 38
ci_0040                -3.997960e-03 3 1  ON 39
ci_0041                 9.002099e-03 3 1  ON 40
ci_0042                 8.684860e-03 3 1  ON 41
ci_0043                -1.259974e-02 3 1  ON 42
ci_0044                -1.329309e-02 3 1  ON 43
ci_0045                 1.061751e-02 3 1  ON 44
ci_0046                 1.011609e-02 3 1  ON 45
ci_0047                -3.639644e-03 3 1  ON 46
ci_0048                -3.466018e-03 3 1  ON 47
ci_0049                -2.544806e-03 3 1  ON 48
ci_0050                -2.731200e-03 3 1  ON 49
ci_0051                -1.775629e-03 3 1  ON 50
ci_0052                -2.106885e-03 3 1  ON 51
ci_0053                -3.936545e-03 3 1  ON 52
ci_0054                -3.293823e-03 3 1  ON 53
ci_0055                 2.681638e-03 3 1  ON 54
ci_0056                 2.267676e-03 3 1  ON 55
ci_0057                 2.555280e-03 3 1  ON 56
ci_0058                 3.094984e-03 3 1  ON 57
ci_0059                -3.371718e-03 3 1  ON 58
ci_0060                -3.208971e-03 3 1  ON 59
ci_0061                -3.939437e-03 3 1  ON 60
ci_0062                -3.931794e-03 3 1  ON 61
ci_0063                -9.983159e-03 3 1  ON 62
ci_0064                -9.391547e-03 3 1  ON 63
ci_0065                -6.424259e-03 3 1  ON 64
ci_0066                -6.209322e-03 3 1  ON 65
ci_0067                -3.660212e-03 3 1  ON 66
ci_0068                -3.437539e-03 3 1  ON 67
ci_0069                 3.762440e-03 3 1  ON 68
ci_0070                 3.439241e-03 3 1  ON 69
ci_0071                 2.964894e-03 3 1  ON 70
ci_0072                 3.570130e-03 3 1  ON 71
ci_0073                 3.586582e-03 3 1  ON 72
ci_0074                 3.564906e-03 3 1  ON 73
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 4.5419e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s005 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s005 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=5  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6890e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 5
    time step          = 0.05
    reference energy   = -16.9567
    reference variance = 0.740636
====================================================
  Execution time = 1.4559e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s005
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5251e+04
  VMC Eavg = -1.6898e+01
  VMC Evar = 2.9455e-01
  Total weights = 1.950848572e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 2.6094e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.284999811966
                                         uncertainty =       0.001736652749

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.284999811966
                                         uncertainty =       0.001736652749

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000377507165
  error estimate for blocks of size 2^( 2) =       0.000394402295
  error estimate for blocks of size 2^( 3) =       0.000411750953
  error estimate for blocks of size 2^( 4) =       0.000426226912
  error estimate for blocks of size 2^( 5) =       0.000437049106
  error estimate for blocks of size 2^( 6) =       0.000442087354
  error estimate for blocks of size 2^( 7) =       0.000447483770

      target function =      -0.921248482283
              le_mean =     -16.898275289962
             les_mean =     285.846256892153
             stat err =       0.000438211785
             autocorr =       1.347465671122
   target nu stat err =       0.000438211785
   target dn stat err =       0.002579696259
      target stat err =       0.004079902265
              std dev =       0.533875752307
             le_variance =       0.285023318901


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.689827528996e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 74
Check correct_vf_var_size: 225, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.5000e+01, overlap shift 2.5000e+02 and omega -1.7444e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.921265306398       residual = 6.10e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.921266455829       residual = 8.85e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.921266638059       residual = 2.17e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.921266709910       residual = 1.16e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.921266760863       residual = 3.17e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.921266769215       residual = 1.29e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.921266769768       residual = 3.33e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.921266767998       residual = 8.83e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.921266769415       residual = 3.60e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.921266769290       residual = 1.65e-07           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.921266769402       residual = 1.07e-07           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.921266769665       residual = 9.71e-08           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.921266770312       residual = 9.41e-08           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.921266770787       residual = 5.24e-08           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.921266770201       residual = 2.53e-08           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.921266770323       residual = 1.22e-08           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.921266770360       residual = 2.63e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         16 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 2.5000e+01 is 5.998010e-06

solving harmonic davidson linear method for identity shift 1.0000e+02, overlap shift 1.0000e+03 and omega -1.7444e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.921265306398       residual = 6.10e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.921265594418       residual = 8.85e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.921265640063       residual = 2.17e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.921265658044       residual = 1.15e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.921265670790       residual = 3.16e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.921265672874       residual = 1.29e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.921265673010       residual = 3.32e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.921265672567       residual = 8.79e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.921265672921       residual = 3.59e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.921265672890       residual = 1.64e-07           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.921265672918       residual = 1.07e-07           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.921265672984       residual = 9.68e-08           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.921265673145       residual = 9.35e-08           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.921265673264       residual = 5.19e-08           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.921265673118       residual = 2.51e-08           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.921265673148       residual = 1.20e-08           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.921265673157       residual = 2.59e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         16 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 1.0000e+02 is 1.501406e-06

solving harmonic davidson linear method for identity shift 4.0000e+02, overlap shift 4.0000e+03 and omega -1.7444e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.921265306398       residual = 6.10e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.921265378445       residual = 8.85e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.921265389861       residual = 2.17e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.921265394358       residual = 1.15e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.921265397544       residual = 3.16e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.921265398065       residual = 1.29e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.921265398099       residual = 3.31e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.921265397988       residual = 8.78e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.921265398077       residual = 3.58e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.921265398070       residual = 1.64e-07           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.921265398076       residual = 1.07e-07           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.921265398093       residual = 9.67e-08           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.921265398133       residual = 9.33e-08           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.921265398163       residual = 5.18e-08           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.921265398126       residual = 2.50e-08           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.921265398133       residual = 1.20e-08           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.921265398136       residual = 2.58e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         16 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 4.0000e+02 is 3.754708e-07

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.199095 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 75 and numParams is: 74

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.7183e+01
  </log>
  <optVariables href="H2O.s005.opt.xml">
ci_0001                 7.083582e-01 3 1  ON 0
ci_0002                 6.929713e-01 3 1  ON 1
ci_0003                -3.111927e-02 3 1  ON 2
ci_0004                -3.021372e-02 3 1  ON 3
ci_0005                -3.055337e-02 3 1  ON 4
ci_0006                -3.070982e-02 3 1  ON 5
ci_0007                -1.356142e-02 3 1  ON 6
ci_0008                -1.345067e-02 3 1  ON 7
ci_0009                -1.880931e-02 3 1  ON 8
ci_0010                -1.811523e-02 3 1  ON 9
ci_0011                -1.471644e-02 3 1  ON 10
ci_0012                -1.460750e-02 3 1  ON 11
ci_0013                 1.529955e-02 3 1  ON 12
ci_0014                 1.482582e-02 3 1  ON 13
ci_0015                 1.590212e-02 3 1  ON 14
ci_0016                 1.546730e-02 3 1  ON 15
ci_0017                 1.343937e-02 3 1  ON 16
ci_0018                 1.318171e-02 3 1  ON 17
ci_0019                 1.302898e-02 3 1  ON 18
ci_0020                 1.260201e-02 3 1  ON 19
ci_0021                 7.477545e-03 3 1  ON 20
ci_0022                 8.098419e-03 3 1  ON 21
ci_0023                -1.179547e-02 3 1  ON 22
ci_0024                -1.133099e-02 3 1  ON 23
ci_0025                -1.984096e-03 3 1  ON 24
ci_0026                -2.708325e-03 3 1  ON 25
ci_0027                -1.207869e-02 3 1  ON 26
ci_0028                -1.155628e-02 3 1  ON 27
ci_0029                -1.056479e-02 3 1  ON 28
ci_0030                -1.053237e-02 3 1  ON 29
ci_0031                 1.349391e-02 3 1  ON 30
ci_0032                 1.220128e-02 3 1  ON 31
ci_0033                 7.980896e-03 3 1  ON 32
ci_0034                 8.442454e-03 3 1  ON 33
ci_0035                 4.954314e-03 3 1  ON 34
ci_0036                 5.009496e-03 3 1  ON 35
ci_0037                -1.132531e-02 3 1  ON 36
ci_0038                -1.146964e-02 3 1  ON 37
ci_0039                -4.021617e-03 3 1  ON 38
ci_0040                -3.997890e-03 3 1  ON 39
ci_0041                 9.002537e-03 3 1  ON 40
ci_0042                 8.685285e-03 3 1  ON 41
ci_0043                -1.260069e-02 3 1  ON 42
ci_0044                -1.329434e-02 3 1  ON 43
ci_0045                 1.061729e-02 3 1  ON 44
ci_0046                 1.011522e-02 3 1  ON 45
ci_0047                -3.639533e-03 3 1  ON 46
ci_0048                -3.466006e-03 3 1  ON 47
ci_0049                -2.546007e-03 3 1  ON 48
ci_0050                -2.732283e-03 3 1  ON 49
ci_0051                -1.775342e-03 3 1  ON 50
ci_0052                -2.106577e-03 3 1  ON 51
ci_0053                -3.935892e-03 3 1  ON 52
ci_0054                -3.294077e-03 3 1  ON 53
ci_0055                 2.680372e-03 3 1  ON 54
ci_0056                 2.267257e-03 3 1  ON 55
ci_0057                 2.555354e-03 3 1  ON 56
ci_0058                 3.094510e-03 3 1  ON 57
ci_0059                -3.371922e-03 3 1  ON 58
ci_0060                -3.209311e-03 3 1  ON 59
ci_0061                -3.939880e-03 3 1  ON 60
ci_0062                -3.931345e-03 3 1  ON 61
ci_0063                -9.983118e-03 3 1  ON 62
ci_0064                -9.392142e-03 3 1  ON 63
ci_0065                -6.424088e-03 3 1  ON 64
ci_0066                -6.209712e-03 3 1  ON 65
ci_0067                -3.659755e-03 3 1  ON 66
ci_0068                -3.436755e-03 3 1  ON 67
ci_0069                 3.762315e-03 3 1  ON 68
ci_0070                 3.439039e-03 3 1  ON 69
ci_0071                 2.964129e-03 3 1  ON 70
ci_0072                 3.569605e-03 3 1  ON 71
ci_0073                 3.586340e-03 3 1  ON 72
ci_0074                 3.565301e-03 3 1  ON 73
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 5
    time step          = 0.05
    reference energy   = -16.9168
    reference variance = 0.260091
====================================================
  Execution time = 1.4067e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s005
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6899e+01
  VMC Evar = 2.9347e-01
  Total weights = 1.9509e+06
  Execution time = 1.8859e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.282988645390
                                         uncertainty =       0.001847951014

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.282988645390
                                         uncertainty =       0.001847951014

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000376138114
  error estimate for blocks of size 2^( 2) =       0.000393170594
  error estimate for blocks of size 2^( 3) =       0.000410639319
  error estimate for blocks of size 2^( 4) =       0.000426025839
  error estimate for blocks of size 2^( 5) =       0.000438210282
  error estimate for blocks of size 2^( 6) =       0.000446605957
  error estimate for blocks of size 2^( 7) =       0.000448994734

      target function =      -0.922938669159
              le_mean =     -16.898590132823
             les_mean =     285.855817265342
             stat err =       0.000439959203
             autocorr =       1.368138702328
   target nu stat err =       0.000439959203
   target dn stat err =       0.002345537766
      target stat err =       0.003738466336
              std dev =       0.531939621946
             le_variance =       0.282959761396

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.282987689652
                                         uncertainty =       0.001848009162

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.282987689652
                                         uncertainty =       0.001848009162

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000376137479
  error estimate for blocks of size 2^( 2) =       0.000393169888
  error estimate for blocks of size 2^( 3) =       0.000410638516
  error estimate for blocks of size 2^( 4) =       0.000426024961
  error estimate for blocks of size 2^( 5) =       0.000438209307
  error estimate for blocks of size 2^( 6) =       0.000446604796
  error estimate for blocks of size 2^( 7) =       0.000448993361

      target function =      -0.922950847482
              le_mean =     -16.898590172420
             les_mean =     285.855810808391
             stat err =       0.000439958106
             autocorr =       1.368136503580
   target nu stat err =       0.000439958106
   target dn stat err =       0.002345317456
      target stat err =       0.003738225709
              std dev =       0.531938723452
             le_variance =       0.282958805507

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.282988165569
                                         uncertainty =       0.001847980154

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.282988165569
                                         uncertainty =       0.001847980154

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000376137795
  error estimate for blocks of size 2^( 2) =       0.000393170240
  error estimate for blocks of size 2^( 3) =       0.000410638916
  error estimate for blocks of size 2^( 4) =       0.000426025398
  error estimate for blocks of size 2^( 5) =       0.000438209793
  error estimate for blocks of size 2^( 6) =       0.000446605375
  error estimate for blocks of size 2^( 7) =       0.000448994046

      target function =      -0.922944551741
              le_mean =     -16.898590152499
             les_mean =     285.855814165007
             stat err =       0.000439958653
             autocorr =       1.368137602176
   target nu stat err =       0.000439958653
   target dn stat err =       0.002345419157
      target stat err =       0.003738331442
              std dev =       0.531939170865
             le_variance =       0.282959281500

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.282988585268
                                         uncertainty =       0.001847954658

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.282988585268
                                         uncertainty =       0.001847954658

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000376138074
  error estimate for blocks of size 2^( 2) =       0.000393170549
  error estimate for blocks of size 2^( 3) =       0.000410639268
  error estimate for blocks of size 2^( 4) =       0.000426025783
  error estimate for blocks of size 2^( 5) =       0.000438210221
  error estimate for blocks of size 2^( 6) =       0.000446605885
  error estimate for blocks of size 2^( 7) =       0.000448994648

      target function =      -0.922939803423
              le_mean =     -16.898590135267
             les_mean =     285.855816621853
             stat err =       0.000439959134
             autocorr =       1.368138564855
   target nu stat err =       0.000439959134
   target dn stat err =       0.002345521828
      target stat err =       0.003738450940
              std dev =       0.531939565426
             le_variance =       0.282959701265


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.922938669159        initial
     2.5000e+01     2.5000e+02             5.9980e-06        -0.922950847482  <--
     1.0000e+02     1.0000e+03             1.5014e-06        -0.922944551741
     4.0000e+02     4.0000e+03             3.7547e-07        -0.922939803423

*****************************************************************************
Applying the update for shift_i =   2.5000e+01     and shift_s =   2.5000e+02
*****************************************************************************

  Execution time = 2.3564e+01
  </log>
  <optVariables href="H2O.s005.opt.xml">
ci_0001                 7.083575e-01 3 1  ON 0
ci_0002                 6.929722e-01 3 1  ON 1
ci_0003                -3.111811e-02 3 1  ON 2
ci_0004                -3.021419e-02 3 1  ON 3
ci_0005                -3.055317e-02 3 1  ON 4
ci_0006                -3.071015e-02 3 1  ON 5
ci_0007                -1.355953e-02 3 1  ON 6
ci_0008                -1.345024e-02 3 1  ON 7
ci_0009                -1.881043e-02 3 1  ON 8
ci_0010                -1.811407e-02 3 1  ON 9
ci_0011                -1.471515e-02 3 1  ON 10
ci_0012                -1.460641e-02 3 1  ON 11
ci_0013                 1.529852e-02 3 1  ON 12
ci_0014                 1.482553e-02 3 1  ON 13
ci_0015                 1.590256e-02 3 1  ON 14
ci_0016                 1.546774e-02 3 1  ON 15
ci_0017                 1.343942e-02 3 1  ON 16
ci_0018                 1.318105e-02 3 1  ON 17
ci_0019                 1.303011e-02 3 1  ON 18
ci_0020                 1.260173e-02 3 1  ON 19
ci_0021                 7.473049e-03 3 1  ON 20
ci_0022                 8.095862e-03 3 1  ON 21
ci_0023                -1.179403e-02 3 1  ON 22
ci_0024                -1.133166e-02 3 1  ON 23
ci_0025                -1.984559e-03 3 1  ON 24
ci_0026                -2.709384e-03 3 1  ON 25
ci_0027                -1.207815e-02 3 1  ON 26
ci_0028                -1.155629e-02 3 1  ON 27
ci_0029                -1.056368e-02 3 1  ON 28
ci_0030                -1.053242e-02 3 1  ON 29
ci_0031                 1.349265e-02 3 1  ON 30
ci_0032                 1.220201e-02 3 1  ON 31
ci_0033                 7.982732e-03 3 1  ON 32
ci_0034                 8.439851e-03 3 1  ON 33
ci_0035                 4.952495e-03 3 1  ON 34
ci_0036                 5.007632e-03 3 1  ON 35
ci_0037                -1.132568e-02 3 1  ON 36
ci_0038                -1.146907e-02 3 1  ON 37
ci_0039                -4.020098e-03 3 1  ON 38
ci_0040                -3.997680e-03 3 1  ON 39
ci_0041                 9.003846e-03 3 1  ON 40
ci_0042                 8.686554e-03 3 1  ON 41
ci_0043                -1.260353e-02 3 1  ON 42
ci_0044                -1.329809e-02 3 1  ON 43
ci_0045                 1.061665e-02 3 1  ON 44
ci_0046                 1.011262e-02 3 1  ON 45
ci_0047                -3.639202e-03 3 1  ON 46
ci_0048                -3.465972e-03 3 1  ON 47
ci_0049                -2.549598e-03 3 1  ON 48
ci_0050                -2.735523e-03 3 1  ON 49
ci_0051                -1.774481e-03 3 1  ON 50
ci_0052                -2.105657e-03 3 1  ON 51
ci_0053                -3.933937e-03 3 1  ON 52
ci_0054                -3.294839e-03 3 1  ON 53
ci_0055                 2.676586e-03 3 1  ON 54
ci_0056                 2.266004e-03 3 1  ON 55
ci_0057                 2.555577e-03 3 1  ON 56
ci_0058                 3.093091e-03 3 1  ON 57
ci_0059                -3.372531e-03 3 1  ON 58
ci_0060                -3.210327e-03 3 1  ON 59
ci_0061                -3.941208e-03 3 1  ON 60
ci_0062                -3.930001e-03 3 1  ON 61
ci_0063                -9.982997e-03 3 1  ON 62
ci_0064                -9.393920e-03 3 1  ON 63
ci_0065                -6.423576e-03 3 1  ON 64
ci_0066                -6.210879e-03 3 1  ON 65
ci_0067                -3.658388e-03 3 1  ON 66
ci_0068                -3.434411e-03 3 1  ON 67
ci_0069                 3.761942e-03 3 1  ON 68
ci_0070                 3.438432e-03 3 1  ON 69
ci_0071                 2.961838e-03 3 1  ON 70
ci_0072                 3.568034e-03 3 1  ON 71
ci_0073                 3.585615e-03 3 1  ON 72
ci_0074                 3.566482e-03 3 1  ON 73
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 4.0754e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s006 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s006 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=6  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6898e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 6
    time step          = 0.05
    reference energy   = -16.9494
    reference variance = 0.186952
====================================================
  Execution time = 1.4419e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s006
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5225e+04
  VMC Eavg = -1.6899e+01
  VMC Evar = 2.9802e-01
  Total weights = 1.951115232e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 2.6200e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.284518735477
                                         uncertainty =       0.003032771823

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.284518735477
                                         uncertainty =       0.003032771823

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000377206098
  error estimate for blocks of size 2^( 2) =       0.000393845624
  error estimate for blocks of size 2^( 3) =       0.000410719732
  error estimate for blocks of size 2^( 4) =       0.000425530062
  error estimate for blocks of size 2^( 5) =       0.000437727203
  error estimate for blocks of size 2^( 6) =       0.000444205968
  error estimate for blocks of size 2^( 7) =       0.000449236633

      target function =      -0.915832875283
              le_mean =     -16.899071453067
             les_mean =     285.876638498455
             stat err =       0.000439174966
             autocorr =       1.355556871740
   target nu stat err =       0.000439174966
   target dn stat err =       0.004871609434
      target stat err =       0.007535651659
              std dev =       0.533449980010
             le_variance =       0.284568881173


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.689907145307e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 74
Check correct_vf_var_size: 225, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 6.2500e+00, overlap shift 6.2500e+01 and omega -1.7444e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.915892880963       residual = 4.33e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.915918708423       residual = 3.44e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.915921318761       residual = 9.29e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.915921850369       residual = 3.87e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.915922396905       residual = 1.32e-04           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.915922530031       residual = 6.21e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.915922588160       residual = 1.40e-05           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.915922633751       residual = 6.15e-06           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.915922666113       residual = 7.78e-06           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.915922682292       residual = 6.58e-06           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.915922671519       residual = 6.77e-06           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.915922676029       residual = 2.78e-06           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.915922684544       residual = 2.22e-06           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.915922689648       residual = 8.50e-07           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.915922687319       residual = 2.75e-07           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.915922687256       residual = 8.81e-08           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.915922686243       residual = 2.16e-08           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.915922684980       residual = 4.31e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         17 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 6.2500e+00 is 5.678900e-05

solving harmonic davidson linear method for identity shift 2.5000e+01, overlap shift 2.5000e+02 and omega -1.7444e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.915892880963       residual = 4.33e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.915899399048       residual = 3.43e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.915900056689       residual = 9.25e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.915900190120       residual = 3.84e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.915900327169       residual = 1.31e-04           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.915900360380       residual = 6.13e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.915900374842       residual = 1.38e-05           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.915900386241       residual = 6.07e-06           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.915900394342       residual = 7.69e-06           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.915900398353       residual = 6.50e-06           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.915900395623       residual = 6.66e-06           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.915900396736       residual = 2.71e-06           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.915900398851       residual = 2.15e-06           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.915900400102       residual = 8.14e-07           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.915900399515       residual = 2.62e-07           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.915900399492       residual = 8.34e-08           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.915900399243       residual = 2.03e-08           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.915900398935       residual = 4.07e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         17 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 2.5000e+01 is 1.433308e-05

solving harmonic davidson linear method for identity shift 1.0000e+02, overlap shift 1.0000e+03 and omega -1.7444e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.915892880963       residual = 4.33e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.915894514356       residual = 3.43e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.915894679085       residual = 9.24e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.915894712476       residual = 3.84e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.915894746764       residual = 1.30e-04           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.915894755062       residual = 6.11e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.915894758673       residual = 1.37e-05           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.915894761523       residual = 6.05e-06           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.915894763549       residual = 7.67e-06           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.915894764550       residual = 6.48e-06           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.915894763865       residual = 6.63e-06           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.915894764142       residual = 2.69e-06           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.915894764670       residual = 2.13e-06           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.915894764982       residual = 8.05e-07           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.915894764834       residual = 2.59e-07           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.915894764828       residual = 8.22e-08           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.915894764766       residual = 2.00e-08           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.915894764690       residual = 4.01e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         17 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 1.0000e+02 is 3.591861e-06

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.209324 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 75 and numParams is: 74

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.7055e+01
  </log>
  <optVariables href="H2O.s006.opt.xml">
ci_0001                 7.083511e-01 3 1  ON 0
ci_0002                 6.929795e-01 3 1  ON 1
ci_0003                -3.111670e-02 3 1  ON 2
ci_0004                -3.021315e-02 3 1  ON 3
ci_0005                -3.055542e-02 3 1  ON 4
ci_0006                -3.070641e-02 3 1  ON 5
ci_0007                -1.355528e-02 3 1  ON 6
ci_0008                -1.344753e-02 3 1  ON 7
ci_0009                -1.880217e-02 3 1  ON 8
ci_0010                -1.811436e-02 3 1  ON 9
ci_0011                -1.471356e-02 3 1  ON 10
ci_0012                -1.460346e-02 3 1  ON 11
ci_0013                 1.529318e-02 3 1  ON 12
ci_0014                 1.482734e-02 3 1  ON 13
ci_0015                 1.589977e-02 3 1  ON 14
ci_0016                 1.546581e-02 3 1  ON 15
ci_0017                 1.344164e-02 3 1  ON 16
ci_0018                 1.318054e-02 3 1  ON 17
ci_0019                 1.302795e-02 3 1  ON 18
ci_0020                 1.260155e-02 3 1  ON 19
ci_0021                 7.474214e-03 3 1  ON 20
ci_0022                 8.087081e-03 3 1  ON 21
ci_0023                -1.179740e-02 3 1  ON 22
ci_0024                -1.133241e-02 3 1  ON 23
ci_0025                -1.983206e-03 3 1  ON 24
ci_0026                -2.706353e-03 3 1  ON 25
ci_0027                -1.207765e-02 3 1  ON 26
ci_0028                -1.155763e-02 3 1  ON 27
ci_0029                -1.056771e-02 3 1  ON 28
ci_0030                -1.053226e-02 3 1  ON 29
ci_0031                 1.349507e-02 3 1  ON 30
ci_0032                 1.220356e-02 3 1  ON 31
ci_0033                 7.970628e-03 3 1  ON 32
ci_0034                 8.442571e-03 3 1  ON 33
ci_0035                 4.949126e-03 3 1  ON 34
ci_0036                 5.010232e-03 3 1  ON 35
ci_0037                -1.132149e-02 3 1  ON 36
ci_0038                -1.147141e-02 3 1  ON 37
ci_0039                -4.020348e-03 3 1  ON 38
ci_0040                -3.999061e-03 3 1  ON 39
ci_0041                 9.004578e-03 3 1  ON 40
ci_0042                 8.685985e-03 3 1  ON 41
ci_0043                -1.260839e-02 3 1  ON 42
ci_0044                -1.329997e-02 3 1  ON 43
ci_0045                 1.061727e-02 3 1  ON 44
ci_0046                 1.011386e-02 3 1  ON 45
ci_0047                -3.639743e-03 3 1  ON 46
ci_0048                -3.464792e-03 3 1  ON 47
ci_0049                -2.552164e-03 3 1  ON 48
ci_0050                -2.738451e-03 3 1  ON 49
ci_0051                -1.773886e-03 3 1  ON 50
ci_0052                -2.101614e-03 3 1  ON 51
ci_0053                -3.936525e-03 3 1  ON 52
ci_0054                -3.297327e-03 3 1  ON 53
ci_0055                 2.662253e-03 3 1  ON 54
ci_0056                 2.261609e-03 3 1  ON 55
ci_0057                 2.557314e-03 3 1  ON 56
ci_0058                 3.097212e-03 3 1  ON 57
ci_0059                -3.374797e-03 3 1  ON 58
ci_0060                -3.210741e-03 3 1  ON 59
ci_0061                -3.940443e-03 3 1  ON 60
ci_0062                -3.928579e-03 3 1  ON 61
ci_0063                -9.982526e-03 3 1  ON 62
ci_0064                -9.391229e-03 3 1  ON 63
ci_0065                -6.425069e-03 3 1  ON 64
ci_0066                -6.207007e-03 3 1  ON 65
ci_0067                -3.656998e-03 3 1  ON 66
ci_0068                -3.436150e-03 3 1  ON 67
ci_0069                 3.757261e-03 3 1  ON 68
ci_0070                 3.448467e-03 3 1  ON 69
ci_0071                 2.966205e-03 3 1  ON 70
ci_0072                 3.557647e-03 3 1  ON 71
ci_0073                 3.584859e-03 3 1  ON 72
ci_0074                 3.566004e-03 3 1  ON 73
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 6
    time step          = 0.05
    reference energy   = -16.8412
    reference variance = 0.276048
====================================================
  Execution time = 1.4067e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s006
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6898e+01
  VMC Evar = 2.9262e-01
  Total weights = 1.9513e+06
  Execution time = 1.8899e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.282636190369
                                         uncertainty =       0.001941606587

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.282636190369
                                         uncertainty =       0.001941606587

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000375958501
  error estimate for blocks of size 2^( 2) =       0.000393332352
  error estimate for blocks of size 2^( 3) =       0.000411357726
  error estimate for blocks of size 2^( 4) =       0.000427526800
  error estimate for blocks of size 2^( 5) =       0.000439708943
  error estimate for blocks of size 2^( 6) =       0.000447177410
  error estimate for blocks of size 2^( 7) =       0.000453084329

      target function =      -0.924265132360
              le_mean =     -16.898245446406
             les_mean =     285.843315620328
             stat err =       0.000441874371
             autocorr =       1.381394767503
   target nu stat err =       0.000441874371
   target dn stat err =       0.002517173441
      target stat err =       0.004010923583
              std dev =       0.531685610886
             le_variance =       0.282689588823

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.282637904956
                                         uncertainty =       0.001942266190

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.282637904956
                                         uncertainty =       0.001942266190

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000375959565
  error estimate for blocks of size 2^( 2) =       0.000393333353
  error estimate for blocks of size 2^( 3) =       0.000411358817
  error estimate for blocks of size 2^( 4) =       0.000427527520
  error estimate for blocks of size 2^( 5) =       0.000439710548
  error estimate for blocks of size 2^( 6) =       0.000447178867
  error estimate for blocks of size 2^( 7) =       0.000453086489

      target function =      -0.924284681322
              le_mean =     -16.898245172915
             les_mean =     285.843293888821
             stat err =       0.000441875856
             autocorr =       1.381396231963
   target nu stat err =       0.000441875856
   target dn stat err =       0.002516936344
      target stat err =       0.004010724090
              std dev =       0.531687116196
             le_variance =       0.282691189529

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.282636963972
                                         uncertainty =       0.001941932992

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.282636963972
                                         uncertainty =       0.001941932992

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000375958977
  error estimate for blocks of size 2^( 2) =       0.000393332799
  error estimate for blocks of size 2^( 3) =       0.000411358220
  error estimate for blocks of size 2^( 4) =       0.000427527110
  error estimate for blocks of size 2^( 5) =       0.000439709706
  error estimate for blocks of size 2^( 6) =       0.000447178101
  error estimate for blocks of size 2^( 7) =       0.000453085375

      target function =      -0.924284012797
              le_mean =     -16.898245301424
             les_mean =     285.843298660997
             stat err =       0.000441875073
             autocorr =       1.381395661020
   target nu stat err =       0.000441875073
   target dn stat err =       0.002516844168
      target stat err =       0.004010577313
              std dev =       0.531686284464
             le_variance =       0.282690305087

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.282636276567
                                         uncertainty =       0.001941646781

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.282636276567
                                         uncertainty =       0.001941646781

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000375958553
  error estimate for blocks of size 2^( 2) =       0.000393332401
  error estimate for blocks of size 2^( 3) =       0.000411357781
  error estimate for blocks of size 2^( 4) =       0.000427526832
  error estimate for blocks of size 2^( 5) =       0.000439709033
  error estimate for blocks of size 2^( 6) =       0.000447177491
  error estimate for blocks of size 2^( 7) =       0.000453084455

      target function =      -0.924268399913
              le_mean =     -16.898245427445
             les_mean =     285.843312892553
             stat err =       0.000441874453
             autocorr =       1.381394896223
   target nu stat err =       0.000441874453
   target dn stat err =       0.002517104262
      target stat err =       0.004010844936
              std dev =       0.531685685199
             le_variance =       0.282689667846


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.924265132360        initial
     6.2500e+00     6.2500e+01             5.6789e-05        -0.924284681322  <--
     2.5000e+01     2.5000e+02             1.4333e-05        -0.924284012797
     1.0000e+02     1.0000e+03             3.5919e-06        -0.924268399913

*****************************************************************************
Applying the update for shift_i =   6.2500e+00     and shift_s =   6.2500e+01
*****************************************************************************

  Execution time = 2.3548e+01
  </log>
  <optVariables href="H2O.s006.opt.xml">
ci_0001                 7.083319e-01 3 1  ON 0
ci_0002                 6.930014e-01 3 1  ON 1
ci_0003                -3.111249e-02 3 1  ON 2
ci_0004                -3.021008e-02 3 1  ON 3
ci_0005                -3.056211e-02 3 1  ON 4
ci_0006                -3.069525e-02 3 1  ON 5
ci_0007                -1.354261e-02 3 1  ON 6
ci_0008                -1.343944e-02 3 1  ON 7
ci_0009                -1.877766e-02 3 1  ON 8
ci_0010                -1.811526e-02 3 1  ON 9
ci_0011                -1.470883e-02 3 1  ON 10
ci_0012                -1.459470e-02 3 1  ON 11
ci_0013                 1.527730e-02 3 1  ON 12
ci_0014                 1.483273e-02 3 1  ON 13
ci_0015                 1.589148e-02 3 1  ON 14
ci_0016                 1.546009e-02 3 1  ON 15
ci_0017                 1.344821e-02 3 1  ON 16
ci_0018                 1.317903e-02 3 1  ON 17
ci_0019                 1.302152e-02 3 1  ON 18
ci_0020                 1.260100e-02 3 1  ON 19
ci_0021                 7.477694e-03 3 1  ON 20
ci_0022                 8.060888e-03 3 1  ON 21
ci_0023                -1.180741e-02 3 1  ON 22
ci_0024                -1.133465e-02 3 1  ON 23
ci_0025                -1.979203e-03 3 1  ON 24
ci_0026                -2.697372e-03 3 1  ON 25
ci_0027                -1.207617e-02 3 1  ON 26
ci_0028                -1.156161e-02 3 1  ON 27
ci_0029                -1.057968e-02 3 1  ON 28
ci_0030                -1.053178e-02 3 1  ON 29
ci_0031                 1.350228e-02 3 1  ON 30
ci_0032                 1.220818e-02 3 1  ON 31
ci_0033                 7.934602e-03 3 1  ON 32
ci_0034                 8.450660e-03 3 1  ON 33
ci_0035                 4.939146e-03 3 1  ON 34
ci_0036                 5.017927e-03 3 1  ON 35
ci_0037                -1.130904e-02 3 1  ON 36
ci_0038                -1.147840e-02 3 1  ON 37
ci_0039                -4.021090e-03 3 1  ON 38
ci_0040                -4.003156e-03 3 1  ON 39
ci_0041                 9.006748e-03 3 1  ON 40
ci_0042                 8.684297e-03 3 1  ON 41
ci_0043                -1.262290e-02 3 1  ON 42
ci_0044                -1.330557e-02 3 1  ON 43
ci_0045                 1.061913e-02 3 1  ON 44
ci_0046                 1.011755e-02 3 1  ON 45
ci_0047                -3.641346e-03 3 1  ON 46
ci_0048                -3.461293e-03 3 1  ON 47
ci_0049                -2.559767e-03 3 1  ON 48
ci_0050                -2.747133e-03 3 1  ON 49
ci_0051                -1.772125e-03 3 1  ON 50
ci_0052                -2.089641e-03 3 1  ON 51
ci_0053                -3.944195e-03 3 1  ON 52
ci_0054                -3.304695e-03 3 1  ON 53
ci_0055                 2.619797e-03 3 1  ON 54
ci_0056                 2.248583e-03 3 1  ON 55
ci_0057                 2.562460e-03 3 1  ON 56
ci_0058                 3.109423e-03 3 1  ON 57
ci_0059                -3.381511e-03 3 1  ON 58
ci_0060                -3.211968e-03 3 1  ON 59
ci_0061                -3.938174e-03 3 1  ON 60
ci_0062                -3.924356e-03 3 1  ON 61
ci_0063                -9.981124e-03 3 1  ON 62
ci_0064                -9.383241e-03 3 1  ON 63
ci_0065                -6.429500e-03 3 1  ON 64
ci_0066                -6.195510e-03 3 1  ON 65
ci_0067                -3.652880e-03 3 1  ON 66
ci_0068                -3.441300e-03 3 1  ON 67
ci_0069                 3.743393e-03 3 1  ON 68
ci_0070                 3.478192e-03 3 1  ON 69
ci_0071                 2.979148e-03 3 1  ON 70
ci_0072                 3.526877e-03 3 1  ON 71
ci_0073                 3.582619e-03 3 1  ON 72
ci_0074                 3.564593e-03 3 1  ON 73
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 4.0628e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s007 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s007 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=7  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6898e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 7
    time step          = 0.05
    reference energy   = -16.8854
    reference variance = 0.266021
====================================================
  Execution time = 1.4399e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s007
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5224e+04
  VMC Eavg = -1.6899e+01
  VMC Evar = 2.9354e-01
  Total weights = 1.950835674e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 2.6076e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.282894823612
                                         uncertainty =       0.001743645368

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.282894823612
                                         uncertainty =       0.001743645368

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000376078587
  error estimate for blocks of size 2^( 2) =       0.000392829146
  error estimate for blocks of size 2^( 3) =       0.000409879256
  error estimate for blocks of size 2^( 4) =       0.000424599629
  error estimate for blocks of size 2^( 5) =       0.000436560883
  error estimate for blocks of size 2^( 6) =       0.000443790515
  error estimate for blocks of size 2^( 7) =       0.000446512367

      target function =      -0.922824074889
              le_mean =     -16.898974850673
             les_mean =     285.868892486963
             stat err =       0.000437865848
             autocorr =       1.355579320678
   target nu stat err =       0.000437865848
   target dn stat err =       0.002718435650
      target stat err =       0.004312201108
              std dev =       0.531855437663
             le_variance =       0.282870206572


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.689897485067e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 74
Check correct_vf_var_size: 225, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.5625e+00, overlap shift 1.5625e+01 and omega -1.7444e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.922842908443       residual = 1.74e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.922888669394       residual = 1.73e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.922892416733       residual = 3.97e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.922894457180       residual = 2.31e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.922895264914       residual = 8.70e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.922895794760       residual = 2.67e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.922895819463       residual = 1.04e-05           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.922895859899       residual = 2.17e-06           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.922895958064       residual = 1.16e-06           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.922895974423       residual = 5.90e-07           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.922895963867       residual = 2.23e-07           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.922895977977       residual = 1.72e-07           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.922895992774       residual = 2.03e-07           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.922895982889       residual = 1.40e-07           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.922895972530       residual = 7.19e-08           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.922895970782       residual = 3.48e-08           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.922895972295       residual = 1.61e-08           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.922895974113       residual = 4.31e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         17 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 1.5625e+00 is 1.796488e-04

solving harmonic davidson linear method for identity shift 6.2500e+00, overlap shift 6.2500e+01 and omega -1.7444e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.922842908443       residual = 1.74e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.922854780751       residual = 1.72e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.922855748367       residual = 3.92e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.922856268824       residual = 2.26e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.922856472529       residual = 8.38e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.922856605594       residual = 2.52e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.922856611073       residual = 9.73e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.922856620871       residual = 2.03e-06           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.922856645452       residual = 1.09e-06           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.922856649404       residual = 5.46e-07           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.922856646699       residual = 2.07e-07           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.922856650170       residual = 1.64e-07           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.922856653796       residual = 1.93e-07           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.922856651171       residual = 1.26e-07           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.922856648677       residual = 6.14e-08           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.922856648274       residual = 2.96e-08           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.922856648660       residual = 1.32e-08           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.922856649081       residual = 3.40e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         17 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 6.2500e+00 is 4.662101e-05

solving harmonic davidson linear method for identity shift 2.5000e+01, overlap shift 2.5000e+02 and omega -1.7444e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.922842908443       residual = 1.74e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.922845904810       residual = 1.72e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.922846148717       residual = 3.91e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.922846279488       residual = 2.24e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.922846330521       residual = 8.30e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.922846363821       residual = 2.49e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.922846365145       residual = 9.57e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.922846367574       residual = 1.99e-06           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.922846373721       residual = 1.07e-06           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.922846374700       residual = 5.35e-07           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.922846374020       residual = 2.03e-07           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.922846374883       residual = 1.62e-07           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.922846375785       residual = 1.90e-07           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.922846375119       residual = 1.23e-07           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.922846374502       residual = 5.89e-08           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.922846374403       residual = 2.84e-08           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.922846374500       residual = 1.25e-08           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.922846374604       residual = 3.20e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         17 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 2.5000e+01 is 1.176718e-05

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.219630 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 75 and numParams is: 74

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.7022e+01
  </log>
  <optVariables href="H2O.s007.opt.xml">
ci_0001                 7.083272e-01 3 1  ON 0
ci_0002                 6.930075e-01 3 1  ON 1
ci_0003                -3.110110e-02 3 1  ON 2
ci_0004                -3.020259e-02 3 1  ON 3
ci_0005                -3.055294e-02 3 1  ON 4
ci_0006                -3.071712e-02 3 1  ON 5
ci_0007                -1.354030e-02 3 1  ON 6
ci_0008                -1.346034e-02 3 1  ON 7
ci_0009                -1.877807e-02 3 1  ON 8
ci_0010                -1.811739e-02 3 1  ON 9
ci_0011                -1.471723e-02 3 1  ON 10
ci_0012                -1.459789e-02 3 1  ON 11
ci_0013                 1.527214e-02 3 1  ON 12
ci_0014                 1.482861e-02 3 1  ON 13
ci_0015                 1.589114e-02 3 1  ON 14
ci_0016                 1.545602e-02 3 1  ON 15
ci_0017                 1.344413e-02 3 1  ON 16
ci_0018                 1.317200e-02 3 1  ON 17
ci_0019                 1.302470e-02 3 1  ON 18
ci_0020                 1.260823e-02 3 1  ON 19
ci_0021                 7.449374e-03 3 1  ON 20
ci_0022                 8.028884e-03 3 1  ON 21
ci_0023                -1.180226e-02 3 1  ON 22
ci_0024                -1.134278e-02 3 1  ON 23
ci_0025                -1.998101e-03 3 1  ON 24
ci_0026                -2.695069e-03 3 1  ON 25
ci_0027                -1.208041e-02 3 1  ON 26
ci_0028                -1.156638e-02 3 1  ON 27
ci_0029                -1.057773e-02 3 1  ON 28
ci_0030                -1.053029e-02 3 1  ON 29
ci_0031                 1.349919e-02 3 1  ON 30
ci_0032                 1.220513e-02 3 1  ON 31
ci_0033                 7.920974e-03 3 1  ON 32
ci_0034                 8.441273e-03 3 1  ON 33
ci_0035                 4.913666e-03 3 1  ON 34
ci_0036                 4.994191e-03 3 1  ON 35
ci_0037                -1.130538e-02 3 1  ON 36
ci_0038                -1.147458e-02 3 1  ON 37
ci_0039                -4.023903e-03 3 1  ON 38
ci_0040                -3.998686e-03 3 1  ON 39
ci_0041                 9.011136e-03 3 1  ON 40
ci_0042                 8.679138e-03 3 1  ON 41
ci_0043                -1.263993e-02 3 1  ON 42
ci_0044                -1.332043e-02 3 1  ON 43
ci_0045                 1.061417e-02 3 1  ON 44
ci_0046                 1.011805e-02 3 1  ON 45
ci_0047                -3.637967e-03 3 1  ON 46
ci_0048                -3.459680e-03 3 1  ON 47
ci_0049                -2.563996e-03 3 1  ON 48
ci_0050                -2.700512e-03 3 1  ON 49
ci_0051                -1.762566e-03 3 1  ON 50
ci_0052                -2.082614e-03 3 1  ON 51
ci_0053                -3.943072e-03 3 1  ON 52
ci_0054                -3.309696e-03 3 1  ON 53
ci_0055                 2.602683e-03 3 1  ON 54
ci_0056                 2.249753e-03 3 1  ON 55
ci_0057                 2.561014e-03 3 1  ON 56
ci_0058                 3.097515e-03 3 1  ON 57
ci_0059                -3.372854e-03 3 1  ON 58
ci_0060                -3.214535e-03 3 1  ON 59
ci_0061                -3.938709e-03 3 1  ON 60
ci_0062                -3.922409e-03 3 1  ON 61
ci_0063                -9.970391e-03 3 1  ON 62
ci_0064                -9.388838e-03 3 1  ON 63
ci_0065                -6.426016e-03 3 1  ON 64
ci_0066                -6.192719e-03 3 1  ON 65
ci_0067                -3.658861e-03 3 1  ON 66
ci_0068                -3.448837e-03 3 1  ON 67
ci_0069                 3.734842e-03 3 1  ON 68
ci_0070                 3.474707e-03 3 1  ON 69
ci_0071                 2.979859e-03 3 1  ON 70
ci_0072                 3.550176e-03 3 1  ON 71
ci_0073                 3.577121e-03 3 1  ON 72
ci_0074                 3.559233e-03 3 1  ON 73
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 7
    time step          = 0.05
    reference energy   = -16.8843
    reference variance = 0.236967
====================================================
  Execution time = 1.4179e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s007
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6898e+01
  VMC Evar = 2.9158e-01
  Total weights = 1.9512e+06
  Execution time = 1.9067e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.281153822188
                                         uncertainty =       0.001750378452

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.281153822188
                                         uncertainty =       0.001750378452

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000374974923
  error estimate for blocks of size 2^( 2) =       0.000391630545
  error estimate for blocks of size 2^( 3) =       0.000408609245
  error estimate for blocks of size 2^( 4) =       0.000423338605
  error estimate for blocks of size 2^( 5) =       0.000434589754
  error estimate for blocks of size 2^( 6) =       0.000440327310
  error estimate for blocks of size 2^( 7) =       0.000445876511

      target function =      -0.925228286162
              le_mean =     -16.897736679382
             les_mean =     285.825500127226
             stat err =       0.000436033045
             autocorr =       1.352179535616
   target nu stat err =       0.000436033045
   target dn stat err =       0.002581282844
      target stat err =       0.004112372510
              std dev =       0.530294621121
             le_variance =       0.281212385190

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.281136615026
                                         uncertainty =       0.001748566384

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.281136615026
                                         uncertainty =       0.001748566384

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000374963588
  error estimate for blocks of size 2^( 2) =       0.000391623065
  error estimate for blocks of size 2^( 3) =       0.000408605777
  error estimate for blocks of size 2^( 4) =       0.000423337097
  error estimate for blocks of size 2^( 5) =       0.000434588263
  error estimate for blocks of size 2^( 6) =       0.000440325094
  error estimate for blocks of size 2^( 7) =       0.000445870651

      target function =      -0.925861007808
              le_mean =     -16.897738271857
             les_mean =     285.825150864781
             stat err =       0.000436030276
             autocorr =       1.352244110645
   target nu stat err =       0.000436030276
   target dn stat err =       0.002540535106
      target stat err =       0.004055022538
              std dev =       0.530278591865
             le_variance =       0.281195384990

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.281144494361
                                         uncertainty =       0.001749431837

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.281144494361
                                         uncertainty =       0.001749431837

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000374968776
  error estimate for blocks of size 2^( 2) =       0.000391626422
  error estimate for blocks of size 2^( 3) =       0.000408607221
  error estimate for blocks of size 2^( 4) =       0.000423337586
  error estimate for blocks of size 2^( 5) =       0.000434588689
  error estimate for blocks of size 2^( 6) =       0.000440325857
  error estimate for blocks of size 2^( 7) =       0.000445873116

      target function =      -0.925850815846
              le_mean =     -16.897737444193
             les_mean =     285.825129341892
             stat err =       0.000436031312
             autocorr =       1.352213119694
   target nu stat err =       0.000436031312
   target dn stat err =       0.002544567616
      target stat err =       0.004061151761
              std dev =       0.530285928010
             le_variance =       0.281203165445

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.281152591166
                                         uncertainty =       0.001750258117

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.281152591166
                                         uncertainty =       0.001750258117

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000374974111
  error estimate for blocks of size 2^( 2) =       0.000391629995
  error estimate for blocks of size 2^( 3) =       0.000408608958
  error estimate for blocks of size 2^( 4) =       0.000423338452
  error estimate for blocks of size 2^( 5) =       0.000434589573
  error estimate for blocks of size 2^( 6) =       0.000440327122
  error estimate for blocks of size 2^( 7) =       0.000445876117

      target function =      -0.925857787688
              le_mean =     -16.897736753152
             les_mean =     285.825101500702
             stat err =       0.000436032816
             autocorr =       1.352183969891
   target nu stat err =       0.000436032816
   target dn stat err =       0.002548770492
      target stat err =       0.004067693412
              std dev =       0.530293473319
             le_variance =       0.281211167844


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.925228286162        initial
     1.5625e+00     1.5625e+01             1.7965e-04        -0.925861007808  <--
     6.2500e+00     6.2500e+01             4.6621e-05        -0.925850815846
     2.5000e+01     2.5000e+02             1.1767e-05        -0.925857787688

*****************************************************************************
Applying the update for shift_i =   1.5625e+00     and shift_s =   1.5625e+01
*****************************************************************************

  Execution time = 2.3694e+01
  </log>
  <optVariables href="H2O.s007.opt.xml">
ci_0001                 7.083128e-01 3 1  ON 0
ci_0002                 6.930256e-01 3 1  ON 1
ci_0003                -3.106812e-02 3 1  ON 2
ci_0004                -3.018094e-02 3 1  ON 3
ci_0005                -3.052611e-02 3 1  ON 4
ci_0006                -3.078052e-02 3 1  ON 5
ci_0007                -1.353348e-02 3 1  ON 6
ci_0008                -1.352155e-02 3 1  ON 7
ci_0009                -1.877923e-02 3 1  ON 8
ci_0010                -1.812354e-02 3 1  ON 9
ci_0011                -1.474152e-02 3 1  ON 10
ci_0012                -1.460707e-02 3 1  ON 11
ci_0013                 1.525725e-02 3 1  ON 12
ci_0014                 1.481674e-02 3 1  ON 13
ci_0015                 1.589013e-02 3 1  ON 14
ci_0016                 1.544430e-02 3 1  ON 15
ci_0017                 1.343234e-02 3 1  ON 16
ci_0018                 1.315176e-02 3 1  ON 17
ci_0019                 1.303385e-02 3 1  ON 18
ci_0020                 1.262912e-02 3 1  ON 19
ci_0021                 7.366628e-03 3 1  ON 20
ci_0022                 7.935523e-03 3 1  ON 21
ci_0023                -1.178740e-02 3 1  ON 22
ci_0024                -1.136621e-02 3 1  ON 23
ci_0025                -2.052022e-03 3 1  ON 24
ci_0026                -2.688485e-03 3 1  ON 25
ci_0027                -1.209268e-02 3 1  ON 26
ci_0028                -1.158014e-02 3 1  ON 27
ci_0029                -1.057212e-02 3 1  ON 28
ci_0030                -1.052605e-02 3 1  ON 29
ci_0031                 1.349012e-02 3 1  ON 30
ci_0032                 1.219628e-02 3 1  ON 31
ci_0033                 7.881355e-03 3 1  ON 32
ci_0034                 8.414022e-03 3 1  ON 33
ci_0035                 4.840768e-03 3 1  ON 34
ci_0036                 4.926402e-03 3 1  ON 35
ci_0037                -1.129480e-02 3 1  ON 36
ci_0038                -1.146354e-02 3 1  ON 37
ci_0039                -4.031960e-03 3 1  ON 38
ci_0040                -3.985893e-03 3 1  ON 39
ci_0041                 9.023791e-03 3 1  ON 40
ci_0042                 8.664256e-03 3 1  ON 41
ci_0043                -1.268948e-02 3 1  ON 42
ci_0044                -1.336362e-02 3 1  ON 43
ci_0045                 1.059973e-02 3 1  ON 44
ci_0046                 1.011948e-02 3 1  ON 45
ci_0047                -3.628285e-03 3 1  ON 46
ci_0048                -3.455064e-03 3 1  ON 47
ci_0049                -2.576089e-03 3 1  ON 48
ci_0050                -2.567484e-03 3 1  ON 49
ci_0051                -1.735311e-03 3 1  ON 50
ci_0052                -2.062576e-03 3 1  ON 51
ci_0053                -3.939854e-03 3 1  ON 52
ci_0054                -3.323966e-03 3 1  ON 53
ci_0055                 2.553830e-03 3 1  ON 54
ci_0056                 2.253089e-03 3 1  ON 55
ci_0057                 2.556954e-03 3 1  ON 56
ci_0058                 3.063460e-03 3 1  ON 57
ci_0059                -3.348118e-03 3 1  ON 58
ci_0060                -3.221856e-03 3 1  ON 59
ci_0061                -3.940281e-03 3 1  ON 60
ci_0062                -3.916830e-03 3 1  ON 61
ci_0063                -9.939492e-03 3 1  ON 62
ci_0064                -9.404936e-03 3 1  ON 63
ci_0065                -6.415977e-03 3 1  ON 64
ci_0066                -6.184700e-03 3 1  ON 65
ci_0067                -3.675961e-03 3 1  ON 66
ci_0068                -3.470343e-03 3 1  ON 67
ci_0069                 3.710411e-03 3 1  ON 68
ci_0070                 3.464753e-03 3 1  ON 69
ci_0071                 2.981892e-03 3 1  ON 70
ci_0072                 3.616751e-03 3 1  ON 71
ci_0073                 3.561420e-03 3 1  ON 72
ci_0074                 3.543931e-03 3 1  ON 73
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 4.0724e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s008 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s008 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=8  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6896e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 8
    time step          = 0.05
    reference energy   = -17.0154
    reference variance = 0.609399
====================================================
  Execution time = 1.4439e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s008
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5245e+04
  VMC Eavg = -1.6899e+01
  VMC Evar = 2.9319e-01
  Total weights = 1.950943211e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 2.6234e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.283562759687
                                         uncertainty =       0.001697954074

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.283562759687
                                         uncertainty =       0.001697954074

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000376526445
  error estimate for blocks of size 2^( 2) =       0.000393212710
  error estimate for blocks of size 2^( 3) =       0.000410801657
  error estimate for blocks of size 2^( 4) =       0.000425880955
  error estimate for blocks of size 2^( 5) =       0.000437125567
  error estimate for blocks of size 2^( 6) =       0.000443736285
  error estimate for blocks of size 2^( 7) =       0.000446305951

      target function =      -0.923392547233
              le_mean =     -16.899440393850
             les_mean =     285.884271686738
             stat err =       0.000438262190
             autocorr =       1.354805779521
   target nu stat err =       0.000438262190
   target dn stat err =       0.002091342481
      target stat err =       0.003358120577
              std dev =       0.532488804955
             le_variance =       0.283544327402


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.689944039385e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 74
Check correct_vf_var_size: 225, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 3.9062e-01, overlap shift 3.9062e+00 and omega -1.7444e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.923403428743       residual = 5.34e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.923453162370       residual = 8.17e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.923462613276       residual = 2.87e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.923467530716       residual = 1.79e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.923469846571       residual = 8.06e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.923471187695       residual = 3.13e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.923471252912       residual = 1.20e-05           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.923471280849       residual = 1.08e-05           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.923471375382       residual = 1.32e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.923471735591       residual = 1.45e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.923472192194       residual = 6.78e-06           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.923472351584       residual = 5.08e-06           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.923472556147       residual = 2.24e-06           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.923472742218       residual = 8.36e-07           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.923472779182       residual = 2.77e-07           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.923472775207       residual = 8.13e-08           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.923472790609       residual = 2.25e-08           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.923472782860       residual = 1.10e-08           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.923472781577       residual = 3.45e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         18 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 3.9062e-01 is 5.340382e-04

solving harmonic davidson linear method for identity shift 1.5625e+00, overlap shift 1.5625e+01 and omega -1.7444e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.923403428743       residual = 5.34e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.923417617642       residual = 7.96e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.923420227046       residual = 2.70e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.923421548880       residual = 1.64e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.923422150352       residual = 7.21e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.923422472582       residual = 2.64e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.923422483066       residual = 1.04e-05           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.923422489532       residual = 9.57e-06           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.923422517455       residual = 1.13e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.923422614711       residual = 1.16e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.923422723393       residual = 5.07e-06           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.923422757354       residual = 3.44e-06           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.923422798315       residual = 1.33e-06           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.923422833914       residual = 4.42e-07           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.923422839557       residual = 1.38e-07           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.923422838547       residual = 3.98e-08           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.923422841002       residual = 1.06e-08           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.923422839249       residual = 4.99e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         17 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 1.5625e+00 is 1.336976e-04

solving harmonic davidson linear method for identity shift 6.2500e+00, overlap shift 6.2500e+01 and omega -1.7444e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.923403428743       residual = 5.34e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.923407105751       residual = 7.90e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.923407775438       residual = 2.64e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.923408112035       residual = 1.60e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.923408263627       residual = 6.98e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.923408342977       residual = 2.52e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.923408345192       residual = 9.94e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.923408346799       residual = 9.26e-06           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.923408354126       residual = 1.08e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.923408378897       residual = 1.08e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.923408405550       residual = 4.65e-06           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.923408413599       residual = 3.06e-06           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.923408423164       residual = 1.14e-06           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.923408431381       residual = 3.68e-07           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.923408432598       residual = 1.13e-07           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.923408432354       residual = 3.24e-08           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.923408432888       residual = 8.52e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         16 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 6.2500e+00 is 3.342739e-05

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.230050 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 75 and numParams is: 74

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.7078e+01
  </log>
  <optVariables href="H2O.s008.opt.xml">
ci_0001                 7.084438e-01 3 1  ON 0
ci_0002                 6.928919e-01 3 1  ON 1
ci_0003                -3.107738e-02 3 1  ON 2
ci_0004                -3.019117e-02 3 1  ON 3
ci_0005                -3.057566e-02 3 1  ON 4
ci_0006                -3.079110e-02 3 1  ON 5
ci_0007                -1.351349e-02 3 1  ON 6
ci_0008                -1.343436e-02 3 1  ON 7
ci_0009                -1.871293e-02 3 1  ON 8
ci_0010                -1.814830e-02 3 1  ON 9
ci_0011                -1.473572e-02 3 1  ON 10
ci_0012                -1.461879e-02 3 1  ON 11
ci_0013                 1.524967e-02 3 1  ON 12
ci_0014                 1.479540e-02 3 1  ON 13
ci_0015                 1.589388e-02 3 1  ON 14
ci_0016                 1.542110e-02 3 1  ON 15
ci_0017                 1.342240e-02 3 1  ON 16
ci_0018                 1.311908e-02 3 1  ON 17
ci_0019                 1.305440e-02 3 1  ON 18
ci_0020                 1.263593e-02 3 1  ON 19
ci_0021                 7.250020e-03 3 1  ON 20
ci_0022                 7.969005e-03 3 1  ON 21
ci_0023                -1.177803e-02 3 1  ON 22
ci_0024                -1.139717e-02 3 1  ON 23
ci_0025                -2.040302e-03 3 1  ON 24
ci_0026                -2.630333e-03 3 1  ON 25
ci_0027                -1.212219e-02 3 1  ON 26
ci_0028                -1.156732e-02 3 1  ON 27
ci_0029                -1.057325e-02 3 1  ON 28
ci_0030                -1.051230e-02 3 1  ON 29
ci_0031                 1.347008e-02 3 1  ON 30
ci_0032                 1.220032e-02 3 1  ON 31
ci_0033                 7.901250e-03 3 1  ON 32
ci_0034                 8.367941e-03 3 1  ON 33
ci_0035                 4.842357e-03 3 1  ON 34
ci_0036                 4.922609e-03 3 1  ON 35
ci_0037                -1.132514e-02 3 1  ON 36
ci_0038                -1.147833e-02 3 1  ON 37
ci_0039                -4.022913e-03 3 1  ON 38
ci_0040                -3.952727e-03 3 1  ON 39
ci_0041                 9.060459e-03 3 1  ON 40
ci_0042                 8.663873e-03 3 1  ON 41
ci_0043                -1.276208e-02 3 1  ON 42
ci_0044                -1.344907e-02 3 1  ON 43
ci_0045                 1.060250e-02 3 1  ON 44
ci_0046                 1.010078e-02 3 1  ON 45
ci_0047                -3.604201e-03 3 1  ON 46
ci_0048                -3.461372e-03 3 1  ON 47
ci_0049                -2.562337e-03 3 1  ON 48
ci_0050                -2.622125e-03 3 1  ON 49
ci_0051                -1.723971e-03 3 1  ON 50
ci_0052                -2.058191e-03 3 1  ON 51
ci_0053                -3.913993e-03 3 1  ON 52
ci_0054                -3.311765e-03 3 1  ON 53
ci_0055                 2.570063e-03 3 1  ON 54
ci_0056                 2.233313e-03 3 1  ON 55
ci_0057                 2.560376e-03 3 1  ON 56
ci_0058                 3.077821e-03 3 1  ON 57
ci_0059                -3.355020e-03 3 1  ON 58
ci_0060                -3.211321e-03 3 1  ON 59
ci_0061                -3.954437e-03 3 1  ON 60
ci_0062                -3.946956e-03 3 1  ON 61
ci_0063                -9.902167e-03 3 1  ON 62
ci_0064                -9.358459e-03 3 1  ON 63
ci_0065                -6.421801e-03 3 1  ON 64
ci_0066                -6.181816e-03 3 1  ON 65
ci_0067                -3.678446e-03 3 1  ON 66
ci_0068                -3.452549e-03 3 1  ON 67
ci_0069                 3.690203e-03 3 1  ON 68
ci_0070                 3.453772e-03 3 1  ON 69
ci_0071                 3.027376e-03 3 1  ON 70
ci_0072                 3.582052e-03 3 1  ON 71
ci_0073                 3.509425e-03 3 1  ON 72
ci_0074                 3.532549e-03 3 1  ON 73
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 8
    time step          = 0.05
    reference energy   = -16.9424
    reference variance = 0.217227
====================================================
  Execution time = 1.4038e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s008
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6899e+01
  VMC Evar = 2.9411e-01
  Total weights = 1.9512e+06
  Execution time = 1.8920e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.282107964318
                                         uncertainty =       0.001753541095

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.282107964318
                                         uncertainty =       0.001753541095

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000375551519
  error estimate for blocks of size 2^( 2) =       0.000392911908
  error estimate for blocks of size 2^( 3) =       0.000410266841
  error estimate for blocks of size 2^( 4) =       0.000425526241
  error estimate for blocks of size 2^( 5) =       0.000437179652
  error estimate for blocks of size 2^( 6) =       0.000444311518
  error estimate for blocks of size 2^( 7) =       0.000447998379

      target function =      -0.921843900805
              le_mean =     -16.898729364085
             les_mean =     285.861220696215
             stat err =       0.000438753948
             autocorr =       1.364906900152
   target nu stat err =       0.000438753948
   target dn stat err =       0.002882686682
      target stat err =       0.004553899240
              std dev =       0.531110051033
             le_variance =       0.282077886308

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.282058865439
                                         uncertainty =       0.001750112932

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.282058865439
                                         uncertainty =       0.001750112932

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000375519182
  error estimate for blocks of size 2^( 2) =       0.000392884362
  error estimate for blocks of size 2^( 3) =       0.000410240744
  error estimate for blocks of size 2^( 4) =       0.000425494725
  error estimate for blocks of size 2^( 5) =       0.000437149466
  error estimate for blocks of size 2^( 6) =       0.000444275427
  error estimate for blocks of size 2^( 7) =       0.000447969811

      target function =      -0.921715765660
              le_mean =     -16.898732212194
             les_mean =     285.861398856981
             stat err =       0.000438722357
             autocorr =       1.364945401899
   target nu stat err =       0.000438722357
   target dn stat err =       0.002916919425
      target stat err =       0.004605305369
              std dev =       0.531064320501
             le_variance =       0.282029312509

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.282076689548
                                         uncertainty =       0.001751361545

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.282076689548
                                         uncertainty =       0.001751361545

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000375530897
  error estimate for blocks of size 2^( 2) =       0.000392894049
  error estimate for blocks of size 2^( 3) =       0.000410249996
  error estimate for blocks of size 2^( 4) =       0.000425506629
  error estimate for blocks of size 2^( 5) =       0.000437160880
  error estimate for blocks of size 2^( 6) =       0.000444289466
  error estimate for blocks of size 2^( 7) =       0.000447980585

      target function =      -0.921884588150
              le_mean =     -16.898730505377
             les_mean =     285.861233036016
             stat err =       0.000438734390
             autocorr =       1.364935116270
   target nu stat err =       0.000438734390
   target dn stat err =       0.002896349940
      target stat err =       0.004575315995
              std dev =       0.531080886985
             le_variance =       0.282046908520

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.282103484984
                                         uncertainty =       0.001753241494

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.282103484984
                                         uncertainty =       0.001753241494

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000375548562
  error estimate for blocks of size 2^( 2) =       0.000392909319
  error estimate for blocks of size 2^( 3) =       0.000410264400
  error estimate for blocks of size 2^( 4) =       0.000425523461
  error estimate for blocks of size 2^( 5) =       0.000437176984
  error estimate for blocks of size 2^( 6) =       0.000444308404
  error estimate for blocks of size 2^( 7) =       0.000447995814

      target function =      -0.921882089682
              le_mean =     -16.898729451234
             les_mean =     285.861199128153
             stat err =       0.000438751166
             autocorr =       1.364911079817
   target nu stat err =       0.000438751166
   target dn stat err =       0.002883943001
      target stat err =       0.004556203778
              std dev =       0.531105870186
             le_variance =       0.282073445346


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.921843900805        initial
     3.9062e-01     3.9062e+00             5.3404e-04        -0.921715765660
     1.5625e+00     1.5625e+01             1.3370e-04        -0.921884588150  <--
     6.2500e+00     6.2500e+01             3.3427e-05        -0.921882089682

*****************************************************************************
Applying the update for shift_i =   1.5625e+00     and shift_s =   1.5625e+01
*****************************************************************************

  Execution time = 2.3535e+01
  </log>
  <optVariables href="H2O.s008.opt.xml">
ci_0001                 7.084438e-01 3 1  ON 0
ci_0002                 6.928919e-01 3 1  ON 1
ci_0003                -3.107738e-02 3 1  ON 2
ci_0004                -3.019117e-02 3 1  ON 3
ci_0005                -3.057566e-02 3 1  ON 4
ci_0006                -3.079110e-02 3 1  ON 5
ci_0007                -1.351349e-02 3 1  ON 6
ci_0008                -1.343436e-02 3 1  ON 7
ci_0009                -1.871293e-02 3 1  ON 8
ci_0010                -1.814830e-02 3 1  ON 9
ci_0011                -1.473572e-02 3 1  ON 10
ci_0012                -1.461879e-02 3 1  ON 11
ci_0013                 1.524967e-02 3 1  ON 12
ci_0014                 1.479540e-02 3 1  ON 13
ci_0015                 1.589388e-02 3 1  ON 14
ci_0016                 1.542110e-02 3 1  ON 15
ci_0017                 1.342240e-02 3 1  ON 16
ci_0018                 1.311908e-02 3 1  ON 17
ci_0019                 1.305440e-02 3 1  ON 18
ci_0020                 1.263593e-02 3 1  ON 19
ci_0021                 7.250020e-03 3 1  ON 20
ci_0022                 7.969005e-03 3 1  ON 21
ci_0023                -1.177803e-02 3 1  ON 22
ci_0024                -1.139717e-02 3 1  ON 23
ci_0025                -2.040302e-03 3 1  ON 24
ci_0026                -2.630333e-03 3 1  ON 25
ci_0027                -1.212219e-02 3 1  ON 26
ci_0028                -1.156732e-02 3 1  ON 27
ci_0029                -1.057325e-02 3 1  ON 28
ci_0030                -1.051230e-02 3 1  ON 29
ci_0031                 1.347008e-02 3 1  ON 30
ci_0032                 1.220032e-02 3 1  ON 31
ci_0033                 7.901250e-03 3 1  ON 32
ci_0034                 8.367941e-03 3 1  ON 33
ci_0035                 4.842357e-03 3 1  ON 34
ci_0036                 4.922609e-03 3 1  ON 35
ci_0037                -1.132514e-02 3 1  ON 36
ci_0038                -1.147833e-02 3 1  ON 37
ci_0039                -4.022913e-03 3 1  ON 38
ci_0040                -3.952727e-03 3 1  ON 39
ci_0041                 9.060459e-03 3 1  ON 40
ci_0042                 8.663873e-03 3 1  ON 41
ci_0043                -1.276208e-02 3 1  ON 42
ci_0044                -1.344907e-02 3 1  ON 43
ci_0045                 1.060250e-02 3 1  ON 44
ci_0046                 1.010078e-02 3 1  ON 45
ci_0047                -3.604201e-03 3 1  ON 46
ci_0048                -3.461372e-03 3 1  ON 47
ci_0049                -2.562337e-03 3 1  ON 48
ci_0050                -2.622125e-03 3 1  ON 49
ci_0051                -1.723971e-03 3 1  ON 50
ci_0052                -2.058191e-03 3 1  ON 51
ci_0053                -3.913993e-03 3 1  ON 52
ci_0054                -3.311765e-03 3 1  ON 53
ci_0055                 2.570063e-03 3 1  ON 54
ci_0056                 2.233313e-03 3 1  ON 55
ci_0057                 2.560376e-03 3 1  ON 56
ci_0058                 3.077821e-03 3 1  ON 57
ci_0059                -3.355020e-03 3 1  ON 58
ci_0060                -3.211321e-03 3 1  ON 59
ci_0061                -3.954437e-03 3 1  ON 60
ci_0062                -3.946956e-03 3 1  ON 61
ci_0063                -9.902167e-03 3 1  ON 62
ci_0064                -9.358459e-03 3 1  ON 63
ci_0065                -6.421801e-03 3 1  ON 64
ci_0066                -6.181816e-03 3 1  ON 65
ci_0067                -3.678446e-03 3 1  ON 66
ci_0068                -3.452549e-03 3 1  ON 67
ci_0069                 3.690203e-03 3 1  ON 68
ci_0070                 3.453772e-03 3 1  ON 69
ci_0071                 3.027376e-03 3 1  ON 70
ci_0072                 3.582052e-03 3 1  ON 71
ci_0073                 3.509425e-03 3 1  ON 72
ci_0074                 3.532549e-03 3 1  ON 73
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 4.0619e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s009 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s009 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=9  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6905e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 9
    time step          = 0.05
    reference energy   = -16.8897
    reference variance = 0.171342
====================================================
  Execution time = 1.4364e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s009
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5238e+04
  VMC Eavg = -1.6899e+01
  VMC Evar = 2.8777e-01
  Total weights = 1.951133965e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 2.6110e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.280826113167
                                         uncertainty =       0.001834996471

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.280826113167
                                         uncertainty =       0.001834996471

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000374667496
  error estimate for blocks of size 2^( 2) =       0.000391655637
  error estimate for blocks of size 2^( 3) =       0.000409013535
  error estimate for blocks of size 2^( 4) =       0.000424891822
  error estimate for blocks of size 2^( 5) =       0.000436853482
  error estimate for blocks of size 2^( 6) =       0.000443694728
  error estimate for blocks of size 2^( 7) =       0.000445911903

      target function =      -0.931941915885
              le_mean =     -16.899323393946
             les_mean =     285.874905392228
             stat err =       0.000437837984
             autocorr =       1.365635614420
   target nu stat err =       0.000437837984
   target dn stat err =       0.002139466325
      target stat err =       0.003493087063
              std dev =       0.529859854749
             le_variance =       0.280751465674


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.689932339395e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 74
Check correct_vf_var_size: 225, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 3.9062e-01, overlap shift 3.9062e+00 and omega -1.7444e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.931953453523       residual = 6.64e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.932029915987       residual = 9.32e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.932043107771       residual = 3.01e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.932048409195       residual = 1.74e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.932051501750       residual = 3.89e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.932052093764       residual = 1.60e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.932052440072       residual = 5.72e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.932052542442       residual = 1.26e-06           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.932052534868       residual = 1.05e-06           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.932052674285       residual = 6.48e-07           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.932052535541       residual = 7.12e-07           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.932052507784       residual = 4.26e-07           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.932052471526       residual = 4.65e-07           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.932052531082       residual = 2.16e-07           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.932052527399       residual = 6.06e-08           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.932052525656       residual = 1.40e-08           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.932052534828       residual = 7.15e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         16 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 3.9062e-01 is 5.121739e-04

solving harmonic davidson linear method for identity shift 1.5625e+00, overlap shift 1.5625e+01 and omega -1.7444e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.931953453523       residual = 6.64e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.931975305266       residual = 9.14e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.931978999845       residual = 2.84e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.931980415276       residual = 1.60e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.931981218922       residual = 3.45e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.931981360998       residual = 1.35e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.931981444523       residual = 4.67e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.931981470679       residual = 1.03e-06           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.931981467356       residual = 8.90e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.931981501710       residual = 5.53e-07           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.931981464015       residual = 5.77e-07           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.931981458193       residual = 3.34e-07           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.931981451650       residual = 3.11e-07           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.931981465850       residual = 1.24e-07           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.931981464957       residual = 2.98e-08           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.931981464682       residual = 6.86e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         15 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 1.5625e+00 is 1.419488e-04

solving harmonic davidson linear method for identity shift 6.2500e+00, overlap shift 6.2500e+01 and omega -1.7444e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.931953453523       residual = 6.64e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.931959119181       residual = 9.09e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.931960071389       residual = 2.79e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.931960431061       residual = 1.56e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.931960633670       residual = 3.32e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.931960668651       residual = 1.28e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.931960689262       residual = 4.40e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.931960695823       residual = 9.70e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.931960694887       residual = 8.49e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.931960703415       residual = 5.28e-07           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.931960693799       residual = 5.42e-07           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.931960692447       residual = 3.10e-07           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.931960691003       residual = 2.75e-07           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.931960694476       residual = 1.05e-07           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.931960694252       residual = 2.43e-08           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.931960694192       residual = 5.60e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         15 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 6.2500e+00 is 3.680334e-05

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.238690 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 75 and numParams is: 74

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.6989e+01
  </log>
  <optVariables href="H2O.s009.opt.xml">
ci_0001                 7.084077e-01 3 1  ON 0
ci_0002                 6.929334e-01 3 1  ON 1
ci_0003                -3.102622e-02 3 1  ON 2
ci_0004                -3.017430e-02 3 1  ON 3
ci_0005                -3.058531e-02 3 1  ON 4
ci_0006                -3.074949e-02 3 1  ON 5
ci_0007                -1.354502e-02 3 1  ON 6
ci_0008                -1.342095e-02 3 1  ON 7
ci_0009                -1.874928e-02 3 1  ON 8
ci_0010                -1.815540e-02 3 1  ON 9
ci_0011                -1.474321e-02 3 1  ON 10
ci_0012                -1.461346e-02 3 1  ON 11
ci_0013                 1.524811e-02 3 1  ON 12
ci_0014                 1.481487e-02 3 1  ON 13
ci_0015                 1.585641e-02 3 1  ON 14
ci_0016                 1.541581e-02 3 1  ON 15
ci_0017                 1.342570e-02 3 1  ON 16
ci_0018                 1.308030e-02 3 1  ON 17
ci_0019                 1.304730e-02 3 1  ON 18
ci_0020                 1.261693e-02 3 1  ON 19
ci_0021                 7.174206e-03 3 1  ON 20
ci_0022                 7.951385e-03 3 1  ON 21
ci_0023                -1.178540e-02 3 1  ON 22
ci_0024                -1.139942e-02 3 1  ON 23
ci_0025                -2.029395e-03 3 1  ON 24
ci_0026                -2.591033e-03 3 1  ON 25
ci_0027                -1.210535e-02 3 1  ON 26
ci_0028                -1.156703e-02 3 1  ON 27
ci_0029                -1.059989e-02 3 1  ON 28
ci_0030                -1.055043e-02 3 1  ON 29
ci_0031                 1.349082e-02 3 1  ON 30
ci_0032                 1.219722e-02 3 1  ON 31
ci_0033                 7.883253e-03 3 1  ON 32
ci_0034                 8.227995e-03 3 1  ON 33
ci_0035                 4.700408e-03 3 1  ON 34
ci_0036                 4.941437e-03 3 1  ON 35
ci_0037                -1.131348e-02 3 1  ON 36
ci_0038                -1.146022e-02 3 1  ON 37
ci_0039                -4.030816e-03 3 1  ON 38
ci_0040                -3.928205e-03 3 1  ON 39
ci_0041                 9.040684e-03 3 1  ON 40
ci_0042                 8.706294e-03 3 1  ON 41
ci_0043                -1.282607e-02 3 1  ON 42
ci_0044                -1.351487e-02 3 1  ON 43
ci_0045                 1.062030e-02 3 1  ON 44
ci_0046                 1.010843e-02 3 1  ON 45
ci_0047                -3.599388e-03 3 1  ON 46
ci_0048                -3.470398e-03 3 1  ON 47
ci_0049                -2.614030e-03 3 1  ON 48
ci_0050                -2.617034e-03 3 1  ON 49
ci_0051                -1.739478e-03 3 1  ON 50
ci_0052                -2.055711e-03 3 1  ON 51
ci_0053                -3.935443e-03 3 1  ON 52
ci_0054                -3.326200e-03 3 1  ON 53
ci_0055                 2.527181e-03 3 1  ON 54
ci_0056                 2.246888e-03 3 1  ON 55
ci_0057                 2.565375e-03 3 1  ON 56
ci_0058                 3.080466e-03 3 1  ON 57
ci_0059                -3.350602e-03 3 1  ON 58
ci_0060                -3.207701e-03 3 1  ON 59
ci_0061                -3.965883e-03 3 1  ON 60
ci_0062                -3.926962e-03 3 1  ON 61
ci_0063                -9.913158e-03 3 1  ON 62
ci_0064                -9.364591e-03 3 1  ON 63
ci_0065                -6.437993e-03 3 1  ON 64
ci_0066                -6.177837e-03 3 1  ON 65
ci_0067                -3.666125e-03 3 1  ON 66
ci_0068                -3.494687e-03 3 1  ON 67
ci_0069                 3.689952e-03 3 1  ON 68
ci_0070                 3.426166e-03 3 1  ON 69
ci_0071                 2.987831e-03 3 1  ON 70
ci_0072                 3.540989e-03 3 1  ON 71
ci_0073                 3.527183e-03 3 1  ON 72
ci_0074                 3.513500e-03 3 1  ON 73
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 9
    time step          = 0.05
    reference energy   = -16.8897
    reference variance = 0.236024
====================================================
  Execution time = 1.4172e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s009
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6897e+01
  VMC Evar = 2.9363e-01
  Total weights = 1.9509e+06
  Execution time = 1.8839e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.283878856991
                                         uncertainty =       0.002176065639

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.283878856991
                                         uncertainty =       0.002176065639

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000376720368
  error estimate for blocks of size 2^( 2) =       0.000393394772
  error estimate for blocks of size 2^( 3) =       0.000410896019
  error estimate for blocks of size 2^( 4) =       0.000425987864
  error estimate for blocks of size 2^( 5) =       0.000438595003
  error estimate for blocks of size 2^( 6) =       0.000446496326
  error estimate for blocks of size 2^( 7) =       0.000451465601

      target function =      -0.922694898783
              le_mean =     -16.897464320173
             les_mean =     285.817903635325
             stat err =       0.000440636198
             autocorr =       1.368113537074
   target nu stat err =       0.000440636198
   target dn stat err =       0.003617845163
      target stat err =       0.005685220983
              std dev =       0.532763053659
             le_variance =       0.283836471344

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.283874669327
                                         uncertainty =       0.002209805366

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.283874669327
                                         uncertainty =       0.002209805366

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000376717576
  error estimate for blocks of size 2^( 2) =       0.000393384566
  error estimate for blocks of size 2^( 3) =       0.000410883174
  error estimate for blocks of size 2^( 4) =       0.000425967206
  error estimate for blocks of size 2^( 5) =       0.000438562450
  error estimate for blocks of size 2^( 6) =       0.000446463097
  error estimate for blocks of size 2^( 7) =       0.000451430969

      target function =      -0.920498734917
              le_mean =     -16.897463021813
             les_mean =     285.819269929864
             stat err =       0.000440605930
             autocorr =       1.367945864286
   target nu stat err =       0.000440605930
   target dn stat err =       0.003853404241
      target stat err =       0.006020702731
              std dev =       0.532759105191
             le_variance =       0.283832264164

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.283872051683
                                         uncertainty =       0.002194013196

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.283872051683
                                         uncertainty =       0.002194013196

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000376715848
  error estimate for blocks of size 2^( 2) =       0.000393386374
  error estimate for blocks of size 2^( 3) =       0.000410886154
  error estimate for blocks of size 2^( 4) =       0.000425973759
  error estimate for blocks of size 2^( 5) =       0.000438574455
  error estimate for blocks of size 2^( 6) =       0.000446475640
  error estimate for blocks of size 2^( 7) =       0.000451444795

      target function =      -0.915060820608
              le_mean =     -16.897463542021
             les_mean =     285.822785259723
             stat err =       0.000440617162
             autocorr =       1.368028153943
   target nu stat err =       0.000440617162
   target dn stat err =       0.005751408192
      target stat err =       0.008843913525
              std dev =       0.532756662096
             le_variance =       0.283829661008

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.283877421572
                                         uncertainty =       0.002178301102

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.283877421572
                                         uncertainty =       0.002178301102

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000376719415
  error estimate for blocks of size 2^( 2) =       0.000393393321
  error estimate for blocks of size 2^( 3) =       0.000410894422
  error estimate for blocks of size 2^( 4) =       0.000425985738
  error estimate for blocks of size 2^( 5) =       0.000438592071
  error estimate for blocks of size 2^( 6) =       0.000446493315
  error estimate for blocks of size 2^( 7) =       0.000451462610

      target function =      -0.922719518501
              le_mean =     -16.897464148852
             les_mean =     285.817881972448
             stat err =       0.000440633434
             autocorr =       1.368103287011
   target nu stat err =       0.000440633434
   target dn stat err =       0.003623449097
      target stat err =       0.005694176056
              std dev =       0.532761706422
             le_variance =       0.283835035830


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.922694898783        initial
     3.9062e-01     3.9062e+00             5.1217e-04        -0.920498734917
     1.5625e+00     1.5625e+01             1.4195e-04        -0.915060820608
     6.2500e+00     6.2500e+01             3.6803e-05        -0.922719518501  <--

*****************************************************************************
Applying the update for shift_i =   6.2500e+00     and shift_s =   6.2500e+01
*****************************************************************************

  Execution time = 2.3653e+01
  </log>
  <optVariables href="H2O.s009.opt.xml">
ci_0001                 7.084348e-01 3 1  ON 0
ci_0002                 6.929023e-01 3 1  ON 1
ci_0003                -3.106425e-02 3 1  ON 2
ci_0004                -3.018683e-02 3 1  ON 3
ci_0005                -3.057815e-02 3 1  ON 4
ci_0006                -3.078046e-02 3 1  ON 5
ci_0007                -1.352152e-02 3 1  ON 6
ci_0008                -1.343097e-02 3 1  ON 7
ci_0009                -1.872231e-02 3 1  ON 8
ci_0010                -1.815012e-02 3 1  ON 9
ci_0011                -1.473766e-02 3 1  ON 10
ci_0012                -1.461741e-02 3 1  ON 11
ci_0013                 1.524927e-02 3 1  ON 12
ci_0014                 1.480041e-02 3 1  ON 13
ci_0015                 1.588424e-02 3 1  ON 14
ci_0016                 1.541973e-02 3 1  ON 15
ci_0017                 1.342326e-02 3 1  ON 16
ci_0018                 1.310908e-02 3 1  ON 17
ci_0019                 1.305258e-02 3 1  ON 18
ci_0020                 1.263104e-02 3 1  ON 19
ci_0021                 7.230646e-03 3 1  ON 20
ci_0022                 7.964485e-03 3 1  ON 21
ci_0023                -1.177994e-02 3 1  ON 22
ci_0024                -1.139774e-02 3 1  ON 23
ci_0025                -2.037468e-03 3 1  ON 24
ci_0026                -2.620134e-03 3 1  ON 25
ci_0027                -1.211785e-02 3 1  ON 26
ci_0028                -1.156724e-02 3 1  ON 27
ci_0029                -1.058011e-02 3 1  ON 28
ci_0030                -1.052210e-02 3 1  ON 29
ci_0031                 1.347539e-02 3 1  ON 30
ci_0032                 1.219954e-02 3 1  ON 31
ci_0033                 7.896632e-03 3 1  ON 32
ci_0034                 8.332120e-03 3 1  ON 33
ci_0035                 4.805553e-03 3 1  ON 34
ci_0036                 4.927488e-03 3 1  ON 35
ci_0037                -1.132215e-02 3 1  ON 36
ci_0038                -1.147368e-02 3 1  ON 37
ci_0039                -4.024958e-03 3 1  ON 38
ci_0040                -3.946377e-03 3 1  ON 39
ci_0041                 9.055383e-03 3 1  ON 40
ci_0042                 8.674793e-03 3 1  ON 41
ci_0043                -1.277843e-02 3 1  ON 42
ci_0044                -1.346585e-02 3 1  ON 43
ci_0045                 1.060706e-02 3 1  ON 44
ci_0046                 1.010274e-02 3 1  ON 45
ci_0047                -3.602958e-03 3 1  ON 46
ci_0048                -3.463705e-03 3 1  ON 47
ci_0049                -2.575742e-03 3 1  ON 48
ci_0050                -2.620803e-03 3 1  ON 49
ci_0051                -1.728003e-03 3 1  ON 50
ci_0052                -2.057550e-03 3 1  ON 51
ci_0053                -3.919563e-03 3 1  ON 52
ci_0054                -3.315506e-03 3 1  ON 53
ci_0055                 2.558935e-03 3 1  ON 54
ci_0056                 2.236840e-03 3 1  ON 55
ci_0057                 2.561674e-03 3 1  ON 56
ci_0058                 3.078503e-03 3 1  ON 57
ci_0059                -3.353880e-03 3 1  ON 58
ci_0060                -3.210376e-03 3 1  ON 59
ci_0061                -3.957390e-03 3 1  ON 60
ci_0062                -3.941796e-03 3 1  ON 61
ci_0063                -9.905009e-03 3 1  ON 62
ci_0064                -9.360040e-03 3 1  ON 63
ci_0065                -6.425978e-03 3 1  ON 64
ci_0066                -6.180797e-03 3 1  ON 65
ci_0067                -3.675252e-03 3 1  ON 66
ci_0068                -3.463477e-03 3 1  ON 67
ci_0069                 3.690146e-03 3 1  ON 68
ci_0070                 3.446613e-03 3 1  ON 69
ci_0071                 3.017115e-03 3 1  ON 70
ci_0072                 3.571400e-03 3 1  ON 71
ci_0073                 3.514029e-03 3 1  ON 72
ci_0074                 3.527609e-03 3 1  ON 73
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 4.0649e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s010 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s010 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=10  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6904e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 10
    time step          = 0.05
    reference energy   = -16.8351
    reference variance = 0.334729
====================================================
  Execution time = 1.4368e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s010
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5241e+04
  VMC Eavg = -1.6899e+01
  VMC Evar = 2.9011e-01
  Total weights = 1.950702458e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 2.6089e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.280772104020
                                         uncertainty =       0.001680265856

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.280772104020
                                         uncertainty =       0.001680265856

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000374696556
  error estimate for blocks of size 2^( 2) =       0.000391796405
  error estimate for blocks of size 2^( 3) =       0.000409425290
  error estimate for blocks of size 2^( 4) =       0.000425031767
  error estimate for blocks of size 2^( 5) =       0.000436881405
  error estimate for blocks of size 2^( 6) =       0.000444439305
  error estimate for blocks of size 2^( 7) =       0.000447427370

      target function =      -0.928227376123
              le_mean =     -16.898663075340
             les_mean =     285.854919164517
             stat err =       0.000438444962
             autocorr =       1.369212218812
   target nu stat err =       0.000438444962
   target dn stat err =       0.002015932008
      target stat err =       0.003271621819
              std dev =       0.529900950691
             le_variance =       0.280795017543


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.689866307534e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 74
Check correct_vf_var_size: 225, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.5625e+00, overlap shift 1.5625e+01 and omega -1.7444e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.928237421533       residual = 5.23e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.928253127145       residual = 5.02e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.928255110819       residual = 2.06e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.928255740441       residual = 1.36e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.928256138707       residual = 4.46e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.928256383881       residual = 1.60e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.928256430202       residual = 6.51e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.928256466221       residual = 2.45e-06           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.928256477004       residual = 2.05e-06           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.928256498417       residual = 1.88e-06           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.928256518444       residual = 1.13e-06           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.928256541128       residual = 1.10e-06           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.928256601636       residual = 6.30e-07           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.928256604115       residual = 1.66e-07           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.928256615987       residual = 5.38e-08           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.928256621589       residual = 1.64e-08           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.928256622980       residual = 4.70e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         16 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 1.5625e+00 is 7.910251e-05

solving harmonic davidson linear method for identity shift 6.2500e+00, overlap shift 6.2500e+01 and omega -1.7444e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.928237421533       residual = 5.23e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.928241493010       residual = 4.99e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.928242002729       residual = 2.02e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.928242162408       residual = 1.33e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.928242262422       residual = 4.30e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.928242323712       residual = 1.52e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.928242335053       residual = 6.10e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.928242344035       residual = 2.31e-06           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.928242346758       residual = 1.97e-06           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.928242352345       residual = 1.78e-06           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.928242357470       residual = 1.05e-06           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.928242363164       residual = 1.01e-06           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.928242377859       residual = 5.47e-07           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.928242378179       residual = 1.38e-07           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.928242380906       residual = 4.41e-08           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.928242382218       residual = 1.33e-08           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.928242382534       residual = 3.83e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         16 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 6.2500e+00 is 2.022660e-05

solving harmonic davidson linear method for identity shift 2.5000e+01, overlap shift 2.5000e+02 and omega -1.7444e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.928237421533       residual = 5.23e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.928238448892       residual = 4.99e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.928238577213       residual = 2.01e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.928238617274       residual = 1.32e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.928238642302       residual = 4.26e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.928238657621       residual = 1.50e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.928238660441       residual = 6.00e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.928238662685       residual = 2.28e-06           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.928238663367       residual = 1.95e-06           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.928238664780       residual = 1.75e-06           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.928238666068       residual = 1.03e-06           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.928238667492       residual = 9.84e-07           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.928238671137       residual = 5.27e-07           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.928238671199       residual = 1.32e-07           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.928238671865       residual = 4.18e-08           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.928238672188       residual = 1.26e-08           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.928238672265       residual = 3.64e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         16 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 2.5000e+01 is 5.085622e-06

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.247890 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 75 and numParams is: 74

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.6991e+01
  </log>
  <optVariables href="H2O.s010.opt.xml">
ci_0001                 7.084198e-01 3 1  ON 0
ci_0002                 6.929177e-01 3 1  ON 1
ci_0003                -3.106939e-02 3 1  ON 2
ci_0004                -3.017992e-02 3 1  ON 3
ci_0005                -3.059290e-02 3 1  ON 4
ci_0006                -3.078741e-02 3 1  ON 5
ci_0007                -1.350337e-02 3 1  ON 6
ci_0008                -1.343129e-02 3 1  ON 7
ci_0009                -1.871651e-02 3 1  ON 8
ci_0010                -1.815116e-02 3 1  ON 9
ci_0011                -1.474322e-02 3 1  ON 10
ci_0012                -1.461700e-02 3 1  ON 11
ci_0013                 1.524831e-02 3 1  ON 12
ci_0014                 1.479979e-02 3 1  ON 13
ci_0015                 1.587712e-02 3 1  ON 14
ci_0016                 1.541878e-02 3 1  ON 15
ci_0017                 1.342152e-02 3 1  ON 16
ci_0018                 1.310853e-02 3 1  ON 17
ci_0019                 1.305440e-02 3 1  ON 18
ci_0020                 1.261979e-02 3 1  ON 19
ci_0021                 7.212983e-03 3 1  ON 20
ci_0022                 7.950936e-03 3 1  ON 21
ci_0023                -1.178062e-02 3 1  ON 22
ci_0024                -1.139728e-02 3 1  ON 23
ci_0025                -2.052738e-03 3 1  ON 24
ci_0026                -2.603079e-03 3 1  ON 25
ci_0027                -1.211164e-02 3 1  ON 26
ci_0028                -1.157424e-02 3 1  ON 27
ci_0029                -1.058053e-02 3 1  ON 28
ci_0030                -1.052896e-02 3 1  ON 29
ci_0031                 1.348018e-02 3 1  ON 30
ci_0032                 1.219177e-02 3 1  ON 31
ci_0033                 7.890050e-03 3 1  ON 32
ci_0034                 8.352347e-03 3 1  ON 33
ci_0035                 4.810610e-03 3 1  ON 34
ci_0036                 4.940092e-03 3 1  ON 35
ci_0037                -1.132593e-02 3 1  ON 36
ci_0038                -1.147324e-02 3 1  ON 37
ci_0039                -4.026649e-03 3 1  ON 38
ci_0040                -3.944010e-03 3 1  ON 39
ci_0041                 9.050783e-03 3 1  ON 40
ci_0042                 8.674230e-03 3 1  ON 41
ci_0043                -1.277153e-02 3 1  ON 42
ci_0044                -1.348471e-02 3 1  ON 43
ci_0045                 1.060553e-02 3 1  ON 44
ci_0046                 1.010198e-02 3 1  ON 45
ci_0047                -3.601252e-03 3 1  ON 46
ci_0048                -3.463358e-03 3 1  ON 47
ci_0049                -2.583872e-03 3 1  ON 48
ci_0050                -2.616021e-03 3 1  ON 49
ci_0051                -1.730668e-03 3 1  ON 50
ci_0052                -2.056803e-03 3 1  ON 51
ci_0053                -3.922393e-03 3 1  ON 52
ci_0054                -3.316584e-03 3 1  ON 53
ci_0055                 2.568660e-03 3 1  ON 54
ci_0056                 2.243885e-03 3 1  ON 55
ci_0057                 2.553272e-03 3 1  ON 56
ci_0058                 3.069580e-03 3 1  ON 57
ci_0059                -3.351136e-03 3 1  ON 58
ci_0060                -3.214282e-03 3 1  ON 59
ci_0061                -3.963875e-03 3 1  ON 60
ci_0062                -3.949340e-03 3 1  ON 61
ci_0063                -9.897544e-03 3 1  ON 62
ci_0064                -9.353783e-03 3 1  ON 63
ci_0065                -6.421781e-03 3 1  ON 64
ci_0066                -6.176612e-03 3 1  ON 65
ci_0067                -3.676366e-03 3 1  ON 66
ci_0068                -3.449367e-03 3 1  ON 67
ci_0069                 3.685179e-03 3 1  ON 68
ci_0070                 3.444217e-03 3 1  ON 69
ci_0071                 3.013363e-03 3 1  ON 70
ci_0072                 3.567240e-03 3 1  ON 71
ci_0073                 3.506715e-03 3 1  ON 72
ci_0074                 3.533082e-03 3 1  ON 73
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 10
    time step          = 0.05
    reference energy   = -16.8519
    reference variance = 0.217617
====================================================
  Execution time = 1.4165e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s010
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6899e+01
  VMC Evar = 2.9305e-01
  Total weights = 1.9509e+06
  Execution time = 1.8962e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.283806800302
                                         uncertainty =       0.001688206827

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.283806800302
                                         uncertainty =       0.001688206827

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000376644242
  error estimate for blocks of size 2^( 2) =       0.000393533604
  error estimate for blocks of size 2^( 3) =       0.000410995325
  error estimate for blocks of size 2^( 4) =       0.000426987351
  error estimate for blocks of size 2^( 5) =       0.000438873317
  error estimate for blocks of size 2^( 6) =       0.000445815570
  error estimate for blocks of size 2^( 7) =       0.000450181586

      target function =      -0.923562697618
              le_mean =     -16.898651004625
             les_mean =     285.857475859288
             stat err =       0.000440464456
             autocorr =       1.367599931403
   target nu stat err =       0.000440464456
   target dn stat err =       0.002342495569
      target stat err =       0.003739347897
              std dev =       0.532655395830
             le_variance =       0.283721770706

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.283799539950
                                         uncertainty =       0.001688647757

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.283799539950
                                         uncertainty =       0.001688647757

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000376639405
  error estimate for blocks of size 2^( 2) =       0.000393528952
  error estimate for blocks of size 2^( 3) =       0.000410989636
  error estimate for blocks of size 2^( 4) =       0.000426980053
  error estimate for blocks of size 2^( 5) =       0.000438864095
  error estimate for blocks of size 2^( 6) =       0.000445805162
  error estimate for blocks of size 2^( 7) =       0.000450172851

      target function =      -0.923601932890
              le_mean =     -16.898651662368
             les_mean =     285.857473035982
             stat err =       0.000440455540
             autocorr =       1.367579693578
   target nu stat err =       0.000440455540
   target dn stat err =       0.002339541995
      target stat err =       0.003735133193
              std dev =       0.532648554702
             le_variance =       0.283714482826

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.283802911620
                                         uncertainty =       0.001688422513

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.283802911620
                                         uncertainty =       0.001688422513

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000376641652
  error estimate for blocks of size 2^( 2) =       0.000393531109
  error estimate for blocks of size 2^( 3) =       0.000410992300
  error estimate for blocks of size 2^( 4) =       0.000426983495
  error estimate for blocks of size 2^( 5) =       0.000438868467
  error estimate for blocks of size 2^( 6) =       0.000445810115
  error estimate for blocks of size 2^( 7) =       0.000450177004

      target function =      -0.923599158532
              le_mean =     -16.898651312859
             les_mean =     285.857462985375
             stat err =       0.000440459770
             autocorr =       1.367589646060
   target nu stat err =       0.000440459770
   target dn stat err =       0.002340613581
      target stat err =       0.003736752861
              std dev =       0.532651732304
             le_variance =       0.283717867926

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.283806285937
                                         uncertainty =       0.001688232559

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.283806285937
                                         uncertainty =       0.001688232559

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000376643900
  error estimate for blocks of size 2^( 2) =       0.000393533273
  error estimate for blocks of size 2^( 3) =       0.000410994928
  error estimate for blocks of size 2^( 4) =       0.000426986849
  error estimate for blocks of size 2^( 5) =       0.000438872690
  error estimate for blocks of size 2^( 6) =       0.000445814867
  error estimate for blocks of size 2^( 7) =       0.000450180994

      target function =      -0.923569910667
              le_mean =     -16.898651040411
             les_mean =     285.857472460087
             stat err =       0.000440463850
             autocorr =       1.367598656353
   target nu stat err =       0.000440463850
   target dn stat err =       0.002342194642
      target stat err =       0.003738943911
              std dev =       0.532654911347
             le_variance =       0.283721254582


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.923562697618        initial
     1.5625e+00     1.5625e+01             7.9103e-05        -0.923601932890  <--
     6.2500e+00     6.2500e+01             2.0227e-05        -0.923599158532
     2.5000e+01     2.5000e+02             5.0856e-06        -0.923569910667

*****************************************************************************
Applying the update for shift_i =   1.5625e+00     and shift_s =   1.5625e+01
*****************************************************************************

  Execution time = 2.3686e+01
  </log>
  <optVariables href="H2O.s010.opt.xml">
ci_0001                 7.083748e-01 3 1  ON 0
ci_0002                 6.929637e-01 3 1  ON 1
ci_0003                -3.108416e-02 3 1  ON 2
ci_0004                -3.016000e-02 3 1  ON 3
ci_0005                -3.063574e-02 3 1  ON 4
ci_0006                -3.080759e-02 3 1  ON 5
ci_0007                -1.345025e-02 3 1  ON 6
ci_0008                -1.343226e-02 3 1  ON 7
ci_0009                -1.869978e-02 3 1  ON 8
ci_0010                -1.815417e-02 3 1  ON 9
ci_0011                -1.475916e-02 3 1  ON 10
ci_0012                -1.461582e-02 3 1  ON 11
ci_0013                 1.524550e-02 3 1  ON 12
ci_0014                 1.479801e-02 3 1  ON 13
ci_0015                 1.585655e-02 3 1  ON 14
ci_0016                 1.541608e-02 3 1  ON 15
ci_0017                 1.341645e-02 3 1  ON 16
ci_0018                 1.310700e-02 3 1  ON 17
ci_0019                 1.305962e-02 3 1  ON 18
ci_0020                 1.258735e-02 3 1  ON 19
ci_0021                 7.161300e-03 3 1  ON 20
ci_0022                 7.911431e-03 3 1  ON 21
ci_0023                -1.178257e-02 3 1  ON 22
ci_0024                -1.139600e-02 3 1  ON 23
ci_0025                -2.096342e-03 3 1  ON 24
ci_0026                -2.554413e-03 3 1  ON 25
ci_0027                -1.209368e-02 3 1  ON 26
ci_0028                -1.159449e-02 3 1  ON 27
ci_0029                -1.058177e-02 3 1  ON 28
ci_0030                -1.054879e-02 3 1  ON 29
ci_0031                 1.349415e-02 3 1  ON 30
ci_0032                 1.216911e-02 3 1  ON 31
ci_0033                 7.870871e-03 3 1  ON 32
ci_0034                 8.411223e-03 3 1  ON 33
ci_0035                 4.825016e-03 3 1  ON 34
ci_0036                 4.976126e-03 3 1  ON 35
ci_0037                -1.133687e-02 3 1  ON 36
ci_0038                -1.147201e-02 3 1  ON 37
ci_0039                -4.031477e-03 3 1  ON 38
ci_0040                -3.937258e-03 3 1  ON 39
ci_0041                 9.037468e-03 3 1  ON 40
ci_0042                 8.672593e-03 3 1  ON 41
ci_0043                -1.275119e-02 3 1  ON 42
ci_0044                -1.353982e-02 3 1  ON 43
ci_0045                 1.060102e-02 3 1  ON 44
ci_0046                 1.009979e-02 3 1  ON 45
ci_0047                -3.596351e-03 3 1  ON 46
ci_0048                -3.462374e-03 3 1  ON 47
ci_0049                -2.607041e-03 3 1  ON 48
ci_0050                -2.602370e-03 3 1  ON 49
ci_0051                -1.738264e-03 3 1  ON 50
ci_0052                -2.054673e-03 3 1  ON 51
ci_0053                -3.930455e-03 3 1  ON 52
ci_0054                -3.319687e-03 3 1  ON 53
ci_0055                 2.596444e-03 3 1  ON 54
ci_0056                 2.263985e-03 3 1  ON 55
ci_0057                 2.529251e-03 3 1  ON 56
ci_0058                 3.044011e-03 3 1  ON 57
ci_0059                -3.343284e-03 3 1  ON 58
ci_0060                -3.225451e-03 3 1  ON 59
ci_0061                -3.982555e-03 3 1  ON 60
ci_0062                -3.971052e-03 3 1  ON 61
ci_0063                -9.876024e-03 3 1  ON 62
ci_0064                -9.335807e-03 3 1  ON 63
ci_0065                -6.409701e-03 3 1  ON 64
ci_0066                -6.164555e-03 3 1  ON 65
ci_0067                -3.679526e-03 3 1  ON 66
ci_0068                -3.409082e-03 3 1  ON 67
ci_0069                 3.670967e-03 3 1  ON 68
ci_0070                 3.437386e-03 3 1  ON 69
ci_0071                 3.002634e-03 3 1  ON 70
ci_0072                 3.555374e-03 3 1  ON 71
ci_0073                 3.485810e-03 3 1  ON 72
ci_0074                 3.548722e-03 3 1  ON 73
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 4.0683e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s011 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s011 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=11  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6898e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 11
    time step          = 0.05
    reference energy   = -16.9347
    reference variance = 0.232565
====================================================
  Execution time = 1.6458e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s011
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5251e+04
  VMC Eavg = -1.6899e+01
  VMC Evar = 2.9920e-01
  Total weights = 1.950783809e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 2.6890e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.284736365160
                                         uncertainty =       0.002943738423

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.284736365160
                                         uncertainty =       0.002943738423

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000377339924
  error estimate for blocks of size 2^( 2) =       0.000393910746
  error estimate for blocks of size 2^( 3) =       0.000410987937
  error estimate for blocks of size 2^( 4) =       0.000426781076
  error estimate for blocks of size 2^( 5) =       0.000438611772
  error estimate for blocks of size 2^( 6) =       0.000446039493
  error estimate for blocks of size 2^( 7) =       0.000450699250

      target function =      -0.914020163382
              le_mean =     -16.899244758321
             les_mean =     285.883677824599
             stat err =       0.000440532898
             autocorr =       1.362985315797
   target nu stat err =       0.000440532898
   target dn stat err =       0.004667105677
      target stat err =       0.007196491984
              std dev =       0.533639237663
             le_variance =       0.284770835973


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.689924475832e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 74
Check correct_vf_var_size: 225, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 3.9062e-01, overlap shift 3.9062e+00 and omega -1.7444e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.914075768015       residual = 1.05e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.914167129359       residual = 2.52e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.914186986313       residual = 8.00e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.914201887614       residual = 2.95e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.914208501752       residual = 1.67e-04           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.914209282556       residual = 1.04e-04           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.914210007843       residual = 5.44e-05           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.914210715952       residual = 2.90e-05           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.914211859722       residual = 4.32e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.914212880882       residual = 3.11e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.914213408317       residual = 2.07e-05           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.914214150860       residual = 5.61e-06           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.914214459186       residual = 3.36e-06           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.914214744887       residual = 7.90e-07           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.914214765457       residual = 3.16e-07           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.914214818726       residual = 8.10e-08           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.914214807710       residual = 2.28e-08           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.914214793512       residual = 1.23e-08           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.914214792801       residual = 3.16e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         18 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 3.9062e-01 is 9.526636e-04

solving harmonic davidson linear method for identity shift 1.5625e+00, overlap shift 1.5625e+01 and omega -1.7444e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.914075768015       residual = 1.05e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.914101871561       residual = 2.45e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.914107417780       residual = 7.68e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.914111444389       residual = 2.73e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.914113167869       residual = 1.49e-04           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.914113334120       residual = 8.74e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.914113506727       residual = 4.70e-05           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.914113682831       residual = 2.65e-05           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.914113994913       residual = 3.82e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.914114237790       residual = 2.34e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.914114341765       residual = 1.33e-05           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.914114500403       residual = 3.50e-06           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.914114565516       residual = 1.97e-06           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.914114621940       residual = 4.02e-07           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.914114623526       residual = 1.60e-07           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.914114632883       residual = 3.95e-08           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.914114630321       residual = 1.09e-08           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.914114627581       residual = 5.62e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         17 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 1.5625e+00 is 2.384596e-04

solving harmonic davidson linear method for identity shift 6.2500e+00, overlap shift 6.2500e+01 and omega -1.7444e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.914075768015       residual = 1.05e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.914082535598       residual = 2.43e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.914083963834       residual = 7.58e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.914084990701       residual = 2.67e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.914085425553       residual = 1.44e-04           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.914085464776       residual = 8.32e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.914085507278       residual = 4.51e-05           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.914085551201       residual = 2.58e-05           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.914085631059       residual = 3.68e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.914085690519       residual = 2.15e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.914085714607       residual = 1.17e-05           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.914085752525       residual = 3.06e-06           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.914085768041       residual = 1.69e-06           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.914085781202       residual = 3.31e-07           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.914085781407       residual = 1.32e-07           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.914085783515       residual = 3.21e-08           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.914085782897       residual = 8.80e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         16 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 6.2500e+00 is 5.962615e-05

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.258377 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 75 and numParams is: 74

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.9163e+01
  </log>
  <optVariables href="H2O.s011.opt.xml">
ci_0001                 7.086096e-01 3 1  ON 0
ci_0002                 6.927253e-01 3 1  ON 1
ci_0003                -3.102979e-02 3 1  ON 2
ci_0004                -3.015154e-02 3 1  ON 3
ci_0005                -3.070661e-02 3 1  ON 4
ci_0006                -3.069427e-02 3 1  ON 5
ci_0007                -1.352516e-02 3 1  ON 6
ci_0008                -1.340142e-02 3 1  ON 7
ci_0009                -1.878613e-02 3 1  ON 8
ci_0010                -1.813465e-02 3 1  ON 9
ci_0011                -1.478365e-02 3 1  ON 10
ci_0012                -1.460939e-02 3 1  ON 11
ci_0013                 1.525900e-02 3 1  ON 12
ci_0014                 1.482499e-02 3 1  ON 13
ci_0015                 1.585199e-02 3 1  ON 14
ci_0016                 1.539745e-02 3 1  ON 15
ci_0017                 1.339259e-02 3 1  ON 16
ci_0018                 1.309267e-02 3 1  ON 17
ci_0019                 1.304370e-02 3 1  ON 18
ci_0020                 1.262168e-02 3 1  ON 19
ci_0021                 7.027159e-03 3 1  ON 20
ci_0022                 7.853706e-03 3 1  ON 21
ci_0023                -1.174122e-02 3 1  ON 22
ci_0024                -1.140650e-02 3 1  ON 23
ci_0025                -2.068505e-03 3 1  ON 24
ci_0026                -2.517693e-03 3 1  ON 25
ci_0027                -1.211336e-02 3 1  ON 26
ci_0028                -1.155801e-02 3 1  ON 27
ci_0029                -1.059957e-02 3 1  ON 28
ci_0030                -1.051682e-02 3 1  ON 29
ci_0031                 1.349797e-02 3 1  ON 30
ci_0032                 1.211754e-02 3 1  ON 31
ci_0033                 7.824539e-03 3 1  ON 32
ci_0034                 8.475389e-03 3 1  ON 33
ci_0035                 4.837721e-03 3 1  ON 34
ci_0036                 5.048883e-03 3 1  ON 35
ci_0037                -1.133207e-02 3 1  ON 36
ci_0038                -1.143488e-02 3 1  ON 37
ci_0039                -3.995364e-03 3 1  ON 38
ci_0040                -3.916418e-03 3 1  ON 39
ci_0041                 9.044269e-03 3 1  ON 40
ci_0042                 8.711760e-03 3 1  ON 41
ci_0043                -1.282502e-02 3 1  ON 42
ci_0044                -1.364862e-02 3 1  ON 43
ci_0045                 1.059002e-02 3 1  ON 44
ci_0046                 1.008786e-02 3 1  ON 45
ci_0047                -3.620493e-03 3 1  ON 46
ci_0048                -3.446960e-03 3 1  ON 47
ci_0049                -2.536983e-03 3 1  ON 48
ci_0050                -2.651599e-03 3 1  ON 49
ci_0051                -1.700582e-03 3 1  ON 50
ci_0052                -2.066917e-03 3 1  ON 51
ci_0053                -3.924866e-03 3 1  ON 52
ci_0054                -3.328428e-03 3 1  ON 53
ci_0055                 2.579730e-03 3 1  ON 54
ci_0056                 2.245909e-03 3 1  ON 55
ci_0057                 2.516991e-03 3 1  ON 56
ci_0058                 3.035460e-03 3 1  ON 57
ci_0059                -3.395265e-03 3 1  ON 58
ci_0060                -3.289733e-03 3 1  ON 59
ci_0061                -4.036313e-03 3 1  ON 60
ci_0062                -3.953539e-03 3 1  ON 61
ci_0063                -9.852565e-03 3 1  ON 62
ci_0064                -9.347935e-03 3 1  ON 63
ci_0065                -6.401351e-03 3 1  ON 64
ci_0066                -6.170927e-03 3 1  ON 65
ci_0067                -3.722103e-03 3 1  ON 66
ci_0068                -3.444049e-03 3 1  ON 67
ci_0069                 3.673993e-03 3 1  ON 68
ci_0070                 3.383323e-03 3 1  ON 69
ci_0071                 3.002398e-03 3 1  ON 70
ci_0072                 3.571735e-03 3 1  ON 71
ci_0073                 3.508693e-03 3 1  ON 72
ci_0074                 3.570605e-03 3 1  ON 73
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 11
    time step          = 0.05
    reference energy   = -16.9682
    reference variance = 0.207461
====================================================
  Execution time = 1.4274e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s011
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6898e+01
  VMC Evar = 2.9013e-01
  Total weights = 1.9510e+06
  Execution time = 2.1896e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.281063689279
                                         uncertainty =       0.001411751394

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.281063689279
                                         uncertainty =       0.001411751394

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000374893097
  error estimate for blocks of size 2^( 2) =       0.000392251352
  error estimate for blocks of size 2^( 3) =       0.000409811706
  error estimate for blocks of size 2^( 4) =       0.000425162822
  error estimate for blocks of size 2^( 5) =       0.000437089451
  error estimate for blocks of size 2^( 6) =       0.000444046255
  error estimate for blocks of size 2^( 7) =       0.000444598667

      target function =      -0.928003082235
              le_mean =     -16.898036731742
             les_mean =     285.833884655186
             stat err =       0.000437724299
             autocorr =       1.363284271848
   target nu stat err =       0.000437724299
   target dn stat err =       0.001951001808
      target stat err =       0.003166400141
              std dev =       0.530178902142
             le_variance =       0.281089668276

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.281058000176
                                         uncertainty =       0.001411551592

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.281058000176
                                         uncertainty =       0.001411551592

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000374889362
  error estimate for blocks of size 2^( 2) =       0.000392233156
  error estimate for blocks of size 2^( 3) =       0.000409779666
  error estimate for blocks of size 2^( 4) =       0.000425111101
  error estimate for blocks of size 2^( 5) =       0.000437036804
  error estimate for blocks of size 2^( 6) =       0.000443998315
  error estimate for blocks of size 2^( 7) =       0.000444554097

      target function =      -0.926978355314
              le_mean =     -16.898037361063
             les_mean =     285.834555685708
             stat err =       0.000437675079
             autocorr =       1.363004858362
   target nu stat err =       0.000437675079
   target dn stat err =       0.002035623525
      target stat err =       0.003289200623
              std dev =       0.530173620678
             le_variance =       0.281084068063

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.281055156479
                                         uncertainty =       0.001411601708

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.281055156479
                                         uncertainty =       0.001411601708

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000374887442
  error estimate for blocks of size 2^( 2) =       0.000392237745
  error estimate for blocks of size 2^( 3) =       0.000409790552
  error estimate for blocks of size 2^( 4) =       0.000425130686
  error estimate for blocks of size 2^( 5) =       0.000437056422
  error estimate for blocks of size 2^( 6) =       0.000444014839
  error estimate for blocks of size 2^( 7) =       0.000444568914

      target function =      -0.928151698809
              le_mean =     -16.898036497009
             les_mean =     285.833782638421
             stat err =       0.000437692715
             autocorr =       1.363128669934
   target nu stat err =       0.000437692715
   target dn stat err =       0.001933723869
      target stat err =       0.003140876626
              std dev =       0.530170904542
             le_variance =       0.281081188023

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.281061779961
                                         uncertainty =       0.001411716405

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.281061779961
                                         uncertainty =       0.001411716405

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000374891828
  error estimate for blocks of size 2^( 2) =       0.000392249070
  error estimate for blocks of size 2^( 3) =       0.000409808466
  error estimate for blocks of size 2^( 4) =       0.000425158177
  error estimate for blocks of size 2^( 5) =       0.000437084654
  error estimate for blocks of size 2^( 6) =       0.000444041685
  error estimate for blocks of size 2^( 7) =       0.000444594306

      target function =      -0.928063931827
              le_mean =     -16.898036618090
             les_mean =     285.833842267989
             stat err =       0.000437719705
             autocorr =       1.363264885218
   target nu stat err =       0.000437719705
   target dn stat err =       0.001947000276
      target stat err =       0.003160665122
              std dev =       0.530177108092
             le_variance =       0.281087765944


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.928003082235        initial
     3.9062e-01     3.9062e+00             9.5266e-04        -0.926978355314
     1.5625e+00     1.5625e+01             2.3846e-04        -0.928151698809  <--
     6.2500e+00     6.2500e+01             5.9626e-05        -0.928063931827

*****************************************************************************
Applying the update for shift_i =   1.5625e+00     and shift_s =   1.5625e+01
*****************************************************************************

  Execution time = 2.4338e+01
  </log>
  <optVariables href="H2O.s011.opt.xml">
ci_0001                 7.086096e-01 3 1  ON 0
ci_0002                 6.927253e-01 3 1  ON 1
ci_0003                -3.102979e-02 3 1  ON 2
ci_0004                -3.015154e-02 3 1  ON 3
ci_0005                -3.070661e-02 3 1  ON 4
ci_0006                -3.069427e-02 3 1  ON 5
ci_0007                -1.352516e-02 3 1  ON 6
ci_0008                -1.340142e-02 3 1  ON 7
ci_0009                -1.878613e-02 3 1  ON 8
ci_0010                -1.813465e-02 3 1  ON 9
ci_0011                -1.478365e-02 3 1  ON 10
ci_0012                -1.460939e-02 3 1  ON 11
ci_0013                 1.525900e-02 3 1  ON 12
ci_0014                 1.482499e-02 3 1  ON 13
ci_0015                 1.585199e-02 3 1  ON 14
ci_0016                 1.539745e-02 3 1  ON 15
ci_0017                 1.339259e-02 3 1  ON 16
ci_0018                 1.309267e-02 3 1  ON 17
ci_0019                 1.304370e-02 3 1  ON 18
ci_0020                 1.262168e-02 3 1  ON 19
ci_0021                 7.027159e-03 3 1  ON 20
ci_0022                 7.853706e-03 3 1  ON 21
ci_0023                -1.174122e-02 3 1  ON 22
ci_0024                -1.140650e-02 3 1  ON 23
ci_0025                -2.068505e-03 3 1  ON 24
ci_0026                -2.517693e-03 3 1  ON 25
ci_0027                -1.211336e-02 3 1  ON 26
ci_0028                -1.155801e-02 3 1  ON 27
ci_0029                -1.059957e-02 3 1  ON 28
ci_0030                -1.051682e-02 3 1  ON 29
ci_0031                 1.349797e-02 3 1  ON 30
ci_0032                 1.211754e-02 3 1  ON 31
ci_0033                 7.824539e-03 3 1  ON 32
ci_0034                 8.475389e-03 3 1  ON 33
ci_0035                 4.837721e-03 3 1  ON 34
ci_0036                 5.048883e-03 3 1  ON 35
ci_0037                -1.133207e-02 3 1  ON 36
ci_0038                -1.143488e-02 3 1  ON 37
ci_0039                -3.995364e-03 3 1  ON 38
ci_0040                -3.916418e-03 3 1  ON 39
ci_0041                 9.044269e-03 3 1  ON 40
ci_0042                 8.711760e-03 3 1  ON 41
ci_0043                -1.282502e-02 3 1  ON 42
ci_0044                -1.364862e-02 3 1  ON 43
ci_0045                 1.059002e-02 3 1  ON 44
ci_0046                 1.008786e-02 3 1  ON 45
ci_0047                -3.620493e-03 3 1  ON 46
ci_0048                -3.446960e-03 3 1  ON 47
ci_0049                -2.536983e-03 3 1  ON 48
ci_0050                -2.651599e-03 3 1  ON 49
ci_0051                -1.700582e-03 3 1  ON 50
ci_0052                -2.066917e-03 3 1  ON 51
ci_0053                -3.924866e-03 3 1  ON 52
ci_0054                -3.328428e-03 3 1  ON 53
ci_0055                 2.579730e-03 3 1  ON 54
ci_0056                 2.245909e-03 3 1  ON 55
ci_0057                 2.516991e-03 3 1  ON 56
ci_0058                 3.035460e-03 3 1  ON 57
ci_0059                -3.395265e-03 3 1  ON 58
ci_0060                -3.289733e-03 3 1  ON 59
ci_0061                -4.036313e-03 3 1  ON 60
ci_0062                -3.953539e-03 3 1  ON 61
ci_0063                -9.852565e-03 3 1  ON 62
ci_0064                -9.347935e-03 3 1  ON 63
ci_0065                -6.401351e-03 3 1  ON 64
ci_0066                -6.170927e-03 3 1  ON 65
ci_0067                -3.722103e-03 3 1  ON 66
ci_0068                -3.444049e-03 3 1  ON 67
ci_0069                 3.673993e-03 3 1  ON 68
ci_0070                 3.383323e-03 3 1  ON 69
ci_0071                 3.002398e-03 3 1  ON 70
ci_0072                 3.571735e-03 3 1  ON 71
ci_0073                 3.508693e-03 3 1  ON 72
ci_0074                 3.570605e-03 3 1  ON 73
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 4.3507e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s012 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s012 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=12  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6903e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 12
    time step          = 0.05
    reference energy   = -16.9265
    reference variance = 0.184766
====================================================
  Execution time = 1.4550e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s012
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5244e+04
  VMC Eavg = -1.6898e+01
  VMC Evar = 2.8921e-01
  Total weights = 1.951078524e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 2.6109e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.280064862999
                                         uncertainty =       0.001605402584

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.280064862999
                                         uncertainty =       0.001605402584

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000374227056
  error estimate for blocks of size 2^( 2) =       0.000391406331
  error estimate for blocks of size 2^( 3) =       0.000409373262
  error estimate for blocks of size 2^( 4) =       0.000424644785
  error estimate for blocks of size 2^( 5) =       0.000436155186
  error estimate for blocks of size 2^( 6) =       0.000445156806
  error estimate for blocks of size 2^( 7) =       0.000452602589

      target function =      -0.929626471542
              le_mean =     -16.897940479950
             les_mean =     285.829602811175
             stat err =       0.000439639842
             autocorr =       1.380141834701
   target nu stat err =       0.000439639842
   target dn stat err =       0.001950227168
      target stat err =       0.003176197320
              std dev =       0.529236977616
             le_variance =       0.280091778476


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.689794047995e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 74
Check correct_vf_var_size: 225, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 3.9062e-01, overlap shift 3.9062e+00 and omega -1.7444e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.929636015769       residual = 5.28e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.929682366964       residual = 1.32e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.929693570028       residual = 3.19e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.929696155149       residual = 1.09e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.929698456363       residual = 4.20e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.929699494258       residual = 2.67e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.929700125536       residual = 9.04e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.929700233973       residual = 7.86e-06           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.929700457076       residual = 9.83e-06           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.929700651561       residual = 7.42e-06           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.929700659534       residual = 6.25e-06           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.929700839743       residual = 3.39e-06           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.929700792626       residual = 1.81e-06           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.929700931067       residual = 6.38e-07           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.929700961405       residual = 1.71e-07           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.929700988273       residual = 5.21e-08           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.929700973248       residual = 1.97e-08           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.929700968770       residual = 4.93e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         17 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 3.9062e-01 is 4.237422e-04

solving harmonic davidson linear method for identity shift 1.5625e+00, overlap shift 1.5625e+01 and omega -1.7444e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.929636015769       residual = 5.28e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.929649272136       residual = 1.28e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.929652376337       residual = 2.99e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.929653054576       residual = 1.00e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.929653667121       residual = 3.81e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.929653931989       residual = 2.30e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.929654086068       residual = 7.65e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.929654110876       residual = 6.89e-06           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.929654168741       residual = 8.86e-06           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.929654212364       residual = 6.19e-06           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.929654209858       residual = 4.62e-06           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.929654251033       residual = 2.22e-06           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.929654239307       residual = 1.09e-06           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.929654269084       residual = 3.37e-07           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.929654274368       residual = 8.48e-08           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.929654278849       residual = 2.65e-08           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.929654275551       residual = 8.84e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         16 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 1.5625e+00 is 1.059803e-04

solving harmonic davidson linear method for identity shift 6.2500e+00, overlap shift 6.2500e+01 and omega -1.7444e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.929636015769       residual = 5.28e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.929639453611       residual = 1.27e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.929640251078       residual = 2.93e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.929640422515       residual = 9.75e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.929640578066       residual = 3.70e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.929640644471       residual = 2.20e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.929640682618       residual = 7.30e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.929640688643       residual = 6.65e-06           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.929640703234       residual = 8.59e-06           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.929640713715       residual = 5.85e-06           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.929640712809       residual = 4.21e-06           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.929640722837       residual = 1.95e-06           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.929640719942       residual = 9.38e-07           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.929640727057       residual = 2.80e-07           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.929640728241       residual = 6.95e-08           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.929640729229       residual = 2.18e-08           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.929640728440       residual = 7.01e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         16 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 6.2500e+00 is 2.650025e-05

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.268146 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 75 and numParams is: 74

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.7176e+01
  </log>
  <optVariables href="H2O.s012.opt.xml">
ci_0001                 7.087155e-01 3 1  ON 0
ci_0002                 6.926213e-01 3 1  ON 1
ci_0003                -3.101611e-02 3 1  ON 2
ci_0004                -3.013161e-02 3 1  ON 3
ci_0005                -3.074745e-02 3 1  ON 4
ci_0006                -3.064814e-02 3 1  ON 5
ci_0007                -1.346232e-02 3 1  ON 6
ci_0008                -1.341945e-02 3 1  ON 7
ci_0009                -1.875612e-02 3 1  ON 8
ci_0010                -1.812979e-02 3 1  ON 9
ci_0011                -1.475118e-02 3 1  ON 10
ci_0012                -1.457116e-02 3 1  ON 11
ci_0013                 1.533494e-02 3 1  ON 12
ci_0014                 1.481978e-02 3 1  ON 13
ci_0015                 1.581945e-02 3 1  ON 14
ci_0016                 1.540870e-02 3 1  ON 15
ci_0017                 1.336901e-02 3 1  ON 16
ci_0018                 1.309789e-02 3 1  ON 17
ci_0019                 1.307362e-02 3 1  ON 18
ci_0020                 1.264799e-02 3 1  ON 19
ci_0021                 6.976781e-03 3 1  ON 20
ci_0022                 7.805147e-03 3 1  ON 21
ci_0023                -1.174807e-02 3 1  ON 22
ci_0024                -1.139590e-02 3 1  ON 23
ci_0025                -2.091777e-03 3 1  ON 24
ci_0026                -2.500036e-03 3 1  ON 25
ci_0027                -1.210995e-02 3 1  ON 26
ci_0028                -1.154749e-02 3 1  ON 27
ci_0029                -1.066150e-02 3 1  ON 28
ci_0030                -1.050936e-02 3 1  ON 29
ci_0031                 1.344659e-02 3 1  ON 30
ci_0032                 1.210060e-02 3 1  ON 31
ci_0033                 7.833260e-03 3 1  ON 32
ci_0034                 8.497843e-03 3 1  ON 33
ci_0035                 4.839992e-03 3 1  ON 34
ci_0036                 5.002454e-03 3 1  ON 35
ci_0037                -1.132588e-02 3 1  ON 36
ci_0038                -1.140573e-02 3 1  ON 37
ci_0039                -4.014065e-03 3 1  ON 38
ci_0040                -3.910245e-03 3 1  ON 39
ci_0041                 9.055814e-03 3 1  ON 40
ci_0042                 8.749066e-03 3 1  ON 41
ci_0043                -1.287492e-02 3 1  ON 42
ci_0044                -1.368414e-02 3 1  ON 43
ci_0045                 1.063179e-02 3 1  ON 44
ci_0046                 1.008334e-02 3 1  ON 45
ci_0047                -3.614059e-03 3 1  ON 46
ci_0048                -3.466939e-03 3 1  ON 47
ci_0049                -2.541069e-03 3 1  ON 48
ci_0050                -2.653256e-03 3 1  ON 49
ci_0051                -1.733982e-03 3 1  ON 50
ci_0052                -2.061621e-03 3 1  ON 51
ci_0053                -3.944522e-03 3 1  ON 52
ci_0054                -3.303387e-03 3 1  ON 53
ci_0055                 2.536410e-03 3 1  ON 54
ci_0056                 2.205002e-03 3 1  ON 55
ci_0057                 2.467798e-03 3 1  ON 56
ci_0058                 2.983764e-03 3 1  ON 57
ci_0059                -3.416530e-03 3 1  ON 58
ci_0060                -3.311501e-03 3 1  ON 59
ci_0061                -4.015788e-03 3 1  ON 60
ci_0062                -3.969164e-03 3 1  ON 61
ci_0063                -9.804486e-03 3 1  ON 62
ci_0064                -9.342932e-03 3 1  ON 63
ci_0065                -6.401564e-03 3 1  ON 64
ci_0066                -6.134136e-03 3 1  ON 65
ci_0067                -3.730831e-03 3 1  ON 66
ci_0068                -3.432866e-03 3 1  ON 67
ci_0069                 3.637510e-03 3 1  ON 68
ci_0070                 3.378191e-03 3 1  ON 69
ci_0071                 3.001960e-03 3 1  ON 70
ci_0072                 3.548906e-03 3 1  ON 71
ci_0073                 3.522098e-03 3 1  ON 72
ci_0074                 3.585693e-03 3 1  ON 73
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 12
    time step          = 0.05
    reference energy   = -16.962
    reference variance = 0.439274
====================================================
  Execution time = 1.4160e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s012
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6899e+01
  VMC Evar = 2.9670e-01
  Total weights = 1.9509e+06
  Execution time = 1.8981e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.286269717741
                                         uncertainty =       0.002657235223

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.286269717741
                                         uncertainty =       0.002657235223

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000378367336
  error estimate for blocks of size 2^( 2) =       0.000395377160
  error estimate for blocks of size 2^( 3) =       0.000412847412
  error estimate for blocks of size 2^( 4) =       0.000427650821
  error estimate for blocks of size 2^( 5) =       0.000439572258
  error estimate for blocks of size 2^( 6) =       0.000447276634
  error estimate for blocks of size 2^( 7) =       0.000450555297

      target function =      -0.917821592533
              le_mean =     -16.898961443633
             les_mean =     285.871650257567
             stat err =       0.000441263753
             autocorr =       1.360094969761
   target nu stat err =       0.000441263753
   target dn stat err =       0.003463412767
      target stat err =       0.005404876242
              std dev =       0.535092217802
             le_variance =       0.286323681552

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.286228246914
                                         uncertainty =       0.002662714269

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.286228246914
                                         uncertainty =       0.002662714269

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000378339688
  error estimate for blocks of size 2^( 2) =       0.000395348842
  error estimate for blocks of size 2^( 3) =       0.000412817703
  error estimate for blocks of size 2^( 4) =       0.000427621793
  error estimate for blocks of size 2^( 5) =       0.000439544124
  error estimate for blocks of size 2^( 6) =       0.000447246105
  error estimate for blocks of size 2^( 7) =       0.000450527642

      target function =      -0.917611443096
              le_mean =     -16.898960949363
             les_mean =     285.871769440916
             stat err =       0.000441234916
             autocorr =       1.360115970015
   target nu stat err =       0.000441234916
   target dn stat err =       0.003472581876
      target stat err =       0.005416446489
              std dev =       0.535053118418
             le_variance =       0.286281839529

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.286243944871
                                         uncertainty =       0.002660149347

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.286243944871
                                         uncertainty =       0.002660149347

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000378350176
  error estimate for blocks of size 2^( 2) =       0.000395359750
  error estimate for blocks of size 2^( 3) =       0.000412829392
  error estimate for blocks of size 2^( 4) =       0.000427633438
  error estimate for blocks of size 2^( 5) =       0.000439555623
  error estimate for blocks of size 2^( 6) =       0.000447258782
  error estimate for blocks of size 2^( 7) =       0.000450538750

      target function =      -0.917876040972
              le_mean =     -16.898960770422
             les_mean =     285.871592244047
             stat err =       0.000441246648
             autocorr =       1.360112897694
   target nu stat err =       0.000441246648
   target dn stat err =       0.003466416330
      target stat err =       0.005410100398
              std dev =       0.535067949957
             le_variance =       0.286297711071

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.286266027532
                                         uncertainty =       0.002657599662

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.286266027532
                                         uncertainty =       0.002657599662

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000378364881
  error estimate for blocks of size 2^( 2) =       0.000395374665
  error estimate for blocks of size 2^( 3) =       0.000412844826
  error estimate for blocks of size 2^( 4) =       0.000427648306
  error estimate for blocks of size 2^( 5) =       0.000439569927
  error estimate for blocks of size 2^( 6) =       0.000447274204
  error estimate for blocks of size 2^( 7) =       0.000450552988

      target function =      -0.917780199577
              le_mean =     -16.898961286754
             les_mean =     285.871671727626
             stat err =       0.000441261356
             autocorr =       1.360097844249
   target nu stat err =       0.000441261356
   target dn stat err =       0.003464204008
      target stat err =       0.005405602639
              std dev =       0.535088746248
             le_variance =       0.286319966362


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.917821592533        initial
     3.9062e-01     3.9062e+00             4.2374e-04        -0.917611443096
     1.5625e+00     1.5625e+01             1.0598e-04        -0.917876040972  <--
     6.2500e+00     6.2500e+01             2.6500e-05        -0.917780199577

*****************************************************************************
Applying the update for shift_i =   1.5625e+00     and shift_s =   1.5625e+01
*****************************************************************************

  Execution time = 2.3649e+01
  </log>
  <optVariables href="H2O.s012.opt.xml">
ci_0001                 7.087155e-01 3 1  ON 0
ci_0002                 6.926213e-01 3 1  ON 1
ci_0003                -3.101611e-02 3 1  ON 2
ci_0004                -3.013161e-02 3 1  ON 3
ci_0005                -3.074745e-02 3 1  ON 4
ci_0006                -3.064814e-02 3 1  ON 5
ci_0007                -1.346232e-02 3 1  ON 6
ci_0008                -1.341945e-02 3 1  ON 7
ci_0009                -1.875612e-02 3 1  ON 8
ci_0010                -1.812979e-02 3 1  ON 9
ci_0011                -1.475118e-02 3 1  ON 10
ci_0012                -1.457116e-02 3 1  ON 11
ci_0013                 1.533494e-02 3 1  ON 12
ci_0014                 1.481978e-02 3 1  ON 13
ci_0015                 1.581945e-02 3 1  ON 14
ci_0016                 1.540870e-02 3 1  ON 15
ci_0017                 1.336901e-02 3 1  ON 16
ci_0018                 1.309789e-02 3 1  ON 17
ci_0019                 1.307362e-02 3 1  ON 18
ci_0020                 1.264799e-02 3 1  ON 19
ci_0021                 6.976781e-03 3 1  ON 20
ci_0022                 7.805147e-03 3 1  ON 21
ci_0023                -1.174807e-02 3 1  ON 22
ci_0024                -1.139590e-02 3 1  ON 23
ci_0025                -2.091777e-03 3 1  ON 24
ci_0026                -2.500036e-03 3 1  ON 25
ci_0027                -1.210995e-02 3 1  ON 26
ci_0028                -1.154749e-02 3 1  ON 27
ci_0029                -1.066150e-02 3 1  ON 28
ci_0030                -1.050936e-02 3 1  ON 29
ci_0031                 1.344659e-02 3 1  ON 30
ci_0032                 1.210060e-02 3 1  ON 31
ci_0033                 7.833260e-03 3 1  ON 32
ci_0034                 8.497843e-03 3 1  ON 33
ci_0035                 4.839992e-03 3 1  ON 34
ci_0036                 5.002454e-03 3 1  ON 35
ci_0037                -1.132588e-02 3 1  ON 36
ci_0038                -1.140573e-02 3 1  ON 37
ci_0039                -4.014065e-03 3 1  ON 38
ci_0040                -3.910245e-03 3 1  ON 39
ci_0041                 9.055814e-03 3 1  ON 40
ci_0042                 8.749066e-03 3 1  ON 41
ci_0043                -1.287492e-02 3 1  ON 42
ci_0044                -1.368414e-02 3 1  ON 43
ci_0045                 1.063179e-02 3 1  ON 44
ci_0046                 1.008334e-02 3 1  ON 45
ci_0047                -3.614059e-03 3 1  ON 46
ci_0048                -3.466939e-03 3 1  ON 47
ci_0049                -2.541069e-03 3 1  ON 48
ci_0050                -2.653256e-03 3 1  ON 49
ci_0051                -1.733982e-03 3 1  ON 50
ci_0052                -2.061621e-03 3 1  ON 51
ci_0053                -3.944522e-03 3 1  ON 52
ci_0054                -3.303387e-03 3 1  ON 53
ci_0055                 2.536410e-03 3 1  ON 54
ci_0056                 2.205002e-03 3 1  ON 55
ci_0057                 2.467798e-03 3 1  ON 56
ci_0058                 2.983764e-03 3 1  ON 57
ci_0059                -3.416530e-03 3 1  ON 58
ci_0060                -3.311501e-03 3 1  ON 59
ci_0061                -4.015788e-03 3 1  ON 60
ci_0062                -3.969164e-03 3 1  ON 61
ci_0063                -9.804486e-03 3 1  ON 62
ci_0064                -9.342932e-03 3 1  ON 63
ci_0065                -6.401564e-03 3 1  ON 64
ci_0066                -6.134136e-03 3 1  ON 65
ci_0067                -3.730831e-03 3 1  ON 66
ci_0068                -3.432866e-03 3 1  ON 67
ci_0069                 3.637510e-03 3 1  ON 68
ci_0070                 3.378191e-03 3 1  ON 69
ci_0071                 3.001960e-03 3 1  ON 70
ci_0072                 3.548906e-03 3 1  ON 71
ci_0073                 3.522098e-03 3 1  ON 72
ci_0074                 3.585693e-03 3 1  ON 73
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 4.0833e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s013 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s013 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=13  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6906e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 13
    time step          = 0.05
    reference energy   = -16.9109
    reference variance = 0.25917
====================================================
  Execution time = 1.4492e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s013
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5218e+04
  VMC Eavg = -1.6898e+01
  VMC Evar = 2.9178e-01
  Total weights = 1.951025472e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 2.5437e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.281765668258
                                         uncertainty =       0.001659164708

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.281765668258
                                         uncertainty =       0.001659164708

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000375346974
  error estimate for blocks of size 2^( 2) =       0.000392226405
  error estimate for blocks of size 2^( 3) =       0.000409924614
  error estimate for blocks of size 2^( 4) =       0.000425201582
  error estimate for blocks of size 2^( 5) =       0.000436990744
  error estimate for blocks of size 2^( 6) =       0.000444325376
  error estimate for blocks of size 2^( 7) =       0.000448822364

      target function =      -0.925573811855
              le_mean =     -16.898430549423
             les_mean =     285.848739329345
             stat err =       0.000438835016
             autocorr =       1.366899897644
   target nu stat err =       0.000438835016
   target dn stat err =       0.002406212413
      target stat err =       0.003851387016
              std dev =       0.530820781204
             le_variance =       0.281770701758


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.689843054942e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 74
Check correct_vf_var_size: 225, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 3.9062e-01, overlap shift 3.9062e+00 and omega -1.7444e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.925588383953       residual = 6.57e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.925642822322       residual = 1.53e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.925656161945       residual = 3.71e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.925661219595       residual = 1.41e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.925664673651       residual = 4.65e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.925665624165       residual = 4.69e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.925666409161       residual = 2.47e-05           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.925666354305       residual = 1.41e-05           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.925666925136       residual = 1.59e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.925667292468       residual = 1.31e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.925667406440       residual = 9.16e-06           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.925667519447       residual = 3.94e-06           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.925667535443       residual = 1.88e-06           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.925667539138       residual = 4.80e-07           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.925667528487       residual = 1.60e-07           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.925667484145       residual = 3.69e-08           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.925667480161       residual = 8.64e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         16 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 3.9062e-01 is 6.139557e-04

solving harmonic davidson linear method for identity shift 1.5625e+00, overlap shift 1.5625e+01 and omega -1.7444e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.925588383953       residual = 6.57e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.925603947156       residual = 1.49e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.925607669423       residual = 3.51e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.925609021146       residual = 1.30e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.925609935979       residual = 4.24e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.925610170045       residual = 4.03e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.925610364204       residual = 2.08e-05           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.925610343098       residual = 1.23e-05           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.925610488525       residual = 1.36e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.925610573667       residual = 1.07e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.925610589384       residual = 6.13e-06           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.925610607617       residual = 2.45e-06           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.925610608842       residual = 1.08e-06           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.925610607303       residual = 2.50e-07           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.925610605038       residual = 7.55e-08           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.925610595717       residual = 1.69e-08           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.925610595645       residual = 3.86e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         16 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 1.5625e+00 is 1.528615e-04

solving harmonic davidson linear method for identity shift 6.2500e+00, overlap shift 6.2500e+01 and omega -1.7444e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.925588383953       residual = 6.57e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.925592419570       residual = 1.48e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.925593377837       residual = 3.45e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.925593721415       residual = 1.27e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.925593953376       residual = 4.12e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.925594011418       residual = 3.85e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.925594059692       residual = 1.98e-05           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.925594053892       residual = 1.19e-05           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.925594090387       residual = 1.30e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.925594111113       residual = 1.01e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.925594114182       residual = 5.45e-06           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.925594118124       residual = 2.14e-06           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.925594118303       residual = 9.18e-07           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.925594117794       residual = 2.08e-07           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.925594117260       residual = 6.09e-08           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.925594115051       residual = 1.36e-08           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.925594115082       residual = 3.08e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         16 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 6.2500e+00 is 3.816832e-05

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.277359 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 75 and numParams is: 74

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.7050e+01
  </log>
  <optVariables href="H2O.s013.opt.xml">
ci_0001                 7.088676e-01 3 1  ON 0
ci_0002                 6.924684e-01 3 1  ON 1
ci_0003                -3.101289e-02 3 1  ON 2
ci_0004                -3.005467e-02 3 1  ON 3
ci_0005                -3.073658e-02 3 1  ON 4
ci_0006                -3.070006e-02 3 1  ON 5
ci_0007                -1.334625e-02 3 1  ON 6
ci_0008                -1.344533e-02 3 1  ON 7
ci_0009                -1.873796e-02 3 1  ON 8
ci_0010                -1.816069e-02 3 1  ON 9
ci_0011                -1.474157e-02 3 1  ON 10
ci_0012                -1.454281e-02 3 1  ON 11
ci_0013                 1.532488e-02 3 1  ON 12
ci_0014                 1.482789e-02 3 1  ON 13
ci_0015                 1.585416e-02 3 1  ON 14
ci_0016                 1.543216e-02 3 1  ON 15
ci_0017                 1.339879e-02 3 1  ON 16
ci_0018                 1.305801e-02 3 1  ON 17
ci_0019                 1.309915e-02 3 1  ON 18
ci_0020                 1.266531e-02 3 1  ON 19
ci_0021                 6.967078e-03 3 1  ON 20
ci_0022                 7.769472e-03 3 1  ON 21
ci_0023                -1.178700e-02 3 1  ON 22
ci_0024                -1.139897e-02 3 1  ON 23
ci_0025                -2.100651e-03 3 1  ON 24
ci_0026                -2.489425e-03 3 1  ON 25
ci_0027                -1.215071e-02 3 1  ON 26
ci_0028                -1.158070e-02 3 1  ON 27
ci_0029                -1.069093e-02 3 1  ON 28
ci_0030                -1.047556e-02 3 1  ON 29
ci_0031                 1.344360e-02 3 1  ON 30
ci_0032                 1.210737e-02 3 1  ON 31
ci_0033                 7.839039e-03 3 1  ON 32
ci_0034                 8.434323e-03 3 1  ON 33
ci_0035                 4.834987e-03 3 1  ON 34
ci_0036                 4.997270e-03 3 1  ON 35
ci_0037                -1.132390e-02 3 1  ON 36
ci_0038                -1.137484e-02 3 1  ON 37
ci_0039                -4.005289e-03 3 1  ON 38
ci_0040                -3.907118e-03 3 1  ON 39
ci_0041                 9.045278e-03 3 1  ON 40
ci_0042                 8.759945e-03 3 1  ON 41
ci_0043                -1.289702e-02 3 1  ON 42
ci_0044                -1.370064e-02 3 1  ON 43
ci_0045                 1.065619e-02 3 1  ON 44
ci_0046                 1.004004e-02 3 1  ON 45
ci_0047                -3.593671e-03 3 1  ON 46
ci_0048                -3.488532e-03 3 1  ON 47
ci_0049                -2.613052e-03 3 1  ON 48
ci_0050                -2.705828e-03 3 1  ON 49
ci_0051                -1.700045e-03 3 1  ON 50
ci_0052                -2.074821e-03 3 1  ON 51
ci_0053                -3.939526e-03 3 1  ON 52
ci_0054                -3.263810e-03 3 1  ON 53
ci_0055                 2.444557e-03 3 1  ON 54
ci_0056                 2.174581e-03 3 1  ON 55
ci_0057                 2.445173e-03 3 1  ON 56
ci_0058                 2.939351e-03 3 1  ON 57
ci_0059                -3.417473e-03 3 1  ON 58
ci_0060                -3.325963e-03 3 1  ON 59
ci_0061                -3.956513e-03 3 1  ON 60
ci_0062                -3.924831e-03 3 1  ON 61
ci_0063                -9.811330e-03 3 1  ON 62
ci_0064                -9.351960e-03 3 1  ON 63
ci_0065                -6.394562e-03 3 1  ON 64
ci_0066                -6.124989e-03 3 1  ON 65
ci_0067                -3.718111e-03 3 1  ON 66
ci_0068                -3.415572e-03 3 1  ON 67
ci_0069                 3.656146e-03 3 1  ON 68
ci_0070                 3.339868e-03 3 1  ON 69
ci_0071                 3.012934e-03 3 1  ON 70
ci_0072                 3.536120e-03 3 1  ON 71
ci_0073                 3.541003e-03 3 1  ON 72
ci_0074                 3.562375e-03 3 1  ON 73
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 13
    time step          = 0.05
    reference energy   = -16.9016
    reference variance = 0.195613
====================================================
  Execution time = 1.3969e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s013
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6899e+01
  VMC Evar = 2.9359e-01
  Total weights = 1.9510e+06
  Execution time = 1.8959e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.283691642864
                                         uncertainty =       0.002154327753

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.283691642864
                                         uncertainty =       0.002154327753

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000376582643
  error estimate for blocks of size 2^( 2) =       0.000393750269
  error estimate for blocks of size 2^( 3) =       0.000410769942
  error estimate for blocks of size 2^( 4) =       0.000425998029
  error estimate for blocks of size 2^( 5) =       0.000436919699
  error estimate for blocks of size 2^( 6) =       0.000445083200
  error estimate for blocks of size 2^( 7) =       0.000449137329

      target function =      -0.922600731900
              le_mean =     -16.898807384974
             les_mean =     285.863374013214
             stat err =       0.000439284564
             autocorr =       1.360727897603
   target nu stat err =       0.000439284564
   target dn stat err =       0.002784523431
      target stat err =       0.004410916938
              std dev =       0.532568280739
             le_variance =       0.283628973649

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.283666918821
                                         uncertainty =       0.002150784302

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.283666918821
                                         uncertainty =       0.002150784302

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000376566589
  error estimate for blocks of size 2^( 2) =       0.000393736973
  error estimate for blocks of size 2^( 3) =       0.000410760455
  error estimate for blocks of size 2^( 4) =       0.000425991830
  error estimate for blocks of size 2^( 5) =       0.000436914152
  error estimate for blocks of size 2^( 6) =       0.000445075597
  error estimate for blocks of size 2^( 7) =       0.000449120294

      target function =      -0.922189941876
              le_mean =     -16.898807630912
             les_mean =     285.863645530210
             stat err =       0.000439275468
             autocorr =       1.360787558043
   target nu stat err =       0.000439275468
   target dn stat err =       0.002785122685
      target stat err =       0.004407966522
              std dev =       0.532545577965
             le_variance =       0.283604792610

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.283672044685
                                         uncertainty =       0.002151032230

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.283672044685
                                         uncertainty =       0.002151032230

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000376569833
  error estimate for blocks of size 2^( 2) =       0.000393739040
  error estimate for blocks of size 2^( 3) =       0.000410760962
  error estimate for blocks of size 2^( 4) =       0.000425991015
  error estimate for blocks of size 2^( 5) =       0.000436913135
  error estimate for blocks of size 2^( 6) =       0.000445075751
  error estimate for blocks of size 2^( 7) =       0.000449125130

      target function =      -0.922698144585
              le_mean =     -16.898807137661
             les_mean =     285.863303325644
             stat err =       0.000439276258
             autocorr =       1.360769010848
   target nu stat err =       0.000439276258
   target dn stat err =       0.002778162859
      target stat err =       0.004402039219
              std dev =       0.532550164745
             le_variance =       0.283609677970

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.283688499122
                                         uncertainty =       0.002153844610

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.283688499122
                                         uncertainty =       0.002153844610

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000376580582
  error estimate for blocks of size 2^( 2) =       0.000393748404
  error estimate for blocks of size 2^( 3) =       0.000410768347
  error estimate for blocks of size 2^( 4) =       0.000425996726
  error estimate for blocks of size 2^( 5) =       0.000436918495
  error estimate for blocks of size 2^( 6) =       0.000445081827
  error estimate for blocks of size 2^( 7) =       0.000449135364

      target function =      -0.922717315799
              le_mean =     -16.898807311802
             les_mean =     285.863296893752
             stat err =       0.000439283103
             autocorr =       1.360733739341
   target nu stat err =       0.000439283103
   target dn stat err =       0.002783098315
      target stat err =       0.004409820939
              std dev =       0.532565365865
             le_variance =       0.283625868919


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.922600731900        initial
     3.9062e-01     3.9062e+00             6.1396e-04        -0.922189941876
     1.5625e+00     1.5625e+01             1.5286e-04        -0.922698144585
     6.2500e+00     6.2500e+01             3.8168e-05        -0.922717315799  <--

*****************************************************************************
Applying the update for shift_i =   6.2500e+00     and shift_s =   6.2500e+01
*****************************************************************************

  Execution time = 2.3465e+01
  </log>
  <optVariables href="H2O.s013.opt.xml">
ci_0001                 7.087535e-01 3 1  ON 0
ci_0002                 6.925831e-01 3 1  ON 1
ci_0003                -3.101525e-02 3 1  ON 2
ci_0004                -3.011189e-02 3 1  ON 3
ci_0005                -3.074464e-02 3 1  ON 4
ci_0006                -3.066146e-02 3 1  ON 5
ci_0007                -1.343278e-02 3 1  ON 6
ci_0008                -1.342602e-02 3 1  ON 7
ci_0009                -1.875142e-02 3 1  ON 8
ci_0010                -1.813779e-02 3 1  ON 9
ci_0011                -1.474870e-02 3 1  ON 10
ci_0012                -1.456389e-02 3 1  ON 11
ci_0013                 1.533234e-02 3 1  ON 12
ci_0014                 1.482189e-02 3 1  ON 13
ci_0015                 1.582837e-02 3 1  ON 14
ci_0016                 1.541476e-02 3 1  ON 15
ci_0017                 1.337667e-02 3 1  ON 16
ci_0018                 1.308764e-02 3 1  ON 17
ci_0019                 1.308018e-02 3 1  ON 18
ci_0020                 1.265247e-02 3 1  ON 19
ci_0021                 6.974305e-03 3 1  ON 20
ci_0022                 7.796040e-03 3 1  ON 21
ci_0023                -1.175808e-02 3 1  ON 22
ci_0024                -1.139671e-02 3 1  ON 23
ci_0025                -2.094069e-03 3 1  ON 24
ci_0026                -2.497292e-03 3 1  ON 25
ci_0027                -1.212042e-02 3 1  ON 26
ci_0028                -1.155606e-02 3 1  ON 27
ci_0029                -1.066905e-02 3 1  ON 28
ci_0030                -1.050068e-02 3 1  ON 29
ci_0031                 1.344584e-02 3 1  ON 30
ci_0032                 1.210232e-02 3 1  ON 31
ci_0033                 7.834718e-03 3 1  ON 32
ci_0034                 8.481598e-03 3 1  ON 33
ci_0035                 4.838684e-03 3 1  ON 34
ci_0036                 5.001118e-03 3 1  ON 35
ci_0037                -1.132535e-02 3 1  ON 36
ci_0038                -1.139782e-02 3 1  ON 37
ci_0039                -4.011785e-03 3 1  ON 38
ci_0040                -3.909443e-03 3 1  ON 39
ci_0041                 9.053090e-03 3 1  ON 40
ci_0042                 8.751878e-03 3 1  ON 41
ci_0043                -1.288054e-02 3 1  ON 42
ci_0044                -1.368839e-02 3 1  ON 43
ci_0045                 1.063802e-02 3 1  ON 44
ci_0046                 1.007226e-02 3 1  ON 45
ci_0047                -3.608776e-03 3 1  ON 46
ci_0048                -3.472533e-03 3 1  ON 47
ci_0049                -2.559719e-03 3 1  ON 48
ci_0050                -2.666889e-03 3 1  ON 49
ci_0051                -1.725164e-03 3 1  ON 50
ci_0052                -2.065054e-03 3 1  ON 51
ci_0053                -3.943222e-03 3 1  ON 52
ci_0054                -3.293128e-03 3 1  ON 53
ci_0055                 2.512591e-03 3 1  ON 54
ci_0056                 2.197108e-03 3 1  ON 55
ci_0057                 2.461923e-03 3 1  ON 56
ci_0058                 2.972274e-03 3 1  ON 57
ci_0059                -3.416770e-03 3 1  ON 58
ci_0060                -3.315251e-03 3 1  ON 59
ci_0061                -4.000507e-03 3 1  ON 60
ci_0062                -3.957745e-03 3 1  ON 61
ci_0063                -9.806238e-03 3 1  ON 62
ci_0064                -9.345271e-03 3 1  ON 63
ci_0065                -6.399755e-03 3 1  ON 64
ci_0066                -6.131786e-03 3 1  ON 65
ci_0067                -3.727529e-03 3 1  ON 66
ci_0068                -3.428387e-03 3 1  ON 67
ci_0069                 3.642337e-03 3 1  ON 68
ci_0070                 3.368259e-03 3 1  ON 69
ci_0071                 3.004798e-03 3 1  ON 70
ci_0072                 3.545605e-03 3 1  ON 71
ci_0073                 3.526995e-03 3 1  ON 72
ci_0074                 3.579648e-03 3 1  ON 73
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 4.0522e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s014 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s014 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=14  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6906e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 14
    time step          = 0.05
    reference energy   = -16.9193
    reference variance = 0.19988
====================================================
  Execution time = 1.4591e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s014
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5226e+04
  VMC Eavg = -1.6898e+01
  VMC Evar = 2.9296e-01
  Total weights = 1.951006300e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 2.5841e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.281255942323
                                         uncertainty =       0.001899403472

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.281255942323
                                         uncertainty =       0.001899403472

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000375021179
  error estimate for blocks of size 2^( 2) =       0.000392030756
  error estimate for blocks of size 2^( 3) =       0.000409248832
  error estimate for blocks of size 2^( 4) =       0.000424519422
  error estimate for blocks of size 2^( 5) =       0.000436277442
  error estimate for blocks of size 2^( 6) =       0.000444443416
  error estimate for blocks of size 2^( 7) =       0.000449059731

      target function =      -0.923717771463
              le_mean =     -16.898198001506
             les_mean =     285.842056436603
             stat err =       0.000438575003
             autocorr =       1.367653745247
   target nu stat err =       0.000438575003
   target dn stat err =       0.003044788264
      target stat err =       0.004817943792
              std dev =       0.530360037798
             le_variance =       0.281281769693


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.689819800151e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 74
Check correct_vf_var_size: 225, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.5625e+00, overlap shift 1.5625e+01 and omega -1.7444e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.923741363054       residual = 5.79e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.923759813916       residual = 7.15e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.923761938103       residual = 2.79e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.923762791700       residual = 1.52e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.923763621995       residual = 4.64e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.923763880197       residual = 1.91e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.923763904977       residual = 5.05e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.923763975933       residual = 3.90e-06           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.923764011759       residual = 5.11e-06           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.923764089401       residual = 3.96e-06           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.923764197723       residual = 3.38e-06           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.923764213478       residual = 1.38e-06           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.923764196775       residual = 7.59e-07           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.923764214516       residual = 2.98e-07           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.923764213981       residual = 7.62e-08           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.923764217167       residual = 2.18e-08           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.923764213436       residual = 5.76e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         16 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 1.5625e+00 is 1.290352e-04

solving harmonic davidson linear method for identity shift 6.2500e+00, overlap shift 6.2500e+01 and omega -1.7444e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.923741363054       residual = 5.79e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.923746144116       residual = 7.11e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.923746690423       residual = 2.74e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.923746907270       residual = 1.49e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.923747117203       residual = 4.48e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.923747181364       residual = 1.81e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.923747187129       residual = 4.83e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.923747205224       residual = 3.79e-06           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.923747214427       residual = 4.92e-06           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.923747234220       residual = 3.69e-06           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.923747260852       residual = 2.88e-06           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.923747263559       residual = 1.25e-06           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.923747259394       residual = 6.61e-07           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.923747263474       residual = 2.49e-07           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.923747263286       residual = 6.30e-08           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.923747263993       residual = 1.76e-08           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.923747263127       residual = 4.63e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         16 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 6.2500e+00 is 3.290872e-05

solving harmonic davidson linear method for identity shift 2.5000e+01, overlap shift 2.5000e+02 and omega -1.7444e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.923741363054       residual = 5.79e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.923742569325       residual = 7.10e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.923742706889       residual = 2.73e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.923742761317       residual = 1.48e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.923742813945       residual = 4.44e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.923742829957       residual = 1.79e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.923742831371       residual = 4.77e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.923742835918       residual = 3.77e-06           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.923742838234       residual = 4.87e-06           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.923742843205       residual = 3.62e-06           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.923742849829       residual = 2.75e-06           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.923742850429       residual = 1.22e-06           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.923742849391       residual = 6.37e-07           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.923742850389       residual = 2.37e-07           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.923742850339       residual = 5.99e-08           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.923742850510       residual = 1.66e-08           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.923742850298       residual = 4.38e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         16 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 2.5000e+01 is 8.268890e-06

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.286579 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 75 and numParams is: 74

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.7189e+01
  </log>
  <optVariables href="H2O.s014.opt.xml">
ci_0001                 7.087314e-01 3 1  ON 0
ci_0002                 6.926066e-01 3 1  ON 1
ci_0003                -3.102338e-02 3 1  ON 2
ci_0004                -3.011574e-02 3 1  ON 3
ci_0005                -3.073435e-02 3 1  ON 4
ci_0006                -3.066398e-02 3 1  ON 5
ci_0007                -1.343864e-02 3 1  ON 6
ci_0008                -1.342562e-02 3 1  ON 7
ci_0009                -1.874631e-02 3 1  ON 8
ci_0010                -1.813231e-02 3 1  ON 9
ci_0011                -1.475106e-02 3 1  ON 10
ci_0012                -1.456086e-02 3 1  ON 11
ci_0013                 1.532998e-02 3 1  ON 12
ci_0014                 1.482155e-02 3 1  ON 13
ci_0015                 1.582608e-02 3 1  ON 14
ci_0016                 1.541290e-02 3 1  ON 15
ci_0017                 1.337525e-02 3 1  ON 16
ci_0018                 1.308053e-02 3 1  ON 17
ci_0019                 1.308696e-02 3 1  ON 18
ci_0020                 1.265589e-02 3 1  ON 19
ci_0021                 6.963737e-03 3 1  ON 20
ci_0022                 7.763131e-03 3 1  ON 21
ci_0023                -1.176421e-02 3 1  ON 22
ci_0024                -1.140572e-02 3 1  ON 23
ci_0025                -2.102203e-03 3 1  ON 24
ci_0026                -2.501070e-03 3 1  ON 25
ci_0027                -1.211497e-02 3 1  ON 26
ci_0028                -1.155395e-02 3 1  ON 27
ci_0029                -1.066683e-02 3 1  ON 28
ci_0030                -1.051159e-02 3 1  ON 29
ci_0031                 1.344330e-02 3 1  ON 30
ci_0032                 1.209253e-02 3 1  ON 31
ci_0033                 7.810289e-03 3 1  ON 32
ci_0034                 8.480039e-03 3 1  ON 33
ci_0035                 4.844309e-03 3 1  ON 34
ci_0036                 4.973890e-03 3 1  ON 35
ci_0037                -1.131824e-02 3 1  ON 36
ci_0038                -1.139057e-02 3 1  ON 37
ci_0039                -4.011966e-03 3 1  ON 38
ci_0040                -3.909217e-03 3 1  ON 39
ci_0041                 9.060643e-03 3 1  ON 40
ci_0042                 8.744212e-03 3 1  ON 41
ci_0043                -1.289018e-02 3 1  ON 42
ci_0044                -1.370207e-02 3 1  ON 43
ci_0045                 1.064033e-02 3 1  ON 44
ci_0046                 1.007266e-02 3 1  ON 45
ci_0047                -3.605695e-03 3 1  ON 46
ci_0048                -3.471598e-03 3 1  ON 47
ci_0049                -2.565478e-03 3 1  ON 48
ci_0050                -2.668887e-03 3 1  ON 49
ci_0051                -1.728259e-03 3 1  ON 50
ci_0052                -2.062013e-03 3 1  ON 51
ci_0053                -3.946570e-03 3 1  ON 52
ci_0054                -3.296053e-03 3 1  ON 53
ci_0055                 2.509634e-03 3 1  ON 54
ci_0056                 2.200928e-03 3 1  ON 55
ci_0057                 2.452714e-03 3 1  ON 56
ci_0058                 2.953472e-03 3 1  ON 57
ci_0059                -3.416588e-03 3 1  ON 58
ci_0060                -3.327013e-03 3 1  ON 59
ci_0061                -4.002029e-03 3 1  ON 60
ci_0062                -3.955414e-03 3 1  ON 61
ci_0063                -9.803142e-03 3 1  ON 62
ci_0064                -9.348750e-03 3 1  ON 63
ci_0065                -6.410370e-03 3 1  ON 64
ci_0066                -6.125481e-03 3 1  ON 65
ci_0067                -3.732343e-03 3 1  ON 66
ci_0068                -3.431174e-03 3 1  ON 67
ci_0069                 3.641340e-03 3 1  ON 68
ci_0070                 3.360664e-03 3 1  ON 69
ci_0071                 2.988853e-03 3 1  ON 70
ci_0072                 3.534979e-03 3 1  ON 71
ci_0073                 3.527049e-03 3 1  ON 72
ci_0074                 3.571687e-03 3 1  ON 73
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 14
    time step          = 0.05
    reference energy   = -16.9314
    reference variance = 0.275099
====================================================
  Execution time = 1.3810e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s014
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6898e+01
  VMC Evar = 2.9444e-01
  Total weights = 1.9508e+06
  Execution time = 1.8744e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.283408330214
                                         uncertainty =       0.001852103295

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.283408330214
                                         uncertainty =       0.001852103295

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000376434840
  error estimate for blocks of size 2^( 2) =       0.000393655351
  error estimate for blocks of size 2^( 3) =       0.000410947218
  error estimate for blocks of size 2^( 4) =       0.000425871793
  error estimate for blocks of size 2^( 5) =       0.000438135029
  error estimate for blocks of size 2^( 6) =       0.000447320210
  error estimate for blocks of size 2^( 7) =       0.000453313387

      target function =      -0.921393070298
              le_mean =     -16.898394067031
             les_mean =     285.850172418968
             stat err =       0.000441160105
             autocorr =       1.373449956846
   target nu stat err =       0.000441160105
   target dn stat err =       0.003240187396
      target stat err =       0.005097029729
              std dev =       0.532359255663
             le_variance =       0.283406377090

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.283391399900
                                         uncertainty =       0.001848089656

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.283391399900
                                         uncertainty =       0.001848089656

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000376423685
  error estimate for blocks of size 2^( 2) =       0.000393642048
  error estimate for blocks of size 2^( 3) =       0.000410931973
  error estimate for blocks of size 2^( 4) =       0.000425855699
  error estimate for blocks of size 2^( 5) =       0.000438118156
  error estimate for blocks of size 2^( 6) =       0.000447302006
  error estimate for blocks of size 2^( 7) =       0.000453294639

      target function =      -0.921429055328
              le_mean =     -16.898393776725
             les_mean =     285.850139607297
             stat err =       0.000441142625
             autocorr =       1.373422515413
   target nu stat err =       0.000441142625
   target dn stat err =       0.003228743300
      target stat err =       0.005079797153
              std dev =       0.532343480266
             le_variance =       0.283389580982

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.283399403292
                                         uncertainty =       0.001850035122

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.283399403292
                                         uncertainty =       0.001850035122

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000376428957
  error estimate for blocks of size 2^( 2) =       0.000393648364
  error estimate for blocks of size 2^( 3) =       0.000410939237
  error estimate for blocks of size 2^( 4) =       0.000425863387
  error estimate for blocks of size 2^( 5) =       0.000438126225
  error estimate for blocks of size 2^( 6) =       0.000447310720
  error estimate for blocks of size 2^( 7) =       0.000453303615

      target function =      -0.921401663714
              le_mean =     -16.898393881056
             les_mean =     285.850160675480
             stat err =       0.000441150987
             autocorr =       1.373436111097
   target nu stat err =       0.000441150987
   target dn stat err =       0.003234242455
      target stat err =       0.005087967297
              std dev =       0.532350935677
             le_variance =       0.283397518716

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.283407176907
                                         uncertainty =       0.001851841985

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.283407176907
                                         uncertainty =       0.001851841985

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000376434079
  error estimate for blocks of size 2^( 2) =       0.000393654453
  error estimate for blocks of size 2^( 3) =       0.000410946195
  error estimate for blocks of size 2^( 4) =       0.000425870717
  error estimate for blocks of size 2^( 5) =       0.000438133903
  error estimate for blocks of size 2^( 6) =       0.000447318998
  error estimate for blocks of size 2^( 7) =       0.000453312141

      target function =      -0.921397034374
              le_mean =     -16.898394040018
             les_mean =     285.850168966732
             stat err =       0.000441158940
             autocorr =       1.373448250080
   target nu stat err =       0.000441158940
   target dn stat err =       0.003239428896
      target stat err =       0.005095904825
              std dev =       0.532358180534
             le_variance =       0.283405232381


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.921393070298        initial
     1.5625e+00     1.5625e+01             1.2904e-04        -0.921429055328  <--
     6.2500e+00     6.2500e+01             3.2909e-05        -0.921401663714
     2.5000e+01     2.5000e+02             8.2689e-06        -0.921397034374

*****************************************************************************
Applying the update for shift_i =   1.5625e+00     and shift_s =   1.5625e+01
*****************************************************************************

  Execution time = 2.3330e+01
  </log>
  <optVariables href="H2O.s014.opt.xml">
ci_0001                 7.086651e-01 3 1  ON 0
ci_0002                 6.926770e-01 3 1  ON 1
ci_0003                -3.104678e-02 3 1  ON 2
ci_0004                -3.012695e-02 3 1  ON 3
ci_0005                -3.070429e-02 3 1  ON 4
ci_0006                -3.067128e-02 3 1  ON 5
ci_0007                -1.345595e-02 3 1  ON 6
ci_0008                -1.342439e-02 3 1  ON 7
ci_0009                -1.873154e-02 3 1  ON 8
ci_0010                -1.811657e-02 3 1  ON 9
ci_0011                -1.475779e-02 3 1  ON 10
ci_0012                -1.455207e-02 3 1  ON 11
ci_0013                 1.532312e-02 3 1  ON 12
ci_0014                 1.482061e-02 3 1  ON 13
ci_0015                 1.581944e-02 3 1  ON 14
ci_0016                 1.540758e-02 3 1  ON 15
ci_0017                 1.337107e-02 3 1  ON 16
ci_0018                 1.306006e-02 3 1  ON 17
ci_0019                 1.310649e-02 3 1  ON 18
ci_0020                 1.266581e-02 3 1  ON 19
ci_0021                 6.932818e-03 3 1  ON 20
ci_0022                 7.667004e-03 3 1  ON 21
ci_0023                -1.178184e-02 3 1  ON 22
ci_0024                -1.143175e-02 3 1  ON 23
ci_0025                -2.125418e-03 3 1  ON 24
ci_0026                -2.511874e-03 3 1  ON 25
ci_0027                -1.209917e-02 3 1  ON 26
ci_0028                -1.154790e-02 3 1  ON 27
ci_0029                -1.066038e-02 3 1  ON 28
ci_0030                -1.054321e-02 3 1  ON 29
ci_0031                 1.343594e-02 3 1  ON 30
ci_0032                 1.206390e-02 3 1  ON 31
ci_0033                 7.739235e-03 3 1  ON 32
ci_0034                 8.475605e-03 3 1  ON 33
ci_0035                 4.860342e-03 3 1  ON 34
ci_0036                 4.896040e-03 3 1  ON 35
ci_0037                -1.129759e-02 3 1  ON 36
ci_0038                -1.136958e-02 3 1  ON 37
ci_0039                -4.012465e-03 3 1  ON 38
ci_0040                -3.908589e-03 3 1  ON 39
ci_0041                 9.082457e-03 3 1  ON 40
ci_0042                 8.722090e-03 3 1  ON 41
ci_0043                -1.291818e-02 3 1  ON 42
ci_0044                -1.374186e-02 3 1  ON 43
ci_0045                 1.064701e-02 3 1  ON 44
ci_0046                 1.007381e-02 3 1  ON 45
ci_0047                -3.596857e-03 3 1  ON 46
ci_0048                -3.468932e-03 3 1  ON 47
ci_0049                -2.581944e-03 3 1  ON 48
ci_0050                -2.674596e-03 3 1  ON 49
ci_0051                -1.737073e-03 3 1  ON 50
ci_0052                -2.053328e-03 3 1  ON 51
ci_0053                -3.956117e-03 3 1  ON 52
ci_0054                -3.304409e-03 3 1  ON 53
ci_0055                 2.501208e-03 3 1  ON 54
ci_0056                 2.211868e-03 3 1  ON 55
ci_0057                 2.426379e-03 3 1  ON 56
ci_0058                 2.899736e-03 3 1  ON 57
ci_0059                -3.416053e-03 3 1  ON 58
ci_0060                -3.360644e-03 3 1  ON 59
ci_0061                -4.006421e-03 3 1  ON 60
ci_0062                -3.948727e-03 3 1  ON 61
ci_0063                -9.794174e-03 3 1  ON 62
ci_0064                -9.358765e-03 3 1  ON 63
ci_0065                -6.440969e-03 3 1  ON 64
ci_0066                -6.107340e-03 3 1  ON 65
ci_0067                -3.746082e-03 3 1  ON 66
ci_0068                -3.439146e-03 3 1  ON 67
ci_0069                 3.638444e-03 3 1  ON 68
ci_0070                 3.338973e-03 3 1  ON 69
ci_0071                 2.943286e-03 3 1  ON 70
ci_0072                 3.504610e-03 3 1  ON 71
ci_0073                 3.527197e-03 3 1  ON 72
ci_0074                 3.548955e-03 3 1  ON 73
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 4.0526e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s015 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s015 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=15  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6907e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 15
    time step          = 0.05
    reference energy   = -16.8535
    reference variance = 0.311796
====================================================
  Execution time = 1.4270e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s015
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5236e+04
  VMC Eavg = -1.6899e+01
  VMC Evar = 2.9282e-01
  Total weights = 1.951095697e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 2.5849e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.282480258763
                                         uncertainty =       0.001733755068

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.282480258763
                                         uncertainty =       0.001733755068

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000375810634
  error estimate for blocks of size 2^( 2) =       0.000393021322
  error estimate for blocks of size 2^( 3) =       0.000410375705
  error estimate for blocks of size 2^( 4) =       0.000425962262
  error estimate for blocks of size 2^( 5) =       0.000438143946
  error estimate for blocks of size 2^( 6) =       0.000446046729
  error estimate for blocks of size 2^( 7) =       0.000449378888

      target function =      -0.923951658772
              le_mean =     -16.898680506569
             les_mean =     285.858223531294
             stat err =       0.000439882956
             autocorr =       1.370049125370
   target nu stat err =       0.000439882956
   target dn stat err =       0.002472990607
      target stat err =       0.003942871699
              std dev =       0.531476495982
             le_variance =       0.282467265781


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.689868050657e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 74
Check correct_vf_var_size: 225, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 3.9062e-01, overlap shift 3.9062e+00 and omega -1.7444e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.923967019193       residual = 9.83e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.924059658273       residual = 1.66e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.924078809243       residual = 4.79e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.924084977581       residual = 1.91e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.924089220491       residual = 6.84e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.924090170651       residual = 3.36e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.924090371686       residual = 6.97e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.924090719956       residual = 3.22e-06           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.924090877778       residual = 1.70e-06           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.924090951312       residual = 1.01e-06           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.924090978200       residual = 2.03e-06           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.924091146197       residual = 1.02e-06           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.924091229649       residual = 1.19e-06           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.924091250376       residual = 3.63e-07           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.924091265541       residual = 2.20e-07           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.924091295528       residual = 1.12e-07           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.924091313341       residual = 3.20e-08           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.924091300712       residual = 1.01e-08           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.924091299138       residual = 2.53e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         18 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 3.9062e-01 is 5.201541e-04

solving harmonic davidson linear method for identity shift 1.5625e+00, overlap shift 1.5625e+01 and omega -1.7444e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.923967019193       residual = 9.83e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.923993481643       residual = 1.62e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.923998811415       residual = 4.49e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.924000447489       residual = 1.75e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.924001558878       residual = 6.05e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.924001785818       residual = 2.78e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.924001828756       residual = 5.68e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.924001916419       residual = 2.55e-06           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.924001956605       residual = 1.40e-06           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.924001974394       residual = 8.76e-07           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.924001985114       residual = 1.75e-06           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.924002025171       residual = 8.45e-07           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.924002041296       residual = 8.25e-07           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.924002043612       residual = 2.17e-07           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.924002046029       residual = 1.31e-07           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.924002051665       residual = 5.70e-08           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.924002054528       residual = 1.45e-08           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.924002051934       residual = 4.41e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         17 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 1.5625e+00 is 1.404556e-04

solving harmonic davidson linear method for identity shift 6.2500e+00, overlap shift 6.2500e+01 and omega -1.7444e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.923967019193       residual = 9.83e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.923973879352       residual = 1.61e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.923975250402       residual = 4.41e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.923975665330       residual = 1.71e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.923975946207       residual = 5.83e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.923976001979       residual = 2.63e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.923976012176       residual = 5.35e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.923976034098       residual = 2.39e-06           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.923976044191       residual = 1.32e-06           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.923976048584       residual = 8.42e-07           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.923976051632       residual = 1.64e-06           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.923976061408       residual = 7.99e-07           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.923976065015       residual = 7.37e-07           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.923976065446       residual = 1.87e-07           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.923976065971       residual = 1.13e-07           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.923976067266       residual = 4.66e-08           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.923976067894       residual = 1.15e-08           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.923976067286       residual = 3.47e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         17 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 6.2500e+00 is 3.583171e-05

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.297480 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 75 and numParams is: 74

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.6871e+01
  </log>
  <optVariables href="H2O.s015.opt.xml">
ci_0001                 7.087172e-01 3 1  ON 0
ci_0002                 6.926319e-01 3 1  ON 1
ci_0003                -3.103793e-02 3 1  ON 2
ci_0004                -3.010352e-02 3 1  ON 3
ci_0005                -3.070016e-02 3 1  ON 4
ci_0006                -3.062240e-02 3 1  ON 5
ci_0007                -1.349489e-02 3 1  ON 6
ci_0008                -1.337025e-02 3 1  ON 7
ci_0009                -1.872664e-02 3 1  ON 8
ci_0010                -1.807578e-02 3 1  ON 9
ci_0011                -1.473730e-02 3 1  ON 10
ci_0012                -1.454748e-02 3 1  ON 11
ci_0013                 1.528806e-02 3 1  ON 12
ci_0014                 1.481548e-02 3 1  ON 13
ci_0015                 1.578118e-02 3 1  ON 14
ci_0016                 1.536344e-02 3 1  ON 15
ci_0017                 1.334218e-02 3 1  ON 16
ci_0018                 1.307113e-02 3 1  ON 17
ci_0019                 1.308678e-02 3 1  ON 18
ci_0020                 1.270653e-02 3 1  ON 19
ci_0021                 6.860149e-03 3 1  ON 20
ci_0022                 7.593387e-03 3 1  ON 21
ci_0023                -1.177211e-02 3 1  ON 22
ci_0024                -1.139991e-02 3 1  ON 23
ci_0025                -2.097903e-03 3 1  ON 24
ci_0026                -2.533553e-03 3 1  ON 25
ci_0027                -1.209149e-02 3 1  ON 26
ci_0028                -1.150352e-02 3 1  ON 27
ci_0029                -1.070010e-02 3 1  ON 28
ci_0030                -1.057404e-02 3 1  ON 29
ci_0031                 1.341971e-02 3 1  ON 30
ci_0032                 1.202600e-02 3 1  ON 31
ci_0033                 7.724606e-03 3 1  ON 32
ci_0034                 8.455681e-03 3 1  ON 33
ci_0035                 4.915615e-03 3 1  ON 34
ci_0036                 4.877394e-03 3 1  ON 35
ci_0037                -1.127807e-02 3 1  ON 36
ci_0038                -1.130874e-02 3 1  ON 37
ci_0039                -4.006415e-03 3 1  ON 38
ci_0040                -3.902851e-03 3 1  ON 39
ci_0041                 9.082560e-03 3 1  ON 40
ci_0042                 8.736811e-03 3 1  ON 41
ci_0043                -1.305863e-02 3 1  ON 42
ci_0044                -1.380046e-02 3 1  ON 43
ci_0045                 1.066230e-02 3 1  ON 44
ci_0046                 1.014830e-02 3 1  ON 45
ci_0047                -3.588411e-03 3 1  ON 46
ci_0048                -3.473161e-03 3 1  ON 47
ci_0049                -2.618713e-03 3 1  ON 48
ci_0050                -2.696752e-03 3 1  ON 49
ci_0051                -1.733742e-03 3 1  ON 50
ci_0052                -2.013996e-03 3 1  ON 51
ci_0053                -3.899208e-03 3 1  ON 52
ci_0054                -3.256495e-03 3 1  ON 53
ci_0055                 2.464882e-03 3 1  ON 54
ci_0056                 2.098345e-03 3 1  ON 55
ci_0057                 2.384920e-03 3 1  ON 56
ci_0058                 2.879232e-03 3 1  ON 57
ci_0059                -3.406838e-03 3 1  ON 58
ci_0060                -3.380727e-03 3 1  ON 59
ci_0061                -3.994339e-03 3 1  ON 60
ci_0062                -3.945990e-03 3 1  ON 61
ci_0063                -9.781711e-03 3 1  ON 62
ci_0064                -9.359910e-03 3 1  ON 63
ci_0065                -6.536930e-03 3 1  ON 64
ci_0066                -6.115852e-03 3 1  ON 65
ci_0067                -3.724291e-03 3 1  ON 66
ci_0068                -3.456887e-03 3 1  ON 67
ci_0069                 3.602586e-03 3 1  ON 68
ci_0070                 3.320512e-03 3 1  ON 69
ci_0071                 2.950028e-03 3 1  ON 70
ci_0072                 3.570865e-03 3 1  ON 71
ci_0073                 3.506023e-03 3 1  ON 72
ci_0074                 3.543081e-03 3 1  ON 73
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 15
    time step          = 0.05
    reference energy   = -16.8994
    reference variance = 0.192692
====================================================
  Execution time = 1.3731e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s015
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6898e+01
  VMC Evar = 2.9580e-01
  Total weights = 1.9514e+06
  Execution time = 1.8744e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.286114968228
                                         uncertainty =       0.004929947919

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.286114968228
                                         uncertainty =       0.004929947919

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000378169470
  error estimate for blocks of size 2^( 2) =       0.000394838040
  error estimate for blocks of size 2^( 3) =       0.000412022798
  error estimate for blocks of size 2^( 4) =       0.000427093002
  error estimate for blocks of size 2^( 5) =       0.000438472261
  error estimate for blocks of size 2^( 6) =       0.000445178171
  error estimate for blocks of size 2^( 7) =       0.000449730876

      target function =      -0.919749834881
              le_mean =     -16.898268187539
             les_mean =     285.846944421236
             stat err =       0.000440118578
             autocorr =       1.354460895413
   target nu stat err =       0.000440118578
   target dn stat err =       0.005358084794
      target stat err =       0.008339946644
              std dev =       0.534812393775
             le_variance =       0.286024296535

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.287969240563
                                         uncertainty =       0.006766649394

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.287969240563
                                         uncertainty =       0.006766649394

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000379389494
  error estimate for blocks of size 2^( 2) =       0.000396020224
  error estimate for blocks of size 2^( 3) =       0.000413157926
  error estimate for blocks of size 2^( 4) =       0.000428193611
  error estimate for blocks of size 2^( 5) =       0.000439572319
  error estimate for blocks of size 2^( 6) =       0.000446316865
  error estimate for blocks of size 2^( 7) =       0.000450878692

      target function =      -0.916491609813
              le_mean =     -16.898278482074
             les_mean =     285.849362235786
             stat err =       0.000441240372
             autocorr =       1.352632704067
   target nu stat err =       0.000441240372
   target dn stat err =       0.007216480786
      target stat err =       0.011134551914
              std dev =       0.536537767452
             le_variance =       0.287872775902

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.287055179113
                                         uncertainty =       0.005862598187

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.287055179113
                                         uncertainty =       0.005862598187

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000378788571
  error estimate for blocks of size 2^( 2) =       0.000395438649
  error estimate for blocks of size 2^( 3) =       0.000412600028
  error estimate for blocks of size 2^( 4) =       0.000427652985
  error estimate for blocks of size 2^( 5) =       0.000439032701
  error estimate for blocks of size 2^( 6) =       0.000445759836
  error estimate for blocks of size 2^( 7) =       0.000450318090

      target function =      -0.918430017992
              le_mean =     -16.898273106081
             les_mean =     285.847945018226
             stat err =       0.000440690903
             autocorr =       1.353550418721
   target nu stat err =       0.000440690903
   target dn stat err =       0.006285371752
      target stat err =       0.009745212773
              std dev =       0.535687934221
             le_variance =       0.286961562870

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.286222070305
                                         uncertainty =       0.005036527926

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.286222070305
                                         uncertainty =       0.005036527926

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000378240044
  error estimate for blocks of size 2^( 2) =       0.000394906595
  error estimate for blocks of size 2^( 3) =       0.000412088735
  error estimate for blocks of size 2^( 4) =       0.000427156990
  error estimate for blocks of size 2^( 5) =       0.000438536390
  error estimate for blocks of size 2^( 6) =       0.000445244917
  error estimate for blocks of size 2^( 7) =       0.000449798446

      target function =      -0.919649990328
              le_mean =     -16.898268680997
             les_mean =     285.847023616905
             stat err =       0.000440184186
             autocorr =       1.354359197297
   target nu stat err =       0.000440184186
   target dn stat err =       0.005461559611
      target stat err =       0.008497950589
              std dev =       0.534912199633
             le_variance =       0.286131061316


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.919749834881        initial  <--
     3.9062e-01     3.9062e+00             5.2015e-04        -0.916491609813
     1.5625e+00     1.5625e+01             1.4046e-04        -0.918430017992
     6.2500e+00     6.2500e+01             3.5832e-05        -0.919649990328

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 23.2676
  </log>
  <optVariables href="H2O.s015.opt.xml">
ci_0001                 7.086651e-01 3 1  ON 0
ci_0002                 6.926770e-01 3 1  ON 1
ci_0003                -3.104678e-02 3 1  ON 2
ci_0004                -3.012695e-02 3 1  ON 3
ci_0005                -3.070429e-02 3 1  ON 4
ci_0006                -3.067128e-02 3 1  ON 5
ci_0007                -1.345595e-02 3 1  ON 6
ci_0008                -1.342439e-02 3 1  ON 7
ci_0009                -1.873154e-02 3 1  ON 8
ci_0010                -1.811657e-02 3 1  ON 9
ci_0011                -1.475779e-02 3 1  ON 10
ci_0012                -1.455207e-02 3 1  ON 11
ci_0013                 1.532312e-02 3 1  ON 12
ci_0014                 1.482061e-02 3 1  ON 13
ci_0015                 1.581944e-02 3 1  ON 14
ci_0016                 1.540758e-02 3 1  ON 15
ci_0017                 1.337107e-02 3 1  ON 16
ci_0018                 1.306006e-02 3 1  ON 17
ci_0019                 1.310649e-02 3 1  ON 18
ci_0020                 1.266581e-02 3 1  ON 19
ci_0021                 6.932818e-03 3 1  ON 20
ci_0022                 7.667004e-03 3 1  ON 21
ci_0023                -1.178184e-02 3 1  ON 22
ci_0024                -1.143175e-02 3 1  ON 23
ci_0025                -2.125418e-03 3 1  ON 24
ci_0026                -2.511874e-03 3 1  ON 25
ci_0027                -1.209917e-02 3 1  ON 26
ci_0028                -1.154790e-02 3 1  ON 27
ci_0029                -1.066038e-02 3 1  ON 28
ci_0030                -1.054321e-02 3 1  ON 29
ci_0031                 1.343594e-02 3 1  ON 30
ci_0032                 1.206390e-02 3 1  ON 31
ci_0033                 7.739235e-03 3 1  ON 32
ci_0034                 8.475605e-03 3 1  ON 33
ci_0035                 4.860342e-03 3 1  ON 34
ci_0036                 4.896040e-03 3 1  ON 35
ci_0037                -1.129759e-02 3 1  ON 36
ci_0038                -1.136958e-02 3 1  ON 37
ci_0039                -4.012465e-03 3 1  ON 38
ci_0040                -3.908589e-03 3 1  ON 39
ci_0041                 9.082457e-03 3 1  ON 40
ci_0042                 8.722090e-03 3 1  ON 41
ci_0043                -1.291818e-02 3 1  ON 42
ci_0044                -1.374186e-02 3 1  ON 43
ci_0045                 1.064701e-02 3 1  ON 44
ci_0046                 1.007381e-02 3 1  ON 45
ci_0047                -3.596857e-03 3 1  ON 46
ci_0048                -3.468932e-03 3 1  ON 47
ci_0049                -2.581944e-03 3 1  ON 48
ci_0050                -2.674596e-03 3 1  ON 49
ci_0051                -1.737073e-03 3 1  ON 50
ci_0052                -2.053328e-03 3 1  ON 51
ci_0053                -3.956117e-03 3 1  ON 52
ci_0054                -3.304409e-03 3 1  ON 53
ci_0055                 2.501208e-03 3 1  ON 54
ci_0056                 2.211868e-03 3 1  ON 55
ci_0057                 2.426379e-03 3 1  ON 56
ci_0058                 2.899736e-03 3 1  ON 57
ci_0059                -3.416053e-03 3 1  ON 58
ci_0060                -3.360644e-03 3 1  ON 59
ci_0061                -4.006421e-03 3 1  ON 60
ci_0062                -3.948727e-03 3 1  ON 61
ci_0063                -9.794174e-03 3 1  ON 62
ci_0064                -9.358765e-03 3 1  ON 63
ci_0065                -6.440969e-03 3 1  ON 64
ci_0066                -6.107340e-03 3 1  ON 65
ci_0067                -3.746082e-03 3 1  ON 66
ci_0068                -3.439146e-03 3 1  ON 67
ci_0069                 3.638444e-03 3 1  ON 68
ci_0070                 3.338973e-03 3 1  ON 69
ci_0071                 2.943286e-03 3 1  ON 70
ci_0072                 3.504610e-03 3 1  ON 71
ci_0073                 3.527197e-03 3 1  ON 72
ci_0074                 3.548955e-03 3 1  ON 73
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 4.0161e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s016 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s016 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=16  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6905e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 16
    time step          = 0.05
    reference energy   = -16.9904
    reference variance = 0.210331
====================================================
  Execution time = 1.4136e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s016
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5212e+04
  VMC Eavg = -1.6899e+01
  VMC Evar = 2.9000e-01
  Total weights = 1.950926329e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 2.5557e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.280258647254
                                         uncertainty =       0.001408842454

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.280258647254
                                         uncertainty =       0.001408842454

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000374389302
  error estimate for blocks of size 2^( 2) =       0.000391268169
  error estimate for blocks of size 2^( 3) =       0.000408353121
  error estimate for blocks of size 2^( 4) =       0.000423602157
  error estimate for blocks of size 2^( 5) =       0.000434543015
  error estimate for blocks of size 2^( 6) =       0.000438961375
  error estimate for blocks of size 2^( 7) =       0.000440840434

      target function =      -0.928410267410
              le_mean =     -16.899167371106
             les_mean =     285.871854290614
             stat err =       0.000434486745
             autocorr =       1.346809600806
   target nu stat err =       0.000434486745
   target dn stat err =       0.001963967569
      target stat err =       0.003194341136
              std dev =       0.529466428326
             le_variance =       0.280334698724


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.689916737111e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 74
Check correct_vf_var_size: 225, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 3.9062e+00, overlap shift 3.9062e+01 and omega -1.7444e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.928420000696       residual = 1.14e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.928431789512       residual = 1.93e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.928433899732       residual = 4.48e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.928434650656       residual = 1.54e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.928434904143       residual = 4.76e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.928434942361       residual = 2.80e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.928435054193       residual = 1.06e-05           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.928435071425       residual = 2.86e-06           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.928435067739       residual = 1.33e-06           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.928435071355       residual = 6.22e-07           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.928435066706       residual = 6.72e-07           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.928435065864       residual = 3.88e-07           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.928435080227       residual = 4.84e-07           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.928435088556       residual = 2.15e-07           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.928435093195       residual = 8.29e-08           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.928435096086       residual = 2.29e-08           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.928435098644       residual = 4.78e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         16 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 3.9062e+00 is 3.938554e-05

solving harmonic davidson linear method for identity shift 1.5625e+01, overlap shift 1.5625e+02 and omega -1.7444e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.928420000696       residual = 1.14e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.928422992894       residual = 1.92e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.928423526952       residual = 4.45e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.928423716036       residual = 1.52e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.928423779581       residual = 4.70e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.928423789064       residual = 2.75e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.928423817042       residual = 1.03e-05           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.928423821304       residual = 2.79e-06           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.928423820347       residual = 1.30e-06           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.928423821245       residual = 6.08e-07           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.928423820088       residual = 6.58e-07           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.928423819913       residual = 3.81e-07           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.928423823543       residual = 4.67e-07           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.928423825586       residual = 2.02e-07           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.928423826710       residual = 7.64e-08           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.928423827406       residual = 2.09e-08           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.928423828021       residual = 4.36e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         16 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 1.5625e+01 is 9.931966e-06

solving harmonic davidson linear method for identity shift 6.2500e+01, overlap shift 6.2500e+02 and omega -1.7444e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.928420000696       residual = 1.14e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.928420751611       residual = 1.92e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.928420885538       residual = 4.44e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.928420932894       residual = 1.52e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.928420948791       residual = 4.68e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.928420951157       residual = 2.73e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.928420958153       residual = 1.02e-05           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.928420959215       residual = 2.77e-06           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.928420958974       residual = 1.29e-06           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.928420959198       residual = 6.04e-07           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.928420958909       residual = 6.55e-07           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.928420958867       residual = 3.79e-07           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.928420959778       residual = 4.62e-07           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.928420960285       residual = 1.98e-07           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.928420960564       residual = 7.49e-08           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.928420960737       residual = 2.05e-08           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.928420960889       residual = 4.27e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         16 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 6.2500e+01 is 2.488398e-06

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.306554 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 75 and numParams is: 74

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.6706e+01
  </log>
  <optVariables href="H2O.s016.opt.xml">
ci_0001                 7.086695e-01 3 1  ON 0
ci_0002                 6.926726e-01 3 1  ON 1
ci_0003                -3.104102e-02 3 1  ON 2
ci_0004                -3.012893e-02 3 1  ON 3
ci_0005                -3.070669e-02 3 1  ON 4
ci_0006                -3.068045e-02 3 1  ON 5
ci_0007                -1.345162e-02 3 1  ON 6
ci_0008                -1.342448e-02 3 1  ON 7
ci_0009                -1.873543e-02 3 1  ON 8
ci_0010                -1.811698e-02 3 1  ON 9
ci_0011                -1.475452e-02 3 1  ON 10
ci_0012                -1.455129e-02 3 1  ON 11
ci_0013                 1.532251e-02 3 1  ON 12
ci_0014                 1.481959e-02 3 1  ON 13
ci_0015                 1.581613e-02 3 1  ON 14
ci_0016                 1.539945e-02 3 1  ON 15
ci_0017                 1.337036e-02 3 1  ON 16
ci_0018                 1.306274e-02 3 1  ON 17
ci_0019                 1.310531e-02 3 1  ON 18
ci_0020                 1.266179e-02 3 1  ON 19
ci_0021                 6.922989e-03 3 1  ON 20
ci_0022                 7.663007e-03 3 1  ON 21
ci_0023                -1.178383e-02 3 1  ON 22
ci_0024                -1.143599e-02 3 1  ON 23
ci_0025                -2.122547e-03 3 1  ON 24
ci_0026                -2.508981e-03 3 1  ON 25
ci_0027                -1.209894e-02 3 1  ON 26
ci_0028                -1.154788e-02 3 1  ON 27
ci_0029                -1.066233e-02 3 1  ON 28
ci_0030                -1.054733e-02 3 1  ON 29
ci_0031                 1.343756e-02 3 1  ON 30
ci_0032                 1.206564e-02 3 1  ON 31
ci_0033                 7.739483e-03 3 1  ON 32
ci_0034                 8.471975e-03 3 1  ON 33
ci_0035                 4.851453e-03 3 1  ON 34
ci_0036                 4.896921e-03 3 1  ON 35
ci_0037                -1.130040e-02 3 1  ON 36
ci_0038                -1.136606e-02 3 1  ON 37
ci_0039                -4.013300e-03 3 1  ON 38
ci_0040                -3.908468e-03 3 1  ON 39
ci_0041                 9.080929e-03 3 1  ON 40
ci_0042                 8.724041e-03 3 1  ON 41
ci_0043                -1.291588e-02 3 1  ON 42
ci_0044                -1.375179e-02 3 1  ON 43
ci_0045                 1.064411e-02 3 1  ON 44
ci_0046                 1.007248e-02 3 1  ON 45
ci_0047                -3.597269e-03 3 1  ON 46
ci_0048                -3.467450e-03 3 1  ON 47
ci_0049                -2.584956e-03 3 1  ON 48
ci_0050                -2.680526e-03 3 1  ON 49
ci_0051                -1.740415e-03 3 1  ON 50
ci_0052                -2.049017e-03 3 1  ON 51
ci_0053                -3.952837e-03 3 1  ON 52
ci_0054                -3.296852e-03 3 1  ON 53
ci_0055                 2.497020e-03 3 1  ON 54
ci_0056                 2.206608e-03 3 1  ON 55
ci_0057                 2.425701e-03 3 1  ON 56
ci_0058                 2.892330e-03 3 1  ON 57
ci_0059                -3.413643e-03 3 1  ON 58
ci_0060                -3.359189e-03 3 1  ON 59
ci_0061                -4.008427e-03 3 1  ON 60
ci_0062                -3.943187e-03 3 1  ON 61
ci_0063                -9.793395e-03 3 1  ON 62
ci_0064                -9.359492e-03 3 1  ON 63
ci_0065                -6.443982e-03 3 1  ON 64
ci_0066                -6.110173e-03 3 1  ON 65
ci_0067                -3.746372e-03 3 1  ON 66
ci_0068                -3.441867e-03 3 1  ON 67
ci_0069                 3.636052e-03 3 1  ON 68
ci_0070                 3.334545e-03 3 1  ON 69
ci_0071                 2.949914e-03 3 1  ON 70
ci_0072                 3.503873e-03 3 1  ON 71
ci_0073                 3.526851e-03 3 1  ON 72
ci_0074                 3.549618e-03 3 1  ON 73
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 16
    time step          = 0.05
    reference energy   = -16.9012
    reference variance = 0.144156
====================================================
  Execution time = 1.3726e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s016
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6898e+01
  VMC Evar = 2.9306e-01
  Total weights = 1.9512e+06
  Execution time = 1.8683e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.284214460290
                                         uncertainty =       0.002396195729

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.284214460290
                                         uncertainty =       0.002396195729

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000376938603
  error estimate for blocks of size 2^( 2) =       0.000393786929
  error estimate for blocks of size 2^( 3) =       0.000410524787
  error estimate for blocks of size 2^( 4) =       0.000426174272
  error estimate for blocks of size 2^( 5) =       0.000437844495
  error estimate for blocks of size 2^( 6) =       0.000446053043
  error estimate for blocks of size 2^( 7) =       0.000452700730

      target function =      -0.923443944591
              le_mean =     -16.898343579765
             les_mean =     285.847155243321
             stat err =       0.000440693135
             autocorr =       1.366882983641
   target nu stat err =       0.000440693135
   target dn stat err =       0.002804706343
      target stat err =       0.004446611329
              std dev =       0.533071684907
             le_variance =       0.284165421249

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.284202351045
                                         uncertainty =       0.002394343956

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.284202351045
                                         uncertainty =       0.002394343956

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000376930533
  error estimate for blocks of size 2^( 2) =       0.000393780311
  error estimate for blocks of size 2^( 3) =       0.000410519195
  error estimate for blocks of size 2^( 4) =       0.000426169627
  error estimate for blocks of size 2^( 5) =       0.000437839989
  error estimate for blocks of size 2^( 6) =       0.000446049270
  error estimate for blocks of size 2^( 7) =       0.000452695706

      target function =      -0.922484522239
              le_mean =     -16.898343482472
             les_mean =     285.847765694308
             stat err =       0.000440688648
             autocorr =       1.366913677673
   target nu stat err =       0.000440688648
   target dn stat err =       0.002885854591
      target stat err =       0.004562329599
              std dev =       0.533060271911
             le_variance =       0.284153253490

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.284208269999
                                         uncertainty =       0.002395256161

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.284208269999
                                         uncertainty =       0.002395256161

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000376934478
  error estimate for blocks of size 2^( 2) =       0.000393783540
  error estimate for blocks of size 2^( 3) =       0.000410521939
  error estimate for blocks of size 2^( 4) =       0.000426171891
  error estimate for blocks of size 2^( 5) =       0.000437842183
  error estimate for blocks of size 2^( 6) =       0.000446051090
  error estimate for blocks of size 2^( 7) =       0.000452698107

      target function =      -0.923579806733
              le_mean =     -16.898343512950
             les_mean =     285.847066086092
             stat err =       0.000440690818
             autocorr =       1.366898526649
   target nu stat err =       0.000440690818
   target dn stat err =       0.002802539516
      target stat err =       0.004444560506
              std dev =       0.533065850720
             le_variance =       0.284159201204

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.284213677428
                                         uncertainty =       0.002396077764

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.284213677428
                                         uncertainty =       0.002396077764

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000376938082
  error estimate for blocks of size 2^( 2) =       0.000393786499
  error estimate for blocks of size 2^( 3) =       0.000410524423
  error estimate for blocks of size 2^( 4) =       0.000426173965
  error estimate for blocks of size 2^( 5) =       0.000437844195
  error estimate for blocks of size 2^( 6) =       0.000446052783
  error estimate for blocks of size 2^( 7) =       0.000452700378

      target function =      -0.923556483381
              le_mean =     -16.898343571970
             les_mean =     285.847082991567
             stat err =       0.000440692830
             autocorr =       1.366884874785
   target nu stat err =       0.000440692830
   target dn stat err =       0.002803487423
      target stat err =       0.004445801181
              std dev =       0.533070947108
             le_variance =       0.284164634651


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.923443944591        initial
     3.9062e+00     3.9062e+01             3.9386e-05        -0.922484522239
     1.5625e+01     1.5625e+02             9.9320e-06        -0.923579806733  <--
     6.2500e+01     6.2500e+02             2.4884e-06        -0.923556483381

*****************************************************************************
Applying the update for shift_i =   1.5625e+01     and shift_s =   1.5625e+02
*****************************************************************************

  Execution time = 2.3250e+01
  </log>
  <optVariables href="H2O.s016.opt.xml">
ci_0001                 7.086695e-01 3 1  ON 0
ci_0002                 6.926726e-01 3 1  ON 1
ci_0003                -3.104102e-02 3 1  ON 2
ci_0004                -3.012893e-02 3 1  ON 3
ci_0005                -3.070669e-02 3 1  ON 4
ci_0006                -3.068045e-02 3 1  ON 5
ci_0007                -1.345162e-02 3 1  ON 6
ci_0008                -1.342448e-02 3 1  ON 7
ci_0009                -1.873543e-02 3 1  ON 8
ci_0010                -1.811698e-02 3 1  ON 9
ci_0011                -1.475452e-02 3 1  ON 10
ci_0012                -1.455129e-02 3 1  ON 11
ci_0013                 1.532251e-02 3 1  ON 12
ci_0014                 1.481959e-02 3 1  ON 13
ci_0015                 1.581613e-02 3 1  ON 14
ci_0016                 1.539945e-02 3 1  ON 15
ci_0017                 1.337036e-02 3 1  ON 16
ci_0018                 1.306274e-02 3 1  ON 17
ci_0019                 1.310531e-02 3 1  ON 18
ci_0020                 1.266179e-02 3 1  ON 19
ci_0021                 6.922989e-03 3 1  ON 20
ci_0022                 7.663007e-03 3 1  ON 21
ci_0023                -1.178383e-02 3 1  ON 22
ci_0024                -1.143599e-02 3 1  ON 23
ci_0025                -2.122547e-03 3 1  ON 24
ci_0026                -2.508981e-03 3 1  ON 25
ci_0027                -1.209894e-02 3 1  ON 26
ci_0028                -1.154788e-02 3 1  ON 27
ci_0029                -1.066233e-02 3 1  ON 28
ci_0030                -1.054733e-02 3 1  ON 29
ci_0031                 1.343756e-02 3 1  ON 30
ci_0032                 1.206564e-02 3 1  ON 31
ci_0033                 7.739483e-03 3 1  ON 32
ci_0034                 8.471975e-03 3 1  ON 33
ci_0035                 4.851453e-03 3 1  ON 34
ci_0036                 4.896921e-03 3 1  ON 35
ci_0037                -1.130040e-02 3 1  ON 36
ci_0038                -1.136606e-02 3 1  ON 37
ci_0039                -4.013300e-03 3 1  ON 38
ci_0040                -3.908468e-03 3 1  ON 39
ci_0041                 9.080929e-03 3 1  ON 40
ci_0042                 8.724041e-03 3 1  ON 41
ci_0043                -1.291588e-02 3 1  ON 42
ci_0044                -1.375179e-02 3 1  ON 43
ci_0045                 1.064411e-02 3 1  ON 44
ci_0046                 1.007248e-02 3 1  ON 45
ci_0047                -3.597269e-03 3 1  ON 46
ci_0048                -3.467450e-03 3 1  ON 47
ci_0049                -2.584956e-03 3 1  ON 48
ci_0050                -2.680526e-03 3 1  ON 49
ci_0051                -1.740415e-03 3 1  ON 50
ci_0052                -2.049017e-03 3 1  ON 51
ci_0053                -3.952837e-03 3 1  ON 52
ci_0054                -3.296852e-03 3 1  ON 53
ci_0055                 2.497020e-03 3 1  ON 54
ci_0056                 2.206608e-03 3 1  ON 55
ci_0057                 2.425701e-03 3 1  ON 56
ci_0058                 2.892330e-03 3 1  ON 57
ci_0059                -3.413643e-03 3 1  ON 58
ci_0060                -3.359189e-03 3 1  ON 59
ci_0061                -4.008427e-03 3 1  ON 60
ci_0062                -3.943187e-03 3 1  ON 61
ci_0063                -9.793395e-03 3 1  ON 62
ci_0064                -9.359492e-03 3 1  ON 63
ci_0065                -6.443982e-03 3 1  ON 64
ci_0066                -6.110173e-03 3 1  ON 65
ci_0067                -3.746372e-03 3 1  ON 66
ci_0068                -3.441867e-03 3 1  ON 67
ci_0069                 3.636052e-03 3 1  ON 68
ci_0070                 3.334545e-03 3 1  ON 69
ci_0071                 2.949914e-03 3 1  ON 70
ci_0072                 3.503873e-03 3 1  ON 71
ci_0073                 3.526851e-03 3 1  ON 72
ci_0074                 3.549618e-03 3 1  ON 73
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 3.9962e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s017 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s017 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=17  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6908e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 17
    time step          = 0.05
    reference energy   = -16.8981
    reference variance = 0.17574
====================================================
  Execution time = 1.4078e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s017
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5248e+04
  VMC Eavg = -1.6898e+01
  VMC Evar = 2.9497e-01
  Total weights = 1.950996788e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 2.5992e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.285235967209
                                         uncertainty =       0.002067575001

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.285235967209
                                         uncertainty =       0.002067575001

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000377707677
  error estimate for blocks of size 2^( 2) =       0.000395122299
  error estimate for blocks of size 2^( 3) =       0.000412800908
  error estimate for blocks of size 2^( 4) =       0.000428809807
  error estimate for blocks of size 2^( 5) =       0.000440353105
  error estimate for blocks of size 2^( 6) =       0.000448241787
  error estimate for blocks of size 2^( 7) =       0.000452510337

      target function =      -0.920599350729
              le_mean =     -16.898147729182
             les_mean =     285.842362305801
             stat err =       0.000442478759
             autocorr =       1.372376363415
   target nu stat err =       0.000442478759
   target dn stat err =       0.002644676820
      target stat err =       0.004173846203
              std dev =       0.534159319901
             le_variance =       0.285326179038


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.689814772918e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 74
Check correct_vf_var_size: 225, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 3.9062e+00, overlap shift 3.9062e+01 and omega -1.7444e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.920616895356       residual = 8.95e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.920626190094       residual = 1.56e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.920627867436       residual = 4.87e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.920628971772       residual = 1.64e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.920629430497       residual = 5.23e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.920629622580       residual = 3.08e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.920629619829       residual = 7.95e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.920629641310       residual = 2.64e-06           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.920629642856       residual = 9.02e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.920629629825       residual = 3.25e-07           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.920629633666       residual = 1.63e-07           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.920629631591       residual = 8.16e-08           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.920629633141       residual = 6.51e-08           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.920629632144       residual = 6.89e-08           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.920629639416       residual = 4.97e-08           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.920629636556       residual = 2.61e-08           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.920629638789       residual = 1.25e-08           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.920629639978       residual = 5.38e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         17 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 3.9062e+00 is 5.330909e-05

solving harmonic davidson linear method for identity shift 1.5625e+01, overlap shift 1.5625e+02 and omega -1.7444e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.920616895356       residual = 8.95e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.920619254006       residual = 1.55e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.920619678187       residual = 4.84e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.920619956155       residual = 1.62e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.920620071385       residual = 5.15e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.920620119360       residual = 3.01e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.920620118489       residual = 7.75e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.920620123819       residual = 2.57e-06           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.920620124169       residual = 8.71e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.920620120915       residual = 3.13e-07           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.920620121879       residual = 1.57e-07           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.920620121369       residual = 7.88e-08           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.920620121759       residual = 6.33e-08           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.920620121511       residual = 6.64e-08           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.920620123317       residual = 4.72e-08           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.920620122607       residual = 2.45e-08           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.920620123149       residual = 1.15e-08           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.920620123429       residual = 4.89e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         17 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 1.5625e+01 is 1.343284e-05

solving harmonic davidson linear method for identity shift 6.2500e+01, overlap shift 6.2500e+02 and omega -1.7444e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.920616895356       residual = 8.95e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.920617487245       residual = 1.55e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.920617593597       residual = 4.83e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.920617663207       residual = 1.62e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.920617692049       residual = 5.13e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.920617704039       residual = 2.99e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.920617703810       residual = 7.70e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.920617705140       residual = 2.55e-06           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.920617705225       residual = 8.64e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.920617704412       residual = 3.10e-07           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.920617704653       residual = 1.55e-07           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.920617704526       residual = 7.81e-08           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.920617704624       residual = 6.28e-08           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.920617704562       residual = 6.58e-08           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.920617705013       residual = 4.66e-08           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.920617704835       residual = 2.41e-08           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.920617704970       residual = 1.12e-08           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.920617705039       residual = 4.77e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         17 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 6.2500e+01 is 3.364875e-06

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.316802 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 75 and numParams is: 74

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.6693e+01
  </log>
  <optVariables href="H2O.s017.opt.xml">
ci_0001                 7.086676e-01 3 1  ON 0
ci_0002                 6.926748e-01 3 1  ON 1
ci_0003                -3.103557e-02 3 1  ON 2
ci_0004                -3.012343e-02 3 1  ON 3
ci_0005                -3.071586e-02 3 1  ON 4
ci_0006                -3.067921e-02 3 1  ON 5
ci_0007                -1.345583e-02 3 1  ON 6
ci_0008                -1.342455e-02 3 1  ON 7
ci_0009                -1.872982e-02 3 1  ON 8
ci_0010                -1.811666e-02 3 1  ON 9
ci_0011                -1.475488e-02 3 1  ON 10
ci_0012                -1.455312e-02 3 1  ON 11
ci_0013                 1.532652e-02 3 1  ON 12
ci_0014                 1.481765e-02 3 1  ON 13
ci_0015                 1.581153e-02 3 1  ON 14
ci_0016                 1.539908e-02 3 1  ON 15
ci_0017                 1.337030e-02 3 1  ON 16
ci_0018                 1.306051e-02 3 1  ON 17
ci_0019                 1.310694e-02 3 1  ON 18
ci_0020                 1.266237e-02 3 1  ON 19
ci_0021                 6.909556e-03 3 1  ON 20
ci_0022                 7.653482e-03 3 1  ON 21
ci_0023                -1.178256e-02 3 1  ON 22
ci_0024                -1.144157e-02 3 1  ON 23
ci_0025                -2.127589e-03 3 1  ON 24
ci_0026                -2.502572e-03 3 1  ON 25
ci_0027                -1.209643e-02 3 1  ON 26
ci_0028                -1.155203e-02 3 1  ON 27
ci_0029                -1.066473e-02 3 1  ON 28
ci_0030                -1.055010e-02 3 1  ON 29
ci_0031                 1.343993e-02 3 1  ON 30
ci_0032                 1.206189e-02 3 1  ON 31
ci_0033                 7.735905e-03 3 1  ON 32
ci_0034                 8.469878e-03 3 1  ON 33
ci_0035                 4.848278e-03 3 1  ON 34
ci_0036                 4.891767e-03 3 1  ON 35
ci_0037                -1.130387e-02 3 1  ON 36
ci_0038                -1.136362e-02 3 1  ON 37
ci_0039                -4.013106e-03 3 1  ON 38
ci_0040                -3.907380e-03 3 1  ON 39
ci_0041                 9.080904e-03 3 1  ON 40
ci_0042                 8.726556e-03 3 1  ON 41
ci_0043                -1.291935e-02 3 1  ON 42
ci_0044                -1.375541e-02 3 1  ON 43
ci_0045                 1.064635e-02 3 1  ON 44
ci_0046                 1.006959e-02 3 1  ON 45
ci_0047                -3.597411e-03 3 1  ON 46
ci_0048                -3.468123e-03 3 1  ON 47
ci_0049                -2.581783e-03 3 1  ON 48
ci_0050                -2.675271e-03 3 1  ON 49
ci_0051                -1.743288e-03 3 1  ON 50
ci_0052                -2.044721e-03 3 1  ON 51
ci_0053                -3.952137e-03 3 1  ON 52
ci_0054                -3.296841e-03 3 1  ON 53
ci_0055                 2.497981e-03 3 1  ON 54
ci_0056                 2.210170e-03 3 1  ON 55
ci_0057                 2.425032e-03 3 1  ON 56
ci_0058                 2.891900e-03 3 1  ON 57
ci_0059                -3.413631e-03 3 1  ON 58
ci_0060                -3.358319e-03 3 1  ON 59
ci_0061                -4.011404e-03 3 1  ON 60
ci_0062                -3.944347e-03 3 1  ON 61
ci_0063                -9.796424e-03 3 1  ON 62
ci_0064                -9.357813e-03 3 1  ON 63
ci_0065                -6.442088e-03 3 1  ON 64
ci_0066                -6.108342e-03 3 1  ON 65
ci_0067                -3.754451e-03 3 1  ON 66
ci_0068                -3.444489e-03 3 1  ON 67
ci_0069                 3.634903e-03 3 1  ON 68
ci_0070                 3.332352e-03 3 1  ON 69
ci_0071                 2.952354e-03 3 1  ON 70
ci_0072                 3.502558e-03 3 1  ON 71
ci_0073                 3.526396e-03 3 1  ON 72
ci_0074                 3.545447e-03 3 1  ON 73
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 17
    time step          = 0.05
    reference energy   = -16.8984
    reference variance = 0.246696
====================================================
  Execution time = 1.3866e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s017
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6899e+01
  VMC Evar = 3.0400e-01
  Total weights = 1.9510e+06
  Execution time = 1.8669e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.286710475563
                                         uncertainty =       0.002764896735

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.286710475563
                                         uncertainty =       0.002764896735

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000378673018
  error estimate for blocks of size 2^( 2) =       0.000395473797
  error estimate for blocks of size 2^( 3) =       0.000412618430
  error estimate for blocks of size 2^( 4) =       0.000428577920
  error estimate for blocks of size 2^( 5) =       0.000439498070
  error estimate for blocks of size 2^( 6) =       0.000447280421
  error estimate for blocks of size 2^( 7) =       0.000451846587

      target function =      -0.906646280823
              le_mean =     -16.898789583848
             les_mean =     285.873090622266
             stat err =       0.000441800749
             autocorr =       1.361207001844
   target nu stat err =       0.000441800749
   target dn stat err =       0.007461276779
      target stat err =       0.011275837362
              std dev =       0.535524517811
             le_variance =       0.286786509176

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.286697095068
                                         uncertainty =       0.002765702328

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.286697095068
                                         uncertainty =       0.002765702328

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000378664088
  error estimate for blocks of size 2^( 2) =       0.000395465468
  error estimate for blocks of size 2^( 3) =       0.000412610835
  error estimate for blocks of size 2^( 4) =       0.000428570540
  error estimate for blocks of size 2^( 5) =       0.000439489728
  error estimate for blocks of size 2^( 6) =       0.000447270178
  error estimate for blocks of size 2^( 7) =       0.000451834395

      target function =      -0.906496887558
              le_mean =     -16.898789514396
             les_mean =     285.873187190745
             stat err =       0.000441791210
             autocorr =       1.361212420145
   target nu stat err =       0.000441791210
   target dn stat err =       0.007469234123
      target stat err =       0.011284100755
              std dev =       0.535511889245
             le_variance =       0.286772983523

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.286703624756
                                         uncertainty =       0.002765292895

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.286703624756
                                         uncertainty =       0.002765292895

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000378668447
  error estimate for blocks of size 2^( 2) =       0.000395469533
  error estimate for blocks of size 2^( 3) =       0.000412614541
  error estimate for blocks of size 2^( 4) =       0.000428574143
  error estimate for blocks of size 2^( 5) =       0.000439493812
  error estimate for blocks of size 2^( 6) =       0.000447275202
  error estimate for blocks of size 2^( 7) =       0.000451840382

      target function =      -0.906627106675
              le_mean =     -16.898789543540
             les_mean =     285.873101888722
             stat err =       0.000441795885
             autocorr =       1.361209891322
   target nu stat err =       0.000441795885
   target dn stat err =       0.007464927386
      target stat err =       0.011280855024
              std dev =       0.535518053048
             le_variance =       0.286779585140

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.286709608435
                                         uncertainty =       0.002764945675

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.286709608435
                                         uncertainty =       0.002764945675

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000378672440
  error estimate for blocks of size 2^( 2) =       0.000395473257
  error estimate for blocks of size 2^( 3) =       0.000412617937
  error estimate for blocks of size 2^( 4) =       0.000428577442
  error estimate for blocks of size 2^( 5) =       0.000439497532
  error estimate for blocks of size 2^( 6) =       0.000447279761
  error estimate for blocks of size 2^( 7) =       0.000451845804

      target function =      -0.906648239167
              le_mean =     -16.898789578276
             les_mean =     285.873089123885
             stat err =       0.000441800135
             autocorr =       1.361207372637
   target nu stat err =       0.000441800135
   target dn stat err =       0.007461724089
      target stat err =       0.011276559131
              std dev =       0.535523699640
             le_variance =       0.286785632876


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.906646280823        initial
     3.9062e+00     3.9062e+01             5.3309e-05        -0.906496887558
     1.5625e+01     1.5625e+02             1.3433e-05        -0.906627106675
     6.2500e+01     6.2500e+02             3.3649e-06        -0.906648239167  <--

*****************************************************************************
Applying the update for shift_i =   6.2500e+01     and shift_s =   6.2500e+02
*****************************************************************************

  Execution time = 2.3484e+01
  </log>
  <optVariables href="H2O.s017.opt.xml">
ci_0001                 7.086690e-01 3 1  ON 0
ci_0002                 6.926731e-01 3 1  ON 1
ci_0003                -3.103966e-02 3 1  ON 2
ci_0004                -3.012755e-02 3 1  ON 3
ci_0005                -3.070899e-02 3 1  ON 4
ci_0006                -3.068014e-02 3 1  ON 5
ci_0007                -1.345268e-02 3 1  ON 6
ci_0008                -1.342450e-02 3 1  ON 7
ci_0009                -1.873402e-02 3 1  ON 8
ci_0010                -1.811690e-02 3 1  ON 9
ci_0011                -1.475461e-02 3 1  ON 10
ci_0012                -1.455175e-02 3 1  ON 11
ci_0013                 1.532351e-02 3 1  ON 12
ci_0014                 1.481910e-02 3 1  ON 13
ci_0015                 1.581498e-02 3 1  ON 14
ci_0016                 1.539936e-02 3 1  ON 15
ci_0017                 1.337035e-02 3 1  ON 16
ci_0018                 1.306218e-02 3 1  ON 17
ci_0019                 1.310572e-02 3 1  ON 18
ci_0020                 1.266193e-02 3 1  ON 19
ci_0021                 6.919624e-03 3 1  ON 20
ci_0022                 7.660621e-03 3 1  ON 21
ci_0023                -1.178351e-02 3 1  ON 22
ci_0024                -1.143739e-02 3 1  ON 23
ci_0025                -2.123812e-03 3 1  ON 24
ci_0026                -2.507373e-03 3 1  ON 25
ci_0027                -1.209831e-02 3 1  ON 26
ci_0028                -1.154892e-02 3 1  ON 27
ci_0029                -1.066293e-02 3 1  ON 28
ci_0030                -1.054802e-02 3 1  ON 29
ci_0031                 1.343816e-02 3 1  ON 30
ci_0032                 1.206470e-02 3 1  ON 31
ci_0033                 7.738587e-03 3 1  ON 32
ci_0034                 8.471450e-03 3 1  ON 33
ci_0035                 4.850656e-03 3 1  ON 34
ci_0036                 4.895628e-03 3 1  ON 35
ci_0037                -1.130127e-02 3 1  ON 36
ci_0038                -1.136545e-02 3 1  ON 37
ci_0039                -4.013251e-03 3 1  ON 38
ci_0040                -3.908195e-03 3 1  ON 39
ci_0041                 9.080923e-03 3 1  ON 40
ci_0042                 8.724671e-03 3 1  ON 41
ci_0043                -1.291675e-02 3 1  ON 42
ci_0044                -1.375270e-02 3 1  ON 43
ci_0045                 1.064467e-02 3 1  ON 44
ci_0046                 1.007175e-02 3 1  ON 45
ci_0047                -3.597304e-03 3 1  ON 46
ci_0048                -3.467619e-03 3 1  ON 47
ci_0049                -2.584160e-03 3 1  ON 48
ci_0050                -2.679208e-03 3 1  ON 49
ci_0051                -1.741136e-03 3 1  ON 50
ci_0052                -2.047939e-03 3 1  ON 51
ci_0053                -3.952662e-03 3 1  ON 52
ci_0054                -3.296849e-03 3 1  ON 53
ci_0055                 2.497261e-03 3 1  ON 54
ci_0056                 2.207502e-03 3 1  ON 55
ci_0057                 2.425533e-03 3 1  ON 56
ci_0058                 2.892222e-03 3 1  ON 57
ci_0059                -3.413640e-03 3 1  ON 58
ci_0060                -3.358971e-03 3 1  ON 59
ci_0061                -4.009174e-03 3 1  ON 60
ci_0062                -3.943478e-03 3 1  ON 61
ci_0063                -9.794155e-03 3 1  ON 62
ci_0064                -9.359071e-03 3 1  ON 63
ci_0065                -6.443507e-03 3 1  ON 64
ci_0066                -6.109714e-03 3 1  ON 65
ci_0067                -3.748399e-03 3 1  ON 66
ci_0068                -3.442525e-03 3 1  ON 67
ci_0069                 3.635764e-03 3 1  ON 68
ci_0070                 3.333995e-03 3 1  ON 69
ci_0071                 2.950526e-03 3 1  ON 70
ci_0072                 3.503543e-03 3 1  ON 71
ci_0073                 3.526737e-03 3 1  ON 72
ci_0074                 3.548571e-03 3 1  ON 73
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 4.0184e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s018 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s018 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=18  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6907e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 18
    time step          = 0.05
    reference energy   = -16.8604
    reference variance = 0.253871
====================================================
  Execution time = 1.4258e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s018
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5257e+04
  VMC Eavg = -1.6899e+01
  VMC Evar = 2.9131e-01
  Total weights = 1.951135481e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 2.5496e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.282202147743
                                         uncertainty =       0.001521339552

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.282202147743
                                         uncertainty =       0.001521339552

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000375635158
  error estimate for blocks of size 2^( 2) =       0.000392820494
  error estimate for blocks of size 2^( 3) =       0.000410803284
  error estimate for blocks of size 2^( 4) =       0.000425974390
  error estimate for blocks of size 2^( 5) =       0.000437636467
  error estimate for blocks of size 2^( 6) =       0.000445713888
  error estimate for blocks of size 2^( 7) =       0.000449969199

      target function =      -0.926325802041
              le_mean =     -16.898588181784
             les_mean =     285.853591422245
             stat err =       0.000439823486
             autocorr =       1.370958677121
   target nu stat err =       0.000439823486
   target dn stat err =       0.002276654070
      target stat err =       0.003659182977
              std dev =       0.531228335265
             le_variance =       0.282203544188


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.689858818178e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 74
Check correct_vf_var_size: 225, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.5625e+01, overlap shift 1.5625e+02 and omega -1.7444e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.926338409173       residual = 9.35e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.926340720823       residual = 9.86e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.926341083900       residual = 3.35e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.926341198413       residual = 1.11e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.926341267802       residual = 4.85e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.926341290195       residual = 3.21e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.926341287262       residual = 1.31e-05           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.926341292725       residual = 8.89e-06           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.926341291136       residual = 1.21e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.926341292526       residual = 7.04e-06           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.926341294482       residual = 3.70e-06           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.926341296280       residual = 2.11e-06           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.926341301367       residual = 8.93e-07           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.926341303115       residual = 1.39e-07           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.926341303536       residual = 3.70e-08           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.926341303818       residual = 2.25e-08           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.926341303707       residual = 4.59e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         16 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 1.5625e+01 is 1.356143e-05

solving harmonic davidson linear method for identity shift 6.2500e+01, overlap shift 6.2500e+02 and omega -1.7444e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.926338409173       residual = 9.35e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.926338989276       residual = 9.85e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.926339080330       residual = 3.34e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.926339109003       residual = 1.11e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.926339126369       residual = 4.83e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.926339131962       residual = 3.20e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.926339131221       residual = 1.30e-05           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.926339132587       residual = 8.87e-06           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.926339132186       residual = 1.21e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.926339132536       residual = 6.97e-06           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.926339133023       residual = 3.67e-06           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.926339133474       residual = 2.08e-06           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.926339134741       residual = 8.78e-07           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.926339135174       residual = 1.36e-07           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.926339135278       residual = 3.63e-08           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.926339135348       residual = 2.20e-08           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.926339135320       residual = 4.48e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         16 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 6.2500e+01 is 3.390430e-06

solving harmonic davidson linear method for identity shift 2.5000e+02, overlap shift 2.5000e+03 and omega -1.7444e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.926338409173       residual = 9.35e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.926338554336       residual = 9.85e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.926338577118       residual = 3.34e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.926338584288       residual = 1.10e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.926338588631       residual = 4.83e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.926338590029       residual = 3.19e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.926338589843       residual = 1.30e-05           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.926338590185       residual = 8.86e-06           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.926338590085       residual = 1.20e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.926338590173       residual = 6.96e-06           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.926338590294       residual = 3.66e-06           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.926338590406       residual = 2.08e-06           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.926338590723       residual = 8.74e-07           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.926338590831       residual = 1.35e-07           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.926338590857       residual = 3.61e-08           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.926338590875       residual = 2.19e-08           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.926338590868       residual = 4.45e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         16 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 2.5000e+02 is 8.476120e-07

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.325930 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 75 and numParams is: 74

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.6822e+01
  </log>
  <optVariables href="H2O.s018.opt.xml">
ci_0001                 7.086724e-01 3 1  ON 0
ci_0002                 6.926697e-01 3 1  ON 1
ci_0003                -3.103928e-02 3 1  ON 2
ci_0004                -3.012730e-02 3 1  ON 3
ci_0005                -3.071024e-02 3 1  ON 4
ci_0006                -3.067996e-02 3 1  ON 5
ci_0007                -1.345346e-02 3 1  ON 6
ci_0008                -1.342467e-02 3 1  ON 7
ci_0009                -1.873411e-02 3 1  ON 8
ci_0010                -1.811659e-02 3 1  ON 9
ci_0011                -1.475432e-02 3 1  ON 10
ci_0012                -1.455207e-02 3 1  ON 11
ci_0013                 1.532297e-02 3 1  ON 12
ci_0014                 1.481932e-02 3 1  ON 13
ci_0015                 1.581601e-02 3 1  ON 14
ci_0016                 1.539874e-02 3 1  ON 15
ci_0017                 1.336993e-02 3 1  ON 16
ci_0018                 1.306227e-02 3 1  ON 17
ci_0019                 1.310487e-02 3 1  ON 18
ci_0020                 1.266278e-02 3 1  ON 19
ci_0021                 6.916404e-03 3 1  ON 20
ci_0022                 7.659331e-03 3 1  ON 21
ci_0023                -1.178375e-02 3 1  ON 22
ci_0024                -1.143627e-02 3 1  ON 23
ci_0025                -2.123862e-03 3 1  ON 24
ci_0026                -2.507021e-03 3 1  ON 25
ci_0027                -1.209847e-02 3 1  ON 26
ci_0028                -1.154844e-02 3 1  ON 27
ci_0029                -1.066166e-02 3 1  ON 28
ci_0030                -1.054779e-02 3 1  ON 29
ci_0031                 1.343653e-02 3 1  ON 30
ci_0032                 1.206441e-02 3 1  ON 31
ci_0033                 7.738560e-03 3 1  ON 32
ci_0034                 8.470169e-03 3 1  ON 33
ci_0035                 4.849884e-03 3 1  ON 34
ci_0036                 4.895877e-03 3 1  ON 35
ci_0037                -1.130123e-02 3 1  ON 36
ci_0038                -1.136535e-02 3 1  ON 37
ci_0039                -4.013533e-03 3 1  ON 38
ci_0040                -3.908064e-03 3 1  ON 39
ci_0041                 9.080898e-03 3 1  ON 40
ci_0042                 8.725405e-03 3 1  ON 41
ci_0043                -1.291777e-02 3 1  ON 42
ci_0044                -1.375274e-02 3 1  ON 43
ci_0045                 1.064488e-02 3 1  ON 44
ci_0046                 1.007151e-02 3 1  ON 45
ci_0047                -3.596488e-03 3 1  ON 46
ci_0048                -3.467368e-03 3 1  ON 47
ci_0049                -2.583270e-03 3 1  ON 48
ci_0050                -2.679554e-03 3 1  ON 49
ci_0051                -1.742217e-03 3 1  ON 50
ci_0052                -2.047991e-03 3 1  ON 51
ci_0053                -3.952688e-03 3 1  ON 52
ci_0054                -3.297156e-03 3 1  ON 53
ci_0055                 2.495866e-03 3 1  ON 54
ci_0056                 2.208970e-03 3 1  ON 55
ci_0057                 2.426635e-03 3 1  ON 56
ci_0058                 2.892206e-03 3 1  ON 57
ci_0059                -3.412687e-03 3 1  ON 58
ci_0060                -3.357883e-03 3 1  ON 59
ci_0061                -4.008968e-03 3 1  ON 60
ci_0062                -3.944262e-03 3 1  ON 61
ci_0063                -9.793799e-03 3 1  ON 62
ci_0064                -9.359427e-03 3 1  ON 63
ci_0065                -6.442937e-03 3 1  ON 64
ci_0066                -6.110103e-03 3 1  ON 65
ci_0067                -3.747843e-03 3 1  ON 66
ci_0068                -3.443353e-03 3 1  ON 67
ci_0069                 3.633661e-03 3 1  ON 68
ci_0070                 3.334701e-03 3 1  ON 69
ci_0071                 2.952096e-03 3 1  ON 70
ci_0072                 3.502725e-03 3 1  ON 71
ci_0073                 3.526844e-03 3 1  ON 72
ci_0074                 3.549347e-03 3 1  ON 73
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 18
    time step          = 0.05
    reference energy   = -16.8049
    reference variance = 0.157744
====================================================
  Execution time = 1.6319e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s018
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6899e+01
  VMC Evar = 2.9132e-01
  Total weights = 1.9506e+06
  Execution time = 1.8649e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.281406143400
                                         uncertainty =       0.001879926305

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.281406143400
                                         uncertainty =       0.001879926305

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000375093473
  error estimate for blocks of size 2^( 2) =       0.000391895204
  error estimate for blocks of size 2^( 3) =       0.000408963450
  error estimate for blocks of size 2^( 4) =       0.000423812474
  error estimate for blocks of size 2^( 5) =       0.000435785632
  error estimate for blocks of size 2^( 6) =       0.000442360104
  error estimate for blocks of size 2^( 7) =       0.000444330814

      target function =      -0.926329522419
              le_mean =     -16.899136151729
             les_mean =     285.872112806928
             stat err =       0.000436572256
             autocorr =       1.354669182813
   target nu stat err =       0.000436572256
   target dn stat err =       0.002527447668
      target stat err =       0.004049374938
              std dev =       0.530462276909
             le_variance =       0.281390227223

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.281405379726
                                         uncertainty =       0.001880307320

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.281405379726
                                         uncertainty =       0.001880307320

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000375092960
  error estimate for blocks of size 2^( 2) =       0.000391894746
  error estimate for blocks of size 2^( 3) =       0.000408963092
  error estimate for blocks of size 2^( 4) =       0.000423812100
  error estimate for blocks of size 2^( 5) =       0.000435785060
  error estimate for blocks of size 2^( 6) =       0.000442359833
  error estimate for blocks of size 2^( 7) =       0.000444330976

      target function =      -0.926334289402
              le_mean =     -16.899136242371
             les_mean =     285.872112839787
             stat err =       0.000436571992
             autocorr =       1.354671251174
   target nu stat err =       0.000436571992
   target dn stat err =       0.002528013881
      target stat err =       0.004050293233
              std dev =       0.530461551622
             le_variance =       0.281389457750

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.281405757199
                                         uncertainty =       0.001880117156

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.281405757199
                                         uncertainty =       0.001880117156

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000375093214
  error estimate for blocks of size 2^( 2) =       0.000391894972
  error estimate for blocks of size 2^( 3) =       0.000408963268
  error estimate for blocks of size 2^( 4) =       0.000423812284
  error estimate for blocks of size 2^( 5) =       0.000435785343
  error estimate for blocks of size 2^( 6) =       0.000442359966
  error estimate for blocks of size 2^( 7) =       0.000444330893

      target function =      -0.926279560869
              le_mean =     -16.899136196875
             les_mean =     285.872146052976
             stat err =       0.000436572121
             autocorr =       1.354670222117
   target nu stat err =       0.000436572121
   target dn stat err =       0.002528094004
      target stat err =       0.004049946430
              std dev =       0.530461910154
             le_variance =       0.281389838124

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.281406094734
                                         uncertainty =       0.001879950164

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.281406094734
                                         uncertainty =       0.001879950164

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000375093440
  error estimate for blocks of size 2^( 2) =       0.000391895175
  error estimate for blocks of size 2^( 3) =       0.000408963427
  error estimate for blocks of size 2^( 4) =       0.000423812450
  error estimate for blocks of size 2^( 5) =       0.000435785595
  error estimate for blocks of size 2^( 6) =       0.000442360086
  error estimate for blocks of size 2^( 7) =       0.000444330823

      target function =      -0.926328573952
              le_mean =     -16.899136157310
             les_mean =     285.872113597529
             stat err =       0.000436572239
             autocorr =       1.354669313398
   target nu stat err =       0.000436572239
   target dn stat err =       0.002527486046
      target stat err =       0.004049426244
              std dev =       0.530462230696
             le_variance =       0.281390178195


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.926329522419        initial
     1.5625e+01     1.5625e+02             1.3561e-05        -0.926334289402  <--
     6.2500e+01     6.2500e+02             3.3904e-06        -0.926279560869
     2.5000e+02     2.5000e+03             8.4761e-07        -0.926328573952

*****************************************************************************
Applying the update for shift_i =   1.5625e+01     and shift_s =   1.5625e+02
*****************************************************************************

  Execution time = 2.5757e+01
  </log>
  <optVariables href="H2O.s018.opt.xml">
ci_0001                 7.086826e-01 3 1  ON 0
ci_0002                 6.926596e-01 3 1  ON 1
ci_0003                -3.103816e-02 3 1  ON 2
ci_0004                -3.012655e-02 3 1  ON 3
ci_0005                -3.071399e-02 3 1  ON 4
ci_0006                -3.067939e-02 3 1  ON 5
ci_0007                -1.345579e-02 3 1  ON 6
ci_0008                -1.342517e-02 3 1  ON 7
ci_0009                -1.873438e-02 3 1  ON 8
ci_0010                -1.811566e-02 3 1  ON 9
ci_0011                -1.475347e-02 3 1  ON 10
ci_0012                -1.455303e-02 3 1  ON 11
ci_0013                 1.532133e-02 3 1  ON 12
ci_0014                 1.481995e-02 3 1  ON 13
ci_0015                 1.581910e-02 3 1  ON 14
ci_0016                 1.539690e-02 3 1  ON 15
ci_0017                 1.336870e-02 3 1  ON 16
ci_0018                 1.306255e-02 3 1  ON 17
ci_0019                 1.310233e-02 3 1  ON 18
ci_0020                 1.266531e-02 3 1  ON 19
ci_0021                 6.906769e-03 3 1  ON 20
ci_0022                 7.655470e-03 3 1  ON 21
ci_0023                -1.178448e-02 3 1  ON 22
ci_0024                -1.143292e-02 3 1  ON 23
ci_0025                -2.124011e-03 3 1  ON 24
ci_0026                -2.505971e-03 3 1  ON 25
ci_0027                -1.209894e-02 3 1  ON 26
ci_0028                -1.154702e-02 3 1  ON 27
ci_0029                -1.065787e-02 3 1  ON 28
ci_0030                -1.054707e-02 3 1  ON 29
ci_0031                 1.343165e-02 3 1  ON 30
ci_0032                 1.206354e-02 3 1  ON 31
ci_0033                 7.738479e-03 3 1  ON 32
ci_0034                 8.466337e-03 3 1  ON 33
ci_0035                 4.847577e-03 3 1  ON 34
ci_0036                 4.896621e-03 3 1  ON 35
ci_0037                -1.130114e-02 3 1  ON 36
ci_0038                -1.136505e-02 3 1  ON 37
ci_0039                -4.014375e-03 3 1  ON 38
ci_0040                -3.907674e-03 3 1  ON 39
ci_0041                 9.080826e-03 3 1  ON 40
ci_0042                 8.727598e-03 3 1  ON 41
ci_0043                -1.292081e-02 3 1  ON 42
ci_0044                -1.375285e-02 3 1  ON 43
ci_0045                 1.064552e-02 3 1  ON 44
ci_0046                 1.007078e-02 3 1  ON 45
ci_0047                -3.594051e-03 3 1  ON 46
ci_0048                -3.466618e-03 3 1  ON 47
ci_0049                -2.580614e-03 3 1  ON 48
ci_0050                -2.680590e-03 3 1  ON 49
ci_0051                -1.745442e-03 3 1  ON 50
ci_0052                -2.048148e-03 3 1  ON 51
ci_0053                -3.952768e-03 3 1  ON 52
ci_0054                -3.298072e-03 3 1  ON 53
ci_0055                 2.491705e-03 3 1  ON 54
ci_0056                 2.213351e-03 3 1  ON 55
ci_0057                 2.429927e-03 3 1  ON 56
ci_0058                 2.892159e-03 3 1  ON 57
ci_0059                -3.409843e-03 3 1  ON 58
ci_0060                -3.354637e-03 3 1  ON 59
ci_0061                -4.008355e-03 3 1  ON 60
ci_0062                -3.946604e-03 3 1  ON 61
ci_0063                -9.792737e-03 3 1  ON 62
ci_0064                -9.360490e-03 3 1  ON 63
ci_0065                -6.441236e-03 3 1  ON 64
ci_0066                -6.111265e-03 3 1  ON 65
ci_0067                -3.746184e-03 3 1  ON 66
ci_0068                -3.445823e-03 3 1  ON 67
ci_0069                 3.627384e-03 3 1  ON 68
ci_0070                 3.336807e-03 3 1  ON 69
ci_0071                 2.956784e-03 3 1  ON 70
ci_0072                 3.500282e-03 3 1  ON 71
ci_0073                 3.527164e-03 3 1  ON 72
ci_0074                 3.551662e-03 3 1  ON 73
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 4.2585e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s019 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s019 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=19  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6903e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 19
    time step          = 0.05
    reference energy   = -16.8935
    reference variance = 0.296804
====================================================
  Execution time = 1.6680e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s019
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5237e+04
  VMC Eavg = -1.6899e+01
  VMC Evar = 2.9351e-01
  Total weights = 1.950818695e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 2.6076e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.281770239745
                                         uncertainty =       0.001386996161

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.281770239745
                                         uncertainty =       0.001386996161

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000375374693
  error estimate for blocks of size 2^( 2) =       0.000392081592
  error estimate for blocks of size 2^( 3) =       0.000409783318
  error estimate for blocks of size 2^( 4) =       0.000425483518
  error estimate for blocks of size 2^( 5) =       0.000436992347
  error estimate for blocks of size 2^( 6) =       0.000444336019
  error estimate for blocks of size 2^( 7) =       0.000446772865

      target function =      -0.922865950380
              le_mean =     -16.898521390696
             les_mean =     285.853538933182
             stat err =       0.000438396187
             autocorr =       1.363966035513
   target nu stat err =       0.000438396187
   target dn stat err =       0.002489855637
      target stat err =       0.003958018837
              std dev =       0.530859982138
             le_variance =       0.281812320636


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.689852139070e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 74
Check correct_vf_var_size: 225, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 3.9062e+00, overlap shift 3.9062e+01 and omega -1.7444e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.922881402126       residual = 4.97e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.922887939762       residual = 7.02e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.922888836654       residual = 2.76e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.922889262892       residual = 1.16e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.922889477444       residual = 3.21e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.922889625008       residual = 1.13e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.922889658203       residual = 3.24e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.922889669086       residual = 1.27e-06           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.922889663267       residual = 4.85e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.922889658578       residual = 1.72e-07           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.922889657905       residual = 1.09e-07           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.922889656979       residual = 1.19e-07           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.922889656825       residual = 8.76e-08           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.922889661078       residual = 6.34e-08           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.922889660284       residual = 3.32e-08           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.922889662851       residual = 1.06e-08           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.922889662375       residual = 3.02e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         16 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 3.9062e+00 is 3.832247e-05

solving harmonic davidson linear method for identity shift 1.5625e+01, overlap shift 1.5625e+02 and omega -1.7444e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.922881402126       residual = 4.97e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.922883060361       residual = 7.00e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.922883287027       residual = 2.74e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.922883394294       residual = 1.15e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.922883448140       residual = 3.16e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.922883485020       residual = 1.11e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.922883493269       residual = 3.14e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.922883495957       residual = 1.24e-06           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.922883494478       residual = 4.71e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.922883493308       residual = 1.67e-07           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.922883493148       residual = 1.07e-07           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.922883492919       residual = 1.16e-07           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.922883492895       residual = 8.54e-08           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.922883493958       residual = 6.09e-08           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.922883493760       residual = 3.13e-08           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.922883494384       residual = 9.73e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         15 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 1.5625e+01 is 9.663173e-06

solving harmonic davidson linear method for identity shift 6.2500e+01, overlap shift 6.2500e+02 and omega -1.7444e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.922881402126       residual = 4.97e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.922881818201       residual = 6.99e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.922881875022       residual = 2.73e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.922881901884       residual = 1.15e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.922881915358       residual = 3.15e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.922881924577       residual = 1.10e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.922881926636       residual = 3.12e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.922881927306       residual = 1.23e-06           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.922881926935       residual = 4.68e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.922881926642       residual = 1.66e-07           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.922881926603       residual = 1.07e-07           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.922881926546       residual = 1.16e-07           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.922881926541       residual = 8.49e-08           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.922881926806       residual = 6.03e-08           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.922881926757       residual = 3.08e-08           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.922881926912       residual = 9.52e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         15 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 6.2500e+01 is 2.421609e-06

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.334497 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 75 and numParams is: 74

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.9302e+01
  </log>
  <optVariables href="H2O.s019.opt.xml">
ci_0001                 7.086807e-01 3 1  ON 0
ci_0002                 6.926614e-01 3 1  ON 1
ci_0003                -3.103485e-02 3 1  ON 2
ci_0004                -3.012539e-02 3 1  ON 3
ci_0005                -3.071322e-02 3 1  ON 4
ci_0006                -3.067958e-02 3 1  ON 5
ci_0007                -1.345881e-02 3 1  ON 6
ci_0008                -1.343170e-02 3 1  ON 7
ci_0009                -1.873361e-02 3 1  ON 8
ci_0010                -1.811442e-02 3 1  ON 9
ci_0011                -1.475393e-02 3 1  ON 10
ci_0012                -1.455212e-02 3 1  ON 11
ci_0013                 1.532044e-02 3 1  ON 12
ci_0014                 1.482111e-02 3 1  ON 13
ci_0015                 1.581811e-02 3 1  ON 14
ci_0016                 1.539890e-02 3 1  ON 15
ci_0017                 1.337109e-02 3 1  ON 16
ci_0018                 1.306179e-02 3 1  ON 17
ci_0019                 1.310352e-02 3 1  ON 18
ci_0020                 1.266832e-02 3 1  ON 19
ci_0021                 6.903964e-03 3 1  ON 20
ci_0022                 7.652707e-03 3 1  ON 21
ci_0023                -1.179002e-02 3 1  ON 22
ci_0024                -1.143432e-02 3 1  ON 23
ci_0025                -2.124061e-03 3 1  ON 24
ci_0026                -2.512851e-03 3 1  ON 25
ci_0027                -1.209631e-02 3 1  ON 26
ci_0028                -1.154220e-02 3 1  ON 27
ci_0029                -1.065750e-02 3 1  ON 28
ci_0030                -1.055072e-02 3 1  ON 29
ci_0031                 1.342797e-02 3 1  ON 30
ci_0032                 1.205899e-02 3 1  ON 31
ci_0033                 7.740747e-03 3 1  ON 32
ci_0034                 8.476000e-03 3 1  ON 33
ci_0035                 4.850720e-03 3 1  ON 34
ci_0036                 4.896381e-03 3 1  ON 35
ci_0037                -1.130655e-02 3 1  ON 36
ci_0038                -1.136373e-02 3 1  ON 37
ci_0039                -4.014149e-03 3 1  ON 38
ci_0040                -3.907815e-03 3 1  ON 39
ci_0041                 9.081767e-03 3 1  ON 40
ci_0042                 8.729990e-03 3 1  ON 41
ci_0043                -1.292796e-02 3 1  ON 42
ci_0044                -1.375833e-02 3 1  ON 43
ci_0045                 1.064657e-02 3 1  ON 44
ci_0046                 1.006458e-02 3 1  ON 45
ci_0047                -3.590742e-03 3 1  ON 46
ci_0048                -3.468344e-03 3 1  ON 47
ci_0049                -2.586911e-03 3 1  ON 48
ci_0050                -2.683106e-03 3 1  ON 49
ci_0051                -1.745830e-03 3 1  ON 50
ci_0052                -2.047071e-03 3 1  ON 51
ci_0053                -3.952385e-03 3 1  ON 52
ci_0054                -3.300424e-03 3 1  ON 53
ci_0055                 2.489211e-03 3 1  ON 54
ci_0056                 2.208354e-03 3 1  ON 55
ci_0057                 2.431710e-03 3 1  ON 56
ci_0058                 2.891885e-03 3 1  ON 57
ci_0059                -3.410771e-03 3 1  ON 58
ci_0060                -3.352945e-03 3 1  ON 59
ci_0061                -4.014537e-03 3 1  ON 60
ci_0062                -3.944520e-03 3 1  ON 61
ci_0063                -9.788600e-03 3 1  ON 62
ci_0064                -9.357998e-03 3 1  ON 63
ci_0065                -6.439254e-03 3 1  ON 64
ci_0066                -6.109254e-03 3 1  ON 65
ci_0067                -3.746544e-03 3 1  ON 66
ci_0068                -3.445671e-03 3 1  ON 67
ci_0069                 3.624913e-03 3 1  ON 68
ci_0070                 3.334292e-03 3 1  ON 69
ci_0071                 2.950709e-03 3 1  ON 70
ci_0072                 3.497693e-03 3 1  ON 71
ci_0073                 3.528106e-03 3 1  ON 72
ci_0074                 3.549272e-03 3 1  ON 73
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 19
    time step          = 0.05
    reference energy   = -16.9513
    reference variance = 0.419167
====================================================
  Execution time = 1.4034e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s019
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6898e+01
  VMC Evar = 2.9915e-01
  Total weights = 1.9507e+06
  Execution time = 1.8669e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.284778625453
                                         uncertainty =       0.002306145824

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.284778625453
                                         uncertainty =       0.002306145824

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000377341898
  error estimate for blocks of size 2^( 2) =       0.000394139216
  error estimate for blocks of size 2^( 3) =       0.000411544298
  error estimate for blocks of size 2^( 4) =       0.000426638981
  error estimate for blocks of size 2^( 5) =       0.000438572743
  error estimate for blocks of size 2^( 6) =       0.000444866994
  error estimate for blocks of size 2^( 7) =       0.000449737341

      target function =      -0.914116730580
              le_mean =     -16.898453456975
             les_mean =     285.856851049131
             stat err =       0.000439954015
             autocorr =       1.359391379271
   target nu stat err =       0.000439954015
   target dn stat err =       0.005957424106
      target stat err =       0.009156269593
              std dev =       0.533642029507
             le_variance =       0.284773815656

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.284777122208
                                         uncertainty =       0.002303294000

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.284777122208
                                         uncertainty =       0.002303294000

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000377340871
  error estimate for blocks of size 2^( 2) =       0.000394136996
  error estimate for blocks of size 2^( 3) =       0.000411540653
  error estimate for blocks of size 2^( 4) =       0.000426635092
  error estimate for blocks of size 2^( 5) =       0.000438567873
  error estimate for blocks of size 2^( 6) =       0.000444862866
  error estimate for blocks of size 2^( 7) =       0.000449733265

      target function =      -0.913901653705
              le_mean =     -16.898453979289
             les_mean =     285.857009327590
             stat err =       0.000439949774
             autocorr =       1.359372569974
   target nu stat err =       0.000439949774
   target dn stat err =       0.005948640396
      target stat err =       0.009138574323
              std dev =       0.533640577930
             le_variance =       0.284772266413

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.284777834491
                                         uncertainty =       0.002304697815

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.284777834491
                                         uncertainty =       0.002304697815

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000377341358
  error estimate for blocks of size 2^( 2) =       0.000394138072
  error estimate for blocks of size 2^( 3) =       0.000411542435
  error estimate for blocks of size 2^( 4) =       0.000426636997
  error estimate for blocks of size 2^( 5) =       0.000438570265
  error estimate for blocks of size 2^( 6) =       0.000444864890
  error estimate for blocks of size 2^( 7) =       0.000449735264

      target function =      -0.914031010478
              le_mean =     -16.898453717000
             les_mean =     285.856915914504
             stat err =       0.000439951854
             autocorr =       1.359381912073
   target nu stat err =       0.000439951854
   target dn stat err =       0.005951995989
      target stat err =       0.009146273191
              std dev =       0.533641266682
             le_variance =       0.284773001506

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.284778520994
                                         uncertainty =       0.002305963228

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.284778520994
                                         uncertainty =       0.002305963228

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000377341827
  error estimate for blocks of size 2^( 2) =       0.000394139069
  error estimate for blocks of size 2^( 3) =       0.000411544061
  error estimate for blocks of size 2^( 4) =       0.000426638729
  error estimate for blocks of size 2^( 5) =       0.000438572429
  error estimate for blocks of size 2^( 6) =       0.000444866727
  error estimate for blocks of size 2^( 7) =       0.000449737078

      target function =      -0.914107881800
              le_mean =     -16.898453489064
             les_mean =     285.856857925688
             stat err =       0.000439953741
             autocorr =       1.359390199245
   target nu stat err =       0.000439953741
   target dn stat err =       0.005956674510
      target stat err =       0.009154948559
              std dev =       0.533641928911
             le_variance =       0.284773708292


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.914116730580        initial  <--
     3.9062e+00     3.9062e+01             3.8322e-05        -0.913901653705
     1.5625e+01     1.5625e+02             9.6632e-06        -0.914031010478
     6.2500e+01     6.2500e+02             2.4216e-06        -0.914107881800

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 23.4909
  </log>
  <optVariables href="H2O.s019.opt.xml">
ci_0001                 7.086826e-01 3 1  ON 0
ci_0002                 6.926596e-01 3 1  ON 1
ci_0003                -3.103816e-02 3 1  ON 2
ci_0004                -3.012655e-02 3 1  ON 3
ci_0005                -3.071399e-02 3 1  ON 4
ci_0006                -3.067939e-02 3 1  ON 5
ci_0007                -1.345579e-02 3 1  ON 6
ci_0008                -1.342517e-02 3 1  ON 7
ci_0009                -1.873438e-02 3 1  ON 8
ci_0010                -1.811566e-02 3 1  ON 9
ci_0011                -1.475347e-02 3 1  ON 10
ci_0012                -1.455303e-02 3 1  ON 11
ci_0013                 1.532133e-02 3 1  ON 12
ci_0014                 1.481995e-02 3 1  ON 13
ci_0015                 1.581910e-02 3 1  ON 14
ci_0016                 1.539690e-02 3 1  ON 15
ci_0017                 1.336870e-02 3 1  ON 16
ci_0018                 1.306255e-02 3 1  ON 17
ci_0019                 1.310233e-02 3 1  ON 18
ci_0020                 1.266531e-02 3 1  ON 19
ci_0021                 6.906769e-03 3 1  ON 20
ci_0022                 7.655470e-03 3 1  ON 21
ci_0023                -1.178448e-02 3 1  ON 22
ci_0024                -1.143292e-02 3 1  ON 23
ci_0025                -2.124011e-03 3 1  ON 24
ci_0026                -2.505971e-03 3 1  ON 25
ci_0027                -1.209894e-02 3 1  ON 26
ci_0028                -1.154702e-02 3 1  ON 27
ci_0029                -1.065787e-02 3 1  ON 28
ci_0030                -1.054707e-02 3 1  ON 29
ci_0031                 1.343165e-02 3 1  ON 30
ci_0032                 1.206354e-02 3 1  ON 31
ci_0033                 7.738479e-03 3 1  ON 32
ci_0034                 8.466337e-03 3 1  ON 33
ci_0035                 4.847577e-03 3 1  ON 34
ci_0036                 4.896621e-03 3 1  ON 35
ci_0037                -1.130114e-02 3 1  ON 36
ci_0038                -1.136505e-02 3 1  ON 37
ci_0039                -4.014375e-03 3 1  ON 38
ci_0040                -3.907674e-03 3 1  ON 39
ci_0041                 9.080826e-03 3 1  ON 40
ci_0042                 8.727598e-03 3 1  ON 41
ci_0043                -1.292081e-02 3 1  ON 42
ci_0044                -1.375285e-02 3 1  ON 43
ci_0045                 1.064552e-02 3 1  ON 44
ci_0046                 1.007078e-02 3 1  ON 45
ci_0047                -3.594051e-03 3 1  ON 46
ci_0048                -3.466618e-03 3 1  ON 47
ci_0049                -2.580614e-03 3 1  ON 48
ci_0050                -2.680590e-03 3 1  ON 49
ci_0051                -1.745442e-03 3 1  ON 50
ci_0052                -2.048148e-03 3 1  ON 51
ci_0053                -3.952768e-03 3 1  ON 52
ci_0054                -3.298072e-03 3 1  ON 53
ci_0055                 2.491705e-03 3 1  ON 54
ci_0056                 2.213351e-03 3 1  ON 55
ci_0057                 2.429927e-03 3 1  ON 56
ci_0058                 2.892159e-03 3 1  ON 57
ci_0059                -3.409843e-03 3 1  ON 58
ci_0060                -3.354637e-03 3 1  ON 59
ci_0061                -4.008355e-03 3 1  ON 60
ci_0062                -3.946604e-03 3 1  ON 61
ci_0063                -9.792737e-03 3 1  ON 62
ci_0064                -9.360490e-03 3 1  ON 63
ci_0065                -6.441236e-03 3 1  ON 64
ci_0066                -6.111265e-03 3 1  ON 65
ci_0067                -3.746184e-03 3 1  ON 66
ci_0068                -3.445823e-03 3 1  ON 67
ci_0069                 3.627384e-03 3 1  ON 68
ci_0070                 3.336807e-03 3 1  ON 69
ci_0071                 2.956784e-03 3 1  ON 70
ci_0072                 3.500282e-03 3 1  ON 71
ci_0073                 3.527164e-03 3 1  ON 72
ci_0074                 3.551662e-03 3 1  ON 73
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 4.2799e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s020 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s020 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=20  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6904e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 20
    time step          = 0.05
    reference energy   = -16.9206
    reference variance = 0.268472
====================================================
  Execution time = 1.5212e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s020
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5260e+04
  VMC Eavg = -1.6899e+01
  VMC Evar = 3.0180e-01
  Total weights = 1.951091724e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 2.5927e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.286703994204
                                         uncertainty =       0.003617926177

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.286703994204
                                         uncertainty =       0.003617926177

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000378583330
  error estimate for blocks of size 2^( 2) =       0.000395711339
  error estimate for blocks of size 2^( 3) =       0.000412072248
  error estimate for blocks of size 2^( 4) =       0.000426372501
  error estimate for blocks of size 2^( 5) =       0.000436579235
  error estimate for blocks of size 2^( 6) =       0.000442645798
  error estimate for blocks of size 2^( 7) =       0.000446205976

      target function =      -0.909984528122
              le_mean =     -16.898775951492
             les_mean =     285.870426707343
             stat err =       0.000437950878
             autocorr =       1.338220959142
   target nu stat err =       0.000437950878
   target dn stat err =       0.007340107688
      target stat err =       0.011174424543
              std dev =       0.535397680097
             le_variance =       0.286650675853


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.689877595149e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 74
Check correct_vf_var_size: 225, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 3.9062e+01, overlap shift 3.9062e+02 and omega -1.7444e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.910120967358       residual = 9.57e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.910122140628       residual = 1.82e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.910122372204       residual = 6.38e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.910122505334       residual = 3.43e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.910122583154       residual = 1.97e-04           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.910122649995       residual = 1.60e-04           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.910122682845       residual = 1.23e-04           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.910122712681       residual = 1.94e-04           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.910122743567       residual = 1.08e-04           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.910122768548       residual = 2.92e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.910122773405       residual = 1.04e-05           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.910122772834       residual = 3.82e-06           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.910122771903       residual = 1.66e-06           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.910122772294       residual = 3.26e-07           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.910122772057       residual = 9.86e-08           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.910122771988       residual = 2.79e-08           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.910122771850       residual = 7.90e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         16 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 3.9062e+01 is 1.782911e-05

solving harmonic davidson linear method for identity shift 1.5625e+02, overlap shift 1.5625e+03 and omega -1.7444e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.910120967358       residual = 9.57e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.910121261104       residual = 1.82e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.910121319062       residual = 6.38e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.910121352369       residual = 3.42e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.910121371836       residual = 1.97e-04           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.910121388549       residual = 1.60e-04           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.910121396762       residual = 1.23e-04           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.910121404223       residual = 1.93e-04           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.910121411934       residual = 1.08e-04           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.910121418162       residual = 2.90e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.910121419370       residual = 1.03e-05           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.910121419226       residual = 3.79e-06           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.910121418993       residual = 1.64e-06           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.910121419091       residual = 3.24e-07           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.910121419031       residual = 9.77e-08           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.910121419014       residual = 2.77e-08           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.910121418980       residual = 7.82e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         16 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 1.5625e+02 is 4.457429e-06

solving harmonic davidson linear method for identity shift 6.2500e+02, overlap shift 6.2500e+03 and omega -1.7444e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.910120967358       residual = 9.57e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.910121040821       residual = 1.82e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.910121055315       residual = 6.38e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.910121063643       residual = 3.42e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.910121068511       residual = 1.97e-04           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.910121072689       residual = 1.60e-04           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.910121074743       residual = 1.23e-04           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.910121076608       residual = 1.93e-04           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.910121078535       residual = 1.08e-04           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.910121080091       residual = 2.90e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.910121080392       residual = 1.03e-05           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.910121080359       residual = 3.79e-06           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.910121080299       residual = 1.64e-06           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.910121080324       residual = 3.23e-07           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.910121080308       residual = 9.75e-08           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.910121080303       residual = 2.76e-08           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.910121080294       residual = 7.80e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         16 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 6.2500e+02 is 1.114367e-06

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.343527 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 75 and numParams is: 74

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.7819e+01
  </log>
  <optVariables href="H2O.s020.opt.xml">
ci_0001                 7.086870e-01 3 1  ON 0
ci_0002                 6.926552e-01 3 1  ON 1
ci_0003                -3.103863e-02 3 1  ON 2
ci_0004                -3.012671e-02 3 1  ON 3
ci_0005                -3.071471e-02 3 1  ON 4
ci_0006                -3.067813e-02 3 1  ON 5
ci_0007                -1.345556e-02 3 1  ON 6
ci_0008                -1.342456e-02 3 1  ON 7
ci_0009                -1.873486e-02 3 1  ON 8
ci_0010                -1.811554e-02 3 1  ON 9
ci_0011                -1.475332e-02 3 1  ON 10
ci_0012                -1.455304e-02 3 1  ON 11
ci_0013                 1.532154e-02 3 1  ON 12
ci_0014                 1.481945e-02 3 1  ON 13
ci_0015                 1.581925e-02 3 1  ON 14
ci_0016                 1.539728e-02 3 1  ON 15
ci_0017                 1.336821e-02 3 1  ON 16
ci_0018                 1.306239e-02 3 1  ON 17
ci_0019                 1.310193e-02 3 1  ON 18
ci_0020                 1.266599e-02 3 1  ON 19
ci_0021                 6.905981e-03 3 1  ON 20
ci_0022                 7.655353e-03 3 1  ON 21
ci_0023                -1.178447e-02 3 1  ON 22
ci_0024                -1.143372e-02 3 1  ON 23
ci_0025                -2.123982e-03 3 1  ON 24
ci_0026                -2.505858e-03 3 1  ON 25
ci_0027                -1.209946e-02 3 1  ON 26
ci_0028                -1.154753e-02 3 1  ON 27
ci_0029                -1.065814e-02 3 1  ON 28
ci_0030                -1.054726e-02 3 1  ON 29
ci_0031                 1.343063e-02 3 1  ON 30
ci_0032                 1.206407e-02 3 1  ON 31
ci_0033                 7.739149e-03 3 1  ON 32
ci_0034                 8.465890e-03 3 1  ON 33
ci_0035                 4.847252e-03 3 1  ON 34
ci_0036                 4.896592e-03 3 1  ON 35
ci_0037                -1.130094e-02 3 1  ON 36
ci_0038                -1.136506e-02 3 1  ON 37
ci_0039                -4.014337e-03 3 1  ON 38
ci_0040                -3.907492e-03 3 1  ON 39
ci_0041                 9.080974e-03 3 1  ON 40
ci_0042                 8.728060e-03 3 1  ON 41
ci_0043                -1.292133e-02 3 1  ON 42
ci_0044                -1.375174e-02 3 1  ON 43
ci_0045                 1.064538e-02 3 1  ON 44
ci_0046                 1.007098e-02 3 1  ON 45
ci_0047                -3.594037e-03 3 1  ON 46
ci_0048                -3.466824e-03 3 1  ON 47
ci_0049                -2.580206e-03 3 1  ON 48
ci_0050                -2.680386e-03 3 1  ON 49
ci_0051                -1.745457e-03 3 1  ON 50
ci_0052                -2.047861e-03 3 1  ON 51
ci_0053                -3.952511e-03 3 1  ON 52
ci_0054                -3.298025e-03 3 1  ON 53
ci_0055                 2.491701e-03 3 1  ON 54
ci_0056                 2.212008e-03 3 1  ON 55
ci_0057                 2.430150e-03 3 1  ON 56
ci_0058                 2.892580e-03 3 1  ON 57
ci_0059                -3.410230e-03 3 1  ON 58
ci_0060                -3.354122e-03 3 1  ON 59
ci_0061                -4.008860e-03 3 1  ON 60
ci_0062                -3.946545e-03 3 1  ON 61
ci_0063                -9.792355e-03 3 1  ON 62
ci_0064                -9.360842e-03 3 1  ON 63
ci_0065                -6.441324e-03 3 1  ON 64
ci_0066                -6.111078e-03 3 1  ON 65
ci_0067                -3.746223e-03 3 1  ON 66
ci_0068                -3.445520e-03 3 1  ON 67
ci_0069                 3.627552e-03 3 1  ON 68
ci_0070                 3.336451e-03 3 1  ON 69
ci_0071                 2.956683e-03 3 1  ON 70
ci_0072                 3.499438e-03 3 1  ON 71
ci_0073                 3.527355e-03 3 1  ON 72
ci_0074                 3.551275e-03 3 1  ON 73
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 20
    time step          = 0.05
    reference energy   = -16.9336
    reference variance = 0.209385
====================================================
  Execution time = 1.4128e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s020
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6899e+01
  VMC Evar = 2.9151e-01
  Total weights = 1.9509e+06
  Execution time = 1.8748e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.282034987395
                                         uncertainty =       0.001609403147

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.282034987395
                                         uncertainty =       0.001609403147

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000375498701
  error estimate for blocks of size 2^( 2) =       0.000392911529
  error estimate for blocks of size 2^( 3) =       0.000410639898
  error estimate for blocks of size 2^( 4) =       0.000425744040
  error estimate for blocks of size 2^( 5) =       0.000437444369
  error estimate for blocks of size 2^( 6) =       0.000443535575
  error estimate for blocks of size 2^( 7) =       0.000449457558

      target function =      -0.926006682934
              le_mean =     -16.898885417486
             les_mean =     285.863842044931
             stat err =       0.000439045385
             autocorr =       1.367105266245
   target nu stat err =       0.000439045385
   target dn stat err =       0.002394789320
      target stat err =       0.003840578669
              std dev =       0.531035355403
             le_variance =       0.281998548688

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.282033753044
                                         uncertainty =       0.001609186542

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.282033753044
                                         uncertainty =       0.001609186542

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000375497883
  error estimate for blocks of size 2^( 2) =       0.000392910673
  error estimate for blocks of size 2^( 3) =       0.000410639021
  error estimate for blocks of size 2^( 4) =       0.000425743204
  error estimate for blocks of size 2^( 5) =       0.000437443499
  error estimate for blocks of size 2^( 6) =       0.000443534657
  error estimate for blocks of size 2^( 7) =       0.000449456731

      target function =      -0.926008327676
              le_mean =     -16.898885341699
             les_mean =     285.863838441053
             stat err =       0.000439044523
             autocorr =       1.367105853229
   target nu stat err =       0.000439044523
   target dn stat err =       0.002394323204
      target stat err =       0.003839871885
              std dev =       0.531034198128
             le_variance =       0.281997319582

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.282034368528
                                         uncertainty =       0.001609294638

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.282034368528
                                         uncertainty =       0.001609294638

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000375498291
  error estimate for blocks of size 2^( 2) =       0.000392911100
  error estimate for blocks of size 2^( 3) =       0.000410639458
  error estimate for blocks of size 2^( 4) =       0.000425743621
  error estimate for blocks of size 2^( 5) =       0.000437443933
  error estimate for blocks of size 2^( 6) =       0.000443535115
  error estimate for blocks of size 2^( 7) =       0.000449457143

      target function =      -0.926008181532
              le_mean =     -16.898885379474
             les_mean =     285.863839809144
             stat err =       0.000439044953
             autocorr =       1.367105560243
   target nu stat err =       0.000439044953
   target dn stat err =       0.002394553230
      target stat err =       0.003840226099
              std dev =       0.531034775174
             le_variance =       0.281997932444

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.282034909896
                                         uncertainty =       0.001609389567

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.282034909896
                                         uncertainty =       0.001609389567

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000375498649
  error estimate for blocks of size 2^( 2) =       0.000392911475
  error estimate for blocks of size 2^( 3) =       0.000410639843
  error estimate for blocks of size 2^( 4) =       0.000425743987
  error estimate for blocks of size 2^( 5) =       0.000437444314
  error estimate for blocks of size 2^( 6) =       0.000443535518
  error estimate for blocks of size 2^( 7) =       0.000449457506

      target function =      -0.926006913838
              le_mean =     -16.898885412724
             les_mean =     285.863841737394
             stat err =       0.000439045331
             autocorr =       1.367105303071
   target nu stat err =       0.000439045331
   target dn stat err =       0.002394759538
      target stat err =       0.003840534534
              std dev =       0.531035282741
             le_variance =       0.281998471516


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.926006682934        initial
     3.9062e+01     3.9062e+02             1.7829e-05        -0.926008327676  <--
     1.5625e+02     1.5625e+03             4.4574e-06        -0.926008181532
     6.2500e+02     6.2500e+03             1.1144e-06        -0.926006913838

*****************************************************************************
Applying the update for shift_i =   3.9062e+01     and shift_s =   3.9062e+02
*****************************************************************************

  Execution time = 2.3639e+01
  </log>
  <optVariables href="H2O.s020.opt.xml">
ci_0001                 7.087001e-01 3 1  ON 0
ci_0002                 6.926418e-01 3 1  ON 1
ci_0003                -3.104001e-02 3 1  ON 2
ci_0004                -3.012720e-02 3 1  ON 3
ci_0005                -3.071688e-02 3 1  ON 4
ci_0006                -3.067436e-02 3 1  ON 5
ci_0007                -1.345487e-02 3 1  ON 6
ci_0008                -1.342274e-02 3 1  ON 7
ci_0009                -1.873628e-02 3 1  ON 8
ci_0010                -1.811520e-02 3 1  ON 9
ci_0011                -1.475288e-02 3 1  ON 10
ci_0012                -1.455308e-02 3 1  ON 11
ci_0013                 1.532214e-02 3 1  ON 12
ci_0014                 1.481796e-02 3 1  ON 13
ci_0015                 1.581969e-02 3 1  ON 14
ci_0016                 1.539842e-02 3 1  ON 15
ci_0017                 1.336675e-02 3 1  ON 16
ci_0018                 1.306190e-02 3 1  ON 17
ci_0019                 1.310071e-02 3 1  ON 18
ci_0020                 1.266804e-02 3 1  ON 19
ci_0021                 6.903617e-03 3 1  ON 20
ci_0022                 7.655001e-03 3 1  ON 21
ci_0023                -1.178447e-02 3 1  ON 22
ci_0024                -1.143611e-02 3 1  ON 23
ci_0025                -2.123894e-03 3 1  ON 24
ci_0026                -2.505521e-03 3 1  ON 25
ci_0027                -1.210103e-02 3 1  ON 26
ci_0028                -1.154906e-02 3 1  ON 27
ci_0029                -1.065896e-02 3 1  ON 28
ci_0030                -1.054783e-02 3 1  ON 29
ci_0031                 1.342755e-02 3 1  ON 30
ci_0032                 1.206566e-02 3 1  ON 31
ci_0033                 7.741158e-03 3 1  ON 32
ci_0034                 8.464550e-03 3 1  ON 33
ci_0035                 4.846281e-03 3 1  ON 34
ci_0036                 4.896504e-03 3 1  ON 35
ci_0037                -1.130034e-02 3 1  ON 36
ci_0038                -1.136510e-02 3 1  ON 37
ci_0039                -4.014223e-03 3 1  ON 38
ci_0040                -3.906945e-03 3 1  ON 39
ci_0041                 9.081418e-03 3 1  ON 40
ci_0042                 8.729444e-03 3 1  ON 41
ci_0043                -1.292290e-02 3 1  ON 42
ci_0044                -1.374843e-02 3 1  ON 43
ci_0045                 1.064493e-02 3 1  ON 44
ci_0046                 1.007159e-02 3 1  ON 45
ci_0047                -3.593994e-03 3 1  ON 46
ci_0048                -3.467441e-03 3 1  ON 47
ci_0049                -2.578984e-03 3 1  ON 48
ci_0050                -2.679777e-03 3 1  ON 49
ci_0051                -1.745502e-03 3 1  ON 50
ci_0052                -2.047000e-03 3 1  ON 51
ci_0053                -3.951740e-03 3 1  ON 52
ci_0054                -3.297884e-03 3 1  ON 53
ci_0055                 2.491692e-03 3 1  ON 54
ci_0056                 2.207989e-03 3 1  ON 55
ci_0057                 2.430818e-03 3 1  ON 56
ci_0058                 2.893838e-03 3 1  ON 57
ci_0059                -3.411391e-03 3 1  ON 58
ci_0060                -3.352582e-03 3 1  ON 59
ci_0061                -4.010371e-03 3 1  ON 60
ci_0062                -3.946367e-03 3 1  ON 61
ci_0063                -9.791214e-03 3 1  ON 62
ci_0064                -9.361894e-03 3 1  ON 63
ci_0065                -6.441586e-03 3 1  ON 64
ci_0066                -6.110519e-03 3 1  ON 65
ci_0067                -3.746343e-03 3 1  ON 66
ci_0068                -3.444613e-03 3 1  ON 67
ci_0069                 3.628058e-03 3 1  ON 68
ci_0070                 3.335387e-03 3 1  ON 69
ci_0071                 2.956379e-03 3 1  ON 70
ci_0072                 3.496914e-03 3 1  ON 71
ci_0073                 3.527926e-03 3 1  ON 72
ci_0074                 3.550118e-03 3 1  ON 73
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 4.1464e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s021 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s021 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=21  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6905e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 21
    time step          = 0.05
    reference energy   = -16.9357
    reference variance = 0.262273
====================================================
  Execution time = 1.4163e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s021
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5261e+04
  VMC Eavg = -1.6899e+01
  VMC Evar = 3.0066e-01
  Total weights = 1.950686379e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 2.5580e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.286736538615
                                         uncertainty =       0.003183087285

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.286736538615
                                         uncertainty =       0.003183087285

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000378594584
  error estimate for blocks of size 2^( 2) =       0.000395318850
  error estimate for blocks of size 2^( 3) =       0.000412107330
  error estimate for blocks of size 2^( 4) =       0.000427861369
  error estimate for blocks of size 2^( 5) =       0.000439302253
  error estimate for blocks of size 2^( 6) =       0.000446626221
  error estimate for blocks of size 2^( 7) =       0.000448564761

      target function =      -0.911785031554
              le_mean =     -16.898877627595
             les_mean =     285.872727988129
             stat err =       0.000440588651
             autocorr =       1.354309171269
   target nu stat err =       0.000440588651
   target dn stat err =       0.005012180316
      target stat err =       0.007680501711
              std dev =       0.535413594694
             le_variance =       0.286667717383


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.689887762760e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 74
Check correct_vf_var_size: 225, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 9.7656e+00, overlap shift 9.7656e+01 and omega -1.7444e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.911847907638       residual = 1.38e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.911855091040       residual = 2.47e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.911856475091       residual = 7.31e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.911857176886       residual = 7.18e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.911857869810       residual = 2.39e-04           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.911858042161       residual = 1.55e-04           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.911858108237       residual = 1.08e-04           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.911858196440       residual = 1.20e-04           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.911858293962       residual = 1.28e-04           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.911858427380       residual = 4.96e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.911858473699       residual = 2.43e-05           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.911858469205       residual = 7.94e-06           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.911858464088       residual = 3.24e-06           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.911858463565       residual = 7.68e-07           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.911858464668       residual = 1.86e-07           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.911858464248       residual = 5.75e-08           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.911858463902       residual = 1.78e-08           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.911858463626       residual = 6.75e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         17 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 9.7656e+00 is 7.080151e-05

solving harmonic davidson linear method for identity shift 3.9062e+01, overlap shift 3.9062e+02 and omega -1.7444e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.911847907638       residual = 1.38e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.911849714049       residual = 2.46e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.911850061684       residual = 7.29e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.911850237679       residual = 7.16e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.911850411192       residual = 2.38e-04           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.911850454143       residual = 1.54e-04           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.911850470616       residual = 1.07e-04           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.911850492716       residual = 1.19e-04           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.911850517079       residual = 1.27e-04           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.911850550237       residual = 4.88e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.911850561637       residual = 2.38e-05           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.911850560443       residual = 7.74e-06           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.911850559158       residual = 3.15e-06           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.911850559025       residual = 7.44e-07           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.911850559297       residual = 1.80e-07           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.911850559193       residual = 5.55e-08           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.911850559107       residual = 1.72e-08           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.911850559039       residual = 6.47e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         17 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 3.9062e+01 is 1.770359e-05

solving harmonic davidson linear method for identity shift 1.5625e+02, overlap shift 1.5625e+03 and omega -1.7444e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.911847907638       residual = 1.38e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.911848359906       residual = 2.46e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.911848446917       residual = 7.29e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.911848490950       residual = 7.15e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.911848534345       residual = 2.38e-04           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.911848545074       residual = 1.54e-04           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.911848549190       residual = 1.07e-04           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.911848554718       residual = 1.19e-04           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.911848560807       residual = 1.27e-04           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.911848569084       residual = 4.86e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.911848571923       residual = 2.37e-05           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.911848571621       residual = 7.69e-06           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.911848571299       residual = 3.13e-06           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.911848571266       residual = 7.38e-07           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.911848571333       residual = 1.78e-07           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.911848571307       residual = 5.50e-08           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.911848571286       residual = 1.70e-08           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.911848571269       residual = 6.41e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         17 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 1.5625e+02 is 4.426100e-06

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.353662 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 75 and numParams is: 74

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.6736e+01
  </log>
  <optVariables href="H2O.s021.opt.xml">
ci_0001                 7.087178e-01 3 1  ON 0
ci_0002                 6.926242e-01 3 1  ON 1
ci_0003                -3.103993e-02 3 1  ON 2
ci_0004                -3.012353e-02 3 1  ON 3
ci_0005                -3.071662e-02 3 1  ON 4
ci_0006                -3.067622e-02 3 1  ON 5
ci_0007                -1.345406e-02 3 1  ON 6
ci_0008                -1.342173e-02 3 1  ON 7
ci_0009                -1.873506e-02 3 1  ON 8
ci_0010                -1.811438e-02 3 1  ON 9
ci_0011                -1.475278e-02 3 1  ON 10
ci_0012                -1.455277e-02 3 1  ON 11
ci_0013                 1.532252e-02 3 1  ON 12
ci_0014                 1.482048e-02 3 1  ON 13
ci_0015                 1.581979e-02 3 1  ON 14
ci_0016                 1.539585e-02 3 1  ON 15
ci_0017                 1.336793e-02 3 1  ON 16
ci_0018                 1.306137e-02 3 1  ON 17
ci_0019                 1.310152e-02 3 1  ON 18
ci_0020                 1.266667e-02 3 1  ON 19
ci_0021                 6.898756e-03 3 1  ON 20
ci_0022                 7.642734e-03 3 1  ON 21
ci_0023                -1.178469e-02 3 1  ON 22
ci_0024                -1.143718e-02 3 1  ON 23
ci_0025                -2.123343e-03 3 1  ON 24
ci_0026                -2.504569e-03 3 1  ON 25
ci_0027                -1.209917e-02 3 1  ON 26
ci_0028                -1.154970e-02 3 1  ON 27
ci_0029                -1.065827e-02 3 1  ON 28
ci_0030                -1.055009e-02 3 1  ON 29
ci_0031                 1.342969e-02 3 1  ON 30
ci_0032                 1.206471e-02 3 1  ON 31
ci_0033                 7.742540e-03 3 1  ON 32
ci_0034                 8.463578e-03 3 1  ON 33
ci_0035                 4.844529e-03 3 1  ON 34
ci_0036                 4.889474e-03 3 1  ON 35
ci_0037                -1.129865e-02 3 1  ON 36
ci_0038                -1.136403e-02 3 1  ON 37
ci_0039                -4.013207e-03 3 1  ON 38
ci_0040                -3.906790e-03 3 1  ON 39
ci_0041                 9.082117e-03 3 1  ON 40
ci_0042                 8.730075e-03 3 1  ON 41
ci_0043                -1.292552e-02 3 1  ON 42
ci_0044                -1.374624e-02 3 1  ON 43
ci_0045                 1.064521e-02 3 1  ON 44
ci_0046                 1.006940e-02 3 1  ON 45
ci_0047                -3.593071e-03 3 1  ON 46
ci_0048                -3.467562e-03 3 1  ON 47
ci_0049                -2.577946e-03 3 1  ON 48
ci_0050                -2.680288e-03 3 1  ON 49
ci_0051                -1.744522e-03 3 1  ON 50
ci_0052                -2.046312e-03 3 1  ON 51
ci_0053                -3.951367e-03 3 1  ON 52
ci_0054                -3.296980e-03 3 1  ON 53
ci_0055                 2.492989e-03 3 1  ON 54
ci_0056                 2.202988e-03 3 1  ON 55
ci_0057                 2.433597e-03 3 1  ON 56
ci_0058                 2.892802e-03 3 1  ON 57
ci_0059                -3.412183e-03 3 1  ON 58
ci_0060                -3.352271e-03 3 1  ON 59
ci_0061                -4.009678e-03 3 1  ON 60
ci_0062                -3.948055e-03 3 1  ON 61
ci_0063                -9.790601e-03 3 1  ON 62
ci_0064                -9.362705e-03 3 1  ON 63
ci_0065                -6.440976e-03 3 1  ON 64
ci_0066                -6.109547e-03 3 1  ON 65
ci_0067                -3.748050e-03 3 1  ON 66
ci_0068                -3.443377e-03 3 1  ON 67
ci_0069                 3.627659e-03 3 1  ON 68
ci_0070                 3.336077e-03 3 1  ON 69
ci_0071                 2.957441e-03 3 1  ON 70
ci_0072                 3.494172e-03 3 1  ON 71
ci_0073                 3.528275e-03 3 1  ON 72
ci_0074                 3.546369e-03 3 1  ON 73
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 21
    time step          = 0.05
    reference energy   = -16.9553
    reference variance = 0.270363
====================================================
  Execution time = 1.4045e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s021
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6898e+01
  VMC Evar = 2.8964e-01
  Total weights = 1.9514e+06
  Execution time = 1.9856e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.280729557639
                                         uncertainty =       0.001706745272

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.280729557639
                                         uncertainty =       0.001706745272

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000374671817
  error estimate for blocks of size 2^( 2) =       0.000391752921
  error estimate for blocks of size 2^( 3) =       0.000408920230
  error estimate for blocks of size 2^( 4) =       0.000423691633
  error estimate for blocks of size 2^( 5) =       0.000434371379
  error estimate for blocks of size 2^( 6) =       0.000441805894
  error estimate for blocks of size 2^( 7) =       0.000446159216

      target function =      -0.928971046763
              le_mean =     -16.898293548161
             les_mean =     285.841955114581
             stat err =       0.000436507030
             autocorr =       1.357314328007
   target nu stat err =       0.000436507030
   target dn stat err =       0.001939520115
      target stat err =       0.003156182383
              std dev =       0.529865964577
             le_variance =       0.280757940417

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.280726342081
                                         uncertainty =       0.001706572201

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.280726342081
                                         uncertainty =       0.001706572201

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000374669679
  error estimate for blocks of size 2^( 2) =       0.000391751247
  error estimate for blocks of size 2^( 3) =       0.000408918602
  error estimate for blocks of size 2^( 4) =       0.000423690501
  error estimate for blocks of size 2^( 5) =       0.000434370429
  error estimate for blocks of size 2^( 6) =       0.000441804538
  error estimate for blocks of size 2^( 7) =       0.000446158652

      target function =      -0.928930911733
              le_mean =     -16.898293780806
             les_mean =     285.841988343332
             stat err =       0.000436506030
             autocorr =       1.357323596122
   target nu stat err =       0.000436506030
   target dn stat err =       0.001941943664
      target stat err =       0.003159643255
              std dev =       0.529862941099
             le_variance =       0.280754736350

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.280727925626
                                         uncertainty =       0.001706658248

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.280727925626
                                         uncertainty =       0.001706658248

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000374670732
  error estimate for blocks of size 2^( 2) =       0.000391752065
  error estimate for blocks of size 2^( 3) =       0.000408919400
  error estimate for blocks of size 2^( 4) =       0.000423691064
  error estimate for blocks of size 2^( 5) =       0.000434370909
  error estimate for blocks of size 2^( 6) =       0.000441805226
  error estimate for blocks of size 2^( 7) =       0.000446158928

      target function =      -0.928800730298
              le_mean =     -16.898293659620
             les_mean =     285.842066568837
             stat err =       0.000436506532
             autocorr =       1.357319087301
   target nu stat err =       0.000436506532
   target dn stat err =       0.001943493367
      target stat err =       0.003161163104
              std dev =       0.529864430006
             le_variance =       0.280756314185

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.280729351399
                                         uncertainty =       0.001706734363

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.280729351399
                                         uncertainty =       0.001706734363

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000374671680
  error estimate for blocks of size 2^( 2) =       0.000391752813
  error estimate for blocks of size 2^( 3) =       0.000408920125
  error estimate for blocks of size 2^( 4) =       0.000423691560
  error estimate for blocks of size 2^( 5) =       0.000434371318
  error estimate for blocks of size 2^( 6) =       0.000441805808
  error estimate for blocks of size 2^( 7) =       0.000446159178

      target function =      -0.928968469588
              le_mean =     -16.898293562121
             les_mean =     285.841957215254
             stat err =       0.000436506966
             autocorr =       1.357314920784
   target nu stat err =       0.000436506966
   target dn stat err =       0.001939657555
      target stat err =       0.003156376671
              std dev =       0.529865770646
             le_variance =       0.280757734902


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.928971046763        initial  <--
     9.7656e+00     9.7656e+01             7.0802e-05        -0.928930911733
     3.9062e+01     3.9062e+02             1.7704e-05        -0.928800730298
     1.5625e+02     1.5625e+03             4.4261e-06        -0.928968469588

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 23.5882
  </log>
  <optVariables href="H2O.s021.opt.xml">
ci_0001                 7.087001e-01 3 1  ON 0
ci_0002                 6.926418e-01 3 1  ON 1
ci_0003                -3.104001e-02 3 1  ON 2
ci_0004                -3.012720e-02 3 1  ON 3
ci_0005                -3.071688e-02 3 1  ON 4
ci_0006                -3.067436e-02 3 1  ON 5
ci_0007                -1.345487e-02 3 1  ON 6
ci_0008                -1.342274e-02 3 1  ON 7
ci_0009                -1.873628e-02 3 1  ON 8
ci_0010                -1.811520e-02 3 1  ON 9
ci_0011                -1.475288e-02 3 1  ON 10
ci_0012                -1.455308e-02 3 1  ON 11
ci_0013                 1.532214e-02 3 1  ON 12
ci_0014                 1.481796e-02 3 1  ON 13
ci_0015                 1.581969e-02 3 1  ON 14
ci_0016                 1.539842e-02 3 1  ON 15
ci_0017                 1.336675e-02 3 1  ON 16
ci_0018                 1.306190e-02 3 1  ON 17
ci_0019                 1.310071e-02 3 1  ON 18
ci_0020                 1.266804e-02 3 1  ON 19
ci_0021                 6.903617e-03 3 1  ON 20
ci_0022                 7.655001e-03 3 1  ON 21
ci_0023                -1.178447e-02 3 1  ON 22
ci_0024                -1.143611e-02 3 1  ON 23
ci_0025                -2.123894e-03 3 1  ON 24
ci_0026                -2.505521e-03 3 1  ON 25
ci_0027                -1.210103e-02 3 1  ON 26
ci_0028                -1.154906e-02 3 1  ON 27
ci_0029                -1.065896e-02 3 1  ON 28
ci_0030                -1.054783e-02 3 1  ON 29
ci_0031                 1.342755e-02 3 1  ON 30
ci_0032                 1.206566e-02 3 1  ON 31
ci_0033                 7.741158e-03 3 1  ON 32
ci_0034                 8.464550e-03 3 1  ON 33
ci_0035                 4.846281e-03 3 1  ON 34
ci_0036                 4.896504e-03 3 1  ON 35
ci_0037                -1.130034e-02 3 1  ON 36
ci_0038                -1.136510e-02 3 1  ON 37
ci_0039                -4.014223e-03 3 1  ON 38
ci_0040                -3.906945e-03 3 1  ON 39
ci_0041                 9.081418e-03 3 1  ON 40
ci_0042                 8.729444e-03 3 1  ON 41
ci_0043                -1.292290e-02 3 1  ON 42
ci_0044                -1.374843e-02 3 1  ON 43
ci_0045                 1.064493e-02 3 1  ON 44
ci_0046                 1.007159e-02 3 1  ON 45
ci_0047                -3.593994e-03 3 1  ON 46
ci_0048                -3.467441e-03 3 1  ON 47
ci_0049                -2.578984e-03 3 1  ON 48
ci_0050                -2.679777e-03 3 1  ON 49
ci_0051                -1.745502e-03 3 1  ON 50
ci_0052                -2.047000e-03 3 1  ON 51
ci_0053                -3.951740e-03 3 1  ON 52
ci_0054                -3.297884e-03 3 1  ON 53
ci_0055                 2.491692e-03 3 1  ON 54
ci_0056                 2.207989e-03 3 1  ON 55
ci_0057                 2.430818e-03 3 1  ON 56
ci_0058                 2.893838e-03 3 1  ON 57
ci_0059                -3.411391e-03 3 1  ON 58
ci_0060                -3.352582e-03 3 1  ON 59
ci_0061                -4.010371e-03 3 1  ON 60
ci_0062                -3.946367e-03 3 1  ON 61
ci_0063                -9.791214e-03 3 1  ON 62
ci_0064                -9.361894e-03 3 1  ON 63
ci_0065                -6.441586e-03 3 1  ON 64
ci_0066                -6.110519e-03 3 1  ON 65
ci_0067                -3.746343e-03 3 1  ON 66
ci_0068                -3.444613e-03 3 1  ON 67
ci_0069                 3.628058e-03 3 1  ON 68
ci_0070                 3.335387e-03 3 1  ON 69
ci_0071                 2.956379e-03 3 1  ON 70
ci_0072                 3.496914e-03 3 1  ON 71
ci_0073                 3.527926e-03 3 1  ON 72
ci_0074                 3.550118e-03 3 1  ON 73
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 4.0341e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s022 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s022 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=22  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6907e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 22
    time step          = 0.05
    reference energy   = -16.936
    reference variance = 0.262494
====================================================
  Execution time = 1.4150e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s022
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5236e+04
  VMC Eavg = -1.6899e+01
  VMC Evar = 2.9405e-01
  Total weights = 1.951271984e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 2.5912e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.283084946266
                                         uncertainty =       0.002487584704

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.283084946266
                                         uncertainty =       0.002487584704

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000376193604
  error estimate for blocks of size 2^( 2) =       0.000393176007
  error estimate for blocks of size 2^( 3) =       0.000409614860
  error estimate for blocks of size 2^( 4) =       0.000424391569
  error estimate for blocks of size 2^( 5) =       0.000436083952
  error estimate for blocks of size 2^( 6) =       0.000444003096
  error estimate for blocks of size 2^( 7) =       0.000447914030

      target function =      -0.922007020109
              le_mean =     -16.898741400458
             les_mean =     285.861507596510
             stat err =       0.000438098162
             autocorr =       1.356188468334
   target nu stat err =       0.000438098162
   target dn stat err =       0.004166203142
      target stat err =       0.006538332359
              std dev =       0.532018096476
             le_variance =       0.283043254978


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.689874140046e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 74
Check correct_vf_var_size: 225, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 9.7656e+01, overlap shift 9.7656e+02 and omega -1.7444e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.922052060525       residual = 3.88e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.922053281603       residual = 1.37e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.922053360614       residual = 4.08e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.922053389315       residual = 1.34e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.922053400722       residual = 5.09e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.922053405988       residual = 3.93e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.922053408514       residual = 1.72e-05           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.922053407000       residual = 7.65e-06           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.922053407253       residual = 7.68e-06           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.922053409021       residual = 6.36e-06           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.922053409561       residual = 5.26e-06           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.922053408663       residual = 1.76e-06           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.922053409054       residual = 5.25e-07           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.922053408719       residual = 1.67e-07           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.922053408658       residual = 6.23e-08           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.922053408703       residual = 1.41e-08           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.922053408708       residual = 3.51e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         16 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 9.7656e+01 is 2.888472e-06

solving harmonic davidson linear method for identity shift 3.9062e+02, overlap shift 3.9062e+03 and omega -1.7444e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.922052060525       residual = 3.88e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.922052365984       residual = 1.37e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.922052385747       residual = 4.08e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.922052392925       residual = 1.34e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.922052395777       residual = 5.09e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.922052397094       residual = 3.92e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.922052397725       residual = 1.72e-05           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.922052397346       residual = 7.65e-06           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.922052397409       residual = 7.68e-06           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.922052397852       residual = 6.36e-06           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.922052397986       residual = 5.25e-06           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.922052397762       residual = 1.76e-06           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.922052397859       residual = 5.23e-07           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.922052397776       residual = 1.67e-07           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.922052397760       residual = 6.21e-08           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.922052397772       residual = 1.40e-08           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.922052397774       residual = 3.50e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         16 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 3.9062e+02 is 7.225654e-07

solving harmonic davidson linear method for identity shift 1.5625e+03, overlap shift 1.5625e+04 and omega -1.7444e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.922052060525       residual = 3.88e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.922052136901       residual = 1.37e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.922052141843       residual = 4.08e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.922052143637       residual = 1.34e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.922052144350       residual = 5.09e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.922052144681       residual = 3.92e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.922052144842       residual = 1.72e-05           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.922052144744       residual = 7.65e-06           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.922052144757       residual = 7.68e-06           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.922052144866       residual = 6.35e-06           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.922052144908       residual = 5.25e-06           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.922052144846       residual = 1.76e-06           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.922052144870       residual = 5.23e-07           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.922052144854       residual = 1.66e-07           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.922052144847       residual = 6.20e-08           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.922052144851       residual = 1.40e-08           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.922052144846       residual = 3.50e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         16 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 1.5625e+03 is 1.806693e-07

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.362806 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 75 and numParams is: 74

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.6756e+01
  </log>
  <optVariables href="H2O.s022.opt.xml">
ci_0001                 7.086996e-01 3 1  ON 0
ci_0002                 6.926423e-01 3 1  ON 1
ci_0003                -3.103991e-02 3 1  ON 2
ci_0004                -3.012727e-02 3 1  ON 3
ci_0005                -3.071669e-02 3 1  ON 4
ci_0006                -3.067417e-02 3 1  ON 5
ci_0007                -1.345461e-02 3 1  ON 6
ci_0008                -1.342265e-02 3 1  ON 7
ci_0009                -1.873607e-02 3 1  ON 8
ci_0010                -1.811524e-02 3 1  ON 9
ci_0011                -1.475291e-02 3 1  ON 10
ci_0012                -1.455300e-02 3 1  ON 11
ci_0013                 1.532219e-02 3 1  ON 12
ci_0014                 1.481803e-02 3 1  ON 13
ci_0015                 1.581978e-02 3 1  ON 14
ci_0016                 1.539849e-02 3 1  ON 15
ci_0017                 1.336662e-02 3 1  ON 16
ci_0018                 1.306189e-02 3 1  ON 17
ci_0019                 1.310064e-02 3 1  ON 18
ci_0020                 1.266820e-02 3 1  ON 19
ci_0021                 6.903438e-03 3 1  ON 20
ci_0022                 7.654823e-03 3 1  ON 21
ci_0023                -1.178458e-02 3 1  ON 22
ci_0024                -1.143613e-02 3 1  ON 23
ci_0025                -2.123948e-03 3 1  ON 24
ci_0026                -2.505434e-03 3 1  ON 25
ci_0027                -1.210091e-02 3 1  ON 26
ci_0028                -1.154901e-02 3 1  ON 27
ci_0029                -1.065915e-02 3 1  ON 28
ci_0030                -1.054780e-02 3 1  ON 29
ci_0031                 1.342777e-02 3 1  ON 30
ci_0032                 1.206573e-02 3 1  ON 31
ci_0033                 7.741231e-03 3 1  ON 32
ci_0034                 8.464512e-03 3 1  ON 33
ci_0035                 4.845898e-03 3 1  ON 34
ci_0036                 4.896486e-03 3 1  ON 35
ci_0037                -1.130049e-02 3 1  ON 36
ci_0038                -1.136500e-02 3 1  ON 37
ci_0039                -4.014203e-03 3 1  ON 38
ci_0040                -3.906948e-03 3 1  ON 39
ci_0041                 9.081436e-03 3 1  ON 40
ci_0042                 8.729512e-03 3 1  ON 41
ci_0043                -1.292313e-02 3 1  ON 42
ci_0044                -1.374860e-02 3 1  ON 43
ci_0045                 1.064494e-02 3 1  ON 44
ci_0046                 1.007155e-02 3 1  ON 45
ci_0047                -3.594000e-03 3 1  ON 46
ci_0048                -3.467324e-03 3 1  ON 47
ci_0049                -2.579100e-03 3 1  ON 48
ci_0050                -2.679668e-03 3 1  ON 49
ci_0051                -1.745610e-03 3 1  ON 50
ci_0052                -2.047216e-03 3 1  ON 51
ci_0053                -3.952051e-03 3 1  ON 52
ci_0054                -3.297908e-03 3 1  ON 53
ci_0055                 2.491677e-03 3 1  ON 54
ci_0056                 2.207793e-03 3 1  ON 55
ci_0057                 2.430745e-03 3 1  ON 56
ci_0058                 2.893888e-03 3 1  ON 57
ci_0059                -3.411301e-03 3 1  ON 58
ci_0060                -3.352528e-03 3 1  ON 59
ci_0061                -4.010439e-03 3 1  ON 60
ci_0062                -3.946378e-03 3 1  ON 61
ci_0063                -9.791204e-03 3 1  ON 62
ci_0064                -9.361905e-03 3 1  ON 63
ci_0065                -6.441586e-03 3 1  ON 64
ci_0066                -6.110532e-03 3 1  ON 65
ci_0067                -3.745620e-03 3 1  ON 66
ci_0068                -3.444632e-03 3 1  ON 67
ci_0069                 3.627949e-03 3 1  ON 68
ci_0070                 3.335324e-03 3 1  ON 69
ci_0071                 2.955668e-03 3 1  ON 70
ci_0072                 3.497024e-03 3 1  ON 71
ci_0073                 3.527856e-03 3 1  ON 72
ci_0074                 3.550145e-03 3 1  ON 73
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 22
    time step          = 0.05
    reference energy   = -16.8753
    reference variance = 0.31894
====================================================
  Execution time = 1.4086e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s022
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6899e+01
  VMC Evar = 2.9320e-01
  Total weights = 1.9507e+06
  Execution time = 1.8714e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.283803339518
                                         uncertainty =       0.001743282710

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.283803339518
                                         uncertainty =       0.001743282710

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000376656397
  error estimate for blocks of size 2^( 2) =       0.000393519362
  error estimate for blocks of size 2^( 3) =       0.000411082126
  error estimate for blocks of size 2^( 4) =       0.000426216692
  error estimate for blocks of size 2^( 5) =       0.000437830549
  error estimate for blocks of size 2^( 6) =       0.000445780450
  error estimate for blocks of size 2^( 7) =       0.000449383632

      target function =      -0.923362614211
              le_mean =     -16.898552491463
             les_mean =     285.854275053649
             stat err =       0.000439802831
             autocorr =       1.363406448995
   target nu stat err =       0.000439802831
   target dn stat err =       0.002129959227
      target stat err =       0.003411908311
              std dev =       0.532672585530
             le_variance =       0.283740083376

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.283803356802
                                         uncertainty =       0.001743250986

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.283803356802
                                         uncertainty =       0.001743250986

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000376656409
  error estimate for blocks of size 2^( 2) =       0.000393519327
  error estimate for blocks of size 2^( 3) =       0.000411082046
  error estimate for blocks of size 2^( 4) =       0.000426216604
  error estimate for blocks of size 2^( 5) =       0.000437830517
  error estimate for blocks of size 2^( 6) =       0.000445780464
  error estimate for blocks of size 2^( 7) =       0.000449383595

      target function =      -0.923355972434
              le_mean =     -16.898552512922
             les_mean =     285.854280027371
             stat err =       0.000439802795
             autocorr =       1.363406146684
   target nu stat err =       0.000439802795
   target dn stat err =       0.002130025492
      target stat err =       0.003411961611
              std dev =       0.532672601632
             le_variance =       0.283740100529

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.283803347992
                                         uncertainty =       0.001743266833

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.283803347992
                                         uncertainty =       0.001743266833

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000376656403
  error estimate for blocks of size 2^( 2) =       0.000393519345
  error estimate for blocks of size 2^( 3) =       0.000411082086
  error estimate for blocks of size 2^( 4) =       0.000426216648
  error estimate for blocks of size 2^( 5) =       0.000437830533
  error estimate for blocks of size 2^( 6) =       0.000445780457
  error estimate for blocks of size 2^( 7) =       0.000449383613

      target function =      -0.923359423851
              le_mean =     -16.898552502180
             les_mean =     285.854277456588
             stat err =       0.000439802813
             autocorr =       1.363406297918
   target nu stat err =       0.000439802813
   target dn stat err =       0.002129990581
      target stat err =       0.003411933189
              std dev =       0.532672593423
             le_variance =       0.283740091784

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.283803340557
                                         uncertainty =       0.001743280724

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.283803340557
                                         uncertainty =       0.001743280724

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000376656398
  error estimate for blocks of size 2^( 2) =       0.000393519360
  error estimate for blocks of size 2^( 3) =       0.000411082121
  error estimate for blocks of size 2^( 4) =       0.000426216686
  error estimate for blocks of size 2^( 5) =       0.000437830547
  error estimate for blocks of size 2^( 6) =       0.000445780450
  error estimate for blocks of size 2^( 7) =       0.000449383629

      target function =      -0.923362228889
              le_mean =     -16.898552492800
             les_mean =     285.854275345333
             stat err =       0.000439802828
             autocorr =       1.363406430115
   target nu stat err =       0.000439802828
   target dn stat err =       0.002129962970
      target stat err =       0.003411911249
              std dev =       0.532672586499
             le_variance =       0.283740084407


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.923362614211        initial  <--
     9.7656e+01     9.7656e+02             2.8885e-06        -0.923355972434
     3.9062e+02     3.9062e+03             7.2257e-07        -0.923359423851
     1.5625e+03     1.5625e+04             1.8067e-07        -0.923362228889

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 23.5472
  </log>
  <optVariables href="H2O.s022.opt.xml">
ci_0001                 7.087001e-01 3 1  ON 0
ci_0002                 6.926418e-01 3 1  ON 1
ci_0003                -3.104001e-02 3 1  ON 2
ci_0004                -3.012720e-02 3 1  ON 3
ci_0005                -3.071688e-02 3 1  ON 4
ci_0006                -3.067436e-02 3 1  ON 5
ci_0007                -1.345487e-02 3 1  ON 6
ci_0008                -1.342274e-02 3 1  ON 7
ci_0009                -1.873628e-02 3 1  ON 8
ci_0010                -1.811520e-02 3 1  ON 9
ci_0011                -1.475288e-02 3 1  ON 10
ci_0012                -1.455308e-02 3 1  ON 11
ci_0013                 1.532214e-02 3 1  ON 12
ci_0014                 1.481796e-02 3 1  ON 13
ci_0015                 1.581969e-02 3 1  ON 14
ci_0016                 1.539842e-02 3 1  ON 15
ci_0017                 1.336675e-02 3 1  ON 16
ci_0018                 1.306190e-02 3 1  ON 17
ci_0019                 1.310071e-02 3 1  ON 18
ci_0020                 1.266804e-02 3 1  ON 19
ci_0021                 6.903617e-03 3 1  ON 20
ci_0022                 7.655001e-03 3 1  ON 21
ci_0023                -1.178447e-02 3 1  ON 22
ci_0024                -1.143611e-02 3 1  ON 23
ci_0025                -2.123894e-03 3 1  ON 24
ci_0026                -2.505521e-03 3 1  ON 25
ci_0027                -1.210103e-02 3 1  ON 26
ci_0028                -1.154906e-02 3 1  ON 27
ci_0029                -1.065896e-02 3 1  ON 28
ci_0030                -1.054783e-02 3 1  ON 29
ci_0031                 1.342755e-02 3 1  ON 30
ci_0032                 1.206566e-02 3 1  ON 31
ci_0033                 7.741158e-03 3 1  ON 32
ci_0034                 8.464550e-03 3 1  ON 33
ci_0035                 4.846281e-03 3 1  ON 34
ci_0036                 4.896504e-03 3 1  ON 35
ci_0037                -1.130034e-02 3 1  ON 36
ci_0038                -1.136510e-02 3 1  ON 37
ci_0039                -4.014223e-03 3 1  ON 38
ci_0040                -3.906945e-03 3 1  ON 39
ci_0041                 9.081418e-03 3 1  ON 40
ci_0042                 8.729444e-03 3 1  ON 41
ci_0043                -1.292290e-02 3 1  ON 42
ci_0044                -1.374843e-02 3 1  ON 43
ci_0045                 1.064493e-02 3 1  ON 44
ci_0046                 1.007159e-02 3 1  ON 45
ci_0047                -3.593994e-03 3 1  ON 46
ci_0048                -3.467441e-03 3 1  ON 47
ci_0049                -2.578984e-03 3 1  ON 48
ci_0050                -2.679777e-03 3 1  ON 49
ci_0051                -1.745502e-03 3 1  ON 50
ci_0052                -2.047000e-03 3 1  ON 51
ci_0053                -3.951740e-03 3 1  ON 52
ci_0054                -3.297884e-03 3 1  ON 53
ci_0055                 2.491692e-03 3 1  ON 54
ci_0056                 2.207989e-03 3 1  ON 55
ci_0057                 2.430818e-03 3 1  ON 56
ci_0058                 2.893838e-03 3 1  ON 57
ci_0059                -3.411391e-03 3 1  ON 58
ci_0060                -3.352582e-03 3 1  ON 59
ci_0061                -4.010371e-03 3 1  ON 60
ci_0062                -3.946367e-03 3 1  ON 61
ci_0063                -9.791214e-03 3 1  ON 62
ci_0064                -9.361894e-03 3 1  ON 63
ci_0065                -6.441586e-03 3 1  ON 64
ci_0066                -6.110519e-03 3 1  ON 65
ci_0067                -3.746343e-03 3 1  ON 66
ci_0068                -3.444613e-03 3 1  ON 67
ci_0069                 3.628058e-03 3 1  ON 68
ci_0070                 3.335387e-03 3 1  ON 69
ci_0071                 2.956379e-03 3 1  ON 70
ci_0072                 3.496914e-03 3 1  ON 71
ci_0073                 3.527926e-03 3 1  ON 72
ci_0074                 3.550118e-03 3 1  ON 73
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 4.0309e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s023 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s023 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=23  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6907e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 23
    time step          = 0.05
    reference energy   = -16.9089
    reference variance = 0.134159
====================================================
  Execution time = 1.4107e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s023
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5257e+04
  VMC Eavg = -1.6899e+01
  VMC Evar = 2.8718e-01
  Total weights = 1.951188860e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 2.5731e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.278450962267
                                         uncertainty =       0.001502437226

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.278450962267
                                         uncertainty =       0.001502437226

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000373105582
  error estimate for blocks of size 2^( 2) =       0.000390169586
  error estimate for blocks of size 2^( 3) =       0.000407774930
  error estimate for blocks of size 2^( 4) =       0.000423194191
  error estimate for blocks of size 2^( 5) =       0.000435227313
  error estimate for blocks of size 2^( 6) =       0.000442528145
  error estimate for blocks of size 2^( 7) =       0.000447169185

      target function =      -0.932857305996
              le_mean =     -16.898534053467
             les_mean =     285.847638108539
             stat err =       0.000437029708
             autocorr =       1.372013633211
   target nu stat err =       0.000437029708
   target dn stat err =       0.002329919218
      target stat err =       0.003791838176
              std dev =       0.527650974940
             le_variance =       0.278415551356


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.689853405347e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 74
Check correct_vf_var_size: 225, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 9.7656e+02, overlap shift 9.7656e+03 and omega -1.7444e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.932871284403       residual = 7.72e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.932871310270       residual = 1.29e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.932871316694       residual = 3.26e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.932871319258       residual = 1.36e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.932871319667       residual = 6.00e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.932871320393       residual = 4.49e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.932871320777       residual = 2.66e-05           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.932871321038       residual = 1.38e-05           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.932871321002       residual = 1.92e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.932871320976       residual = 1.05e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.932871321116       residual = 8.07e-06           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.932871321109       residual = 2.42e-06           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.932871321140       residual = 6.68e-07           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.932871321165       residual = 2.19e-07           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.932871321187       residual = 1.10e-07           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.932871321185       residual = 1.95e-08           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.932871321185       residual = 6.23e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         16 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 9.7656e+02 is 2.797272e-07

solving harmonic davidson linear method for identity shift 3.9062e+03, overlap shift 3.9062e+04 and omega -1.7444e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.932871284403       residual = 7.72e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.932871290870       residual = 1.29e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.932871292476       residual = 3.26e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.932871293115       residual = 1.36e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.932871293216       residual = 6.00e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.932871293409       residual = 4.49e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.932871293487       residual = 2.66e-05           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.932871293564       residual = 1.38e-05           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.932871293560       residual = 1.92e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.932871293551       residual = 1.05e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.932871293591       residual = 8.07e-06           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.932871293582       residual = 2.42e-06           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.932871293589       residual = 6.68e-07           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.932871293581       residual = 2.19e-07           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.932871293592       residual = 1.10e-07           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.932871293596       residual = 1.95e-08           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.932871293607       residual = 6.23e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         16 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 3.9062e+03 is 6.993167e-08

solving harmonic davidson linear method for identity shift 1.5625e+04, overlap shift 1.5625e+05 and omega -1.7444e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.932871284403       residual = 7.72e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.932871286020       residual = 1.29e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.932871286421       residual = 3.26e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.932871286582       residual = 1.36e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.932871286607       residual = 6.00e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.932871286666       residual = 4.49e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.932871286655       residual = 2.66e-05           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.932871286674       residual = 1.38e-05           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.932871286674       residual = 1.92e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.932871286661       residual = 1.05e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.932871286710       residual = 8.07e-06           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.932871286705       residual = 2.42e-06           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.932871286689       residual = 6.68e-07           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.932871286687       residual = 2.19e-07           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.932871286690       residual = 1.10e-07           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.932871286678       residual = 1.95e-08           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.932871286730       residual = 6.23e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         16 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 1.5625e+04 is 1.748291e-08

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.371796 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 75 and numParams is: 74

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.6694e+01
  </log>
  <optVariables href="H2O.s023.opt.xml">
ci_0001                 7.087000e-01 3 1  ON 0
ci_0002                 6.926419e-01 3 1  ON 1
ci_0003                -3.104000e-02 3 1  ON 2
ci_0004                -3.012719e-02 3 1  ON 3
ci_0005                -3.071687e-02 3 1  ON 4
ci_0006                -3.067438e-02 3 1  ON 5
ci_0007                -1.345486e-02 3 1  ON 6
ci_0008                -1.342277e-02 3 1  ON 7
ci_0009                -1.873629e-02 3 1  ON 8
ci_0010                -1.811521e-02 3 1  ON 9
ci_0011                -1.475289e-02 3 1  ON 10
ci_0012                -1.455307e-02 3 1  ON 11
ci_0013                 1.532211e-02 3 1  ON 12
ci_0014                 1.481797e-02 3 1  ON 13
ci_0015                 1.581969e-02 3 1  ON 14
ci_0016                 1.539842e-02 3 1  ON 15
ci_0017                 1.336674e-02 3 1  ON 16
ci_0018                 1.306191e-02 3 1  ON 17
ci_0019                 1.310071e-02 3 1  ON 18
ci_0020                 1.266804e-02 3 1  ON 19
ci_0021                 6.903583e-03 3 1  ON 20
ci_0022                 7.655016e-03 3 1  ON 21
ci_0023                -1.178446e-02 3 1  ON 22
ci_0024                -1.143611e-02 3 1  ON 23
ci_0025                -2.123904e-03 3 1  ON 24
ci_0026                -2.505496e-03 3 1  ON 25
ci_0027                -1.210104e-02 3 1  ON 26
ci_0028                -1.154906e-02 3 1  ON 27
ci_0029                -1.065896e-02 3 1  ON 28
ci_0030                -1.054784e-02 3 1  ON 29
ci_0031                 1.342754e-02 3 1  ON 30
ci_0032                 1.206567e-02 3 1  ON 31
ci_0033                 7.741156e-03 3 1  ON 32
ci_0034                 8.464528e-03 3 1  ON 33
ci_0035                 4.846273e-03 3 1  ON 34
ci_0036                 4.896507e-03 3 1  ON 35
ci_0037                -1.130036e-02 3 1  ON 36
ci_0038                -1.136510e-02 3 1  ON 37
ci_0039                -4.014229e-03 3 1  ON 38
ci_0040                -3.906945e-03 3 1  ON 39
ci_0041                 9.081424e-03 3 1  ON 40
ci_0042                 8.729433e-03 3 1  ON 41
ci_0043                -1.292293e-02 3 1  ON 42
ci_0044                -1.374847e-02 3 1  ON 43
ci_0045                 1.064492e-02 3 1  ON 44
ci_0046                 1.007162e-02 3 1  ON 45
ci_0047                -3.593999e-03 3 1  ON 46
ci_0048                -3.467440e-03 3 1  ON 47
ci_0049                -2.579002e-03 3 1  ON 48
ci_0050                -2.679789e-03 3 1  ON 49
ci_0051                -1.745504e-03 3 1  ON 50
ci_0052                -2.046973e-03 3 1  ON 51
ci_0053                -3.951723e-03 3 1  ON 52
ci_0054                -3.297878e-03 3 1  ON 53
ci_0055                 2.491694e-03 3 1  ON 54
ci_0056                 2.207976e-03 3 1  ON 55
ci_0057                 2.430849e-03 3 1  ON 56
ci_0058                 2.893840e-03 3 1  ON 57
ci_0059                -3.411387e-03 3 1  ON 58
ci_0060                -3.352582e-03 3 1  ON 59
ci_0061                -4.010359e-03 3 1  ON 60
ci_0062                -3.946363e-03 3 1  ON 61
ci_0063                -9.791208e-03 3 1  ON 62
ci_0064                -9.361897e-03 3 1  ON 63
ci_0065                -6.441578e-03 3 1  ON 64
ci_0066                -6.110518e-03 3 1  ON 65
ci_0067                -3.746345e-03 3 1  ON 66
ci_0068                -3.444607e-03 3 1  ON 67
ci_0069                 3.628048e-03 3 1  ON 68
ci_0070                 3.335382e-03 3 1  ON 69
ci_0071                 2.956383e-03 3 1  ON 70
ci_0072                 3.496925e-03 3 1  ON 71
ci_0073                 3.527935e-03 3 1  ON 72
ci_0074                 3.550115e-03 3 1  ON 73
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 23
    time step          = 0.05
    reference energy   = -16.9323
    reference variance = 0.212939
====================================================
  Execution time = 1.4199e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s023
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6898e+01
  VMC Evar = 2.9037e-01
  Total weights = 1.9513e+06
  Execution time = 1.8714e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.279700886580
                                         uncertainty =       0.001748873898

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.279700886580
                                         uncertainty =       0.001748873898

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000373981686
  error estimate for blocks of size 2^( 2) =       0.000391074043
  error estimate for blocks of size 2^( 3) =       0.000408857798
  error estimate for blocks of size 2^( 4) =       0.000423526484
  error estimate for blocks of size 2^( 5) =       0.000435448514
  error estimate for blocks of size 2^( 6) =       0.000443086455
  error estimate for blocks of size 2^( 7) =       0.000447088920

      target function =      -0.927788817818
              le_mean =     -16.897939541384
             les_mean =     285.830730883470
             stat err =       0.000437287593
             autocorr =       1.367205012025
   target nu stat err =       0.000437287593
   target dn stat err =       0.002443955578
      target stat err =       0.003923923562
              std dev =       0.528889971738
             le_variance =       0.279724602205

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.279700869063
                                         uncertainty =       0.001748874955

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.279700869063
                                         uncertainty =       0.001748874955

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000373981674
  error estimate for blocks of size 2^( 2) =       0.000391074032
  error estimate for blocks of size 2^( 3) =       0.000408857786
  error estimate for blocks of size 2^( 4) =       0.000423526467
  error estimate for blocks of size 2^( 5) =       0.000435448495
  error estimate for blocks of size 2^( 6) =       0.000443086438
  error estimate for blocks of size 2^( 7) =       0.000447088894

      target function =      -0.927788745251
              le_mean =     -16.897939541823
             les_mean =     285.830730944027
             stat err =       0.000437287573
             autocorr =       1.367204974033
   target nu stat err =       0.000437287573
   target dn stat err =       0.002443993589
      target stat err =       0.003923981798
              std dev =       0.528889955229
             le_variance =       0.279724584742

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.279700877820
                                         uncertainty =       0.001748874426

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.279700877820
                                         uncertainty =       0.001748874426

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000373981680
  error estimate for blocks of size 2^( 2) =       0.000391074038
  error estimate for blocks of size 2^( 3) =       0.000408857792
  error estimate for blocks of size 2^( 4) =       0.000423526475
  error estimate for blocks of size 2^( 5) =       0.000435448505
  error estimate for blocks of size 2^( 6) =       0.000443086446
  error estimate for blocks of size 2^( 7) =       0.000447088907

      target function =      -0.927788781682
              le_mean =     -16.897939541603
             les_mean =     285.830730913654
             stat err =       0.000437287583
             autocorr =       1.367204993030
   target nu stat err =       0.000437287583
   target dn stat err =       0.002443974581
      target stat err =       0.003923952678
              std dev =       0.528889963482
             le_variance =       0.279724593472

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.279700885485
                                         uncertainty =       0.001748873964

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.279700885485
                                         uncertainty =       0.001748873964

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000373981685
  error estimate for blocks of size 2^( 2) =       0.000391074043
  error estimate for blocks of size 2^( 3) =       0.000408857798
  error estimate for blocks of size 2^( 4) =       0.000423526483
  error estimate for blocks of size 2^( 5) =       0.000435448513
  error estimate for blocks of size 2^( 6) =       0.000443086454
  error estimate for blocks of size 2^( 7) =       0.000447088918

      target function =      -0.927788813317
              le_mean =     -16.897939541411
             les_mean =     285.830730887233
             stat err =       0.000437287592
             autocorr =       1.367205009651
   target nu stat err =       0.000437287592
   target dn stat err =       0.002443957953
      target stat err =       0.003923927201
              std dev =       0.528889970706
             le_variance =       0.279724601113


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.927788817818        initial  <--
     9.7656e+02     9.7656e+03             2.7973e-07        -0.927788745251
     3.9062e+03     3.9062e+04             6.9932e-08        -0.927788781682
     1.5625e+04     1.5625e+05             1.7483e-08        -0.927788813317

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 23.6532
  </log>
  <optVariables href="H2O.s023.opt.xml">
ci_0001                 7.087001e-01 3 1  ON 0
ci_0002                 6.926418e-01 3 1  ON 1
ci_0003                -3.104001e-02 3 1  ON 2
ci_0004                -3.012720e-02 3 1  ON 3
ci_0005                -3.071688e-02 3 1  ON 4
ci_0006                -3.067436e-02 3 1  ON 5
ci_0007                -1.345487e-02 3 1  ON 6
ci_0008                -1.342274e-02 3 1  ON 7
ci_0009                -1.873628e-02 3 1  ON 8
ci_0010                -1.811520e-02 3 1  ON 9
ci_0011                -1.475288e-02 3 1  ON 10
ci_0012                -1.455308e-02 3 1  ON 11
ci_0013                 1.532214e-02 3 1  ON 12
ci_0014                 1.481796e-02 3 1  ON 13
ci_0015                 1.581969e-02 3 1  ON 14
ci_0016                 1.539842e-02 3 1  ON 15
ci_0017                 1.336675e-02 3 1  ON 16
ci_0018                 1.306190e-02 3 1  ON 17
ci_0019                 1.310071e-02 3 1  ON 18
ci_0020                 1.266804e-02 3 1  ON 19
ci_0021                 6.903617e-03 3 1  ON 20
ci_0022                 7.655001e-03 3 1  ON 21
ci_0023                -1.178447e-02 3 1  ON 22
ci_0024                -1.143611e-02 3 1  ON 23
ci_0025                -2.123894e-03 3 1  ON 24
ci_0026                -2.505521e-03 3 1  ON 25
ci_0027                -1.210103e-02 3 1  ON 26
ci_0028                -1.154906e-02 3 1  ON 27
ci_0029                -1.065896e-02 3 1  ON 28
ci_0030                -1.054783e-02 3 1  ON 29
ci_0031                 1.342755e-02 3 1  ON 30
ci_0032                 1.206566e-02 3 1  ON 31
ci_0033                 7.741158e-03 3 1  ON 32
ci_0034                 8.464550e-03 3 1  ON 33
ci_0035                 4.846281e-03 3 1  ON 34
ci_0036                 4.896504e-03 3 1  ON 35
ci_0037                -1.130034e-02 3 1  ON 36
ci_0038                -1.136510e-02 3 1  ON 37
ci_0039                -4.014223e-03 3 1  ON 38
ci_0040                -3.906945e-03 3 1  ON 39
ci_0041                 9.081418e-03 3 1  ON 40
ci_0042                 8.729444e-03 3 1  ON 41
ci_0043                -1.292290e-02 3 1  ON 42
ci_0044                -1.374843e-02 3 1  ON 43
ci_0045                 1.064493e-02 3 1  ON 44
ci_0046                 1.007159e-02 3 1  ON 45
ci_0047                -3.593994e-03 3 1  ON 46
ci_0048                -3.467441e-03 3 1  ON 47
ci_0049                -2.578984e-03 3 1  ON 48
ci_0050                -2.679777e-03 3 1  ON 49
ci_0051                -1.745502e-03 3 1  ON 50
ci_0052                -2.047000e-03 3 1  ON 51
ci_0053                -3.951740e-03 3 1  ON 52
ci_0054                -3.297884e-03 3 1  ON 53
ci_0055                 2.491692e-03 3 1  ON 54
ci_0056                 2.207989e-03 3 1  ON 55
ci_0057                 2.430818e-03 3 1  ON 56
ci_0058                 2.893838e-03 3 1  ON 57
ci_0059                -3.411391e-03 3 1  ON 58
ci_0060                -3.352582e-03 3 1  ON 59
ci_0061                -4.010371e-03 3 1  ON 60
ci_0062                -3.946367e-03 3 1  ON 61
ci_0063                -9.791214e-03 3 1  ON 62
ci_0064                -9.361894e-03 3 1  ON 63
ci_0065                -6.441586e-03 3 1  ON 64
ci_0066                -6.110519e-03 3 1  ON 65
ci_0067                -3.746343e-03 3 1  ON 66
ci_0068                -3.444613e-03 3 1  ON 67
ci_0069                 3.628058e-03 3 1  ON 68
ci_0070                 3.335387e-03 3 1  ON 69
ci_0071                 2.956379e-03 3 1  ON 70
ci_0072                 3.496914e-03 3 1  ON 71
ci_0073                 3.527926e-03 3 1  ON 72
ci_0074                 3.550118e-03 3 1  ON 73
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 4.0355e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s024 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s024 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=24  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6908e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 24
    time step          = 0.05
    reference energy   = -16.8943
    reference variance = 0.296746
====================================================
  Execution time = 1.4265e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s024
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5270e+04
  VMC Eavg = -1.6899e+01
  VMC Evar = 2.9078e-01
  Total weights = 1.951099031e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 2.6447e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.281749016648
                                         uncertainty =       0.001859787056

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.281749016648
                                         uncertainty =       0.001859787056

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000375275763
  error estimate for blocks of size 2^( 2) =       0.000392342543
  error estimate for blocks of size 2^( 3) =       0.000409745473
  error estimate for blocks of size 2^( 4) =       0.000424534988
  error estimate for blocks of size 2^( 5) =       0.000436316000
  error estimate for blocks of size 2^( 6) =       0.000444287770
  error estimate for blocks of size 2^( 7) =       0.000448288160

      target function =      -0.927172901778
              le_mean =     -16.899396491434
             les_mean =     285.880383766978
             stat err =       0.000438356729
             autocorr =       1.364439623544
   target nu stat err =       0.000438356729
   target dn stat err =       0.001998720181
      target stat err =       0.003242300207
              std dev =       0.530720073614
             le_variance =       0.281663796536


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.689939649143e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 74
Check correct_vf_var_size: 225, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 9.7656e+03, overlap shift 9.7656e+04 and omega -1.7444e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.927182700735       residual = 7.32e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.927182704140       residual = 1.13e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.927182704682       residual = 2.21e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.927182704775       residual = 1.01e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.927182704804       residual = 3.00e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.927182704804       residual = 1.07e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.927182704800       residual = 4.66e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.927182704802       residual = 1.74e-06           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.927182704760       residual = 7.34e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.927182704790       residual = 2.42e-07           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.927182704802       residual = 1.91e-07           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.927182704793       residual = 1.64e-07           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.927182704780       residual = 1.36e-07           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.927182704819       residual = 9.43e-08           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.927182704802       residual = 4.74e-08           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.927182704802       residual = 2.18e-08           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.927182704802       residual = 4.83e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         16 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 9.7656e+03 is 1.699651e-08

solving harmonic davidson linear method for identity shift 3.9062e+04, overlap shift 3.9062e+05 and omega -1.7444e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.927182700735       residual = 7.32e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.927182701586       residual = 1.13e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.927182701722       residual = 2.21e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.927182701745       residual = 1.01e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.927182701751       residual = 3.00e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.927182701754       residual = 1.07e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.927182701752       residual = 4.66e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.927182701842       residual = 1.74e-06           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.927182701758       residual = 7.34e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.927182701751       residual = 2.42e-07           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.927182701751       residual = 1.91e-07           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.927182701737       residual = 1.64e-07           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.927182701798       residual = 1.36e-07           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.927182701709       residual = 9.43e-08           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.927182701648       residual = 4.74e-08           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.927182701752       residual = 2.18e-08           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.927182701752       residual = 4.83e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         16 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 3.9062e+04 is 4.249141e-09

solving harmonic davidson linear method for identity shift 1.5625e+05, overlap shift 1.5625e+06 and omega -1.7444e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.927182700735       residual = 7.32e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.927182700948       residual = 1.13e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.927182700982       residual = 2.21e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.927182700988       residual = 1.01e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.927182700989       residual = 3.00e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.927182700976       residual = 1.07e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.927182700990       residual = 4.66e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.927182700872       residual = 1.74e-06           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.927182701117       residual = 7.34e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.927182700989       residual = 2.42e-07           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.927182701072       residual = 1.91e-07           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.927182700757       residual = 1.64e-07           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.927182701094       residual = 1.36e-07           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.927182700989       residual = 9.43e-08           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.927182701127       residual = 4.74e-08           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.927182700989       residual = 2.18e-08           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.927182700989       residual = 4.83e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         16 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 1.5625e+05 is 1.062286e-09

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.380873 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 75 and numParams is: 74

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.6924e+01
  </log>
  <optVariables href="H2O.s024.opt.xml">
ci_0001                 7.087001e-01 3 1  ON 0
ci_0002                 6.926418e-01 3 1  ON 1
ci_0003                -3.104001e-02 3 1  ON 2
ci_0004                -3.012720e-02 3 1  ON 3
ci_0005                -3.071688e-02 3 1  ON 4
ci_0006                -3.067436e-02 3 1  ON 5
ci_0007                -1.345487e-02 3 1  ON 6
ci_0008                -1.342274e-02 3 1  ON 7
ci_0009                -1.873628e-02 3 1  ON 8
ci_0010                -1.811520e-02 3 1  ON 9
ci_0011                -1.475288e-02 3 1  ON 10
ci_0012                -1.455308e-02 3 1  ON 11
ci_0013                 1.532214e-02 3 1  ON 12
ci_0014                 1.481796e-02 3 1  ON 13
ci_0015                 1.581969e-02 3 1  ON 14
ci_0016                 1.539842e-02 3 1  ON 15
ci_0017                 1.336675e-02 3 1  ON 16
ci_0018                 1.306190e-02 3 1  ON 17
ci_0019                 1.310071e-02 3 1  ON 18
ci_0020                 1.266804e-02 3 1  ON 19
ci_0021                 6.903613e-03 3 1  ON 20
ci_0022                 7.654999e-03 3 1  ON 21
ci_0023                -1.178447e-02 3 1  ON 22
ci_0024                -1.143611e-02 3 1  ON 23
ci_0025                -2.123893e-03 3 1  ON 24
ci_0026                -2.505519e-03 3 1  ON 25
ci_0027                -1.210103e-02 3 1  ON 26
ci_0028                -1.154906e-02 3 1  ON 27
ci_0029                -1.065896e-02 3 1  ON 28
ci_0030                -1.054783e-02 3 1  ON 29
ci_0031                 1.342755e-02 3 1  ON 30
ci_0032                 1.206566e-02 3 1  ON 31
ci_0033                 7.741159e-03 3 1  ON 32
ci_0034                 8.464549e-03 3 1  ON 33
ci_0035                 4.846284e-03 3 1  ON 34
ci_0036                 4.896507e-03 3 1  ON 35
ci_0037                -1.130034e-02 3 1  ON 36
ci_0038                -1.136510e-02 3 1  ON 37
ci_0039                -4.014222e-03 3 1  ON 38
ci_0040                -3.906945e-03 3 1  ON 39
ci_0041                 9.081417e-03 3 1  ON 40
ci_0042                 8.729445e-03 3 1  ON 41
ci_0043                -1.292290e-02 3 1  ON 42
ci_0044                -1.374844e-02 3 1  ON 43
ci_0045                 1.064493e-02 3 1  ON 44
ci_0046                 1.007159e-02 3 1  ON 45
ci_0047                -3.593994e-03 3 1  ON 46
ci_0048                -3.467441e-03 3 1  ON 47
ci_0049                -2.578984e-03 3 1  ON 48
ci_0050                -2.679779e-03 3 1  ON 49
ci_0051                -1.745503e-03 3 1  ON 50
ci_0052                -2.046999e-03 3 1  ON 51
ci_0053                -3.951738e-03 3 1  ON 52
ci_0054                -3.297884e-03 3 1  ON 53
ci_0055                 2.491688e-03 3 1  ON 54
ci_0056                 2.207988e-03 3 1  ON 55
ci_0057                 2.430818e-03 3 1  ON 56
ci_0058                 2.893839e-03 3 1  ON 57
ci_0059                -3.411391e-03 3 1  ON 58
ci_0060                -3.352582e-03 3 1  ON 59
ci_0061                -4.010370e-03 3 1  ON 60
ci_0062                -3.946367e-03 3 1  ON 61
ci_0063                -9.791215e-03 3 1  ON 62
ci_0064                -9.361895e-03 3 1  ON 63
ci_0065                -6.441586e-03 3 1  ON 64
ci_0066                -6.110518e-03 3 1  ON 65
ci_0067                -3.746343e-03 3 1  ON 66
ci_0068                -3.444614e-03 3 1  ON 67
ci_0069                 3.628057e-03 3 1  ON 68
ci_0070                 3.335387e-03 3 1  ON 69
ci_0071                 2.956379e-03 3 1  ON 70
ci_0072                 3.496914e-03 3 1  ON 71
ci_0073                 3.527924e-03 3 1  ON 72
ci_0074                 3.550118e-03 3 1  ON 73
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 24
    time step          = 0.05
    reference energy   = -16.9237
    reference variance = 0.241325
====================================================
  Execution time = 1.3873e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s024
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6899e+01
  VMC Evar = 2.9140e-01
  Total weights = 1.9509e+06
  Execution time = 1.8709e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.283493671962
                                         uncertainty =       0.001589677602

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.283493671962
                                         uncertainty =       0.001589677602

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000376473645
  error estimate for blocks of size 2^( 2) =       0.000393832711
  error estimate for blocks of size 2^( 3) =       0.000410688073
  error estimate for blocks of size 2^( 4) =       0.000425391275
  error estimate for blocks of size 2^( 5) =       0.000437075033
  error estimate for blocks of size 2^( 6) =       0.000445318394
  error estimate for blocks of size 2^( 7) =       0.000450400184

      target function =      -0.926185667682
              le_mean =     -16.898569653666
             les_mean =     285.853055550599
             stat err =       0.000439546221
             autocorr =       1.363138373504
   target nu stat err =       0.000439546221
   target dn stat err =       0.002032385904
      target stat err =       0.003282687057
              std dev =       0.532414134957
             le_variance =       0.283464811102

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.283493669758
                                         uncertainty =       0.001589677645

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.283493669758
                                         uncertainty =       0.001589677645

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000376473644
  error estimate for blocks of size 2^( 2) =       0.000393832709
  error estimate for blocks of size 2^( 3) =       0.000410688071
  error estimate for blocks of size 2^( 4) =       0.000425391273
  error estimate for blocks of size 2^( 5) =       0.000437075031
  error estimate for blocks of size 2^( 6) =       0.000445318392
  error estimate for blocks of size 2^( 7) =       0.000450400181

      target function =      -0.926185773086
              le_mean =     -16.898569653763
             les_mean =     285.853055486886
             stat err =       0.000439546219
             autocorr =       1.363138369014
   target nu stat err =       0.000439546219
   target dn stat err =       0.002032383145
      target stat err =       0.003282683558
              std dev =       0.532414132900
             le_variance =       0.283464808911

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.283493670860
                                         uncertainty =       0.001589677624

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.283493670860
                                         uncertainty =       0.001589677624

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000376473645
  error estimate for blocks of size 2^( 2) =       0.000393832710
  error estimate for blocks of size 2^( 3) =       0.000410688072
  error estimate for blocks of size 2^( 4) =       0.000425391274
  error estimate for blocks of size 2^( 5) =       0.000437075032
  error estimate for blocks of size 2^( 6) =       0.000445318393
  error estimate for blocks of size 2^( 7) =       0.000450400182

      target function =      -0.926185720396
              le_mean =     -16.898569653715
             les_mean =     285.853055518735
             stat err =       0.000439546220
             autocorr =       1.363138371280
   target nu stat err =       0.000439546220
   target dn stat err =       0.002032384524
      target stat err =       0.003282685307
              std dev =       0.532414133928
             le_variance =       0.283464810007

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.283493671824
                                         uncertainty =       0.001589677605

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.283493671824
                                         uncertainty =       0.001589677605

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000376473645
  error estimate for blocks of size 2^( 2) =       0.000393832711
  error estimate for blocks of size 2^( 3) =       0.000410688072
  error estimate for blocks of size 2^( 4) =       0.000425391275
  error estimate for blocks of size 2^( 5) =       0.000437075033
  error estimate for blocks of size 2^( 6) =       0.000445318394
  error estimate for blocks of size 2^( 7) =       0.000450400184

      target function =      -0.926185674272
              le_mean =     -16.898569653672
             les_mean =     285.853055546615
             stat err =       0.000439546221
             autocorr =       1.363138373229
   target nu stat err =       0.000439546221
   target dn stat err =       0.002032385731
      target stat err =       0.003282686838
              std dev =       0.532414134829
             le_variance =       0.283464810965


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.926185667682        initial
     9.7656e+03     9.7656e+04             1.6997e-08        -0.926185773086  <--
     3.9062e+04     3.9062e+05             4.2491e-09        -0.926185720396
     1.5625e+05     1.5625e+06             1.0623e-09        -0.926185674272

*****************************************************************************
Applying the update for shift_i =   9.7656e+03     and shift_s =   9.7656e+04
*****************************************************************************

  Execution time = 2.3333e+01
  </log>
  <optVariables href="H2O.s024.opt.xml">
ci_0001                 7.087001e-01 3 1  ON 0
ci_0002                 6.926418e-01 3 1  ON 1
ci_0003                -3.104001e-02 3 1  ON 2
ci_0004                -3.012719e-02 3 1  ON 3
ci_0005                -3.071688e-02 3 1  ON 4
ci_0006                -3.067436e-02 3 1  ON 5
ci_0007                -1.345487e-02 3 1  ON 6
ci_0008                -1.342275e-02 3 1  ON 7
ci_0009                -1.873628e-02 3 1  ON 8
ci_0010                -1.811519e-02 3 1  ON 9
ci_0011                -1.475287e-02 3 1  ON 10
ci_0012                -1.455308e-02 3 1  ON 11
ci_0013                 1.532214e-02 3 1  ON 12
ci_0014                 1.481796e-02 3 1  ON 13
ci_0015                 1.581969e-02 3 1  ON 14
ci_0016                 1.539842e-02 3 1  ON 15
ci_0017                 1.336676e-02 3 1  ON 16
ci_0018                 1.306190e-02 3 1  ON 17
ci_0019                 1.310071e-02 3 1  ON 18
ci_0020                 1.266803e-02 3 1  ON 19
ci_0021                 6.903600e-03 3 1  ON 20
ci_0022                 7.654990e-03 3 1  ON 21
ci_0023                -1.178447e-02 3 1  ON 22
ci_0024                -1.143611e-02 3 1  ON 23
ci_0025                -2.123890e-03 3 1  ON 24
ci_0026                -2.505510e-03 3 1  ON 25
ci_0027                -1.210103e-02 3 1  ON 26
ci_0028                -1.154906e-02 3 1  ON 27
ci_0029                -1.065896e-02 3 1  ON 28
ci_0030                -1.054784e-02 3 1  ON 29
ci_0031                 1.342755e-02 3 1  ON 30
ci_0032                 1.206566e-02 3 1  ON 31
ci_0033                 7.741163e-03 3 1  ON 32
ci_0034                 8.464545e-03 3 1  ON 33
ci_0035                 4.846294e-03 3 1  ON 34
ci_0036                 4.896514e-03 3 1  ON 35
ci_0037                -1.130034e-02 3 1  ON 36
ci_0038                -1.136510e-02 3 1  ON 37
ci_0039                -4.014220e-03 3 1  ON 38
ci_0040                -3.906944e-03 3 1  ON 39
ci_0041                 9.081416e-03 3 1  ON 40
ci_0042                 8.729448e-03 3 1  ON 41
ci_0043                -1.292290e-02 3 1  ON 42
ci_0044                -1.374844e-02 3 1  ON 43
ci_0045                 1.064493e-02 3 1  ON 44
ci_0046                 1.007158e-02 3 1  ON 45
ci_0047                -3.593994e-03 3 1  ON 46
ci_0048                -3.467442e-03 3 1  ON 47
ci_0049                -2.578984e-03 3 1  ON 48
ci_0050                -2.679785e-03 3 1  ON 49
ci_0051                -1.745505e-03 3 1  ON 50
ci_0052                -2.046996e-03 3 1  ON 51
ci_0053                -3.951735e-03 3 1  ON 52
ci_0054                -3.297885e-03 3 1  ON 53
ci_0055                 2.491677e-03 3 1  ON 54
ci_0056                 2.207984e-03 3 1  ON 55
ci_0057                 2.430817e-03 3 1  ON 56
ci_0058                 2.893842e-03 3 1  ON 57
ci_0059                -3.411393e-03 3 1  ON 58
ci_0060                -3.352581e-03 3 1  ON 59
ci_0061                -4.010367e-03 3 1  ON 60
ci_0062                -3.946367e-03 3 1  ON 61
ci_0063                -9.791216e-03 3 1  ON 62
ci_0064                -9.361899e-03 3 1  ON 63
ci_0065                -6.441587e-03 3 1  ON 64
ci_0066                -6.110518e-03 3 1  ON 65
ci_0067                -3.746345e-03 3 1  ON 66
ci_0068                -3.444616e-03 3 1  ON 67
ci_0069                 3.628055e-03 3 1  ON 68
ci_0070                 3.335384e-03 3 1  ON 69
ci_0071                 2.956377e-03 3 1  ON 70
ci_0072                 3.496916e-03 3 1  ON 71
ci_0073                 3.527916e-03 3 1  ON 72
ci_0074                 3.550117e-03 3 1  ON 73
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 4.0264e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s025 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s025 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=25  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6908e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 25
    time step          = 0.05
    reference energy   = -16.831
    reference variance = 0.246438
====================================================
  Execution time = 1.4159e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s025
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5263e+04
  VMC Eavg = -1.6899e+01
  VMC Evar = 2.9523e-01
  Total weights = 1.951176976e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 2.5823e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.284888815185
                                         uncertainty =       0.002698231066

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.284888815185
                                         uncertainty =       0.002698231066

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000377384736
  error estimate for blocks of size 2^( 2) =       0.000394355164
  error estimate for blocks of size 2^( 3) =       0.000412125684
  error estimate for blocks of size 2^( 4) =       0.000427451472
  error estimate for blocks of size 2^( 5) =       0.000438873761
  error estimate for blocks of size 2^( 6) =       0.000446539467
  error estimate for blocks of size 2^( 7) =       0.000448806663

      target function =      -0.920181121417
              le_mean =     -16.899020103634
             les_mean =     285.872108644232
             stat err =       0.000440417841
             autocorr =       1.361949944755
   target nu stat err =       0.000440417841
   target dn stat err =       0.003637693410
      target stat err =       0.005701225398
              std dev =       0.533702611647
             le_variance =       0.284838477679


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.689902010363e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 74
Check correct_vf_var_size: 225, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.4414e+03, overlap shift 2.4414e+04 and omega -1.7444e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.920214858618       residual = 1.02e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.920214879877       residual = 7.56e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.920214881328       residual = 1.64e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.920214881722       residual = 8.54e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.920214882103       residual = 2.15e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.920214882322       residual = 9.50e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.920214882453       residual = 5.36e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.920214882468       residual = 2.23e-06           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.920214882472       residual = 2.32e-06           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.920214882485       residual = 1.50e-06           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.920214882467       residual = 1.29e-06           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.920214882461       residual = 5.91e-07           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.920214882460       residual = 4.18e-07           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.920214882453       residual = 1.18e-07           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.920214882447       residual = 3.40e-08           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.920214882450       residual = 9.86e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         15 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 2.4414e+03 is 7.537845e-08

solving harmonic davidson linear method for identity shift 9.7656e+03, overlap shift 9.7656e+04 and omega -1.7444e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.920214858618       residual = 1.02e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.920214863933       residual = 7.56e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.920214864296       residual = 1.64e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.920214864394       residual = 8.54e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.920214864484       residual = 2.15e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.920214864527       residual = 9.50e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.920214864560       residual = 5.36e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.920214864582       residual = 2.23e-06           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.920214864577       residual = 2.32e-06           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.920214864578       residual = 1.50e-06           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.920214864562       residual = 1.29e-06           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.920214864551       residual = 5.91e-07           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.920214864582       residual = 4.18e-07           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.920214864563       residual = 1.18e-07           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.920214864570       residual = 3.40e-08           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.920214864578       residual = 9.86e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         15 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 9.7656e+03 is 1.884506e-08

solving harmonic davidson linear method for identity shift 3.9062e+04, overlap shift 3.9062e+05 and omega -1.7444e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.920214858618       residual = 1.02e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.920214859947       residual = 7.56e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.920214860038       residual = 1.64e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.920214860061       residual = 8.54e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.920214860092       residual = 2.15e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.920214860103       residual = 9.50e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.920214860129       residual = 5.36e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.920214860126       residual = 2.23e-06           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.920214860073       residual = 2.32e-06           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.920214860115       residual = 1.50e-06           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.920214860106       residual = 1.29e-06           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.920214860087       residual = 5.91e-07           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.920214860110       residual = 4.18e-07           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.920214860092       residual = 1.18e-07           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.920214860074       residual = 3.40e-08           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.920214860121       residual = 9.86e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         15 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 3.9062e+04 is 4.711294e-09

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.389064 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 75 and numParams is: 74

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.6757e+01
  </log>
  <optVariables href="H2O.s025.opt.xml">
ci_0001                 7.087001e-01 3 1  ON 0
ci_0002                 6.926418e-01 3 1  ON 1
ci_0003                -3.104002e-02 3 1  ON 2
ci_0004                -3.012720e-02 3 1  ON 3
ci_0005                -3.071687e-02 3 1  ON 4
ci_0006                -3.067436e-02 3 1  ON 5
ci_0007                -1.345487e-02 3 1  ON 6
ci_0008                -1.342274e-02 3 1  ON 7
ci_0009                -1.873628e-02 3 1  ON 8
ci_0010                -1.811520e-02 3 1  ON 9
ci_0011                -1.475287e-02 3 1  ON 10
ci_0012                -1.455308e-02 3 1  ON 11
ci_0013                 1.532215e-02 3 1  ON 12
ci_0014                 1.481796e-02 3 1  ON 13
ci_0015                 1.581969e-02 3 1  ON 14
ci_0016                 1.539842e-02 3 1  ON 15
ci_0017                 1.336675e-02 3 1  ON 16
ci_0018                 1.306190e-02 3 1  ON 17
ci_0019                 1.310071e-02 3 1  ON 18
ci_0020                 1.266804e-02 3 1  ON 19
ci_0021                 6.903613e-03 3 1  ON 20
ci_0022                 7.654998e-03 3 1  ON 21
ci_0023                -1.178447e-02 3 1  ON 22
ci_0024                -1.143611e-02 3 1  ON 23
ci_0025                -2.123888e-03 3 1  ON 24
ci_0026                -2.505499e-03 3 1  ON 25
ci_0027                -1.210104e-02 3 1  ON 26
ci_0028                -1.154906e-02 3 1  ON 27
ci_0029                -1.065896e-02 3 1  ON 28
ci_0030                -1.054784e-02 3 1  ON 29
ci_0031                 1.342754e-02 3 1  ON 30
ci_0032                 1.206566e-02 3 1  ON 31
ci_0033                 7.741164e-03 3 1  ON 32
ci_0034                 8.464547e-03 3 1  ON 33
ci_0035                 4.846300e-03 3 1  ON 34
ci_0036                 4.896499e-03 3 1  ON 35
ci_0037                -1.130034e-02 3 1  ON 36
ci_0038                -1.136509e-02 3 1  ON 37
ci_0039                -4.014218e-03 3 1  ON 38
ci_0040                -3.906942e-03 3 1  ON 39
ci_0041                 9.081421e-03 3 1  ON 40
ci_0042                 8.729454e-03 3 1  ON 41
ci_0043                -1.292290e-02 3 1  ON 42
ci_0044                -1.374845e-02 3 1  ON 43
ci_0045                 1.064493e-02 3 1  ON 44
ci_0046                 1.007159e-02 3 1  ON 45
ci_0047                -3.593991e-03 3 1  ON 46
ci_0048                -3.467443e-03 3 1  ON 47
ci_0049                -2.578992e-03 3 1  ON 48
ci_0050                -2.679780e-03 3 1  ON 49
ci_0051                -1.745503e-03 3 1  ON 50
ci_0052                -2.046995e-03 3 1  ON 51
ci_0053                -3.951736e-03 3 1  ON 52
ci_0054                -3.297897e-03 3 1  ON 53
ci_0055                 2.491658e-03 3 1  ON 54
ci_0056                 2.207994e-03 3 1  ON 55
ci_0057                 2.430800e-03 3 1  ON 56
ci_0058                 2.893831e-03 3 1  ON 57
ci_0059                -3.411389e-03 3 1  ON 58
ci_0060                -3.352583e-03 3 1  ON 59
ci_0061                -4.010369e-03 3 1  ON 60
ci_0062                -3.946372e-03 3 1  ON 61
ci_0063                -9.791214e-03 3 1  ON 62
ci_0064                -9.361897e-03 3 1  ON 63
ci_0065                -6.441586e-03 3 1  ON 64
ci_0066                -6.110516e-03 3 1  ON 65
ci_0067                -3.746343e-03 3 1  ON 66
ci_0068                -3.444623e-03 3 1  ON 67
ci_0069                 3.628053e-03 3 1  ON 68
ci_0070                 3.335387e-03 3 1  ON 69
ci_0071                 2.956372e-03 3 1  ON 70
ci_0072                 3.496925e-03 3 1  ON 71
ci_0073                 3.527913e-03 3 1  ON 72
ci_0074                 3.550117e-03 3 1  ON 73
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 25
    time step          = 0.05
    reference energy   = -16.9618
    reference variance = 0.335818
====================================================
  Execution time = 1.3852e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s025
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6899e+01
  VMC Evar = 2.9249e-01
  Total weights = 1.9510e+06
  Execution time = 1.8706e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.283146454686
                                         uncertainty =       0.001811284751

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.283146454686
                                         uncertainty =       0.001811284751

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000376216999
  error estimate for blocks of size 2^( 2) =       0.000393043560
  error estimate for blocks of size 2^( 3) =       0.000410868458
  error estimate for blocks of size 2^( 4) =       0.000425905940
  error estimate for blocks of size 2^( 5) =       0.000437182031
  error estimate for blocks of size 2^( 6) =       0.000442640815
  error estimate for blocks of size 2^( 7) =       0.000446327714

      target function =      -0.924466849740
              le_mean =     -16.898884894295
             les_mean =     285.864805118901
             stat err =       0.000438014125
             autocorr =       1.355499622840
   target nu stat err =       0.000438014125
   target dn stat err =       0.002361365493
      target stat err =       0.003776314611
              std dev =       0.532051182760
             le_variance =       0.283078461076

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.283146455938
                                         uncertainty =       0.001811284390

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.283146455938
                                         uncertainty =       0.001811284390

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000376217000
  error estimate for blocks of size 2^( 2) =       0.000393043561
  error estimate for blocks of size 2^( 3) =       0.000410868459
  error estimate for blocks of size 2^( 4) =       0.000425905942
  error estimate for blocks of size 2^( 5) =       0.000437182034
  error estimate for blocks of size 2^( 6) =       0.000442640819
  error estimate for blocks of size 2^( 7) =       0.000446327718

      target function =      -0.924466936498
              le_mean =     -16.898884894699
             les_mean =     285.864805077424
             stat err =       0.000438014129
             autocorr =       1.355499639474
   target nu stat err =       0.000438014129
   target dn stat err =       0.002361342782
      target stat err =       0.003776280394
              std dev =       0.532051183919
             le_variance =       0.283078462310

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.283146455311
                                         uncertainty =       0.001811284570

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.283146455311
                                         uncertainty =       0.001811284570

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000376217000
  error estimate for blocks of size 2^( 2) =       0.000393043561
  error estimate for blocks of size 2^( 3) =       0.000410868458
  error estimate for blocks of size 2^( 4) =       0.000425905941
  error estimate for blocks of size 2^( 5) =       0.000437182032
  error estimate for blocks of size 2^( 6) =       0.000442640817
  error estimate for blocks of size 2^( 7) =       0.000446327716

      target function =      -0.924466893174
              le_mean =     -16.898884894497
             les_mean =     285.864805098127
             stat err =       0.000438014127
             autocorr =       1.355499631160
   target nu stat err =       0.000438014127
   target dn stat err =       0.002361354136
      target stat err =       0.003776297500
              std dev =       0.532051183340
             le_variance =       0.283078461693

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.283146454764
                                         uncertainty =       0.001811284728

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.283146454764
                                         uncertainty =       0.001811284728

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000376216999
  error estimate for blocks of size 2^( 2) =       0.000393043560
  error estimate for blocks of size 2^( 3) =       0.000410868458
  error estimate for blocks of size 2^( 4) =       0.000425905940
  error estimate for blocks of size 2^( 5) =       0.000437182031
  error estimate for blocks of size 2^( 6) =       0.000442640816
  error estimate for blocks of size 2^( 7) =       0.000446327714

      target function =      -0.924466855175
              le_mean =     -16.898884894320
             les_mean =     285.864805116300
             stat err =       0.000438014125
             autocorr =       1.355499623884
   target nu stat err =       0.000438014125
   target dn stat err =       0.002361364074
      target stat err =       0.003776312472
              std dev =       0.532051182833
             le_variance =       0.283078461154


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.924466849740        initial
     2.4414e+03     2.4414e+04             7.5378e-08        -0.924466936498  <--
     9.7656e+03     9.7656e+04             1.8845e-08        -0.924466893174
     3.9062e+04     3.9062e+05             4.7113e-09        -0.924466855175

*****************************************************************************
Applying the update for shift_i =   2.4414e+03     and shift_s =   2.4414e+04
*****************************************************************************

  Execution time = 2.6218e+01
  </log>
  <optVariables href="H2O.s025.opt.xml">
ci_0001                 7.087001e-01 3 1  ON 0
ci_0002                 6.926418e-01 3 1  ON 1
ci_0003                -3.104003e-02 3 1  ON 2
ci_0004                -3.012721e-02 3 1  ON 3
ci_0005                -3.071685e-02 3 1  ON 4
ci_0006                -3.067434e-02 3 1  ON 5
ci_0007                -1.345487e-02 3 1  ON 6
ci_0008                -1.342273e-02 3 1  ON 7
ci_0009                -1.873628e-02 3 1  ON 8
ci_0010                -1.811520e-02 3 1  ON 9
ci_0011                -1.475285e-02 3 1  ON 10
ci_0012                -1.455309e-02 3 1  ON 11
ci_0013                 1.532217e-02 3 1  ON 12
ci_0014                 1.481796e-02 3 1  ON 13
ci_0015                 1.581970e-02 3 1  ON 14
ci_0016                 1.539842e-02 3 1  ON 15
ci_0017                 1.336674e-02 3 1  ON 16
ci_0018                 1.306191e-02 3 1  ON 17
ci_0019                 1.310072e-02 3 1  ON 18
ci_0020                 1.266804e-02 3 1  ON 19
ci_0021                 6.903650e-03 3 1  ON 20
ci_0022                 7.655020e-03 3 1  ON 21
ci_0023                -1.178448e-02 3 1  ON 22
ci_0024                -1.143610e-02 3 1  ON 23
ci_0025                -2.123883e-03 3 1  ON 24
ci_0026                -2.505467e-03 3 1  ON 25
ci_0027                -1.210106e-02 3 1  ON 26
ci_0028                -1.154907e-02 3 1  ON 27
ci_0029                -1.065897e-02 3 1  ON 28
ci_0030                -1.054785e-02 3 1  ON 29
ci_0031                 1.342753e-02 3 1  ON 30
ci_0032                 1.206567e-02 3 1  ON 31
ci_0033                 7.741166e-03 3 1  ON 32
ci_0034                 8.464554e-03 3 1  ON 33
ci_0035                 4.846319e-03 3 1  ON 34
ci_0036                 4.896455e-03 3 1  ON 35
ci_0037                -1.130035e-02 3 1  ON 36
ci_0038                -1.136508e-02 3 1  ON 37
ci_0039                -4.014211e-03 3 1  ON 38
ci_0040                -3.906937e-03 3 1  ON 39
ci_0041                 9.081435e-03 3 1  ON 40
ci_0042                 8.729473e-03 3 1  ON 41
ci_0043                -1.292288e-02 3 1  ON 42
ci_0044                -1.374846e-02 3 1  ON 43
ci_0045                 1.064493e-02 3 1  ON 44
ci_0046                 1.007159e-02 3 1  ON 45
ci_0047                -3.593980e-03 3 1  ON 46
ci_0048                -3.467443e-03 3 1  ON 47
ci_0049                -2.579016e-03 3 1  ON 48
ci_0050                -2.679765e-03 3 1  ON 49
ci_0051                -1.745496e-03 3 1  ON 50
ci_0052                -2.046993e-03 3 1  ON 51
ci_0053                -3.951738e-03 3 1  ON 52
ci_0054                -3.297934e-03 3 1  ON 53
ci_0055                 2.491602e-03 3 1  ON 54
ci_0056                 2.208023e-03 3 1  ON 55
ci_0057                 2.430749e-03 3 1  ON 56
ci_0058                 2.893795e-03 3 1  ON 57
ci_0059                -3.411378e-03 3 1  ON 58
ci_0060                -3.352587e-03 3 1  ON 59
ci_0061                -4.010377e-03 3 1  ON 60
ci_0062                -3.946387e-03 3 1  ON 61
ci_0063                -9.791205e-03 3 1  ON 62
ci_0064                -9.361891e-03 3 1  ON 63
ci_0065                -6.441584e-03 3 1  ON 64
ci_0066                -6.110511e-03 3 1  ON 65
ci_0067                -3.746336e-03 3 1  ON 66
ci_0068                -3.444644e-03 3 1  ON 67
ci_0069                 3.628047e-03 3 1  ON 68
ci_0070                 3.335393e-03 3 1  ON 69
ci_0071                 2.956356e-03 3 1  ON 70
ci_0072                 3.496951e-03 3 1  ON 71
ci_0073                 3.527903e-03 3 1  ON 72
ci_0074                 3.550118e-03 3 1  ON 73
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 4.2981e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s026 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s026 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=26  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6907e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 26
    time step          = 0.05
    reference energy   = -16.9088
    reference variance = 0.258353
====================================================
  Execution time = 1.4328e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s026
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5251e+04
  VMC Eavg = -1.6899e+01
  VMC Evar = 2.9022e-01
  Total weights = 1.950798731e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 2.9079e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.282608696794
                                         uncertainty =       0.001440833587

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.282608696794
                                         uncertainty =       0.001440833587

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000375936341
  error estimate for blocks of size 2^( 2) =       0.000393034604
  error estimate for blocks of size 2^( 3) =       0.000410442936
  error estimate for blocks of size 2^( 4) =       0.000425572216
  error estimate for blocks of size 2^( 5) =       0.000438144503
  error estimate for blocks of size 2^( 6) =       0.000447732297
  error estimate for blocks of size 2^( 7) =       0.000450849572

      target function =      -0.928056459878
              le_mean =     -16.898772826456
             les_mean =     285.858738976685
             stat err =       0.000440574647
             autocorr =       1.373442187316
   target nu stat err =       0.000440574647
   target dn stat err =       0.001867568964
      target stat err =       0.003044258265
              std dev =       0.531654272142
             le_variance =       0.282656265087


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.689877282646e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 74
Check correct_vf_var_size: 225, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 6.1035e+02, overlap shift 6.1035e+03 and omega -1.7444e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.928065092997       residual = 3.96e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.928065118733       residual = 6.64e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.928065126191       residual = 2.72e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.928065127824       residual = 7.86e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.928065128560       residual = 2.69e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.928065128434       residual = 1.29e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.928065128571       residual = 3.32e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.928065128730       residual = 1.97e-06           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.928065128754       residual = 5.94e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.928065128720       residual = 1.44e-07           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.928065128687       residual = 5.15e-08           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.928065128664       residual = 1.58e-08           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.928065128658       residual = 5.89e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         12 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 6.1035e+02 is 2.008508e-07

solving harmonic davidson linear method for identity shift 2.4414e+03, overlap shift 2.4414e+04 and omega -1.7444e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.928065092997       residual = 3.96e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.928065099432       residual = 6.64e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.928065101296       residual = 2.72e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.928065101704       residual = 7.86e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.928065101888       residual = 2.69e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.928065101857       residual = 1.29e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.928065101891       residual = 3.32e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.928065101930       residual = 1.97e-06           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.928065101937       residual = 5.94e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.928065101928       residual = 1.44e-07           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.928065101921       residual = 5.15e-08           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.928065101917       residual = 1.58e-08           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.928065101916       residual = 5.89e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         12 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 2.4414e+03 is 5.021530e-08

solving harmonic davidson linear method for identity shift 9.7656e+03, overlap shift 9.7656e+04 and omega -1.7444e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.928065092997       residual = 3.96e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.928065094606       residual = 6.64e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.928065095072       residual = 2.72e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.928065095170       residual = 7.86e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.928065095234       residual = 2.69e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.928065095206       residual = 1.29e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.928065095218       residual = 3.32e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.928065095244       residual = 1.97e-06           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.928065095226       residual = 5.94e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.928065095237       residual = 1.44e-07           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.928065095229       residual = 5.15e-08           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.928065095243       residual = 1.58e-08           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.928065095207       residual = 5.89e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         12 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 9.7656e+03 is 1.255399e-08

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.394602 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 75 and numParams is: 74

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.9766e+01
  </log>
  <optVariables href="H2O.s026.opt.xml">
ci_0001                 7.087001e-01 3 1  ON 0
ci_0002                 6.926418e-01 3 1  ON 1
ci_0003                -3.104003e-02 3 1  ON 2
ci_0004                -3.012721e-02 3 1  ON 3
ci_0005                -3.071687e-02 3 1  ON 4
ci_0006                -3.067434e-02 3 1  ON 5
ci_0007                -1.345486e-02 3 1  ON 6
ci_0008                -1.342269e-02 3 1  ON 7
ci_0009                -1.873629e-02 3 1  ON 8
ci_0010                -1.811523e-02 3 1  ON 9
ci_0011                -1.475283e-02 3 1  ON 10
ci_0012                -1.455310e-02 3 1  ON 11
ci_0013                 1.532214e-02 3 1  ON 12
ci_0014                 1.481794e-02 3 1  ON 13
ci_0015                 1.581968e-02 3 1  ON 14
ci_0016                 1.539842e-02 3 1  ON 15
ci_0017                 1.336672e-02 3 1  ON 16
ci_0018                 1.306190e-02 3 1  ON 17
ci_0019                 1.310071e-02 3 1  ON 18
ci_0020                 1.266804e-02 3 1  ON 19
ci_0021                 6.903600e-03 3 1  ON 20
ci_0022                 7.655042e-03 3 1  ON 21
ci_0023                -1.178449e-02 3 1  ON 22
ci_0024                -1.143610e-02 3 1  ON 23
ci_0025                -2.123906e-03 3 1  ON 24
ci_0026                -2.505486e-03 3 1  ON 25
ci_0027                -1.210107e-02 3 1  ON 26
ci_0028                -1.154905e-02 3 1  ON 27
ci_0029                -1.065896e-02 3 1  ON 28
ci_0030                -1.054789e-02 3 1  ON 29
ci_0031                 1.342753e-02 3 1  ON 30
ci_0032                 1.206566e-02 3 1  ON 31
ci_0033                 7.741148e-03 3 1  ON 32
ci_0034                 8.464538e-03 3 1  ON 33
ci_0035                 4.846349e-03 3 1  ON 34
ci_0036                 4.896456e-03 3 1  ON 35
ci_0037                -1.130031e-02 3 1  ON 36
ci_0038                -1.136505e-02 3 1  ON 37
ci_0039                -4.014215e-03 3 1  ON 38
ci_0040                -3.906929e-03 3 1  ON 39
ci_0041                 9.081455e-03 3 1  ON 40
ci_0042                 8.729487e-03 3 1  ON 41
ci_0043                -1.292291e-02 3 1  ON 42
ci_0044                -1.374851e-02 3 1  ON 43
ci_0045                 1.064492e-02 3 1  ON 44
ci_0046                 1.007157e-02 3 1  ON 45
ci_0047                -3.593983e-03 3 1  ON 46
ci_0048                -3.467441e-03 3 1  ON 47
ci_0049                -2.579034e-03 3 1  ON 48
ci_0050                -2.679773e-03 3 1  ON 49
ci_0051                -1.745487e-03 3 1  ON 50
ci_0052                -2.046996e-03 3 1  ON 51
ci_0053                -3.951738e-03 3 1  ON 52
ci_0054                -3.297944e-03 3 1  ON 53
ci_0055                 2.491594e-03 3 1  ON 54
ci_0056                 2.208017e-03 3 1  ON 55
ci_0057                 2.430753e-03 3 1  ON 56
ci_0058                 2.893780e-03 3 1  ON 57
ci_0059                -3.411370e-03 3 1  ON 58
ci_0060                -3.352568e-03 3 1  ON 59
ci_0061                -4.010349e-03 3 1  ON 60
ci_0062                -3.946378e-03 3 1  ON 61
ci_0063                -9.791217e-03 3 1  ON 62
ci_0064                -9.361896e-03 3 1  ON 63
ci_0065                -6.441589e-03 3 1  ON 64
ci_0066                -6.110517e-03 3 1  ON 65
ci_0067                -3.746318e-03 3 1  ON 66
ci_0068                -3.444670e-03 3 1  ON 67
ci_0069                 3.628058e-03 3 1  ON 68
ci_0070                 3.335372e-03 3 1  ON 69
ci_0071                 2.956367e-03 3 1  ON 70
ci_0072                 3.496937e-03 3 1  ON 71
ci_0073                 3.527904e-03 3 1  ON 72
ci_0074                 3.550098e-03 3 1  ON 73
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 26
    time step          = 0.05
    reference energy   = -16.8173
    reference variance = 0.178711
====================================================
  Execution time = 1.4076e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s026
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6898e+01
  VMC Evar = 2.9224e-01
  Total weights = 1.9512e+06
  Execution time = 1.8914e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.281528852983
                                         uncertainty =       0.001763424649

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.281528852983
                                         uncertainty =       0.001763424649

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000375163958
  error estimate for blocks of size 2^( 2) =       0.000391918430
  error estimate for blocks of size 2^( 3) =       0.000409539259
  error estimate for blocks of size 2^( 4) =       0.000424094988
  error estimate for blocks of size 2^( 5) =       0.000435409415
  error estimate for blocks of size 2^( 6) =       0.000441783751
  error estimate for blocks of size 2^( 7) =       0.000447797714

      target function =      -0.924839070455
              le_mean =     -16.897898508646
             les_mean =     285.831218293643
             stat err =       0.000437271467
             autocorr =       1.358501304157
   target nu stat err =       0.000437271467
   target dn stat err =       0.002727564191
      target stat err =       0.004336153511
              std dev =       0.530561958096
             le_variance =       0.281495991379

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.281528807411
                                         uncertainty =       0.001763419421

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.281528807411
                                         uncertainty =       0.001763419421

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000375163928
  error estimate for blocks of size 2^( 2) =       0.000391918399
  error estimate for blocks of size 2^( 3) =       0.000409539225
  error estimate for blocks of size 2^( 4) =       0.000424094951
  error estimate for blocks of size 2^( 5) =       0.000435409378
  error estimate for blocks of size 2^( 6) =       0.000441783712
  error estimate for blocks of size 2^( 7) =       0.000447797673

      target function =      -0.924839119800
              le_mean =     -16.897898507923
             les_mean =     285.831218237605
             stat err =       0.000437271429
             autocorr =       1.358501286426
   target nu stat err =       0.000437271429
   target dn stat err =       0.002727575278
      target stat err =       0.004336171062
              std dev =       0.530561915113
             le_variance =       0.281495945768

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.281528830194
                                         uncertainty =       0.001763422035

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.281528830194
                                         uncertainty =       0.001763422035

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000375163943
  error estimate for blocks of size 2^( 2) =       0.000391918414
  error estimate for blocks of size 2^( 3) =       0.000409539242
  error estimate for blocks of size 2^( 4) =       0.000424094969
  error estimate for blocks of size 2^( 5) =       0.000435409396
  error estimate for blocks of size 2^( 6) =       0.000441783731
  error estimate for blocks of size 2^( 7) =       0.000447797694

      target function =      -0.924839095327
              le_mean =     -16.897898508284
             les_mean =     285.831218265488
             stat err =       0.000437271448
             autocorr =       1.358501295292
   target nu stat err =       0.000437271448
   target dn stat err =       0.002727569733
      target stat err =       0.004336162287
              std dev =       0.530561936601
             le_variance =       0.281495968570

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.281528850134
                                         uncertainty =       0.001763424322

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.281528850134
                                         uncertainty =       0.001763424322

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000375163957
  error estimate for blocks of size 2^( 2) =       0.000391918428
  error estimate for blocks of size 2^( 3) =       0.000409539257
  error estimate for blocks of size 2^( 4) =       0.000424094985
  error estimate for blocks of size 2^( 5) =       0.000435409412
  error estimate for blocks of size 2^( 6) =       0.000441783748
  error estimate for blocks of size 2^( 7) =       0.000447797712

      target function =      -0.924839073586
              le_mean =     -16.897898508601
             les_mean =     285.831218290109
             stat err =       0.000437271464
             autocorr =       1.358501303048
   target nu stat err =       0.000437271464
   target dn stat err =       0.002727564884
      target stat err =       0.004336154608
              std dev =       0.530561955409
             le_variance =       0.281495988528


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.924839070455        initial
     6.1035e+02     6.1035e+03             2.0085e-07        -0.924839119800  <--
     2.4414e+03     2.4414e+04             5.0215e-08        -0.924839095327
     9.7656e+03     9.7656e+04             1.2554e-08        -0.924839073586

*****************************************************************************
Applying the update for shift_i =   6.1035e+02     and shift_s =   6.1035e+03
*****************************************************************************

  Execution time = 2.3544e+01
  </log>
  <optVariables href="H2O.s026.opt.xml">
ci_0001                 7.087001e-01 3 1  ON 0
ci_0002                 6.926418e-01 3 1  ON 1
ci_0003                -3.104001e-02 3 1  ON 2
ci_0004                -3.012721e-02 3 1  ON 3
ci_0005                -3.071692e-02 3 1  ON 4
ci_0006                -3.067435e-02 3 1  ON 5
ci_0007                -1.345483e-02 3 1  ON 6
ci_0008                -1.342259e-02 3 1  ON 7
ci_0009                -1.873634e-02 3 1  ON 8
ci_0010                -1.811532e-02 3 1  ON 9
ci_0011                -1.475278e-02 3 1  ON 10
ci_0012                -1.455313e-02 3 1  ON 11
ci_0013                 1.532207e-02 3 1  ON 12
ci_0014                 1.481790e-02 3 1  ON 13
ci_0015                 1.581965e-02 3 1  ON 14
ci_0016                 1.539840e-02 3 1  ON 15
ci_0017                 1.336668e-02 3 1  ON 16
ci_0018                 1.306186e-02 3 1  ON 17
ci_0019                 1.310068e-02 3 1  ON 18
ci_0020                 1.266804e-02 3 1  ON 19
ci_0021                 6.903450e-03 3 1  ON 20
ci_0022                 7.655110e-03 3 1  ON 21
ci_0023                -1.178453e-02 3 1  ON 22
ci_0024                -1.143610e-02 3 1  ON 23
ci_0025                -2.123972e-03 3 1  ON 24
ci_0026                -2.505541e-03 3 1  ON 25
ci_0027                -1.210112e-02 3 1  ON 26
ci_0028                -1.154899e-02 3 1  ON 27
ci_0029                -1.065894e-02 3 1  ON 28
ci_0030                -1.054800e-02 3 1  ON 29
ci_0031                 1.342755e-02 3 1  ON 30
ci_0032                 1.206564e-02 3 1  ON 31
ci_0033                 7.741093e-03 3 1  ON 32
ci_0034                 8.464492e-03 3 1  ON 33
ci_0035                 4.846439e-03 3 1  ON 34
ci_0036                 4.896458e-03 3 1  ON 35
ci_0037                -1.130019e-02 3 1  ON 36
ci_0038                -1.136498e-02 3 1  ON 37
ci_0039                -4.014226e-03 3 1  ON 38
ci_0040                -3.906905e-03 3 1  ON 39
ci_0041                 9.081517e-03 3 1  ON 40
ci_0042                 8.729530e-03 3 1  ON 41
ci_0043                -1.292302e-02 3 1  ON 42
ci_0044                -1.374865e-02 3 1  ON 43
ci_0045                 1.064488e-02 3 1  ON 44
ci_0046                 1.007150e-02 3 1  ON 45
ci_0047                -3.593992e-03 3 1  ON 46
ci_0048                -3.467434e-03 3 1  ON 47
ci_0049                -2.579089e-03 3 1  ON 48
ci_0050                -2.679796e-03 3 1  ON 49
ci_0051                -1.745460e-03 3 1  ON 50
ci_0052                -2.047004e-03 3 1  ON 51
ci_0053                -3.951740e-03 3 1  ON 52
ci_0054                -3.297977e-03 3 1  ON 53
ci_0055                 2.491570e-03 3 1  ON 54
ci_0056                 2.207999e-03 3 1  ON 55
ci_0057                 2.430766e-03 3 1  ON 56
ci_0058                 2.893735e-03 3 1  ON 57
ci_0059                -3.411343e-03 3 1  ON 58
ci_0060                -3.352511e-03 3 1  ON 59
ci_0061                -4.010264e-03 3 1  ON 60
ci_0062                -3.946351e-03 3 1  ON 61
ci_0063                -9.791251e-03 3 1  ON 62
ci_0064                -9.361911e-03 3 1  ON 63
ci_0065                -6.441606e-03 3 1  ON 64
ci_0066                -6.110535e-03 3 1  ON 65
ci_0067                -3.746263e-03 3 1  ON 66
ci_0068                -3.444748e-03 3 1  ON 67
ci_0069                 3.628091e-03 3 1  ON 68
ci_0070                 3.335307e-03 3 1  ON 69
ci_0071                 2.956402e-03 3 1  ON 70
ci_0072                 3.496892e-03 3 1  ON 71
ci_0073                 3.527908e-03 3 1  ON 72
ci_0074                 3.550038e-03 3 1  ON 73
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 4.3316e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s027 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s027 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=27  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6906e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 27
    time step          = 0.05
    reference energy   = -16.8832
    reference variance = 0.376865
====================================================
  Execution time = 1.4147e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s027
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5229e+04
  VMC Eavg = -1.6898e+01
  VMC Evar = 2.9303e-01
  Total weights = 1.951116894e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 2.5772e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.283899449718
                                         uncertainty =       0.002343277632

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.283899449718
                                         uncertainty =       0.002343277632

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000376764740
  error estimate for blocks of size 2^( 2) =       0.000394048476
  error estimate for blocks of size 2^( 3) =       0.000411805413
  error estimate for blocks of size 2^( 4) =       0.000427808136
  error estimate for blocks of size 2^( 5) =       0.000440234379
  error estimate for blocks of size 2^( 6) =       0.000447608569
  error estimate for blocks of size 2^( 7) =       0.000453757675

      target function =      -0.923613684197
              le_mean =     -16.898468514164
             les_mean =     285.851268428707
             stat err =       0.000442352190
             autocorr =       1.378465364251
   target nu stat err =       0.000442352190
   target dn stat err =       0.002852782604
      target stat err =       0.004523856842
              std dev =       0.532825805446
             le_variance =       0.283903338950


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.689846851416e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 74
Check correct_vf_var_size: 225, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.5259e+02, overlap shift 1.5259e+03 and omega -1.7444e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.923636235957       residual = 1.36e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.923636702369       residual = 7.50e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.923636728930       residual = 1.96e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.923636741367       residual = 1.10e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.923636745116       residual = 2.88e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.923636746870       residual = 1.21e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.923636747557       residual = 4.91e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.923636748014       residual = 2.85e-06           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.923636748738       residual = 3.21e-06           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.923636749098       residual = 2.39e-06           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.923636749604       residual = 1.87e-06           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.923636749703       residual = 9.02e-07           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.923636749581       residual = 5.18e-07           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.923636749595       residual = 1.78e-07           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.923636749605       residual = 4.50e-08           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.923636749639       residual = 1.81e-08           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.923636749638       residual = 3.60e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         16 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 1.5259e+02 is 1.615043e-06

solving harmonic davidson linear method for identity shift 6.1035e+02, overlap shift 6.1035e+03 and omega -1.7444e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.923636235957       residual = 1.36e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.923636352605       residual = 7.50e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.923636359247       residual = 1.96e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.923636362357       residual = 1.10e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.923636363295       residual = 2.88e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.923636363732       residual = 1.21e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.923636363905       residual = 4.91e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.923636364019       residual = 2.84e-06           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.923636364200       residual = 3.21e-06           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.923636364290       residual = 2.39e-06           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.923636364417       residual = 1.87e-06           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.923636364441       residual = 9.00e-07           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.923636364410       residual = 5.17e-07           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.923636364413       residual = 1.78e-07           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.923636364416       residual = 4.49e-08           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.923636364425       residual = 1.81e-08           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.923636364424       residual = 3.59e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         16 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 6.1035e+02 is 4.039185e-07

solving harmonic davidson linear method for identity shift 2.4414e+03, overlap shift 2.4414e+04 and omega -1.7444e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.923636235957       residual = 1.36e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.923636265122       residual = 7.50e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.923636266783       residual = 1.96e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.923636267560       residual = 1.10e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.923636267793       residual = 2.88e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.923636267904       residual = 1.21e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.923636267945       residual = 4.91e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.923636267975       residual = 2.84e-06           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.923636268019       residual = 3.21e-06           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.923636268045       residual = 2.39e-06           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.923636268075       residual = 1.87e-06           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.923636268081       residual = 9.00e-07           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.923636268077       residual = 5.17e-07           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.923636268076       residual = 1.78e-07           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.923636268079       residual = 4.49e-08           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.923636268070       residual = 1.81e-08           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.923636268078       residual = 3.59e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         16 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 2.4414e+03 is 1.009895e-07

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.403672 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 75 and numParams is: 74

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.6739e+01
  </log>
  <optVariables href="H2O.s027.opt.xml">
ci_0001                 7.087003e-01 3 1  ON 0
ci_0002                 6.926416e-01 3 1  ON 1
ci_0003                -3.103999e-02 3 1  ON 2
ci_0004                -3.012722e-02 3 1  ON 3
ci_0005                -3.071694e-02 3 1  ON 4
ci_0006                -3.067443e-02 3 1  ON 5
ci_0007                -1.345472e-02 3 1  ON 6
ci_0008                -1.342269e-02 3 1  ON 7
ci_0009                -1.873629e-02 3 1  ON 8
ci_0010                -1.811538e-02 3 1  ON 9
ci_0011                -1.475278e-02 3 1  ON 10
ci_0012                -1.455314e-02 3 1  ON 11
ci_0013                 1.532205e-02 3 1  ON 12
ci_0014                 1.481784e-02 3 1  ON 13
ci_0015                 1.581963e-02 3 1  ON 14
ci_0016                 1.539839e-02 3 1  ON 15
ci_0017                 1.336666e-02 3 1  ON 16
ci_0018                 1.306168e-02 3 1  ON 17
ci_0019                 1.310071e-02 3 1  ON 18
ci_0020                 1.266803e-02 3 1  ON 19
ci_0021                 6.903380e-03 3 1  ON 20
ci_0022                 7.655014e-03 3 1  ON 21
ci_0023                -1.178457e-02 3 1  ON 22
ci_0024                -1.143608e-02 3 1  ON 23
ci_0025                -2.124240e-03 3 1  ON 24
ci_0026                -2.505369e-03 3 1  ON 25
ci_0027                -1.210099e-02 3 1  ON 26
ci_0028                -1.154898e-02 3 1  ON 27
ci_0029                -1.065897e-02 3 1  ON 28
ci_0030                -1.054813e-02 3 1  ON 29
ci_0031                 1.342768e-02 3 1  ON 30
ci_0032                 1.206571e-02 3 1  ON 31
ci_0033                 7.741221e-03 3 1  ON 32
ci_0034                 8.464312e-03 3 1  ON 33
ci_0035                 4.846035e-03 3 1  ON 34
ci_0036                 4.896277e-03 3 1  ON 35
ci_0037                -1.130007e-02 3 1  ON 36
ci_0038                -1.136499e-02 3 1  ON 37
ci_0039                -4.014180e-03 3 1  ON 38
ci_0040                -3.906930e-03 3 1  ON 39
ci_0041                 9.081537e-03 3 1  ON 40
ci_0042                 8.729579e-03 3 1  ON 41
ci_0043                -1.292316e-02 3 1  ON 42
ci_0044                -1.374862e-02 3 1  ON 43
ci_0045                 1.064488e-02 3 1  ON 44
ci_0046                 1.007150e-02 3 1  ON 45
ci_0047                -3.593954e-03 3 1  ON 46
ci_0048                -3.467404e-03 3 1  ON 47
ci_0049                -2.578909e-03 3 1  ON 48
ci_0050                -2.679846e-03 3 1  ON 49
ci_0051                -1.745485e-03 3 1  ON 50
ci_0052                -2.047011e-03 3 1  ON 51
ci_0053                -3.951709e-03 3 1  ON 52
ci_0054                -3.298029e-03 3 1  ON 53
ci_0055                 2.491461e-03 3 1  ON 54
ci_0056                 2.208103e-03 3 1  ON 55
ci_0057                 2.430952e-03 3 1  ON 56
ci_0058                 2.893841e-03 3 1  ON 57
ci_0059                -3.411435e-03 3 1  ON 58
ci_0060                -3.352451e-03 3 1  ON 59
ci_0061                -4.010243e-03 3 1  ON 60
ci_0062                -3.946268e-03 3 1  ON 61
ci_0063                -9.791228e-03 3 1  ON 62
ci_0064                -9.361931e-03 3 1  ON 63
ci_0065                -6.441662e-03 3 1  ON 64
ci_0066                -6.110518e-03 3 1  ON 65
ci_0067                -3.746122e-03 3 1  ON 66
ci_0068                -3.444665e-03 3 1  ON 67
ci_0069                 3.628013e-03 3 1  ON 68
ci_0070                 3.335388e-03 3 1  ON 69
ci_0071                 2.956375e-03 3 1  ON 70
ci_0072                 3.497059e-03 3 1  ON 71
ci_0073                 3.527877e-03 3 1  ON 72
ci_0074                 3.549993e-03 3 1  ON 73
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 27
    time step          = 0.05
    reference energy   = -16.9424
    reference variance = 0.19933
====================================================
  Execution time = 1.3839e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s027
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6898e+01
  VMC Evar = 2.9742e-01
  Total weights = 1.9512e+06
  Execution time = 1.8741e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.286239127564
                                         uncertainty =       0.002633289970

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.286239127564
                                         uncertainty =       0.002633289970

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000378295814
  error estimate for blocks of size 2^( 2) =       0.000395406092
  error estimate for blocks of size 2^( 3) =       0.000413331494
  error estimate for blocks of size 2^( 4) =       0.000428730151
  error estimate for blocks of size 2^( 5) =       0.000442142529
  error estimate for blocks of size 2^( 6) =       0.000449357767
  error estimate for blocks of size 2^( 7) =       0.000453670736

      target function =      -0.916791293792
              le_mean =     -16.898347483760
             les_mean =     285.851566628075
             stat err =       0.000443475296
             autocorr =       1.374281791934
   target nu stat err =       0.000443475296
   target dn stat err =       0.003575829656
      target stat err =       0.005558884367
              std dev =       0.534991070813
             le_variance =       0.286215445849

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.286239176764
                                         uncertainty =       0.002633328796

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.286239176764
                                         uncertainty =       0.002633328796

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000378295847
  error estimate for blocks of size 2^( 2) =       0.000395406156
  error estimate for blocks of size 2^( 3) =       0.000413331597
  error estimate for blocks of size 2^( 4) =       0.000428730254
  error estimate for blocks of size 2^( 5) =       0.000442142605
  error estimate for blocks of size 2^( 6) =       0.000449357843
  error estimate for blocks of size 2^( 7) =       0.000453670736

      target function =      -0.916791987847
              le_mean =     -16.898347483754
             les_mean =     285.851566177408
             stat err =       0.000443475359
             autocorr =       1.374281948603
   target nu stat err =       0.000443475359
   target dn stat err =       0.003575821471
      target stat err =       0.005558880226
              std dev =       0.534991117268
             le_variance =       0.286215495555

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.286239152120
                                         uncertainty =       0.002633309388

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.286239152120
                                         uncertainty =       0.002633309388

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000378295830
  error estimate for blocks of size 2^( 2) =       0.000395406124
  error estimate for blocks of size 2^( 3) =       0.000413331545
  error estimate for blocks of size 2^( 4) =       0.000428730202
  error estimate for blocks of size 2^( 5) =       0.000442142567
  error estimate for blocks of size 2^( 6) =       0.000449357805
  error estimate for blocks of size 2^( 7) =       0.000453670736

      target function =      -0.916791642489
              le_mean =     -16.898347483751
             les_mean =     285.851566401484
             stat err =       0.000443475328
             autocorr =       1.374281870377
   target nu stat err =       0.000443475328
   target dn stat err =       0.003575825544
      target stat err =       0.005558882287
              std dev =       0.534991093999
             le_variance =       0.286215470659

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.286239130628
                                         uncertainty =       0.002633292397

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.286239130628
                                         uncertainty =       0.002633292397

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000378295816
  error estimate for blocks of size 2^( 2) =       0.000395406096
  error estimate for blocks of size 2^( 3) =       0.000413331500
  error estimate for blocks of size 2^( 4) =       0.000428730158
  error estimate for blocks of size 2^( 5) =       0.000442142534
  error estimate for blocks of size 2^( 6) =       0.000449357771
  error estimate for blocks of size 2^( 7) =       0.000453670736

      target function =      -0.916791337559
              le_mean =     -16.898347483758
             les_mean =     285.851566599615
             stat err =       0.000443475300
             autocorr =       1.374281801739
   target nu stat err =       0.000443475300
   target dn stat err =       0.003575829140
      target stat err =       0.005558884105
              std dev =       0.534991073706
             le_variance =       0.286215448945


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.916791293792        initial
     1.5259e+02     1.5259e+03             1.6150e-06        -0.916791987847  <--
     6.1035e+02     6.1035e+03             4.0392e-07        -0.916791642489
     2.4414e+03     2.4414e+04             1.0099e-07        -0.916791337559

*****************************************************************************
Applying the update for shift_i =   1.5259e+02     and shift_s =   1.5259e+03
*****************************************************************************

  Execution time = 2.3286e+01
  </log>
  <optVariables href="H2O.s027.opt.xml">
ci_0001                 7.087008e-01 3 1  ON 0
ci_0002                 6.926410e-01 3 1  ON 1
ci_0003                -3.103995e-02 3 1  ON 2
ci_0004                -3.012725e-02 3 1  ON 3
ci_0005                -3.071701e-02 3 1  ON 4
ci_0006                -3.067468e-02 3 1  ON 5
ci_0007                -1.345440e-02 3 1  ON 6
ci_0008                -1.342301e-02 3 1  ON 7
ci_0009                -1.873614e-02 3 1  ON 8
ci_0010                -1.811557e-02 3 1  ON 9
ci_0011                -1.475277e-02 3 1  ON 10
ci_0012                -1.455315e-02 3 1  ON 11
ci_0013                 1.532199e-02 3 1  ON 12
ci_0014                 1.481765e-02 3 1  ON 13
ci_0015                 1.581959e-02 3 1  ON 14
ci_0016                 1.539836e-02 3 1  ON 15
ci_0017                 1.336662e-02 3 1  ON 16
ci_0018                 1.306115e-02 3 1  ON 17
ci_0019                 1.310079e-02 3 1  ON 18
ci_0020                 1.266802e-02 3 1  ON 19
ci_0021                 6.903173e-03 3 1  ON 20
ci_0022                 7.654726e-03 3 1  ON 21
ci_0023                -1.178469e-02 3 1  ON 22
ci_0024                -1.143604e-02 3 1  ON 23
ci_0025                -2.125041e-03 3 1  ON 24
ci_0026                -2.504853e-03 3 1  ON 25
ci_0027                -1.210061e-02 3 1  ON 26
ci_0028                -1.154896e-02 3 1  ON 27
ci_0029                -1.065908e-02 3 1  ON 28
ci_0030                -1.054849e-02 3 1  ON 29
ci_0031                 1.342808e-02 3 1  ON 30
ci_0032                 1.206592e-02 3 1  ON 31
ci_0033                 7.741607e-03 3 1  ON 32
ci_0034                 8.463773e-03 3 1  ON 33
ci_0035                 4.844824e-03 3 1  ON 34
ci_0036                 4.895736e-03 3 1  ON 35
ci_0037                -1.129974e-02 3 1  ON 36
ci_0038                -1.136503e-02 3 1  ON 37
ci_0039                -4.014040e-03 3 1  ON 38
ci_0040                -3.907005e-03 3 1  ON 39
ci_0041                 9.081597e-03 3 1  ON 40
ci_0042                 8.729725e-03 3 1  ON 41
ci_0043                -1.292359e-02 3 1  ON 42
ci_0044                -1.374852e-02 3 1  ON 43
ci_0045                 1.064485e-02 3 1  ON 44
ci_0046                 1.007151e-02 3 1  ON 45
ci_0047                -3.593840e-03 3 1  ON 46
ci_0048                -3.467314e-03 3 1  ON 47
ci_0049                -2.578368e-03 3 1  ON 48
ci_0050                -2.679995e-03 3 1  ON 49
ci_0051                -1.745558e-03 3 1  ON 50
ci_0052                -2.047029e-03 3 1  ON 51
ci_0053                -3.951616e-03 3 1  ON 52
ci_0054                -3.298185e-03 3 1  ON 53
ci_0055                 2.491133e-03 3 1  ON 54
ci_0056                 2.208414e-03 3 1  ON 55
ci_0057                 2.431509e-03 3 1  ON 56
ci_0058                 2.894159e-03 3 1  ON 57
ci_0059                -3.411711e-03 3 1  ON 58
ci_0060                -3.352271e-03 3 1  ON 59
ci_0061                -4.010181e-03 3 1  ON 60
ci_0062                -3.946018e-03 3 1  ON 61
ci_0063                -9.791160e-03 3 1  ON 62
ci_0064                -9.361993e-03 3 1  ON 63
ci_0065                -6.441829e-03 3 1  ON 64
ci_0066                -6.110469e-03 3 1  ON 65
ci_0067                -3.745699e-03 3 1  ON 66
ci_0068                -3.444419e-03 3 1  ON 67
ci_0069                 3.627777e-03 3 1  ON 68
ci_0070                 3.335629e-03 3 1  ON 69
ci_0071                 2.956294e-03 3 1  ON 70
ci_0072                 3.497558e-03 3 1  ON 71
ci_0073                 3.527786e-03 3 1  ON 72
ci_0074                 3.549859e-03 3 1  ON 73
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 4.0032e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s028 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s028 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=28  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6906e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 28
    time step          = 0.05
    reference energy   = -16.8976
    reference variance = 0.245898
====================================================
  Execution time = 1.4256e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s028
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5263e+04
  VMC Eavg = -1.6898e+01
  VMC Evar = 2.9603e-01
  Total weights = 1.951465531e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 2.5831e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.283852864585
                                         uncertainty =       0.002377612407

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.283852864585
                                         uncertainty =       0.002377612407

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000376688801
  error estimate for blocks of size 2^( 2) =       0.000393377772
  error estimate for blocks of size 2^( 3) =       0.000410849213
  error estimate for blocks of size 2^( 4) =       0.000426084557
  error estimate for blocks of size 2^( 5) =       0.000437834149
  error estimate for blocks of size 2^( 6) =       0.000446287700
  error estimate for blocks of size 2^( 7) =       0.000450768919

      target function =      -0.918938722700
              le_mean =     -16.898200739475
             les_mean =     285.845213546661
             stat err =       0.000440243831
             autocorr =       1.365907034825
   target nu stat err =       0.000440243831
   target dn stat err =       0.003748068607
      target stat err =       0.005846780390
              std dev =       0.532718410868
             le_variance =       0.283788905278


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.689820073947e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 74
Check correct_vf_var_size: 225, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 3.8147e+01, overlap shift 3.8147e+02 and omega -1.7444e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.918974624668       residual = 3.20e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.918977732510       residual = 2.01e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.918977946415       residual = 4.47e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.918978000403       residual = 1.84e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.918978017206       residual = 8.20e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.918978043910       residual = 5.79e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.918978070628       residual = 4.98e-05           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.918978078880       residual = 4.06e-05           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.918978085793       residual = 6.63e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.918978099745       residual = 1.85e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.918978115470       residual = 6.32e-06           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.918978118911       residual = 2.25e-06           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.918978120072       residual = 6.90e-07           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.918978120073       residual = 3.05e-07           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.918978120261       residual = 7.58e-08           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.918978120103       residual = 2.33e-08           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.918978119897       residual = 5.63e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         16 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 3.8147e+01 is 1.084954e-05

solving harmonic davidson linear method for identity shift 1.5259e+02, overlap shift 1.5259e+03 and omega -1.7444e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.918974624668       residual = 3.20e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.918975402845       residual = 2.01e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.918975456397       residual = 4.47e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.918975469906       residual = 1.84e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.918975474108       residual = 8.20e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.918975480789       residual = 5.78e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.918975487471       residual = 4.97e-05           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.918975489535       residual = 4.06e-05           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.918975491263       residual = 6.61e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.918975494747       residual = 1.84e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.918975498671       residual = 6.29e-06           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.918975499528       residual = 2.23e-06           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.918975499817       residual = 6.86e-07           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.918975499817       residual = 3.02e-07           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.918975499864       residual = 7.52e-08           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.918975499824       residual = 2.31e-08           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.918975499773       residual = 5.58e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         16 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 1.5259e+02 is 2.712526e-06

solving harmonic davidson linear method for identity shift 6.1035e+02, overlap shift 6.1035e+03 and omega -1.7444e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.918974624668       residual = 3.20e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.918974819288       residual = 2.01e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.918974832681       residual = 4.47e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.918974836059       residual = 1.83e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.918974837110       residual = 8.19e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.918974838780       residual = 5.78e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.918974840451       residual = 4.97e-05           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.918974840967       residual = 4.06e-05           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.918974841399       residual = 6.61e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.918974842270       residual = 1.84e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.918974843250       residual = 6.28e-06           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.918974843465       residual = 2.23e-06           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.918974843537       residual = 6.85e-07           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.918974843537       residual = 3.02e-07           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.918974843548       residual = 7.50e-08           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.918974843538       residual = 2.30e-08           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.918974843525       residual = 5.57e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         16 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 6.1035e+02 is 6.781405e-07

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.412762 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 75 and numParams is: 74

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.6855e+01
  </log>
  <optVariables href="H2O.s028.opt.xml">
ci_0001                 7.086981e-01 3 1  ON 0
ci_0002                 6.926437e-01 3 1  ON 1
ci_0003                -3.103987e-02 3 1  ON 2
ci_0004                -3.012755e-02 3 1  ON 3
ci_0005                -3.071724e-02 3 1  ON 4
ci_0006                -3.067517e-02 3 1  ON 5
ci_0007                -1.345405e-02 3 1  ON 6
ci_0008                -1.342279e-02 3 1  ON 7
ci_0009                -1.873550e-02 3 1  ON 8
ci_0010                -1.811548e-02 3 1  ON 9
ci_0011                -1.475319e-02 3 1  ON 10
ci_0012                -1.455326e-02 3 1  ON 11
ci_0013                 1.532203e-02 3 1  ON 12
ci_0014                 1.481776e-02 3 1  ON 13
ci_0015                 1.581939e-02 3 1  ON 14
ci_0016                 1.539839e-02 3 1  ON 15
ci_0017                 1.336687e-02 3 1  ON 16
ci_0018                 1.306097e-02 3 1  ON 17
ci_0019                 1.310080e-02 3 1  ON 18
ci_0020                 1.266775e-02 3 1  ON 19
ci_0021                 6.902853e-03 3 1  ON 20
ci_0022                 7.654485e-03 3 1  ON 21
ci_0023                -1.178506e-02 3 1  ON 22
ci_0024                -1.143646e-02 3 1  ON 23
ci_0025                -2.125072e-03 3 1  ON 24
ci_0026                -2.504892e-03 3 1  ON 25
ci_0027                -1.210078e-02 3 1  ON 26
ci_0028                -1.154892e-02 3 1  ON 27
ci_0029                -1.065870e-02 3 1  ON 28
ci_0030                -1.054829e-02 3 1  ON 29
ci_0031                 1.342853e-02 3 1  ON 30
ci_0032                 1.206553e-02 3 1  ON 31
ci_0033                 7.741689e-03 3 1  ON 32
ci_0034                 8.464337e-03 3 1  ON 33
ci_0035                 4.844225e-03 3 1  ON 34
ci_0036                 4.895292e-03 3 1  ON 35
ci_0037                -1.129970e-02 3 1  ON 36
ci_0038                -1.136538e-02 3 1  ON 37
ci_0039                -4.014015e-03 3 1  ON 38
ci_0040                -3.907059e-03 3 1  ON 39
ci_0041                 9.081614e-03 3 1  ON 40
ci_0042                 8.729982e-03 3 1  ON 41
ci_0043                -1.292402e-02 3 1  ON 42
ci_0044                -1.374942e-02 3 1  ON 43
ci_0045                 1.064491e-02 3 1  ON 44
ci_0046                 1.007173e-02 3 1  ON 45
ci_0047                -3.593753e-03 3 1  ON 46
ci_0048                -3.467425e-03 3 1  ON 47
ci_0049                -2.575937e-03 3 1  ON 48
ci_0050                -2.680110e-03 3 1  ON 49
ci_0051                -1.745923e-03 3 1  ON 50
ci_0052                -2.046883e-03 3 1  ON 51
ci_0053                -3.952011e-03 3 1  ON 52
ci_0054                -3.298279e-03 3 1  ON 53
ci_0055                 2.491942e-03 3 1  ON 54
ci_0056                 2.208538e-03 3 1  ON 55
ci_0057                 2.432077e-03 3 1  ON 56
ci_0058                 2.894491e-03 3 1  ON 57
ci_0059                -3.411490e-03 3 1  ON 58
ci_0060                -3.352253e-03 3 1  ON 59
ci_0061                -4.010331e-03 3 1  ON 60
ci_0062                -3.945936e-03 3 1  ON 61
ci_0063                -9.791246e-03 3 1  ON 62
ci_0064                -9.362007e-03 3 1  ON 63
ci_0065                -6.441366e-03 3 1  ON 64
ci_0066                -6.110426e-03 3 1  ON 65
ci_0067                -3.747030e-03 3 1  ON 66
ci_0068                -3.444399e-03 3 1  ON 67
ci_0069                 3.627424e-03 3 1  ON 68
ci_0070                 3.335441e-03 3 1  ON 69
ci_0071                 2.957733e-03 3 1  ON 70
ci_0072                 3.497641e-03 3 1  ON 71
ci_0073                 3.527112e-03 3 1  ON 72
ci_0074                 3.549825e-03 3 1  ON 73
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 28
    time step          = 0.05
    reference energy   = -16.9262
    reference variance = 0.156694
====================================================
  Execution time = 1.3941e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s028
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6898e+01
  VMC Evar = 2.9652e-01
  Total weights = 1.9509e+06
  Execution time = 1.8636e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.284299224442
                                         uncertainty =       0.002378629229

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.284299224442
                                         uncertainty =       0.002378629229

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000376970031
  error estimate for blocks of size 2^( 2) =       0.000393833688
  error estimate for blocks of size 2^( 3) =       0.000411258485
  error estimate for blocks of size 2^( 4) =       0.000425432902
  error estimate for blocks of size 2^( 5) =       0.000436910375
  error estimate for blocks of size 2^( 6) =       0.000443110035
  error estimate for blocks of size 2^( 7) =       0.000444509154

      target function =      -0.918146046494
              le_mean =     -16.898161239026
             les_mean =     285.844371740374
             stat err =       0.000437490616
             autocorr =       1.346864279662
   target nu stat err =       0.000437490616
   target dn stat err =       0.005077659769
      target stat err =       0.007877544226
              std dev =       0.533116129760
             le_variance =       0.284212807810

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.284298788735
                                         uncertainty =       0.002378724899

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.284298788735
                                         uncertainty =       0.002378724899

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000376969739
  error estimate for blocks of size 2^( 2) =       0.000393833457
  error estimate for blocks of size 2^( 3) =       0.000411258267
  error estimate for blocks of size 2^( 4) =       0.000425432653
  error estimate for blocks of size 2^( 5) =       0.000436909873
  error estimate for blocks of size 2^( 6) =       0.000443109515
  error estimate for blocks of size 2^( 7) =       0.000444508551

      target function =      -0.918144255022
              le_mean =     -16.898161244002
             les_mean =     285.844373045183
             stat err =       0.000437490148
             autocorr =       1.346863478456
   target nu stat err =       0.000437490148
   target dn stat err =       0.005079035175
      target stat err =       0.007879629114
              std dev =       0.533115717521
             le_variance =       0.284212368268

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.284299005149
                                         uncertainty =       0.002378677170

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.284299005149
                                         uncertainty =       0.002378677170

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000376969884
  error estimate for blocks of size 2^( 2) =       0.000393833572
  error estimate for blocks of size 2^( 3) =       0.000411258375
  error estimate for blocks of size 2^( 4) =       0.000425432777
  error estimate for blocks of size 2^( 5) =       0.000436910123
  error estimate for blocks of size 2^( 6) =       0.000443109774
  error estimate for blocks of size 2^( 7) =       0.000444508852

      target function =      -0.918145247002
              le_mean =     -16.898161241371
             les_mean =     285.844372325622
             stat err =       0.000437490381
             autocorr =       1.346863879883
   target nu stat err =       0.000437490381
   target dn stat err =       0.005078348554
      target stat err =       0.007878589978
              std dev =       0.533115922289
             le_variance =       0.284212586598

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.284299196878
                                         uncertainty =       0.002378635221

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.284299196878
                                         uncertainty =       0.002378635221

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000376970012
  error estimate for blocks of size 2^( 2) =       0.000393833674
  error estimate for blocks of size 2^( 3) =       0.000411258471
  error estimate for blocks of size 2^( 4) =       0.000425432886
  error estimate for blocks of size 2^( 5) =       0.000436910343
  error estimate for blocks of size 2^( 6) =       0.000443110002
  error estimate for blocks of size 2^( 7) =       0.000444509116

      target function =      -0.918145960282
              le_mean =     -16.898161239304
             les_mean =     285.844371804129
             stat err =       0.000437490587
             autocorr =       1.346864229783
   target nu stat err =       0.000437490587
   target dn stat err =       0.005077745873
      target stat err =       0.007877675188
              std dev =       0.533116103684
             le_variance =       0.284212780007


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.918146046494        initial  <--
     3.8147e+01     3.8147e+02             1.0850e-05        -0.918144255022
     1.5259e+02     1.5259e+03             2.7125e-06        -0.918145247002
     6.1035e+02     6.1035e+03             6.7814e-07        -0.918145960282

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 23.3819
  </log>
  <optVariables href="H2O.s028.opt.xml">
ci_0001                 7.087008e-01 3 1  ON 0
ci_0002                 6.926410e-01 3 1  ON 1
ci_0003                -3.103995e-02 3 1  ON 2
ci_0004                -3.012725e-02 3 1  ON 3
ci_0005                -3.071701e-02 3 1  ON 4
ci_0006                -3.067468e-02 3 1  ON 5
ci_0007                -1.345440e-02 3 1  ON 6
ci_0008                -1.342301e-02 3 1  ON 7
ci_0009                -1.873614e-02 3 1  ON 8
ci_0010                -1.811557e-02 3 1  ON 9
ci_0011                -1.475277e-02 3 1  ON 10
ci_0012                -1.455315e-02 3 1  ON 11
ci_0013                 1.532199e-02 3 1  ON 12
ci_0014                 1.481765e-02 3 1  ON 13
ci_0015                 1.581959e-02 3 1  ON 14
ci_0016                 1.539836e-02 3 1  ON 15
ci_0017                 1.336662e-02 3 1  ON 16
ci_0018                 1.306115e-02 3 1  ON 17
ci_0019                 1.310079e-02 3 1  ON 18
ci_0020                 1.266802e-02 3 1  ON 19
ci_0021                 6.903173e-03 3 1  ON 20
ci_0022                 7.654726e-03 3 1  ON 21
ci_0023                -1.178469e-02 3 1  ON 22
ci_0024                -1.143604e-02 3 1  ON 23
ci_0025                -2.125041e-03 3 1  ON 24
ci_0026                -2.504853e-03 3 1  ON 25
ci_0027                -1.210061e-02 3 1  ON 26
ci_0028                -1.154896e-02 3 1  ON 27
ci_0029                -1.065908e-02 3 1  ON 28
ci_0030                -1.054849e-02 3 1  ON 29
ci_0031                 1.342808e-02 3 1  ON 30
ci_0032                 1.206592e-02 3 1  ON 31
ci_0033                 7.741607e-03 3 1  ON 32
ci_0034                 8.463773e-03 3 1  ON 33
ci_0035                 4.844824e-03 3 1  ON 34
ci_0036                 4.895736e-03 3 1  ON 35
ci_0037                -1.129974e-02 3 1  ON 36
ci_0038                -1.136503e-02 3 1  ON 37
ci_0039                -4.014040e-03 3 1  ON 38
ci_0040                -3.907005e-03 3 1  ON 39
ci_0041                 9.081597e-03 3 1  ON 40
ci_0042                 8.729725e-03 3 1  ON 41
ci_0043                -1.292359e-02 3 1  ON 42
ci_0044                -1.374852e-02 3 1  ON 43
ci_0045                 1.064485e-02 3 1  ON 44
ci_0046                 1.007151e-02 3 1  ON 45
ci_0047                -3.593840e-03 3 1  ON 46
ci_0048                -3.467314e-03 3 1  ON 47
ci_0049                -2.578368e-03 3 1  ON 48
ci_0050                -2.679995e-03 3 1  ON 49
ci_0051                -1.745558e-03 3 1  ON 50
ci_0052                -2.047029e-03 3 1  ON 51
ci_0053                -3.951616e-03 3 1  ON 52
ci_0054                -3.298185e-03 3 1  ON 53
ci_0055                 2.491133e-03 3 1  ON 54
ci_0056                 2.208414e-03 3 1  ON 55
ci_0057                 2.431509e-03 3 1  ON 56
ci_0058                 2.894159e-03 3 1  ON 57
ci_0059                -3.411711e-03 3 1  ON 58
ci_0060                -3.352271e-03 3 1  ON 59
ci_0061                -4.010181e-03 3 1  ON 60
ci_0062                -3.946018e-03 3 1  ON 61
ci_0063                -9.791160e-03 3 1  ON 62
ci_0064                -9.361993e-03 3 1  ON 63
ci_0065                -6.441829e-03 3 1  ON 64
ci_0066                -6.110469e-03 3 1  ON 65
ci_0067                -3.745699e-03 3 1  ON 66
ci_0068                -3.444419e-03 3 1  ON 67
ci_0069                 3.627777e-03 3 1  ON 68
ci_0070                 3.335629e-03 3 1  ON 69
ci_0071                 2.956294e-03 3 1  ON 70
ci_0072                 3.497558e-03 3 1  ON 71
ci_0073                 3.527786e-03 3 1  ON 72
ci_0074                 3.549859e-03 3 1  ON 73
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 4.0244e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s029 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s029 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=29  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6906e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 29
    time step          = 0.05
    reference energy   = -16.8486
    reference variance = 0.251536
====================================================
  Execution time = 1.4327e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s029
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5226e+04
  VMC Eavg = -1.6899e+01
  VMC Evar = 3.0334e-01
  Total weights = 1.950926126e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 2.6235e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.282500316818
                                         uncertainty =       0.001923822208

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.282500316818
                                         uncertainty =       0.001923822208

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000375841927
  error estimate for blocks of size 2^( 2) =       0.000393097788
  error estimate for blocks of size 2^( 3) =       0.000410396367
  error estimate for blocks of size 2^( 4) =       0.000425292967
  error estimate for blocks of size 2^( 5) =       0.000436592888
  error estimate for blocks of size 2^( 6) =       0.000443357626
  error estimate for blocks of size 2^( 7) =       0.000446523884

      target function =      -0.907472459766
              le_mean =     -16.898947778549
             les_mean =     285.877779078808
             stat err =       0.000437941841
             autocorr =       1.357758177517
   target nu stat err =       0.000437941841
   target dn stat err =       0.011029584398
      target stat err =       0.016687139663
              std dev =       0.531520750717
             le_variance =       0.282514308442


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.689894777855e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 74
Check correct_vf_var_size: 225, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 3.8147e+02, overlap shift 3.8147e+03 and omega -1.7444e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.907776639824       residual = 1.18e-01           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.907777935894       residual = 6.06e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.907777986961       residual = 4.88e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.907777995674       residual = 3.22e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.907778001433       residual = 9.85e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.907778006937       residual = 1.78e-04           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.907778013342       residual = 1.85e-04           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.907778015634       residual = 1.12e-04           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.907778017873       residual = 6.79e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.907778020039       residual = 2.10e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.907778020354       residual = 7.77e-06           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.907778020267       residual = 3.65e-06           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.907778020157       residual = 1.08e-06           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.907778020147       residual = 3.52e-07           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.907778020155       residual = 4.90e-08           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.907778020163       residual = 2.63e-08           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.907778020162       residual = 9.77e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         16 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 3.8147e+02 is 2.757676e-06

solving harmonic davidson linear method for identity shift 1.5259e+03, overlap shift 1.5259e+04 and omega -1.7444e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.907776639824       residual = 1.18e-01           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.907776963892       residual = 6.06e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.907776976660       residual = 4.88e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.907776978838       residual = 3.22e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.907776980281       residual = 9.85e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.907776981656       residual = 1.78e-04           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.907776983255       residual = 1.85e-04           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.907776983828       residual = 1.12e-04           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.907776984387       residual = 6.79e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.907776984934       residual = 2.10e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.907776985008       residual = 7.77e-06           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.907776984987       residual = 3.65e-06           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.907776984962       residual = 1.08e-06           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.907776984955       residual = 3.52e-07           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.907776984962       residual = 4.90e-08           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.907776984962       residual = 2.62e-08           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.907776984957       residual = 9.77e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         16 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 1.5259e+03 is 6.895294e-07

solving harmonic davidson linear method for identity shift 6.1035e+03, overlap shift 6.1035e+04 and omega -1.7444e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.907776639824       residual = 1.18e-01           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.907776720844       residual = 6.06e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.907776724036       residual = 4.88e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.907776724581       residual = 3.22e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.907776724941       residual = 9.85e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.907776725285       residual = 1.78e-04           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.907776725685       residual = 1.84e-04           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.907776725828       residual = 1.12e-04           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.907776725974       residual = 6.79e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.907776726104       residual = 2.10e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.907776726123       residual = 7.76e-06           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.907776726122       residual = 3.64e-06           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.907776726135       residual = 1.08e-06           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.907776726108       residual = 3.52e-07           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.907776726109       residual = 4.90e-08           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.907776726121       residual = 2.62e-08           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.907776726109       residual = 9.76e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         16 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 6.1035e+03 is 1.723892e-07

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.421797 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 75 and numParams is: 74

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.6964e+01
  </log>
  <optVariables href="H2O.s029.opt.xml">
ci_0001                 7.087012e-01 3 1  ON 0
ci_0002                 6.926406e-01 3 1  ON 1
ci_0003                -3.103995e-02 3 1  ON 2
ci_0004                -3.012724e-02 3 1  ON 3
ci_0005                -3.071705e-02 3 1  ON 4
ci_0006                -3.067466e-02 3 1  ON 5
ci_0007                -1.345435e-02 3 1  ON 6
ci_0008                -1.342298e-02 3 1  ON 7
ci_0009                -1.873612e-02 3 1  ON 8
ci_0010                -1.811553e-02 3 1  ON 9
ci_0011                -1.475275e-02 3 1  ON 10
ci_0012                -1.455310e-02 3 1  ON 11
ci_0013                 1.532197e-02 3 1  ON 12
ci_0014                 1.481780e-02 3 1  ON 13
ci_0015                 1.581966e-02 3 1  ON 14
ci_0016                 1.539837e-02 3 1  ON 15
ci_0017                 1.336664e-02 3 1  ON 16
ci_0018                 1.306115e-02 3 1  ON 17
ci_0019                 1.310077e-02 3 1  ON 18
ci_0020                 1.266803e-02 3 1  ON 19
ci_0021                 6.903167e-03 3 1  ON 20
ci_0022                 7.654756e-03 3 1  ON 21
ci_0023                -1.178469e-02 3 1  ON 22
ci_0024                -1.143602e-02 3 1  ON 23
ci_0025                -2.125093e-03 3 1  ON 24
ci_0026                -2.504837e-03 3 1  ON 25
ci_0027                -1.210066e-02 3 1  ON 26
ci_0028                -1.154901e-02 3 1  ON 27
ci_0029                -1.065906e-02 3 1  ON 28
ci_0030                -1.054845e-02 3 1  ON 29
ci_0031                 1.342808e-02 3 1  ON 30
ci_0032                 1.206593e-02 3 1  ON 31
ci_0033                 7.741616e-03 3 1  ON 32
ci_0034                 8.463738e-03 3 1  ON 33
ci_0035                 4.844881e-03 3 1  ON 34
ci_0036                 4.895046e-03 3 1  ON 35
ci_0037                -1.129974e-02 3 1  ON 36
ci_0038                -1.136502e-02 3 1  ON 37
ci_0039                -4.014034e-03 3 1  ON 38
ci_0040                -3.907008e-03 3 1  ON 39
ci_0041                 9.081610e-03 3 1  ON 40
ci_0042                 8.729756e-03 3 1  ON 41
ci_0043                -1.292357e-02 3 1  ON 42
ci_0044                -1.374856e-02 3 1  ON 43
ci_0045                 1.064485e-02 3 1  ON 44
ci_0046                 1.007160e-02 3 1  ON 45
ci_0047                -3.593831e-03 3 1  ON 46
ci_0048                -3.467321e-03 3 1  ON 47
ci_0049                -2.578341e-03 3 1  ON 48
ci_0050                -2.679986e-03 3 1  ON 49
ci_0051                -1.745562e-03 3 1  ON 50
ci_0052                -2.046988e-03 3 1  ON 51
ci_0053                -3.951576e-03 3 1  ON 52
ci_0054                -3.298142e-03 3 1  ON 53
ci_0055                 2.490918e-03 3 1  ON 54
ci_0056                 2.208408e-03 3 1  ON 55
ci_0057                 2.431538e-03 3 1  ON 56
ci_0058                 2.894192e-03 3 1  ON 57
ci_0059                -3.411716e-03 3 1  ON 58
ci_0060                -3.352284e-03 3 1  ON 59
ci_0061                -4.010156e-03 3 1  ON 60
ci_0062                -3.945929e-03 3 1  ON 61
ci_0063                -9.791165e-03 3 1  ON 62
ci_0064                -9.361974e-03 3 1  ON 63
ci_0065                -6.441879e-03 3 1  ON 64
ci_0066                -6.110466e-03 3 1  ON 65
ci_0067                -3.745681e-03 3 1  ON 66
ci_0068                -3.444361e-03 3 1  ON 67
ci_0069                 3.627701e-03 3 1  ON 68
ci_0070                 3.335533e-03 3 1  ON 69
ci_0071                 2.956250e-03 3 1  ON 70
ci_0072                 3.497539e-03 3 1  ON 71
ci_0073                 3.527771e-03 3 1  ON 72
ci_0074                 3.549816e-03 3 1  ON 73
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 29
    time step          = 0.05
    reference energy   = -16.9291
    reference variance = 0.488313
====================================================
  Execution time = 1.3937e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s029
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6899e+01
  VMC Evar = 2.8993e-01
  Total weights = 1.9511e+06
  Execution time = 1.8759e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.281049545088
                                         uncertainty =       0.001699588444

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.281049545088
                                         uncertainty =       0.001699588444

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000374864884
  error estimate for blocks of size 2^( 2) =       0.000391995776
  error estimate for blocks of size 2^( 3) =       0.000409267297
  error estimate for blocks of size 2^( 4) =       0.000424505425
  error estimate for blocks of size 2^( 5) =       0.000437029538
  error estimate for blocks of size 2^( 6) =       0.000443779800
  error estimate for blocks of size 2^( 7) =       0.000448712868

      target function =      -0.928512230724
              le_mean =     -16.898730014722
             les_mean =     285.857001579575
             stat err =       0.000438506908
             autocorr =       1.368369416282
   target nu stat err =       0.000438506908
   target dn stat err =       0.002101797952
      target stat err =       0.003406345017
              std dev =       0.530139003546
             le_variance =       0.281047363081

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.281049480898
                                         uncertainty =       0.001699573794

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.281049480898
                                         uncertainty =       0.001699573794

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000374864842
  error estimate for blocks of size 2^( 2) =       0.000391995758
  error estimate for blocks of size 2^( 3) =       0.000409267305
  error estimate for blocks of size 2^( 4) =       0.000424505454
  error estimate for blocks of size 2^( 5) =       0.000437029573
  error estimate for blocks of size 2^( 6) =       0.000443779810
  error estimate for blocks of size 2^( 7) =       0.000448712860

      target function =      -0.928512372693
              le_mean =     -16.898730022684
             les_mean =     285.857001758706
             stat err =       0.000438506924
             autocorr =       1.368369825565
   target nu stat err =       0.000438506924
   target dn stat err =       0.002101843384
      target stat err =       0.003406416184
              std dev =       0.530138944101
             le_variance =       0.281047300052

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.281049512944
                                         uncertainty =       0.001699581116

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.281049512944
                                         uncertainty =       0.001699581116

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000374864863
  error estimate for blocks of size 2^( 2) =       0.000391995767
  error estimate for blocks of size 2^( 3) =       0.000409267301
  error estimate for blocks of size 2^( 4) =       0.000424505440
  error estimate for blocks of size 2^( 5) =       0.000437029555
  error estimate for blocks of size 2^( 6) =       0.000443779805
  error estimate for blocks of size 2^( 7) =       0.000448712864

      target function =      -0.928512317182
              le_mean =     -16.898730018699
             les_mean =     285.857001659216
             stat err =       0.000438506916
             autocorr =       1.368369621017
   target nu stat err =       0.000438506916
   target dn stat err =       0.002101820521
      target stat err =       0.003406380485
              std dev =       0.530138973778
             le_variance =       0.281047331518

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.281049541065
                                         uncertainty =       0.001699587528

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.281049541065
                                         uncertainty =       0.001699587528

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000374864882
  error estimate for blocks of size 2^( 2) =       0.000391995775
  error estimate for blocks of size 2^( 3) =       0.000409267298
  error estimate for blocks of size 2^( 4) =       0.000424505427
  error estimate for blocks of size 2^( 5) =       0.000437029540
  error estimate for blocks of size 2^( 6) =       0.000443779801
  error estimate for blocks of size 2^( 7) =       0.000448712867

      target function =      -0.928512243184
              le_mean =     -16.898730015218
             les_mean =     285.857001588468
             stat err =       0.000438506909
             autocorr =       1.368369441873
   target nu stat err =       0.000438506909
   target dn stat err =       0.002101800757
      target stat err =       0.003406349438
              std dev =       0.530138999820
             le_variance =       0.281047359131


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.928512230724        initial
     3.8147e+02     3.8147e+03             2.7577e-06        -0.928512372693  <--
     1.5259e+03     1.5259e+04             6.8953e-07        -0.928512317182
     6.1035e+03     6.1035e+04             1.7239e-07        -0.928512243184

*****************************************************************************
Applying the update for shift_i =   3.8147e+02     and shift_s =   3.8147e+03
*****************************************************************************

  Execution time = 2.3419e+01
  </log>
  <optVariables href="H2O.s029.opt.xml">
ci_0001                 7.087025e-01 3 1  ON 0
ci_0002                 6.926394e-01 3 1  ON 1
ci_0003                -3.103994e-02 3 1  ON 2
ci_0004                -3.012719e-02 3 1  ON 3
ci_0005                -3.071718e-02 3 1  ON 4
ci_0006                -3.067461e-02 3 1  ON 5
ci_0007                -1.345420e-02 3 1  ON 6
ci_0008                -1.342290e-02 3 1  ON 7
ci_0009                -1.873606e-02 3 1  ON 8
ci_0010                -1.811541e-02 3 1  ON 9
ci_0011                -1.475270e-02 3 1  ON 10
ci_0012                -1.455293e-02 3 1  ON 11
ci_0013                 1.532191e-02 3 1  ON 12
ci_0014                 1.481825e-02 3 1  ON 13
ci_0015                 1.581985e-02 3 1  ON 14
ci_0016                 1.539839e-02 3 1  ON 15
ci_0017                 1.336672e-02 3 1  ON 16
ci_0018                 1.306116e-02 3 1  ON 17
ci_0019                 1.310071e-02 3 1  ON 18
ci_0020                 1.266806e-02 3 1  ON 19
ci_0021                 6.903150e-03 3 1  ON 20
ci_0022                 7.654845e-03 3 1  ON 21
ci_0023                -1.178468e-02 3 1  ON 22
ci_0024                -1.143597e-02 3 1  ON 23
ci_0025                -2.125249e-03 3 1  ON 24
ci_0026                -2.504787e-03 3 1  ON 25
ci_0027                -1.210081e-02 3 1  ON 26
ci_0028                -1.154916e-02 3 1  ON 27
ci_0029                -1.065900e-02 3 1  ON 28
ci_0030                -1.054834e-02 3 1  ON 29
ci_0031                 1.342808e-02 3 1  ON 30
ci_0032                 1.206597e-02 3 1  ON 31
ci_0033                 7.741644e-03 3 1  ON 32
ci_0034                 8.463632e-03 3 1  ON 33
ci_0035                 4.845052e-03 3 1  ON 34
ci_0036                 4.892978e-03 3 1  ON 35
ci_0037                -1.129973e-02 3 1  ON 36
ci_0038                -1.136500e-02 3 1  ON 37
ci_0039                -4.014015e-03 3 1  ON 38
ci_0040                -3.907016e-03 3 1  ON 39
ci_0041                 9.081651e-03 3 1  ON 40
ci_0042                 8.729848e-03 3 1  ON 41
ci_0043                -1.292350e-02 3 1  ON 42
ci_0044                -1.374866e-02 3 1  ON 43
ci_0045                 1.064482e-02 3 1  ON 44
ci_0046                 1.007188e-02 3 1  ON 45
ci_0047                -3.593804e-03 3 1  ON 46
ci_0048                -3.467341e-03 3 1  ON 47
ci_0049                -2.578258e-03 3 1  ON 48
ci_0050                -2.679961e-03 3 1  ON 49
ci_0051                -1.745574e-03 3 1  ON 50
ci_0052                -2.046864e-03 3 1  ON 51
ci_0053                -3.951458e-03 3 1  ON 52
ci_0054                -3.298013e-03 3 1  ON 53
ci_0055                 2.490270e-03 3 1  ON 54
ci_0056                 2.208390e-03 3 1  ON 55
ci_0057                 2.431624e-03 3 1  ON 56
ci_0058                 2.894291e-03 3 1  ON 57
ci_0059                -3.411732e-03 3 1  ON 58
ci_0060                -3.352323e-03 3 1  ON 59
ci_0061                -4.010079e-03 3 1  ON 60
ci_0062                -3.945664e-03 3 1  ON 61
ci_0063                -9.791179e-03 3 1  ON 62
ci_0064                -9.361918e-03 3 1  ON 63
ci_0065                -6.442027e-03 3 1  ON 64
ci_0066                -6.110458e-03 3 1  ON 65
ci_0067                -3.745629e-03 3 1  ON 66
ci_0068                -3.444189e-03 3 1  ON 67
ci_0069                 3.627472e-03 3 1  ON 68
ci_0070                 3.335246e-03 3 1  ON 69
ci_0071                 2.956119e-03 3 1  ON 70
ci_0072                 3.497481e-03 3 1  ON 71
ci_0073                 3.527726e-03 3 1  ON 72
ci_0074                 3.549688e-03 3 1  ON 73
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 4.0390e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s030 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s030 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=30  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6905e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 30
    time step          = 0.05
    reference energy   = -16.8669
    reference variance = 0.230959
====================================================
  Execution time = 1.4168e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s030
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5239e+04
  VMC Eavg = -1.6900e+01
  VMC Evar = 2.9699e-01
  Total weights = 1.951199260e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 2.5568e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.285580416957
                                         uncertainty =       0.002925272973

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.285580416957
                                         uncertainty =       0.002925272973

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000377870597
  error estimate for blocks of size 2^( 2) =       0.000395003351
  error estimate for blocks of size 2^( 3) =       0.000412177853
  error estimate for blocks of size 2^( 4) =       0.000426949866
  error estimate for blocks of size 2^( 5) =       0.000438048075
  error estimate for blocks of size 2^( 6) =       0.000444802817
  error estimate for blocks of size 2^( 7) =       0.000448688721

      target function =      -0.917452173573
              le_mean =     -16.899513832907
             les_mean =     285.890552863135
             stat err =       0.000439622370
             autocorr =       1.353547076529
   target nu stat err =       0.000439622370
   target dn stat err =       0.003978332865
      target stat err =       0.006195279851
              std dev =       0.534389723633
             le_variance =       0.285572376724


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.689951383291e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 74
Check correct_vf_var_size: 225, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 9.5367e+01, overlap shift 9.5367e+02 and omega -1.7444e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.917492429210       residual = 3.87e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.917493828228       residual = 2.52e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.917493931919       residual = 6.26e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.917493974034       residual = 2.68e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.917493990658       residual = 1.31e-04           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.917494004578       residual = 1.09e-04           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.917494014838       residual = 1.05e-04           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.917494022601       residual = 5.61e-05           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.917494026913       residual = 6.30e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.917494031860       residual = 3.87e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.917494033998       residual = 9.99e-06           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.917494034578       residual = 5.49e-06           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.917494035650       residual = 1.56e-06           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.917494036081       residual = 3.69e-07           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.917494036272       residual = 1.56e-07           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.917494036203       residual = 4.42e-08           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.917494036220       residual = 1.42e-08           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.917494036232       residual = 3.83e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         17 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 9.5367e+01 is 5.312588e-06

solving harmonic davidson linear method for identity shift 3.8147e+02, overlap shift 3.8147e+03 and omega -1.7444e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.917492429210       residual = 3.87e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.917492779188       residual = 2.52e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.917492805124       residual = 6.26e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.917492815657       residual = 2.68e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.917492819814       residual = 1.31e-04           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.917492823295       residual = 1.09e-04           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.917492825859       residual = 1.05e-04           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.917492827800       residual = 5.61e-05           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.917492828879       residual = 6.30e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.917492830113       residual = 3.86e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.917492830648       residual = 9.97e-06           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.917492830791       residual = 5.48e-06           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.917492831061       residual = 1.56e-06           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.917492831167       residual = 3.68e-07           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.917492831215       residual = 1.56e-07           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.917492831198       residual = 4.40e-08           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.917492831203       residual = 1.42e-08           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.917492831206       residual = 3.81e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         17 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 3.8147e+02 is 1.328166e-06

solving harmonic davidson linear method for identity shift 1.5259e+03, overlap shift 1.5259e+04 and omega -1.7444e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.917492429210       residual = 3.87e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.917492516719       residual = 2.52e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.917492523204       residual = 6.25e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.917492525837       residual = 2.68e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.917492526878       residual = 1.31e-04           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.917492527746       residual = 1.09e-04           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.917492528389       residual = 1.05e-04           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.917492528874       residual = 5.61e-05           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.917492529140       residual = 6.30e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.917492529450       residual = 3.86e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.917492529583       residual = 9.97e-06           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.917492529621       residual = 5.48e-06           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.917492529687       residual = 1.56e-06           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.917492529713       residual = 3.67e-07           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.917492529729       residual = 1.55e-07           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.917492529723       residual = 4.40e-08           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.917492529726       residual = 1.42e-08           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.917492529723       residual = 3.81e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         17 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 1.5259e+03 is 3.320427e-07

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.431931 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 75 and numParams is: 74

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.6740e+01
  </log>
  <optVariables href="H2O.s030.opt.xml">
ci_0001                 7.087012e-01 3 1  ON 0
ci_0002                 6.926407e-01 3 1  ON 1
ci_0003                -3.103986e-02 3 1  ON 2
ci_0004                -3.012725e-02 3 1  ON 3
ci_0005                -3.071705e-02 3 1  ON 4
ci_0006                -3.067437e-02 3 1  ON 5
ci_0007                -1.345410e-02 3 1  ON 6
ci_0008                -1.342283e-02 3 1  ON 7
ci_0009                -1.873596e-02 3 1  ON 8
ci_0010                -1.811551e-02 3 1  ON 9
ci_0011                -1.475270e-02 3 1  ON 10
ci_0012                -1.455296e-02 3 1  ON 11
ci_0013                 1.532186e-02 3 1  ON 12
ci_0014                 1.481811e-02 3 1  ON 13
ci_0015                 1.581961e-02 3 1  ON 14
ci_0016                 1.539839e-02 3 1  ON 15
ci_0017                 1.336652e-02 3 1  ON 16
ci_0018                 1.306124e-02 3 1  ON 17
ci_0019                 1.310074e-02 3 1  ON 18
ci_0020                 1.266781e-02 3 1  ON 19
ci_0021                 6.903281e-03 3 1  ON 20
ci_0022                 7.654874e-03 3 1  ON 21
ci_0023                -1.178483e-02 3 1  ON 22
ci_0024                -1.143607e-02 3 1  ON 23
ci_0025                -2.125230e-03 3 1  ON 24
ci_0026                -2.505112e-03 3 1  ON 25
ci_0027                -1.210074e-02 3 1  ON 26
ci_0028                -1.154926e-02 3 1  ON 27
ci_0029                -1.065922e-02 3 1  ON 28
ci_0030                -1.054841e-02 3 1  ON 29
ci_0031                 1.342819e-02 3 1  ON 30
ci_0032                 1.206630e-02 3 1  ON 31
ci_0033                 7.741676e-03 3 1  ON 32
ci_0034                 8.463775e-03 3 1  ON 33
ci_0035                 4.844497e-03 3 1  ON 34
ci_0036                 4.892760e-03 3 1  ON 35
ci_0037                -1.129977e-02 3 1  ON 36
ci_0038                -1.136495e-02 3 1  ON 37
ci_0039                -4.013968e-03 3 1  ON 38
ci_0040                -3.907082e-03 3 1  ON 39
ci_0041                 9.081888e-03 3 1  ON 40
ci_0042                 8.730007e-03 3 1  ON 41
ci_0043                -1.292363e-02 3 1  ON 42
ci_0044                -1.374921e-02 3 1  ON 43
ci_0045                 1.064498e-02 3 1  ON 44
ci_0046                 1.007202e-02 3 1  ON 45
ci_0047                -3.593797e-03 3 1  ON 46
ci_0048                -3.467374e-03 3 1  ON 47
ci_0049                -2.577384e-03 3 1  ON 48
ci_0050                -2.680051e-03 3 1  ON 49
ci_0051                -1.745843e-03 3 1  ON 50
ci_0052                -2.046753e-03 3 1  ON 51
ci_0053                -3.951598e-03 3 1  ON 52
ci_0054                -3.298240e-03 3 1  ON 53
ci_0055                 2.490263e-03 3 1  ON 54
ci_0056                 2.207929e-03 3 1  ON 55
ci_0057                 2.431642e-03 3 1  ON 56
ci_0058                 2.894417e-03 3 1  ON 57
ci_0059                -3.411841e-03 3 1  ON 58
ci_0060                -3.352413e-03 3 1  ON 59
ci_0061                -4.010084e-03 3 1  ON 60
ci_0062                -3.945752e-03 3 1  ON 61
ci_0063                -9.791001e-03 3 1  ON 62
ci_0064                -9.361956e-03 3 1  ON 63
ci_0065                -6.442023e-03 3 1  ON 64
ci_0066                -6.110522e-03 3 1  ON 65
ci_0067                -3.745913e-03 3 1  ON 66
ci_0068                -3.444307e-03 3 1  ON 67
ci_0069                 3.627261e-03 3 1  ON 68
ci_0070                 3.335417e-03 3 1  ON 69
ci_0071                 2.956466e-03 3 1  ON 70
ci_0072                 3.497690e-03 3 1  ON 71
ci_0073                 3.527745e-03 3 1  ON 72
ci_0074                 3.549522e-03 3 1  ON 73
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 30
    time step          = 0.05
    reference energy   = -16.8879
    reference variance = 0.311832
====================================================
  Execution time = 1.3901e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s030
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6898e+01
  VMC Evar = 2.9584e-01
  Total weights = 1.9511e+06
  Execution time = 1.8686e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.283117767200
                                         uncertainty =       0.001917527340

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.283117767200
                                         uncertainty =       0.001917527340

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000376266284
  error estimate for blocks of size 2^( 2) =       0.000393284270
  error estimate for blocks of size 2^( 3) =       0.000411202533
  error estimate for blocks of size 2^( 4) =       0.000426685157
  error estimate for blocks of size 2^( 5) =       0.000436655907
  error estimate for blocks of size 2^( 6) =       0.000443713454
  error estimate for blocks of size 2^( 7) =       0.000448409145

      target function =      -0.919238196476
              le_mean =     -16.898192060899
             les_mean =     285.844738223956
             stat err =       0.000438865916
             autocorr =       1.360420280761
   target nu stat err =       0.000438865916
   target dn stat err =       0.002694066573
      target stat err =       0.004236241514
              std dev =       0.532120881487
             le_variance =       0.283152632514

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.283117675152
                                         uncertainty =       0.001917564260

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.283117675152
                                         uncertainty =       0.001917564260

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000376266218
  error estimate for blocks of size 2^( 2) =       0.000393284218
  error estimate for blocks of size 2^( 3) =       0.000411202469
  error estimate for blocks of size 2^( 4) =       0.000426685074
  error estimate for blocks of size 2^( 5) =       0.000436655800
  error estimate for blocks of size 2^( 6) =       0.000443713346
  error estimate for blocks of size 2^( 7) =       0.000448409030

      target function =      -0.919238449365
              le_mean =     -16.898192010423
             les_mean =     285.844736350842
             stat err =       0.000438865813
             autocorr =       1.360420117344
   target nu stat err =       0.000438865813
   target dn stat err =       0.002694460581
      target stat err =       0.004236844102
              std dev =       0.532120788431
             le_variance =       0.283152533480

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.283117720885
                                         uncertainty =       0.001917545808

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.283117720885
                                         uncertainty =       0.001917545808

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000376266251
  error estimate for blocks of size 2^( 2) =       0.000393284244
  error estimate for blocks of size 2^( 3) =       0.000411202501
  error estimate for blocks of size 2^( 4) =       0.000426685115
  error estimate for blocks of size 2^( 5) =       0.000436655853
  error estimate for blocks of size 2^( 6) =       0.000443713400
  error estimate for blocks of size 2^( 7) =       0.000448409087

      target function =      -0.919238489415
              le_mean =     -16.898192035625
             les_mean =     285.844737178871
             stat err =       0.000438865864
             autocorr =       1.360420199325
   target nu stat err =       0.000438865864
   target dn stat err =       0.002694239868
      target stat err =       0.004236508172
              std dev =       0.532120834684
             le_variance =       0.283152582705

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.283117761381
                                         uncertainty =       0.001917529648

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.283117761381
                                         uncertainty =       0.001917529648

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000376266280
  error estimate for blocks of size 2^( 2) =       0.000393284266
  error estimate for blocks of size 2^( 3) =       0.000411202529
  error estimate for blocks of size 2^( 4) =       0.000426685151
  error estimate for blocks of size 2^( 5) =       0.000436655900
  error estimate for blocks of size 2^( 6) =       0.000443713448
  error estimate for blocks of size 2^( 7) =       0.000448409138

      target function =      -0.919238251350
              le_mean =     -16.898192057737
             les_mean =     285.844738081455
             stat err =       0.000438865909
             autocorr =       1.360420270596
   target nu stat err =       0.000438865909
   target dn stat err =       0.002694085586
      target stat err =       0.004236270973
              std dev =       0.532120875609
             le_variance =       0.283152626259


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.919238196476        initial
     9.5367e+01     9.5367e+02             5.3126e-06        -0.919238449365
     3.8147e+02     3.8147e+03             1.3282e-06        -0.919238489415  <--
     1.5259e+03     1.5259e+04             3.3204e-07        -0.919238251350

*****************************************************************************
Applying the update for shift_i =   3.8147e+02     and shift_s =   3.8147e+03
*****************************************************************************

  Execution time = 2.3353e+01
  </log>
  <optVariables href="H2O.s030.opt.xml">
ci_0001                 7.087012e-01 3 1  ON 0
ci_0002                 6.926407e-01 3 1  ON 1
ci_0003                -3.103986e-02 3 1  ON 2
ci_0004                -3.012725e-02 3 1  ON 3
ci_0005                -3.071705e-02 3 1  ON 4
ci_0006                -3.067437e-02 3 1  ON 5
ci_0007                -1.345410e-02 3 1  ON 6
ci_0008                -1.342283e-02 3 1  ON 7
ci_0009                -1.873596e-02 3 1  ON 8
ci_0010                -1.811551e-02 3 1  ON 9
ci_0011                -1.475270e-02 3 1  ON 10
ci_0012                -1.455296e-02 3 1  ON 11
ci_0013                 1.532186e-02 3 1  ON 12
ci_0014                 1.481811e-02 3 1  ON 13
ci_0015                 1.581961e-02 3 1  ON 14
ci_0016                 1.539839e-02 3 1  ON 15
ci_0017                 1.336652e-02 3 1  ON 16
ci_0018                 1.306124e-02 3 1  ON 17
ci_0019                 1.310074e-02 3 1  ON 18
ci_0020                 1.266781e-02 3 1  ON 19
ci_0021                 6.903281e-03 3 1  ON 20
ci_0022                 7.654874e-03 3 1  ON 21
ci_0023                -1.178483e-02 3 1  ON 22
ci_0024                -1.143607e-02 3 1  ON 23
ci_0025                -2.125230e-03 3 1  ON 24
ci_0026                -2.505112e-03 3 1  ON 25
ci_0027                -1.210074e-02 3 1  ON 26
ci_0028                -1.154926e-02 3 1  ON 27
ci_0029                -1.065922e-02 3 1  ON 28
ci_0030                -1.054841e-02 3 1  ON 29
ci_0031                 1.342819e-02 3 1  ON 30
ci_0032                 1.206630e-02 3 1  ON 31
ci_0033                 7.741676e-03 3 1  ON 32
ci_0034                 8.463775e-03 3 1  ON 33
ci_0035                 4.844497e-03 3 1  ON 34
ci_0036                 4.892760e-03 3 1  ON 35
ci_0037                -1.129977e-02 3 1  ON 36
ci_0038                -1.136495e-02 3 1  ON 37
ci_0039                -4.013968e-03 3 1  ON 38
ci_0040                -3.907082e-03 3 1  ON 39
ci_0041                 9.081888e-03 3 1  ON 40
ci_0042                 8.730007e-03 3 1  ON 41
ci_0043                -1.292363e-02 3 1  ON 42
ci_0044                -1.374921e-02 3 1  ON 43
ci_0045                 1.064498e-02 3 1  ON 44
ci_0046                 1.007202e-02 3 1  ON 45
ci_0047                -3.593797e-03 3 1  ON 46
ci_0048                -3.467374e-03 3 1  ON 47
ci_0049                -2.577384e-03 3 1  ON 48
ci_0050                -2.680051e-03 3 1  ON 49
ci_0051                -1.745843e-03 3 1  ON 50
ci_0052                -2.046753e-03 3 1  ON 51
ci_0053                -3.951598e-03 3 1  ON 52
ci_0054                -3.298240e-03 3 1  ON 53
ci_0055                 2.490263e-03 3 1  ON 54
ci_0056                 2.207929e-03 3 1  ON 55
ci_0057                 2.431642e-03 3 1  ON 56
ci_0058                 2.894417e-03 3 1  ON 57
ci_0059                -3.411841e-03 3 1  ON 58
ci_0060                -3.352413e-03 3 1  ON 59
ci_0061                -4.010084e-03 3 1  ON 60
ci_0062                -3.945752e-03 3 1  ON 61
ci_0063                -9.791001e-03 3 1  ON 62
ci_0064                -9.361956e-03 3 1  ON 63
ci_0065                -6.442023e-03 3 1  ON 64
ci_0066                -6.110522e-03 3 1  ON 65
ci_0067                -3.745913e-03 3 1  ON 66
ci_0068                -3.444307e-03 3 1  ON 67
ci_0069                 3.627261e-03 3 1  ON 68
ci_0070                 3.335417e-03 3 1  ON 69
ci_0071                 2.956466e-03 3 1  ON 70
ci_0072                 3.497690e-03 3 1  ON 71
ci_0073                 3.527745e-03 3 1  ON 72
ci_0074                 3.549522e-03 3 1  ON 73
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 4.0109e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s031 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s031 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=31  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6905e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 31
    time step          = 0.05
    reference energy   = -16.8544
    reference variance = 0.233346
====================================================
  Execution time = 1.4142e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s031
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5237e+04
  VMC Eavg = -1.6899e+01
  VMC Evar = 2.9120e-01
  Total weights = 1.950924703e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 2.6339e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.281532801797
                                         uncertainty =       0.001628872626

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.281532801797
                                         uncertainty =       0.001628872626

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000375157064
  error estimate for blocks of size 2^( 2) =       0.000392314958
  error estimate for blocks of size 2^( 3) =       0.000409746927
  error estimate for blocks of size 2^( 4) =       0.000425915820
  error estimate for blocks of size 2^( 5) =       0.000437414203
  error estimate for blocks of size 2^( 6) =       0.000444897537
  error estimate for blocks of size 2^( 7) =       0.000449773343

      target function =      -0.926512265205
              le_mean =     -16.899449925790
             les_mean =     285.882608056390
             stat err =       0.000439500226
             autocorr =       1.372435519056
   target nu stat err =       0.000439500226
   target dn stat err =       0.002131736401
      target stat err =       0.003442953291
              std dev =       0.530552207355
             le_variance =       0.281485644730


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.689944992579e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 74
Check correct_vf_var_size: 225, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 9.5367e+01, overlap shift 9.5367e+02 and omega -1.7444e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.926523694640       residual = 6.43e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.926524021320       residual = 8.35e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.926524061869       residual = 3.24e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.926524076929       residual = 1.78e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.926524088918       residual = 4.73e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.926524092289       residual = 1.80e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.926524092863       residual = 2.75e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.926524092683       residual = 1.24e-06           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.926524091957       residual = 4.87e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.926524092001       residual = 1.31e-07           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.926524092003       residual = 6.84e-08           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.926524091995       residual = 2.61e-08           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.926524091984       residual = 2.14e-08           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.926524092041       residual = 1.44e-08           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.926524091986       residual = 1.40e-08           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.926524091967       residual = 1.32e-08           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.926524091939       residual = 3.01e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         16 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 9.5367e+01 is 2.666883e-06

solving harmonic davidson linear method for identity shift 3.8147e+02, overlap shift 3.8147e+03 and omega -1.7444e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.926523694640       residual = 6.43e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.926523776360       residual = 8.34e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.926523786502       residual = 3.24e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.926523790268       residual = 1.78e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.926523793265       residual = 4.72e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.926523794108       residual = 1.80e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.926523794251       residual = 2.75e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.926523794206       residual = 1.24e-06           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.926523794024       residual = 4.87e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.926523794036       residual = 1.30e-07           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.926523794037       residual = 6.83e-08           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.926523794034       residual = 2.61e-08           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.926523794031       residual = 2.14e-08           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.926523794046       residual = 1.44e-08           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.926523794032       residual = 1.40e-08           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.926523794026       residual = 1.32e-08           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.926523794021       residual = 3.00e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         16 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 3.8147e+02 is 6.669408e-07

solving harmonic davidson linear method for identity shift 1.5259e+03, overlap shift 1.5259e+04 and omega -1.7444e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.926523694640       residual = 6.43e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.926523715073       residual = 8.34e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.926523717609       residual = 3.24e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.926523718550       residual = 1.78e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.926523719300       residual = 4.72e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.926523719511       residual = 1.80e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.926523719544       residual = 2.75e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.926523719532       residual = 1.24e-06           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.926523719491       residual = 4.87e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.926523719490       residual = 1.30e-07           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.926523719491       residual = 6.83e-08           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.926523719494       residual = 2.61e-08           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.926523719494       residual = 2.14e-08           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.926523719497       residual = 1.44e-08           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.926523719492       residual = 1.40e-08           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.926523719489       residual = 1.32e-08           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.926523719487       residual = 3.00e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         16 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 1.5259e+03 is 1.667490e-07

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.441070 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 75 and numParams is: 74

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.6791e+01
  </log>
  <optVariables href="H2O.s031.opt.xml">
ci_0001                 7.087011e-01 3 1  ON 0
ci_0002                 6.926407e-01 3 1  ON 1
ci_0003                -3.103987e-02 3 1  ON 2
ci_0004                -3.012718e-02 3 1  ON 3
ci_0005                -3.071695e-02 3 1  ON 4
ci_0006                -3.067432e-02 3 1  ON 5
ci_0007                -1.345407e-02 3 1  ON 6
ci_0008                -1.342286e-02 3 1  ON 7
ci_0009                -1.873596e-02 3 1  ON 8
ci_0010                -1.811542e-02 3 1  ON 9
ci_0011                -1.475262e-02 3 1  ON 10
ci_0012                -1.455290e-02 3 1  ON 11
ci_0013                 1.532181e-02 3 1  ON 12
ci_0014                 1.481814e-02 3 1  ON 13
ci_0015                 1.581949e-02 3 1  ON 14
ci_0016                 1.539844e-02 3 1  ON 15
ci_0017                 1.336639e-02 3 1  ON 16
ci_0018                 1.306141e-02 3 1  ON 17
ci_0019                 1.310084e-02 3 1  ON 18
ci_0020                 1.266782e-02 3 1  ON 19
ci_0021                 6.902899e-03 3 1  ON 20
ci_0022                 7.654660e-03 3 1  ON 21
ci_0023                -1.178500e-02 3 1  ON 22
ci_0024                -1.143602e-02 3 1  ON 23
ci_0025                -2.125142e-03 3 1  ON 24
ci_0026                -2.505103e-03 3 1  ON 25
ci_0027                -1.210082e-02 3 1  ON 26
ci_0028                -1.154920e-02 3 1  ON 27
ci_0029                -1.065924e-02 3 1  ON 28
ci_0030                -1.054853e-02 3 1  ON 29
ci_0031                 1.342804e-02 3 1  ON 30
ci_0032                 1.206616e-02 3 1  ON 31
ci_0033                 7.741831e-03 3 1  ON 32
ci_0034                 8.463682e-03 3 1  ON 33
ci_0035                 4.844390e-03 3 1  ON 34
ci_0036                 4.892755e-03 3 1  ON 35
ci_0037                -1.129975e-02 3 1  ON 36
ci_0038                -1.136503e-02 3 1  ON 37
ci_0039                -4.013950e-03 3 1  ON 38
ci_0040                -3.907112e-03 3 1  ON 39
ci_0041                 9.081780e-03 3 1  ON 40
ci_0042                 8.730093e-03 3 1  ON 41
ci_0043                -1.292385e-02 3 1  ON 42
ci_0044                -1.374988e-02 3 1  ON 43
ci_0045                 1.064513e-02 3 1  ON 44
ci_0046                 1.007212e-02 3 1  ON 45
ci_0047                -3.593795e-03 3 1  ON 46
ci_0048                -3.467278e-03 3 1  ON 47
ci_0049                -2.577863e-03 3 1  ON 48
ci_0050                -2.680064e-03 3 1  ON 49
ci_0051                -1.745779e-03 3 1  ON 50
ci_0052                -2.046739e-03 3 1  ON 51
ci_0053                -3.951491e-03 3 1  ON 52
ci_0054                -3.298370e-03 3 1  ON 53
ci_0055                 2.490322e-03 3 1  ON 54
ci_0056                 2.207965e-03 3 1  ON 55
ci_0057                 2.431567e-03 3 1  ON 56
ci_0058                 2.894488e-03 3 1  ON 57
ci_0059                -3.411753e-03 3 1  ON 58
ci_0060                -3.352467e-03 3 1  ON 59
ci_0061                -4.010056e-03 3 1  ON 60
ci_0062                -3.945764e-03 3 1  ON 61
ci_0063                -9.790969e-03 3 1  ON 62
ci_0064                -9.361985e-03 3 1  ON 63
ci_0065                -6.442242e-03 3 1  ON 64
ci_0066                -6.110432e-03 3 1  ON 65
ci_0067                -3.745896e-03 3 1  ON 66
ci_0068                -3.444316e-03 3 1  ON 67
ci_0069                 3.627061e-03 3 1  ON 68
ci_0070                 3.335398e-03 3 1  ON 69
ci_0071                 2.956849e-03 3 1  ON 70
ci_0072                 3.497708e-03 3 1  ON 71
ci_0073                 3.527800e-03 3 1  ON 72
ci_0074                 3.549536e-03 3 1  ON 73
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 31
    time step          = 0.05
    reference energy   = -16.9336
    reference variance = 0.301435
====================================================
  Execution time = 1.4104e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s031
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6898e+01
  VMC Evar = 2.9509e-01
  Total weights = 1.9509e+06
  Execution time = 1.8690e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.284740789790
                                         uncertainty =       0.002222747315

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.284740789790
                                         uncertainty =       0.002222747315

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000377291812
  error estimate for blocks of size 2^( 2) =       0.000394600365
  error estimate for blocks of size 2^( 3) =       0.000412306995
  error estimate for blocks of size 2^( 4) =       0.000428563716
  error estimate for blocks of size 2^( 5) =       0.000441472742
  error estimate for blocks of size 2^( 6) =       0.000451380061
  error estimate for blocks of size 2^( 7) =       0.000456613299

      target function =      -0.920396726171
              le_mean =     -16.898433880402
             les_mean =     285.852161238946
             stat err =       0.000444507454
             autocorr =       1.388044330539
   target nu stat err =       0.000444507454
   target dn stat err =       0.003065816413
      target stat err =       0.004819653761
              std dev =       0.533571197444
             le_variance =       0.284698222742

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.284740173849
                                         uncertainty =       0.002222614566

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.284740173849
                                         uncertainty =       0.002222614566

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000377291402
  error estimate for blocks of size 2^( 2) =       0.000394599944
  error estimate for blocks of size 2^( 3) =       0.000412306549
  error estimate for blocks of size 2^( 4) =       0.000428563246
  error estimate for blocks of size 2^( 5) =       0.000441472218
  error estimate for blocks of size 2^( 6) =       0.000451379453
  error estimate for blocks of size 2^( 7) =       0.000456612673

      target function =      -0.920402653122
              le_mean =     -16.898433891089
             les_mean =     285.852157788293
             stat err =       0.000444506898
             autocorr =       1.388043867890
   target nu stat err =       0.000444506898
   target dn stat err =       0.003065356711
      target stat err =       0.004819009804
              std dev =       0.533570618080
             le_variance =       0.284697604478

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.284740481581
                                         uncertainty =       0.002222680896

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.284740481581
                                         uncertainty =       0.002222680896

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000377291607
  error estimate for blocks of size 2^( 2) =       0.000394600155
  error estimate for blocks of size 2^( 3) =       0.000412306772
  error estimate for blocks of size 2^( 4) =       0.000428563480
  error estimate for blocks of size 2^( 5) =       0.000441472480
  error estimate for blocks of size 2^( 6) =       0.000451379757
  error estimate for blocks of size 2^( 7) =       0.000456612986

      target function =      -0.920399713815
              le_mean =     -16.898433885739
             les_mean =     285.852159497850
             stat err =       0.000444507176
             autocorr =       1.388044099259
   target nu stat err =       0.000444507176
   target dn stat err =       0.003065585492
      target stat err =       0.004819330394
              std dev =       0.533570907538
             le_variance =       0.284697913371

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.284740751250
                                         uncertainty =       0.002222739010

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.284740751250
                                         uncertainty =       0.002222739010

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000377291786
  error estimate for blocks of size 2^( 2) =       0.000394600339
  error estimate for blocks of size 2^( 3) =       0.000412306967
  error estimate for blocks of size 2^( 4) =       0.000428563686
  error estimate for blocks of size 2^( 5) =       0.000441472709
  error estimate for blocks of size 2^( 6) =       0.000451380023
  error estimate for blocks of size 2^( 7) =       0.000456613260

      target function =      -0.920397102160
              le_mean =     -16.898433881068
             les_mean =     285.852161019647
             stat err =       0.000444507420
             autocorr =       1.388044301636
   target nu stat err =       0.000444507420
   target dn stat err =       0.003065787439
      target stat err =       0.004819613200
              std dev =       0.533571161193
             le_variance =       0.284698184057


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.920396726171        initial
     9.5367e+01     9.5367e+02             2.6669e-06        -0.920402653122  <--
     3.8147e+02     3.8147e+03             6.6694e-07        -0.920399713815
     1.5259e+03     1.5259e+04             1.6675e-07        -0.920397102160

*****************************************************************************
Applying the update for shift_i =   9.5367e+01     and shift_s =   9.5367e+02
*****************************************************************************

  Execution time = 2.3585e+01
  </log>
  <optVariables href="H2O.s031.opt.xml">
ci_0001                 7.087010e-01 3 1  ON 0
ci_0002                 6.926408e-01 3 1  ON 1
ci_0003                -3.103989e-02 3 1  ON 2
ci_0004                -3.012699e-02 3 1  ON 3
ci_0005                -3.071665e-02 3 1  ON 4
ci_0006                -3.067418e-02 3 1  ON 5
ci_0007                -1.345396e-02 3 1  ON 6
ci_0008                -1.342297e-02 3 1  ON 7
ci_0009                -1.873596e-02 3 1  ON 8
ci_0010                -1.811514e-02 3 1  ON 9
ci_0011                -1.475235e-02 3 1  ON 10
ci_0012                -1.455275e-02 3 1  ON 11
ci_0013                 1.532166e-02 3 1  ON 12
ci_0014                 1.481822e-02 3 1  ON 13
ci_0015                 1.581915e-02 3 1  ON 14
ci_0016                 1.539859e-02 3 1  ON 15
ci_0017                 1.336599e-02 3 1  ON 16
ci_0018                 1.306191e-02 3 1  ON 17
ci_0019                 1.310115e-02 3 1  ON 18
ci_0020                 1.266785e-02 3 1  ON 19
ci_0021                 6.901754e-03 3 1  ON 20
ci_0022                 7.654018e-03 3 1  ON 21
ci_0023                -1.178551e-02 3 1  ON 22
ci_0024                -1.143587e-02 3 1  ON 23
ci_0025                -2.124879e-03 3 1  ON 24
ci_0026                -2.505076e-03 3 1  ON 25
ci_0027                -1.210107e-02 3 1  ON 26
ci_0028                -1.154902e-02 3 1  ON 27
ci_0029                -1.065932e-02 3 1  ON 28
ci_0030                -1.054888e-02 3 1  ON 29
ci_0031                 1.342759e-02 3 1  ON 30
ci_0032                 1.206573e-02 3 1  ON 31
ci_0033                 7.742295e-03 3 1  ON 32
ci_0034                 8.463403e-03 3 1  ON 33
ci_0035                 4.844069e-03 3 1  ON 34
ci_0036                 4.892740e-03 3 1  ON 35
ci_0037                -1.129970e-02 3 1  ON 36
ci_0038                -1.136527e-02 3 1  ON 37
ci_0039                -4.013893e-03 3 1  ON 38
ci_0040                -3.907201e-03 3 1  ON 39
ci_0041                 9.081456e-03 3 1  ON 40
ci_0042                 8.730352e-03 3 1  ON 41
ci_0043                -1.292449e-02 3 1  ON 42
ci_0044                -1.375188e-02 3 1  ON 43
ci_0045                 1.064557e-02 3 1  ON 44
ci_0046                 1.007243e-02 3 1  ON 45
ci_0047                -3.593787e-03 3 1  ON 46
ci_0048                -3.466990e-03 3 1  ON 47
ci_0049                -2.579299e-03 3 1  ON 48
ci_0050                -2.680103e-03 3 1  ON 49
ci_0051                -1.745587e-03 3 1  ON 50
ci_0052                -2.046698e-03 3 1  ON 51
ci_0053                -3.951171e-03 3 1  ON 52
ci_0054                -3.298762e-03 3 1  ON 53
ci_0055                 2.490501e-03 3 1  ON 54
ci_0056                 2.208076e-03 3 1  ON 55
ci_0057                 2.431343e-03 3 1  ON 56
ci_0058                 2.894700e-03 3 1  ON 57
ci_0059                -3.411488e-03 3 1  ON 58
ci_0060                -3.352627e-03 3 1  ON 59
ci_0061                -4.009969e-03 3 1  ON 60
ci_0062                -3.945800e-03 3 1  ON 61
ci_0063                -9.790873e-03 3 1  ON 62
ci_0064                -9.362071e-03 3 1  ON 63
ci_0065                -6.442899e-03 3 1  ON 64
ci_0066                -6.110160e-03 3 1  ON 65
ci_0067                -3.745845e-03 3 1  ON 66
ci_0068                -3.444346e-03 3 1  ON 67
ci_0069                 3.626463e-03 3 1  ON 68
ci_0070                 3.335342e-03 3 1  ON 69
ci_0071                 2.957998e-03 3 1  ON 70
ci_0072                 3.497762e-03 3 1  ON 71
ci_0073                 3.527965e-03 3 1  ON 72
ci_0074                 3.549577e-03 3 1  ON 73
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 4.0383e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s032 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s032 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=32  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6904e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 32
    time step          = 0.05
    reference energy   = -16.9654
    reference variance = 0.223605
====================================================
  Execution time = 1.4172e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s032
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5225e+04
  VMC Eavg = -1.6898e+01
  VMC Evar = 2.9282e-01
  Total weights = 1.950822355e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 2.6183e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.282921255885
                                         uncertainty =       0.001662580893

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.282921255885
                                         uncertainty =       0.001662580893

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000376110838
  error estimate for blocks of size 2^( 2) =       0.000393284578
  error estimate for blocks of size 2^( 3) =       0.000411509018
  error estimate for blocks of size 2^( 4) =       0.000427181806
  error estimate for blocks of size 2^( 5) =       0.000438691532
  error estimate for blocks of size 2^( 6) =       0.000446268820
  error estimate for blocks of size 2^( 7) =       0.000448519949

      target function =      -0.923937139622
              le_mean =     -16.898158272571
             les_mean =     285.840576951049
             stat err =       0.000440165527
             autocorr =       1.369620845301
   target nu stat err =       0.000440165527
   target dn stat err =       0.002635165002
      target stat err =       0.004188426602
              std dev =       0.531901047537
             le_variance =       0.282918724371


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.689815827257e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 74
Check correct_vf_var_size: 225, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.3842e+01, overlap shift 2.3842e+02 and omega -1.7444e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.923954714068       residual = 1.25e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.923956976565       residual = 2.02e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.923957280479       residual = 5.89e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.923957486770       residual = 2.62e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.923957566775       residual = 6.54e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.923957584343       residual = 3.89e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.923957583077       residual = 1.02e-05           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.923957580091       residual = 3.23e-06           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.923957578930       residual = 2.46e-06           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.923957577430       residual = 1.41e-06           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.923957580349       residual = 1.76e-06           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.923957579353       residual = 1.13e-06           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.923957583329       residual = 7.00e-07           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.923957584464       residual = 2.35e-07           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.923957585000       residual = 7.52e-08           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.923957584819       residual = 1.94e-08           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.923957584925       residual = 4.67e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         16 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 2.3842e+01 is 9.892934e-06

solving harmonic davidson linear method for identity shift 9.5367e+01, overlap shift 9.5367e+02 and omega -1.7444e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.923954714068       residual = 1.25e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.923955281095       residual = 2.02e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.923955357234       residual = 5.89e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.923955408872       residual = 2.62e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.923955428880       residual = 6.52e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.923955433269       residual = 3.87e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.923955432948       residual = 1.02e-05           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.923955432201       residual = 3.22e-06           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.923955431910       residual = 2.45e-06           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.923955431536       residual = 1.41e-06           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.923955432267       residual = 1.76e-06           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.923955432019       residual = 1.12e-06           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.923955433012       residual = 6.94e-07           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.923955433294       residual = 2.33e-07           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.923955433427       residual = 7.42e-08           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.923955433382       residual = 1.91e-08           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.923955433408       residual = 4.60e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         16 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 9.5367e+01 is 2.479303e-06

solving harmonic davidson linear method for identity shift 3.8147e+02, overlap shift 3.8147e+03 and omega -1.7444e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.923954714068       residual = 1.25e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.923954855913       residual = 2.02e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.923954874957       residual = 5.88e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.923954887871       residual = 2.61e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.923954892873       residual = 6.52e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.923954893970       residual = 3.87e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.923954893890       residual = 1.02e-05           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.923954893703       residual = 3.21e-06           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.923954893630       residual = 2.45e-06           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.923954893537       residual = 1.41e-06           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.923954893719       residual = 1.75e-06           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.923954893658       residual = 1.12e-06           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.923954893906       residual = 6.92e-07           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.923954893976       residual = 2.32e-07           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.923954894009       residual = 7.40e-08           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.923954893997       residual = 1.90e-08           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.923954894005       residual = 4.59e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         16 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 3.8147e+02 is 6.202063e-07

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.450105 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 75 and numParams is: 74

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.6804e+01
  </log>
  <optVariables href="H2O.s032.opt.xml">
ci_0001                 7.086999e-01 3 1  ON 0
ci_0002                 6.926419e-01 3 1  ON 1
ci_0003                -3.104007e-02 3 1  ON 2
ci_0004                -3.012678e-02 3 1  ON 3
ci_0005                -3.071799e-02 3 1  ON 4
ci_0006                -3.067404e-02 3 1  ON 5
ci_0007                -1.345398e-02 3 1  ON 6
ci_0008                -1.342239e-02 3 1  ON 7
ci_0009                -1.873602e-02 3 1  ON 8
ci_0010                -1.811445e-02 3 1  ON 9
ci_0011                -1.475248e-02 3 1  ON 10
ci_0012                -1.455295e-02 3 1  ON 11
ci_0013                 1.532121e-02 3 1  ON 12
ci_0014                 1.481845e-02 3 1  ON 13
ci_0015                 1.581983e-02 3 1  ON 14
ci_0016                 1.539918e-02 3 1  ON 15
ci_0017                 1.336676e-02 3 1  ON 16
ci_0018                 1.306170e-02 3 1  ON 17
ci_0019                 1.310124e-02 3 1  ON 18
ci_0020                 1.266803e-02 3 1  ON 19
ci_0021                 6.899432e-03 3 1  ON 20
ci_0022                 7.653390e-03 3 1  ON 21
ci_0023                -1.178469e-02 3 1  ON 22
ci_0024                -1.143574e-02 3 1  ON 23
ci_0025                -2.123931e-03 3 1  ON 24
ci_0026                -2.504593e-03 3 1  ON 25
ci_0027                -1.210022e-02 3 1  ON 26
ci_0028                -1.154936e-02 3 1  ON 27
ci_0029                -1.065890e-02 3 1  ON 28
ci_0030                -1.054909e-02 3 1  ON 29
ci_0031                 1.342784e-02 3 1  ON 30
ci_0032                 1.206659e-02 3 1  ON 31
ci_0033                 7.741196e-03 3 1  ON 32
ci_0034                 8.462628e-03 3 1  ON 33
ci_0035                 4.841590e-03 3 1  ON 34
ci_0036                 4.891944e-03 3 1  ON 35
ci_0037                -1.130051e-02 3 1  ON 36
ci_0038                -1.136484e-02 3 1  ON 37
ci_0039                -4.013720e-03 3 1  ON 38
ci_0040                -3.907474e-03 3 1  ON 39
ci_0041                 9.081444e-03 3 1  ON 40
ci_0042                 8.730829e-03 3 1  ON 41
ci_0043                -1.292681e-02 3 1  ON 42
ci_0044                -1.375285e-02 3 1  ON 43
ci_0045                 1.064474e-02 3 1  ON 44
ci_0046                 1.007245e-02 3 1  ON 45
ci_0047                -3.593886e-03 3 1  ON 46
ci_0048                -3.466905e-03 3 1  ON 47
ci_0049                -2.579140e-03 3 1  ON 48
ci_0050                -2.679310e-03 3 1  ON 49
ci_0051                -1.746042e-03 3 1  ON 50
ci_0052                -2.046369e-03 3 1  ON 51
ci_0053                -3.950521e-03 3 1  ON 52
ci_0054                -3.298896e-03 3 1  ON 53
ci_0055                 2.489464e-03 3 1  ON 54
ci_0056                 2.206904e-03 3 1  ON 55
ci_0057                 2.431017e-03 3 1  ON 56
ci_0058                 2.894114e-03 3 1  ON 57
ci_0059                -3.411147e-03 3 1  ON 58
ci_0060                -3.353164e-03 3 1  ON 59
ci_0061                -4.010393e-03 3 1  ON 60
ci_0062                -3.946040e-03 3 1  ON 61
ci_0063                -9.791076e-03 3 1  ON 62
ci_0064                -9.362203e-03 3 1  ON 63
ci_0065                -6.442690e-03 3 1  ON 64
ci_0066                -6.109508e-03 3 1  ON 65
ci_0067                -3.746711e-03 3 1  ON 66
ci_0068                -3.445073e-03 3 1  ON 67
ci_0069                 3.625661e-03 3 1  ON 68
ci_0070                 3.335084e-03 3 1  ON 69
ci_0071                 2.958814e-03 3 1  ON 70
ci_0072                 3.497528e-03 3 1  ON 71
ci_0073                 3.528429e-03 3 1  ON 72
ci_0074                 3.549714e-03 3 1  ON 73
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 32
    time step          = 0.05
    reference energy   = -16.9256
    reference variance = 0.222324
====================================================
  Execution time = 1.4009e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s032
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6899e+01
  VMC Evar = 2.9208e-01
  Total weights = 1.9509e+06
  Execution time = 1.8679e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.282663454432
                                         uncertainty =       0.002042577234

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.282663454432
                                         uncertainty =       0.002042577234

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000376004596
  error estimate for blocks of size 2^( 2) =       0.000392948050
  error estimate for blocks of size 2^( 3) =       0.000410081080
  error estimate for blocks of size 2^( 4) =       0.000424739646
  error estimate for blocks of size 2^( 5) =       0.000435510158
  error estimate for blocks of size 2^( 6) =       0.000444263009
  error estimate for blocks of size 2^( 7) =       0.000450625595

      target function =      -0.925111290952
              le_mean =     -16.898666045721
             les_mean =     285.856994407546
             stat err =       0.000438784602
             autocorr =       1.361809787798
   target nu stat err =       0.000438784602
   target dn stat err =       0.002511760608
      target stat err =       0.004011922533
              std dev =       0.531750799162
             le_variance =       0.282758912409

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.282658801863
                                         uncertainty =       0.002040862661

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.282658801863
                                         uncertainty =       0.002040862661

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000376001511
  error estimate for blocks of size 2^( 2) =       0.000392945026
  error estimate for blocks of size 2^( 3) =       0.000410078145
  error estimate for blocks of size 2^( 4) =       0.000424736639
  error estimate for blocks of size 2^( 5) =       0.000435507044
  error estimate for blocks of size 2^( 6) =       0.000444259583
  error estimate for blocks of size 2^( 7) =       0.000450622156

      target function =      -0.925133201435
              le_mean =     -16.898666115620
             les_mean =     285.856982841263
             stat err =       0.000438781356
             autocorr =       1.361811982448
   target nu stat err =       0.000438781356
   target dn stat err =       0.002508098171
      target stat err =       0.004006460022
              std dev =       0.531746435969
             le_variance =       0.282754272166

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.282661117054
                                         uncertainty =       0.002041715375

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.282661117054
                                         uncertainty =       0.002041715375

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000376003046
  error estimate for blocks of size 2^( 2) =       0.000392946531
  error estimate for blocks of size 2^( 3) =       0.000410079606
  error estimate for blocks of size 2^( 4) =       0.000424738136
  error estimate for blocks of size 2^( 5) =       0.000435508595
  error estimate for blocks of size 2^( 6) =       0.000444261289
  error estimate for blocks of size 2^( 7) =       0.000450623869

      target function =      -0.925122362287
              le_mean =     -16.898666080528
             les_mean =     285.856988545644
             stat err =       0.000438782972
             autocorr =       1.361810895821
   target nu stat err =       0.000438782972
   target dn stat err =       0.002509917378
      target stat err =       0.004009173770
              std dev =       0.531748607152
             le_variance =       0.282756581208

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.282663161494
                                         uncertainty =       0.002042469175

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.282663161494
                                         uncertainty =       0.002042469175

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000376004402
  error estimate for blocks of size 2^( 2) =       0.000392947860
  error estimate for blocks of size 2^( 3) =       0.000410080895
  error estimate for blocks of size 2^( 4) =       0.000424739457
  error estimate for blocks of size 2^( 5) =       0.000435509962
  error estimate for blocks of size 2^( 6) =       0.000444262794
  error estimate for blocks of size 2^( 7) =       0.000450625379

      target function =      -0.925112685784
              le_mean =     -16.898666050049
             les_mean =     285.856993667088
             stat err =       0.000438784398
             autocorr =       1.361809927006
   target nu stat err =       0.000438784398
   target dn stat err =       0.002511529194
      target stat err =       0.004011577476
              std dev =       0.531750524442
             le_variance =       0.282758620244


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.925111290952        initial
     2.3842e+01     2.3842e+02             9.8929e-06        -0.925133201435  <--
     9.5367e+01     9.5367e+02             2.4793e-06        -0.925122362287
     3.8147e+02     3.8147e+03             6.2021e-07        -0.925112685784

*****************************************************************************
Applying the update for shift_i =   2.3842e+01     and shift_s =   2.3842e+02
*****************************************************************************

  Execution time = 2.3462e+01
  </log>
  <optVariables href="H2O.s032.opt.xml">
ci_0001                 7.086965e-01 3 1  ON 0
ci_0002                 6.926453e-01 3 1  ON 1
ci_0003                -3.104060e-02 3 1  ON 2
ci_0004                -3.012614e-02 3 1  ON 3
ci_0005                -3.072202e-02 3 1  ON 4
ci_0006                -3.067362e-02 3 1  ON 5
ci_0007                -1.345403e-02 3 1  ON 6
ci_0008                -1.342063e-02 3 1  ON 7
ci_0009                -1.873621e-02 3 1  ON 8
ci_0010                -1.811239e-02 3 1  ON 9
ci_0011                -1.475286e-02 3 1  ON 10
ci_0012                -1.455357e-02 3 1  ON 11
ci_0013                 1.531988e-02 3 1  ON 12
ci_0014                 1.481913e-02 3 1  ON 13
ci_0015                 1.582186e-02 3 1  ON 14
ci_0016                 1.540096e-02 3 1  ON 15
ci_0017                 1.336903e-02 3 1  ON 16
ci_0018                 1.306110e-02 3 1  ON 17
ci_0019                 1.310149e-02 3 1  ON 18
ci_0020                 1.266859e-02 3 1  ON 19
ci_0021                 6.892481e-03 3 1  ON 20
ci_0022                 7.651508e-03 3 1  ON 21
ci_0023                -1.178223e-02 3 1  ON 22
ci_0024                -1.143537e-02 3 1  ON 23
ci_0025                -2.121096e-03 3 1  ON 24
ci_0026                -2.503147e-03 3 1  ON 25
ci_0027                -1.209770e-02 3 1  ON 26
ci_0028                -1.155040e-02 3 1  ON 27
ci_0029                -1.065765e-02 3 1  ON 28
ci_0030                -1.054972e-02 3 1  ON 29
ci_0031                 1.342861e-02 3 1  ON 30
ci_0032                 1.206915e-02 3 1  ON 31
ci_0033                 7.737905e-03 3 1  ON 32
ci_0034                 8.460309e-03 3 1  ON 33
ci_0035                 4.834176e-03 3 1  ON 34
ci_0036                 4.889562e-03 3 1  ON 35
ci_0037                -1.130291e-02 3 1  ON 36
ci_0038                -1.136357e-02 3 1  ON 37
ci_0039                -4.013204e-03 3 1  ON 38
ci_0040                -3.908292e-03 3 1  ON 39
ci_0041                 9.081405e-03 3 1  ON 40
ci_0042                 8.732256e-03 3 1  ON 41
ci_0043                -1.293377e-02 3 1  ON 42
ci_0044                -1.375574e-02 3 1  ON 43
ci_0045                 1.064224e-02 3 1  ON 44
ci_0046                 1.007253e-02 3 1  ON 45
ci_0047                -3.594181e-03 3 1  ON 46
ci_0048                -3.466653e-03 3 1  ON 47
ci_0049                -2.578666e-03 3 1  ON 48
ci_0050                -2.676940e-03 3 1  ON 49
ci_0051                -1.747404e-03 3 1  ON 50
ci_0052                -2.045387e-03 3 1  ON 51
ci_0053                -3.948578e-03 3 1  ON 52
ci_0054                -3.299297e-03 3 1  ON 53
ci_0055                 2.486365e-03 3 1  ON 54
ci_0056                 2.203399e-03 3 1  ON 55
ci_0057                 2.430041e-03 3 1  ON 56
ci_0058                 2.892363e-03 3 1  ON 57
ci_0059                -3.410130e-03 3 1  ON 58
ci_0060                -3.354771e-03 3 1  ON 59
ci_0061                -4.011660e-03 3 1  ON 60
ci_0062                -3.946760e-03 3 1  ON 61
ci_0063                -9.791681e-03 3 1  ON 62
ci_0064                -9.362599e-03 3 1  ON 63
ci_0065                -6.442066e-03 3 1  ON 64
ci_0066                -6.107555e-03 3 1  ON 65
ci_0067                -3.749298e-03 3 1  ON 66
ci_0068                -3.447247e-03 3 1  ON 67
ci_0069                 3.623265e-03 3 1  ON 68
ci_0070                 3.334310e-03 3 1  ON 69
ci_0071                 2.961255e-03 3 1  ON 70
ci_0072                 3.496829e-03 3 1  ON 71
ci_0073                 3.529815e-03 3 1  ON 72
ci_0074                 3.550124e-03 3 1  ON 73
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 4.0274e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s033 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s033 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=33  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6906e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 33
    time step          = 0.05
    reference energy   = -16.8894
    reference variance = 0.209352
====================================================
  Execution time = 1.6346e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s033
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5279e+04
  VMC Eavg = -1.6899e+01
  VMC Evar = 2.9094e-01
  Total weights = 1.951149839e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 2.5699e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.280829922902
                                         uncertainty =       0.001750539920

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.280829922902
                                         uncertainty =       0.001750539920

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000374693133
  error estimate for blocks of size 2^( 2) =       0.000391872664
  error estimate for blocks of size 2^( 3) =       0.000409200513
  error estimate for blocks of size 2^( 4) =       0.000424338588
  error estimate for blocks of size 2^( 5) =       0.000436346777
  error estimate for blocks of size 2^( 6) =       0.000444294474
  error estimate for blocks of size 2^( 7) =       0.000448881265

      target function =      -0.926907320908
              le_mean =     -16.898622086936
             les_mean =     285.854365480907
             stat err =       0.000438465276
             autocorr =       1.369364113578
   target nu stat err =       0.000438465276
   target dn stat err =       0.002599461155
      target stat err =       0.004162689028
              std dev =       0.529896110828
             le_variance =       0.280789888270


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.689862208694e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 74
Check correct_vf_var_size: 225, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 5.9605e+00, overlap shift 5.9605e+01 and omega -1.7444e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.926924478708       residual = 1.25e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.926932353064       residual = 1.73e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.926933760178       residual = 3.98e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.926934277212       residual = 1.74e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.926934571098       residual = 6.89e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.926934686001       residual = 2.49e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.926934718386       residual = 9.02e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.926934708166       residual = 1.65e-06           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.926934715748       residual = 1.47e-06           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.926934717023       residual = 1.00e-06           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.926934718142       residual = 8.73e-07           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.926934707846       residual = 6.05e-07           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.926934708523       residual = 5.49e-07           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.926934713296       residual = 1.51e-07           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.926934713341       residual = 5.85e-08           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.926934715409       residual = 1.64e-08           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.926934714498       residual = 5.20e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         16 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 5.9605e+00 is 3.336847e-05

solving harmonic davidson linear method for identity shift 2.3842e+01, overlap shift 2.3842e+02 and omega -1.7444e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.926924478708       residual = 1.25e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.926926466941       residual = 1.73e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.926926821599       residual = 3.97e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.926926951446       residual = 1.73e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.926927025124       residual = 6.83e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.926927053820       residual = 2.45e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.926927061856       residual = 8.84e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.926927059281       residual = 1.63e-06           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.926927061180       residual = 1.46e-06           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.926927061490       residual = 9.93e-07           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.926927061763       residual = 8.61e-07           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.926927059190       residual = 5.95e-07           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.926927059376       residual = 5.33e-07           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.926927060568       residual = 1.44e-07           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.926927060576       residual = 5.55e-08           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.926927061084       residual = 1.55e-08           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.926927060860       residual = 4.90e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         16 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 2.3842e+01 is 8.424057e-06

solving harmonic davidson linear method for identity shift 9.5367e+01, overlap shift 9.5367e+02 and omega -1.7444e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.926924478708       residual = 1.25e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.926924977009       residual = 1.73e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.926925065855       residual = 3.96e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.926925098354       residual = 1.73e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.926925116786       residual = 6.81e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.926925123959       residual = 2.43e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.926925125964       residual = 8.80e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.926925125319       residual = 1.62e-06           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.926925125794       residual = 1.45e-06           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.926925125871       residual = 9.91e-07           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.926925125938       residual = 8.59e-07           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.926925125295       residual = 5.93e-07           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.926925125343       residual = 5.29e-07           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.926925125641       residual = 1.42e-07           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.926925125643       residual = 5.48e-08           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.926925125769       residual = 1.53e-08           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.926925125713       residual = 4.83e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         16 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 9.5367e+01 is 2.111199e-06

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.459219 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 75 and numParams is: 74

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.8930e+01
  </log>
  <optVariables href="H2O.s033.opt.xml">
ci_0001                 7.087001e-01 3 1  ON 0
ci_0002                 6.926416e-01 3 1  ON 1
ci_0003                -3.104103e-02 3 1  ON 2
ci_0004                -3.012930e-02 3 1  ON 3
ci_0005                -3.071955e-02 3 1  ON 4
ci_0006                -3.067877e-02 3 1  ON 5
ci_0007                -1.344680e-02 3 1  ON 6
ci_0008                -1.342288e-02 3 1  ON 7
ci_0009                -1.873578e-02 3 1  ON 8
ci_0010                -1.811112e-02 3 1  ON 9
ci_0011                -1.475504e-02 3 1  ON 10
ci_0012                -1.455801e-02 3 1  ON 11
ci_0013                 1.531941e-02 3 1  ON 12
ci_0014                 1.481943e-02 3 1  ON 13
ci_0015                 1.582323e-02 3 1  ON 14
ci_0016                 1.540268e-02 3 1  ON 15
ci_0017                 1.336724e-02 3 1  ON 16
ci_0018                 1.306518e-02 3 1  ON 17
ci_0019                 1.310325e-02 3 1  ON 18
ci_0020                 1.266892e-02 3 1  ON 19
ci_0021                 6.888238e-03 3 1  ON 20
ci_0022                 7.655245e-03 3 1  ON 21
ci_0023                -1.178038e-02 3 1  ON 22
ci_0024                -1.143400e-02 3 1  ON 23
ci_0025                -2.112672e-03 3 1  ON 24
ci_0026                -2.501294e-03 3 1  ON 25
ci_0027                -1.209647e-02 3 1  ON 26
ci_0028                -1.155165e-02 3 1  ON 27
ci_0029                -1.065730e-02 3 1  ON 28
ci_0030                -1.055189e-02 3 1  ON 29
ci_0031                 1.342458e-02 3 1  ON 30
ci_0032                 1.206983e-02 3 1  ON 31
ci_0033                 7.734909e-03 3 1  ON 32
ci_0034                 8.455074e-03 3 1  ON 33
ci_0035                 4.834328e-03 3 1  ON 34
ci_0036                 4.885904e-03 3 1  ON 35
ci_0037                -1.130256e-02 3 1  ON 36
ci_0038                -1.136321e-02 3 1  ON 37
ci_0039                -4.013053e-03 3 1  ON 38
ci_0040                -3.907857e-03 3 1  ON 39
ci_0041                 9.081610e-03 3 1  ON 40
ci_0042                 8.732064e-03 3 1  ON 41
ci_0043                -1.293121e-02 3 1  ON 42
ci_0044                -1.374905e-02 3 1  ON 43
ci_0045                 1.064160e-02 3 1  ON 44
ci_0046                 1.007350e-02 3 1  ON 45
ci_0047                -3.592857e-03 3 1  ON 46
ci_0048                -3.467998e-03 3 1  ON 47
ci_0049                -2.581484e-03 3 1  ON 48
ci_0050                -2.674813e-03 3 1  ON 49
ci_0051                -1.750256e-03 3 1  ON 50
ci_0052                -2.042242e-03 3 1  ON 51
ci_0053                -3.948515e-03 3 1  ON 52
ci_0054                -3.300141e-03 3 1  ON 53
ci_0055                 2.485658e-03 3 1  ON 54
ci_0056                 2.202436e-03 3 1  ON 55
ci_0057                 2.432537e-03 3 1  ON 56
ci_0058                 2.887679e-03 3 1  ON 57
ci_0059                -3.408899e-03 3 1  ON 58
ci_0060                -3.357086e-03 3 1  ON 59
ci_0061                -4.010178e-03 3 1  ON 60
ci_0062                -3.948605e-03 3 1  ON 61
ci_0063                -9.790771e-03 3 1  ON 62
ci_0064                -9.363103e-03 3 1  ON 63
ci_0065                -6.442951e-03 3 1  ON 64
ci_0066                -6.107668e-03 3 1  ON 65
ci_0067                -3.752430e-03 3 1  ON 66
ci_0068                -3.449930e-03 3 1  ON 67
ci_0069                 3.621572e-03 3 1  ON 68
ci_0070                 3.337600e-03 3 1  ON 69
ci_0071                 2.958717e-03 3 1  ON 70
ci_0072                 3.500594e-03 3 1  ON 71
ci_0073                 3.530260e-03 3 1  ON 72
ci_0074                 3.549407e-03 3 1  ON 73
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 33
    time step          = 0.05
    reference energy   = -16.8826
    reference variance = 0.278853
====================================================
  Execution time = 1.6144e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s033
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6899e+01
  VMC Evar = 2.9762e-01
  Total weights = 1.9507e+06
  Execution time = 1.8851e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.285073047971
                                         uncertainty =       0.002040010729

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.285073047971
                                         uncertainty =       0.002040010729

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000377469869
  error estimate for blocks of size 2^( 2) =       0.000394364444
  error estimate for blocks of size 2^( 3) =       0.000411934040
  error estimate for blocks of size 2^( 4) =       0.000427407798
  error estimate for blocks of size 2^( 5) =       0.000439292242
  error estimate for blocks of size 2^( 6) =       0.000445048367
  error estimate for blocks of size 2^( 7) =       0.000448976321

      target function =      -0.916491402293
              le_mean =     -16.898703182927
             les_mean =     285.863780878035
             stat err =       0.000440181182
             autocorr =       1.359873042171
   target nu stat err =       0.000440181182
   target dn stat err =       0.003700360914
      target stat err =       0.005748378533
              std dev =       0.533823007493
             le_variance =       0.284967003329

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.285076460759
                                         uncertainty =       0.002040498647

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.285076460759
                                         uncertainty =       0.002040498647

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000377472143
  error estimate for blocks of size 2^( 2) =       0.000394366643
  error estimate for blocks of size 2^( 3) =       0.000411936388
  error estimate for blocks of size 2^( 4) =       0.000427410579
  error estimate for blocks of size 2^( 5) =       0.000439294803
  error estimate for blocks of size 2^( 6) =       0.000445052043
  error estimate for blocks of size 2^( 7) =       0.000448981897

      target function =      -0.916452171741
              le_mean =     -16.898702985078
             les_mean =     285.863799679334
             stat err =       0.000440184831
             autocorr =       1.359879197951
   target nu stat err =       0.000440184831
   target dn stat err =       0.003698794615
      target stat err =       0.005745496336
              std dev =       0.533826224166
             le_variance =       0.284970437608

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.285074743389
                                         uncertainty =       0.002040255694

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.285074743389
                                         uncertainty =       0.002040255694

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000377470999
  error estimate for blocks of size 2^( 2) =       0.000394365535
  error estimate for blocks of size 2^( 3) =       0.000411935206
  error estimate for blocks of size 2^( 4) =       0.000427409182
  error estimate for blocks of size 2^( 5) =       0.000439293514
  error estimate for blocks of size 2^( 6) =       0.000445050201
  error estimate for blocks of size 2^( 7) =       0.000448979115

      target function =      -0.916472637756
              le_mean =     -16.898703079445
             les_mean =     285.863789572798
             stat err =       0.000440183003
             autocorr =       1.359876152140
   target nu stat err =       0.000440183003
   target dn stat err =       0.003699520526
      target stat err =       0.005746860463
              std dev =       0.533824605665
             le_variance =       0.284968709614

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.285073256973
                                         uncertainty =       0.002040041181

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.285073256973
                                         uncertainty =       0.002040041181

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000377470008
  error estimate for blocks of size 2^( 2) =       0.000394364578
  error estimate for blocks of size 2^( 3) =       0.000411934184
  error estimate for blocks of size 2^( 4) =       0.000427407969
  error estimate for blocks of size 2^( 5) =       0.000439292399
  error estimate for blocks of size 2^( 6) =       0.000445048594
  error estimate for blocks of size 2^( 7) =       0.000448976669

      target function =      -0.916489175966
              le_mean =     -16.898703169537
             les_mean =     285.863781872133
             stat err =       0.000440181408
             autocorr =       1.359873434441
   target nu stat err =       0.000440181408
   target dn stat err =       0.003700249636
      target stat err =       0.005748180728
              std dev =       0.533823204531
             le_variance =       0.284967213696


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.916491402293        initial  <--
     5.9605e+00     5.9605e+01             3.3368e-05        -0.916452171741
     2.3842e+01     2.3842e+02             8.4241e-06        -0.916472637756
     9.5367e+01     9.5367e+02             2.1112e-06        -0.916489175966

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 25.6302
  </log>
  <optVariables href="H2O.s033.opt.xml">
ci_0001                 7.086965e-01 3 1  ON 0
ci_0002                 6.926453e-01 3 1  ON 1
ci_0003                -3.104060e-02 3 1  ON 2
ci_0004                -3.012614e-02 3 1  ON 3
ci_0005                -3.072202e-02 3 1  ON 4
ci_0006                -3.067362e-02 3 1  ON 5
ci_0007                -1.345403e-02 3 1  ON 6
ci_0008                -1.342063e-02 3 1  ON 7
ci_0009                -1.873621e-02 3 1  ON 8
ci_0010                -1.811239e-02 3 1  ON 9
ci_0011                -1.475286e-02 3 1  ON 10
ci_0012                -1.455357e-02 3 1  ON 11
ci_0013                 1.531988e-02 3 1  ON 12
ci_0014                 1.481913e-02 3 1  ON 13
ci_0015                 1.582186e-02 3 1  ON 14
ci_0016                 1.540096e-02 3 1  ON 15
ci_0017                 1.336903e-02 3 1  ON 16
ci_0018                 1.306110e-02 3 1  ON 17
ci_0019                 1.310149e-02 3 1  ON 18
ci_0020                 1.266859e-02 3 1  ON 19
ci_0021                 6.892481e-03 3 1  ON 20
ci_0022                 7.651508e-03 3 1  ON 21
ci_0023                -1.178223e-02 3 1  ON 22
ci_0024                -1.143537e-02 3 1  ON 23
ci_0025                -2.121096e-03 3 1  ON 24
ci_0026                -2.503147e-03 3 1  ON 25
ci_0027                -1.209770e-02 3 1  ON 26
ci_0028                -1.155040e-02 3 1  ON 27
ci_0029                -1.065765e-02 3 1  ON 28
ci_0030                -1.054972e-02 3 1  ON 29
ci_0031                 1.342861e-02 3 1  ON 30
ci_0032                 1.206915e-02 3 1  ON 31
ci_0033                 7.737905e-03 3 1  ON 32
ci_0034                 8.460309e-03 3 1  ON 33
ci_0035                 4.834176e-03 3 1  ON 34
ci_0036                 4.889562e-03 3 1  ON 35
ci_0037                -1.130291e-02 3 1  ON 36
ci_0038                -1.136357e-02 3 1  ON 37
ci_0039                -4.013204e-03 3 1  ON 38
ci_0040                -3.908292e-03 3 1  ON 39
ci_0041                 9.081405e-03 3 1  ON 40
ci_0042                 8.732256e-03 3 1  ON 41
ci_0043                -1.293377e-02 3 1  ON 42
ci_0044                -1.375574e-02 3 1  ON 43
ci_0045                 1.064224e-02 3 1  ON 44
ci_0046                 1.007253e-02 3 1  ON 45
ci_0047                -3.594181e-03 3 1  ON 46
ci_0048                -3.466653e-03 3 1  ON 47
ci_0049                -2.578666e-03 3 1  ON 48
ci_0050                -2.676940e-03 3 1  ON 49
ci_0051                -1.747404e-03 3 1  ON 50
ci_0052                -2.045387e-03 3 1  ON 51
ci_0053                -3.948578e-03 3 1  ON 52
ci_0054                -3.299297e-03 3 1  ON 53
ci_0055                 2.486365e-03 3 1  ON 54
ci_0056                 2.203399e-03 3 1  ON 55
ci_0057                 2.430041e-03 3 1  ON 56
ci_0058                 2.892363e-03 3 1  ON 57
ci_0059                -3.410130e-03 3 1  ON 58
ci_0060                -3.354771e-03 3 1  ON 59
ci_0061                -4.011660e-03 3 1  ON 60
ci_0062                -3.946760e-03 3 1  ON 61
ci_0063                -9.791681e-03 3 1  ON 62
ci_0064                -9.362599e-03 3 1  ON 63
ci_0065                -6.442066e-03 3 1  ON 64
ci_0066                -6.107555e-03 3 1  ON 65
ci_0067                -3.749298e-03 3 1  ON 66
ci_0068                -3.447247e-03 3 1  ON 67
ci_0069                 3.623265e-03 3 1  ON 68
ci_0070                 3.334310e-03 3 1  ON 69
ci_0071                 2.961255e-03 3 1  ON 70
ci_0072                 3.496829e-03 3 1  ON 71
ci_0073                 3.529815e-03 3 1  ON 72
ci_0074                 3.550124e-03 3 1  ON 73
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 4.4567e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s034 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s034 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=34  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6905e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 34
    time step          = 0.05
    reference energy   = -16.8774
    reference variance = 0.200362
====================================================
  Execution time = 1.4380e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s034
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5244e+04
  VMC Eavg = -1.6898e+01
  VMC Evar = 2.9572e-01
  Total weights = 1.950810443e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 2.6306e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.285113912078
                                         uncertainty =       0.001802134930

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.285113912078
                                         uncertainty =       0.001802134930

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000377550633
  error estimate for blocks of size 2^( 2) =       0.000394600077
  error estimate for blocks of size 2^( 3) =       0.000412279074
  error estimate for blocks of size 2^( 4) =       0.000427146024
  error estimate for blocks of size 2^( 5) =       0.000439345912
  error estimate for blocks of size 2^( 6) =       0.000447997608
  error estimate for blocks of size 2^( 7) =       0.000453828283

      target function =      -0.919430522622
              le_mean =     -16.898196435196
             les_mean =     285.844761321968
             stat err =       0.000442079457
             autocorr =       1.371040434028
   target nu stat err =       0.000442079457
   target dn stat err =       0.002756437970
      target stat err =       0.004334115063
              std dev =       0.533937225375
             le_variance =       0.285088960641


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.689819643520e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 74
Check correct_vf_var_size: 225, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 5.9605e+01, overlap shift 5.9605e+02 and omega -1.7444e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.919449523930       residual = 8.21e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.919450210434       residual = 8.99e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.919450291510       residual = 2.56e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.919450316699       residual = 1.43e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.919450338807       residual = 3.11e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.919450343481       residual = 3.42e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.919450343331       residual = 1.53e-05           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.919450344535       residual = 1.10e-05           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.919450348033       residual = 1.23e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.919450351999       residual = 7.43e-06           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.919450353690       residual = 4.78e-06           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.919450353882       residual = 1.58e-06           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.919450355022       residual = 8.05e-07           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.919450354601       residual = 2.22e-07           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.919450354640       residual = 6.26e-08           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.919450354757       residual = 1.08e-08           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.919450354761       residual = 2.66e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         16 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 5.9605e+01 is 3.782226e-06

solving harmonic davidson linear method for identity shift 2.3842e+02, overlap shift 2.3842e+03 and omega -1.7444e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.919449523930       residual = 8.21e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.919449695723       residual = 8.99e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.919449716007       residual = 2.56e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.919449722306       residual = 1.43e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.919449727835       residual = 3.11e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.919449729004       residual = 3.41e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.919449728966       residual = 1.53e-05           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.919449729267       residual = 1.10e-05           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.919449730142       residual = 1.23e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.919449731133       residual = 7.42e-06           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.919449731554       residual = 4.77e-06           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.919449731602       residual = 1.58e-06           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.919449731887       residual = 8.01e-07           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.919449731781       residual = 2.21e-07           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.919449731791       residual = 6.23e-08           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.919449731821       residual = 1.07e-08           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.919449731821       residual = 2.65e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         16 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 2.3842e+02 is 9.455578e-07

solving harmonic davidson linear method for identity shift 9.5367e+02, overlap shift 9.5367e+03 and omega -1.7444e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.919449523930       residual = 8.21e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.919449566889       residual = 8.98e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.919449571960       residual = 2.55e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.919449573536       residual = 1.43e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.919449574918       residual = 3.10e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.919449575210       residual = 3.41e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.919449575202       residual = 1.53e-05           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.919449575274       residual = 1.10e-05           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.919449575495       residual = 1.23e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.919449575743       residual = 7.41e-06           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.919449575850       residual = 4.76e-06           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.919449575860       residual = 1.57e-06           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.919449575930       residual = 8.00e-07           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.919449575905       residual = 2.21e-07           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.919449575909       residual = 6.22e-08           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.919449575915       residual = 1.07e-08           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.919449575914       residual = 2.64e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         16 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 9.5367e+02 is 2.363895e-07

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.468281 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 75 and numParams is: 74

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.7025e+01
  </log>
  <optVariables href="H2O.s034.opt.xml">
ci_0001                 7.086956e-01 3 1  ON 0
ci_0002                 6.926462e-01 3 1  ON 1
ci_0003                -3.104045e-02 3 1  ON 2
ci_0004                -3.012596e-02 3 1  ON 3
ci_0005                -3.072172e-02 3 1  ON 4
ci_0006                -3.067412e-02 3 1  ON 5
ci_0007                -1.345380e-02 3 1  ON 6
ci_0008                -1.342102e-02 3 1  ON 7
ci_0009                -1.873608e-02 3 1  ON 8
ci_0010                -1.811255e-02 3 1  ON 9
ci_0011                -1.475289e-02 3 1  ON 10
ci_0012                -1.455328e-02 3 1  ON 11
ci_0013                 1.531963e-02 3 1  ON 12
ci_0014                 1.481921e-02 3 1  ON 13
ci_0015                 1.582193e-02 3 1  ON 14
ci_0016                 1.540099e-02 3 1  ON 15
ci_0017                 1.336908e-02 3 1  ON 16
ci_0018                 1.306106e-02 3 1  ON 17
ci_0019                 1.310173e-02 3 1  ON 18
ci_0020                 1.266866e-02 3 1  ON 19
ci_0021                 6.892087e-03 3 1  ON 20
ci_0022                 7.651350e-03 3 1  ON 21
ci_0023                -1.178234e-02 3 1  ON 22
ci_0024                -1.143547e-02 3 1  ON 23
ci_0025                -2.121458e-03 3 1  ON 24
ci_0026                -2.503368e-03 3 1  ON 25
ci_0027                -1.209762e-02 3 1  ON 26
ci_0028                -1.155069e-02 3 1  ON 27
ci_0029                -1.065736e-02 3 1  ON 28
ci_0030                -1.055004e-02 3 1  ON 29
ci_0031                 1.342866e-02 3 1  ON 30
ci_0032                 1.206906e-02 3 1  ON 31
ci_0033                 7.737605e-03 3 1  ON 32
ci_0034                 8.460207e-03 3 1  ON 33
ci_0035                 4.833812e-03 3 1  ON 34
ci_0036                 4.889460e-03 3 1  ON 35
ci_0037                -1.130334e-02 3 1  ON 36
ci_0038                -1.136362e-02 3 1  ON 37
ci_0039                -4.013266e-03 3 1  ON 38
ci_0040                -3.908341e-03 3 1  ON 39
ci_0041                 9.081246e-03 3 1  ON 40
ci_0042                 8.732248e-03 3 1  ON 41
ci_0043                -1.293354e-02 3 1  ON 42
ci_0044                -1.375612e-02 3 1  ON 43
ci_0045                 1.064220e-02 3 1  ON 44
ci_0046                 1.007260e-02 3 1  ON 45
ci_0047                -3.594305e-03 3 1  ON 46
ci_0048                -3.466661e-03 3 1  ON 47
ci_0049                -2.579527e-03 3 1  ON 48
ci_0050                -2.677283e-03 3 1  ON 49
ci_0051                -1.747449e-03 3 1  ON 50
ci_0052                -2.045420e-03 3 1  ON 51
ci_0053                -3.948532e-03 3 1  ON 52
ci_0054                -3.299227e-03 3 1  ON 53
ci_0055                 2.486151e-03 3 1  ON 54
ci_0056                 2.203083e-03 3 1  ON 55
ci_0057                 2.430293e-03 3 1  ON 56
ci_0058                 2.892956e-03 3 1  ON 57
ci_0059                -3.410200e-03 3 1  ON 58
ci_0060                -3.354671e-03 3 1  ON 59
ci_0061                -4.011208e-03 3 1  ON 60
ci_0062                -3.946735e-03 3 1  ON 61
ci_0063                -9.791487e-03 3 1  ON 62
ci_0064                -9.362680e-03 3 1  ON 63
ci_0065                -6.442049e-03 3 1  ON 64
ci_0066                -6.107561e-03 3 1  ON 65
ci_0067                -3.749513e-03 3 1  ON 66
ci_0068                -3.447422e-03 3 1  ON 67
ci_0069                 3.623124e-03 3 1  ON 68
ci_0070                 3.334211e-03 3 1  ON 69
ci_0071                 2.961257e-03 3 1  ON 70
ci_0072                 3.496513e-03 3 1  ON 71
ci_0073                 3.529815e-03 3 1  ON 72
ci_0074                 3.549907e-03 3 1  ON 73
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 34
    time step          = 0.05
    reference energy   = -16.9226
    reference variance = 0.229829
====================================================
  Execution time = 1.4124e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s034
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6898e+01
  VMC Evar = 2.8855e-01
  Total weights = 1.9512e+06
  Execution time = 1.8726e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.278323018303
                                         uncertainty =       0.001478391853

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.278323018303
                                         uncertainty =       0.001478391853

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000373012154
  error estimate for blocks of size 2^( 2) =       0.000390306277
  error estimate for blocks of size 2^( 3) =       0.000407564752
  error estimate for blocks of size 2^( 4) =       0.000422214064
  error estimate for blocks of size 2^( 5) =       0.000433672617
  error estimate for blocks of size 2^( 6) =       0.000441563031
  error estimate for blocks of size 2^( 7) =       0.000446667802

      target function =      -0.930683097785
              le_mean =     -16.898335828316
             les_mean =     285.842303749446
             stat err =       0.000436029379
             autocorr =       1.366424182074
   target nu stat err =       0.000436029379
   target dn stat err =       0.002008524532
      target stat err =       0.003274143881
              std dev =       0.527518846493
             le_variance =       0.278276133405

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.278323155460
                                         uncertainty =       0.001478428771

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.278323155460
                                         uncertainty =       0.001478428771

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000373012245
  error estimate for blocks of size 2^( 2) =       0.000390306338
  error estimate for blocks of size 2^( 3) =       0.000407564744
  error estimate for blocks of size 2^( 4) =       0.000422214062
  error estimate for blocks of size 2^( 5) =       0.000433672579
  error estimate for blocks of size 2^( 6) =       0.000441563071
  error estimate for blocks of size 2^( 7) =       0.000446667847

      target function =      -0.930692795706
              le_mean =     -16.898335846430
             les_mean =     285.842298254440
             stat err =       0.000436029390
             autocorr =       1.366423584979
   target nu stat err =       0.000436029390
   target dn stat err =       0.002008307528
      target stat err =       0.003273874965
              std dev =       0.527518975345
             le_variance =       0.278276269349

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.278323086727
                                         uncertainty =       0.001478410323

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.278323086727
                                         uncertainty =       0.001478410323

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000373012199
  error estimate for blocks of size 2^( 2) =       0.000390306308
  error estimate for blocks of size 2^( 3) =       0.000407564748
  error estimate for blocks of size 2^( 4) =       0.000422214063
  error estimate for blocks of size 2^( 5) =       0.000433672598
  error estimate for blocks of size 2^( 6) =       0.000441563051
  error estimate for blocks of size 2^( 7) =       0.000446667824

      target function =      -0.930688168940
              le_mean =     -16.898335837348
             les_mean =     285.842300861134
             stat err =       0.000436029384
             autocorr =       1.366423883507
   target nu stat err =       0.000436029384
   target dn stat err =       0.002008411426
      target stat err =       0.003274003828
              std dev =       0.527518910772
             le_variance =       0.278276201223

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.278323026832
                                         uncertainty =       0.001478394162

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.278323026832
                                         uncertainty =       0.001478394162

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000373012159
  error estimate for blocks of size 2^( 2) =       0.000390306281
  error estimate for blocks of size 2^( 3) =       0.000407564751
  error estimate for blocks of size 2^( 4) =       0.000422214064
  error estimate for blocks of size 2^( 5) =       0.000433672615
  error estimate for blocks of size 2^( 6) =       0.000441563034
  error estimate for blocks of size 2^( 7) =       0.000446667804

      target function =      -0.930683759464
              le_mean =     -16.898335829441
             les_mean =     285.842303370781
             stat err =       0.000436029379
             autocorr =       1.366424144764
   target nu stat err =       0.000436029379
   target dn stat err =       0.002008509872
      target stat err =       0.003274125758
              std dev =       0.527518854506
             le_variance =       0.278276141859


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.930683097785        initial
     5.9605e+01     5.9605e+02             3.7822e-06        -0.930692795706  <--
     2.3842e+02     2.3842e+03             9.4556e-07        -0.930688168940
     9.5367e+02     9.5367e+03             2.3639e-07        -0.930683759464

*****************************************************************************
Applying the update for shift_i =   5.9605e+01     and shift_s =   5.9605e+02
*****************************************************************************

  Execution time = 2.3627e+01
  </log>
  <optVariables href="H2O.s034.opt.xml">
ci_0001                 7.086928e-01 3 1  ON 0
ci_0002                 6.926491e-01 3 1  ON 1
ci_0003                -3.103999e-02 3 1  ON 2
ci_0004                -3.012542e-02 3 1  ON 3
ci_0005                -3.072080e-02 3 1  ON 4
ci_0006                -3.067563e-02 3 1  ON 5
ci_0007                -1.345312e-02 3 1  ON 6
ci_0008                -1.342221e-02 3 1  ON 7
ci_0009                -1.873570e-02 3 1  ON 8
ci_0010                -1.811301e-02 3 1  ON 9
ci_0011                -1.475300e-02 3 1  ON 10
ci_0012                -1.455241e-02 3 1  ON 11
ci_0013                 1.531888e-02 3 1  ON 12
ci_0014                 1.481943e-02 3 1  ON 13
ci_0015                 1.582217e-02 3 1  ON 14
ci_0016                 1.540107e-02 3 1  ON 15
ci_0017                 1.336921e-02 3 1  ON 16
ci_0018                 1.306095e-02 3 1  ON 17
ci_0019                 1.310244e-02 3 1  ON 18
ci_0020                 1.266886e-02 3 1  ON 19
ci_0021                 6.890906e-03 3 1  ON 20
ci_0022                 7.650878e-03 3 1  ON 21
ci_0023                -1.178265e-02 3 1  ON 22
ci_0024                -1.143577e-02 3 1  ON 23
ci_0025                -2.122544e-03 3 1  ON 24
ci_0026                -2.504031e-03 3 1  ON 25
ci_0027                -1.209737e-02 3 1  ON 26
ci_0028                -1.155155e-02 3 1  ON 27
ci_0029                -1.065649e-02 3 1  ON 28
ci_0030                -1.055101e-02 3 1  ON 29
ci_0031                 1.342882e-02 3 1  ON 30
ci_0032                 1.206880e-02 3 1  ON 31
ci_0033                 7.736705e-03 3 1  ON 32
ci_0034                 8.459903e-03 3 1  ON 33
ci_0035                 4.832720e-03 3 1  ON 34
ci_0036                 4.889155e-03 3 1  ON 35
ci_0037                -1.130464e-02 3 1  ON 36
ci_0038                -1.136376e-02 3 1  ON 37
ci_0039                -4.013450e-03 3 1  ON 38
ci_0040                -3.908485e-03 3 1  ON 39
ci_0041                 9.080769e-03 3 1  ON 40
ci_0042                 8.732224e-03 3 1  ON 41
ci_0043                -1.293286e-02 3 1  ON 42
ci_0044                -1.375724e-02 3 1  ON 43
ci_0045                 1.064209e-02 3 1  ON 44
ci_0046                 1.007282e-02 3 1  ON 45
ci_0047                -3.594675e-03 3 1  ON 46
ci_0048                -3.466684e-03 3 1  ON 47
ci_0049                -2.582106e-03 3 1  ON 48
ci_0050                -2.678314e-03 3 1  ON 49
ci_0051                -1.747584e-03 3 1  ON 50
ci_0052                -2.045519e-03 3 1  ON 51
ci_0053                -3.948391e-03 3 1  ON 52
ci_0054                -3.299018e-03 3 1  ON 53
ci_0055                 2.485509e-03 3 1  ON 54
ci_0056                 2.202136e-03 3 1  ON 55
ci_0057                 2.431046e-03 3 1  ON 56
ci_0058                 2.894734e-03 3 1  ON 57
ci_0059                -3.410410e-03 3 1  ON 58
ci_0060                -3.354372e-03 3 1  ON 59
ci_0061                -4.009854e-03 3 1  ON 60
ci_0062                -3.946659e-03 3 1  ON 61
ci_0063                -9.790904e-03 3 1  ON 62
ci_0064                -9.362921e-03 3 1  ON 63
ci_0065                -6.441997e-03 3 1  ON 64
ci_0066                -6.107578e-03 3 1  ON 65
ci_0067                -3.750155e-03 3 1  ON 66
ci_0068                -3.447945e-03 3 1  ON 67
ci_0069                 3.622701e-03 3 1  ON 68
ci_0070                 3.333917e-03 3 1  ON 69
ci_0071                 2.961264e-03 3 1  ON 70
ci_0072                 3.495566e-03 3 1  ON 71
ci_0073                 3.529816e-03 3 1  ON 72
ci_0074                 3.549255e-03 3 1  ON 73
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 4.0658e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s035 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s035 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=35  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6905e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 35
    time step          = 0.05
    reference energy   = -17.035
    reference variance = 1.19973
====================================================
  Execution time = 1.4272e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s035
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5230e+04
  VMC Eavg = -1.6899e+01
  VMC Evar = 2.9639e-01
  Total weights = 1.950553061e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 2.6254e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.284945960654
                                         uncertainty =       0.001957680380

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.284945960654
                                         uncertainty =       0.001957680380

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000377481508
  error estimate for blocks of size 2^( 2) =       0.000394546665
  error estimate for blocks of size 2^( 3) =       0.000412245218
  error estimate for blocks of size 2^( 4) =       0.000427205499
  error estimate for blocks of size 2^( 5) =       0.000440042638
  error estimate for blocks of size 2^( 6) =       0.000447841394
  error estimate for blocks of size 2^( 7) =       0.000450608808

      target function =      -0.918396338090
              le_mean =     -16.898755078055
             les_mean =     285.864310650099
             stat err =       0.000441424585
             autocorr =       1.367482170951
   target nu stat err =       0.000441424585
   target dn stat err =       0.002818414941
      target stat err =       0.004423249235
              std dev =       0.533839467513
             le_variance =       0.284984577075


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.689875507805e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 74
Check correct_vf_var_size: 225, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.4901e+01, overlap shift 1.4901e+02 and omega -1.7444e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.918416398996       residual = 1.13e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.918419552163       residual = 1.06e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.918419878531       residual = 3.62e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.918419956534       residual = 1.13e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.918420037173       residual = 4.59e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.918420046138       residual = 2.87e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.918420062872       residual = 1.06e-05           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.918420065980       residual = 2.02e-06           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.918420060672       residual = 1.58e-06           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.918420064318       residual = 1.08e-06           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.918420067046       residual = 9.44e-07           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.918420068356       residual = 6.76e-07           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.918420068583       residual = 5.81e-07           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.918420065161       residual = 2.01e-07           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.918420064943       residual = 7.99e-08           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.918420065641       residual = 2.36e-08           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.918420065475       residual = 3.94e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         16 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 1.4901e+01 is 1.324412e-05

solving harmonic davidson linear method for identity shift 5.9605e+01, overlap shift 5.9605e+02 and omega -1.7444e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.918416398996       residual = 1.13e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.918417190370       residual = 1.06e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.918417272230       residual = 3.61e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.918417291764       residual = 1.12e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.918417311955       residual = 4.57e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.918417314186       residual = 2.85e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.918417318366       residual = 1.05e-05           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.918417319138       residual = 2.01e-06           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.918417317811       residual = 1.57e-06           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.918417318724       residual = 1.07e-06           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.918417319404       residual = 9.38e-07           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.918417319730       residual = 6.71e-07           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.918417319784       residual = 5.75e-07           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.918417318931       residual = 1.98e-07           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.918417318878       residual = 7.83e-08           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.918417319052       residual = 2.31e-08           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.918417319010       residual = 3.84e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         16 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 5.9605e+01 is 3.317885e-06

solving harmonic davidson linear method for identity shift 2.3842e+02, overlap shift 2.3842e+03 and omega -1.7444e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.918416398996       residual = 1.13e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.918416597033       residual = 1.06e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.918416617515       residual = 3.61e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.918416622400       residual = 1.12e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.918416627450       residual = 4.57e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.918416628007       residual = 2.85e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.918416629051       residual = 1.05e-05           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.918416629245       residual = 2.00e-06           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.918416628913       residual = 1.57e-06           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.918416629141       residual = 1.07e-06           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.918416629311       residual = 9.36e-07           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.918416629392       residual = 6.69e-07           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.918416629405       residual = 5.73e-07           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.918416629192       residual = 1.97e-07           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.918416629179       residual = 7.79e-08           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.918416629223       residual = 2.29e-08           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.918416629213       residual = 3.82e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         16 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 2.3842e+02 is 8.299007e-07

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.477393 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 75 and numParams is: 74

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.6912e+01
  </log>
  <optVariables href="H2O.s035.opt.xml">
ci_0001                 7.086943e-01 3 1  ON 0
ci_0002                 6.926477e-01 3 1  ON 1
ci_0003                -3.103962e-02 3 1  ON 2
ci_0004                -3.012511e-02 3 1  ON 3
ci_0005                -3.072079e-02 3 1  ON 4
ci_0006                -3.067542e-02 3 1  ON 5
ci_0007                -1.345441e-02 3 1  ON 6
ci_0008                -1.342110e-02 3 1  ON 7
ci_0009                -1.873473e-02 3 1  ON 8
ci_0010                -1.811238e-02 3 1  ON 9
ci_0011                -1.475321e-02 3 1  ON 10
ci_0012                -1.455245e-02 3 1  ON 11
ci_0013                 1.531910e-02 3 1  ON 12
ci_0014                 1.482011e-02 3 1  ON 13
ci_0015                 1.582144e-02 3 1  ON 14
ci_0016                 1.540210e-02 3 1  ON 15
ci_0017                 1.337009e-02 3 1  ON 16
ci_0018                 1.306113e-02 3 1  ON 17
ci_0019                 1.310233e-02 3 1  ON 18
ci_0020                 1.266879e-02 3 1  ON 19
ci_0021                 6.889052e-03 3 1  ON 20
ci_0022                 7.647561e-03 3 1  ON 21
ci_0023                -1.178339e-02 3 1  ON 22
ci_0024                -1.143572e-02 3 1  ON 23
ci_0025                -2.122180e-03 3 1  ON 24
ci_0026                -2.504814e-03 3 1  ON 25
ci_0027                -1.209757e-02 3 1  ON 26
ci_0028                -1.155168e-02 3 1  ON 27
ci_0029                -1.065527e-02 3 1  ON 28
ci_0030                -1.055233e-02 3 1  ON 29
ci_0031                 1.342775e-02 3 1  ON 30
ci_0032                 1.206938e-02 3 1  ON 31
ci_0033                 7.736515e-03 3 1  ON 32
ci_0034                 8.458182e-03 3 1  ON 33
ci_0035                 4.834087e-03 3 1  ON 34
ci_0036                 4.885917e-03 3 1  ON 35
ci_0037                -1.130447e-02 3 1  ON 36
ci_0038                -1.136291e-02 3 1  ON 37
ci_0039                -4.012630e-03 3 1  ON 38
ci_0040                -3.908140e-03 3 1  ON 39
ci_0041                 9.081131e-03 3 1  ON 40
ci_0042                 8.732404e-03 3 1  ON 41
ci_0043                -1.293203e-02 3 1  ON 42
ci_0044                -1.375724e-02 3 1  ON 43
ci_0045                 1.064249e-02 3 1  ON 44
ci_0046                 1.007217e-02 3 1  ON 45
ci_0047                -3.594644e-03 3 1  ON 46
ci_0048                -3.466857e-03 3 1  ON 47
ci_0049                -2.581586e-03 3 1  ON 48
ci_0050                -2.678888e-03 3 1  ON 49
ci_0051                -1.748096e-03 3 1  ON 50
ci_0052                -2.045656e-03 3 1  ON 51
ci_0053                -3.947578e-03 3 1  ON 52
ci_0054                -3.298977e-03 3 1  ON 53
ci_0055                 2.485987e-03 3 1  ON 54
ci_0056                 2.203783e-03 3 1  ON 55
ci_0057                 2.430015e-03 3 1  ON 56
ci_0058                 2.894073e-03 3 1  ON 57
ci_0059                -3.408490e-03 3 1  ON 58
ci_0060                -3.351549e-03 3 1  ON 59
ci_0061                -4.009317e-03 3 1  ON 60
ci_0062                -3.944888e-03 3 1  ON 61
ci_0063                -9.790852e-03 3 1  ON 62
ci_0064                -9.362301e-03 3 1  ON 63
ci_0065                -6.442584e-03 3 1  ON 64
ci_0066                -6.108265e-03 3 1  ON 65
ci_0067                -3.748624e-03 3 1  ON 66
ci_0068                -3.448190e-03 3 1  ON 67
ci_0069                 3.622335e-03 3 1  ON 68
ci_0070                 3.334030e-03 3 1  ON 69
ci_0071                 2.961012e-03 3 1  ON 70
ci_0072                 3.495539e-03 3 1  ON 71
ci_0073                 3.530145e-03 3 1  ON 72
ci_0074                 3.549380e-03 3 1  ON 73
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 35
    time step          = 0.05
    reference energy   = -16.9708
    reference variance = 0.232019
====================================================
  Execution time = 1.4103e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s035
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6899e+01
  VMC Evar = 2.9232e-01
  Total weights = 1.9512e+06
  Execution time = 1.8752e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.282732383381
                                         uncertainty =       0.001661594285

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.282732383381
                                         uncertainty =       0.001661594285

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000375955125
  error estimate for blocks of size 2^( 2) =       0.000392815408
  error estimate for blocks of size 2^( 3) =       0.000410025312
  error estimate for blocks of size 2^( 4) =       0.000424643982
  error estimate for blocks of size 2^( 5) =       0.000436142767
  error estimate for blocks of size 2^( 6) =       0.000442472685
  error estimate for blocks of size 2^( 7) =       0.000445186905

      target function =      -0.924749810758
              le_mean =     -16.899146102285
             les_mean =     285.873456394233
             stat err =       0.000437111584
             autocorr =       1.351800535147
   target nu stat err =       0.000437111584
   target dn stat err =       0.002208918953
      target stat err =       0.003545760838
              std dev =       0.531680836551
             le_variance =       0.282684511955

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.282731405304
                                         uncertainty =       0.001661601959

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.282731405304
                                         uncertainty =       0.001661601959

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000375954478
  error estimate for blocks of size 2^( 2) =       0.000392814883
  error estimate for blocks of size 2^( 3) =       0.000410024848
  error estimate for blocks of size 2^( 4) =       0.000424643611
  error estimate for blocks of size 2^( 5) =       0.000436142756
  error estimate for blocks of size 2^( 6) =       0.000442472701
  error estimate for blocks of size 2^( 7) =       0.000445186554

      target function =      -0.924758836498
              le_mean =     -16.899146130068
             les_mean =     285.873451583591
             stat err =       0.000437111406
             autocorr =       1.351804078272
   target nu stat err =       0.000437111406
   target dn stat err =       0.002208876161
      target stat err =       0.003545762970
              std dev =       0.531679922131
             le_variance =       0.282683539597

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.282731889938
                                         uncertainty =       0.001661598103

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.282731889938
                                         uncertainty =       0.001661598103

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000375954799
  error estimate for blocks of size 2^( 2) =       0.000392815143
  error estimate for blocks of size 2^( 3) =       0.000410025078
  error estimate for blocks of size 2^( 4) =       0.000424643794
  error estimate for blocks of size 2^( 5) =       0.000436142760
  error estimate for blocks of size 2^( 6) =       0.000442472691
  error estimate for blocks of size 2^( 7) =       0.000445186727

      target function =      -0.924755014239
              le_mean =     -16.899146115807
             les_mean =     285.873453536487
             stat err =       0.000437111493
             autocorr =       1.351802315719
   target nu stat err =       0.000437111493
   target dn stat err =       0.002208889588
      target stat err =       0.003545754849
              std dev =       0.531680375208
             le_variance =       0.282684021381

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.282732321237
                                         uncertainty =       0.001661594749

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.282732321237
                                         uncertainty =       0.001661594749

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000375955084
  error estimate for blocks of size 2^( 2) =       0.000392815374
  error estimate for blocks of size 2^( 3) =       0.000410025282
  error estimate for blocks of size 2^( 4) =       0.000424643958
  error estimate for blocks of size 2^( 5) =       0.000436142766
  error estimate for blocks of size 2^( 6) =       0.000442472685
  error estimate for blocks of size 2^( 7) =       0.000445186883

      target function =      -0.924750534812
              le_mean =     -16.899146103929
             les_mean =     285.873455988570
             stat err =       0.000437111573
             autocorr =       1.351800758308
   target nu stat err =       0.000437111573
   target dn stat err =       0.002208914362
      target stat err =       0.003545759228
              std dev =       0.531680778447
             le_variance =       0.282684450170


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.924749810758        initial
     1.4901e+01     1.4901e+02             1.3244e-05        -0.924758836498  <--
     5.9605e+01     5.9605e+02             3.3179e-06        -0.924755014239
     2.3842e+02     2.3842e+03             8.2990e-07        -0.924750534812

*****************************************************************************
Applying the update for shift_i =   1.4901e+01     and shift_s =   1.4901e+02
*****************************************************************************

  Execution time = 2.3553e+01
  </log>
  <optVariables href="H2O.s035.opt.xml">
ci_0001                 7.086988e-01 3 1  ON 0
ci_0002                 6.926437e-01 3 1  ON 1
ci_0003                -3.103854e-02 3 1  ON 2
ci_0004                -3.012417e-02 3 1  ON 3
ci_0005                -3.072077e-02 3 1  ON 4
ci_0006                -3.067479e-02 3 1  ON 5
ci_0007                -1.345825e-02 3 1  ON 6
ci_0008                -1.341779e-02 3 1  ON 7
ci_0009                -1.873186e-02 3 1  ON 8
ci_0010                -1.811048e-02 3 1  ON 9
ci_0011                -1.475385e-02 3 1  ON 10
ci_0012                -1.455256e-02 3 1  ON 11
ci_0013                 1.531974e-02 3 1  ON 12
ci_0014                 1.482214e-02 3 1  ON 13
ci_0015                 1.581924e-02 3 1  ON 14
ci_0016                 1.540520e-02 3 1  ON 15
ci_0017                 1.337270e-02 3 1  ON 16
ci_0018                 1.306169e-02 3 1  ON 17
ci_0019                 1.310203e-02 3 1  ON 18
ci_0020                 1.266859e-02 3 1  ON 19
ci_0021                 6.883502e-03 3 1  ON 20
ci_0022                 7.637634e-03 3 1  ON 21
ci_0023                -1.178562e-02 3 1  ON 22
ci_0024                -1.143557e-02 3 1  ON 23
ci_0025                -2.121092e-03 3 1  ON 24
ci_0026                -2.507153e-03 3 1  ON 25
ci_0027                -1.209817e-02 3 1  ON 26
ci_0028                -1.155208e-02 3 1  ON 27
ci_0029                -1.065162e-02 3 1  ON 28
ci_0030                -1.055627e-02 3 1  ON 29
ci_0031                 1.342454e-02 3 1  ON 30
ci_0032                 1.207112e-02 3 1  ON 31
ci_0033                 7.735948e-03 3 1  ON 32
ci_0034                 8.453037e-03 3 1  ON 33
ci_0035                 4.838167e-03 3 1  ON 34
ci_0036                 4.876252e-03 3 1  ON 35
ci_0037                -1.130397e-02 3 1  ON 36
ci_0038                -1.136036e-02 3 1  ON 37
ci_0039                -4.010182e-03 3 1  ON 38
ci_0040                -3.907108e-03 3 1  ON 39
ci_0041                 9.082213e-03 3 1  ON 40
ci_0042                 8.732942e-03 3 1  ON 41
ci_0043                -1.292954e-02 3 1  ON 42
ci_0044                -1.375723e-02 3 1  ON 43
ci_0045                 1.064371e-02 3 1  ON 44
ci_0046                 1.007022e-02 3 1  ON 45
ci_0047                -3.594552e-03 3 1  ON 46
ci_0048                -3.467374e-03 3 1  ON 47
ci_0049                -2.580037e-03 3 1  ON 48
ci_0050                -2.680601e-03 3 1  ON 49
ci_0051                -1.749620e-03 3 1  ON 50
ci_0052                -2.046064e-03 3 1  ON 51
ci_0053                -3.945150e-03 3 1  ON 52
ci_0054                -3.298855e-03 3 1  ON 53
ci_0055                 2.487412e-03 3 1  ON 54
ci_0056                 2.208698e-03 3 1  ON 55
ci_0057                 2.426937e-03 3 1  ON 56
ci_0058                 2.892101e-03 3 1  ON 57
ci_0059                -3.402762e-03 3 1  ON 58
ci_0060                -3.343124e-03 3 1  ON 59
ci_0061                -4.007712e-03 3 1  ON 60
ci_0062                -3.939599e-03 3 1  ON 61
ci_0063                -9.790695e-03 3 1  ON 62
ci_0064                -9.360451e-03 3 1  ON 63
ci_0065                -6.444337e-03 3 1  ON 64
ci_0066                -6.110319e-03 3 1  ON 65
ci_0067                -3.744053e-03 3 1  ON 66
ci_0068                -3.448922e-03 3 1  ON 67
ci_0069                 3.621243e-03 3 1  ON 68
ci_0070                 3.334365e-03 3 1  ON 69
ci_0071                 2.960259e-03 3 1  ON 70
ci_0072                 3.495459e-03 3 1  ON 71
ci_0073                 3.531127e-03 3 1  ON 72
ci_0074                 3.549755e-03 3 1  ON 73
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 4.0472e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s036 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s036 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=36  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6908e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 36
    time step          = 0.05
    reference energy   = -16.8817
    reference variance = 0.308276
====================================================
  Execution time = 1.4432e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s036
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5267e+04
  VMC Eavg = -1.6899e+01
  VMC Evar = 2.9314e-01
  Total weights = 1.951096565e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 2.5965e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.282152306282
                                         uncertainty =       0.002306150488

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.282152306282
                                         uncertainty =       0.002306150488

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000375579118
  error estimate for blocks of size 2^( 2) =       0.000392762994
  error estimate for blocks of size 2^( 3) =       0.000410150212
  error estimate for blocks of size 2^( 4) =       0.000425820504
  error estimate for blocks of size 2^( 5) =       0.000438015091
  error estimate for blocks of size 2^( 6) =       0.000446147384
  error estimate for blocks of size 2^( 7) =       0.000449738100

      target function =      -0.923440699887
              le_mean =     -16.898909573478
             les_mean =     285.866285241727
             stat err =       0.000439930269
             autocorr =       1.372033808794
   target nu stat err =       0.000439930269
   target dn stat err =       0.003338637188
      target stat err =       0.005276455323
              std dev =       0.531149082792
             le_variance =       0.282119348151


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.689890957348e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 74
Check correct_vf_var_size: 225, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 3.7253e+00, overlap shift 3.7253e+01 and omega -1.7444e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.923469262930       residual = 8.95e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.923479673992       residual = 1.25e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.923480982085       residual = 3.32e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.923481578138       residual = 1.26e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.923482216009       residual = 8.21e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.923482381446       residual = 7.58e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.923482595569       residual = 4.14e-05           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.923482665349       residual = 2.98e-05           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.923482787502       residual = 4.21e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.923482880666       residual = 1.52e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.923482897031       residual = 4.86e-06           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.923482901896       residual = 1.08e-06           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.923482911381       residual = 5.71e-07           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.923482910312       residual = 1.65e-07           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.923482906432       residual = 3.45e-08           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.923482908602       residual = 1.24e-08           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.923482907283       residual = 1.92e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         16 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 3.7253e+00 is 1.071830e-04

solving harmonic davidson linear method for identity shift 1.4901e+01, overlap shift 1.4901e+02 and omega -1.7444e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.923469262930       residual = 8.95e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.923471906542       residual = 1.24e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.923472237708       residual = 3.29e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.923472387970       residual = 1.25e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.923472548556       residual = 8.12e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.923472589853       residual = 7.44e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.923472643251       residual = 4.06e-05           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.923472660568       residual = 2.95e-05           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.923472691014       residual = 4.11e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.923472713545       residual = 1.44e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.923472717429       residual = 4.56e-06           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.923472718583       residual = 1.02e-06           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.923472720893       residual = 5.34e-07           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.923472720616       residual = 1.52e-07           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.923472719669       residual = 3.16e-08           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.923472720194       residual = 1.13e-08           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.923472719871       residual = 1.74e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         16 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 1.4901e+01 is 2.679776e-05

solving harmonic davidson linear method for identity shift 5.9605e+01, overlap shift 5.9605e+02 and omega -1.7444e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.923469262930       residual = 8.95e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.923469926436       residual = 1.24e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.923470009491       residual = 3.29e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.923470047135       residual = 1.24e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.923470087351       residual = 8.09e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.923470097671       residual = 7.41e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.923470111012       residual = 4.04e-05           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.923470115333       residual = 2.94e-05           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.923470122938       residual = 4.09e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.923470128523       residual = 1.42e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.923470129481       residual = 4.48e-06           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.923470129766       residual = 1.00e-06           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.923470130339       residual = 5.25e-07           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.923470130270       residual = 1.49e-07           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.923470130035       residual = 3.08e-08           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.923470130165       residual = 1.11e-08           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.923470130084       residual = 1.70e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         16 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 5.9605e+01 is 6.699568e-06

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.486507 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 75 and numParams is: 74

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.7043e+01
  </log>
  <optVariables href="H2O.s036.opt.xml">
ci_0001                 7.086731e-01 3 1  ON 0
ci_0002                 6.926705e-01 3 1  ON 1
ci_0003                -3.103496e-02 3 1  ON 2
ci_0004                -3.012388e-02 3 1  ON 3
ci_0005                -3.071475e-02 3 1  ON 4
ci_0006                -3.067512e-02 3 1  ON 5
ci_0007                -1.344970e-02 3 1  ON 6
ci_0008                -1.342040e-02 3 1  ON 7
ci_0009                -1.873308e-02 3 1  ON 8
ci_0010                -1.811157e-02 3 1  ON 9
ci_0011                -1.475451e-02 3 1  ON 10
ci_0012                -1.455180e-02 3 1  ON 11
ci_0013                 1.531930e-02 3 1  ON 12
ci_0014                 1.482527e-02 3 1  ON 13
ci_0015                 1.581651e-02 3 1  ON 14
ci_0016                 1.540506e-02 3 1  ON 15
ci_0017                 1.336713e-02 3 1  ON 16
ci_0018                 1.306520e-02 3 1  ON 17
ci_0019                 1.310103e-02 3 1  ON 18
ci_0020                 1.266687e-02 3 1  ON 19
ci_0021                 6.876593e-03 3 1  ON 20
ci_0022                 7.629159e-03 3 1  ON 21
ci_0023                -1.179027e-02 3 1  ON 22
ci_0024                -1.143867e-02 3 1  ON 23
ci_0025                -2.122839e-03 3 1  ON 24
ci_0026                -2.505513e-03 3 1  ON 25
ci_0027                -1.209628e-02 3 1  ON 26
ci_0028                -1.155205e-02 3 1  ON 27
ci_0029                -1.065172e-02 3 1  ON 28
ci_0030                -1.055613e-02 3 1  ON 29
ci_0031                 1.342115e-02 3 1  ON 30
ci_0032                 1.207632e-02 3 1  ON 31
ci_0033                 7.738865e-03 3 1  ON 32
ci_0034                 8.448506e-03 3 1  ON 33
ci_0035                 4.838682e-03 3 1  ON 34
ci_0036                 4.880702e-03 3 1  ON 35
ci_0037                -1.130274e-02 3 1  ON 36
ci_0038                -1.135936e-02 3 1  ON 37
ci_0039                -4.010467e-03 3 1  ON 38
ci_0040                -3.905377e-03 3 1  ON 39
ci_0041                 9.086438e-03 3 1  ON 40
ci_0042                 8.736859e-03 3 1  ON 41
ci_0043                -1.293442e-02 3 1  ON 42
ci_0044                -1.375721e-02 3 1  ON 43
ci_0045                 1.064372e-02 3 1  ON 44
ci_0046                 1.006959e-02 3 1  ON 45
ci_0047                -3.594731e-03 3 1  ON 46
ci_0048                -3.466968e-03 3 1  ON 47
ci_0049                -2.575205e-03 3 1  ON 48
ci_0050                -2.687828e-03 3 1  ON 49
ci_0051                -1.753672e-03 3 1  ON 50
ci_0052                -2.047365e-03 3 1  ON 51
ci_0053                -3.944766e-03 3 1  ON 52
ci_0054                -3.297401e-03 3 1  ON 53
ci_0055                 2.480981e-03 3 1  ON 54
ci_0056                 2.211146e-03 3 1  ON 55
ci_0057                 2.433713e-03 3 1  ON 56
ci_0058                 2.896991e-03 3 1  ON 57
ci_0059                -3.407271e-03 3 1  ON 58
ci_0060                -3.351492e-03 3 1  ON 59
ci_0061                -4.005673e-03 3 1  ON 60
ci_0062                -3.936439e-03 3 1  ON 61
ci_0063                -9.789170e-03 3 1  ON 62
ci_0064                -9.359985e-03 3 1  ON 63
ci_0065                -6.441007e-03 3 1  ON 64
ci_0066                -6.109096e-03 3 1  ON 65
ci_0067                -3.740411e-03 3 1  ON 66
ci_0068                -3.453390e-03 3 1  ON 67
ci_0069                 3.620727e-03 3 1  ON 68
ci_0070                 3.332129e-03 3 1  ON 69
ci_0071                 2.960981e-03 3 1  ON 70
ci_0072                 3.488041e-03 3 1  ON 71
ci_0073                 3.534210e-03 3 1  ON 72
ci_0074                 3.548745e-03 3 1  ON 73
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 36
    time step          = 0.05
    reference energy   = -16.8157
    reference variance = 0.194844
====================================================
  Execution time = 1.4350e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s036
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6899e+01
  VMC Evar = 2.9272e-01
  Total weights = 1.9512e+06
  Execution time = 1.8730e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.281842586205
                                         uncertainty =       0.001850654735

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.281842586205
                                         uncertainty =       0.001850654735

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000375360006
  error estimate for blocks of size 2^( 2) =       0.000392276093
  error estimate for blocks of size 2^( 3) =       0.000409621870
  error estimate for blocks of size 2^( 4) =       0.000425933456
  error estimate for blocks of size 2^( 5) =       0.000438498414
  error estimate for blocks of size 2^( 6) =       0.000447270837
  error estimate for blocks of size 2^( 7) =       0.000450874820

      target function =      -0.924087552466
              le_mean =     -16.899062337438
             les_mean =     285.871041417903
             stat err =       0.000440644382
             autocorr =       1.378099201322
   target nu stat err =       0.000440644382
   target dn stat err =       0.002858434788
      target stat err =       0.004541621403
              std dev =       0.530839210601
             le_variance =       0.281790267511

ERROR CostFunction-> Number of Effective Walkers is too small! 
  Number of effective walkers (samples) / total number of samples = 0.169535
  User specified threshold minwalkers = 0.3
  If this message appears frequently. You might have to be cautious. 
  Find info about parameter "minwalkers" in the user manual!
Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.281833953521
                                         uncertainty =       0.001851463955

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.281833953521
                                         uncertainty =       0.001851463955

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000375354242
  error estimate for blocks of size 2^( 2) =       0.000392268604
  error estimate for blocks of size 2^( 3) =       0.000409612949
  error estimate for blocks of size 2^( 4) =       0.000425923882
  error estimate for blocks of size 2^( 5) =       0.000438487802
  error estimate for blocks of size 2^( 6) =       0.000447258595
  error estimate for blocks of size 2^( 7) =       0.000450863601

      target function =      -0.924189275836
              le_mean =     -16.899062669589
             les_mean =     285.870987892894
             stat err =       0.000440633470
             autocorr =       1.378073270436
   target nu stat err =       0.000440633470
   target dn stat err =       0.002842800727
      target stat err =       0.004518435168
              std dev =       0.530831059117
             le_variance =       0.281781613323

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.281838123605
                                         uncertainty =       0.001851057640

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.281838123605
                                         uncertainty =       0.001851057640

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000375357026
  error estimate for blocks of size 2^( 2) =       0.000392272241
  error estimate for blocks of size 2^( 3) =       0.000409617292
  error estimate for blocks of size 2^( 4) =       0.000425928549
  error estimate for blocks of size 2^( 5) =       0.000438492985
  error estimate for blocks of size 2^( 6) =       0.000447264581
  error estimate for blocks of size 2^( 7) =       0.000450869083

      target function =      -0.924143163242
              le_mean =     -16.899062499212
             les_mean =     285.871011480893
             stat err =       0.000440638799
             autocorr =       1.378086160405
   target nu stat err =       0.000440638799
   target dn stat err =       0.002850337504
      target stat err =       0.004529641765
              std dev =       0.530834997060
             le_variance =       0.281785794104

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.281842015903
                                         uncertainty =       0.001850704952

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.281842015903
                                         uncertainty =       0.001850704952

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000375359625
  error estimate for blocks of size 2^( 2) =       0.000392275603
  error estimate for blocks of size 2^( 3) =       0.000409621289
  error estimate for blocks of size 2^( 4) =       0.000425932834
  error estimate for blocks of size 2^( 5) =       0.000438497727
  error estimate for blocks of size 2^( 6) =       0.000447270046
  error estimate for blocks of size 2^( 7) =       0.000450874094

      target function =      -0.924095414042
              le_mean =     -16.899062356973
             les_mean =     285.871037071787
             stat err =       0.000440643675
             autocorr =       1.378097577600
   target nu stat err =       0.000440643675
   target dn stat err =       0.002857396963
      target stat err =       0.004540093201
              std dev =       0.530838672167
             le_variance =       0.281789695869


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.924087552466        initial
     3.7253e+00     3.7253e+01             1.0718e-04        -0.924189275836  <--
     1.4901e+01     1.4901e+02             2.6798e-05        -0.924143163242
     5.9605e+01     5.9605e+02             6.6996e-06        -0.924095414042

*****************************************************************************
Applying the update for shift_i =   3.7253e+00     and shift_s =   3.7253e+01
*****************************************************************************

  Execution time = 2.3832e+01
  </log>
  <optVariables href="H2O.s036.opt.xml">
ci_0001                 7.085960e-01 3 1  ON 0
ci_0002                 6.927509e-01 3 1  ON 1
ci_0003                -3.102433e-02 3 1  ON 2
ci_0004                -3.012308e-02 3 1  ON 3
ci_0005                -3.069683e-02 3 1  ON 4
ci_0006                -3.067612e-02 3 1  ON 5
ci_0007                -1.342432e-02 3 1  ON 6
ci_0008                -1.342812e-02 3 1  ON 7
ci_0009                -1.873664e-02 3 1  ON 8
ci_0010                -1.811481e-02 3 1  ON 9
ci_0011                -1.475643e-02 3 1  ON 10
ci_0012                -1.454959e-02 3 1  ON 11
ci_0013                 1.531798e-02 3 1  ON 12
ci_0014                 1.483454e-02 3 1  ON 13
ci_0015                 1.580843e-02 3 1  ON 14
ci_0016                 1.540467e-02 3 1  ON 15
ci_0017                 1.335068e-02 3 1  ON 16
ci_0018                 1.307557e-02 3 1  ON 17
ci_0019                 1.309805e-02 3 1  ON 18
ci_0020                 1.266182e-02 3 1  ON 19
ci_0021                 6.856094e-03 3 1  ON 20
ci_0022                 7.603981e-03 3 1  ON 21
ci_0023                -1.180396e-02 3 1  ON 22
ci_0024                -1.144785e-02 3 1  ON 23
ci_0025                -2.127958e-03 3 1  ON 24
ci_0026                -2.500714e-03 3 1  ON 25
ci_0027                -1.209070e-02 3 1  ON 26
ci_0028                -1.155200e-02 3 1  ON 27
ci_0029                -1.065201e-02 3 1  ON 28
ci_0030                -1.055572e-02 3 1  ON 29
ci_0031                 1.341106e-02 3 1  ON 30
ci_0032                 1.209176e-02 3 1  ON 31
ci_0033                 7.747494e-03 3 1  ON 32
ci_0034                 8.435096e-03 3 1  ON 33
ci_0035                 4.840177e-03 3 1  ON 34
ci_0036                 4.893786e-03 3 1  ON 35
ci_0037                -1.129908e-02 3 1  ON 36
ci_0038                -1.135641e-02 3 1  ON 37
ci_0039                -4.011295e-03 3 1  ON 38
ci_0040                -3.900291e-03 3 1  ON 39
ci_0041                 9.098886e-03 3 1  ON 40
ci_0042                 8.748443e-03 3 1  ON 41
ci_0043                -1.294885e-02 3 1  ON 42
ci_0044                -1.375713e-02 3 1  ON 43
ci_0045                 1.064376e-02 3 1  ON 44
ci_0046                 1.006772e-02 3 1  ON 45
ci_0047                -3.595249e-03 3 1  ON 46
ci_0048                -3.465782e-03 3 1  ON 47
ci_0049                -2.561004e-03 3 1  ON 48
ci_0050                -2.709068e-03 3 1  ON 49
ci_0051                -1.765559e-03 3 1  ON 50
ci_0052                -2.051184e-03 3 1  ON 51
ci_0053                -3.943630e-03 3 1  ON 52
ci_0054                -3.293134e-03 3 1  ON 53
ci_0055                 2.462081e-03 3 1  ON 54
ci_0056                 2.218334e-03 3 1  ON 55
ci_0057                 2.453622e-03 3 1  ON 56
ci_0058                 2.911369e-03 3 1  ON 57
ci_0059                -3.420513e-03 3 1  ON 58
ci_0060                -3.376091e-03 3 1  ON 59
ci_0061                -3.999652e-03 3 1  ON 60
ci_0062                -3.927131e-03 3 1  ON 61
ci_0063                -9.784659e-03 3 1  ON 62
ci_0064                -9.358629e-03 3 1  ON 63
ci_0065                -6.431166e-03 3 1  ON 64
ci_0066                -6.105507e-03 3 1  ON 65
ci_0067                -3.729705e-03 3 1  ON 66
ci_0068                -3.466526e-03 3 1  ON 67
ci_0069                 3.619201e-03 3 1  ON 68
ci_0070                 3.325565e-03 3 1  ON 69
ci_0071                 2.963092e-03 3 1  ON 70
ci_0072                 3.466247e-03 3 1  ON 71
ci_0073                 3.543258e-03 3 1  ON 72
ci_0074                 3.545786e-03 3 1  ON 73
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 4.0971e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s037 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s037 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=37  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6906e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 37
    time step          = 0.05
    reference energy   = -16.8275
    reference variance = 0.326276
====================================================
  Execution time = 1.4213e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s037
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5250e+04
  VMC Eavg = -1.6899e+01
  VMC Evar = 2.9280e-01
  Total weights = 1.950871964e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 2.5751e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.282200757259
                                         uncertainty =       0.001674372922

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.282200757259
                                         uncertainty =       0.001674372922

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000375637228
  error estimate for blocks of size 2^( 2) =       0.000392276476
  error estimate for blocks of size 2^( 3) =       0.000409719400
  error estimate for blocks of size 2^( 4) =       0.000424540435
  error estimate for blocks of size 2^( 5) =       0.000436163456
  error estimate for blocks of size 2^( 6) =       0.000443587225
  error estimate for blocks of size 2^( 7) =       0.000449800435

      target function =      -0.923975202554
              le_mean =     -16.898956018540
             les_mean =     285.867518812572
             stat err =       0.000438522888
             autocorr =       1.362847543212
   target nu stat err =       0.000438522888
   target dn stat err =       0.002861478049
      target stat err =       0.004543759716
              std dev =       0.531231262773
             le_variance =       0.282206654548


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.689895601854e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 74
Check correct_vf_var_size: 225, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 9.3132e-01, overlap shift 9.3132e+00 and omega -1.7444e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.923996114265       residual = 2.07e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.924084812165       residual = 2.63e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.924096806035       residual = 8.65e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.924101924962       residual = 2.37e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.924103583475       residual = 1.02e-04           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.924104467145       residual = 1.18e-04           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.924105024441       residual = 4.92e-05           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.924105313452       residual = 3.79e-05           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.924106101644       residual = 4.63e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.924107756460       residual = 2.68e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.924108052949       residual = 1.36e-05           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.924108167575       residual = 4.06e-06           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.924108154637       residual = 2.36e-06           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.924108089646       residual = 4.37e-07           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.924108096823       residual = 1.01e-07           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.924108084062       residual = 4.00e-08           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.924108084692       residual = 1.20e-08           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.924108082731       residual = 4.88e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         17 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 9.3132e-01 is 4.383503e-04

solving harmonic davidson linear method for identity shift 3.7253e+00, overlap shift 3.7253e+01 and omega -1.7444e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.923996114265       residual = 2.07e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.924019655943       residual = 2.59e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.924022792396       residual = 8.38e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.924024112146       residual = 2.29e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.924024537520       residual = 9.87e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.924024760048       residual = 1.10e-04           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.924024898081       residual = 4.60e-05           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.924024971683       residual = 3.64e-05           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.924025177442       residual = 4.35e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.924025581327       residual = 2.29e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.924025642527       residual = 1.11e-05           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.924025664187       residual = 3.29e-06           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.924025658840       residual = 1.82e-06           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.924025643676       residual = 3.16e-07           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.924025645290       residual = 7.21e-08           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.924025642390       residual = 2.87e-08           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.924025642545       residual = 8.31e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         16 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 3.7253e+00 is 1.097872e-04

solving harmonic davidson linear method for identity shift 1.4901e+01, overlap shift 1.4901e+02 and omega -1.7444e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.923996114265       residual = 2.07e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.924002091814       residual = 2.58e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.924002885015       residual = 8.31e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.924003217504       residual = 2.26e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.924003324523       residual = 9.78e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.924003380229       residual = 1.08e-04           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.924003414639       residual = 4.52e-05           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.924003433134       residual = 3.60e-05           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.924003485143       residual = 4.27e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.924003585373       residual = 2.19e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.924003599857       residual = 1.05e-05           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.924003604849       residual = 3.11e-06           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.924003603391       residual = 1.70e-06           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.924003599678       residual = 2.91e-07           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.924003600070       residual = 6.60e-08           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.924003599364       residual = 2.63e-08           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.924003599403       residual = 7.54e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         16 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 1.4901e+01 is 2.746059e-05

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.503085 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 75 and numParams is: 74

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.6813e+01
  </log>
  <optVariables href="H2O.s037.opt.xml">
ci_0001                 7.084879e-01 3 1  ON 0
ci_0002                 6.928606e-01 3 1  ON 1
ci_0003                -3.102043e-02 3 1  ON 2
ci_0004                -3.012920e-02 3 1  ON 3
ci_0005                -3.067418e-02 3 1  ON 4
ci_0006                -3.072013e-02 3 1  ON 5
ci_0007                -1.340578e-02 3 1  ON 6
ci_0008                -1.344571e-02 3 1  ON 7
ci_0009                -1.871211e-02 3 1  ON 8
ci_0010                -1.812991e-02 3 1  ON 9
ci_0011                -1.475986e-02 3 1  ON 10
ci_0012                -1.452805e-02 3 1  ON 11
ci_0013                 1.530669e-02 3 1  ON 12
ci_0014                 1.482525e-02 3 1  ON 13
ci_0015                 1.578359e-02 3 1  ON 14
ci_0016                 1.539390e-02 3 1  ON 15
ci_0017                 1.332998e-02 3 1  ON 16
ci_0018                 1.307442e-02 3 1  ON 17
ci_0019                 1.308909e-02 3 1  ON 18
ci_0020                 1.266476e-02 3 1  ON 19
ci_0021                 6.862715e-03 3 1  ON 20
ci_0022                 7.585906e-03 3 1  ON 21
ci_0023                -1.180747e-02 3 1  ON 22
ci_0024                -1.145276e-02 3 1  ON 23
ci_0025                -2.112066e-03 3 1  ON 24
ci_0026                -2.491593e-03 3 1  ON 25
ci_0027                -1.209357e-02 3 1  ON 26
ci_0028                -1.157163e-02 3 1  ON 27
ci_0029                -1.067703e-02 3 1  ON 28
ci_0030                -1.054252e-02 3 1  ON 29
ci_0031                 1.341885e-02 3 1  ON 30
ci_0032                 1.206558e-02 3 1  ON 31
ci_0033                 7.764572e-03 3 1  ON 32
ci_0034                 8.437108e-03 3 1  ON 33
ci_0035                 4.838653e-03 3 1  ON 34
ci_0036                 4.895057e-03 3 1  ON 35
ci_0037                -1.129867e-02 3 1  ON 36
ci_0038                -1.136083e-02 3 1  ON 37
ci_0039                -4.012200e-03 3 1  ON 38
ci_0040                -3.897908e-03 3 1  ON 39
ci_0041                 9.121676e-03 3 1  ON 40
ci_0042                 8.757754e-03 3 1  ON 41
ci_0043                -1.299763e-02 3 1  ON 42
ci_0044                -1.374512e-02 3 1  ON 43
ci_0045                 1.064477e-02 3 1  ON 44
ci_0046                 1.005536e-02 3 1  ON 45
ci_0047                -3.605253e-03 3 1  ON 46
ci_0048                -3.464354e-03 3 1  ON 47
ci_0049                -2.562756e-03 3 1  ON 48
ci_0050                -2.688850e-03 3 1  ON 49
ci_0051                -1.749605e-03 3 1  ON 50
ci_0052                -2.044596e-03 3 1  ON 51
ci_0053                -3.934289e-03 3 1  ON 52
ci_0054                -3.291443e-03 3 1  ON 53
ci_0055                 2.448079e-03 3 1  ON 54
ci_0056                 2.218691e-03 3 1  ON 55
ci_0057                 2.445844e-03 3 1  ON 56
ci_0058                 2.949768e-03 3 1  ON 57
ci_0059                -3.413820e-03 3 1  ON 58
ci_0060                -3.399417e-03 3 1  ON 59
ci_0061                -4.089772e-03 3 1  ON 60
ci_0062                -3.915313e-03 3 1  ON 61
ci_0063                -9.782919e-03 3 1  ON 62
ci_0064                -9.360864e-03 3 1  ON 63
ci_0065                -6.453165e-03 3 1  ON 64
ci_0066                -6.101648e-03 3 1  ON 65
ci_0067                -3.722964e-03 3 1  ON 66
ci_0068                -3.470689e-03 3 1  ON 67
ci_0069                 3.634837e-03 3 1  ON 68
ci_0070                 3.324185e-03 3 1  ON 69
ci_0071                 3.041218e-03 3 1  ON 70
ci_0072                 3.457976e-03 3 1  ON 71
ci_0073                 3.533359e-03 3 1  ON 72
ci_0074                 3.526876e-03 3 1  ON 73
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 37
    time step          = 0.05
    reference energy   = -16.9486
    reference variance = 0.303499
====================================================
  Execution time = 1.4120e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s037
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6899e+01
  VMC Evar = 2.9296e-01
  Total weights = 1.9512e+06
  Execution time = 1.8680e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.283257238137
                                         uncertainty =       0.003170840185

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.283257238137
                                         uncertainty =       0.003170840185

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000376350278
  error estimate for blocks of size 2^( 2) =       0.000393518638
  error estimate for blocks of size 2^( 3) =       0.000410747550
  error estimate for blocks of size 2^( 4) =       0.000425775523
  error estimate for blocks of size 2^( 5) =       0.000438148207
  error estimate for blocks of size 2^( 6) =       0.000446264694
  error estimate for blocks of size 2^( 7) =       0.000450463708

      target function =      -0.923716168349
              le_mean =     -16.898612610346
             les_mean =     285.856067060994
             stat err =       0.000440163033
             autocorr =       1.367863146631
   target nu stat err =       0.000440163033
   target dn stat err =       0.003576659899
      target stat err =       0.005645716091
              std dev =       0.532239667245
             le_variance =       0.283279063389

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.283259292838
                                         uncertainty =       0.003186061826

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.283259292838
                                         uncertainty =       0.003186061826

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000376351566
  error estimate for blocks of size 2^( 2) =       0.000393522956
  error estimate for blocks of size 2^( 3) =       0.000410755084
  error estimate for blocks of size 2^( 4) =       0.000425781760
  error estimate for blocks of size 2^( 5) =       0.000438153803
  error estimate for blocks of size 2^( 6) =       0.000446269443
  error estimate for blocks of size 2^( 7) =       0.000450477330

      target function =      -0.923233595453
              le_mean =     -16.898612763697
             les_mean =     285.856380511916
             stat err =       0.000440170584
             autocorr =       1.367900719380
   target nu stat err =       0.000440170584
   target dn stat err =       0.003604039033
      target stat err =       0.005682298401
              std dev =       0.532241488234
             le_variance =       0.283281001797

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.283256515382
                                         uncertainty =       0.003178744648

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.283256515382
                                         uncertainty =       0.003178744648

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000376349757
  error estimate for blocks of size 2^( 2) =       0.000393519746
  error estimate for blocks of size 2^( 3) =       0.000410750413
  error estimate for blocks of size 2^( 4) =       0.000425777782
  error estimate for blocks of size 2^( 5) =       0.000438150138
  error estimate for blocks of size 2^( 6) =       0.000446266212
  error estimate for blocks of size 2^( 7) =       0.000450469841

      target function =      -0.923658421174
              le_mean =     -16.898612453021
             les_mean =     285.856098558772
             stat err =       0.000440165993
             autocorr =       1.367885330169
   target nu stat err =       0.000440165993
   target dn stat err =       0.003584464159
      target stat err =       0.005657119083
              std dev =       0.532238930995
             le_variance =       0.283278279667

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.283256932048
                                         uncertainty =       0.003171835356

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.283256932048
                                         uncertainty =       0.003171835356

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000376350070
  error estimate for blocks of size 2^( 2) =       0.000393518636
  error estimate for blocks of size 2^( 3) =       0.000410747774
  error estimate for blocks of size 2^( 4) =       0.000425775675
  error estimate for blocks of size 2^( 5) =       0.000438148320
  error estimate for blocks of size 2^( 6) =       0.000446264761
  error estimate for blocks of size 2^( 7) =       0.000450464359

      target function =      -0.923718024092
              le_mean =     -16.898612564754
             les_mean =     285.856064322424
             stat err =       0.000440163279
             autocorr =       1.367866191207
   target nu stat err =       0.000440163279
   target dn stat err =       0.003577571169
      target stat err =       0.005647151618
              std dev =       0.532239372561
             le_variance =       0.283278749704


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.923716168349        initial
     9.3132e-01     9.3132e+00             4.3835e-04        -0.923233595453
     3.7253e+00     3.7253e+01             1.0979e-04        -0.923658421174
     1.4901e+01     1.4901e+02             2.7461e-05        -0.923718024092  <--

*****************************************************************************
Applying the update for shift_i =   1.4901e+01     and shift_s =   1.4901e+02
*****************************************************************************

  Execution time = 2.3568e+01
  </log>
  <optVariables href="H2O.s037.opt.xml">
ci_0001                 7.085690e-01 3 1  ON 0
ci_0002                 6.927783e-01 3 1  ON 1
ci_0003                -3.102336e-02 3 1  ON 2
ci_0004                -3.012461e-02 3 1  ON 3
ci_0005                -3.069113e-02 3 1  ON 4
ci_0006                -3.068722e-02 3 1  ON 5
ci_0007                -1.341965e-02 3 1  ON 6
ci_0008                -1.343256e-02 3 1  ON 7
ci_0009                -1.873043e-02 3 1  ON 8
ci_0010                -1.811863e-02 3 1  ON 9
ci_0011                -1.475731e-02 3 1  ON 10
ci_0012                -1.454414e-02 3 1  ON 11
ci_0013                 1.531513e-02 3 1  ON 12
ci_0014                 1.483218e-02 3 1  ON 13
ci_0015                 1.580215e-02 3 1  ON 14
ci_0016                 1.540194e-02 3 1  ON 15
ci_0017                 1.334545e-02 3 1  ON 16
ci_0018                 1.307528e-02 3 1  ON 17
ci_0019                 1.309579e-02 3 1  ON 18
ci_0020                 1.266256e-02 3 1  ON 19
ci_0021                 6.857761e-03 3 1  ON 20
ci_0022                 7.599425e-03 3 1  ON 21
ci_0023                -1.180485e-02 3 1  ON 22
ci_0024                -1.144909e-02 3 1  ON 23
ci_0025                -2.123924e-03 3 1  ON 24
ci_0026                -2.498399e-03 3 1  ON 25
ci_0027                -1.209143e-02 3 1  ON 26
ci_0028                -1.155697e-02 3 1  ON 27
ci_0029                -1.065835e-02 3 1  ON 28
ci_0030                -1.055237e-02 3 1  ON 29
ci_0031                 1.341302e-02 3 1  ON 30
ci_0032                 1.208515e-02 3 1  ON 31
ci_0033                 7.751812e-03 3 1  ON 32
ci_0034                 8.435612e-03 3 1  ON 33
ci_0035                 4.839791e-03 3 1  ON 34
ci_0036                 4.894109e-03 3 1  ON 35
ci_0037                -1.129898e-02 3 1  ON 36
ci_0038                -1.135753e-02 3 1  ON 37
ci_0039                -4.011524e-03 3 1  ON 38
ci_0040                -3.899685e-03 3 1  ON 39
ci_0041                 9.104655e-03 3 1  ON 40
ci_0042                 8.750798e-03 3 1  ON 41
ci_0043                -1.296115e-02 3 1  ON 42
ci_0044                -1.375411e-02 3 1  ON 43
ci_0045                 1.064402e-02 3 1  ON 44
ci_0046                 1.006459e-02 3 1  ON 45
ci_0047                -3.597792e-03 3 1  ON 46
ci_0048                -3.465418e-03 3 1  ON 47
ci_0049                -2.561449e-03 3 1  ON 48
ci_0050                -2.703936e-03 3 1  ON 49
ci_0051                -1.761507e-03 3 1  ON 50
ci_0052                -2.049509e-03 3 1  ON 51
ci_0053                -3.941254e-03 3 1  ON 52
ci_0054                -3.292703e-03 3 1  ON 53
ci_0055                 2.458522e-03 3 1  ON 54
ci_0056                 2.218424e-03 3 1  ON 55
ci_0057                 2.451648e-03 3 1  ON 56
ci_0058                 2.921118e-03 3 1  ON 57
ci_0059                -3.418815e-03 3 1  ON 58
ci_0060                -3.382011e-03 3 1  ON 59
ci_0061                -4.022486e-03 3 1  ON 60
ci_0062                -3.924137e-03 3 1  ON 61
ci_0063                -9.784224e-03 3 1  ON 62
ci_0064                -9.359191e-03 3 1  ON 63
ci_0065                -6.436742e-03 3 1  ON 64
ci_0066                -6.104527e-03 3 1  ON 65
ci_0067                -3.727987e-03 3 1  ON 66
ci_0068                -3.467580e-03 3 1  ON 67
ci_0069                 3.623177e-03 3 1  ON 68
ci_0070                 3.325213e-03 3 1  ON 69
ci_0071                 2.982945e-03 3 1  ON 70
ci_0072                 3.464145e-03 3 1  ON 71
ci_0073                 3.540744e-03 3 1  ON 72
ci_0074                 3.540982e-03 3 1  ON 73
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 4.0398e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s038 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s038 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=38  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6905e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 38
    time step          = 0.05
    reference energy   = -16.9066
    reference variance = 0.170435
====================================================
  Execution time = 1.4276e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s038
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5204e+04
  VMC Eavg = -1.6900e+01
  VMC Evar = 2.9219e-01
  Total weights = 1.951113248e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 2.5944e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.283295286023
                                         uncertainty =       0.001749769640

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.283295286023
                                         uncertainty =       0.001749769640

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000376345265
  error estimate for blocks of size 2^( 2) =       0.000392670508
  error estimate for blocks of size 2^( 3) =       0.000409743937
  error estimate for blocks of size 2^( 4) =       0.000424722200
  error estimate for blocks of size 2^( 5) =       0.000435480996
  error estimate for blocks of size 2^( 6) =       0.000443460806
  error estimate for blocks of size 2^( 7) =       0.000445589936

      target function =      -0.924958770799
              le_mean =     -16.899814054124
             les_mean =     285.895904591092
             stat err =       0.000437313484
             autocorr =       1.350245770802
   target nu stat err =       0.000437313484
   target dn stat err =       0.002204678500
      target stat err =       0.003545235415
              std dev =       0.532232577602
             le_variance =       0.283271516661


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.689981405412e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 74
Check correct_vf_var_size: 225, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 3.7253e+00, overlap shift 3.7253e+01 and omega -1.7444e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.924970999706       residual = 4.47e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.924976343013       residual = 6.92e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.924977196766       residual = 2.67e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.924977652591       residual = 1.19e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.924977901741       residual = 5.15e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.924977894490       residual = 4.18e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.924977954987       residual = 9.78e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.924977938375       residual = 4.65e-06           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.924977975690       residual = 4.55e-06           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.924977998980       residual = 4.28e-06           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.924977994048       residual = 2.98e-06           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.924977999274       residual = 1.83e-06           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.924978003580       residual = 7.84e-07           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.924978022700       residual = 1.82e-07           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.924978022091       residual = 6.69e-08           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.924978021682       residual = 1.73e-08           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.924978023598       residual = 4.17e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         16 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 3.7253e+00 is 4.267491e-05

solving harmonic davidson linear method for identity shift 1.4901e+01, overlap shift 1.4901e+02 and omega -1.7444e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.924970999706       residual = 4.47e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.924972356287       residual = 6.90e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.924972572338       residual = 2.65e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.924972687056       residual = 1.18e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.924972749624       residual = 5.08e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.924972747673       residual = 4.10e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.924972762756       residual = 9.54e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.924972758556       residual = 4.57e-06           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.924972767938       residual = 4.47e-06           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.924972773727       residual = 4.18e-06           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.924972772464       residual = 2.87e-06           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.924972773759       residual = 1.74e-06           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.924972774834       residual = 7.30e-07           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.924972779491       residual = 1.68e-07           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.924972779337       residual = 6.15e-08           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.924972779235       residual = 1.58e-08           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.924972779695       residual = 3.78e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         16 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 1.4901e+01 is 1.075605e-05

solving harmonic davidson linear method for identity shift 5.9605e+01, overlap shift 5.9605e+02 and omega -1.7444e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.924970999706       residual = 4.47e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.924971340174       residual = 6.90e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.924971394353       residual = 2.64e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.924971423080       residual = 1.18e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.924971438739       residual = 5.06e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.924971438242       residual = 4.08e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.924971442010       residual = 9.49e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.924971440957       residual = 4.55e-06           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.924971443306       residual = 4.45e-06           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.924971444751       residual = 4.15e-06           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.924971444434       residual = 2.84e-06           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.924971444757       residual = 1.72e-06           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.924971445026       residual = 7.17e-07           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.924971446182       residual = 1.65e-07           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.924971446144       residual = 6.02e-08           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.924971446118       residual = 1.54e-08           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.924971446232       residual = 3.69e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         16 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 5.9605e+01 is 2.694531e-06

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.518987 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 75 and numParams is: 74

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.6895e+01
  </log>
  <optVariables href="H2O.s038.opt.xml">
ci_0001                 7.085591e-01 3 1  ON 0
ci_0002                 6.927889e-01 3 1  ON 1
ci_0003                -3.102225e-02 3 1  ON 2
ci_0004                -3.012706e-02 3 1  ON 3
ci_0005                -3.068745e-02 3 1  ON 4
ci_0006                -3.069048e-02 3 1  ON 5
ci_0007                -1.342111e-02 3 1  ON 6
ci_0008                -1.342181e-02 3 1  ON 7
ci_0009                -1.873261e-02 3 1  ON 8
ci_0010                -1.812048e-02 3 1  ON 9
ci_0011                -1.475832e-02 3 1  ON 10
ci_0012                -1.453978e-02 3 1  ON 11
ci_0013                 1.531376e-02 3 1  ON 12
ci_0014                 1.483270e-02 3 1  ON 13
ci_0015                 1.579764e-02 3 1  ON 14
ci_0016                 1.539941e-02 3 1  ON 15
ci_0017                 1.334164e-02 3 1  ON 16
ci_0018                 1.307874e-02 3 1  ON 17
ci_0019                 1.309803e-02 3 1  ON 18
ci_0020                 1.266350e-02 3 1  ON 19
ci_0021                 6.849483e-03 3 1  ON 20
ci_0022                 7.591839e-03 3 1  ON 21
ci_0023                -1.180260e-02 3 1  ON 22
ci_0024                -1.145103e-02 3 1  ON 23
ci_0025                -2.126160e-03 3 1  ON 24
ci_0026                -2.496520e-03 3 1  ON 25
ci_0027                -1.209739e-02 3 1  ON 26
ci_0028                -1.155485e-02 3 1  ON 27
ci_0029                -1.065626e-02 3 1  ON 28
ci_0030                -1.055568e-02 3 1  ON 29
ci_0031                 1.341172e-02 3 1  ON 30
ci_0032                 1.208501e-02 3 1  ON 31
ci_0033                 7.757026e-03 3 1  ON 32
ci_0034                 8.440697e-03 3 1  ON 33
ci_0035                 4.840282e-03 3 1  ON 34
ci_0036                 4.887358e-03 3 1  ON 35
ci_0037                -1.130025e-02 3 1  ON 36
ci_0038                -1.135572e-02 3 1  ON 37
ci_0039                -4.010526e-03 3 1  ON 38
ci_0040                -3.899083e-03 3 1  ON 39
ci_0041                 9.104635e-03 3 1  ON 40
ci_0042                 8.752641e-03 3 1  ON 41
ci_0043                -1.295641e-02 3 1  ON 42
ci_0044                -1.375798e-02 3 1  ON 43
ci_0045                 1.064049e-02 3 1  ON 44
ci_0046                 1.006300e-02 3 1  ON 45
ci_0047                -3.595667e-03 3 1  ON 46
ci_0048                -3.465516e-03 3 1  ON 47
ci_0049                -2.557889e-03 3 1  ON 48
ci_0050                -2.703117e-03 3 1  ON 49
ci_0051                -1.762336e-03 3 1  ON 50
ci_0052                -2.047596e-03 3 1  ON 51
ci_0053                -3.936514e-03 3 1  ON 52
ci_0054                -3.295113e-03 3 1  ON 53
ci_0055                 2.456981e-03 3 1  ON 54
ci_0056                 2.214870e-03 3 1  ON 55
ci_0057                 2.444828e-03 3 1  ON 56
ci_0058                 2.917995e-03 3 1  ON 57
ci_0059                -3.419900e-03 3 1  ON 58
ci_0060                -3.378105e-03 3 1  ON 59
ci_0061                -4.020525e-03 3 1  ON 60
ci_0062                -3.920509e-03 3 1  ON 61
ci_0063                -9.783351e-03 3 1  ON 62
ci_0064                -9.361344e-03 3 1  ON 63
ci_0065                -6.438793e-03 3 1  ON 64
ci_0066                -6.104669e-03 3 1  ON 65
ci_0067                -3.729639e-03 3 1  ON 66
ci_0068                -3.465621e-03 3 1  ON 67
ci_0069                 3.624989e-03 3 1  ON 68
ci_0070                 3.325702e-03 3 1  ON 69
ci_0071                 2.983587e-03 3 1  ON 70
ci_0072                 3.465606e-03 3 1  ON 71
ci_0073                 3.538366e-03 3 1  ON 72
ci_0074                 3.539886e-03 3 1  ON 73
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 38
    time step          = 0.05
    reference energy   = -16.855
    reference variance = 0.342035
====================================================
  Execution time = 1.3996e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s038
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6899e+01
  VMC Evar = 2.8899e-01
  Total weights = 1.9513e+06
  Execution time = 1.8689e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.280378057979
                                         uncertainty =       0.001796614115

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.280378057979
                                         uncertainty =       0.001796614115

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000374451403
  error estimate for blocks of size 2^( 2) =       0.000391272345
  error estimate for blocks of size 2^( 3) =       0.000408706528
  error estimate for blocks of size 2^( 4) =       0.000424078882
  error estimate for blocks of size 2^( 5) =       0.000434612409
  error estimate for blocks of size 2^( 6) =       0.000443660572
  error estimate for blocks of size 2^( 7) =       0.000447484081

      target function =      -0.929991857925
              le_mean =     -16.898971729043
             les_mean =     285.864240108342
             stat err =       0.000437458986
             autocorr =       1.364846341432
   target nu stat err =       0.000437458986
   target dn stat err =       0.002128490455
      target stat err =       0.003459425569
              std dev =       0.529554252037
             le_variance =       0.280427705851

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.280372172003
                                         uncertainty =       0.001796523619

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.280372172003
                                         uncertainty =       0.001796523619

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000374447520
  error estimate for blocks of size 2^( 2) =       0.000391269123
  error estimate for blocks of size 2^( 3) =       0.000408704347
  error estimate for blocks of size 2^( 4) =       0.000424077569
  error estimate for blocks of size 2^( 5) =       0.000434611911
  error estimate for blocks of size 2^( 6) =       0.000443660983
  error estimate for blocks of size 2^( 7) =       0.000447484824

      target function =      -0.930010582205
              le_mean =     -16.898972142081
             les_mean =     285.864242298607
             stat err =       0.000437458822
             autocorr =       1.364873626115
   target nu stat err =       0.000437458822
   target dn stat err =       0.002125342962
      target stat err =       0.003454686628
              std dev =       0.529548760743
             le_variance =       0.280421890004

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.280375032415
                                         uncertainty =       0.001796566591

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.280375032415
                                         uncertainty =       0.001796566591

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000374449406
  error estimate for blocks of size 2^( 2) =       0.000391270686
  error estimate for blocks of size 2^( 3) =       0.000408705398
  error estimate for blocks of size 2^( 4) =       0.000424078195
  error estimate for blocks of size 2^( 5) =       0.000434612137
  error estimate for blocks of size 2^( 6) =       0.000443660761
  error estimate for blocks of size 2^( 7) =       0.000447484436

      target function =      -0.930001815844
              le_mean =     -16.898971933832
             les_mean =     285.864240770349
             stat err =       0.000437458882
             autocorr =       1.364860249307
   target nu stat err =       0.000437458882
   target dn stat err =       0.002126801848
      target stat err =       0.003456882422
              std dev =       0.529551428919
             le_variance =       0.280424715870

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.280377673840
                                         uncertainty =       0.001796608019

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.280377673840
                                         uncertainty =       0.001796608019

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000374451149
  error estimate for blocks of size 2^( 2) =       0.000391272134
  error estimate for blocks of size 2^( 3) =       0.000408706383
  error estimate for blocks of size 2^( 4) =       0.000424078793
  error estimate for blocks of size 2^( 5) =       0.000434612372
  error estimate for blocks of size 2^( 6) =       0.000443660593
  error estimate for blocks of size 2^( 7) =       0.000447484123

      target function =      -0.929993202099
              le_mean =     -16.898971754245
             les_mean =     285.864240115127
             stat err =       0.000437458970
             autocorr =       1.364848091858
   target nu stat err =       0.000437458970
   target dn stat err =       0.002128266615
      target stat err =       0.003459088615
              std dev =       0.529553893554
             le_variance =       0.280427326178


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.929991857925        initial
     3.7253e+00     3.7253e+01             4.2675e-05        -0.930010582205  <--
     1.4901e+01     1.4901e+02             1.0756e-05        -0.930001815844
     5.9605e+01     5.9605e+02             2.6945e-06        -0.929993202099

*****************************************************************************
Applying the update for shift_i =   3.7253e+00     and shift_s =   3.7253e+01
*****************************************************************************

  Execution time = 2.3477e+01
  </log>
  <optVariables href="H2O.s038.opt.xml">
ci_0001                 7.085294e-01 3 1  ON 0
ci_0002                 6.928206e-01 3 1  ON 1
ci_0003                -3.101894e-02 3 1  ON 2
ci_0004                -3.013431e-02 3 1  ON 3
ci_0005                -3.067654e-02 3 1  ON 4
ci_0006                -3.070015e-02 3 1  ON 5
ci_0007                -1.342548e-02 3 1  ON 6
ci_0008                -1.338989e-02 3 1  ON 7
ci_0009                -1.873900e-02 3 1  ON 8
ci_0010                -1.812597e-02 3 1  ON 9
ci_0011                -1.476128e-02 3 1  ON 10
ci_0012                -1.452693e-02 3 1  ON 11
ci_0013                 1.530971e-02 3 1  ON 12
ci_0014                 1.483424e-02 3 1  ON 13
ci_0015                 1.578432e-02 3 1  ON 14
ci_0016                 1.539194e-02 3 1  ON 15
ci_0017                 1.333043e-02 3 1  ON 16
ci_0018                 1.308896e-02 3 1  ON 17
ci_0019                 1.310465e-02 3 1  ON 18
ci_0020                 1.266630e-02 3 1  ON 19
ci_0021                 6.824891e-03 3 1  ON 20
ci_0022                 7.569339e-03 3 1  ON 21
ci_0023                -1.179596e-02 3 1  ON 22
ci_0024                -1.145677e-02 3 1  ON 23
ci_0025                -2.132730e-03 3 1  ON 24
ci_0026                -2.490998e-03 3 1  ON 25
ci_0027                -1.211495e-02 3 1  ON 26
ci_0028                -1.154862e-02 3 1  ON 27
ci_0029                -1.065010e-02 3 1  ON 28
ci_0030                -1.056544e-02 3 1  ON 29
ci_0031                 1.340783e-02 3 1  ON 30
ci_0032                 1.208457e-02 3 1  ON 31
ci_0033                 7.772440e-03 3 1  ON 32
ci_0034                 8.455767e-03 3 1  ON 33
ci_0035                 4.841711e-03 3 1  ON 34
ci_0036                 4.867533e-03 3 1  ON 35
ci_0037                -1.130401e-02 3 1  ON 36
ci_0038                -1.135038e-02 3 1  ON 37
ci_0039                -4.007590e-03 3 1  ON 38
ci_0040                -3.897318e-03 3 1  ON 39
ci_0041                 9.104567e-03 3 1  ON 40
ci_0042                 8.758094e-03 3 1  ON 41
ci_0043                -1.294232e-02 3 1  ON 42
ci_0044                -1.376944e-02 3 1  ON 43
ci_0045                 1.063005e-02 3 1  ON 44
ci_0046                 1.005831e-02 3 1  ON 45
ci_0047                -3.589414e-03 3 1  ON 46
ci_0048                -3.465809e-03 3 1  ON 47
ci_0049                -2.547427e-03 3 1  ON 48
ci_0050                -2.700713e-03 3 1  ON 49
ci_0051                -1.764766e-03 3 1  ON 50
ci_0052                -2.041985e-03 3 1  ON 51
ci_0053                -3.922584e-03 3 1  ON 52
ci_0054                -3.302202e-03 3 1  ON 53
ci_0055                 2.452453e-03 3 1  ON 54
ci_0056                 2.204431e-03 3 1  ON 55
ci_0057                 2.424785e-03 3 1  ON 56
ci_0058                 2.908821e-03 3 1  ON 57
ci_0059                -3.423088e-03 3 1  ON 58
ci_0060                -3.366631e-03 3 1  ON 59
ci_0061                -4.014739e-03 3 1  ON 60
ci_0062                -3.909816e-03 3 1  ON 61
ci_0063                -9.780767e-03 3 1  ON 62
ci_0064                -9.367697e-03 3 1  ON 63
ci_0065                -6.444838e-03 3 1  ON 64
ci_0066                -6.105090e-03 3 1  ON 65
ci_0067                -3.734492e-03 3 1  ON 66
ci_0068                -3.459869e-03 3 1  ON 67
ci_0069                 3.630309e-03 3 1  ON 68
ci_0070                 3.327142e-03 3 1  ON 69
ci_0071                 2.985469e-03 3 1  ON 70
ci_0072                 3.469903e-03 3 1  ON 71
ci_0073                 3.531376e-03 3 1  ON 72
ci_0074                 3.536672e-03 3 1  ON 73
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 4.0388e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s039 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s039 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=39  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6905e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 39
    time step          = 0.05
    reference energy   = -16.8533
    reference variance = 0.172941
====================================================
  Execution time = 1.4524e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s039
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5280e+04
  VMC Eavg = -1.6899e+01
  VMC Evar = 2.9334e-01
  Total weights = 1.951193508e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 2.6083e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.283564707808
                                         uncertainty =       0.002016481913

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.283564707808
                                         uncertainty =       0.002016481913

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000376521463
  error estimate for blocks of size 2^( 2) =       0.000393289249
  error estimate for blocks of size 2^( 3) =       0.000410488638
  error estimate for blocks of size 2^( 4) =       0.000426536250
  error estimate for blocks of size 2^( 5) =       0.000439129532
  error estimate for blocks of size 2^( 6) =       0.000448038084
  error estimate for blocks of size 2^( 7) =       0.000451117583

      target function =      -0.923138168848
              le_mean =     -16.898801254048
             les_mean =     285.862824578484
             stat err =       0.000441205363
             autocorr =       1.373099756256
   target nu stat err =       0.000441205363
   target dn stat err =       0.002561904267
      target stat err =       0.004073908974
              std dev =       0.532481759361
             le_variance =       0.283536824052


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.689880125405e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 74
Check correct_vf_var_size: 225, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 9.3132e-01, overlap shift 9.3132e+00 and omega -1.7444e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.923154819492       residual = 1.60e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.923213026112       residual = 2.07e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.923221703264       residual = 4.30e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.923225247394       residual = 1.71e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.923227415029       residual = 7.85e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.923228131797       residual = 5.89e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.923228370275       residual = 2.43e-05           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.923228568097       residual = 1.08e-05           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.923228697231       residual = 1.04e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.923228817775       residual = 1.08e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.923228927766       residual = 8.46e-06           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.923228807655       residual = 4.08e-06           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.923228822416       residual = 1.77e-06           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.923228882368       residual = 6.63e-07           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.923228914561       residual = 1.53e-07           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.923228928349       residual = 8.07e-08           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.923228930537       residual = 1.05e-08           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.923228928221       residual = 2.61e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         17 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 9.3132e-01 is 2.519008e-04

solving harmonic davidson linear method for identity shift 3.7253e+00, overlap shift 3.7253e+01 and omega -1.7444e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.923154819492       residual = 1.60e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.923170287414       residual = 2.06e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.923172572203       residual = 4.21e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.923173487396       residual = 1.65e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.923174041228       residual = 7.49e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.923174221472       residual = 5.48e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.923174277428       residual = 2.25e-05           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.923174326620       residual = 1.01e-05           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.923174358733       residual = 9.83e-06           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.923174386850       residual = 9.92e-06           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.923174412917       residual = 7.36e-06           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.923174382846       residual = 3.28e-06           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.923174386597       residual = 1.37e-06           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.923174400578       residual = 4.92e-07           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.923174407989       residual = 1.11e-07           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.923174410920       residual = 5.58e-08           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.923174411266       residual = 7.11e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         16 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 3.7253e+00 is 6.309393e-05

solving harmonic davidson linear method for identity shift 1.4901e+01, overlap shift 1.4901e+02 and omega -1.7444e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.923154819492       residual = 1.60e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.923158748314       residual = 2.05e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.923159327207       residual = 4.18e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.923159557873       residual = 1.63e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.923159697070       residual = 7.39e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.923159742176       residual = 5.37e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.923159755914       residual = 2.20e-05           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.923159768192       residual = 9.94e-06           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.923159776207       residual = 9.68e-06           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.923159783094       residual = 9.70e-06           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.923159789513       residual = 7.09e-06           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.923159782007       residual = 3.09e-06           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.923159782948       residual = 1.28e-06           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.923159786379       residual = 4.54e-07           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.923159788191       residual = 1.02e-07           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.923159788892       residual = 5.06e-08           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.923159788967       residual = 6.42e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         16 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 1.4901e+01 is 1.578206e-05

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.535501 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 75 and numParams is: 74

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.7158e+01
  </log>
  <optVariables href="H2O.s039.opt.xml">
ci_0001                 7.084676e-01 3 1  ON 0
ci_0002                 6.928837e-01 3 1  ON 1
ci_0003                -3.102282e-02 3 1  ON 2
ci_0004                -3.012833e-02 3 1  ON 3
ci_0005                -3.069274e-02 3 1  ON 4
ci_0006                -3.068918e-02 3 1  ON 5
ci_0007                -1.343329e-02 3 1  ON 6
ci_0008                -1.335487e-02 3 1  ON 7
ci_0009                -1.872083e-02 3 1  ON 8
ci_0010                -1.812582e-02 3 1  ON 9
ci_0011                -1.474480e-02 3 1  ON 10
ci_0012                -1.452547e-02 3 1  ON 11
ci_0013                 1.530482e-02 3 1  ON 12
ci_0014                 1.483158e-02 3 1  ON 13
ci_0015                 1.577289e-02 3 1  ON 14
ci_0016                 1.540202e-02 3 1  ON 15
ci_0017                 1.335473e-02 3 1  ON 16
ci_0018                 1.308562e-02 3 1  ON 17
ci_0019                 1.309821e-02 3 1  ON 18
ci_0020                 1.266417e-02 3 1  ON 19
ci_0021                 6.833763e-03 3 1  ON 20
ci_0022                 7.517785e-03 3 1  ON 21
ci_0023                -1.179216e-02 3 1  ON 22
ci_0024                -1.144740e-02 3 1  ON 23
ci_0025                -2.083767e-03 3 1  ON 24
ci_0026                -2.449026e-03 3 1  ON 25
ci_0027                -1.211549e-02 3 1  ON 26
ci_0028                -1.157080e-02 3 1  ON 27
ci_0029                -1.066279e-02 3 1  ON 28
ci_0030                -1.057982e-02 3 1  ON 29
ci_0031                 1.341209e-02 3 1  ON 30
ci_0032                 1.208412e-02 3 1  ON 31
ci_0033                 7.781208e-03 3 1  ON 32
ci_0034                 8.490650e-03 3 1  ON 33
ci_0035                 4.865737e-03 3 1  ON 34
ci_0036                 4.894284e-03 3 1  ON 35
ci_0037                -1.132193e-02 3 1  ON 36
ci_0038                -1.133505e-02 3 1  ON 37
ci_0039                -4.006920e-03 3 1  ON 38
ci_0040                -3.895694e-03 3 1  ON 39
ci_0041                 9.111813e-03 3 1  ON 40
ci_0042                 8.757075e-03 3 1  ON 41
ci_0043                -1.297443e-02 3 1  ON 42
ci_0044                -1.375355e-02 3 1  ON 43
ci_0045                 1.061687e-02 3 1  ON 44
ci_0046                 1.007601e-02 3 1  ON 45
ci_0047                -3.590056e-03 3 1  ON 46
ci_0048                -3.460737e-03 3 1  ON 47
ci_0049                -2.547968e-03 3 1  ON 48
ci_0050                -2.707583e-03 3 1  ON 49
ci_0051                -1.791208e-03 3 1  ON 50
ci_0052                -2.029127e-03 3 1  ON 51
ci_0053                -3.933077e-03 3 1  ON 52
ci_0054                -3.317308e-03 3 1  ON 53
ci_0055                 2.462575e-03 3 1  ON 54
ci_0056                 2.244216e-03 3 1  ON 55
ci_0057                 2.444938e-03 3 1  ON 56
ci_0058                 2.907138e-03 3 1  ON 57
ci_0059                -3.430589e-03 3 1  ON 58
ci_0060                -3.369754e-03 3 1  ON 59
ci_0061                -3.999209e-03 3 1  ON 60
ci_0062                -3.908977e-03 3 1  ON 61
ci_0063                -9.784297e-03 3 1  ON 62
ci_0064                -9.367784e-03 3 1  ON 63
ci_0065                -6.434728e-03 3 1  ON 64
ci_0066                -6.108872e-03 3 1  ON 65
ci_0067                -3.723775e-03 3 1  ON 66
ci_0068                -3.474003e-03 3 1  ON 67
ci_0069                 3.605310e-03 3 1  ON 68
ci_0070                 3.336766e-03 3 1  ON 69
ci_0071                 2.979102e-03 3 1  ON 70
ci_0072                 3.461224e-03 3 1  ON 71
ci_0073                 3.536949e-03 3 1  ON 72
ci_0074                 3.518706e-03 3 1  ON 73
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 39
    time step          = 0.05
    reference energy   = -16.9051
    reference variance = 0.233337
====================================================
  Execution time = 1.3956e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s039
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6897e+01
  VMC Evar = 2.9372e-01
  Total weights = 1.9513e+06
  Execution time = 1.8658e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.283322978812
                                         uncertainty =       0.002362339338

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.283322978812
                                         uncertainty =       0.002362339338

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000376328729
  error estimate for blocks of size 2^( 2) =       0.000393098255
  error estimate for blocks of size 2^( 3) =       0.000410519077
  error estimate for blocks of size 2^( 4) =       0.000425933049
  error estimate for blocks of size 2^( 5) =       0.000436913570
  error estimate for blocks of size 2^( 6) =       0.000443964982
  error estimate for blocks of size 2^( 7) =       0.000449810206

      target function =      -0.922394179703
              le_mean =     -16.897225743713
             les_mean =     285.810037751059
             stat err =       0.000439155452
             autocorr =       1.361763873701
   target nu stat err =       0.000439155452
   target dn stat err =       0.003103281050
      target stat err =       0.004885876335
              std dev =       0.532209192950
             le_variance =       0.283246625060

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.283306946680
                                         uncertainty =       0.002348862338

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.283306946680
                                         uncertainty =       0.002348862338

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000376318113
  error estimate for blocks of size 2^( 2) =       0.000393081202
  error estimate for blocks of size 2^( 3) =       0.000410495048
  error estimate for blocks of size 2^( 4) =       0.000425899346
  error estimate for blocks of size 2^( 5) =       0.000436875566
  error estimate for blocks of size 2^( 6) =       0.000443918613
  error estimate for blocks of size 2^( 7) =       0.000449757544

      target function =      -0.922426462376
              le_mean =     -16.897226101323
             les_mean =     285.810029459932
             stat err =       0.000439112767
             autocorr =       1.361575986951
   target nu stat err =       0.000439112767
   target dn stat err =       0.003067960293
      target stat err =       0.004831875922
              std dev =       0.532194179531
             le_variance =       0.283230644727

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.283313301976
                                         uncertainty =       0.002355234280

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.283313301976
                                         uncertainty =       0.002355234280

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000376322319
  error estimate for blocks of size 2^( 2) =       0.000393088441
  error estimate for blocks of size 2^( 3) =       0.000410505620
  error estimate for blocks of size 2^( 4) =       0.000425914563
  error estimate for blocks of size 2^( 5) =       0.000436892768
  error estimate for blocks of size 2^( 6) =       0.000443939863
  error estimate for blocks of size 2^( 7) =       0.000449781772

      target function =      -0.922574233803
              le_mean =     -16.897225793227
             les_mean =     285.809923972229
             stat err =       0.000439132241
             autocorr =       1.361666323926
   target nu stat err =       0.000439132241
   target dn stat err =       0.003081010355
      target stat err =       0.004853486842
              std dev =       0.532200126927
             le_variance =       0.283236975102

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.283321582581
                                         uncertainty =       0.002361432161

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.283321582581
                                         uncertainty =       0.002361432161

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000376327804
  error estimate for blocks of size 2^( 2) =       0.000393096897
  error estimate for blocks of size 2^( 3) =       0.000410517261
  error estimate for blocks of size 2^( 4) =       0.000425930601
  error estimate for blocks of size 2^( 5) =       0.000436910830
  error estimate for blocks of size 2^( 6) =       0.000443961703
  error estimate for blocks of size 2^( 7) =       0.000449806514

      target function =      -0.922432581193
              le_mean =     -16.897225732149
             les_mean =     285.810012719153
             stat err =       0.000439152412
             autocorr =       1.361751717491
   target nu stat err =       0.000439152412
   target dn stat err =       0.003099864921
      target stat err =       0.004881022202
              std dev =       0.532207884488
             le_variance =       0.283245232311


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.922394179703        initial
     9.3132e-01     9.3132e+00             2.5190e-04        -0.922426462376
     3.7253e+00     3.7253e+01             6.3094e-05        -0.922574233803  <--
     1.4901e+01     1.4901e+02             1.5782e-05        -0.922432581193

*****************************************************************************
Applying the update for shift_i =   3.7253e+00     and shift_s =   3.7253e+01
*****************************************************************************

  Execution time = 2.3408e+01
  </log>
  <optVariables href="H2O.s039.opt.xml">
ci_0001                 7.084676e-01 3 1  ON 0
ci_0002                 6.928837e-01 3 1  ON 1
ci_0003                -3.102282e-02 3 1  ON 2
ci_0004                -3.012833e-02 3 1  ON 3
ci_0005                -3.069274e-02 3 1  ON 4
ci_0006                -3.068918e-02 3 1  ON 5
ci_0007                -1.343329e-02 3 1  ON 6
ci_0008                -1.335487e-02 3 1  ON 7
ci_0009                -1.872083e-02 3 1  ON 8
ci_0010                -1.812582e-02 3 1  ON 9
ci_0011                -1.474480e-02 3 1  ON 10
ci_0012                -1.452547e-02 3 1  ON 11
ci_0013                 1.530482e-02 3 1  ON 12
ci_0014                 1.483158e-02 3 1  ON 13
ci_0015                 1.577289e-02 3 1  ON 14
ci_0016                 1.540202e-02 3 1  ON 15
ci_0017                 1.335473e-02 3 1  ON 16
ci_0018                 1.308562e-02 3 1  ON 17
ci_0019                 1.309821e-02 3 1  ON 18
ci_0020                 1.266417e-02 3 1  ON 19
ci_0021                 6.833763e-03 3 1  ON 20
ci_0022                 7.517785e-03 3 1  ON 21
ci_0023                -1.179216e-02 3 1  ON 22
ci_0024                -1.144740e-02 3 1  ON 23
ci_0025                -2.083767e-03 3 1  ON 24
ci_0026                -2.449026e-03 3 1  ON 25
ci_0027                -1.211549e-02 3 1  ON 26
ci_0028                -1.157080e-02 3 1  ON 27
ci_0029                -1.066279e-02 3 1  ON 28
ci_0030                -1.057982e-02 3 1  ON 29
ci_0031                 1.341209e-02 3 1  ON 30
ci_0032                 1.208412e-02 3 1  ON 31
ci_0033                 7.781208e-03 3 1  ON 32
ci_0034                 8.490650e-03 3 1  ON 33
ci_0035                 4.865737e-03 3 1  ON 34
ci_0036                 4.894284e-03 3 1  ON 35
ci_0037                -1.132193e-02 3 1  ON 36
ci_0038                -1.133505e-02 3 1  ON 37
ci_0039                -4.006920e-03 3 1  ON 38
ci_0040                -3.895694e-03 3 1  ON 39
ci_0041                 9.111813e-03 3 1  ON 40
ci_0042                 8.757075e-03 3 1  ON 41
ci_0043                -1.297443e-02 3 1  ON 42
ci_0044                -1.375355e-02 3 1  ON 43
ci_0045                 1.061687e-02 3 1  ON 44
ci_0046                 1.007601e-02 3 1  ON 45
ci_0047                -3.590056e-03 3 1  ON 46
ci_0048                -3.460737e-03 3 1  ON 47
ci_0049                -2.547968e-03 3 1  ON 48
ci_0050                -2.707583e-03 3 1  ON 49
ci_0051                -1.791208e-03 3 1  ON 50
ci_0052                -2.029127e-03 3 1  ON 51
ci_0053                -3.933077e-03 3 1  ON 52
ci_0054                -3.317308e-03 3 1  ON 53
ci_0055                 2.462575e-03 3 1  ON 54
ci_0056                 2.244216e-03 3 1  ON 55
ci_0057                 2.444938e-03 3 1  ON 56
ci_0058                 2.907138e-03 3 1  ON 57
ci_0059                -3.430589e-03 3 1  ON 58
ci_0060                -3.369754e-03 3 1  ON 59
ci_0061                -3.999209e-03 3 1  ON 60
ci_0062                -3.908977e-03 3 1  ON 61
ci_0063                -9.784297e-03 3 1  ON 62
ci_0064                -9.367784e-03 3 1  ON 63
ci_0065                -6.434728e-03 3 1  ON 64
ci_0066                -6.108872e-03 3 1  ON 65
ci_0067                -3.723775e-03 3 1  ON 66
ci_0068                -3.474003e-03 3 1  ON 67
ci_0069                 3.605310e-03 3 1  ON 68
ci_0070                 3.336766e-03 3 1  ON 69
ci_0071                 2.979102e-03 3 1  ON 70
ci_0072                 3.461224e-03 3 1  ON 71
ci_0073                 3.536949e-03 3 1  ON 72
ci_0074                 3.518706e-03 3 1  ON 73
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 4.0583e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s040 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s040 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=40  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6904e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 40
    time step          = 0.05
    reference energy   = -16.8617
    reference variance = 0.168558
====================================================
  Execution time = 1.4282e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s040
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5247e+04
  VMC Eavg = -1.6899e+01
  VMC Evar = 2.9517e-01
  Total weights = 1.951212443e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 2.6386e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.284567633110
                                         uncertainty =       0.001838773912

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.284567633110
                                         uncertainty =       0.001838773912

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000377265197
  error estimate for blocks of size 2^( 2) =       0.000394115621
  error estimate for blocks of size 2^( 3) =       0.000411599265
  error estimate for blocks of size 2^( 4) =       0.000426369373
  error estimate for blocks of size 2^( 5) =       0.000438359386
  error estimate for blocks of size 2^( 6) =       0.000447559032
  error estimate for blocks of size 2^( 7) =       0.000452145195

      target function =      -0.920285985131
              le_mean =     -16.899278981991
             les_mean =     285.880803159204
             stat err =       0.000441108246
             autocorr =       1.367089246906
   target nu stat err =       0.000441108246
   target dn stat err =       0.002504058431
      target stat err =       0.003964336299
              std dev =       0.533533558511
             le_variance =       0.284658058057


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.689927898199e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 74
Check correct_vf_var_size: 225, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 9.3132e-01, overlap shift 9.3132e+00 and omega -1.7444e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.920301753460       residual = 1.18e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.920354433269       residual = 1.72e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.920361947558       residual = 4.12e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.920364087498       residual = 1.70e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.920365486000       residual = 5.92e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.920365845133       residual = 3.25e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.920365750940       residual = 1.75e-05           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.920365714762       residual = 6.24e-06           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.920365753824       residual = 7.71e-06           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.920365681828       residual = 6.36e-06           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.920365715740       residual = 5.95e-06           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.920365712529       residual = 2.73e-06           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.920365783389       residual = 9.48e-07           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.920365826068       residual = 2.32e-07           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.920365852979       residual = 1.01e-07           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.920365859018       residual = 3.82e-08           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.920365861607       residual = 9.21e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         16 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 9.3132e-01 is 1.990693e-04

solving harmonic davidson linear method for identity shift 3.7253e+00, overlap shift 3.7253e+01 and omega -1.7444e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.920301753460       residual = 1.18e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.920315736885       residual = 1.71e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.920317712647       residual = 4.03e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.920318260924       residual = 1.63e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.920318615831       residual = 5.61e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.920318703818       residual = 2.99e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.920318678476       residual = 1.60e-05           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.920318669026       residual = 5.85e-06           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.920318678989       residual = 7.34e-06           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.920318660977       residual = 5.86e-06           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.920318670211       residual = 5.10e-06           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.920318670163       residual = 2.19e-06           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.920318687226       residual = 7.28e-07           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.920318696917       residual = 1.74e-07           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.920318702953       residual = 7.45e-08           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.920318704150       residual = 2.69e-08           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.920318704717       residual = 6.25e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         16 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 3.7253e+00 is 4.986931e-05

solving harmonic davidson linear method for identity shift 1.4901e+01, overlap shift 1.4901e+02 and omega -1.7444e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.920301753460       residual = 1.18e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.920305304142       residual = 1.70e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.920305804545       residual = 4.00e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.920305942440       residual = 1.62e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.920306031476       residual = 5.53e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.920306053339       residual = 2.92e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.920306046887       residual = 1.56e-05           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.920306044500       residual = 5.76e-06           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.920306047004       residual = 7.24e-06           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.920306042506       residual = 5.74e-06           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.920306044863       residual = 4.89e-06           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.920306044897       residual = 2.07e-06           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.920306049117       residual = 6.79e-07           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.920306051477       residual = 1.61e-07           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.920306052942       residual = 6.86e-08           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.920306053222       residual = 2.45e-08           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.920306053359       residual = 5.63e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         16 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 1.4901e+01 is 1.247376e-05

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.551565 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 75 and numParams is: 74

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.6945e+01
  </log>
  <optVariables href="H2O.s040.opt.xml">
ci_0001                 7.085174e-01 3 1  ON 0
ci_0002                 6.928370e-01 3 1  ON 1
ci_0003                -3.101122e-02 3 1  ON 2
ci_0004                -3.010811e-02 3 1  ON 3
ci_0005                -3.065892e-02 3 1  ON 4
ci_0006                -3.068789e-02 3 1  ON 5
ci_0007                -1.343089e-02 3 1  ON 6
ci_0008                -1.334308e-02 3 1  ON 7
ci_0009                -1.871180e-02 3 1  ON 8
ci_0010                -1.813059e-02 3 1  ON 9
ci_0011                -1.473534e-02 3 1  ON 10
ci_0012                -1.453796e-02 3 1  ON 11
ci_0013                 1.529849e-02 3 1  ON 12
ci_0014                 1.482276e-02 3 1  ON 13
ci_0015                 1.576404e-02 3 1  ON 14
ci_0016                 1.537858e-02 3 1  ON 15
ci_0017                 1.335755e-02 3 1  ON 16
ci_0018                 1.306500e-02 3 1  ON 17
ci_0019                 1.311997e-02 3 1  ON 18
ci_0020                 1.265940e-02 3 1  ON 19
ci_0021                 6.790254e-03 3 1  ON 20
ci_0022                 7.496309e-03 3 1  ON 21
ci_0023                -1.179802e-02 3 1  ON 22
ci_0024                -1.143757e-02 3 1  ON 23
ci_0025                -2.048148e-03 3 1  ON 24
ci_0026                -2.434099e-03 3 1  ON 25
ci_0027                -1.212102e-02 3 1  ON 26
ci_0028                -1.156096e-02 3 1  ON 27
ci_0029                -1.065761e-02 3 1  ON 28
ci_0030                -1.056781e-02 3 1  ON 29
ci_0031                 1.340875e-02 3 1  ON 30
ci_0032                 1.209659e-02 3 1  ON 31
ci_0033                 7.807498e-03 3 1  ON 32
ci_0034                 8.478409e-03 3 1  ON 33
ci_0035                 4.876660e-03 3 1  ON 34
ci_0036                 4.850865e-03 3 1  ON 35
ci_0037                -1.133269e-02 3 1  ON 36
ci_0038                -1.132202e-02 3 1  ON 37
ci_0039                -4.004230e-03 3 1  ON 38
ci_0040                -3.889961e-03 3 1  ON 39
ci_0041                 9.106871e-03 3 1  ON 40
ci_0042                 8.764000e-03 3 1  ON 41
ci_0043                -1.298068e-02 3 1  ON 42
ci_0044                -1.379127e-02 3 1  ON 43
ci_0045                 1.059890e-02 3 1  ON 44
ci_0046                 1.009190e-02 3 1  ON 45
ci_0047                -3.589477e-03 3 1  ON 46
ci_0048                -3.466797e-03 3 1  ON 47
ci_0049                -2.540874e-03 3 1  ON 48
ci_0050                -2.710747e-03 3 1  ON 49
ci_0051                -1.780304e-03 3 1  ON 50
ci_0052                -2.040226e-03 3 1  ON 51
ci_0053                -3.947626e-03 3 1  ON 52
ci_0054                -3.332264e-03 3 1  ON 53
ci_0055                 2.448482e-03 3 1  ON 54
ci_0056                 2.261682e-03 3 1  ON 55
ci_0057                 2.486038e-03 3 1  ON 56
ci_0058                 2.885282e-03 3 1  ON 57
ci_0059                -3.402309e-03 3 1  ON 58
ci_0060                -3.381349e-03 3 1  ON 59
ci_0061                -3.994140e-03 3 1  ON 60
ci_0062                -3.915792e-03 3 1  ON 61
ci_0063                -9.795975e-03 3 1  ON 62
ci_0064                -9.364901e-03 3 1  ON 63
ci_0065                -6.434316e-03 3 1  ON 64
ci_0066                -6.124242e-03 3 1  ON 65
ci_0067                -3.738801e-03 3 1  ON 66
ci_0068                -3.466406e-03 3 1  ON 67
ci_0069                 3.604591e-03 3 1  ON 68
ci_0070                 3.328578e-03 3 1  ON 69
ci_0071                 3.003133e-03 3 1  ON 70
ci_0072                 3.448015e-03 3 1  ON 71
ci_0073                 3.550166e-03 3 1  ON 72
ci_0074                 3.509463e-03 3 1  ON 73
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 40
    time step          = 0.05
    reference energy   = -16.9098
    reference variance = 0.33257
====================================================
  Execution time = 1.6230e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s040
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6899e+01
  VMC Evar = 2.9807e-01
  Total weights = 1.9510e+06
  Execution time = 1.8703e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

ERROR CostFunction-> Number of Effective Walkers is too small! 
  Number of effective walkers (samples) / total number of samples = 0.00266175
  User specified threshold minwalkers = 0.3
  If this message appears frequently. You might have to be cautious. 
  Find info about parameter "minwalkers" in the user manual!
Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.286614962084
                                         uncertainty =       0.002024409822

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.286614962084
                                         uncertainty =       0.002024409822

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000378592316
  error estimate for blocks of size 2^( 2) =       0.000395574913
  error estimate for blocks of size 2^( 3) =       0.000413064638
  error estimate for blocks of size 2^( 4) =       0.000428277753
  error estimate for blocks of size 2^( 5) =       0.000441466210
  error estimate for blocks of size 2^( 6) =       0.000448850689
  error estimate for blocks of size 2^( 7) =       0.000450016470

      target function =      -0.915808486657
              le_mean =     -16.899237071944
             les_mean =     285.882279877312
             stat err =       0.000442152781
             autocorr =       1.363958416083
   target nu stat err =       0.000442152781
   target dn stat err =       0.002578752209
      target stat err =       0.004039554414
              std dev =       0.535410388506
             le_variance =       0.286664284120

ERROR CostFunction-> Number of Effective Walkers is too small! 
  Number of effective walkers (samples) / total number of samples = 0.000179791
  User specified threshold minwalkers = 0.3
  If this message appears frequently. You might have to be cautious. 
  Find info about parameter "minwalkers" in the user manual!
Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.286601243441
                                         uncertainty =       0.002024391670

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.286601243441
                                         uncertainty =       0.002024391670

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000378583133
  error estimate for blocks of size 2^( 2) =       0.000395567830
  error estimate for blocks of size 2^( 3) =       0.000413057865
  error estimate for blocks of size 2^( 4) =       0.000428271940
  error estimate for blocks of size 2^( 5) =       0.000441456157
  error estimate for blocks of size 2^( 6) =       0.000448837137
  error estimate for blocks of size 2^( 7) =       0.000450000321

      target function =      -0.915850540242
              le_mean =     -16.899238953091
             les_mean =     285.882316133949
             stat err =       0.000442141389
             autocorr =       1.363954300007
   target nu stat err =       0.000442141389
   target dn stat err =       0.002579521103
      target stat err =       0.004041093393
              std dev =       0.535397401472
             le_variance =       0.286650377503

ERROR CostFunction-> Number of Effective Walkers is too small! 
  Number of effective walkers (samples) / total number of samples = 0.00269161
  User specified threshold minwalkers = 0.3
  If this message appears frequently. You might have to be cautious. 
  Find info about parameter "minwalkers" in the user manual!
Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.286606502031
                                         uncertainty =       0.002024355384

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.286606502031
                                         uncertainty =       0.002024355384

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000378586663
  error estimate for blocks of size 2^( 2) =       0.000395570418
  error estimate for blocks of size 2^( 3) =       0.000413060337
  error estimate for blocks of size 2^( 4) =       0.000428274022
  error estimate for blocks of size 2^( 5) =       0.000441460355
  error estimate for blocks of size 2^( 6) =       0.000448843067
  error estimate for blocks of size 2^( 7) =       0.000450007462

      target function =      -0.915851291521
              le_mean =     -16.899237945733
             les_mean =     285.882281607497
             stat err =       0.000442146227
             autocorr =       1.363958718315
   target nu stat err =       0.000442146227
   target dn stat err =       0.002578777617
      target stat err =       0.004039968565
              std dev =       0.535402392747
             le_variance =       0.286655722159

ERROR CostFunction-> Number of Effective Walkers is too small! 
  Number of effective walkers (samples) / total number of samples = 0.00738539
  User specified threshold minwalkers = 0.3
  If this message appears frequently. You might have to be cautious. 
  Find info about parameter "minwalkers" in the user manual!
Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.286613744948
                                         uncertainty =       0.002024399330

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.286613744948
                                         uncertainty =       0.002024399330

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000378591504
  error estimate for blocks of size 2^( 2) =       0.000395574250
  error estimate for blocks of size 2^( 3) =       0.000413064001
  error estimate for blocks of size 2^( 4) =       0.000428277194
  error estimate for blocks of size 2^( 5) =       0.000441465395
  error estimate for blocks of size 2^( 6) =       0.000448849657
  error estimate for blocks of size 2^( 7) =       0.000450015258

      target function =      -0.915817240499
              le_mean =     -16.899237168135
             les_mean =     285.882277443229
             stat err =       0.000442151876
             autocorr =       1.363958687407
   target nu stat err =       0.000442151876
   target dn stat err =       0.002578684360
      target stat err =       0.004039528076
              std dev =       0.535409239704
             le_variance =       0.286663053960


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.915808486657        initial
     9.3132e-01     9.3132e+00             1.9907e-04        -0.915850540242
     3.7253e+00     3.7253e+01             4.9869e-05        -0.915851291521  <--
     1.4901e+01     1.4901e+02             1.2474e-05        -0.915817240499

*****************************************************************************
Applying the update for shift_i =   3.7253e+00     and shift_s =   3.7253e+01
*****************************************************************************

  Execution time = 2.5696e+01
  </log>
  <optVariables href="H2O.s040.opt.xml">
ci_0001                 7.085174e-01 3 1  ON 0
ci_0002                 6.928370e-01 3 1  ON 1
ci_0003                -3.101122e-02 3 1  ON 2
ci_0004                -3.010811e-02 3 1  ON 3
ci_0005                -3.065892e-02 3 1  ON 4
ci_0006                -3.068789e-02 3 1  ON 5
ci_0007                -1.343089e-02 3 1  ON 6
ci_0008                -1.334308e-02 3 1  ON 7
ci_0009                -1.871180e-02 3 1  ON 8
ci_0010                -1.813059e-02 3 1  ON 9
ci_0011                -1.473534e-02 3 1  ON 10
ci_0012                -1.453796e-02 3 1  ON 11
ci_0013                 1.529849e-02 3 1  ON 12
ci_0014                 1.482276e-02 3 1  ON 13
ci_0015                 1.576404e-02 3 1  ON 14
ci_0016                 1.537858e-02 3 1  ON 15
ci_0017                 1.335755e-02 3 1  ON 16
ci_0018                 1.306500e-02 3 1  ON 17
ci_0019                 1.311997e-02 3 1  ON 18
ci_0020                 1.265940e-02 3 1  ON 19
ci_0021                 6.790254e-03 3 1  ON 20
ci_0022                 7.496309e-03 3 1  ON 21
ci_0023                -1.179802e-02 3 1  ON 22
ci_0024                -1.143757e-02 3 1  ON 23
ci_0025                -2.048148e-03 3 1  ON 24
ci_0026                -2.434099e-03 3 1  ON 25
ci_0027                -1.212102e-02 3 1  ON 26
ci_0028                -1.156096e-02 3 1  ON 27
ci_0029                -1.065761e-02 3 1  ON 28
ci_0030                -1.056781e-02 3 1  ON 29
ci_0031                 1.340875e-02 3 1  ON 30
ci_0032                 1.209659e-02 3 1  ON 31
ci_0033                 7.807498e-03 3 1  ON 32
ci_0034                 8.478409e-03 3 1  ON 33
ci_0035                 4.876660e-03 3 1  ON 34
ci_0036                 4.850865e-03 3 1  ON 35
ci_0037                -1.133269e-02 3 1  ON 36
ci_0038                -1.132202e-02 3 1  ON 37
ci_0039                -4.004230e-03 3 1  ON 38
ci_0040                -3.889961e-03 3 1  ON 39
ci_0041                 9.106871e-03 3 1  ON 40
ci_0042                 8.764000e-03 3 1  ON 41
ci_0043                -1.298068e-02 3 1  ON 42
ci_0044                -1.379127e-02 3 1  ON 43
ci_0045                 1.059890e-02 3 1  ON 44
ci_0046                 1.009190e-02 3 1  ON 45
ci_0047                -3.589477e-03 3 1  ON 46
ci_0048                -3.466797e-03 3 1  ON 47
ci_0049                -2.540874e-03 3 1  ON 48
ci_0050                -2.710747e-03 3 1  ON 49
ci_0051                -1.780304e-03 3 1  ON 50
ci_0052                -2.040226e-03 3 1  ON 51
ci_0053                -3.947626e-03 3 1  ON 52
ci_0054                -3.332264e-03 3 1  ON 53
ci_0055                 2.448482e-03 3 1  ON 54
ci_0056                 2.261682e-03 3 1  ON 55
ci_0057                 2.486038e-03 3 1  ON 56
ci_0058                 2.885282e-03 3 1  ON 57
ci_0059                -3.402309e-03 3 1  ON 58
ci_0060                -3.381349e-03 3 1  ON 59
ci_0061                -3.994140e-03 3 1  ON 60
ci_0062                -3.915792e-03 3 1  ON 61
ci_0063                -9.795975e-03 3 1  ON 62
ci_0064                -9.364901e-03 3 1  ON 63
ci_0065                -6.434316e-03 3 1  ON 64
ci_0066                -6.124242e-03 3 1  ON 65
ci_0067                -3.738801e-03 3 1  ON 66
ci_0068                -3.466406e-03 3 1  ON 67
ci_0069                 3.604591e-03 3 1  ON 68
ci_0070                 3.328578e-03 3 1  ON 69
ci_0071                 3.003133e-03 3 1  ON 70
ci_0072                 3.448015e-03 3 1  ON 71
ci_0073                 3.550166e-03 3 1  ON 72
ci_0074                 3.509463e-03 3 1  ON 73
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 4.2657e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s041 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s041 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=41  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6904e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 41
    time step          = 0.05
    reference energy   = -16.9478
    reference variance = 0.378785
====================================================
  Execution time = 1.6372e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s041
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5264e+04
  VMC Eavg = -1.6899e+01
  VMC Evar = 2.9817e-01
  Total weights = 1.951023985e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 2.6342e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.285514027992
                                         uncertainty =       0.001712722110

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.285514027992
                                         uncertainty =       0.001712722110

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000377814148
  error estimate for blocks of size 2^( 2) =       0.000394713888
  error estimate for blocks of size 2^( 3) =       0.000412090511
  error estimate for blocks of size 2^( 4) =       0.000427729249
  error estimate for blocks of size 2^( 5) =       0.000438848819
  error estimate for blocks of size 2^( 6) =       0.000445420776
  error estimate for blocks of size 2^( 7) =       0.000448028045

      target function =      -0.915622677101
              le_mean =     -16.899282564765
             les_mean =     285.883922893248
             stat err =       0.000440006722
             autocorr =       1.356320071468
   target nu stat err =       0.000440006722
   target dn stat err =       0.003964378633
      target stat err =       0.006146903919
              std dev =       0.534309892301
             le_variance =       0.285487061011


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.689928256477e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 74
Check correct_vf_var_size: 225, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 9.3132e-01, overlap shift 9.3132e+00 and omega -1.7444e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.915662468704       residual = 2.28e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.915751469772       residual = 3.16e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.915763527000       residual = 5.42e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.915767160283       residual = 2.92e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.915769250168       residual = 9.50e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.915769848450       residual = 7.64e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.915769864110       residual = 2.26e-05           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.915769990348       residual = 8.00e-06           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.915769798524       residual = 9.63e-06           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.915769583592       residual = 1.01e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.915769561147       residual = 6.20e-06           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.915769404315       residual = 3.11e-06           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.915769296541       residual = 1.95e-06           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.915769341767       residual = 4.96e-07           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.915769368762       residual = 1.73e-07           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.915769373766       residual = 5.36e-08           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.915769387318       residual = 1.78e-08           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.915769385565       residual = 6.69e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         17 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 9.3132e-01 is 2.712681e-04

solving harmonic davidson linear method for identity shift 3.7253e+00, overlap shift 3.7253e+01 and omega -1.7444e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.915662468704       residual = 2.28e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.915686105852       residual = 3.13e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.915689283014       residual = 5.32e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.915690217348       residual = 2.82e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.915690748477       residual = 9.05e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.915690897385       residual = 7.08e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.915690897612       residual = 2.07e-05           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.915690927750       residual = 7.58e-06           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.915690875934       residual = 9.42e-06           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.915690821084       residual = 9.27e-06           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.915690816286       residual = 5.39e-06           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.915690778768       residual = 2.60e-06           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.915690754607       residual = 1.56e-06           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.915690766650       residual = 3.65e-07           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.915690772894       residual = 1.26e-07           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.915690774090       residual = 3.91e-08           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.915690777031       residual = 1.26e-08           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.915690776567       residual = 4.62e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         17 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 3.7253e+00 is 7.214739e-05

solving harmonic davidson linear method for identity shift 1.4901e+01, overlap shift 1.4901e+02 and omega -1.7444e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.915662468704       residual = 2.28e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.915668471522       residual = 3.13e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.915669276678       residual = 5.29e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.915669511905       residual = 2.79e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.915669645199       residual = 8.94e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.915669682359       residual = 6.94e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.915669682171       residual = 2.03e-05           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.915669689607       residual = 7.47e-06           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.915669676389       residual = 9.37e-06           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.915669662621       residual = 9.05e-06           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.915669661481       residual = 5.19e-06           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.915669652219       residual = 2.48e-06           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.915669646360       residual = 1.47e-06           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.915669649408       residual = 3.36e-07           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.915669650935       residual = 1.16e-07           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.915669651230       residual = 3.60e-08           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.915669651937       residual = 1.15e-08           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.915669651820       residual = 4.18e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         17 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 1.4901e+01 is 1.832920e-05

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.561735 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 75 and numParams is: 74

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.9021e+01
  </log>
  <optVariables href="H2O.s041.opt.xml">
ci_0001                 7.085752e-01 3 1  ON 0
ci_0002                 6.927791e-01 3 1  ON 1
ci_0003                -3.100516e-02 3 1  ON 2
ci_0004                -3.010348e-02 3 1  ON 3
ci_0005                -3.061090e-02 3 1  ON 4
ci_0006                -3.068975e-02 3 1  ON 5
ci_0007                -1.339208e-02 3 1  ON 6
ci_0008                -1.336466e-02 3 1  ON 7
ci_0009                -1.870192e-02 3 1  ON 8
ci_0010                -1.813119e-02 3 1  ON 9
ci_0011                -1.474470e-02 3 1  ON 10
ci_0012                -1.450995e-02 3 1  ON 11
ci_0013                 1.530277e-02 3 1  ON 12
ci_0014                 1.480310e-02 3 1  ON 13
ci_0015                 1.574738e-02 3 1  ON 14
ci_0016                 1.538680e-02 3 1  ON 15
ci_0017                 1.336718e-02 3 1  ON 16
ci_0018                 1.305024e-02 3 1  ON 17
ci_0019                 1.309317e-02 3 1  ON 18
ci_0020                 1.265981e-02 3 1  ON 19
ci_0021                 6.763310e-03 3 1  ON 20
ci_0022                 7.476636e-03 3 1  ON 21
ci_0023                -1.179577e-02 3 1  ON 22
ci_0024                -1.145823e-02 3 1  ON 23
ci_0025                -2.030852e-03 3 1  ON 24
ci_0026                -2.420346e-03 3 1  ON 25
ci_0027                -1.212617e-02 3 1  ON 26
ci_0028                -1.156216e-02 3 1  ON 27
ci_0029                -1.065947e-02 3 1  ON 28
ci_0030                -1.058584e-02 3 1  ON 29
ci_0031                 1.341053e-02 3 1  ON 30
ci_0032                 1.211902e-02 3 1  ON 31
ci_0033                 7.862099e-03 3 1  ON 32
ci_0034                 8.488991e-03 3 1  ON 33
ci_0035                 4.886204e-03 3 1  ON 34
ci_0036                 4.923012e-03 3 1  ON 35
ci_0037                -1.134509e-02 3 1  ON 36
ci_0038                -1.131528e-02 3 1  ON 37
ci_0039                -4.019347e-03 3 1  ON 38
ci_0040                -3.885580e-03 3 1  ON 39
ci_0041                 9.088746e-03 3 1  ON 40
ci_0042                 8.779551e-03 3 1  ON 41
ci_0043                -1.301101e-02 3 1  ON 42
ci_0044                -1.381804e-02 3 1  ON 43
ci_0045                 1.059923e-02 3 1  ON 44
ci_0046                 1.008996e-02 3 1  ON 45
ci_0047                -3.588044e-03 3 1  ON 46
ci_0048                -3.479339e-03 3 1  ON 47
ci_0049                -2.582266e-03 3 1  ON 48
ci_0050                -2.704643e-03 3 1  ON 49
ci_0051                -1.793948e-03 3 1  ON 50
ci_0052                -2.016938e-03 3 1  ON 51
ci_0053                -3.930477e-03 3 1  ON 52
ci_0054                -3.314392e-03 3 1  ON 53
ci_0055                 2.388177e-03 3 1  ON 54
ci_0056                 2.275876e-03 3 1  ON 55
ci_0057                 2.484171e-03 3 1  ON 56
ci_0058                 2.887401e-03 3 1  ON 57
ci_0059                -3.400610e-03 3 1  ON 58
ci_0060                -3.375498e-03 3 1  ON 59
ci_0061                -3.981319e-03 3 1  ON 60
ci_0062                -3.929819e-03 3 1  ON 61
ci_0063                -9.800774e-03 3 1  ON 62
ci_0064                -9.369411e-03 3 1  ON 63
ci_0065                -6.435827e-03 3 1  ON 64
ci_0066                -6.132954e-03 3 1  ON 65
ci_0067                -3.735656e-03 3 1  ON 66
ci_0068                -3.485188e-03 3 1  ON 67
ci_0069                 3.588776e-03 3 1  ON 68
ci_0070                 3.357673e-03 3 1  ON 69
ci_0071                 2.997854e-03 3 1  ON 70
ci_0072                 3.481774e-03 3 1  ON 71
ci_0073                 3.543941e-03 3 1  ON 72
ci_0074                 3.528597e-03 3 1  ON 73
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 41
    time step          = 0.05
    reference energy   = -16.9152
    reference variance = 0.209424
====================================================
  Execution time = 1.4199e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s041
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6899e+01
  VMC Evar = 2.9091e-01
  Total weights = 1.9512e+06
  Execution time = 1.8717e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.281929678018
                                         uncertainty =       0.001629891674

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.281929678018
                                         uncertainty =       0.001629891674

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000375435879
  error estimate for blocks of size 2^( 2) =       0.000392421636
  error estimate for blocks of size 2^( 3) =       0.000409568151
  error estimate for blocks of size 2^( 4) =       0.000424290727
  error estimate for blocks of size 2^( 5) =       0.000435070708
  error estimate for blocks of size 2^( 6) =       0.000440433362
  error estimate for blocks of size 2^( 7) =       0.000444203804

      target function =      -0.926904251435
              le_mean =     -16.898818400020
             les_mean =     285.861008149232
             stat err =       0.000435999650
             autocorr =       1.348654582457
   target nu stat err =       0.000435999650
   target dn stat err =       0.002140735513
      target stat err =       0.003454370779
              std dev =       0.530946512298
             le_variance =       0.281904198922

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.281912653539
                                         uncertainty =       0.001628724445

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.281912653539
                                         uncertainty =       0.001628724445

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000375424379
  error estimate for blocks of size 2^( 2) =       0.000392407151
  error estimate for blocks of size 2^( 3) =       0.000409549766
  error estimate for blocks of size 2^( 4) =       0.000424269570
  error estimate for blocks of size 2^( 5) =       0.000435044281
  error estimate for blocks of size 2^( 6) =       0.000440411708
  error estimate for blocks of size 2^( 7) =       0.000444187581

      target function =      -0.926248709367
              le_mean =     -16.898819088514
             les_mean =     285.861447536543
             stat err =       0.000435978285
             autocorr =       1.348605027752
   target nu stat err =       0.000435978285
   target dn stat err =       0.002160449531
      target stat err =       0.003479904889
              std dev =       0.530930248900
             le_variance =       0.281886929197

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.281919312456
                                         uncertainty =       0.001629260058

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.281919312456
                                         uncertainty =       0.001629260058

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000375428891
  error estimate for blocks of size 2^( 2) =       0.000392413119
  error estimate for blocks of size 2^( 3) =       0.000409557646
  error estimate for blocks of size 2^( 4) =       0.000424278836
  error estimate for blocks of size 2^( 5) =       0.000435056118
  error estimate for blocks of size 2^( 6) =       0.000440421299
  error estimate for blocks of size 2^( 7) =       0.000444194710

      target function =      -0.926998344301
              le_mean =     -16.898818552066
             les_mean =     285.860953634984
             stat err =       0.000435987741
             autocorr =       1.348631115592
   target nu stat err =       0.000435987741
   target dn stat err =       0.002134954623
      target stat err =       0.003446152436
              std dev =       0.530936628691
             le_variance =       0.281893703685

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.281928168626
                                         uncertainty =       0.001629808844

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.281928168626
                                         uncertainty =       0.001629808844

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000375434863
  error estimate for blocks of size 2^( 2) =       0.000392420430
  error estimate for blocks of size 2^( 3) =       0.000409566697
  error estimate for blocks of size 2^( 4) =       0.000424289100
  error estimate for blocks of size 2^( 5) =       0.000435068741
  error estimate for blocks of size 2^( 6) =       0.000440431713
  error estimate for blocks of size 2^( 7) =       0.000444202533

      target function =      -0.926922687782
              le_mean =     -16.898818396376
             les_mean =     285.860996334203
             stat err =       0.000435998022
             autocorr =       1.348651809908
   target nu stat err =       0.000435998022
   target dn stat err =       0.002139905972
      target stat err =       0.003453227414
              std dev =       0.530945075392
             le_variance =       0.281902673083


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.926904251435        initial
     9.3132e-01     9.3132e+00             2.7127e-04        -0.926248709367
     3.7253e+00     3.7253e+01             7.2147e-05        -0.926998344301  <--
     1.4901e+01     1.4901e+02             1.8329e-05        -0.926922687782

*****************************************************************************
Applying the update for shift_i =   3.7253e+00     and shift_s =   3.7253e+01
*****************************************************************************

  Execution time = 2.3645e+01
  </log>
  <optVariables href="H2O.s041.opt.xml">
ci_0001                 7.085752e-01 3 1  ON 0
ci_0002                 6.927791e-01 3 1  ON 1
ci_0003                -3.100516e-02 3 1  ON 2
ci_0004                -3.010348e-02 3 1  ON 3
ci_0005                -3.061090e-02 3 1  ON 4
ci_0006                -3.068975e-02 3 1  ON 5
ci_0007                -1.339208e-02 3 1  ON 6
ci_0008                -1.336466e-02 3 1  ON 7
ci_0009                -1.870192e-02 3 1  ON 8
ci_0010                -1.813119e-02 3 1  ON 9
ci_0011                -1.474470e-02 3 1  ON 10
ci_0012                -1.450995e-02 3 1  ON 11
ci_0013                 1.530277e-02 3 1  ON 12
ci_0014                 1.480310e-02 3 1  ON 13
ci_0015                 1.574738e-02 3 1  ON 14
ci_0016                 1.538680e-02 3 1  ON 15
ci_0017                 1.336718e-02 3 1  ON 16
ci_0018                 1.305024e-02 3 1  ON 17
ci_0019                 1.309317e-02 3 1  ON 18
ci_0020                 1.265981e-02 3 1  ON 19
ci_0021                 6.763310e-03 3 1  ON 20
ci_0022                 7.476636e-03 3 1  ON 21
ci_0023                -1.179577e-02 3 1  ON 22
ci_0024                -1.145823e-02 3 1  ON 23
ci_0025                -2.030852e-03 3 1  ON 24
ci_0026                -2.420346e-03 3 1  ON 25
ci_0027                -1.212617e-02 3 1  ON 26
ci_0028                -1.156216e-02 3 1  ON 27
ci_0029                -1.065947e-02 3 1  ON 28
ci_0030                -1.058584e-02 3 1  ON 29
ci_0031                 1.341053e-02 3 1  ON 30
ci_0032                 1.211902e-02 3 1  ON 31
ci_0033                 7.862099e-03 3 1  ON 32
ci_0034                 8.488991e-03 3 1  ON 33
ci_0035                 4.886204e-03 3 1  ON 34
ci_0036                 4.923012e-03 3 1  ON 35
ci_0037                -1.134509e-02 3 1  ON 36
ci_0038                -1.131528e-02 3 1  ON 37
ci_0039                -4.019347e-03 3 1  ON 38
ci_0040                -3.885580e-03 3 1  ON 39
ci_0041                 9.088746e-03 3 1  ON 40
ci_0042                 8.779551e-03 3 1  ON 41
ci_0043                -1.301101e-02 3 1  ON 42
ci_0044                -1.381804e-02 3 1  ON 43
ci_0045                 1.059923e-02 3 1  ON 44
ci_0046                 1.008996e-02 3 1  ON 45
ci_0047                -3.588044e-03 3 1  ON 46
ci_0048                -3.479339e-03 3 1  ON 47
ci_0049                -2.582266e-03 3 1  ON 48
ci_0050                -2.704643e-03 3 1  ON 49
ci_0051                -1.793948e-03 3 1  ON 50
ci_0052                -2.016938e-03 3 1  ON 51
ci_0053                -3.930477e-03 3 1  ON 52
ci_0054                -3.314392e-03 3 1  ON 53
ci_0055                 2.388177e-03 3 1  ON 54
ci_0056                 2.275876e-03 3 1  ON 55
ci_0057                 2.484171e-03 3 1  ON 56
ci_0058                 2.887401e-03 3 1  ON 57
ci_0059                -3.400610e-03 3 1  ON 58
ci_0060                -3.375498e-03 3 1  ON 59
ci_0061                -3.981319e-03 3 1  ON 60
ci_0062                -3.929819e-03 3 1  ON 61
ci_0063                -9.800774e-03 3 1  ON 62
ci_0064                -9.369411e-03 3 1  ON 63
ci_0065                -6.435827e-03 3 1  ON 64
ci_0066                -6.132954e-03 3 1  ON 65
ci_0067                -3.735656e-03 3 1  ON 66
ci_0068                -3.485188e-03 3 1  ON 67
ci_0069                 3.588776e-03 3 1  ON 68
ci_0070                 3.357673e-03 3 1  ON 69
ci_0071                 2.997854e-03 3 1  ON 70
ci_0072                 3.481774e-03 3 1  ON 71
ci_0073                 3.543941e-03 3 1  ON 72
ci_0074                 3.528597e-03 3 1  ON 73
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 4.2672e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s042 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s042 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=42  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6904e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 42
    time step          = 0.05
    reference energy   = -16.8842
    reference variance = 0.271184
====================================================
  Execution time = 1.4274e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s042
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5240e+04
  VMC Eavg = -1.6899e+01
  VMC Evar = 2.9783e-01
  Total weights = 1.951007714e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 2.6388e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.283143577409
                                         uncertainty =       0.001506135614

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.283143577409
                                         uncertainty =       0.001506135614

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000376245004
  error estimate for blocks of size 2^( 2) =       0.000393320344
  error estimate for blocks of size 2^( 3) =       0.000410914687
  error estimate for blocks of size 2^( 4) =       0.000426486893
  error estimate for blocks of size 2^( 5) =       0.000437156409
  error estimate for blocks of size 2^( 6) =       0.000442235599
  error estimate for blocks of size 2^( 7) =       0.000447478927

      target function =      -0.916155957711
              le_mean =     -16.898940248174
             les_mean =     285.872007836721
             stat err =       0.000438339457
             autocorr =       1.357311869810
   target nu stat err =       0.000438339457
   target dn stat err =       0.003939439940
      target stat err =       0.006111680400
              std dev =       0.532090787246
             le_variance =       0.283120605872


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.689894024817e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 74
Check correct_vf_var_size: 225, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 9.3132e-01, overlap shift 9.3132e+00 and omega -1.7444e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.916195344125       residual = 2.55e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.916314641200       residual = 1.07e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.916322336795       residual = 3.45e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.916324907764       residual = 2.71e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.916326412551       residual = 1.89e-04           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.916327336611       residual = 9.13e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.916328081282       residual = 6.94e-05           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.916328331690       residual = 5.91e-05           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.916329114282       residual = 6.86e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.916330417780       residual = 5.12e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.916331330774       residual = 1.38e-05           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.916331436658       residual = 3.66e-06           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.916331514238       residual = 1.31e-06           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.916331533998       residual = 4.37e-07           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.916331531804       residual = 1.41e-07           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.916331536304       residual = 1.95e-08           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.916331538767       residual = 4.69e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         16 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 9.3132e-01 is 5.537029e-04

solving harmonic davidson linear method for identity shift 3.7253e+00, overlap shift 3.7253e+01 and omega -1.7444e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.916195344125       residual = 2.55e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.916227012547       residual = 1.07e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.916229028245       residual = 3.35e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.916229687718       residual = 2.60e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.916230067733       residual = 1.79e-04           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.916230293214       residual = 8.45e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.916230479604       residual = 6.42e-05           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.916230543936       residual = 5.56e-05           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.916230745687       residual = 6.33e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.916231064018       residual = 4.32e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.916231269546       residual = 1.07e-05           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.916231288800       residual = 2.81e-06           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.916231305666       residual = 1.01e-06           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.916231309412       residual = 3.24e-07           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.916231308935       residual = 9.89e-08           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.916231309941       residual = 1.34e-08           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.916231310456       residual = 3.31e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         16 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 3.7253e+00 is 1.379411e-04

solving harmonic davidson linear method for identity shift 1.4901e+01, overlap shift 1.4901e+02 and omega -1.7444e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.916195344125       residual = 2.55e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.916203385521       residual = 1.06e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.916203895522       residual = 3.32e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.916204061440       residual = 2.57e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.916204156648       residual = 1.77e-04           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.916204212616       residual = 8.28e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.916204259227       residual = 6.29e-05           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.916204275434       residual = 5.47e-05           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.916204326260       residual = 6.19e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.916204405260       residual = 4.13e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.916204455189       residual = 1.00e-05           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.916204459581       residual = 2.62e-06           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.916204463645       residual = 9.45e-07           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.916204464512       residual = 2.99e-07           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.916204464398       residual = 9.00e-08           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.916204464643       residual = 1.22e-08           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.916204464765       residual = 3.02e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         16 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 1.4901e+01 is 3.445233e-05

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.570834 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 75 and numParams is: 74

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.6927e+01
  </log>
  <optVariables href="H2O.s042.opt.xml">
ci_0001                 7.084472e-01 3 1  ON 0
ci_0002                 6.929171e-01 3 1  ON 1
ci_0003                -3.097471e-02 3 1  ON 2
ci_0004                -3.009216e-02 3 1  ON 3
ci_0005                -3.058537e-02 3 1  ON 4
ci_0006                -3.069886e-02 3 1  ON 5
ci_0007                -1.334163e-02 3 1  ON 6
ci_0008                -1.336221e-02 3 1  ON 7
ci_0009                -1.869378e-02 3 1  ON 8
ci_0010                -1.811760e-02 3 1  ON 9
ci_0011                -1.473807e-02 3 1  ON 10
ci_0012                -1.450990e-02 3 1  ON 11
ci_0013                 1.530869e-02 3 1  ON 12
ci_0014                 1.479955e-02 3 1  ON 13
ci_0015                 1.571317e-02 3 1  ON 14
ci_0016                 1.538700e-02 3 1  ON 15
ci_0017                 1.333980e-02 3 1  ON 16
ci_0018                 1.305197e-02 3 1  ON 17
ci_0019                 1.309632e-02 3 1  ON 18
ci_0020                 1.266800e-02 3 1  ON 19
ci_0021                 6.701833e-03 3 1  ON 20
ci_0022                 7.458241e-03 3 1  ON 21
ci_0023                -1.177403e-02 3 1  ON 22
ci_0024                -1.146342e-02 3 1  ON 23
ci_0025                -2.031030e-03 3 1  ON 24
ci_0026                -2.394536e-03 3 1  ON 25
ci_0027                -1.211704e-02 3 1  ON 26
ci_0028                -1.157234e-02 3 1  ON 27
ci_0029                -1.066944e-02 3 1  ON 28
ci_0030                -1.059902e-02 3 1  ON 29
ci_0031                 1.340113e-02 3 1  ON 30
ci_0032                 1.210904e-02 3 1  ON 31
ci_0033                 7.886842e-03 3 1  ON 32
ci_0034                 8.487496e-03 3 1  ON 33
ci_0035                 4.906218e-03 3 1  ON 34
ci_0036                 5.043442e-03 3 1  ON 35
ci_0037                -1.133406e-02 3 1  ON 36
ci_0038                -1.131085e-02 3 1  ON 37
ci_0039                -4.020793e-03 3 1  ON 38
ci_0040                -3.881540e-03 3 1  ON 39
ci_0041                 9.084368e-03 3 1  ON 40
ci_0042                 8.779656e-03 3 1  ON 41
ci_0043                -1.297983e-02 3 1  ON 42
ci_0044                -1.383295e-02 3 1  ON 43
ci_0045                 1.059528e-02 3 1  ON 44
ci_0046                 1.009009e-02 3 1  ON 45
ci_0047                -3.582442e-03 3 1  ON 46
ci_0048                -3.475165e-03 3 1  ON 47
ci_0049                -2.581793e-03 3 1  ON 48
ci_0050                -2.642386e-03 3 1  ON 49
ci_0051                -1.796357e-03 3 1  ON 50
ci_0052                -2.015168e-03 3 1  ON 51
ci_0053                -3.913637e-03 3 1  ON 52
ci_0054                -3.312401e-03 3 1  ON 53
ci_0055                 2.361196e-03 3 1  ON 54
ci_0056                 2.291054e-03 3 1  ON 55
ci_0057                 2.501532e-03 3 1  ON 56
ci_0058                 2.899181e-03 3 1  ON 57
ci_0059                -3.396041e-03 3 1  ON 58
ci_0060                -3.376570e-03 3 1  ON 59
ci_0061                -3.975602e-03 3 1  ON 60
ci_0062                -3.935979e-03 3 1  ON 61
ci_0063                -9.782357e-03 3 1  ON 62
ci_0064                -9.368332e-03 3 1  ON 63
ci_0065                -6.433113e-03 3 1  ON 64
ci_0066                -6.128837e-03 3 1  ON 65
ci_0067                -3.713866e-03 3 1  ON 66
ci_0068                -3.479276e-03 3 1  ON 67
ci_0069                 3.592772e-03 3 1  ON 68
ci_0070                 3.361304e-03 3 1  ON 69
ci_0071                 2.980463e-03 3 1  ON 70
ci_0072                 3.458295e-03 3 1  ON 71
ci_0073                 3.524611e-03 3 1  ON 72
ci_0074                 3.509949e-03 3 1  ON 73
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 42
    time step          = 0.05
    reference energy   = -16.9068
    reference variance = 0.329452
====================================================
  Execution time = 1.3892e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s042
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6899e+01
  VMC Evar = 2.9585e-01
  Total weights = 1.9511e+06
  Execution time = 1.8685e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.283561999816
                                         uncertainty =       0.002021075711

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.283561999816
                                         uncertainty =       0.002021075711

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000376539388
  error estimate for blocks of size 2^( 2) =       0.000393545880
  error estimate for blocks of size 2^( 3) =       0.000411220075
  error estimate for blocks of size 2^( 4) =       0.000426699062
  error estimate for blocks of size 2^( 5) =       0.000438629721
  error estimate for blocks of size 2^( 6) =       0.000446742222
  error estimate for blocks of size 2^( 7) =       0.000451651162

      target function =      -0.919361495698
              le_mean =     -16.898811495937
             les_mean =     285.865592779183
             stat err =       0.000440930542
             autocorr =       1.371259150513
   target nu stat err =       0.000440930542
   target dn stat err =       0.002996857155
      target stat err =       0.004705731800
              std dev =       0.532507109835
             le_variance =       0.283563822025

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.283546540396
                                         uncertainty =       0.002026804180

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.283546540396
                                         uncertainty =       0.002026804180

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000376529393
  error estimate for blocks of size 2^( 2) =       0.000393537284
  error estimate for blocks of size 2^( 3) =       0.000411212340
  error estimate for blocks of size 2^( 4) =       0.000426693163
  error estimate for blocks of size 2^( 5) =       0.000438629090
  error estimate for blocks of size 2^( 6) =       0.000446737719
  error estimate for blocks of size 2^( 7) =       0.000451643206

      target function =      -0.918108208257
              le_mean =     -16.898813082750
             les_mean =     285.866454093083
             stat err =       0.000440925794
             autocorr =       1.371302423768
   target nu stat err =       0.000440925794
   target dn stat err =       0.003168115139
      target stat err =       0.004954750178
              std dev =       0.532492974295
             le_variance =       0.283548767673

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.283550901331
                                         uncertainty =       0.002023912403

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.283550901331
                                         uncertainty =       0.002023912403

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000376532164
  error estimate for blocks of size 2^( 2) =       0.000393539415
  error estimate for blocks of size 2^( 3) =       0.000411214092
  error estimate for blocks of size 2^( 4) =       0.000426694075
  error estimate for blocks of size 2^( 5) =       0.000438627457
  error estimate for blocks of size 2^( 6) =       0.000446737826
  error estimate for blocks of size 2^( 7) =       0.000451645067

      target function =      -0.918990400129
              le_mean =     -16.898812164487
             les_mean =     285.865854343354
             stat err =       0.000440926106
             autocorr =       1.371284182560
   target nu stat err =       0.000440926106
   target dn stat err =       0.003044170515
      target stat err =       0.004774381693
              std dev =       0.532496892394
             le_variance =       0.283552940410

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.283560256839
                                         uncertainty =       0.002021423059

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.283560256839
                                         uncertainty =       0.002021423059

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000376538250
  error estimate for blocks of size 2^( 2) =       0.000393544840
  error estimate for blocks of size 2^( 3) =       0.000411219100
  error estimate for blocks of size 2^( 4) =       0.000426698217
  error estimate for blocks of size 2^( 5) =       0.000438629220
  error estimate for blocks of size 2^( 6) =       0.000446741444
  error estimate for blocks of size 2^( 7) =       0.000451650170

      target function =      -0.919336941569
              le_mean =     -16.898811557716
             les_mean =     285.865610663695
             stat err =       0.000440929763
             autocorr =       1.371262599661
   target nu stat err =       0.000440929763
   target dn stat err =       0.003000913165
      target stat err =       0.004711693793
              std dev =       0.532505499203
             le_variance =       0.283562106681


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.919361495698        initial  <--
     9.3132e-01     9.3132e+00             5.5370e-04        -0.918108208257
     3.7253e+00     3.7253e+01             1.3794e-04        -0.918990400129
     1.4901e+01     1.4901e+02             3.4452e-05        -0.919336941569

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 23.4149
  </log>
  <optVariables href="H2O.s042.opt.xml">
ci_0001                 7.085752e-01 3 1  ON 0
ci_0002                 6.927791e-01 3 1  ON 1
ci_0003                -3.100516e-02 3 1  ON 2
ci_0004                -3.010348e-02 3 1  ON 3
ci_0005                -3.061090e-02 3 1  ON 4
ci_0006                -3.068975e-02 3 1  ON 5
ci_0007                -1.339208e-02 3 1  ON 6
ci_0008                -1.336466e-02 3 1  ON 7
ci_0009                -1.870192e-02 3 1  ON 8
ci_0010                -1.813119e-02 3 1  ON 9
ci_0011                -1.474470e-02 3 1  ON 10
ci_0012                -1.450995e-02 3 1  ON 11
ci_0013                 1.530277e-02 3 1  ON 12
ci_0014                 1.480310e-02 3 1  ON 13
ci_0015                 1.574738e-02 3 1  ON 14
ci_0016                 1.538680e-02 3 1  ON 15
ci_0017                 1.336718e-02 3 1  ON 16
ci_0018                 1.305024e-02 3 1  ON 17
ci_0019                 1.309317e-02 3 1  ON 18
ci_0020                 1.265981e-02 3 1  ON 19
ci_0021                 6.763310e-03 3 1  ON 20
ci_0022                 7.476636e-03 3 1  ON 21
ci_0023                -1.179577e-02 3 1  ON 22
ci_0024                -1.145823e-02 3 1  ON 23
ci_0025                -2.030852e-03 3 1  ON 24
ci_0026                -2.420346e-03 3 1  ON 25
ci_0027                -1.212617e-02 3 1  ON 26
ci_0028                -1.156216e-02 3 1  ON 27
ci_0029                -1.065947e-02 3 1  ON 28
ci_0030                -1.058584e-02 3 1  ON 29
ci_0031                 1.341053e-02 3 1  ON 30
ci_0032                 1.211902e-02 3 1  ON 31
ci_0033                 7.862099e-03 3 1  ON 32
ci_0034                 8.488991e-03 3 1  ON 33
ci_0035                 4.886204e-03 3 1  ON 34
ci_0036                 4.923012e-03 3 1  ON 35
ci_0037                -1.134509e-02 3 1  ON 36
ci_0038                -1.131528e-02 3 1  ON 37
ci_0039                -4.019347e-03 3 1  ON 38
ci_0040                -3.885580e-03 3 1  ON 39
ci_0041                 9.088746e-03 3 1  ON 40
ci_0042                 8.779551e-03 3 1  ON 41
ci_0043                -1.301101e-02 3 1  ON 42
ci_0044                -1.381804e-02 3 1  ON 43
ci_0045                 1.059923e-02 3 1  ON 44
ci_0046                 1.008996e-02 3 1  ON 45
ci_0047                -3.588044e-03 3 1  ON 46
ci_0048                -3.479339e-03 3 1  ON 47
ci_0049                -2.582266e-03 3 1  ON 48
ci_0050                -2.704643e-03 3 1  ON 49
ci_0051                -1.793948e-03 3 1  ON 50
ci_0052                -2.016938e-03 3 1  ON 51
ci_0053                -3.930477e-03 3 1  ON 52
ci_0054                -3.314392e-03 3 1  ON 53
ci_0055                 2.388177e-03 3 1  ON 54
ci_0056                 2.275876e-03 3 1  ON 55
ci_0057                 2.484171e-03 3 1  ON 56
ci_0058                 2.887401e-03 3 1  ON 57
ci_0059                -3.400610e-03 3 1  ON 58
ci_0060                -3.375498e-03 3 1  ON 59
ci_0061                -3.981319e-03 3 1  ON 60
ci_0062                -3.929819e-03 3 1  ON 61
ci_0063                -9.800774e-03 3 1  ON 62
ci_0064                -9.369411e-03 3 1  ON 63
ci_0065                -6.435827e-03 3 1  ON 64
ci_0066                -6.132954e-03 3 1  ON 65
ci_0067                -3.735656e-03 3 1  ON 66
ci_0068                -3.485188e-03 3 1  ON 67
ci_0069                 3.588776e-03 3 1  ON 68
ci_0070                 3.357673e-03 3 1  ON 69
ci_0071                 2.997854e-03 3 1  ON 70
ci_0072                 3.481774e-03 3 1  ON 71
ci_0073                 3.543941e-03 3 1  ON 72
ci_0074                 3.528597e-03 3 1  ON 73
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 4.0348e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s043 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s043 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=43  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6904e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 43
    time step          = 0.05
    reference energy   = -16.9217
    reference variance = 0.189114
====================================================
  Execution time = 1.4548e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s043
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5234e+04
  VMC Eavg = -1.6899e+01
  VMC Evar = 2.8957e-01
  Total weights = 1.950947772e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 2.5954e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.281559674665
                                         uncertainty =       0.001913310347

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.281559674665
                                         uncertainty =       0.001913310347

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000375159711
  error estimate for blocks of size 2^( 2) =       0.000391757373
  error estimate for blocks of size 2^( 3) =       0.000408829908
  error estimate for blocks of size 2^( 4) =       0.000423514932
  error estimate for blocks of size 2^( 5) =       0.000435266236
  error estimate for blocks of size 2^( 6) =       0.000442233435
  error estimate for blocks of size 2^( 7) =       0.000446203302

      target function =      -0.929061299273
              le_mean =     -16.898653917405
             les_mean =     285.854078850535
             stat err =       0.000436804476
             autocorr =       1.355631889103
   target nu stat err =       0.000436804476
   target dn stat err =       0.002433487428
      target stat err =       0.003923230668
              std dev =       0.530555950651
             le_variance =       0.281489616771


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.689865391741e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 74
Check correct_vf_var_size: 225, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 9.3132e+00, overlap shift 9.3132e+01 and omega -1.7444e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.929076695820       residual = 7.57e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.929080131440       residual = 7.86e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.929080729939       residual = 2.46e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.929081031200       residual = 1.69e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.929081200109       residual = 6.10e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.929081304558       residual = 2.32e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.929081333992       residual = 5.25e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.929081336772       residual = 2.68e-06           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.929081347233       residual = 2.67e-06           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.929081353681       residual = 1.56e-06           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.929081358751       residual = 1.29e-06           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.929081359761       residual = 9.64e-07           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.929081359061       residual = 7.21e-07           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.929081358574       residual = 2.59e-07           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.929081358502       residual = 8.27e-08           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.929081358181       residual = 2.84e-08           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.929081358871       residual = 7.75e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         16 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 9.3132e+00 is 3.050475e-05

solving harmonic davidson linear method for identity shift 3.7253e+01, overlap shift 3.7253e+02 and omega -1.7444e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.929076695820       residual = 7.57e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.929077560103       residual = 7.85e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.929077710449       residual = 2.45e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.929077785989       residual = 1.68e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.929077828304       residual = 6.06e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.929077854390       residual = 2.30e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.929077861719       residual = 5.19e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.929077862407       residual = 2.65e-06           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.929077865025       residual = 2.65e-06           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.929077866631       residual = 1.54e-06           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.929077867893       residual = 1.27e-06           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.929077868135       residual = 9.52e-07           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.929077867954       residual = 7.05e-07           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.929077867832       residual = 2.51e-07           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.929077867814       residual = 8.00e-08           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.929077867735       residual = 2.73e-08           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.929077867904       residual = 7.43e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         16 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 3.7253e+01 is 7.651387e-06

solving harmonic davidson linear method for identity shift 1.4901e+02, overlap shift 1.4901e+03 and omega -1.7444e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.929076695820       residual = 7.57e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.929076912229       residual = 7.85e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.929076949861       residual = 2.45e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.929076968760       residual = 1.68e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.929076979344       residual = 6.05e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.929076985864       residual = 2.29e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.929076987695       residual = 5.18e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.929076987866       residual = 2.65e-06           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.929076988521       residual = 2.65e-06           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.929076988922       residual = 1.54e-06           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.929076989237       residual = 1.27e-06           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.929076989297       residual = 9.48e-07           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.929076989251       residual = 7.01e-07           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.929076989221       residual = 2.50e-07           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.929076989216       residual = 7.94e-08           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.929076989196       residual = 2.71e-08           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.929076989239       residual = 7.36e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         16 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 1.4901e+02 is 1.914428e-06

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.579868 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 75 and numParams is: 74

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.7157e+01
  </log>
  <optVariables href="H2O.s043.opt.xml">
ci_0001                 7.085725e-01 3 1  ON 0
ci_0002                 6.927818e-01 3 1  ON 1
ci_0003                -3.100477e-02 3 1  ON 2
ci_0004                -3.010269e-02 3 1  ON 3
ci_0005                -3.061025e-02 3 1  ON 4
ci_0006                -3.069176e-02 3 1  ON 5
ci_0007                -1.339117e-02 3 1  ON 6
ci_0008                -1.336329e-02 3 1  ON 7
ci_0009                -1.870222e-02 3 1  ON 8
ci_0010                -1.813100e-02 3 1  ON 9
ci_0011                -1.474521e-02 3 1  ON 10
ci_0012                -1.451126e-02 3 1  ON 11
ci_0013                 1.530165e-02 3 1  ON 12
ci_0014                 1.480332e-02 3 1  ON 13
ci_0015                 1.574757e-02 3 1  ON 14
ci_0016                 1.538727e-02 3 1  ON 15
ci_0017                 1.336676e-02 3 1  ON 16
ci_0018                 1.304868e-02 3 1  ON 17
ci_0019                 1.309133e-02 3 1  ON 18
ci_0020                 1.266106e-02 3 1  ON 19
ci_0021                 6.763709e-03 3 1  ON 20
ci_0022                 7.475899e-03 3 1  ON 21
ci_0023                -1.179743e-02 3 1  ON 22
ci_0024                -1.145865e-02 3 1  ON 23
ci_0025                -2.030664e-03 3 1  ON 24
ci_0026                -2.416155e-03 3 1  ON 25
ci_0027                -1.212818e-02 3 1  ON 26
ci_0028                -1.156195e-02 3 1  ON 27
ci_0029                -1.065754e-02 3 1  ON 28
ci_0030                -1.058442e-02 3 1  ON 29
ci_0031                 1.340959e-02 3 1  ON 30
ci_0032                 1.212011e-02 3 1  ON 31
ci_0033                 7.863574e-03 3 1  ON 32
ci_0034                 8.490400e-03 3 1  ON 33
ci_0035                 4.884194e-03 3 1  ON 34
ci_0036                 4.920846e-03 3 1  ON 35
ci_0037                -1.134564e-02 3 1  ON 36
ci_0038                -1.131419e-02 3 1  ON 37
ci_0039                -4.019310e-03 3 1  ON 38
ci_0040                -3.886263e-03 3 1  ON 39
ci_0041                 9.090391e-03 3 1  ON 40
ci_0042                 8.779602e-03 3 1  ON 41
ci_0043                -1.301866e-02 3 1  ON 42
ci_0044                -1.382192e-02 3 1  ON 43
ci_0045                 1.059829e-02 3 1  ON 44
ci_0046                 1.008959e-02 3 1  ON 45
ci_0047                -3.587589e-03 3 1  ON 46
ci_0048                -3.479554e-03 3 1  ON 47
ci_0049                -2.583216e-03 3 1  ON 48
ci_0050                -2.702395e-03 3 1  ON 49
ci_0051                -1.793747e-03 3 1  ON 50
ci_0052                -2.016956e-03 3 1  ON 51
ci_0053                -3.930821e-03 3 1  ON 52
ci_0054                -3.314816e-03 3 1  ON 53
ci_0055                 2.389891e-03 3 1  ON 54
ci_0056                 2.274939e-03 3 1  ON 55
ci_0057                 2.482348e-03 3 1  ON 56
ci_0058                 2.885971e-03 3 1  ON 57
ci_0059                -3.399466e-03 3 1  ON 58
ci_0060                -3.376308e-03 3 1  ON 59
ci_0061                -3.980748e-03 3 1  ON 60
ci_0062                -3.929741e-03 3 1  ON 61
ci_0063                -9.801831e-03 3 1  ON 62
ci_0064                -9.369298e-03 3 1  ON 63
ci_0065                -6.434776e-03 3 1  ON 64
ci_0066                -6.132644e-03 3 1  ON 65
ci_0067                -3.737647e-03 3 1  ON 66
ci_0068                -3.483138e-03 3 1  ON 67
ci_0069                 3.586460e-03 3 1  ON 68
ci_0070                 3.356770e-03 3 1  ON 69
ci_0071                 2.999024e-03 3 1  ON 70
ci_0072                 3.481792e-03 3 1  ON 71
ci_0073                 3.543174e-03 3 1  ON 72
ci_0074                 3.528682e-03 3 1  ON 73
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 43
    time step          = 0.05
    reference energy   = -16.9869
    reference variance = 0.183284
====================================================
  Execution time = 1.4041e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s043
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6899e+01
  VMC Evar = 2.9362e-01
  Total weights = 1.9509e+06
  Execution time = 1.8781e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.281602753004
                                         uncertainty =       0.001682830461

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.281602753004
                                         uncertainty =       0.001682830461

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000375312365
  error estimate for blocks of size 2^( 2) =       0.000392242008
  error estimate for blocks of size 2^( 3) =       0.000409270882
  error estimate for blocks of size 2^( 4) =       0.000424415841
  error estimate for blocks of size 2^( 5) =       0.000436313080
  error estimate for blocks of size 2^( 6) =       0.000441990115
  error estimate for blocks of size 2^( 7) =       0.000448786858

      target function =      -0.922688133740
              le_mean =     -16.898655496220
             les_mean =     285.858182857782
             stat err =       0.000437876474
             autocorr =       1.361186010851
   target nu stat err =       0.000437876474
   target dn stat err =       0.002848306130
      target stat err =       0.004508314790
              std dev =       0.530771837248
             le_variance =       0.281718743216

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.281600450691
                                         uncertainty =       0.001682811828

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.281600450691
                                         uncertainty =       0.001682811828

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000375310255
  error estimate for blocks of size 2^( 2) =       0.000392239894
  error estimate for blocks of size 2^( 3) =       0.000409268574
  error estimate for blocks of size 2^( 4) =       0.000424413308
  error estimate for blocks of size 2^( 5) =       0.000436310482
  error estimate for blocks of size 2^( 6) =       0.000441987730
  error estimate for blocks of size 2^( 7) =       0.000448784700

      target function =      -0.922720237584
              le_mean =     -16.898655586334
             les_mean =     285.858165456844
             stat err =       0.000437874055
             autocorr =       1.361186284782
   target nu stat err =       0.000437874055
   target dn stat err =       0.002836239517
      target stat err =       0.004490040006
              std dev =       0.530768852147
             le_variance =       0.281715574409

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.281601587618
                                         uncertainty =       0.001682821120

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.281601587618
                                         uncertainty =       0.001682821120

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000375311298
  error estimate for blocks of size 2^( 2) =       0.000392240939
  error estimate for blocks of size 2^( 3) =       0.000409269716
  error estimate for blocks of size 2^( 4) =       0.000424414563
  error estimate for blocks of size 2^( 5) =       0.000436311769
  error estimate for blocks of size 2^( 6) =       0.000441988912
  error estimate for blocks of size 2^( 7) =       0.000448785770

      target function =      -0.922704675965
              le_mean =     -16.898655540573
             les_mean =     285.858173820090
             stat err =       0.000437875254
             autocorr =       1.361186171864
   target nu stat err =       0.000437875254
   target dn stat err =       0.002842196603
      target stat err =       0.004499064779
              std dev =       0.530770327055
             le_variance =       0.281717140082

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.281602606152
                                         uncertainty =       0.001682829281

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.281602606152
                                         uncertainty =       0.001682829281

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000375312231
  error estimate for blocks of size 2^( 2) =       0.000392241873
  error estimate for blocks of size 2^( 3) =       0.000409270735
  error estimate for blocks of size 2^( 4) =       0.000424415681
  error estimate for blocks of size 2^( 5) =       0.000436312915
  error estimate for blocks of size 2^( 6) =       0.000441989964
  error estimate for blocks of size 2^( 7) =       0.000448786721

      target function =      -0.922690237710
              le_mean =     -16.898655501651
             les_mean =     285.858181701085
             stat err =       0.000437876320
             autocorr =       1.361186032616
   target nu stat err =       0.000437876320
   target dn stat err =       0.002847536850
      target stat err =       0.004507150287
              std dev =       0.530771647089
             le_variance =       0.281718541353


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.922688133740        initial
     9.3132e+00     9.3132e+01             3.0505e-05        -0.922720237584  <--
     3.7253e+01     3.7253e+02             7.6514e-06        -0.922704675965
     1.4901e+02     1.4901e+03             1.9144e-06        -0.922690237710

*****************************************************************************
Applying the update for shift_i =   9.3132e+00     and shift_s =   9.3132e+01
*****************************************************************************

  Execution time = 2.3567e+01
  </log>
  <optVariables href="H2O.s043.opt.xml">
ci_0001                 7.085643e-01 3 1  ON 0
ci_0002                 6.927897e-01 3 1  ON 1
ci_0003                -3.100358e-02 3 1  ON 2
ci_0004                -3.010033e-02 3 1  ON 3
ci_0005                -3.060828e-02 3 1  ON 4
ci_0006                -3.069775e-02 3 1  ON 5
ci_0007                -1.338846e-02 3 1  ON 6
ci_0008                -1.335922e-02 3 1  ON 7
ci_0009                -1.870312e-02 3 1  ON 8
ci_0010                -1.813043e-02 3 1  ON 9
ci_0011                -1.474672e-02 3 1  ON 10
ci_0012                -1.451520e-02 3 1  ON 11
ci_0013                 1.529832e-02 3 1  ON 12
ci_0014                 1.480399e-02 3 1  ON 13
ci_0015                 1.574812e-02 3 1  ON 14
ci_0016                 1.538869e-02 3 1  ON 15
ci_0017                 1.336551e-02 3 1  ON 16
ci_0018                 1.304402e-02 3 1  ON 17
ci_0019                 1.308584e-02 3 1  ON 18
ci_0020                 1.266478e-02 3 1  ON 19
ci_0021                 6.764914e-03 3 1  ON 20
ci_0022                 7.473706e-03 3 1  ON 21
ci_0023                -1.180237e-02 3 1  ON 22
ci_0024                -1.145992e-02 3 1  ON 23
ci_0025                -2.030103e-03 3 1  ON 24
ci_0026                -2.403690e-03 3 1  ON 25
ci_0027                -1.213416e-02 3 1  ON 26
ci_0028                -1.156134e-02 3 1  ON 27
ci_0029                -1.065181e-02 3 1  ON 28
ci_0030                -1.058019e-02 3 1  ON 29
ci_0031                 1.340680e-02 3 1  ON 30
ci_0032                 1.212338e-02 3 1  ON 31
ci_0033                 7.867977e-03 3 1  ON 32
ci_0034                 8.494607e-03 3 1  ON 33
ci_0035                 4.878214e-03 3 1  ON 34
ci_0036                 4.914400e-03 3 1  ON 35
ci_0037                -1.134728e-02 3 1  ON 36
ci_0038                -1.131092e-02 3 1  ON 37
ci_0039                -4.019199e-03 3 1  ON 38
ci_0040                -3.888297e-03 3 1  ON 39
ci_0041                 9.095290e-03 3 1  ON 40
ci_0042                 8.779756e-03 3 1  ON 41
ci_0043                -1.304151e-02 3 1  ON 42
ci_0044                -1.383351e-02 3 1  ON 43
ci_0045                 1.059548e-02 3 1  ON 44
ci_0046                 1.008847e-02 3 1  ON 45
ci_0047                -3.586233e-03 3 1  ON 46
ci_0048                -3.480194e-03 3 1  ON 47
ci_0049                -2.586042e-03 3 1  ON 48
ci_0050                -2.695708e-03 3 1  ON 49
ci_0051                -1.793151e-03 3 1  ON 50
ci_0052                -2.017010e-03 3 1  ON 51
ci_0053                -3.931846e-03 3 1  ON 52
ci_0054                -3.316078e-03 3 1  ON 53
ci_0055                 2.394989e-03 3 1  ON 54
ci_0056                 2.272153e-03 3 1  ON 55
ci_0057                 2.476925e-03 3 1  ON 56
ci_0058                 2.881718e-03 3 1  ON 57
ci_0059                -3.396062e-03 3 1  ON 58
ci_0060                -3.378719e-03 3 1  ON 59
ci_0061                -3.979048e-03 3 1  ON 60
ci_0062                -3.929508e-03 3 1  ON 61
ci_0063                -9.804976e-03 3 1  ON 62
ci_0064                -9.368963e-03 3 1  ON 63
ci_0065                -6.431644e-03 3 1  ON 64
ci_0066                -6.131720e-03 3 1  ON 65
ci_0067                -3.743571e-03 3 1  ON 66
ci_0068                -3.477041e-03 3 1  ON 67
ci_0069                 3.579572e-03 3 1  ON 68
ci_0070                 3.354081e-03 3 1  ON 69
ci_0071                 3.002507e-03 3 1  ON 70
ci_0072                 3.481844e-03 3 1  ON 71
ci_0073                 3.540890e-03 3 1  ON 72
ci_0074                 3.528935e-03 3 1  ON 73
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 4.0754e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s044 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s044 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=44  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6905e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 44
    time step          = 0.05
    reference energy   = -16.8803
    reference variance = 0.249234
====================================================
  Execution time = 1.4361e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s044
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5247e+04
  VMC Eavg = -1.6898e+01
  VMC Evar = 2.9195e-01
  Total weights = 1.951337994e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 2.6059e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.281734943206
                                         uncertainty =       0.002164578481

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.281734943206
                                         uncertainty =       0.002164578481

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000375374847
  error estimate for blocks of size 2^( 2) =       0.000392215782
  error estimate for blocks of size 2^( 3) =       0.000409564882
  error estimate for blocks of size 2^( 4) =       0.000425830216
  error estimate for blocks of size 2^( 5) =       0.000437238697
  error estimate for blocks of size 2^( 6) =       0.000444215546
  error estimate for blocks of size 2^( 7) =       0.000447174764

      target function =      -0.925305101163
              le_mean =     -16.898409788513
             les_mean =     285.848206386032
             stat err =       0.000438614806
             autocorr =       1.365325617701
   target nu stat err =       0.000438614806
   target dn stat err =       0.002652748187
      target stat err =       0.004229276938
              std dev =       0.530860199236
             le_variance =       0.281812551133


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.689840978851e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 74
Check correct_vf_var_size: 225, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.3283e+00, overlap shift 2.3283e+01 and omega -1.7444e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.925323174413       residual = 1.16e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.925348179587       residual = 1.57e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.925350870891       residual = 3.00e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.925351425171       residual = 1.94e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.925352337289       residual = 7.50e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.925352612786       residual = 5.24e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.925352652314       residual = 3.20e-05           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.925352751660       residual = 4.68e-05           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.925352902879       residual = 4.56e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.925353204594       residual = 1.72e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.925353260354       residual = 4.67e-06           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.925353240412       residual = 1.49e-06           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.925353213193       residual = 3.99e-07           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.925353212118       residual = 2.23e-07           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.925353214214       residual = 6.05e-08           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.925353217008       residual = 1.85e-08           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.925353217106       residual = 4.46e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         16 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 2.3283e+00 is 1.644750e-04

solving harmonic davidson linear method for identity shift 9.3132e+00, overlap shift 9.3132e+01 and omega -1.7444e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.925323174413       residual = 1.16e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.925329581317       residual = 1.57e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.925330268694       residual = 2.97e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.925330408689       residual = 1.91e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.925330638924       residual = 7.37e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.925330707554       residual = 5.11e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.925330717119       residual = 3.11e-05           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.925330742500       residual = 4.60e-05           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.925330780458       residual = 4.41e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.925330854120       residual = 1.59e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.925330866881       residual = 4.23e-06           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.925330861796       residual = 1.34e-06           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.925330855117       residual = 3.61e-07           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.925330854947       residual = 1.98e-07           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.925330855479       residual = 5.30e-08           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.925330856139       residual = 1.59e-08           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.925330856163       residual = 3.78e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         16 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 9.3132e+00 is 4.113132e-05

solving harmonic davidson linear method for identity shift 3.7253e+01, overlap shift 3.7253e+02 and omega -1.7444e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.925323174413       residual = 1.16e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.925324786169       residual = 1.56e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.925324958947       residual = 2.96e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.925324994035       residual = 1.91e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.925325051731       residual = 7.34e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.925325068871       residual = 5.07e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.925325071242       residual = 3.09e-05           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.925325077623       residual = 4.58e-05           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.925325087121       residual = 4.37e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.925325105422       residual = 1.55e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.925325108539       residual = 4.12e-06           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.925325107262       residual = 1.31e-06           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.925325105601       residual = 3.51e-07           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.925325105565       residual = 1.92e-07           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.925325105698       residual = 5.12e-08           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.925325105861       residual = 1.53e-08           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.925325105866       residual = 3.62e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         16 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 3.7253e+01 is 1.028363e-05

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.588991 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 75 and numParams is: 74

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.6981e+01
  </log>
  <optVariables href="H2O.s044.opt.xml">
ci_0001                 7.086048e-01 3 1  ON 0
ci_0002                 6.927486e-01 3 1  ON 1
ci_0003                -3.099988e-02 3 1  ON 2
ci_0004                -3.009199e-02 3 1  ON 3
ci_0005                -3.060778e-02 3 1  ON 4
ci_0006                -3.069201e-02 3 1  ON 5
ci_0007                -1.339101e-02 3 1  ON 6
ci_0008                -1.336078e-02 3 1  ON 7
ci_0009                -1.870456e-02 3 1  ON 8
ci_0010                -1.812922e-02 3 1  ON 9
ci_0011                -1.474693e-02 3 1  ON 10
ci_0012                -1.451184e-02 3 1  ON 11
ci_0013                 1.529755e-02 3 1  ON 12
ci_0014                 1.480401e-02 3 1  ON 13
ci_0015                 1.574367e-02 3 1  ON 14
ci_0016                 1.538708e-02 3 1  ON 15
ci_0017                 1.336937e-02 3 1  ON 16
ci_0018                 1.303855e-02 3 1  ON 17
ci_0019                 1.308997e-02 3 1  ON 18
ci_0020                 1.266672e-02 3 1  ON 19
ci_0021                 6.757815e-03 3 1  ON 20
ci_0022                 7.474575e-03 3 1  ON 21
ci_0023                -1.180393e-02 3 1  ON 22
ci_0024                -1.146799e-02 3 1  ON 23
ci_0025                -2.033199e-03 3 1  ON 24
ci_0026                -2.395286e-03 3 1  ON 25
ci_0027                -1.213137e-02 3 1  ON 26
ci_0028                -1.155279e-02 3 1  ON 27
ci_0029                -1.065653e-02 3 1  ON 28
ci_0030                -1.058137e-02 3 1  ON 29
ci_0031                 1.340930e-02 3 1  ON 30
ci_0032                 1.211557e-02 3 1  ON 31
ci_0033                 7.853743e-03 3 1  ON 32
ci_0034                 8.499383e-03 3 1  ON 33
ci_0035                 4.852649e-03 3 1  ON 34
ci_0036                 4.932676e-03 3 1  ON 35
ci_0037                -1.134573e-02 3 1  ON 36
ci_0038                -1.131447e-02 3 1  ON 37
ci_0039                -4.016622e-03 3 1  ON 38
ci_0040                -3.887590e-03 3 1  ON 39
ci_0041                 9.104328e-03 3 1  ON 40
ci_0042                 8.778774e-03 3 1  ON 41
ci_0043                -1.306087e-02 3 1  ON 42
ci_0044                -1.384681e-02 3 1  ON 43
ci_0045                 1.059461e-02 3 1  ON 44
ci_0046                 1.008715e-02 3 1  ON 45
ci_0047                -3.586119e-03 3 1  ON 46
ci_0048                -3.480430e-03 3 1  ON 47
ci_0049                -2.585240e-03 3 1  ON 48
ci_0050                -2.697425e-03 3 1  ON 49
ci_0051                -1.795619e-03 3 1  ON 50
ci_0052                -2.016717e-03 3 1  ON 51
ci_0053                -3.932264e-03 3 1  ON 52
ci_0054                -3.323374e-03 3 1  ON 53
ci_0055                 2.404769e-03 3 1  ON 54
ci_0056                 2.272190e-03 3 1  ON 55
ci_0057                 2.457046e-03 3 1  ON 56
ci_0058                 2.863970e-03 3 1  ON 57
ci_0059                -3.399599e-03 3 1  ON 58
ci_0060                -3.377932e-03 3 1  ON 59
ci_0061                -3.977639e-03 3 1  ON 60
ci_0062                -3.923065e-03 3 1  ON 61
ci_0063                -9.805101e-03 3 1  ON 62
ci_0064                -9.372259e-03 3 1  ON 63
ci_0065                -6.432757e-03 3 1  ON 64
ci_0066                -6.133036e-03 3 1  ON 65
ci_0067                -3.744194e-03 3 1  ON 66
ci_0068                -3.477994e-03 3 1  ON 67
ci_0069                 3.577319e-03 3 1  ON 68
ci_0070                 3.350931e-03 3 1  ON 69
ci_0071                 3.000950e-03 3 1  ON 70
ci_0072                 3.482780e-03 3 1  ON 71
ci_0073                 3.552621e-03 3 1  ON 72
ci_0074                 3.527932e-03 3 1  ON 73
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 44
    time step          = 0.05
    reference energy   = -16.9497
    reference variance = 0.178821
====================================================
  Execution time = 1.4032e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s044
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6898e+01
  VMC Evar = 2.9360e-01
  Total weights = 1.9509e+06
  Execution time = 1.8686e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.283640806529
                                         uncertainty =       0.001991570772

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.283640806529
                                         uncertainty =       0.001991570772

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000376565215
  error estimate for blocks of size 2^( 2) =       0.000394039249
  error estimate for blocks of size 2^( 3) =       0.000411500819
  error estimate for blocks of size 2^( 4) =       0.000427670182
  error estimate for blocks of size 2^( 5) =       0.000440994512
  error estimate for blocks of size 2^( 6) =       0.000449936934
  error estimate for blocks of size 2^( 7) =       0.000455756904

      target function =      -0.922706705727
              le_mean =     -16.898159484997
             les_mean =     285.841403612858
             stat err =       0.000443589633
             autocorr =       1.387657787396
   target nu stat err =       0.000443589633
   target dn stat err =       0.002869921994
      target stat err =       0.004539247115
              std dev =       0.532543633566
             le_variance =       0.283602721652

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.283640960291
                                         uncertainty =       0.001990865724

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.283640960291
                                         uncertainty =       0.001990865724

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000376565339
  error estimate for blocks of size 2^( 2) =       0.000394038465
  error estimate for blocks of size 2^( 3) =       0.000411499448
  error estimate for blocks of size 2^( 4) =       0.000427668558
  error estimate for blocks of size 2^( 5) =       0.000440991427
  error estimate for blocks of size 2^( 6) =       0.000449933200
  error estimate for blocks of size 2^( 7) =       0.000455752024

      target function =      -0.922558914467
              le_mean =     -16.898159281915
             les_mean =     285.841491465196
             stat err =       0.000443586302
             autocorr =       1.387636033768
   target nu stat err =       0.000443586302
   target dn stat err =       0.002874552740
      target stat err =       0.004544932854
              std dev =       0.532543808969
             le_variance =       0.283602908472

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.283640678521
                                         uncertainty =       0.001991206844

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.283640678521
                                         uncertainty =       0.001991206844

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000376565141
  error estimate for blocks of size 2^( 2) =       0.000394038723
  error estimate for blocks of size 2^( 3) =       0.000411499991
  error estimate for blocks of size 2^( 4) =       0.000427669279
  error estimate for blocks of size 2^( 5) =       0.000440992879
  error estimate for blocks of size 2^( 6) =       0.000449934917
  error estimate for blocks of size 2^( 7) =       0.000455754312

      target function =      -0.922719378395
              le_mean =     -16.898159362407
             les_mean =     285.841391328112
             stat err =       0.000443587847
             autocorr =       1.387647156577
   target nu stat err =       0.000443587847
   target dn stat err =       0.002871608388
      target stat err =       0.004541963307
              std dev =       0.532543529020
             le_variance =       0.283602610301

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.283640766220
                                         uncertainty =       0.001991524633

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.283640766220
                                         uncertainty =       0.001991524633

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000376565189
  error estimate for blocks of size 2^( 2) =       0.000394039167
  error estimate for blocks of size 2^( 3) =       0.000411500698
  error estimate for blocks of size 2^( 4) =       0.000427670055
  error estimate for blocks of size 2^( 5) =       0.000440994296
  error estimate for blocks of size 2^( 6) =       0.000449936671
  error estimate for blocks of size 2^( 7) =       0.000455756566

      target function =      -0.922700942950
              le_mean =     -16.898159465917
             les_mean =     285.841406660356
             stat err =       0.000443589397
             autocorr =       1.387656496377
   target nu stat err =       0.000443589397
   target dn stat err =       0.002870124515
      target stat err =       0.004539502551
              std dev =       0.532543597678
             le_variance =       0.283602683428


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.922706705727        initial
     2.3283e+00     2.3283e+01             1.6447e-04        -0.922558914467
     9.3132e+00     9.3132e+01             4.1131e-05        -0.922719378395  <--
     3.7253e+01     3.7253e+02             1.0284e-05        -0.922700942950

*****************************************************************************
Applying the update for shift_i =   9.3132e+00     and shift_s =   9.3132e+01
*****************************************************************************

  Execution time = 2.3492e+01
  </log>
  <optVariables href="H2O.s044.opt.xml">
ci_0001                 7.086048e-01 3 1  ON 0
ci_0002                 6.927486e-01 3 1  ON 1
ci_0003                -3.099988e-02 3 1  ON 2
ci_0004                -3.009199e-02 3 1  ON 3
ci_0005                -3.060778e-02 3 1  ON 4
ci_0006                -3.069201e-02 3 1  ON 5
ci_0007                -1.339101e-02 3 1  ON 6
ci_0008                -1.336078e-02 3 1  ON 7
ci_0009                -1.870456e-02 3 1  ON 8
ci_0010                -1.812922e-02 3 1  ON 9
ci_0011                -1.474693e-02 3 1  ON 10
ci_0012                -1.451184e-02 3 1  ON 11
ci_0013                 1.529755e-02 3 1  ON 12
ci_0014                 1.480401e-02 3 1  ON 13
ci_0015                 1.574367e-02 3 1  ON 14
ci_0016                 1.538708e-02 3 1  ON 15
ci_0017                 1.336937e-02 3 1  ON 16
ci_0018                 1.303855e-02 3 1  ON 17
ci_0019                 1.308997e-02 3 1  ON 18
ci_0020                 1.266672e-02 3 1  ON 19
ci_0021                 6.757815e-03 3 1  ON 20
ci_0022                 7.474575e-03 3 1  ON 21
ci_0023                -1.180393e-02 3 1  ON 22
ci_0024                -1.146799e-02 3 1  ON 23
ci_0025                -2.033199e-03 3 1  ON 24
ci_0026                -2.395286e-03 3 1  ON 25
ci_0027                -1.213137e-02 3 1  ON 26
ci_0028                -1.155279e-02 3 1  ON 27
ci_0029                -1.065653e-02 3 1  ON 28
ci_0030                -1.058137e-02 3 1  ON 29
ci_0031                 1.340930e-02 3 1  ON 30
ci_0032                 1.211557e-02 3 1  ON 31
ci_0033                 7.853743e-03 3 1  ON 32
ci_0034                 8.499383e-03 3 1  ON 33
ci_0035                 4.852649e-03 3 1  ON 34
ci_0036                 4.932676e-03 3 1  ON 35
ci_0037                -1.134573e-02 3 1  ON 36
ci_0038                -1.131447e-02 3 1  ON 37
ci_0039                -4.016622e-03 3 1  ON 38
ci_0040                -3.887590e-03 3 1  ON 39
ci_0041                 9.104328e-03 3 1  ON 40
ci_0042                 8.778774e-03 3 1  ON 41
ci_0043                -1.306087e-02 3 1  ON 42
ci_0044                -1.384681e-02 3 1  ON 43
ci_0045                 1.059461e-02 3 1  ON 44
ci_0046                 1.008715e-02 3 1  ON 45
ci_0047                -3.586119e-03 3 1  ON 46
ci_0048                -3.480430e-03 3 1  ON 47
ci_0049                -2.585240e-03 3 1  ON 48
ci_0050                -2.697425e-03 3 1  ON 49
ci_0051                -1.795619e-03 3 1  ON 50
ci_0052                -2.016717e-03 3 1  ON 51
ci_0053                -3.932264e-03 3 1  ON 52
ci_0054                -3.323374e-03 3 1  ON 53
ci_0055                 2.404769e-03 3 1  ON 54
ci_0056                 2.272190e-03 3 1  ON 55
ci_0057                 2.457046e-03 3 1  ON 56
ci_0058                 2.863970e-03 3 1  ON 57
ci_0059                -3.399599e-03 3 1  ON 58
ci_0060                -3.377932e-03 3 1  ON 59
ci_0061                -3.977639e-03 3 1  ON 60
ci_0062                -3.923065e-03 3 1  ON 61
ci_0063                -9.805101e-03 3 1  ON 62
ci_0064                -9.372259e-03 3 1  ON 63
ci_0065                -6.432757e-03 3 1  ON 64
ci_0066                -6.133036e-03 3 1  ON 65
ci_0067                -3.744194e-03 3 1  ON 66
ci_0068                -3.477994e-03 3 1  ON 67
ci_0069                 3.577319e-03 3 1  ON 68
ci_0070                 3.350931e-03 3 1  ON 69
ci_0071                 3.000950e-03 3 1  ON 70
ci_0072                 3.482780e-03 3 1  ON 71
ci_0073                 3.552621e-03 3 1  ON 72
ci_0074                 3.527932e-03 3 1  ON 73
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 4.0479e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s045 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s045 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=45  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6906e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 45
    time step          = 0.05
    reference energy   = -16.9038
    reference variance = 0.262888
====================================================
  Execution time = 1.4264e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s045
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5259e+04
  VMC Eavg = -1.6898e+01
  VMC Evar = 2.9254e-01
  Total weights = 1.950920473e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 2.5569e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.282333388562
                                         uncertainty =       0.001896484955

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.282333388562
                                         uncertainty =       0.001896484955

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000375764482
  error estimate for blocks of size 2^( 2) =       0.000392826649
  error estimate for blocks of size 2^( 3) =       0.000410426455
  error estimate for blocks of size 2^( 4) =       0.000425061533
  error estimate for blocks of size 2^( 5) =       0.000437344127
  error estimate for blocks of size 2^( 6) =       0.000443989099
  error estimate for blocks of size 2^( 7) =       0.000448365181

      target function =      -0.924381177175
              le_mean =     -16.897759358321
             les_mean =     285.826811198271
             stat err =       0.000438689985
             autocorr =       1.362962748726
   target nu stat err =       0.000438689985
   target dn stat err =       0.002180214547
      target stat err =       0.003490667919
              std dev =       0.531411226040
             le_variance =       0.282397891161


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.689775935832e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 74
Check correct_vf_var_size: 225, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.3283e+00, overlap shift 2.3283e+01 and omega -1.7444e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.924392885096       residual = 4.98e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.924401513570       residual = 9.41e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.924402857736       residual = 2.67e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.924403596791       residual = 1.28e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.924403988460       residual = 4.91e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.924404029512       residual = 2.54e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.924404124080       residual = 1.01e-05           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.924404171795       residual = 3.03e-06           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.924404189458       residual = 1.57e-06           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.924404175032       residual = 1.22e-06           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.924404162995       residual = 1.21e-06           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.924404179102       residual = 9.45e-07           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.924404189680       residual = 5.89e-07           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.924404205642       residual = 2.16e-07           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.924404206974       residual = 9.53e-08           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.924404212344       residual = 3.53e-08           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.924404211121       residual = 5.48e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         16 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 2.3283e+00 is 7.452023e-05

solving harmonic davidson linear method for identity shift 9.3132e+00, overlap shift 9.3132e+01 and omega -1.7444e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.924392885096       residual = 4.98e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.924395095752       residual = 9.37e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.924395438876       residual = 2.64e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.924395625927       residual = 1.26e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.924395724268       residual = 4.78e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.924395734269       residual = 2.44e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.924395757798       residual = 9.73e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.924395769589       residual = 2.91e-06           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.924395773971       residual = 1.51e-06           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.924395770355       residual = 1.18e-06           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.924395767331       residual = 1.16e-06           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.924395771446       residual = 8.90e-07           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.924395774106       residual = 5.39e-07           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.924395777927       residual = 1.93e-07           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.924395778254       residual = 8.47e-08           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.924395779523       residual = 3.06e-08           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.924395779220       residual = 4.68e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         16 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 9.3132e+00 is 1.886837e-05

solving harmonic davidson linear method for identity shift 3.7253e+01, overlap shift 3.7253e+02 and omega -1.7444e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.924392885096       residual = 4.98e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.924393441211       residual = 9.36e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.924393527446       residual = 2.63e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.924393574353       residual = 1.26e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.924393598963       residual = 4.75e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.924393601446       residual = 2.42e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.924393607321       residual = 9.63e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.924393610260       residual = 2.88e-06           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.924393611353       residual = 1.49e-06           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.924393610448       residual = 1.17e-06           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.924393609691       residual = 1.15e-06           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.924393610726       residual = 8.76e-07           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.924393611392       residual = 5.27e-07           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.924393612336       residual = 1.88e-07           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.924393612418       residual = 8.22e-08           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.924393612730       residual = 2.95e-08           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.924393612655       residual = 4.49e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         16 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 3.7253e+01 is 4.732220e-06

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.598064 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 75 and numParams is: 74

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.6835e+01
  </log>
  <optVariables href="H2O.s045.opt.xml">
ci_0001                 7.085959e-01 3 1  ON 0
ci_0002                 6.927576e-01 3 1  ON 1
ci_0003                -3.099233e-02 3 1  ON 2
ci_0004                -3.009409e-02 3 1  ON 3
ci_0005                -3.060745e-02 3 1  ON 4
ci_0006                -3.069802e-02 3 1  ON 5
ci_0007                -1.338598e-02 3 1  ON 6
ci_0008                -1.335686e-02 3 1  ON 7
ci_0009                -1.870058e-02 3 1  ON 8
ci_0010                -1.812880e-02 3 1  ON 9
ci_0011                -1.474599e-02 3 1  ON 10
ci_0012                -1.451390e-02 3 1  ON 11
ci_0013                 1.529531e-02 3 1  ON 12
ci_0014                 1.480735e-02 3 1  ON 13
ci_0015                 1.574627e-02 3 1  ON 14
ci_0016                 1.538523e-02 3 1  ON 15
ci_0017                 1.336939e-02 3 1  ON 16
ci_0018                 1.303954e-02 3 1  ON 17
ci_0019                 1.308714e-02 3 1  ON 18
ci_0020                 1.266608e-02 3 1  ON 19
ci_0021                 6.738947e-03 3 1  ON 20
ci_0022                 7.476047e-03 3 1  ON 21
ci_0023                -1.180266e-02 3 1  ON 22
ci_0024                -1.147028e-02 3 1  ON 23
ci_0025                -2.034828e-03 3 1  ON 24
ci_0026                -2.397463e-03 3 1  ON 25
ci_0027                -1.213196e-02 3 1  ON 26
ci_0028                -1.155288e-02 3 1  ON 27
ci_0029                -1.065967e-02 3 1  ON 28
ci_0030                -1.058058e-02 3 1  ON 29
ci_0031                 1.340519e-02 3 1  ON 30
ci_0032                 1.211613e-02 3 1  ON 31
ci_0033                 7.862811e-03 3 1  ON 32
ci_0034                 8.501745e-03 3 1  ON 33
ci_0035                 4.867333e-03 3 1  ON 34
ci_0036                 4.931034e-03 3 1  ON 35
ci_0037                -1.134804e-02 3 1  ON 36
ci_0038                -1.131443e-02 3 1  ON 37
ci_0039                -4.016007e-03 3 1  ON 38
ci_0040                -3.888530e-03 3 1  ON 39
ci_0041                 9.106581e-03 3 1  ON 40
ci_0042                 8.779551e-03 3 1  ON 41
ci_0043                -1.306584e-02 3 1  ON 42
ci_0044                -1.386546e-02 3 1  ON 43
ci_0045                 1.058516e-02 3 1  ON 44
ci_0046                 1.009327e-02 3 1  ON 45
ci_0047                -3.582979e-03 3 1  ON 46
ci_0048                -3.480259e-03 3 1  ON 47
ci_0049                -2.589790e-03 3 1  ON 48
ci_0050                -2.697520e-03 3 1  ON 49
ci_0051                -1.792859e-03 3 1  ON 50
ci_0052                -2.013642e-03 3 1  ON 51
ci_0053                -3.933175e-03 3 1  ON 52
ci_0054                -3.316550e-03 3 1  ON 53
ci_0055                 2.406439e-03 3 1  ON 54
ci_0056                 2.266114e-03 3 1  ON 55
ci_0057                 2.444363e-03 3 1  ON 56
ci_0058                 2.860214e-03 3 1  ON 57
ci_0059                -3.393018e-03 3 1  ON 58
ci_0060                -3.379328e-03 3 1  ON 59
ci_0061                -3.978445e-03 3 1  ON 60
ci_0062                -3.913457e-03 3 1  ON 61
ci_0063                -9.807750e-03 3 1  ON 62
ci_0064                -9.370483e-03 3 1  ON 63
ci_0065                -6.438678e-03 3 1  ON 64
ci_0066                -6.135551e-03 3 1  ON 65
ci_0067                -3.740128e-03 3 1  ON 66
ci_0068                -3.480698e-03 3 1  ON 67
ci_0069                 3.576614e-03 3 1  ON 68
ci_0070                 3.356144e-03 3 1  ON 69
ci_0071                 2.993342e-03 3 1  ON 70
ci_0072                 3.479894e-03 3 1  ON 71
ci_0073                 3.557859e-03 3 1  ON 72
ci_0074                 3.529013e-03 3 1  ON 73
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 45
    time step          = 0.05
    reference energy   = -16.8241
    reference variance = 0.181525
====================================================
  Execution time = 1.4155e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s045
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6899e+01
  VMC Evar = 2.9110e-01
  Total weights = 1.9509e+06
  Execution time = 1.8723e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.280678891394
                                         uncertainty =       0.001474385249

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.280678891394
                                         uncertainty =       0.001474385249

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000374590507
  error estimate for blocks of size 2^( 2) =       0.000391697255
  error estimate for blocks of size 2^( 3) =       0.000409189875
  error estimate for blocks of size 2^( 4) =       0.000425207953
  error estimate for blocks of size 2^( 5) =       0.000436373194
  error estimate for blocks of size 2^( 6) =       0.000444117647
  error estimate for blocks of size 2^( 7) =       0.000449975948

      target function =      -0.926685867828
              le_mean =     -16.898890002904
             les_mean =     285.863563871867
             stat err =       0.000438918685
             autocorr =       1.372949630027
   target nu stat err =       0.000438918685
   target dn stat err =       0.002601603292
      target stat err =       0.004166236514
              std dev =       0.529750975851
             le_variance =       0.280636096415

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.280672411421
                                         uncertainty =       0.001473775675

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.280672411421
                                         uncertainty =       0.001473775675

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000374586155
  error estimate for blocks of size 2^( 2) =       0.000391691956
  error estimate for blocks of size 2^( 3) =       0.000409183766
  error estimate for blocks of size 2^( 4) =       0.000425200301
  error estimate for blocks of size 2^( 5) =       0.000436364103
  error estimate for blocks of size 2^( 6) =       0.000444110043
  error estimate for blocks of size 2^( 7) =       0.000449968697

      target function =      -0.926482033725
              le_mean =     -16.898890018352
             les_mean =     285.863693732906
             stat err =       0.000438910786
             autocorr =       1.372932114016
   target nu stat err =       0.000438910786
   target dn stat err =       0.002609775440
      target stat err =       0.004177093576
              std dev =       0.529744821023
             le_variance =       0.280629575401

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.280675505551
                                         uncertainty =       0.001474071721

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.280675505551
                                         uncertainty =       0.001474071721

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000374588234
  error estimate for blocks of size 2^( 2) =       0.000391694502
  error estimate for blocks of size 2^( 3) =       0.000409186712
  error estimate for blocks of size 2^( 4) =       0.000425204005
  error estimate for blocks of size 2^( 5) =       0.000436368518
  error estimate for blocks of size 2^( 6) =       0.000444113726
  error estimate for blocks of size 2^( 7) =       0.000449972227

      target function =      -0.926603995953
              le_mean =     -16.898889996818
             les_mean =     285.863615609651
             stat err =       0.000438914619
             autocorr =       1.372940857181
   target nu stat err =       0.000438914619
   target dn stat err =       0.002604882804
      target stat err =       0.004170593639
              std dev =       0.529747760393
             le_variance =       0.280632689641

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.280678455233
                                         uncertainty =       0.001474345590

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.280678455233
                                         uncertainty =       0.001474345590

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000374590215
  error estimate for blocks of size 2^( 2) =       0.000391696902
  error estimate for blocks of size 2^( 3) =       0.000409189471
  error estimate for blocks of size 2^( 4) =       0.000425207450
  error estimate for blocks of size 2^( 5) =       0.000436372600
  error estimate for blocks of size 2^( 6) =       0.000444117147
  error estimate for blocks of size 2^( 7) =       0.000449975475

      target function =      -0.926677320749
              le_mean =     -16.898890000664
             les_mean =     285.863569218296
             stat err =       0.000438918168
             autocorr =       1.372948540921
   target nu stat err =       0.000438918168
   target dn stat err =       0.002601956920
      target stat err =       0.004166708866
              std dev =       0.529750561705
             le_variance =       0.280635657627


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.926685867828        initial  <--
     2.3283e+00     2.3283e+01             7.4520e-05        -0.926482033725
     9.3132e+00     9.3132e+01             1.8868e-05        -0.926603995953
     3.7253e+01     3.7253e+02             4.7322e-06        -0.926677320749

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 23.6126
  </log>
  <optVariables href="H2O.s045.opt.xml">
ci_0001                 7.086048e-01 3 1  ON 0
ci_0002                 6.927486e-01 3 1  ON 1
ci_0003                -3.099988e-02 3 1  ON 2
ci_0004                -3.009199e-02 3 1  ON 3
ci_0005                -3.060778e-02 3 1  ON 4
ci_0006                -3.069201e-02 3 1  ON 5
ci_0007                -1.339101e-02 3 1  ON 6
ci_0008                -1.336078e-02 3 1  ON 7
ci_0009                -1.870456e-02 3 1  ON 8
ci_0010                -1.812922e-02 3 1  ON 9
ci_0011                -1.474693e-02 3 1  ON 10
ci_0012                -1.451184e-02 3 1  ON 11
ci_0013                 1.529755e-02 3 1  ON 12
ci_0014                 1.480401e-02 3 1  ON 13
ci_0015                 1.574367e-02 3 1  ON 14
ci_0016                 1.538708e-02 3 1  ON 15
ci_0017                 1.336937e-02 3 1  ON 16
ci_0018                 1.303855e-02 3 1  ON 17
ci_0019                 1.308997e-02 3 1  ON 18
ci_0020                 1.266672e-02 3 1  ON 19
ci_0021                 6.757815e-03 3 1  ON 20
ci_0022                 7.474575e-03 3 1  ON 21
ci_0023                -1.180393e-02 3 1  ON 22
ci_0024                -1.146799e-02 3 1  ON 23
ci_0025                -2.033199e-03 3 1  ON 24
ci_0026                -2.395286e-03 3 1  ON 25
ci_0027                -1.213137e-02 3 1  ON 26
ci_0028                -1.155279e-02 3 1  ON 27
ci_0029                -1.065653e-02 3 1  ON 28
ci_0030                -1.058137e-02 3 1  ON 29
ci_0031                 1.340930e-02 3 1  ON 30
ci_0032                 1.211557e-02 3 1  ON 31
ci_0033                 7.853743e-03 3 1  ON 32
ci_0034                 8.499383e-03 3 1  ON 33
ci_0035                 4.852649e-03 3 1  ON 34
ci_0036                 4.932676e-03 3 1  ON 35
ci_0037                -1.134573e-02 3 1  ON 36
ci_0038                -1.131447e-02 3 1  ON 37
ci_0039                -4.016622e-03 3 1  ON 38
ci_0040                -3.887590e-03 3 1  ON 39
ci_0041                 9.104328e-03 3 1  ON 40
ci_0042                 8.778774e-03 3 1  ON 41
ci_0043                -1.306087e-02 3 1  ON 42
ci_0044                -1.384681e-02 3 1  ON 43
ci_0045                 1.059461e-02 3 1  ON 44
ci_0046                 1.008715e-02 3 1  ON 45
ci_0047                -3.586119e-03 3 1  ON 46
ci_0048                -3.480430e-03 3 1  ON 47
ci_0049                -2.585240e-03 3 1  ON 48
ci_0050                -2.697425e-03 3 1  ON 49
ci_0051                -1.795619e-03 3 1  ON 50
ci_0052                -2.016717e-03 3 1  ON 51
ci_0053                -3.932264e-03 3 1  ON 52
ci_0054                -3.323374e-03 3 1  ON 53
ci_0055                 2.404769e-03 3 1  ON 54
ci_0056                 2.272190e-03 3 1  ON 55
ci_0057                 2.457046e-03 3 1  ON 56
ci_0058                 2.863970e-03 3 1  ON 57
ci_0059                -3.399599e-03 3 1  ON 58
ci_0060                -3.377932e-03 3 1  ON 59
ci_0061                -3.977639e-03 3 1  ON 60
ci_0062                -3.923065e-03 3 1  ON 61
ci_0063                -9.805101e-03 3 1  ON 62
ci_0064                -9.372259e-03 3 1  ON 63
ci_0065                -6.432757e-03 3 1  ON 64
ci_0066                -6.133036e-03 3 1  ON 65
ci_0067                -3.744194e-03 3 1  ON 66
ci_0068                -3.477994e-03 3 1  ON 67
ci_0069                 3.577319e-03 3 1  ON 68
ci_0070                 3.350931e-03 3 1  ON 69
ci_0071                 3.000950e-03 3 1  ON 70
ci_0072                 3.482780e-03 3 1  ON 71
ci_0073                 3.552621e-03 3 1  ON 72
ci_0074                 3.527932e-03 3 1  ON 73
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 4.0454e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s046 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s046 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=46  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6905e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 46
    time step          = 0.05
    reference energy   = -16.8272
    reference variance = 0.217194
====================================================
  Execution time = 1.4218e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s046
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5215e+04
  VMC Eavg = -1.6899e+01
  VMC Evar = 2.9481e-01
  Total weights = 1.951040650e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 2.6535e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.283577711376
                                         uncertainty =       0.002106552961

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.283577711376
                                         uncertainty =       0.002106552961

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000376540538
  error estimate for blocks of size 2^( 2) =       0.000393232178
  error estimate for blocks of size 2^( 3) =       0.000411039664
  error estimate for blocks of size 2^( 4) =       0.000425851534
  error estimate for blocks of size 2^( 5) =       0.000437591798
  error estimate for blocks of size 2^( 6) =       0.000443871804
  error estimate for blocks of size 2^( 7) =       0.000449639238

      target function =      -0.920843507597
              le_mean =     -16.898514760192
             les_mean =     285.854607924452
             stat err =       0.000439238593
             autocorr =       1.360747379423
   target nu stat err =       0.000439238593
   target dn stat err =       0.003008279144
      target stat err =       0.004735247378
              std dev =       0.532508735666
             le_variance =       0.283565553561


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.689851476019e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 74
Check correct_vf_var_size: 225, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.3283e+01, overlap shift 2.3283e+02 and omega -1.7444e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.920866585906       residual = 2.09e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.920870920571       residual = 2.60e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.920871662149       residual = 8.53e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.920871942454       residual = 3.86e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.920872120553       residual = 1.08e-04           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.920872166439       residual = 5.91e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.920872172016       residual = 1.43e-05           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.920872167639       residual = 8.29e-06           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.920872165075       residual = 2.08e-06           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.920872164649       residual = 8.11e-07           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.920872164254       residual = 6.12e-07           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.920872164998       residual = 3.84e-07           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.920872165901       residual = 3.25e-07           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.920872165869       residual = 2.66e-07           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.920872164193       residual = 2.25e-07           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.920872163505       residual = 6.03e-08           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.920872163541       residual = 1.53e-08           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.920872163541       residual = 5.38e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         17 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 2.3283e+01 is 1.243068e-05

solving harmonic davidson linear method for identity shift 9.3132e+01, overlap shift 9.3132e+02 and omega -1.7444e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.920866585906       residual = 2.09e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.920867672271       residual = 2.60e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.920867857989       residual = 8.51e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.920867928128       residual = 3.85e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.920867972681       residual = 1.08e-04           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.920867984141       residual = 5.89e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.920867985523       residual = 1.42e-05           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.920867984426       residual = 8.24e-06           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.920867983785       residual = 2.07e-06           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.920867983679       residual = 8.08e-07           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.920867983580       residual = 6.10e-07           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.920867983766       residual = 3.83e-07           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.920867983992       residual = 3.24e-07           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.920867983982       residual = 2.65e-07           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.920867983563       residual = 2.23e-07           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.920867983393       residual = 5.95e-08           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.920867983402       residual = 1.51e-08           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.920867983402       residual = 5.30e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         17 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 9.3132e+01 is 3.113218e-06

solving harmonic davidson linear method for identity shift 3.7253e+02, overlap shift 3.7253e+03 and omega -1.7444e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.920866585906       residual = 2.09e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.920866857666       residual = 2.60e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.920866904116       residual = 8.51e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.920866921655       residual = 3.85e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.920866932794       residual = 1.08e-04           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.920866935659       residual = 5.88e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.920866936004       residual = 1.42e-05           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.920866935729       residual = 8.23e-06           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.920866935569       residual = 2.06e-06           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.920866935542       residual = 8.07e-07           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.920866935518       residual = 6.09e-07           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.920866935564       residual = 3.83e-07           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.920866935621       residual = 3.24e-07           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.920866935619       residual = 2.65e-07           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.920866935514       residual = 2.22e-07           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.920866935472       residual = 5.92e-08           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.920866935472       residual = 1.50e-08           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.920866935472       residual = 5.27e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         17 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 3.7253e+02 is 7.786521e-07

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.609843 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 75 and numParams is: 74

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.6888e+01
  </log>
  <optVariables href="H2O.s046.opt.xml">
ci_0001                 7.086044e-01 3 1  ON 0
ci_0002                 6.927493e-01 3 1  ON 1
ci_0003                -3.099962e-02 3 1  ON 2
ci_0004                -3.009220e-02 3 1  ON 3
ci_0005                -3.060686e-02 3 1  ON 4
ci_0006                -3.069241e-02 3 1  ON 5
ci_0007                -1.338909e-02 3 1  ON 6
ci_0008                -1.335890e-02 3 1  ON 7
ci_0009                -1.870256e-02 3 1  ON 8
ci_0010                -1.812951e-02 3 1  ON 9
ci_0011                -1.474639e-02 3 1  ON 10
ci_0012                -1.451164e-02 3 1  ON 11
ci_0013                 1.529733e-02 3 1  ON 12
ci_0014                 1.480461e-02 3 1  ON 13
ci_0015                 1.574463e-02 3 1  ON 14
ci_0016                 1.538676e-02 3 1  ON 15
ci_0017                 1.336905e-02 3 1  ON 16
ci_0018                 1.303855e-02 3 1  ON 17
ci_0019                 1.309004e-02 3 1  ON 18
ci_0020                 1.266694e-02 3 1  ON 19
ci_0021                 6.757250e-03 3 1  ON 20
ci_0022                 7.472481e-03 3 1  ON 21
ci_0023                -1.180377e-02 3 1  ON 22
ci_0024                -1.146826e-02 3 1  ON 23
ci_0025                -2.032106e-03 3 1  ON 24
ci_0026                -2.394589e-03 3 1  ON 25
ci_0027                -1.213130e-02 3 1  ON 26
ci_0028                -1.155188e-02 3 1  ON 27
ci_0029                -1.065666e-02 3 1  ON 28
ci_0030                -1.058249e-02 3 1  ON 29
ci_0031                 1.340975e-02 3 1  ON 30
ci_0032                 1.211483e-02 3 1  ON 31
ci_0033                 7.852479e-03 3 1  ON 32
ci_0034                 8.497348e-03 3 1  ON 33
ci_0035                 4.853758e-03 3 1  ON 34
ci_0036                 4.932743e-03 3 1  ON 35
ci_0037                -1.134262e-02 3 1  ON 36
ci_0038                -1.131462e-02 3 1  ON 37
ci_0039                -4.016342e-03 3 1  ON 38
ci_0040                -3.887327e-03 3 1  ON 39
ci_0041                 9.104271e-03 3 1  ON 40
ci_0042                 8.779289e-03 3 1  ON 41
ci_0043                -1.306300e-02 3 1  ON 42
ci_0044                -1.384677e-02 3 1  ON 43
ci_0045                 1.059430e-02 3 1  ON 44
ci_0046                 1.008535e-02 3 1  ON 45
ci_0047                -3.585963e-03 3 1  ON 46
ci_0048                -3.480688e-03 3 1  ON 47
ci_0049                -2.588068e-03 3 1  ON 48
ci_0050                -2.697307e-03 3 1  ON 49
ci_0051                -1.796000e-03 3 1  ON 50
ci_0052                -2.016907e-03 3 1  ON 51
ci_0053                -3.932204e-03 3 1  ON 52
ci_0054                -3.323534e-03 3 1  ON 53
ci_0055                 2.403394e-03 3 1  ON 54
ci_0056                 2.271479e-03 3 1  ON 55
ci_0057                 2.457494e-03 3 1  ON 56
ci_0058                 2.862641e-03 3 1  ON 57
ci_0059                -3.399053e-03 3 1  ON 58
ci_0060                -3.377116e-03 3 1  ON 59
ci_0061                -3.977521e-03 3 1  ON 60
ci_0062                -3.922891e-03 3 1  ON 61
ci_0063                -9.804762e-03 3 1  ON 62
ci_0064                -9.372288e-03 3 1  ON 63
ci_0065                -6.433396e-03 3 1  ON 64
ci_0066                -6.133008e-03 3 1  ON 65
ci_0067                -3.745109e-03 3 1  ON 66
ci_0068                -3.478192e-03 3 1  ON 67
ci_0069                 3.575692e-03 3 1  ON 68
ci_0070                 3.350352e-03 3 1  ON 69
ci_0071                 3.002007e-03 3 1  ON 70
ci_0072                 3.482503e-03 3 1  ON 71
ci_0073                 3.552392e-03 3 1  ON 72
ci_0074                 3.528139e-03 3 1  ON 73
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 46
    time step          = 0.05
    reference energy   = -16.9101
    reference variance = 0.535786
====================================================
  Execution time = 1.4011e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s046
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6898e+01
  VMC Evar = 2.9338e-01
  Total weights = 1.9510e+06
  Execution time = 1.8668e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.282576465594
                                         uncertainty =       0.001565890134

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.282576465594
                                         uncertainty =       0.001565890134

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000375884122
  error estimate for blocks of size 2^( 2) =       0.000393076503
  error estimate for blocks of size 2^( 3) =       0.000410447041
  error estimate for blocks of size 2^( 4) =       0.000426037463
  error estimate for blocks of size 2^( 5) =       0.000438436848
  error estimate for blocks of size 2^( 6) =       0.000447629675
  error estimate for blocks of size 2^( 7) =       0.000452665227

      target function =      -0.923068266558
              le_mean =     -16.897945381922
             les_mean =     285.833937879354
             stat err =       0.000441192303
             autocorr =       1.377678537908
   target nu stat err =       0.000441192303
   target dn stat err =       0.002569331246
      target stat err =       0.004078300892
              std dev =       0.531580423449
             le_variance =       0.282577746594

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.282573226448
                                         uncertainty =       0.001565744728

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.282573226448
                                         uncertainty =       0.001565744728

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000375881973
  error estimate for blocks of size 2^( 2) =       0.000393074458
  error estimate for blocks of size 2^( 3) =       0.000410445172
  error estimate for blocks of size 2^( 4) =       0.000426035623
  error estimate for blocks of size 2^( 5) =       0.000438434977
  error estimate for blocks of size 2^( 6) =       0.000447628065
  error estimate for blocks of size 2^( 7) =       0.000452663325

      target function =      -0.923070711549
              le_mean =     -16.897945472538
             les_mean =     285.833939381870
             stat err =       0.000441190498
             autocorr =       1.377683016382
   target nu stat err =       0.000441190498
   target dn stat err =       0.002568621743
      target stat err =       0.004077233685
              std dev =       0.531577383839
             le_variance =       0.282574515009

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.282574839094
                                         uncertainty =       0.001565817204

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.282574839094
                                         uncertainty =       0.001565817204

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000375883043
  error estimate for blocks of size 2^( 2) =       0.000393075476
  error estimate for blocks of size 2^( 3) =       0.000410446102
  error estimate for blocks of size 2^( 4) =       0.000426036539
  error estimate for blocks of size 2^( 5) =       0.000438435908
  error estimate for blocks of size 2^( 6) =       0.000447628866
  error estimate for blocks of size 2^( 7) =       0.000452664272

      target function =      -0.923069925011
              le_mean =     -16.897945426866
             les_mean =     285.833938338968
             stat err =       0.000441191396
             autocorr =       1.377680785433
   target nu stat err =       0.000441191396
   target dn stat err =       0.002568971901
      target stat err =       0.004077764026
              std dev =       0.531578897142
             le_variance =       0.282576123887

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.282576261780
                                         uncertainty =       0.001565881003

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.282576261780
                                         uncertainty =       0.001565881003

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000375883987
  error estimate for blocks of size 2^( 2) =       0.000393076374
  error estimate for blocks of size 2^( 3) =       0.000410446924
  error estimate for blocks of size 2^( 4) =       0.000426037347
  error estimate for blocks of size 2^( 5) =       0.000438436730
  error estimate for blocks of size 2^( 6) =       0.000447629574
  error estimate for blocks of size 2^( 7) =       0.000452665107

      target function =      -0.923068525726
              le_mean =     -16.897945387493
             les_mean =     285.833937901975
             stat err =       0.000441192190
             autocorr =       1.377678819436
   target nu stat err =       0.000441192190
   target dn stat err =       0.002569285890
      target stat err =       0.004078233561
              std dev =       0.531580232190
             le_variance =       0.282577543255


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.923068266558        initial
     2.3283e+01     2.3283e+02             1.2431e-05        -0.923070711549  <--
     9.3132e+01     9.3132e+02             3.1132e-06        -0.923069925011
     3.7253e+02     3.7253e+03             7.7865e-07        -0.923068525726

*****************************************************************************
Applying the update for shift_i =   2.3283e+01     and shift_s =   2.3283e+02
*****************************************************************************

  Execution time = 2.3471e+01
  </log>
  <optVariables href="H2O.s046.opt.xml">
ci_0001                 7.086031e-01 3 1  ON 0
ci_0002                 6.927514e-01 3 1  ON 1
ci_0003                -3.099885e-02 3 1  ON 2
ci_0004                -3.009285e-02 3 1  ON 3
ci_0005                -3.060409e-02 3 1  ON 4
ci_0006                -3.069363e-02 3 1  ON 5
ci_0007                -1.338332e-02 3 1  ON 6
ci_0008                -1.335326e-02 3 1  ON 7
ci_0009                -1.869658e-02 3 1  ON 8
ci_0010                -1.813037e-02 3 1  ON 9
ci_0011                -1.474476e-02 3 1  ON 10
ci_0012                -1.451103e-02 3 1  ON 11
ci_0013                 1.529667e-02 3 1  ON 12
ci_0014                 1.480641e-02 3 1  ON 13
ci_0015                 1.574751e-02 3 1  ON 14
ci_0016                 1.538579e-02 3 1  ON 15
ci_0017                 1.336812e-02 3 1  ON 16
ci_0018                 1.303856e-02 3 1  ON 17
ci_0019                 1.309026e-02 3 1  ON 18
ci_0020                 1.266759e-02 3 1  ON 19
ci_0021                 6.755558e-03 3 1  ON 20
ci_0022                 7.466211e-03 3 1  ON 21
ci_0023                -1.180330e-02 3 1  ON 22
ci_0024                -1.146908e-02 3 1  ON 23
ci_0025                -2.028838e-03 3 1  ON 24
ci_0026                -2.392504e-03 3 1  ON 25
ci_0027                -1.213107e-02 3 1  ON 26
ci_0028                -1.154918e-02 3 1  ON 27
ci_0029                -1.065707e-02 3 1  ON 28
ci_0030                -1.058584e-02 3 1  ON 29
ci_0031                 1.341109e-02 3 1  ON 30
ci_0032                 1.211263e-02 3 1  ON 31
ci_0033                 7.848696e-03 3 1  ON 32
ci_0034                 8.491254e-03 3 1  ON 33
ci_0035                 4.857072e-03 3 1  ON 34
ci_0036                 4.932943e-03 3 1  ON 35
ci_0037                -1.133330e-02 3 1  ON 36
ci_0038                -1.131507e-02 3 1  ON 37
ci_0039                -4.015505e-03 3 1  ON 38
ci_0040                -3.886539e-03 3 1  ON 39
ci_0041                 9.104099e-03 3 1  ON 40
ci_0042                 8.780830e-03 3 1  ON 41
ci_0043                -1.306938e-02 3 1  ON 42
ci_0044                -1.384664e-02 3 1  ON 43
ci_0045                 1.059336e-02 3 1  ON 44
ci_0046                 1.007996e-02 3 1  ON 45
ci_0047                -3.585498e-03 3 1  ON 46
ci_0048                -3.481460e-03 3 1  ON 47
ci_0049                -2.596523e-03 3 1  ON 48
ci_0050                -2.696955e-03 3 1  ON 49
ci_0051                -1.797139e-03 3 1  ON 50
ci_0052                -2.017475e-03 3 1  ON 51
ci_0053                -3.932025e-03 3 1  ON 52
ci_0054                -3.324011e-03 3 1  ON 53
ci_0055                 2.399282e-03 3 1  ON 54
ci_0056                 2.269353e-03 3 1  ON 55
ci_0057                 2.458834e-03 3 1  ON 56
ci_0058                 2.858669e-03 3 1  ON 57
ci_0059                -3.397422e-03 3 1  ON 58
ci_0060                -3.374678e-03 3 1  ON 59
ci_0061                -3.977170e-03 3 1  ON 60
ci_0062                -3.922371e-03 3 1  ON 61
ci_0063                -9.803748e-03 3 1  ON 62
ci_0064                -9.372374e-03 3 1  ON 63
ci_0065                -6.435306e-03 3 1  ON 64
ci_0066                -6.132924e-03 3 1  ON 65
ci_0067                -3.747844e-03 3 1  ON 66
ci_0068                -3.478783e-03 3 1  ON 67
ci_0069                 3.570829e-03 3 1  ON 68
ci_0070                 3.348621e-03 3 1  ON 69
ci_0071                 3.005166e-03 3 1  ON 70
ci_0072                 3.481676e-03 3 1  ON 71
ci_0073                 3.551709e-03 3 1  ON 72
ci_0074                 3.528760e-03 3 1  ON 73
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 4.0365e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s047 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s047 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=47  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6904e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 47
    time step          = 0.05
    reference energy   = -16.8744
    reference variance = 0.197034
====================================================
  Execution time = 1.4215e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s047
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5271e+04
  VMC Eavg = -1.6898e+01
  VMC Evar = 2.9330e-01
  Total weights = 1.950847772e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 2.5896e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.283810161942
                                         uncertainty =       0.001639520058

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.283810161942
                                         uncertainty =       0.001639520058

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000376773678
  error estimate for blocks of size 2^( 2) =       0.000393592778
  error estimate for blocks of size 2^( 3) =       0.000411169243
  error estimate for blocks of size 2^( 4) =       0.000425196280
  error estimate for blocks of size 2^( 5) =       0.000436412875
  error estimate for blocks of size 2^( 6) =       0.000445629458
  error estimate for blocks of size 2^( 7) =       0.000448214077

      target function =      -0.923207058895
              le_mean =     -16.898365934558
             les_mean =     285.848067270580
             stat err =       0.000438863172
             autocorr =       1.356741678090
   target nu stat err =       0.000438863172
   target dn stat err =       0.002244759526
      target stat err =       0.003584525091
              std dev =       0.532838445712
             le_variance =       0.283916809229


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.689836593456e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 74
Check correct_vf_var_size: 225, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 5.8208e+00, overlap shift 5.8208e+01 and omega -1.7444e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.923219607206       residual = 5.32e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.923224171570       residual = 6.95e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.923224786157       residual = 1.57e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.923224863828       residual = 1.09e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.923224989100       residual = 5.10e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.923225005931       residual = 2.02e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.923224998435       residual = 1.76e-05           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.923225004060       residual = 6.55e-06           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.923225021995       residual = 4.59e-06           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.923225048004       residual = 5.45e-06           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.923225035236       residual = 3.81e-06           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.923225035400       residual = 2.71e-06           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.923225055270       residual = 7.67e-07           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.923225052612       residual = 2.99e-07           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.923225054482       residual = 1.05e-07           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.923225053087       residual = 3.57e-08           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.923225052533       residual = 1.04e-08           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.923225052694       residual = 3.02e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         17 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 5.8208e+00 is 2.675402e-05

solving harmonic davidson linear method for identity shift 2.3283e+01, overlap shift 2.3283e+02 and omega -1.7444e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.923219607206       residual = 5.32e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.923220759627       residual = 6.94e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.923220914541       residual = 1.56e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.923220934014       residual = 1.08e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.923220965436       residual = 5.05e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.923220969605       residual = 2.00e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.923220967693       residual = 1.74e-05           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.923220969102       residual = 6.47e-06           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.923220973594       residual = 4.55e-06           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.923220980112       residual = 5.39e-06           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.923220976893       residual = 3.73e-06           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.923220976933       residual = 2.62e-06           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.923220981847       residual = 7.36e-07           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.923220981182       residual = 2.87e-07           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.923220981639       residual = 1.00e-07           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.923220981293       residual = 3.38e-08           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.923220981157       residual = 9.82e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         16 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 2.3283e+01 is 6.757471e-06

solving harmonic davidson linear method for identity shift 9.3132e+01, overlap shift 9.3132e+02 and omega -1.7444e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.923219607206       residual = 5.32e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.923219896028       residual = 6.94e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.923219934836       residual = 1.56e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.923219939708       residual = 1.08e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.923219947570       residual = 5.04e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.923219948610       residual = 2.00e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.923219948129       residual = 1.73e-05           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.923219948482       residual = 6.45e-06           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.923219949605       residual = 4.54e-06           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.923219951236       residual = 5.37e-06           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.923219950429       residual = 3.71e-06           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.923219950439       residual = 2.60e-06           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.923219951665       residual = 7.28e-07           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.923219951498       residual = 2.84e-07           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.923219951612       residual = 9.89e-08           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.923219951525       residual = 3.33e-08           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.923219951492       residual = 9.67e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         16 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 9.3132e+01 is 1.693558e-06

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.619309 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 75 and numParams is: 74

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.6820e+01
  </log>
  <optVariables href="H2O.s047.opt.xml">
ci_0001                 7.086097e-01 3 1  ON 0
ci_0002                 6.927448e-01 3 1  ON 1
ci_0003                -3.099652e-02 3 1  ON 2
ci_0004                -3.009304e-02 3 1  ON 3
ci_0005                -3.060549e-02 3 1  ON 4
ci_0006                -3.069117e-02 3 1  ON 5
ci_0007                -1.338406e-02 3 1  ON 6
ci_0008                -1.335137e-02 3 1  ON 7
ci_0009                -1.869727e-02 3 1  ON 8
ci_0010                -1.812978e-02 3 1  ON 9
ci_0011                -1.474436e-02 3 1  ON 10
ci_0012                -1.451191e-02 3 1  ON 11
ci_0013                 1.529724e-02 3 1  ON 12
ci_0014                 1.480505e-02 3 1  ON 13
ci_0015                 1.574880e-02 3 1  ON 14
ci_0016                 1.538545e-02 3 1  ON 15
ci_0017                 1.336663e-02 3 1  ON 16
ci_0018                 1.303936e-02 3 1  ON 17
ci_0019                 1.308964e-02 3 1  ON 18
ci_0020                 1.266678e-02 3 1  ON 19
ci_0021                 6.751589e-03 3 1  ON 20
ci_0022                 7.461377e-03 3 1  ON 21
ci_0023                -1.180269e-02 3 1  ON 22
ci_0024                -1.146960e-02 3 1  ON 23
ci_0025                -2.030106e-03 3 1  ON 24
ci_0026                -2.391888e-03 3 1  ON 25
ci_0027                -1.213037e-02 3 1  ON 26
ci_0028                -1.154966e-02 3 1  ON 27
ci_0029                -1.066040e-02 3 1  ON 28
ci_0030                -1.058706e-02 3 1  ON 29
ci_0031                 1.340865e-02 3 1  ON 30
ci_0032                 1.211305e-02 3 1  ON 31
ci_0033                 7.851191e-03 3 1  ON 32
ci_0034                 8.490071e-03 3 1  ON 33
ci_0035                 4.858880e-03 3 1  ON 34
ci_0036                 4.937005e-03 3 1  ON 35
ci_0037                -1.132935e-02 3 1  ON 36
ci_0038                -1.131389e-02 3 1  ON 37
ci_0039                -4.016242e-03 3 1  ON 38
ci_0040                -3.887119e-03 3 1  ON 39
ci_0041                 9.106520e-03 3 1  ON 40
ci_0042                 8.780666e-03 3 1  ON 41
ci_0043                -1.307227e-02 3 1  ON 42
ci_0044                -1.384665e-02 3 1  ON 43
ci_0045                 1.059126e-02 3 1  ON 44
ci_0046                 1.008062e-02 3 1  ON 45
ci_0047                -3.586028e-03 3 1  ON 46
ci_0048                -3.480155e-03 3 1  ON 47
ci_0049                -2.603281e-03 3 1  ON 48
ci_0050                -2.701349e-03 3 1  ON 49
ci_0051                -1.797914e-03 3 1  ON 50
ci_0052                -2.017319e-03 3 1  ON 51
ci_0053                -3.931511e-03 3 1  ON 52
ci_0054                -3.324451e-03 3 1  ON 53
ci_0055                 2.402139e-03 3 1  ON 54
ci_0056                 2.268644e-03 3 1  ON 55
ci_0057                 2.459499e-03 3 1  ON 56
ci_0058                 2.860997e-03 3 1  ON 57
ci_0059                -3.395798e-03 3 1  ON 58
ci_0060                -3.377081e-03 3 1  ON 59
ci_0061                -3.977152e-03 3 1  ON 60
ci_0062                -3.922947e-03 3 1  ON 61
ci_0063                -9.802322e-03 3 1  ON 62
ci_0064                -9.372809e-03 3 1  ON 63
ci_0065                -6.434838e-03 3 1  ON 64
ci_0066                -6.132359e-03 3 1  ON 65
ci_0067                -3.749077e-03 3 1  ON 66
ci_0068                -3.476648e-03 3 1  ON 67
ci_0069                 3.572159e-03 3 1  ON 68
ci_0070                 3.348530e-03 3 1  ON 69
ci_0071                 3.006091e-03 3 1  ON 70
ci_0072                 3.481402e-03 3 1  ON 71
ci_0073                 3.549530e-03 3 1  ON 72
ci_0074                 3.526822e-03 3 1  ON 73
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 47
    time step          = 0.05
    reference energy   = -16.9121
    reference variance = 0.193328
====================================================
  Execution time = 1.4262e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s047
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6899e+01
  VMC Evar = 2.9688e-01
  Total weights = 1.9511e+06
  Execution time = 1.8740e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.284449056966
                                         uncertainty =       0.002347407571

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.284449056966
                                         uncertainty =       0.002347407571

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000377190300
  error estimate for blocks of size 2^( 2) =       0.000393896133
  error estimate for blocks of size 2^( 3) =       0.000410974593
  error estimate for blocks of size 2^( 4) =       0.000425791856
  error estimate for blocks of size 2^( 5) =       0.000436787732
  error estimate for blocks of size 2^( 6) =       0.000444891402
  error estimate for blocks of size 2^( 7) =       0.000451129350

      target function =      -0.917630619716
              le_mean =     -16.898509420553
             les_mean =     285.856493652682
             stat err =       0.000439650085
             autocorr =       1.358605257054
   target nu stat err =       0.000439650085
   target dn stat err =       0.003722846261
      target stat err =       0.005794824064
              std dev =       0.533427638222
             le_variance =       0.284545045219

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.284448106239
                                         uncertainty =       0.002347294472

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.284448106239
                                         uncertainty =       0.002347294472

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000377189669
  error estimate for blocks of size 2^( 2) =       0.000393894823
  error estimate for blocks of size 2^( 3) =       0.000410972461
  error estimate for blocks of size 2^( 4) =       0.000425789019
  error estimate for blocks of size 2^( 5) =       0.000436784403
  error estimate for blocks of size 2^( 6) =       0.000444887729
  error estimate for blocks of size 2^( 7) =       0.000451123481

      target function =      -0.917606997943
              le_mean =     -16.898509043745
             les_mean =     285.856496229612
             stat err =       0.000439646158
             autocorr =       1.358585530933
   target nu stat err =       0.000439646158
   target dn stat err =       0.003722042100
      target stat err =       0.005793291939
              std dev =       0.533426746192
             le_variance =       0.284544093552

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.284448563759
                                         uncertainty =       0.002347350180

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.284448563759
                                         uncertainty =       0.002347350180

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000377189973
  error estimate for blocks of size 2^( 2) =       0.000393895463
  error estimate for blocks of size 2^( 3) =       0.000410973509
  error estimate for blocks of size 2^( 4) =       0.000425790416
  error estimate for blocks of size 2^( 5) =       0.000436786045
  error estimate for blocks of size 2^( 6) =       0.000444889541
  error estimate for blocks of size 2^( 7) =       0.000451126383

      target function =      -0.917619536375
              le_mean =     -16.898509228651
             les_mean =     285.856494351721
             stat err =       0.000439648096
             autocorr =       1.358595323278
   target nu stat err =       0.000439648096
   target dn stat err =       0.003722428119
      target stat err =       0.005794042460
              std dev =       0.533427175434
             le_variance =       0.284544551491

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.284448993475
                                         uncertainty =       0.002347400323

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.284448993475
                                         uncertainty =       0.002347400323

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000377190258
  error estimate for blocks of size 2^( 2) =       0.000393896048
  error estimate for blocks of size 2^( 3) =       0.000410974456
  error estimate for blocks of size 2^( 4) =       0.000425791674
  error estimate for blocks of size 2^( 5) =       0.000436787520
  error estimate for blocks of size 2^( 6) =       0.000444891167
  error estimate for blocks of size 2^( 7) =       0.000451128977

      target function =      -0.917629303970
              le_mean =     -16.898509396295
             les_mean =     285.856493685788
             stat err =       0.000439649835
             autocorr =       1.358604014139
   target nu stat err =       0.000439649835
   target dn stat err =       0.003722792937
      target stat err =       0.005794725614
              std dev =       0.533427578647
             le_variance =       0.284544981662


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.917630619716        initial  <--
     5.8208e+00     5.8208e+01             2.6754e-05        -0.917606997943
     2.3283e+01     2.3283e+02             6.7575e-06        -0.917619536375
     9.3132e+01     9.3132e+02             1.6936e-06        -0.917629303970

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 27.8133
  </log>
  <optVariables href="H2O.s047.opt.xml">
ci_0001                 7.086031e-01 3 1  ON 0
ci_0002                 6.927514e-01 3 1  ON 1
ci_0003                -3.099885e-02 3 1  ON 2
ci_0004                -3.009285e-02 3 1  ON 3
ci_0005                -3.060409e-02 3 1  ON 4
ci_0006                -3.069363e-02 3 1  ON 5
ci_0007                -1.338332e-02 3 1  ON 6
ci_0008                -1.335326e-02 3 1  ON 7
ci_0009                -1.869658e-02 3 1  ON 8
ci_0010                -1.813037e-02 3 1  ON 9
ci_0011                -1.474476e-02 3 1  ON 10
ci_0012                -1.451103e-02 3 1  ON 11
ci_0013                 1.529667e-02 3 1  ON 12
ci_0014                 1.480641e-02 3 1  ON 13
ci_0015                 1.574751e-02 3 1  ON 14
ci_0016                 1.538579e-02 3 1  ON 15
ci_0017                 1.336812e-02 3 1  ON 16
ci_0018                 1.303856e-02 3 1  ON 17
ci_0019                 1.309026e-02 3 1  ON 18
ci_0020                 1.266759e-02 3 1  ON 19
ci_0021                 6.755558e-03 3 1  ON 20
ci_0022                 7.466211e-03 3 1  ON 21
ci_0023                -1.180330e-02 3 1  ON 22
ci_0024                -1.146908e-02 3 1  ON 23
ci_0025                -2.028838e-03 3 1  ON 24
ci_0026                -2.392504e-03 3 1  ON 25
ci_0027                -1.213107e-02 3 1  ON 26
ci_0028                -1.154918e-02 3 1  ON 27
ci_0029                -1.065707e-02 3 1  ON 28
ci_0030                -1.058584e-02 3 1  ON 29
ci_0031                 1.341109e-02 3 1  ON 30
ci_0032                 1.211263e-02 3 1  ON 31
ci_0033                 7.848696e-03 3 1  ON 32
ci_0034                 8.491254e-03 3 1  ON 33
ci_0035                 4.857072e-03 3 1  ON 34
ci_0036                 4.932943e-03 3 1  ON 35
ci_0037                -1.133330e-02 3 1  ON 36
ci_0038                -1.131507e-02 3 1  ON 37
ci_0039                -4.015505e-03 3 1  ON 38
ci_0040                -3.886539e-03 3 1  ON 39
ci_0041                 9.104099e-03 3 1  ON 40
ci_0042                 8.780830e-03 3 1  ON 41
ci_0043                -1.306938e-02 3 1  ON 42
ci_0044                -1.384664e-02 3 1  ON 43
ci_0045                 1.059336e-02 3 1  ON 44
ci_0046                 1.007996e-02 3 1  ON 45
ci_0047                -3.585498e-03 3 1  ON 46
ci_0048                -3.481460e-03 3 1  ON 47
ci_0049                -2.596523e-03 3 1  ON 48
ci_0050                -2.696955e-03 3 1  ON 49
ci_0051                -1.797139e-03 3 1  ON 50
ci_0052                -2.017475e-03 3 1  ON 51
ci_0053                -3.932025e-03 3 1  ON 52
ci_0054                -3.324011e-03 3 1  ON 53
ci_0055                 2.399282e-03 3 1  ON 54
ci_0056                 2.269353e-03 3 1  ON 55
ci_0057                 2.458834e-03 3 1  ON 56
ci_0058                 2.858669e-03 3 1  ON 57
ci_0059                -3.397422e-03 3 1  ON 58
ci_0060                -3.374678e-03 3 1  ON 59
ci_0061                -3.977170e-03 3 1  ON 60
ci_0062                -3.922371e-03 3 1  ON 61
ci_0063                -9.803748e-03 3 1  ON 62
ci_0064                -9.372374e-03 3 1  ON 63
ci_0065                -6.435306e-03 3 1  ON 64
ci_0066                -6.132924e-03 3 1  ON 65
ci_0067                -3.747844e-03 3 1  ON 66
ci_0068                -3.478783e-03 3 1  ON 67
ci_0069                 3.570829e-03 3 1  ON 68
ci_0070                 3.348621e-03 3 1  ON 69
ci_0071                 3.005166e-03 3 1  ON 70
ci_0072                 3.481676e-03 3 1  ON 71
ci_0073                 3.551709e-03 3 1  ON 72
ci_0074                 3.528760e-03 3 1  ON 73
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 4.4639e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s048 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s048 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=48  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6904e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 48
    time step          = 0.05
    reference energy   = -16.9938
    reference variance = 0.359465
====================================================
  Execution time = 1.6340e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s048
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5259e+04
  VMC Eavg = -1.6899e+01
  VMC Evar = 2.9476e-01
  Total weights = 1.951080783e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 2.5770e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.283090814266
                                         uncertainty =       0.002042575987

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.283090814266
                                         uncertainty =       0.002042575987

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000376218213
  error estimate for blocks of size 2^( 2) =       0.000393681266
  error estimate for blocks of size 2^( 3) =       0.000411785674
  error estimate for blocks of size 2^( 4) =       0.000427427261
  error estimate for blocks of size 2^( 5) =       0.000440338231
  error estimate for blocks of size 2^( 6) =       0.000446666057
  error estimate for blocks of size 2^( 7) =       0.000450142134

      target function =      -0.920889401552
              le_mean =     -16.898836723667
             les_mean =     285.865446635204
             stat err =       0.000441143421
             autocorr =       1.374928077605
   target nu stat err =       0.000441143421
   target dn stat err =       0.004216791416
      target stat err =       0.006602520980
              std dev =       0.532052899218
             le_variance =       0.283080287566


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.689883672367e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 74
Check correct_vf_var_size: 225, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 5.8208e+01, overlap shift 5.8208e+02 and omega -1.7444e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.920935493348       residual = 9.91e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.920936363139       residual = 1.63e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.920936476607       residual = 4.49e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.920936530277       residual = 2.83e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.920936574346       residual = 8.10e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.920936588921       residual = 6.10e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.920936601161       residual = 3.37e-05           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.920936608364       residual = 3.38e-05           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.920936615982       residual = 3.76e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.920936617886       residual = 1.87e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.920936616914       residual = 1.01e-05           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.920936616968       residual = 3.78e-06           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.920936617645       residual = 1.25e-06           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.920936618539       residual = 3.39e-07           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.920936618109       residual = 9.74e-08           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.920936618132       residual = 2.25e-08           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.920936618065       residual = 5.25e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         16 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 5.8208e+01 is 6.520085e-06

solving harmonic davidson linear method for identity shift 2.3283e+02, overlap shift 2.3283e+03 and omega -1.7444e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.920935493348       residual = 9.91e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.920935711014       residual = 1.63e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.920935739404       residual = 4.49e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.920935752827       residual = 2.83e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.920935763847       residual = 8.09e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.920935767491       residual = 6.09e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.920935770551       residual = 3.36e-05           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.920935772352       residual = 3.38e-05           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.920935774255       residual = 3.76e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.920935774729       residual = 1.86e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.920935774485       residual = 1.01e-05           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.920935774499       residual = 3.76e-06           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.920935774667       residual = 1.24e-06           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.920935774891       residual = 3.37e-07           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.920935774783       residual = 9.68e-08           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.920935774789       residual = 2.24e-08           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.920935774772       residual = 5.22e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         16 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 2.3283e+02 is 1.630060e-06

solving harmonic davidson linear method for identity shift 9.3132e+02, overlap shift 9.3132e+03 and omega -1.7444e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.920935493348       residual = 9.91e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.920935547778       residual = 1.63e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.920935554877       residual = 4.49e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.920935558233       residual = 2.83e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.920935560988       residual = 8.09e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.920935561899       residual = 6.09e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.920935562664       residual = 3.36e-05           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.920935563115       residual = 3.38e-05           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.920935563590       residual = 3.75e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.920935563709       residual = 1.86e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.920935563650       residual = 1.01e-05           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.920935563648       residual = 3.76e-06           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.920935563695       residual = 1.24e-06           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.920935563749       residual = 3.37e-07           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.920935563721       residual = 9.67e-08           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.920935563723       residual = 2.24e-08           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.920935563720       residual = 5.21e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         16 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 9.3132e+02 is 4.075176e-07

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.628298 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 75 and numParams is: 74

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.8932e+01
  </log>
  <optVariables href="H2O.s048.opt.xml">
ci_0001                 7.086047e-01 3 1  ON 0
ci_0002                 6.927498e-01 3 1  ON 1
ci_0003                -3.099863e-02 3 1  ON 2
ci_0004                -3.009269e-02 3 1  ON 3
ci_0005                -3.060407e-02 3 1  ON 4
ci_0006                -3.069397e-02 3 1  ON 5
ci_0007                -1.338324e-02 3 1  ON 6
ci_0008                -1.335287e-02 3 1  ON 7
ci_0009                -1.869668e-02 3 1  ON 8
ci_0010                -1.813040e-02 3 1  ON 9
ci_0011                -1.474492e-02 3 1  ON 10
ci_0012                -1.451113e-02 3 1  ON 11
ci_0013                 1.529626e-02 3 1  ON 12
ci_0014                 1.480614e-02 3 1  ON 13
ci_0015                 1.574760e-02 3 1  ON 14
ci_0016                 1.538609e-02 3 1  ON 15
ci_0017                 1.336806e-02 3 1  ON 16
ci_0018                 1.303874e-02 3 1  ON 17
ci_0019                 1.309010e-02 3 1  ON 18
ci_0020                 1.266764e-02 3 1  ON 19
ci_0021                 6.755011e-03 3 1  ON 20
ci_0022                 7.465190e-03 3 1  ON 21
ci_0023                -1.180345e-02 3 1  ON 22
ci_0024                -1.146919e-02 3 1  ON 23
ci_0025                -2.029025e-03 3 1  ON 24
ci_0026                -2.392180e-03 3 1  ON 25
ci_0027                -1.213119e-02 3 1  ON 26
ci_0028                -1.154905e-02 3 1  ON 27
ci_0029                -1.065727e-02 3 1  ON 28
ci_0030                -1.058597e-02 3 1  ON 29
ci_0031                 1.341061e-02 3 1  ON 30
ci_0032                 1.211297e-02 3 1  ON 31
ci_0033                 7.848486e-03 3 1  ON 32
ci_0034                 8.491056e-03 3 1  ON 33
ci_0035                 4.857440e-03 3 1  ON 34
ci_0036                 4.933419e-03 3 1  ON 35
ci_0037                -1.133361e-02 3 1  ON 36
ci_0038                -1.131484e-02 3 1  ON 37
ci_0039                -4.015433e-03 3 1  ON 38
ci_0040                -3.886445e-03 3 1  ON 39
ci_0041                 9.104105e-03 3 1  ON 40
ci_0042                 8.780787e-03 3 1  ON 41
ci_0043                -1.307010e-02 3 1  ON 42
ci_0044                -1.384608e-02 3 1  ON 43
ci_0045                 1.059305e-02 3 1  ON 44
ci_0046                 1.007968e-02 3 1  ON 45
ci_0047                -3.585469e-03 3 1  ON 46
ci_0048                -3.481532e-03 3 1  ON 47
ci_0049                -2.596235e-03 3 1  ON 48
ci_0050                -2.696802e-03 3 1  ON 49
ci_0051                -1.797188e-03 3 1  ON 50
ci_0052                -2.017272e-03 3 1  ON 51
ci_0053                -3.931897e-03 3 1  ON 52
ci_0054                -3.323962e-03 3 1  ON 53
ci_0055                 2.399229e-03 3 1  ON 54
ci_0056                 2.269190e-03 3 1  ON 55
ci_0057                 2.457582e-03 3 1  ON 56
ci_0058                 2.858656e-03 3 1  ON 57
ci_0059                -3.397149e-03 3 1  ON 58
ci_0060                -3.374963e-03 3 1  ON 59
ci_0061                -3.976989e-03 3 1  ON 60
ci_0062                -3.922430e-03 3 1  ON 61
ci_0063                -9.803516e-03 3 1  ON 62
ci_0064                -9.372479e-03 3 1  ON 63
ci_0065                -6.435352e-03 3 1  ON 64
ci_0066                -6.132807e-03 3 1  ON 65
ci_0067                -3.748024e-03 3 1  ON 66
ci_0068                -3.478915e-03 3 1  ON 67
ci_0069                 3.570667e-03 3 1  ON 68
ci_0070                 3.348611e-03 3 1  ON 69
ci_0071                 3.005195e-03 3 1  ON 70
ci_0072                 3.481799e-03 3 1  ON 71
ci_0073                 3.551790e-03 3 1  ON 72
ci_0074                 3.528942e-03 3 1  ON 73
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 48
    time step          = 0.05
    reference energy   = -16.8578
    reference variance = 0.176415
====================================================
  Execution time = 1.4080e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s048
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6899e+01
  VMC Evar = 2.9806e-01
  Total weights = 1.9507e+06
  Execution time = 1.8680e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.287414064923
                                         uncertainty =       0.002810293360

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.287414064923
                                         uncertainty =       0.002810293360

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000379084608
  error estimate for blocks of size 2^( 2) =       0.000396224427
  error estimate for blocks of size 2^( 3) =       0.000413961682
  error estimate for blocks of size 2^( 4) =       0.000429090100
  error estimate for blocks of size 2^( 5) =       0.000440516426
  error estimate for blocks of size 2^( 6) =       0.000449665232
  error estimate for blocks of size 2^( 7) =       0.000453833023

      target function =      -0.915799770344
              le_mean =     -16.898534715132
             les_mean =     285.858538339356
             stat err =       0.000443276195
             autocorr =       1.367339994702
   target nu stat err =       0.000443276195
   target dn stat err =       0.003582934854
      target stat err =       0.005559664065
              std dev =       0.536106593785
             le_variance =       0.287410279899

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.287413934124
                                         uncertainty =       0.002810510538

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.287413934124
                                         uncertainty =       0.002810510538

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000379084525
  error estimate for blocks of size 2^( 2) =       0.000396224340
  error estimate for blocks of size 2^( 3) =       0.000413961557
  error estimate for blocks of size 2^( 4) =       0.000429089974
  error estimate for blocks of size 2^( 5) =       0.000440516247
  error estimate for blocks of size 2^( 6) =       0.000449664972
  error estimate for blocks of size 2^( 7) =       0.000453832878

      target function =      -0.915822161320
              le_mean =     -16.898534695817
             les_mean =     285.858523204425
             stat err =       0.000443276018
             autocorr =       1.367339494485
   target nu stat err =       0.000443276018
   target dn stat err =       0.003576294613
      target stat err =       0.005549813167
              std dev =       0.536106477229
             le_variance =       0.287410154926

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.287413999223
                                         uncertainty =       0.002810402040

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.287413999223
                                         uncertainty =       0.002810402040

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000379084566
  error estimate for blocks of size 2^( 2) =       0.000396224383
  error estimate for blocks of size 2^( 3) =       0.000413961619
  error estimate for blocks of size 2^( 4) =       0.000429090037
  error estimate for blocks of size 2^( 5) =       0.000440516336
  error estimate for blocks of size 2^( 6) =       0.000449665102
  error estimate for blocks of size 2^( 7) =       0.000453832950

      target function =      -0.915811018350
              le_mean =     -16.898534705430
             les_mean =     285.858530736391
             stat err =       0.000443276106
             autocorr =       1.367339744644
   target nu stat err =       0.000443276106
   target dn stat err =       0.003579595267
      target stat err =       0.005554709660
              std dev =       0.536106535229
             le_variance =       0.287410217116

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.287414056671
                                         uncertainty =       0.002810306945

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.287414056671
                                         uncertainty =       0.002810306945

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000379084603
  error estimate for blocks of size 2^( 2) =       0.000396224422
  error estimate for blocks of size 2^( 3) =       0.000413961674
  error estimate for blocks of size 2^( 4) =       0.000429090092
  error estimate for blocks of size 2^( 5) =       0.000440516415
  error estimate for blocks of size 2^( 6) =       0.000449665215
  error estimate for blocks of size 2^( 7) =       0.000453833014

      target function =      -0.915801181779
              le_mean =     -16.898534713915
             les_mean =     285.858537385317
             stat err =       0.000443276184
             autocorr =       1.367339963472
   target nu stat err =       0.000443276184
   target dn stat err =       0.003582515367
      target stat err =       0.005559041731
              std dev =       0.536106586429
             le_variance =       0.287410272012


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.915799770344        initial
     5.8208e+01     5.8208e+02             6.5201e-06        -0.915822161320  <--
     2.3283e+02     2.3283e+03             1.6301e-06        -0.915811018350
     9.3132e+02     9.3132e+03             4.0752e-07        -0.915801181779

*****************************************************************************
Applying the update for shift_i =   5.8208e+01     and shift_s =   5.8208e+02
*****************************************************************************

  Execution time = 2.3546e+01
  </log>
  <optVariables href="H2O.s048.opt.xml">
ci_0001                 7.086096e-01 3 1  ON 0
ci_0002                 6.927449e-01 3 1  ON 1
ci_0003                -3.099798e-02 3 1  ON 2
ci_0004                -3.009221e-02 3 1  ON 3
ci_0005                -3.060400e-02 3 1  ON 4
ci_0006                -3.069501e-02 3 1  ON 5
ci_0007                -1.338301e-02 3 1  ON 6
ci_0008                -1.335170e-02 3 1  ON 7
ci_0009                -1.869701e-02 3 1  ON 8
ci_0010                -1.813047e-02 3 1  ON 9
ci_0011                -1.474540e-02 3 1  ON 10
ci_0012                -1.451142e-02 3 1  ON 11
ci_0013                 1.529506e-02 3 1  ON 12
ci_0014                 1.480533e-02 3 1  ON 13
ci_0015                 1.574787e-02 3 1  ON 14
ci_0016                 1.538702e-02 3 1  ON 15
ci_0017                 1.336787e-02 3 1  ON 16
ci_0018                 1.303928e-02 3 1  ON 17
ci_0019                 1.308963e-02 3 1  ON 18
ci_0020                 1.266778e-02 3 1  ON 19
ci_0021                 6.753372e-03 3 1  ON 20
ci_0022                 7.462127e-03 3 1  ON 21
ci_0023                -1.180391e-02 3 1  ON 22
ci_0024                -1.146953e-02 3 1  ON 23
ci_0025                -2.029583e-03 3 1  ON 24
ci_0026                -2.391210e-03 3 1  ON 25
ci_0027                -1.213152e-02 3 1  ON 26
ci_0028                -1.154867e-02 3 1  ON 27
ci_0029                -1.065789e-02 3 1  ON 28
ci_0030                -1.058635e-02 3 1  ON 29
ci_0031                 1.340917e-02 3 1  ON 30
ci_0032                 1.211399e-02 3 1  ON 31
ci_0033                 7.847855e-03 3 1  ON 32
ci_0034                 8.490462e-03 3 1  ON 33
ci_0035                 4.858539e-03 3 1  ON 34
ci_0036                 4.934845e-03 3 1  ON 35
ci_0037                -1.133455e-02 3 1  ON 36
ci_0038                -1.131414e-02 3 1  ON 37
ci_0039                -4.015216e-03 3 1  ON 38
ci_0040                -3.886163e-03 3 1  ON 39
ci_0041                 9.104123e-03 3 1  ON 40
ci_0042                 8.780659e-03 3 1  ON 41
ci_0043                -1.307225e-02 3 1  ON 42
ci_0044                -1.384440e-02 3 1  ON 43
ci_0045                 1.059212e-02 3 1  ON 44
ci_0046                 1.007884e-02 3 1  ON 45
ci_0047                -3.585382e-03 3 1  ON 46
ci_0048                -3.481747e-03 3 1  ON 47
ci_0049                -2.595372e-03 3 1  ON 48
ci_0050                -2.696342e-03 3 1  ON 49
ci_0051                -1.797336e-03 3 1  ON 50
ci_0052                -2.016664e-03 3 1  ON 51
ci_0053                -3.931514e-03 3 1  ON 52
ci_0054                -3.323815e-03 3 1  ON 53
ci_0055                 2.399069e-03 3 1  ON 54
ci_0056                 2.268700e-03 3 1  ON 55
ci_0057                 2.453831e-03 3 1  ON 56
ci_0058                 2.858618e-03 3 1  ON 57
ci_0059                -3.396331e-03 3 1  ON 58
ci_0060                -3.375817e-03 3 1  ON 59
ci_0061                -3.976449e-03 3 1  ON 60
ci_0062                -3.922608e-03 3 1  ON 61
ci_0063                -9.802819e-03 3 1  ON 62
ci_0064                -9.372791e-03 3 1  ON 63
ci_0065                -6.435489e-03 3 1  ON 64
ci_0066                -6.132456e-03 3 1  ON 65
ci_0067                -3.748563e-03 3 1  ON 66
ci_0068                -3.479310e-03 3 1  ON 67
ci_0069                 3.570184e-03 3 1  ON 68
ci_0070                 3.348580e-03 3 1  ON 69
ci_0071                 3.005281e-03 3 1  ON 70
ci_0072                 3.482168e-03 3 1  ON 71
ci_0073                 3.552035e-03 3 1  ON 72
ci_0074                 3.529487e-03 3 1  ON 73
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 4.2491e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s049 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s049 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=49  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6904e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 49
    time step          = 0.05
    reference energy   = -16.8888
    reference variance = 0.341945
====================================================
  Execution time = 1.4179e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s049
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5250e+04
  VMC Eavg = -1.6899e+01
  VMC Evar = 2.9216e-01
  Total weights = 1.951157639e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 2.5828e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.282093332074
                                         uncertainty =       0.001514355436

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.282093332074
                                         uncertainty =       0.001514355436

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000375546969
  error estimate for blocks of size 2^( 2) =       0.000392629688
  error estimate for blocks of size 2^( 3) =       0.000409564459
  error estimate for blocks of size 2^( 4) =       0.000425153705
  error estimate for blocks of size 2^( 5) =       0.000437486795
  error estimate for blocks of size 2^( 6) =       0.000446247764
  error estimate for blocks of size 2^( 7) =       0.000450390336

      target function =      -0.924989979820
              le_mean =     -16.898862429817
             les_mean =     285.863713595609
             stat err =       0.000439819650
             autocorr =       1.371578706745
   target nu stat err =       0.000439819650
   target dn stat err =       0.002177396705
      target stat err =       0.003498323231
              std dev =       0.531103617091
             le_variance =       0.282071052087


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.689886242982e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 74
Check correct_vf_var_size: 225, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.4552e+01, overlap shift 1.4552e+02 and omega -1.7444e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.925001797498       residual = 1.59e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.925005112358       residual = 2.60e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.925005992914       residual = 4.57e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.925006150006       residual = 1.74e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.925006228420       residual = 9.40e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.925006263676       residual = 2.75e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.925006271481       residual = 1.54e-05           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.925006269435       residual = 3.84e-06           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.925006270470       residual = 2.42e-06           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.925006281073       residual = 1.59e-06           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.925006282408       residual = 2.11e-06           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.925006284421       residual = 1.30e-06           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.925006284777       residual = 5.23e-07           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.925006285562       residual = 3.35e-07           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.925006284437       residual = 8.46e-08           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.925006284308       residual = 2.03e-08           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.925006284013       residual = 5.78e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         16 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 1.4552e+01 is 1.213526e-05

solving harmonic davidson linear method for identity shift 5.8208e+01, overlap shift 5.8208e+02 and omega -1.7444e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.925001797498       residual = 1.59e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.925002629698       residual = 2.59e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.925002850602       residual = 4.57e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.925002889944       residual = 1.73e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.925002909567       residual = 9.37e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.925002918382       residual = 2.73e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.925002920326       residual = 1.53e-05           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.925002919810       residual = 3.82e-06           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.925002920069       residual = 2.41e-06           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.925002922723       residual = 1.59e-06           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.925002923055       residual = 2.09e-06           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.925002923554       residual = 1.29e-06           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.925002923639       residual = 5.16e-07           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.925002923832       residual = 3.29e-07           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.925002923553       residual = 8.26e-08           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.925002923521       residual = 1.98e-08           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.925002923448       residual = 5.63e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         16 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 5.8208e+01 is 3.039985e-06

solving harmonic davidson linear method for identity shift 2.3283e+02, overlap shift 2.3283e+03 and omega -1.7444e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.925001797498       residual = 1.59e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.925002005767       residual = 2.59e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.925002061041       residual = 4.56e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.925002070881       residual = 1.73e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.925002075788       residual = 9.36e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.925002077992       residual = 2.73e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.925002078477       residual = 1.53e-05           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.925002078348       residual = 3.81e-06           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.925002078413       residual = 2.40e-06           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.925002079076       residual = 1.58e-06           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.925002079159       residual = 2.09e-06           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.925002079284       residual = 1.28e-06           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.925002079305       residual = 5.14e-07           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.925002079353       residual = 3.28e-07           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.925002079283       residual = 8.22e-08           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.925002079275       residual = 1.97e-08           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.925002079257       residual = 5.60e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         16 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 2.3283e+02 is 7.603830e-07

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.637419 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 75 and numParams is: 74

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.6776e+01
  </log>
  <optVariables href="H2O.s049.opt.xml">
ci_0001                 7.086116e-01 3 1  ON 0
ci_0002                 6.927432e-01 3 1  ON 1
ci_0003                -3.099881e-02 3 1  ON 2
ci_0004                -3.009034e-02 3 1  ON 3
ci_0005                -3.060276e-02 3 1  ON 4
ci_0006                -3.069409e-02 3 1  ON 5
ci_0007                -1.338329e-02 3 1  ON 6
ci_0008                -1.335210e-02 3 1  ON 7
ci_0009                -1.869649e-02 3 1  ON 8
ci_0010                -1.813047e-02 3 1  ON 9
ci_0011                -1.474564e-02 3 1  ON 10
ci_0012                -1.450992e-02 3 1  ON 11
ci_0013                 1.529544e-02 3 1  ON 12
ci_0014                 1.480457e-02 3 1  ON 13
ci_0015                 1.574725e-02 3 1  ON 14
ci_0016                 1.538851e-02 3 1  ON 15
ci_0017                 1.336724e-02 3 1  ON 16
ci_0018                 1.303934e-02 3 1  ON 17
ci_0019                 1.308970e-02 3 1  ON 18
ci_0020                 1.266808e-02 3 1  ON 19
ci_0021                 6.752325e-03 3 1  ON 20
ci_0022                 7.459087e-03 3 1  ON 21
ci_0023                -1.180438e-02 3 1  ON 22
ci_0024                -1.146981e-02 3 1  ON 23
ci_0025                -2.029218e-03 3 1  ON 24
ci_0026                -2.389042e-03 3 1  ON 25
ci_0027                -1.213167e-02 3 1  ON 26
ci_0028                -1.154919e-02 3 1  ON 27
ci_0029                -1.065836e-02 3 1  ON 28
ci_0030                -1.058733e-02 3 1  ON 29
ci_0031                 1.340886e-02 3 1  ON 30
ci_0032                 1.211409e-02 3 1  ON 31
ci_0033                 7.847979e-03 3 1  ON 32
ci_0034                 8.488486e-03 3 1  ON 33
ci_0035                 4.856756e-03 3 1  ON 34
ci_0036                 4.932243e-03 3 1  ON 35
ci_0037                -1.133341e-02 3 1  ON 36
ci_0038                -1.131143e-02 3 1  ON 37
ci_0039                -4.015094e-03 3 1  ON 38
ci_0040                -3.885886e-03 3 1  ON 39
ci_0041                 9.104126e-03 3 1  ON 40
ci_0042                 8.781077e-03 3 1  ON 41
ci_0043                -1.307242e-02 3 1  ON 42
ci_0044                -1.384269e-02 3 1  ON 43
ci_0045                 1.059156e-02 3 1  ON 44
ci_0046                 1.007776e-02 3 1  ON 45
ci_0047                -3.584898e-03 3 1  ON 46
ci_0048                -3.481396e-03 3 1  ON 47
ci_0049                -2.596722e-03 3 1  ON 48
ci_0050                -2.695897e-03 3 1  ON 49
ci_0051                -1.798170e-03 3 1  ON 50
ci_0052                -2.014570e-03 3 1  ON 51
ci_0053                -3.929903e-03 3 1  ON 52
ci_0054                -3.324520e-03 3 1  ON 53
ci_0055                 2.398165e-03 3 1  ON 54
ci_0056                 2.266547e-03 3 1  ON 55
ci_0057                 2.455094e-03 3 1  ON 56
ci_0058                 2.857555e-03 3 1  ON 57
ci_0059                -3.396722e-03 3 1  ON 58
ci_0060                -3.374614e-03 3 1  ON 59
ci_0061                -3.976506e-03 3 1  ON 60
ci_0062                -3.922351e-03 3 1  ON 61
ci_0063                -9.802322e-03 3 1  ON 62
ci_0064                -9.373261e-03 3 1  ON 63
ci_0065                -6.435675e-03 3 1  ON 64
ci_0066                -6.132782e-03 3 1  ON 65
ci_0067                -3.748876e-03 3 1  ON 66
ci_0068                -3.479663e-03 3 1  ON 67
ci_0069                 3.569755e-03 3 1  ON 68
ci_0070                 3.348428e-03 3 1  ON 69
ci_0071                 3.005396e-03 3 1  ON 70
ci_0072                 3.481215e-03 3 1  ON 71
ci_0073                 3.552646e-03 3 1  ON 72
ci_0074                 3.529240e-03 3 1  ON 73
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 49
    time step          = 0.05
    reference energy   = -16.8839
    reference variance = 0.396783
====================================================
  Execution time = 1.4072e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s049
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6899e+01
  VMC Evar = 2.9475e-01
  Total weights = 1.9515e+06
  Execution time = 1.8754e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.283834563701
                                         uncertainty =       0.002157427234

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.283834563701
                                         uncertainty =       0.002157427234

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000376725770
  error estimate for blocks of size 2^( 2) =       0.000393498312
  error estimate for blocks of size 2^( 3) =       0.000410877113
  error estimate for blocks of size 2^( 4) =       0.000426052902
  error estimate for blocks of size 2^( 5) =       0.000438680827
  error estimate for blocks of size 2^( 6) =       0.000447047176
  error estimate for blocks of size 2^( 7) =       0.000453035406

      target function =      -0.920942241049
              le_mean =     -16.898793229102
             les_mean =     285.863958834055
             stat err =       0.000441204078
             autocorr =       1.371602845091
   target nu stat err =       0.000441204078
   target dn stat err =       0.002858583207
      target stat err =       0.004509332181
              std dev =       0.532770692819
             le_variance =       0.283844611127

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.283832512966
                                         uncertainty =       0.002157207508

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.283832512966
                                         uncertainty =       0.002157207508

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000376724414
  error estimate for blocks of size 2^( 2) =       0.000393497374
  error estimate for blocks of size 2^( 3) =       0.000410876581
  error estimate for blocks of size 2^( 4) =       0.000426052871
  error estimate for blocks of size 2^( 5) =       0.000438681025
  error estimate for blocks of size 2^( 6) =       0.000447047241
  error estimate for blocks of size 2^( 7) =       0.000453036162

      target function =      -0.919943709942
              le_mean =     -16.898793260122
             les_mean =     285.864601721531
             stat err =       0.000441204325
             autocorr =       1.371614254088
   target nu stat err =       0.000441204325
   target dn stat err =       0.002930823508
      target stat err =       0.004610335604
              std dev =       0.532768775406
             le_variance =       0.283842568047

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.283833529306
                                         uncertainty =       0.002157316798

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.283833529306
                                         uncertainty =       0.002157316798

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000376725086
  error estimate for blocks of size 2^( 2) =       0.000393497839
  error estimate for blocks of size 2^( 3) =       0.000410876850
  error estimate for blocks of size 2^( 4) =       0.000426052899
  error estimate for blocks of size 2^( 5) =       0.000438680930
  error estimate for blocks of size 2^( 6) =       0.000447047213
  error estimate for blocks of size 2^( 7) =       0.000453035761

      target function =      -0.920924821921
              le_mean =     -16.898793249417
             les_mean =     285.863970724375
             stat err =       0.000441204201
             autocorr =       1.371608591702
   target nu stat err =       0.000441204201
   target dn stat err =       0.002857901304
      target stat err =       0.004508117828
              std dev =       0.532769725657
             le_variance =       0.283843580576

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.283834433722
                                         uncertainty =       0.002157413402

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.283834433722
                                         uncertainty =       0.002157413402

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000376725684
  error estimate for blocks of size 2^( 2) =       0.000393498252
  error estimate for blocks of size 2^( 3) =       0.000410877080
  error estimate for blocks of size 2^( 4) =       0.000426052902
  error estimate for blocks of size 2^( 5) =       0.000438680839
  error estimate for blocks of size 2^( 6) =       0.000447047181
  error estimate for blocks of size 2^( 7) =       0.000453035449

      target function =      -0.920941728968
              le_mean =     -16.898793231645
             les_mean =     285.863959250041
             stat err =       0.000441204093
             autocorr =       1.371603564946
   target nu stat err =       0.000441204093
   target dn stat err =       0.002858491340
      target stat err =       0.004509186296
              std dev =       0.532770571287
             le_variance =       0.283844481629


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.920942241049        initial  <--
     1.4552e+01     1.4552e+02             1.2135e-05        -0.919943709942
     5.8208e+01     5.8208e+02             3.0400e-06        -0.920924821921
     2.3283e+02     2.3283e+03             7.6038e-07        -0.920941728968

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 23.5398
  </log>
  <optVariables href="H2O.s049.opt.xml">
ci_0001                 7.086096e-01 3 1  ON 0
ci_0002                 6.927449e-01 3 1  ON 1
ci_0003                -3.099798e-02 3 1  ON 2
ci_0004                -3.009221e-02 3 1  ON 3
ci_0005                -3.060400e-02 3 1  ON 4
ci_0006                -3.069501e-02 3 1  ON 5
ci_0007                -1.338301e-02 3 1  ON 6
ci_0008                -1.335170e-02 3 1  ON 7
ci_0009                -1.869701e-02 3 1  ON 8
ci_0010                -1.813047e-02 3 1  ON 9
ci_0011                -1.474540e-02 3 1  ON 10
ci_0012                -1.451142e-02 3 1  ON 11
ci_0013                 1.529506e-02 3 1  ON 12
ci_0014                 1.480533e-02 3 1  ON 13
ci_0015                 1.574787e-02 3 1  ON 14
ci_0016                 1.538702e-02 3 1  ON 15
ci_0017                 1.336787e-02 3 1  ON 16
ci_0018                 1.303928e-02 3 1  ON 17
ci_0019                 1.308963e-02 3 1  ON 18
ci_0020                 1.266778e-02 3 1  ON 19
ci_0021                 6.753372e-03 3 1  ON 20
ci_0022                 7.462127e-03 3 1  ON 21
ci_0023                -1.180391e-02 3 1  ON 22
ci_0024                -1.146953e-02 3 1  ON 23
ci_0025                -2.029583e-03 3 1  ON 24
ci_0026                -2.391210e-03 3 1  ON 25
ci_0027                -1.213152e-02 3 1  ON 26
ci_0028                -1.154867e-02 3 1  ON 27
ci_0029                -1.065789e-02 3 1  ON 28
ci_0030                -1.058635e-02 3 1  ON 29
ci_0031                 1.340917e-02 3 1  ON 30
ci_0032                 1.211399e-02 3 1  ON 31
ci_0033                 7.847855e-03 3 1  ON 32
ci_0034                 8.490462e-03 3 1  ON 33
ci_0035                 4.858539e-03 3 1  ON 34
ci_0036                 4.934845e-03 3 1  ON 35
ci_0037                -1.133455e-02 3 1  ON 36
ci_0038                -1.131414e-02 3 1  ON 37
ci_0039                -4.015216e-03 3 1  ON 38
ci_0040                -3.886163e-03 3 1  ON 39
ci_0041                 9.104123e-03 3 1  ON 40
ci_0042                 8.780659e-03 3 1  ON 41
ci_0043                -1.307225e-02 3 1  ON 42
ci_0044                -1.384440e-02 3 1  ON 43
ci_0045                 1.059212e-02 3 1  ON 44
ci_0046                 1.007884e-02 3 1  ON 45
ci_0047                -3.585382e-03 3 1  ON 46
ci_0048                -3.481747e-03 3 1  ON 47
ci_0049                -2.595372e-03 3 1  ON 48
ci_0050                -2.696342e-03 3 1  ON 49
ci_0051                -1.797336e-03 3 1  ON 50
ci_0052                -2.016664e-03 3 1  ON 51
ci_0053                -3.931514e-03 3 1  ON 52
ci_0054                -3.323815e-03 3 1  ON 53
ci_0055                 2.399069e-03 3 1  ON 54
ci_0056                 2.268700e-03 3 1  ON 55
ci_0057                 2.453831e-03 3 1  ON 56
ci_0058                 2.858618e-03 3 1  ON 57
ci_0059                -3.396331e-03 3 1  ON 58
ci_0060                -3.375817e-03 3 1  ON 59
ci_0061                -3.976449e-03 3 1  ON 60
ci_0062                -3.922608e-03 3 1  ON 61
ci_0063                -9.802819e-03 3 1  ON 62
ci_0064                -9.372791e-03 3 1  ON 63
ci_0065                -6.435489e-03 3 1  ON 64
ci_0066                -6.132456e-03 3 1  ON 65
ci_0067                -3.748563e-03 3 1  ON 66
ci_0068                -3.479310e-03 3 1  ON 67
ci_0069                 3.570184e-03 3 1  ON 68
ci_0070                 3.348580e-03 3 1  ON 69
ci_0071                 3.005281e-03 3 1  ON 70
ci_0072                 3.482168e-03 3 1  ON 71
ci_0073                 3.552035e-03 3 1  ON 72
ci_0074                 3.529487e-03 3 1  ON 73
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 4.0322e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s050 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s050 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=50  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6904e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 50
    time step          = 0.05
    reference energy   = -16.9472
    reference variance = 0.377687
====================================================
  Execution time = 1.4270e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s050
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5220e+04
  VMC Eavg = -1.6899e+01
  VMC Evar = 2.9661e-01
  Total weights = 1.950615161e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 2.6466e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.286569008684
                                         uncertainty =       0.002168192616

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.286569008684
                                         uncertainty =       0.002168192616

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000378601223
  error estimate for blocks of size 2^( 2) =       0.000395458910
  error estimate for blocks of size 2^( 3) =       0.000412701332
  error estimate for blocks of size 2^( 4) =       0.000427584744
  error estimate for blocks of size 2^( 5) =       0.000439448132
  error estimate for blocks of size 2^( 6) =       0.000447312284
  error estimate for blocks of size 2^( 7) =       0.000454970671

      target function =      -0.918049714344
              le_mean =     -16.898610579824
             les_mean =     285.859650872822
             stat err =       0.000442328958
             autocorr =       1.364981356406
   target nu stat err =       0.000442328958
   target dn stat err =       0.002830509963
      target stat err =       0.004437470441
              std dev =       0.535422983731
             le_variance =       0.286677771507


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.689861057982e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 74
Check correct_vf_var_size: 225, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.4552e+02, overlap shift 1.4552e+03 and omega -1.7444e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.918069867992       residual = 9.71e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.918070144284       residual = 1.13e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.918070187789       residual = 3.62e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.918070203948       residual = 2.32e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.918070217784       residual = 1.06e-04           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.918070225806       residual = 8.71e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.918070233816       residual = 4.56e-05           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.918070236828       residual = 2.59e-05           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.918070240383       residual = 3.23e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.918070245222       residual = 3.64e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.918070247130       residual = 1.67e-05           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.918070247773       residual = 6.16e-06           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.918070247740       residual = 1.72e-06           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.918070247716       residual = 5.36e-07           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.918070247564       residual = 1.13e-07           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.918070247494       residual = 5.29e-08           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.918070247502       residual = 1.23e-08           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.918070247483       residual = 4.86e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         17 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 1.4552e+02 is 2.698334e-06

solving harmonic davidson linear method for identity shift 5.8208e+02, overlap shift 5.8208e+03 and omega -1.7444e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.918069867992       residual = 9.71e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.918069937092       residual = 1.13e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.918069947972       residual = 3.62e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.918069952013       residual = 2.32e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.918069955472       residual = 1.06e-04           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.918069957478       residual = 8.70e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.918069959481       residual = 4.55e-05           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.918069960233       residual = 2.59e-05           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.918069961120       residual = 3.23e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.918069962333       residual = 3.64e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.918069962808       residual = 1.67e-05           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.918069962969       residual = 6.15e-06           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.918069962961       residual = 1.72e-06           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.918069962954       residual = 5.34e-07           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.918069962915       residual = 1.13e-07           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.918069962897       residual = 5.28e-08           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.918069962902       residual = 1.23e-08           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.918069962895       residual = 4.84e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         17 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 5.8208e+02 is 6.745797e-07

solving harmonic davidson linear method for identity shift 2.3283e+03, overlap shift 2.3283e+04 and omega -1.7444e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.918069867992       residual = 9.71e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.918069885269       residual = 1.13e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.918069887989       residual = 3.62e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.918069888999       residual = 2.32e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.918069889864       residual = 1.06e-04           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.918069890366       residual = 8.70e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.918069890865       residual = 4.55e-05           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.918069891056       residual = 2.59e-05           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.918069891276       residual = 3.23e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.918069891581       residual = 3.64e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.918069891699       residual = 1.67e-05           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.918069891738       residual = 6.15e-06           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.918069891734       residual = 1.72e-06           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.918069891737       residual = 5.34e-07           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.918069891724       residual = 1.12e-07           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.918069891727       residual = 5.28e-08           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.918069891718       residual = 1.23e-08           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.918069891724       residual = 4.84e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         17 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 2.3283e+03 is 1.686447e-07

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.647548 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 75 and numParams is: 74

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.6932e+01
  </log>
  <optVariables href="H2O.s050.opt.xml">
ci_0001                 7.086090e-01 3 1  ON 0
ci_0002                 6.927455e-01 3 1  ON 1
ci_0003                -3.099783e-02 3 1  ON 2
ci_0004                -3.009221e-02 3 1  ON 3
ci_0005                -3.060389e-02 3 1  ON 4
ci_0006                -3.069510e-02 3 1  ON 5
ci_0007                -1.338254e-02 3 1  ON 6
ci_0008                -1.335150e-02 3 1  ON 7
ci_0009                -1.869690e-02 3 1  ON 8
ci_0010                -1.813045e-02 3 1  ON 9
ci_0011                -1.474531e-02 3 1  ON 10
ci_0012                -1.451139e-02 3 1  ON 11
ci_0013                 1.529501e-02 3 1  ON 12
ci_0014                 1.480536e-02 3 1  ON 13
ci_0015                 1.574780e-02 3 1  ON 14
ci_0016                 1.538692e-02 3 1  ON 15
ci_0017                 1.336782e-02 3 1  ON 16
ci_0018                 1.303926e-02 3 1  ON 17
ci_0019                 1.308964e-02 3 1  ON 18
ci_0020                 1.266788e-02 3 1  ON 19
ci_0021                 6.753420e-03 3 1  ON 20
ci_0022                 7.462064e-03 3 1  ON 21
ci_0023                -1.180399e-02 3 1  ON 22
ci_0024                -1.146966e-02 3 1  ON 23
ci_0025                -2.029529e-03 3 1  ON 24
ci_0026                -2.391073e-03 3 1  ON 25
ci_0027                -1.213153e-02 3 1  ON 26
ci_0028                -1.154868e-02 3 1  ON 27
ci_0029                -1.065793e-02 3 1  ON 28
ci_0030                -1.058655e-02 3 1  ON 29
ci_0031                 1.340922e-02 3 1  ON 30
ci_0032                 1.211399e-02 3 1  ON 31
ci_0033                 7.847909e-03 3 1  ON 32
ci_0034                 8.490567e-03 3 1  ON 33
ci_0035                 4.858610e-03 3 1  ON 34
ci_0036                 4.934673e-03 3 1  ON 35
ci_0037                -1.133445e-02 3 1  ON 36
ci_0038                -1.131409e-02 3 1  ON 37
ci_0039                -4.015187e-03 3 1  ON 38
ci_0040                -3.886159e-03 3 1  ON 39
ci_0041                 9.104114e-03 3 1  ON 40
ci_0042                 8.780673e-03 3 1  ON 41
ci_0043                -1.307231e-02 3 1  ON 42
ci_0044                -1.384454e-02 3 1  ON 43
ci_0045                 1.059198e-02 3 1  ON 44
ci_0046                 1.007890e-02 3 1  ON 45
ci_0047                -3.585392e-03 3 1  ON 46
ci_0048                -3.481766e-03 3 1  ON 47
ci_0049                -2.595120e-03 3 1  ON 48
ci_0050                -2.696341e-03 3 1  ON 49
ci_0051                -1.797378e-03 3 1  ON 50
ci_0052                -2.016618e-03 3 1  ON 51
ci_0053                -3.931643e-03 3 1  ON 52
ci_0054                -3.323817e-03 3 1  ON 53
ci_0055                 2.399099e-03 3 1  ON 54
ci_0056                 2.268833e-03 3 1  ON 55
ci_0057                 2.453916e-03 3 1  ON 56
ci_0058                 2.858393e-03 3 1  ON 57
ci_0059                -3.396232e-03 3 1  ON 58
ci_0060                -3.375919e-03 3 1  ON 59
ci_0061                -3.976466e-03 3 1  ON 60
ci_0062                -3.922599e-03 3 1  ON 61
ci_0063                -9.802826e-03 3 1  ON 62
ci_0064                -9.372808e-03 3 1  ON 63
ci_0065                -6.435464e-03 3 1  ON 64
ci_0066                -6.132424e-03 3 1  ON 65
ci_0067                -3.748489e-03 3 1  ON 66
ci_0068                -3.479389e-03 3 1  ON 67
ci_0069                 3.570027e-03 3 1  ON 68
ci_0070                 3.348568e-03 3 1  ON 69
ci_0071                 3.005260e-03 3 1  ON 70
ci_0072                 3.482036e-03 3 1  ON 71
ci_0073                 3.552136e-03 3 1  ON 72
ci_0074                 3.529448e-03 3 1  ON 73
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 50
    time step          = 0.05
    reference energy   = -16.9855
    reference variance = 0.438525
====================================================
  Execution time = 1.4075e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s050
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6899e+01
  VMC Evar = 2.9191e-01
  Total weights = 1.9510e+06
  Execution time = 1.8811e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.281448398685
                                         uncertainty =       0.001458780517

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.281448398685
                                         uncertainty =       0.001458780517

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000375149101
  error estimate for blocks of size 2^( 2) =       0.000391812041
  error estimate for blocks of size 2^( 3) =       0.000408869213
  error estimate for blocks of size 2^( 4) =       0.000423848304
  error estimate for blocks of size 2^( 5) =       0.000434309361
  error estimate for blocks of size 2^( 6) =       0.000439462718
  error estimate for blocks of size 2^( 7) =       0.000442275244

      target function =      -0.925386393800
              le_mean =     -16.898746213252
             les_mean =     285.859532092019
             stat err =       0.000434973907
             autocorr =       1.344369313301
   target nu stat err =       0.000434973907
   target dn stat err =       0.002188813816
      target stat err =       0.003516294433
              std dev =       0.530540946411
             le_variance =       0.281473695819

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.281448243678
                                         uncertainty =       0.001458771177

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.281448243678
                                         uncertainty =       0.001458771177

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000375148999
  error estimate for blocks of size 2^( 2) =       0.000391811963
  error estimate for blocks of size 2^( 3) =       0.000408869143
  error estimate for blocks of size 2^( 4) =       0.000423848250
  error estimate for blocks of size 2^( 5) =       0.000434309303
  error estimate for blocks of size 2^( 6) =       0.000439462672
  error estimate for blocks of size 2^( 7) =       0.000442275206

      target function =      -0.925387831604
              le_mean =     -16.898746207907
             les_mean =     285.859530996712
             stat err =       0.000434973858
             autocorr =       1.344369742934
   target nu stat err =       0.000434973858
   target dn stat err =       0.002188702784
      target stat err =       0.003516134555
              std dev =       0.530540801901
             le_variance =       0.281473542482

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.281448321115
                                         uncertainty =       0.001458775845

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.281448321115
                                         uncertainty =       0.001458775845

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000375149050
  error estimate for blocks of size 2^( 2) =       0.000391812002
  error estimate for blocks of size 2^( 3) =       0.000408869178
  error estimate for blocks of size 2^( 4) =       0.000423848277
  error estimate for blocks of size 2^( 5) =       0.000434309332
  error estimate for blocks of size 2^( 6) =       0.000439462695
  error estimate for blocks of size 2^( 7) =       0.000442275225

      target function =      -0.925387115727
              le_mean =     -16.898746210574
             les_mean =     285.859531542260
             stat err =       0.000434973882
             autocorr =       1.344369528211
   target nu stat err =       0.000434973882
   target dn stat err =       0.002188758239
      target stat err =       0.003516214424
              std dev =       0.530540874094
             le_variance =       0.281473619084

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.281448388983
                                         uncertainty =       0.001458779933

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.281448388983
                                         uncertainty =       0.001458779933

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000375149095
  error estimate for blocks of size 2^( 2) =       0.000391812036
  error estimate for blocks of size 2^( 3) =       0.000408869209
  error estimate for blocks of size 2^( 4) =       0.000423848301
  error estimate for blocks of size 2^( 5) =       0.000434309358
  error estimate for blocks of size 2^( 6) =       0.000439462715
  error estimate for blocks of size 2^( 7) =       0.000442275241

      target function =      -0.925386484362
              le_mean =     -16.898746212917
             les_mean =     285.859532023076
             stat err =       0.000434973904
             autocorr =       1.344369340167
   target nu stat err =       0.000434973904
   target dn stat err =       0.002188806863
      target stat err =       0.003516284426
              std dev =       0.530540937366
             le_variance =       0.281473686221


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.925386393800        initial
     1.4552e+02     1.4552e+03             2.6983e-06        -0.925387831604  <--
     5.8208e+02     5.8208e+03             6.7458e-07        -0.925387115727
     2.3283e+03     2.3283e+04             1.6864e-07        -0.925386484362

*****************************************************************************
Applying the update for shift_i =   1.4552e+02     and shift_s =   1.4552e+03
*****************************************************************************

  Execution time = 2.3549e+01
  </log>
  <optVariables href="H2O.s050.opt.xml">
ci_0001                 7.086071e-01 3 1  ON 0
ci_0002                 6.927476e-01 3 1  ON 1
ci_0003                -3.099737e-02 3 1  ON 2
ci_0004                -3.009221e-02 3 1  ON 3
ci_0005                -3.060355e-02 3 1  ON 4
ci_0006                -3.069534e-02 3 1  ON 5
ci_0007                -1.338111e-02 3 1  ON 6
ci_0008                -1.335091e-02 3 1  ON 7
ci_0009                -1.869658e-02 3 1  ON 8
ci_0010                -1.813042e-02 3 1  ON 9
ci_0011                -1.474503e-02 3 1  ON 10
ci_0012                -1.451129e-02 3 1  ON 11
ci_0013                 1.529487e-02 3 1  ON 12
ci_0014                 1.480545e-02 3 1  ON 13
ci_0015                 1.574760e-02 3 1  ON 14
ci_0016                 1.538662e-02 3 1  ON 15
ci_0017                 1.336765e-02 3 1  ON 16
ci_0018                 1.303921e-02 3 1  ON 17
ci_0019                 1.308968e-02 3 1  ON 18
ci_0020                 1.266817e-02 3 1  ON 19
ci_0021                 6.753566e-03 3 1  ON 20
ci_0022                 7.461876e-03 3 1  ON 21
ci_0023                -1.180421e-02 3 1  ON 22
ci_0024                -1.147005e-02 3 1  ON 23
ci_0025                -2.029365e-03 3 1  ON 24
ci_0026                -2.390659e-03 3 1  ON 25
ci_0027                -1.213156e-02 3 1  ON 26
ci_0028                -1.154871e-02 3 1  ON 27
ci_0029                -1.065807e-02 3 1  ON 28
ci_0030                -1.058714e-02 3 1  ON 29
ci_0031                 1.340934e-02 3 1  ON 30
ci_0032                 1.211398e-02 3 1  ON 31
ci_0033                 7.848073e-03 3 1  ON 32
ci_0034                 8.490882e-03 3 1  ON 33
ci_0035                 4.858824e-03 3 1  ON 34
ci_0036                 4.934155e-03 3 1  ON 35
ci_0037                -1.133418e-02 3 1  ON 36
ci_0038                -1.131394e-02 3 1  ON 37
ci_0039                -4.015102e-03 3 1  ON 38
ci_0040                -3.886144e-03 3 1  ON 39
ci_0041                 9.104088e-03 3 1  ON 40
ci_0042                 8.780716e-03 3 1  ON 41
ci_0043                -1.307249e-02 3 1  ON 42
ci_0044                -1.384496e-02 3 1  ON 43
ci_0045                 1.059155e-02 3 1  ON 44
ci_0046                 1.007908e-02 3 1  ON 45
ci_0047                -3.585422e-03 3 1  ON 46
ci_0048                -3.481823e-03 3 1  ON 47
ci_0049                -2.594364e-03 3 1  ON 48
ci_0050                -2.696337e-03 3 1  ON 49
ci_0051                -1.797501e-03 3 1  ON 50
ci_0052                -2.016480e-03 3 1  ON 51
ci_0053                -3.932030e-03 3 1  ON 52
ci_0054                -3.323822e-03 3 1  ON 53
ci_0055                 2.399187e-03 3 1  ON 54
ci_0056                 2.269230e-03 3 1  ON 55
ci_0057                 2.454171e-03 3 1  ON 56
ci_0058                 2.857715e-03 3 1  ON 57
ci_0059                -3.395934e-03 3 1  ON 58
ci_0060                -3.376222e-03 3 1  ON 59
ci_0061                -3.976518e-03 3 1  ON 60
ci_0062                -3.922569e-03 3 1  ON 61
ci_0063                -9.802847e-03 3 1  ON 62
ci_0064                -9.372860e-03 3 1  ON 63
ci_0065                -6.435389e-03 3 1  ON 64
ci_0066                -6.132328e-03 3 1  ON 65
ci_0067                -3.748268e-03 3 1  ON 66
ci_0068                -3.479628e-03 3 1  ON 67
ci_0069                 3.569559e-03 3 1  ON 68
ci_0070                 3.348532e-03 3 1  ON 69
ci_0071                 3.005195e-03 3 1  ON 70
ci_0072                 3.481640e-03 3 1  ON 71
ci_0073                 3.552439e-03 3 1  ON 72
ci_0074                 3.529331e-03 3 1  ON 73
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 4.0487e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s051 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s051 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=51  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6905e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 51
    time step          = 0.05
    reference energy   = -16.9482
    reference variance = 0.252819
====================================================
  Execution time = 1.4324e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s051
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5232e+04
  VMC Eavg = -1.6899e+01
  VMC Evar = 2.9843e-01
  Total weights = 1.950799993e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 2.6442e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.286034226041
                                         uncertainty =       0.003041083632

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.286034226041
                                         uncertainty =       0.003041083632

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000378141248
  error estimate for blocks of size 2^( 2) =       0.000395169713
  error estimate for blocks of size 2^( 3) =       0.000412508956
  error estimate for blocks of size 2^( 4) =       0.000428202237
  error estimate for blocks of size 2^( 5) =       0.000439126828
  error estimate for blocks of size 2^( 6) =       0.000444219902
  error estimate for blocks of size 2^( 7) =       0.000450545871

      target function =      -0.915223913262
              le_mean =     -16.898959566099
             les_mean =     285.873265915872
             stat err =       0.000440523710
             autocorr =       1.357158183822
   target nu stat err =       0.000440523710
   target dn stat err =       0.003989703860
      target stat err =       0.006176700852
              std dev =       0.534772480951
             le_variance =       0.285981606382


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.689895956610e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 74
Check correct_vf_var_size: 225, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 3.6380e+01, overlap shift 3.6380e+02 and omega -1.7444e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.915264153332       residual = 5.20e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.915268840505       residual = 4.65e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.915269421776       residual = 7.82e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.915269504404       residual = 2.37e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.915269584242       residual = 1.77e-04           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.915269646358       residual = 6.49e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.915269656646       residual = 6.45e-05           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.915269664023       residual = 4.48e-05           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.915269672604       residual = 3.34e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.915269684668       residual = 3.95e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.915269695470       residual = 1.59e-05           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.915269695773       residual = 6.40e-06           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.915269696124       residual = 2.13e-06           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.915269694782       residual = 1.07e-06           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.915269693603       residual = 4.05e-07           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.915269693394       residual = 1.03e-07           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.915269693010       residual = 2.83e-08           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.915269692869       residual = 8.94e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         17 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 3.6380e+01 is 1.086284e-05

solving harmonic davidson linear method for identity shift 1.4552e+02, overlap shift 1.4552e+03 and omega -1.7444e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.915264153332       residual = 5.20e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.915265327053       residual = 4.65e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.915265472577       residual = 7.81e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.915265493253       residual = 2.37e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.915265513225       residual = 1.77e-04           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.915265528761       residual = 6.48e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.915265531331       residual = 6.44e-05           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.915265533173       residual = 4.47e-05           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.915265535318       residual = 3.34e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.915265538333       residual = 3.94e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.915265541025       residual = 1.58e-05           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.915265541099       residual = 6.36e-06           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.915265541185       residual = 2.11e-06           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.915265540849       residual = 1.06e-06           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.915265540555       residual = 4.02e-07           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.915265540503       residual = 1.03e-07           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.915265540408       residual = 2.80e-08           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.915265540373       residual = 8.85e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         17 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 1.4552e+02 is 2.715665e-06

solving harmonic davidson linear method for identity shift 5.8208e+02, overlap shift 5.8208e+03 and omega -1.7444e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.915264153332       residual = 5.20e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.915264446883       residual = 4.65e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.915264483277       residual = 7.81e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.915264488447       residual = 2.37e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.915264493441       residual = 1.77e-04           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.915264497325       residual = 6.48e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.915264497968       residual = 6.44e-05           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.915264498429       residual = 4.47e-05           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.915264498965       residual = 3.34e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.915264499718       residual = 3.94e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.915264500392       residual = 1.58e-05           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.915264500409       residual = 6.35e-06           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.915264500432       residual = 2.11e-06           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.915264500347       residual = 1.06e-06           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.915264500274       residual = 4.01e-07           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.915264500260       residual = 1.02e-07           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.915264500235       residual = 2.80e-08           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.915264500225       residual = 8.83e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         17 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 5.8208e+02 is 6.789133e-07

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.657670 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 75 and numParams is: 74

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.6984e+01
  </log>
  <optVariables href="H2O.s051.opt.xml">
ci_0001                 7.086045e-01 3 1  ON 0
ci_0002                 6.927503e-01 3 1  ON 1
ci_0003                -3.099654e-02 3 1  ON 2
ci_0004                -3.009249e-02 3 1  ON 3
ci_0005                -3.060400e-02 3 1  ON 4
ci_0006                -3.069543e-02 3 1  ON 5
ci_0007                -1.338072e-02 3 1  ON 6
ci_0008                -1.335044e-02 3 1  ON 7
ci_0009                -1.869666e-02 3 1  ON 8
ci_0010                -1.813064e-02 3 1  ON 9
ci_0011                -1.474534e-02 3 1  ON 10
ci_0012                -1.451199e-02 3 1  ON 11
ci_0013                 1.529514e-02 3 1  ON 12
ci_0014                 1.480531e-02 3 1  ON 13
ci_0015                 1.574741e-02 3 1  ON 14
ci_0016                 1.538625e-02 3 1  ON 15
ci_0017                 1.336747e-02 3 1  ON 16
ci_0018                 1.303916e-02 3 1  ON 17
ci_0019                 1.308984e-02 3 1  ON 18
ci_0020                 1.266790e-02 3 1  ON 19
ci_0021                 6.753369e-03 3 1  ON 20
ci_0022                 7.461634e-03 3 1  ON 21
ci_0023                -1.180366e-02 3 1  ON 22
ci_0024                -1.147022e-02 3 1  ON 23
ci_0025                -2.029936e-03 3 1  ON 24
ci_0026                -2.390286e-03 3 1  ON 25
ci_0027                -1.213149e-02 3 1  ON 26
ci_0028                -1.154875e-02 3 1  ON 27
ci_0029                -1.065792e-02 3 1  ON 28
ci_0030                -1.058678e-02 3 1  ON 29
ci_0031                 1.340933e-02 3 1  ON 30
ci_0032                 1.211312e-02 3 1  ON 31
ci_0033                 7.846901e-03 3 1  ON 32
ci_0034                 8.490290e-03 3 1  ON 33
ci_0035                 4.859102e-03 3 1  ON 34
ci_0036                 4.933611e-03 3 1  ON 35
ci_0037                -1.133426e-02 3 1  ON 36
ci_0038                -1.131411e-02 3 1  ON 37
ci_0039                -4.015134e-03 3 1  ON 38
ci_0040                -3.886013e-03 3 1  ON 39
ci_0041                 9.104191e-03 3 1  ON 40
ci_0042                 8.780658e-03 3 1  ON 41
ci_0043                -1.307343e-02 3 1  ON 42
ci_0044                -1.384491e-02 3 1  ON 43
ci_0045                 1.059125e-02 3 1  ON 44
ci_0046                 1.007940e-02 3 1  ON 45
ci_0047                -3.585213e-03 3 1  ON 46
ci_0048                -3.481788e-03 3 1  ON 47
ci_0049                -2.592185e-03 3 1  ON 48
ci_0050                -2.696255e-03 3 1  ON 49
ci_0051                -1.796921e-03 3 1  ON 50
ci_0052                -2.016509e-03 3 1  ON 51
ci_0053                -3.931447e-03 3 1  ON 52
ci_0054                -3.324612e-03 3 1  ON 53
ci_0055                 2.399813e-03 3 1  ON 54
ci_0056                 2.269324e-03 3 1  ON 55
ci_0057                 2.451687e-03 3 1  ON 56
ci_0058                 2.857057e-03 3 1  ON 57
ci_0059                -3.395581e-03 3 1  ON 58
ci_0060                -3.378178e-03 3 1  ON 59
ci_0061                -3.976729e-03 3 1  ON 60
ci_0062                -3.922566e-03 3 1  ON 61
ci_0063                -9.802812e-03 3 1  ON 62
ci_0064                -9.372478e-03 3 1  ON 63
ci_0065                -6.435562e-03 3 1  ON 64
ci_0066                -6.132249e-03 3 1  ON 65
ci_0067                -3.748464e-03 3 1  ON 66
ci_0068                -3.479401e-03 3 1  ON 67
ci_0069                 3.569445e-03 3 1  ON 68
ci_0070                 3.348543e-03 3 1  ON 69
ci_0071                 3.004644e-03 3 1  ON 70
ci_0072                 3.481779e-03 3 1  ON 71
ci_0073                 3.552053e-03 3 1  ON 72
ci_0074                 3.527798e-03 3 1  ON 73
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 51
    time step          = 0.05
    reference energy   = -16.8812
    reference variance = 0.165586
====================================================
  Execution time = 1.3862e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s051
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6898e+01
  VMC Evar = 2.9253e-01
  Total weights = 1.9512e+06
  Execution time = 1.8740e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.282942010378
                                         uncertainty =       0.001935244312

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.282942010378
                                         uncertainty =       0.001935244312

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000376080140
  error estimate for blocks of size 2^( 2) =       0.000393327390
  error estimate for blocks of size 2^( 3) =       0.000410663552
  error estimate for blocks of size 2^( 4) =       0.000425062900
  error estimate for blocks of size 2^( 5) =       0.000436225875
  error estimate for blocks of size 2^( 6) =       0.000442668885
  error estimate for blocks of size 2^( 7) =       0.000446666023

      target function =      -0.924409727915
              le_mean =     -16.898272869449
             les_mean =     285.844150679028
             stat err =       0.000437655921
             autocorr =       1.354268626814
   target nu stat err =       0.000437655921
   target dn stat err =       0.002432394067
      target stat err =       0.003880629334
              std dev =       0.531857634068
             le_variance =       0.282872542916

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.282941929846
                                         uncertainty =       0.001935087537

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.282941929846
                                         uncertainty =       0.001935087537

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000376080087
  error estimate for blocks of size 2^( 2) =       0.000393327495
  error estimate for blocks of size 2^( 3) =       0.000410663810
  error estimate for blocks of size 2^( 4) =       0.000425063230
  error estimate for blocks of size 2^( 5) =       0.000436226268
  error estimate for blocks of size 2^( 6) =       0.000442669464
  error estimate for blocks of size 2^( 7) =       0.000446666810

      target function =      -0.924395183512
              le_mean =     -16.898272903043
             les_mean =     285.844161090319
             stat err =       0.000437656443
             autocorr =       1.354272239591
   target nu stat err =       0.000437656443
   target dn stat err =       0.002433885618
      target stat err =       0.003882802642
              std dev =       0.531857559318
             le_variance =       0.282872463404

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.282941967784
                                         uncertainty =       0.001935165725

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.282941967784
                                         uncertainty =       0.001935165725

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000376080112
  error estimate for blocks of size 2^( 2) =       0.000393327441
  error estimate for blocks of size 2^( 3) =       0.000410663680
  error estimate for blocks of size 2^( 4) =       0.000425063064
  error estimate for blocks of size 2^( 5) =       0.000436226071
  error estimate for blocks of size 2^( 6) =       0.000442669174
  error estimate for blocks of size 2^( 7) =       0.000446666416

      target function =      -0.924402921252
              le_mean =     -16.898272886061
             les_mean =     285.844155581149
             stat err =       0.000437656181
             autocorr =       1.354270437957
   target nu stat err =       0.000437656181
   target dn stat err =       0.002433133420
      target stat err =       0.003881709964
              std dev =       0.531857594508
             le_variance =       0.282872500835

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.282942004801
                                         uncertainty =       0.001935234475

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.282942004801
                                         uncertainty =       0.001935234475

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000376080136
  error estimate for blocks of size 2^( 2) =       0.000393327396
  error estimate for blocks of size 2^( 3) =       0.000410663568
  error estimate for blocks of size 2^( 4) =       0.000425062920
  error estimate for blocks of size 2^( 5) =       0.000436225900
  error estimate for blocks of size 2^( 6) =       0.000442668921
  error estimate for blocks of size 2^( 7) =       0.000446666072

      target function =      -0.924408919310
              le_mean =     -16.898272871503
             les_mean =     285.844151264084
             stat err =       0.000437655953
             autocorr =       1.354268853526
   target nu stat err =       0.000437655953
   target dn stat err =       0.002432485759
      target stat err =       0.003880763644
              std dev =       0.531857628885
             le_variance =       0.282872537404


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.924409727915        initial  <--
     3.6380e+01     3.6380e+02             1.0863e-05        -0.924395183512
     1.4552e+02     1.4552e+03             2.7157e-06        -0.924402921252
     5.8208e+02     5.8208e+03             6.7891e-07        -0.924408919310

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 23.3994
  </log>
  <optVariables href="H2O.s051.opt.xml">
ci_0001                 7.086071e-01 3 1  ON 0
ci_0002                 6.927476e-01 3 1  ON 1
ci_0003                -3.099737e-02 3 1  ON 2
ci_0004                -3.009221e-02 3 1  ON 3
ci_0005                -3.060355e-02 3 1  ON 4
ci_0006                -3.069534e-02 3 1  ON 5
ci_0007                -1.338111e-02 3 1  ON 6
ci_0008                -1.335091e-02 3 1  ON 7
ci_0009                -1.869658e-02 3 1  ON 8
ci_0010                -1.813042e-02 3 1  ON 9
ci_0011                -1.474503e-02 3 1  ON 10
ci_0012                -1.451129e-02 3 1  ON 11
ci_0013                 1.529487e-02 3 1  ON 12
ci_0014                 1.480545e-02 3 1  ON 13
ci_0015                 1.574760e-02 3 1  ON 14
ci_0016                 1.538662e-02 3 1  ON 15
ci_0017                 1.336765e-02 3 1  ON 16
ci_0018                 1.303921e-02 3 1  ON 17
ci_0019                 1.308968e-02 3 1  ON 18
ci_0020                 1.266817e-02 3 1  ON 19
ci_0021                 6.753566e-03 3 1  ON 20
ci_0022                 7.461876e-03 3 1  ON 21
ci_0023                -1.180421e-02 3 1  ON 22
ci_0024                -1.147005e-02 3 1  ON 23
ci_0025                -2.029365e-03 3 1  ON 24
ci_0026                -2.390659e-03 3 1  ON 25
ci_0027                -1.213156e-02 3 1  ON 26
ci_0028                -1.154871e-02 3 1  ON 27
ci_0029                -1.065807e-02 3 1  ON 28
ci_0030                -1.058714e-02 3 1  ON 29
ci_0031                 1.340934e-02 3 1  ON 30
ci_0032                 1.211398e-02 3 1  ON 31
ci_0033                 7.848073e-03 3 1  ON 32
ci_0034                 8.490882e-03 3 1  ON 33
ci_0035                 4.858824e-03 3 1  ON 34
ci_0036                 4.934155e-03 3 1  ON 35
ci_0037                -1.133418e-02 3 1  ON 36
ci_0038                -1.131394e-02 3 1  ON 37
ci_0039                -4.015102e-03 3 1  ON 38
ci_0040                -3.886144e-03 3 1  ON 39
ci_0041                 9.104088e-03 3 1  ON 40
ci_0042                 8.780716e-03 3 1  ON 41
ci_0043                -1.307249e-02 3 1  ON 42
ci_0044                -1.384496e-02 3 1  ON 43
ci_0045                 1.059155e-02 3 1  ON 44
ci_0046                 1.007908e-02 3 1  ON 45
ci_0047                -3.585422e-03 3 1  ON 46
ci_0048                -3.481823e-03 3 1  ON 47
ci_0049                -2.594364e-03 3 1  ON 48
ci_0050                -2.696337e-03 3 1  ON 49
ci_0051                -1.797501e-03 3 1  ON 50
ci_0052                -2.016480e-03 3 1  ON 51
ci_0053                -3.932030e-03 3 1  ON 52
ci_0054                -3.323822e-03 3 1  ON 53
ci_0055                 2.399187e-03 3 1  ON 54
ci_0056                 2.269230e-03 3 1  ON 55
ci_0057                 2.454171e-03 3 1  ON 56
ci_0058                 2.857715e-03 3 1  ON 57
ci_0059                -3.395934e-03 3 1  ON 58
ci_0060                -3.376222e-03 3 1  ON 59
ci_0061                -3.976518e-03 3 1  ON 60
ci_0062                -3.922569e-03 3 1  ON 61
ci_0063                -9.802847e-03 3 1  ON 62
ci_0064                -9.372860e-03 3 1  ON 63
ci_0065                -6.435389e-03 3 1  ON 64
ci_0066                -6.132328e-03 3 1  ON 65
ci_0067                -3.748268e-03 3 1  ON 66
ci_0068                -3.479628e-03 3 1  ON 67
ci_0069                 3.569559e-03 3 1  ON 68
ci_0070                 3.348532e-03 3 1  ON 69
ci_0071                 3.005195e-03 3 1  ON 70
ci_0072                 3.481640e-03 3 1  ON 71
ci_0073                 3.552439e-03 3 1  ON 72
ci_0074                 3.529331e-03 3 1  ON 73
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 4.0390e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s052 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s052 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=52  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6905e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 52
    time step          = 0.05
    reference energy   = -16.8311
    reference variance = 0.384991
====================================================
  Execution time = 1.4422e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s052
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5219e+04
  VMC Eavg = -1.6899e+01
  VMC Evar = 2.9239e-01
  Total weights = 1.951136700e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 2.5590e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.281439352467
                                         uncertainty =       0.001545451714

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.281439352467
                                         uncertainty =       0.001545451714

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000375115059
  error estimate for blocks of size 2^( 2) =       0.000392421581
  error estimate for blocks of size 2^( 3) =       0.000410088386
  error estimate for blocks of size 2^( 4) =       0.000425028332
  error estimate for blocks of size 2^( 5) =       0.000436807743
  error estimate for blocks of size 2^( 6) =       0.000444073297
  error estimate for blocks of size 2^( 7) =       0.000450112182

      target function =      -0.924632747164
              le_mean =     -16.899097888865
             les_mean =     285.871901281243
             stat err =       0.000439005388
             autocorr =       1.369653476571
   target nu stat err =       0.000439005388
   target dn stat err =       0.002174526490
      target stat err =       0.003492498985
              std dev =       0.530492803222
             le_variance =       0.281422614270


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.689909788887e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 74
Check correct_vf_var_size: 225, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 3.6380e+02, overlap shift 3.6380e+03 and omega -1.7444e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.924644583197       residual = 7.97e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.924644673170       residual = 8.51e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.924644687790       residual = 2.73e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.924644692480       residual = 1.16e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.924644694625       residual = 4.60e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.924644694966       residual = 3.17e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.924644694838       residual = 1.54e-05           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.924644694937       residual = 9.47e-06           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.924644695286       residual = 1.01e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.924644695870       residual = 1.02e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.924644695787       residual = 4.97e-06           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.924644696070       residual = 2.17e-06           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.924644696124       residual = 9.84e-07           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.924644696176       residual = 3.21e-07           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.924644696301       residual = 1.32e-07           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.924644696351       residual = 3.64e-08           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.924644696344       residual = 9.32e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         16 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 3.6380e+02 is 5.811942e-07

solving harmonic davidson linear method for identity shift 1.4552e+03, overlap shift 1.4552e+04 and omega -1.7444e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.924644583197       residual = 7.97e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.924644605694       residual = 8.51e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.924644609349       residual = 2.73e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.924644610523       residual = 1.16e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.924644611059       residual = 4.60e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.924644611145       residual = 3.17e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.924644611111       residual = 1.54e-05           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.924644611138       residual = 9.47e-06           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.924644611223       residual = 1.01e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.924644611369       residual = 1.02e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.924644611349       residual = 4.97e-06           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.924644611418       residual = 2.17e-06           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.924644611427       residual = 9.83e-07           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.924644611445       residual = 3.21e-07           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.924644611481       residual = 1.32e-07           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.924644611487       residual = 3.64e-08           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.924644611491       residual = 9.31e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         16 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 1.4552e+03 is 1.452985e-07

solving harmonic davidson linear method for identity shift 5.8208e+03, overlap shift 5.8208e+04 and omega -1.7444e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.924644583197       residual = 7.97e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.924644588822       residual = 8.51e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.924644589735       residual = 2.73e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.924644590028       residual = 1.16e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.924644590163       residual = 4.60e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.924644590190       residual = 3.17e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.924644590164       residual = 1.54e-05           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.924644590183       residual = 9.47e-06           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.924644590205       residual = 1.01e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.924644590247       residual = 1.02e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.924644590238       residual = 4.97e-06           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.924644590246       residual = 2.17e-06           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.924644590256       residual = 9.83e-07           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.924644590260       residual = 3.21e-07           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.924644590247       residual = 1.32e-07           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.924644590292       residual = 3.64e-08           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.924644590285       residual = 9.31e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         16 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 5.8208e+03 is 3.632461e-08

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.666737 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 75 and numParams is: 74

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.6996e+01
  </log>
  <optVariables href="H2O.s052.opt.xml">
ci_0001                 7.086072e-01 3 1  ON 0
ci_0002                 6.927474e-01 3 1  ON 1
ci_0003                -3.099735e-02 3 1  ON 2
ci_0004                -3.009217e-02 3 1  ON 3
ci_0005                -3.060355e-02 3 1  ON 4
ci_0006                -3.069534e-02 3 1  ON 5
ci_0007                -1.338109e-02 3 1  ON 6
ci_0008                -1.335087e-02 3 1  ON 7
ci_0009                -1.869660e-02 3 1  ON 8
ci_0010                -1.813042e-02 3 1  ON 9
ci_0011                -1.474502e-02 3 1  ON 10
ci_0012                -1.451130e-02 3 1  ON 11
ci_0013                 1.529483e-02 3 1  ON 12
ci_0014                 1.480546e-02 3 1  ON 13
ci_0015                 1.574758e-02 3 1  ON 14
ci_0016                 1.538659e-02 3 1  ON 15
ci_0017                 1.336764e-02 3 1  ON 16
ci_0018                 1.303926e-02 3 1  ON 17
ci_0019                 1.308969e-02 3 1  ON 18
ci_0020                 1.266814e-02 3 1  ON 19
ci_0021                 6.753506e-03 3 1  ON 20
ci_0022                 7.461908e-03 3 1  ON 21
ci_0023                -1.180422e-02 3 1  ON 22
ci_0024                -1.147005e-02 3 1  ON 23
ci_0025                -2.029317e-03 3 1  ON 24
ci_0026                -2.390673e-03 3 1  ON 25
ci_0027                -1.213159e-02 3 1  ON 26
ci_0028                -1.154876e-02 3 1  ON 27
ci_0029                -1.065803e-02 3 1  ON 28
ci_0030                -1.058714e-02 3 1  ON 29
ci_0031                 1.340933e-02 3 1  ON 30
ci_0032                 1.211396e-02 3 1  ON 31
ci_0033                 7.848077e-03 3 1  ON 32
ci_0034                 8.490803e-03 3 1  ON 33
ci_0035                 4.858829e-03 3 1  ON 34
ci_0036                 4.934124e-03 3 1  ON 35
ci_0037                -1.133418e-02 3 1  ON 36
ci_0038                -1.131393e-02 3 1  ON 37
ci_0039                -4.015097e-03 3 1  ON 38
ci_0040                -3.886163e-03 3 1  ON 39
ci_0041                 9.104140e-03 3 1  ON 40
ci_0042                 8.780724e-03 3 1  ON 41
ci_0043                -1.307255e-02 3 1  ON 42
ci_0044                -1.384505e-02 3 1  ON 43
ci_0045                 1.059153e-02 3 1  ON 44
ci_0046                 1.007903e-02 3 1  ON 45
ci_0047                -3.585427e-03 3 1  ON 46
ci_0048                -3.481837e-03 3 1  ON 47
ci_0049                -2.594408e-03 3 1  ON 48
ci_0050                -2.696363e-03 3 1  ON 49
ci_0051                -1.797504e-03 3 1  ON 50
ci_0052                -2.016472e-03 3 1  ON 51
ci_0053                -3.932024e-03 3 1  ON 52
ci_0054                -3.323862e-03 3 1  ON 53
ci_0055                 2.399143e-03 3 1  ON 54
ci_0056                 2.269165e-03 3 1  ON 55
ci_0057                 2.454145e-03 3 1  ON 56
ci_0058                 2.857662e-03 3 1  ON 57
ci_0059                -3.395980e-03 3 1  ON 58
ci_0060                -3.376228e-03 3 1  ON 59
ci_0061                -3.976507e-03 3 1  ON 60
ci_0062                -3.922627e-03 3 1  ON 61
ci_0063                -9.802834e-03 3 1  ON 62
ci_0064                -9.372907e-03 3 1  ON 63
ci_0065                -6.435376e-03 3 1  ON 64
ci_0066                -6.132329e-03 3 1  ON 65
ci_0067                -3.748281e-03 3 1  ON 66
ci_0068                -3.479663e-03 3 1  ON 67
ci_0069                 3.569571e-03 3 1  ON 68
ci_0070                 3.348444e-03 3 1  ON 69
ci_0071                 3.005239e-03 3 1  ON 70
ci_0072                 3.481627e-03 3 1  ON 71
ci_0073                 3.552395e-03 3 1  ON 72
ci_0074                 3.529349e-03 3 1  ON 73
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 52
    time step          = 0.05
    reference energy   = -16.8709
    reference variance = 0.356017
====================================================
  Execution time = 1.3870e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s052
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6898e+01
  VMC Evar = 2.9121e-01
  Total weights = 1.9510e+06
  Execution time = 1.8732e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.284192973383
                                         uncertainty =       0.002120032350

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.284192973383
                                         uncertainty =       0.002120032350

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000376961832
  error estimate for blocks of size 2^( 2) =       0.000394270419
  error estimate for blocks of size 2^( 3) =       0.000411874017
  error estimate for blocks of size 2^( 4) =       0.000427533633
  error estimate for blocks of size 2^( 5) =       0.000439536239
  error estimate for blocks of size 2^( 6) =       0.000446398835
  error estimate for blocks of size 2^( 7) =       0.000452602357

      target function =      -0.926467817672
              le_mean =     -16.898315176750
             les_mean =     285.844269227930
             stat err =       0.000441517766
             autocorr =       1.371834145152
   target nu stat err =       0.000441517766
   target dn stat err =       0.002502732501
      target stat err =       0.004007815421
              std dev =       0.533104535103
             le_variance =       0.284200445348

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.284193069589
                                         uncertainty =       0.002120129773

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.284193069589
                                         uncertainty =       0.002120129773

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000376961894
  error estimate for blocks of size 2^( 2) =       0.000394270475
  error estimate for blocks of size 2^( 3) =       0.000411874066
  error estimate for blocks of size 2^( 4) =       0.000427533680
  error estimate for blocks of size 2^( 5) =       0.000439536287
  error estimate for blocks of size 2^( 6) =       0.000446398878
  error estimate for blocks of size 2^( 7) =       0.000452602421

      target function =      -0.926466614253
              le_mean =     -16.898315178368
             les_mean =     285.844270046716
             stat err =       0.000441517817
             autocorr =       1.371834007664
   target nu stat err =       0.000441517817
   target dn stat err =       0.002502843017
      target stat err =       0.004007976011
              std dev =       0.533104623075
             le_variance =       0.284200539144

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.284193021484
                                         uncertainty =       0.002120081065

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.284193021484
                                         uncertainty =       0.002120081065

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000376961863
  error estimate for blocks of size 2^( 2) =       0.000394270447
  error estimate for blocks of size 2^( 3) =       0.000411874041
  error estimate for blocks of size 2^( 4) =       0.000427533656
  error estimate for blocks of size 2^( 5) =       0.000439536263
  error estimate for blocks of size 2^( 6) =       0.000446398856
  error estimate for blocks of size 2^( 7) =       0.000452602389

      target function =      -0.926467237034
              le_mean =     -16.898315177558
             les_mean =     285.844269623890
             stat err =       0.000441517791
             autocorr =       1.371834076409
   target nu stat err =       0.000441517791
   target dn stat err =       0.002502787719
      target stat err =       0.004007895833
              std dev =       0.533104579087
             le_variance =       0.284200492243

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.284192979395
                                         uncertainty =       0.002120038439

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.284192979395
                                         uncertainty =       0.002120038439

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000376961836
  error estimate for blocks of size 2^( 2) =       0.000394270423
  error estimate for blocks of size 2^( 3) =       0.000411874020
  error estimate for blocks of size 2^( 4) =       0.000427533636
  error estimate for blocks of size 2^( 5) =       0.000439536242
  error estimate for blocks of size 2^( 6) =       0.000446398837
  error estimate for blocks of size 2^( 7) =       0.000452602361

      target function =      -0.926467747604
              le_mean =     -16.898315176851
             les_mean =     285.844269275823
             stat err =       0.000441517769
             autocorr =       1.371834136553
   target nu stat err =       0.000441517769
   target dn stat err =       0.002502739398
      target stat err =       0.004007825487
              std dev =       0.533104540601
             le_variance =       0.284200451209


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.926467817672        initial  <--
     3.6380e+02     3.6380e+03             5.8119e-07        -0.926466614253
     1.4552e+03     1.4552e+04             1.4530e-07        -0.926467237034
     5.8208e+03     5.8208e+04             3.6325e-08        -0.926467747604

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 23.3325
  </log>
  <optVariables href="H2O.s052.opt.xml">
ci_0001                 7.086071e-01 3 1  ON 0
ci_0002                 6.927476e-01 3 1  ON 1
ci_0003                -3.099737e-02 3 1  ON 2
ci_0004                -3.009221e-02 3 1  ON 3
ci_0005                -3.060355e-02 3 1  ON 4
ci_0006                -3.069534e-02 3 1  ON 5
ci_0007                -1.338111e-02 3 1  ON 6
ci_0008                -1.335091e-02 3 1  ON 7
ci_0009                -1.869658e-02 3 1  ON 8
ci_0010                -1.813042e-02 3 1  ON 9
ci_0011                -1.474503e-02 3 1  ON 10
ci_0012                -1.451129e-02 3 1  ON 11
ci_0013                 1.529487e-02 3 1  ON 12
ci_0014                 1.480545e-02 3 1  ON 13
ci_0015                 1.574760e-02 3 1  ON 14
ci_0016                 1.538662e-02 3 1  ON 15
ci_0017                 1.336765e-02 3 1  ON 16
ci_0018                 1.303921e-02 3 1  ON 17
ci_0019                 1.308968e-02 3 1  ON 18
ci_0020                 1.266817e-02 3 1  ON 19
ci_0021                 6.753566e-03 3 1  ON 20
ci_0022                 7.461876e-03 3 1  ON 21
ci_0023                -1.180421e-02 3 1  ON 22
ci_0024                -1.147005e-02 3 1  ON 23
ci_0025                -2.029365e-03 3 1  ON 24
ci_0026                -2.390659e-03 3 1  ON 25
ci_0027                -1.213156e-02 3 1  ON 26
ci_0028                -1.154871e-02 3 1  ON 27
ci_0029                -1.065807e-02 3 1  ON 28
ci_0030                -1.058714e-02 3 1  ON 29
ci_0031                 1.340934e-02 3 1  ON 30
ci_0032                 1.211398e-02 3 1  ON 31
ci_0033                 7.848073e-03 3 1  ON 32
ci_0034                 8.490882e-03 3 1  ON 33
ci_0035                 4.858824e-03 3 1  ON 34
ci_0036                 4.934155e-03 3 1  ON 35
ci_0037                -1.133418e-02 3 1  ON 36
ci_0038                -1.131394e-02 3 1  ON 37
ci_0039                -4.015102e-03 3 1  ON 38
ci_0040                -3.886144e-03 3 1  ON 39
ci_0041                 9.104088e-03 3 1  ON 40
ci_0042                 8.780716e-03 3 1  ON 41
ci_0043                -1.307249e-02 3 1  ON 42
ci_0044                -1.384496e-02 3 1  ON 43
ci_0045                 1.059155e-02 3 1  ON 44
ci_0046                 1.007908e-02 3 1  ON 45
ci_0047                -3.585422e-03 3 1  ON 46
ci_0048                -3.481823e-03 3 1  ON 47
ci_0049                -2.594364e-03 3 1  ON 48
ci_0050                -2.696337e-03 3 1  ON 49
ci_0051                -1.797501e-03 3 1  ON 50
ci_0052                -2.016480e-03 3 1  ON 51
ci_0053                -3.932030e-03 3 1  ON 52
ci_0054                -3.323822e-03 3 1  ON 53
ci_0055                 2.399187e-03 3 1  ON 54
ci_0056                 2.269230e-03 3 1  ON 55
ci_0057                 2.454171e-03 3 1  ON 56
ci_0058                 2.857715e-03 3 1  ON 57
ci_0059                -3.395934e-03 3 1  ON 58
ci_0060                -3.376222e-03 3 1  ON 59
ci_0061                -3.976518e-03 3 1  ON 60
ci_0062                -3.922569e-03 3 1  ON 61
ci_0063                -9.802847e-03 3 1  ON 62
ci_0064                -9.372860e-03 3 1  ON 63
ci_0065                -6.435389e-03 3 1  ON 64
ci_0066                -6.132328e-03 3 1  ON 65
ci_0067                -3.748268e-03 3 1  ON 66
ci_0068                -3.479628e-03 3 1  ON 67
ci_0069                 3.569559e-03 3 1  ON 68
ci_0070                 3.348532e-03 3 1  ON 69
ci_0071                 3.005195e-03 3 1  ON 70
ci_0072                 3.481640e-03 3 1  ON 71
ci_0073                 3.552439e-03 3 1  ON 72
ci_0074                 3.529331e-03 3 1  ON 73
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 4.0354e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s053 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s053 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=53  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6904e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 53
    time step          = 0.05
    reference energy   = -16.8528
    reference variance = 0.236653
====================================================
  Execution time = 1.4303e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s053
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5261e+04
  VMC Eavg = -1.6898e+01
  VMC Evar = 2.9395e-01
  Total weights = 1.951384886e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 2.5813e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.285338146961
                                         uncertainty =       0.002083276806

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.285338146961
                                         uncertainty =       0.002083276806

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000377689272
  error estimate for blocks of size 2^( 2) =       0.000394259644
  error estimate for blocks of size 2^( 3) =       0.000411164144
  error estimate for blocks of size 2^( 4) =       0.000425613669
  error estimate for blocks of size 2^( 5) =       0.000437757591
  error estimate for blocks of size 2^( 6) =       0.000444663508
  error estimate for blocks of size 2^( 7) =       0.000448076178

      target function =      -0.922178436541
              le_mean =     -16.898310561427
             les_mean =     285.846851140497
             stat err =       0.000439027737
             autocorr =       1.351184392266
   target nu stat err =       0.000439027737
   target dn stat err =       0.002681464249
      target stat err =       0.004244603362
              std dev =       0.534133290429
             le_variance =       0.285298371944


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.689831056143e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 74
Check correct_vf_var_size: 225, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 3.6380e+03, overlap shift 3.6380e+04 and omega -1.7444e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.922196430116       residual = 1.33e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.922196444464       residual = 2.00e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.922196446425       residual = 3.45e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.922196446754       residual = 1.48e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.922196447160       residual = 5.22e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.922196447277       residual = 4.32e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.922196447383       residual = 2.22e-05           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.922196447366       residual = 1.25e-05           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.922196447371       residual = 1.69e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.922196447438       residual = 1.16e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.922196447466       residual = 6.70e-06           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.922196447492       residual = 2.64e-06           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.922196447528       residual = 1.32e-06           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.922196447518       residual = 3.57e-07           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.922196447530       residual = 5.03e-08           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.922196447518       residual = 1.84e-08           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.922196447523       residual = 4.73e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         16 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 3.6380e+03 is 7.208342e-08

solving harmonic davidson linear method for identity shift 1.4552e+04, overlap shift 1.4552e+05 and omega -1.7444e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.922196430116       residual = 1.33e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.922196433703       residual = 2.00e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.922196434193       residual = 3.45e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.922196434274       residual = 1.48e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.922196434377       residual = 5.22e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.922196434406       residual = 4.32e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.922196434433       residual = 2.22e-05           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.922196434429       residual = 1.25e-05           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.922196434430       residual = 1.69e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.922196434446       residual = 1.16e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.922196434454       residual = 6.70e-06           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.922196434464       residual = 2.64e-06           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.922196434480       residual = 1.32e-06           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.922196434441       residual = 3.57e-07           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.922196434478       residual = 5.03e-08           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.922196434401       residual = 1.84e-08           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.922196434481       residual = 4.73e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         16 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 1.4552e+04 is 1.802115e-08

solving harmonic davidson linear method for identity shift 5.8208e+04, overlap shift 5.8208e+05 and omega -1.7444e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.922196430116       residual = 1.33e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.922196431013       residual = 2.00e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.922196431136       residual = 3.45e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.922196431156       residual = 1.48e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.922196431184       residual = 5.22e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.922196431219       residual = 4.32e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.922196431345       residual = 2.22e-05           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.922196431256       residual = 1.25e-05           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.922196431363       residual = 1.69e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.922196431157       residual = 1.16e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.922196431198       residual = 6.70e-06           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.922196431216       residual = 2.64e-06           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.922196431204       residual = 1.32e-06           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.922196431276       residual = 3.57e-07           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.922196431067       residual = 5.03e-08           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.922196431030       residual = 1.84e-08           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.922196431178       residual = 4.73e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         16 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 5.8208e+04 is 4.505305e-09

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.675773 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 75 and numParams is: 74

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.6899e+01
  </log>
  <optVariables href="H2O.s053.opt.xml">
ci_0001                 7.086071e-01 3 1  ON 0
ci_0002                 6.927476e-01 3 1  ON 1
ci_0003                -3.099736e-02 3 1  ON 2
ci_0004                -3.009221e-02 3 1  ON 3
ci_0005                -3.060354e-02 3 1  ON 4
ci_0006                -3.069535e-02 3 1  ON 5
ci_0007                -1.338110e-02 3 1  ON 6
ci_0008                -1.335091e-02 3 1  ON 7
ci_0009                -1.869658e-02 3 1  ON 8
ci_0010                -1.813041e-02 3 1  ON 9
ci_0011                -1.474503e-02 3 1  ON 10
ci_0012                -1.451130e-02 3 1  ON 11
ci_0013                 1.529487e-02 3 1  ON 12
ci_0014                 1.480545e-02 3 1  ON 13
ci_0015                 1.574760e-02 3 1  ON 14
ci_0016                 1.538662e-02 3 1  ON 15
ci_0017                 1.336765e-02 3 1  ON 16
ci_0018                 1.303921e-02 3 1  ON 17
ci_0019                 1.308968e-02 3 1  ON 18
ci_0020                 1.266817e-02 3 1  ON 19
ci_0021                 6.753558e-03 3 1  ON 20
ci_0022                 7.461869e-03 3 1  ON 21
ci_0023                -1.180421e-02 3 1  ON 22
ci_0024                -1.147005e-02 3 1  ON 23
ci_0025                -2.029359e-03 3 1  ON 24
ci_0026                -2.390659e-03 3 1  ON 25
ci_0027                -1.213156e-02 3 1  ON 26
ci_0028                -1.154871e-02 3 1  ON 27
ci_0029                -1.065807e-02 3 1  ON 28
ci_0030                -1.058714e-02 3 1  ON 29
ci_0031                 1.340934e-02 3 1  ON 30
ci_0032                 1.211399e-02 3 1  ON 31
ci_0033                 7.848073e-03 3 1  ON 32
ci_0034                 8.490881e-03 3 1  ON 33
ci_0035                 4.858817e-03 3 1  ON 34
ci_0036                 4.934137e-03 3 1  ON 35
ci_0037                -1.133418e-02 3 1  ON 36
ci_0038                -1.131394e-02 3 1  ON 37
ci_0039                -4.015100e-03 3 1  ON 38
ci_0040                -3.886144e-03 3 1  ON 39
ci_0041                 9.104089e-03 3 1  ON 40
ci_0042                 8.780719e-03 3 1  ON 41
ci_0043                -1.307249e-02 3 1  ON 42
ci_0044                -1.384497e-02 3 1  ON 43
ci_0045                 1.059155e-02 3 1  ON 44
ci_0046                 1.007908e-02 3 1  ON 45
ci_0047                -3.585422e-03 3 1  ON 46
ci_0048                -3.481825e-03 3 1  ON 47
ci_0049                -2.594365e-03 3 1  ON 48
ci_0050                -2.696331e-03 3 1  ON 49
ci_0051                -1.797507e-03 3 1  ON 50
ci_0052                -2.016479e-03 3 1  ON 51
ci_0053                -3.932025e-03 3 1  ON 52
ci_0054                -3.323820e-03 3 1  ON 53
ci_0055                 2.399190e-03 3 1  ON 54
ci_0056                 2.269227e-03 3 1  ON 55
ci_0057                 2.454166e-03 3 1  ON 56
ci_0058                 2.857711e-03 3 1  ON 57
ci_0059                -3.395929e-03 3 1  ON 58
ci_0060                -3.376219e-03 3 1  ON 59
ci_0061                -3.976521e-03 3 1  ON 60
ci_0062                -3.922567e-03 3 1  ON 61
ci_0063                -9.802845e-03 3 1  ON 62
ci_0064                -9.372860e-03 3 1  ON 63
ci_0065                -6.435387e-03 3 1  ON 64
ci_0066                -6.132329e-03 3 1  ON 65
ci_0067                -3.748269e-03 3 1  ON 66
ci_0068                -3.479635e-03 3 1  ON 67
ci_0069                 3.569559e-03 3 1  ON 68
ci_0070                 3.348532e-03 3 1  ON 69
ci_0071                 3.005198e-03 3 1  ON 70
ci_0072                 3.481641e-03 3 1  ON 71
ci_0073                 3.552441e-03 3 1  ON 72
ci_0074                 3.529332e-03 3 1  ON 73
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 53
    time step          = 0.05
    reference energy   = -16.9004
    reference variance = 0.157735
====================================================
  Execution time = 1.4029e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s053
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6899e+01
  VMC Evar = 2.8996e-01
  Total weights = 1.9509e+06
  Execution time = 1.8723e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.281621666057
                                         uncertainty =       0.001678403851

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.281621666057
                                         uncertainty =       0.001678403851

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000375284631
  error estimate for blocks of size 2^( 2) =       0.000392086550
  error estimate for blocks of size 2^( 3) =       0.000409049432
  error estimate for blocks of size 2^( 4) =       0.000423969220
  error estimate for blocks of size 2^( 5) =       0.000435059506
  error estimate for blocks of size 2^( 6) =       0.000441043717
  error estimate for blocks of size 2^( 7) =       0.000445443437

      target function =      -0.928459196289
              le_mean =     -16.898502993060
             les_mean =     285.849359999023
             stat err =       0.000436378970
             autocorr =       1.352091454003
   target nu stat err =       0.000436378970
   target dn stat err =       0.002004002582
      target stat err =       0.003253094338
              std dev =       0.530732614854
             le_variance =       0.281677108469

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.281621659030
                                         uncertainty =       0.001678402683

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.281621659030
                                         uncertainty =       0.001678402683

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000375284626
  error estimate for blocks of size 2^( 2) =       0.000392086546
  error estimate for blocks of size 2^( 3) =       0.000409049429
  error estimate for blocks of size 2^( 4) =       0.000423969217
  error estimate for blocks of size 2^( 5) =       0.000435059503
  error estimate for blocks of size 2^( 6) =       0.000441043714
  error estimate for blocks of size 2^( 7) =       0.000445443432

      target function =      -0.928459331054
              le_mean =     -16.898502992913
             les_mean =     285.849359908792
             stat err =       0.000436378967
             autocorr =       1.352091466430
   target nu stat err =       0.000436378967
   target dn stat err =       0.002003999956
      target stat err =       0.003253091214
              std dev =       0.530732608276
             le_variance =       0.281677101487

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.281621662544
                                         uncertainty =       0.001678403267

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.281621662544
                                         uncertainty =       0.001678403267

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000375284629
  error estimate for blocks of size 2^( 2) =       0.000392086548
  error estimate for blocks of size 2^( 3) =       0.000409049431
  error estimate for blocks of size 2^( 4) =       0.000423969219
  error estimate for blocks of size 2^( 5) =       0.000435059505
  error estimate for blocks of size 2^( 6) =       0.000441043716
  error estimate for blocks of size 2^( 7) =       0.000445443435

      target function =      -0.928459263712
              le_mean =     -16.898502992986
             les_mean =     285.849359953882
             stat err =       0.000436378968
             autocorr =       1.352091460215
   target nu stat err =       0.000436378968
   target dn stat err =       0.002004001268
      target stat err =       0.003253092775
              std dev =       0.530732611564
             le_variance =       0.281677104978

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.281621665618
                                         uncertainty =       0.001678403778

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.281621665618
                                         uncertainty =       0.001678403778

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000375284631
  error estimate for blocks of size 2^( 2) =       0.000392086549
  error estimate for blocks of size 2^( 3) =       0.000409049432
  error estimate for blocks of size 2^( 4) =       0.000423969220
  error estimate for blocks of size 2^( 5) =       0.000435059506
  error estimate for blocks of size 2^( 6) =       0.000441043717
  error estimate for blocks of size 2^( 7) =       0.000445443437

      target function =      -0.928459204721
              le_mean =     -16.898502993051
             les_mean =     285.849359993378
             stat err =       0.000436378970
             autocorr =       1.352091454777
   target nu stat err =       0.000436378970
   target dn stat err =       0.002004002418
      target stat err =       0.003253094143
              std dev =       0.530732614442
             le_variance =       0.281677108033


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.928459196289        initial
     3.6380e+03     3.6380e+04             7.2083e-08        -0.928459331054  <--
     1.4552e+04     1.4552e+05             1.8021e-08        -0.928459263712
     5.8208e+04     5.8208e+05             4.5053e-09        -0.928459204721

*****************************************************************************
Applying the update for shift_i =   3.6380e+03     and shift_s =   3.6380e+04
*****************************************************************************

  Execution time = 2.3460e+01
  </log>
  <optVariables href="H2O.s053.opt.xml">
ci_0001                 7.086070e-01 3 1  ON 0
ci_0002                 6.927476e-01 3 1  ON 1
ci_0003                -3.099735e-02 3 1  ON 2
ci_0004                -3.009221e-02 3 1  ON 3
ci_0005                -3.060353e-02 3 1  ON 4
ci_0006                -3.069537e-02 3 1  ON 5
ci_0007                -1.338107e-02 3 1  ON 6
ci_0008                -1.335092e-02 3 1  ON 7
ci_0009                -1.869657e-02 3 1  ON 8
ci_0010                -1.813041e-02 3 1  ON 9
ci_0011                -1.474503e-02 3 1  ON 10
ci_0012                -1.451131e-02 3 1  ON 11
ci_0013                 1.529488e-02 3 1  ON 12
ci_0014                 1.480545e-02 3 1  ON 13
ci_0015                 1.574758e-02 3 1  ON 14
ci_0016                 1.538661e-02 3 1  ON 15
ci_0017                 1.336764e-02 3 1  ON 16
ci_0018                 1.303921e-02 3 1  ON 17
ci_0019                 1.308969e-02 3 1  ON 18
ci_0020                 1.266817e-02 3 1  ON 19
ci_0021                 6.753533e-03 3 1  ON 20
ci_0022                 7.461846e-03 3 1  ON 21
ci_0023                -1.180421e-02 3 1  ON 22
ci_0024                -1.147005e-02 3 1  ON 23
ci_0025                -2.029339e-03 3 1  ON 24
ci_0026                -2.390658e-03 3 1  ON 25
ci_0027                -1.213157e-02 3 1  ON 26
ci_0028                -1.154873e-02 3 1  ON 27
ci_0029                -1.065807e-02 3 1  ON 28
ci_0030                -1.058714e-02 3 1  ON 29
ci_0031                 1.340934e-02 3 1  ON 30
ci_0032                 1.211401e-02 3 1  ON 31
ci_0033                 7.848073e-03 3 1  ON 32
ci_0034                 8.490879e-03 3 1  ON 33
ci_0035                 4.858796e-03 3 1  ON 34
ci_0036                 4.934083e-03 3 1  ON 35
ci_0037                -1.133418e-02 3 1  ON 36
ci_0038                -1.131395e-02 3 1  ON 37
ci_0039                -4.015097e-03 3 1  ON 38
ci_0040                -3.886142e-03 3 1  ON 39
ci_0041                 9.104094e-03 3 1  ON 40
ci_0042                 8.780728e-03 3 1  ON 41
ci_0043                -1.307248e-02 3 1  ON 42
ci_0044                -1.384499e-02 3 1  ON 43
ci_0045                 1.059155e-02 3 1  ON 44
ci_0046                 1.007908e-02 3 1  ON 45
ci_0047                -3.585422e-03 3 1  ON 46
ci_0048                -3.481829e-03 3 1  ON 47
ci_0049                -2.594367e-03 3 1  ON 48
ci_0050                -2.696311e-03 3 1  ON 49
ci_0051                -1.797527e-03 3 1  ON 50
ci_0052                -2.016475e-03 3 1  ON 51
ci_0053                -3.932009e-03 3 1  ON 52
ci_0054                -3.323811e-03 3 1  ON 53
ci_0055                 2.399202e-03 3 1  ON 54
ci_0056                 2.269218e-03 3 1  ON 55
ci_0057                 2.454150e-03 3 1  ON 56
ci_0058                 2.857698e-03 3 1  ON 57
ci_0059                -3.395912e-03 3 1  ON 58
ci_0060                -3.376208e-03 3 1  ON 59
ci_0061                -3.976529e-03 3 1  ON 60
ci_0062                -3.922558e-03 3 1  ON 61
ci_0063                -9.802840e-03 3 1  ON 62
ci_0064                -9.372858e-03 3 1  ON 63
ci_0065                -6.435382e-03 3 1  ON 64
ci_0066                -6.132330e-03 3 1  ON 65
ci_0067                -3.748270e-03 3 1  ON 66
ci_0068                -3.479655e-03 3 1  ON 67
ci_0069                 3.569560e-03 3 1  ON 68
ci_0070                 3.348531e-03 3 1  ON 69
ci_0071                 3.005208e-03 3 1  ON 70
ci_0072                 3.481642e-03 3 1  ON 71
ci_0073                 3.552448e-03 3 1  ON 72
ci_0074                 3.529335e-03 3 1  ON 73
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 4.0365e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s054 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s054 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=54  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6904e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 54
    time step          = 0.05
    reference energy   = -16.8402
    reference variance = 0.237934
====================================================
  Execution time = 1.4396e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s054
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5246e+04
  VMC Eavg = -1.6899e+01
  VMC Evar = 2.9242e-01
  Total weights = 1.950700699e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 2.5349e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.282338002808
                                         uncertainty =       0.002068389681

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.282338002808
                                         uncertainty =       0.002068389681

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000375707632
  error estimate for blocks of size 2^( 2) =       0.000393118853
  error estimate for blocks of size 2^( 3) =       0.000410983299
  error estimate for blocks of size 2^( 4) =       0.000426651552
  error estimate for blocks of size 2^( 5) =       0.000439899498
  error estimate for blocks of size 2^( 6) =       0.000450371859
  error estimate for blocks of size 2^( 7) =       0.000454944261

      target function =      -0.924581491087
              le_mean =     -16.898653692171
             les_mean =     285.856915691789
             stat err =       0.000442966793
             autocorr =       1.390088034681
   target nu stat err =       0.000442966793
   target dn stat err =       0.002391948267
      target stat err =       0.003824292362
              std dev =       0.531330829072
             le_variance =       0.282312449922


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.689865369217e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 74
Check correct_vf_var_size: 225, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 9.0949e+02, overlap shift 9.0949e+03 and omega -1.7444e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.924595809285       residual = 5.14e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.924595835570       residual = 7.68e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.924595839468       residual = 3.14e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.924595842068       residual = 1.62e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.924595842884       residual = 4.00e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.924595842816       residual = 1.21e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.924595842971       residual = 2.79e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.924595842892       residual = 1.47e-06           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.924595842934       residual = 1.35e-06           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.924595842943       residual = 7.86e-07           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.924595842962       residual = 6.49e-07           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.924595842939       residual = 5.85e-07           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.924595843012       residual = 3.94e-07           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.924595843034       residual = 1.19e-07           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.924595843020       residual = 3.66e-08           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.924595843029       residual = 1.70e-08           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.924595843038       residual = 3.56e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         16 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 9.0949e+02 is 1.740284e-07

solving harmonic davidson linear method for identity shift 3.6380e+03, overlap shift 3.6380e+04 and omega -1.7444e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.924595809285       residual = 5.14e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.924595815857       residual = 7.68e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.924595816831       residual = 3.14e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.924595817481       residual = 1.62e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.924595817680       residual = 4.00e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.924595817662       residual = 1.21e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.924595817703       residual = 2.79e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.924595817688       residual = 1.47e-06           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.924595817694       residual = 1.35e-06           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.924595817695       residual = 7.86e-07           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.924595817705       residual = 6.49e-07           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.924595817687       residual = 5.85e-07           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.924595817713       residual = 3.94e-07           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.924595817719       residual = 1.19e-07           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.924595817720       residual = 3.66e-08           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.924595817715       residual = 1.70e-08           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.924595817714       residual = 3.56e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         16 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 3.6380e+03 is 4.350871e-08

solving harmonic davidson linear method for identity shift 1.4552e+04, overlap shift 1.4552e+05 and omega -1.7444e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.924595809285       residual = 5.14e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.924595810928       residual = 7.68e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.924595811171       residual = 3.14e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.924595811334       residual = 1.62e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.924595811356       residual = 4.00e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.924595811381       residual = 1.21e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.924595811393       residual = 2.79e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.924595811419       residual = 1.47e-06           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.924595811388       residual = 1.35e-06           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.924595811388       residual = 7.86e-07           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.924595811390       residual = 6.49e-07           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.924595811387       residual = 5.85e-07           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.924595811410       residual = 3.94e-07           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.924595811343       residual = 1.19e-07           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.924595811393       residual = 3.66e-08           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.924595811421       residual = 1.70e-08           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.924595811353       residual = 3.56e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         16 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 1.4552e+04 is 1.087728e-08

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.684788 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 75 and numParams is: 74

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.6945e+01
  </log>
  <optVariables href="H2O.s054.opt.xml">
ci_0001                 7.086070e-01 3 1  ON 0
ci_0002                 6.927476e-01 3 1  ON 1
ci_0003                -3.099734e-02 3 1  ON 2
ci_0004                -3.009221e-02 3 1  ON 3
ci_0005                -3.060355e-02 3 1  ON 4
ci_0006                -3.069538e-02 3 1  ON 5
ci_0007                -1.338111e-02 3 1  ON 6
ci_0008                -1.335091e-02 3 1  ON 7
ci_0009                -1.869656e-02 3 1  ON 8
ci_0010                -1.813041e-02 3 1  ON 9
ci_0011                -1.474503e-02 3 1  ON 10
ci_0012                -1.451129e-02 3 1  ON 11
ci_0013                 1.529488e-02 3 1  ON 12
ci_0014                 1.480544e-02 3 1  ON 13
ci_0015                 1.574758e-02 3 1  ON 14
ci_0016                 1.538662e-02 3 1  ON 15
ci_0017                 1.336764e-02 3 1  ON 16
ci_0018                 1.303920e-02 3 1  ON 17
ci_0019                 1.308969e-02 3 1  ON 18
ci_0020                 1.266818e-02 3 1  ON 19
ci_0021                 6.753497e-03 3 1  ON 20
ci_0022                 7.461820e-03 3 1  ON 21
ci_0023                -1.180421e-02 3 1  ON 22
ci_0024                -1.147005e-02 3 1  ON 23
ci_0025                -2.029334e-03 3 1  ON 24
ci_0026                -2.390638e-03 3 1  ON 25
ci_0027                -1.213157e-02 3 1  ON 26
ci_0028                -1.154873e-02 3 1  ON 27
ci_0029                -1.065809e-02 3 1  ON 28
ci_0030                -1.058715e-02 3 1  ON 29
ci_0031                 1.340936e-02 3 1  ON 30
ci_0032                 1.211399e-02 3 1  ON 31
ci_0033                 7.848083e-03 3 1  ON 32
ci_0034                 8.490864e-03 3 1  ON 33
ci_0035                 4.858780e-03 3 1  ON 34
ci_0036                 4.934091e-03 3 1  ON 35
ci_0037                -1.133417e-02 3 1  ON 36
ci_0038                -1.131394e-02 3 1  ON 37
ci_0039                -4.015099e-03 3 1  ON 38
ci_0040                -3.886148e-03 3 1  ON 39
ci_0041                 9.104095e-03 3 1  ON 40
ci_0042                 8.780732e-03 3 1  ON 41
ci_0043                -1.307252e-02 3 1  ON 42
ci_0044                -1.384503e-02 3 1  ON 43
ci_0045                 1.059156e-02 3 1  ON 44
ci_0046                 1.007907e-02 3 1  ON 45
ci_0047                -3.585408e-03 3 1  ON 46
ci_0048                -3.481815e-03 3 1  ON 47
ci_0049                -2.594358e-03 3 1  ON 48
ci_0050                -2.696309e-03 3 1  ON 49
ci_0051                -1.797517e-03 3 1  ON 50
ci_0052                -2.016473e-03 3 1  ON 51
ci_0053                -3.932015e-03 3 1  ON 52
ci_0054                -3.323819e-03 3 1  ON 53
ci_0055                 2.399216e-03 3 1  ON 54
ci_0056                 2.269204e-03 3 1  ON 55
ci_0057                 2.454147e-03 3 1  ON 56
ci_0058                 2.857698e-03 3 1  ON 57
ci_0059                -3.395922e-03 3 1  ON 58
ci_0060                -3.376202e-03 3 1  ON 59
ci_0061                -3.976533e-03 3 1  ON 60
ci_0062                -3.922562e-03 3 1  ON 61
ci_0063                -9.802822e-03 3 1  ON 62
ci_0064                -9.372857e-03 3 1  ON 63
ci_0065                -6.435381e-03 3 1  ON 64
ci_0066                -6.132314e-03 3 1  ON 65
ci_0067                -3.748273e-03 3 1  ON 66
ci_0068                -3.479655e-03 3 1  ON 67
ci_0069                 3.569560e-03 3 1  ON 68
ci_0070                 3.348534e-03 3 1  ON 69
ci_0071                 3.005244e-03 3 1  ON 70
ci_0072                 3.481639e-03 3 1  ON 71
ci_0073                 3.552458e-03 3 1  ON 72
ci_0074                 3.529359e-03 3 1  ON 73
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 54
    time step          = 0.05
    reference energy   = -16.9762
    reference variance = 0.255874
====================================================
  Execution time = 1.3872e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s054
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6899e+01
  VMC Evar = 2.8979e-01
  Total weights = 1.9510e+06
  Execution time = 1.8965e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.281059075398
                                         uncertainty =       0.002036000167

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.281059075398
                                         uncertainty =       0.002036000167

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000374894236
  error estimate for blocks of size 2^( 2) =       0.000392079697
  error estimate for blocks of size 2^( 3) =       0.000409557328
  error estimate for blocks of size 2^( 4) =       0.000424868502
  error estimate for blocks of size 2^( 5) =       0.000436682263
  error estimate for blocks of size 2^( 6) =       0.000442752362
  error estimate for blocks of size 2^( 7) =       0.000447015586

      target function =      -0.928728287919
              le_mean =     -16.898760159498
             les_mean =     285.857882354433
             stat err =       0.000437829678
             autocorr =       1.363932469337
   target nu stat err =       0.000437829678
   target dn stat err =       0.002330650851
      target stat err =       0.003761960038
              std dev =       0.530180512601
             le_variance =       0.281091375942

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.281059051221
                                         uncertainty =       0.002036015042

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.281059051221
                                         uncertainty =       0.002036015042

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000374894219
  error estimate for blocks of size 2^( 2) =       0.000392079680
  error estimate for blocks of size 2^( 3) =       0.000409557308
  error estimate for blocks of size 2^( 4) =       0.000424868479
  error estimate for blocks of size 2^( 5) =       0.000436682233
  error estimate for blocks of size 2^( 6) =       0.000442752325
  error estimate for blocks of size 2^( 7) =       0.000447015555

      target function =      -0.928728538633
              le_mean =     -16.898760159039
             les_mean =     285.857882180440
             stat err =       0.000437829648
             autocorr =       1.363932399834
   target nu stat err =       0.000437829648
   target dn stat err =       0.002330651717
      target stat err =       0.003761963358
              std dev =       0.530180489524
             le_variance =       0.281091351471

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.281059063308
                                         uncertainty =       0.002036007605

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.281059063308
                                         uncertainty =       0.002036007605

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000374894228
  error estimate for blocks of size 2^( 2) =       0.000392079688
  error estimate for blocks of size 2^( 3) =       0.000409557318
  error estimate for blocks of size 2^( 4) =       0.000424868491
  error estimate for blocks of size 2^( 5) =       0.000436682248
  error estimate for blocks of size 2^( 6) =       0.000442752344
  error estimate for blocks of size 2^( 7) =       0.000447015571

      target function =      -0.928728413385
              le_mean =     -16.898760159268
             les_mean =     285.857882267363
             stat err =       0.000437829663
             autocorr =       1.363932434589
   target nu stat err =       0.000437829663
   target dn stat err =       0.002330651281
      target stat err =       0.003761961694
              std dev =       0.530180501061
             le_variance =       0.281091363706

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.281059073886
                                         uncertainty =       0.002036001096

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.281059073886
                                         uncertainty =       0.002036001096

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000374894235
  error estimate for blocks of size 2^( 2) =       0.000392079696
  error estimate for blocks of size 2^( 3) =       0.000409557327
  error estimate for blocks of size 2^( 4) =       0.000424868501
  error estimate for blocks of size 2^( 5) =       0.000436682261
  error estimate for blocks of size 2^( 6) =       0.000442752360
  error estimate for blocks of size 2^( 7) =       0.000447015584

      target function =      -0.928728303614
              le_mean =     -16.898760159469
             les_mean =     285.857882343542
             stat err =       0.000437829676
             autocorr =       1.363932464993
   target nu stat err =       0.000437829676
   target dn stat err =       0.002330650904
      target stat err =       0.003761960245
              std dev =       0.530180511159
             le_variance =       0.281091374412


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.928728287919        initial
     9.0949e+02     9.0949e+03             1.7403e-07        -0.928728538633  <--
     3.6380e+03     3.6380e+04             4.3509e-08        -0.928728413385
     1.4552e+04     1.4552e+05             1.0877e-08        -0.928728303614

*****************************************************************************
Applying the update for shift_i =   9.0949e+02     and shift_s =   9.0949e+03
*****************************************************************************

  Execution time = 2.3357e+01
  </log>
  <optVariables href="H2O.s054.opt.xml">
ci_0001                 7.086071e-01 3 1  ON 0
ci_0002                 6.927476e-01 3 1  ON 1
ci_0003                -3.099732e-02 3 1  ON 2
ci_0004                -3.009222e-02 3 1  ON 3
ci_0005                -3.060360e-02 3 1  ON 4
ci_0006                -3.069541e-02 3 1  ON 5
ci_0007                -1.338120e-02 3 1  ON 6
ci_0008                -1.335089e-02 3 1  ON 7
ci_0009                -1.869656e-02 3 1  ON 8
ci_0010                -1.813042e-02 3 1  ON 9
ci_0011                -1.474502e-02 3 1  ON 10
ci_0012                -1.451123e-02 3 1  ON 11
ci_0013                 1.529487e-02 3 1  ON 12
ci_0014                 1.480542e-02 3 1  ON 13
ci_0015                 1.574758e-02 3 1  ON 14
ci_0016                 1.538662e-02 3 1  ON 15
ci_0017                 1.336761e-02 3 1  ON 16
ci_0018                 1.303916e-02 3 1  ON 17
ci_0019                 1.308970e-02 3 1  ON 18
ci_0020                 1.266821e-02 3 1  ON 19
ci_0021                 6.753387e-03 3 1  ON 20
ci_0022                 7.461742e-03 3 1  ON 21
ci_0023                -1.180422e-02 3 1  ON 22
ci_0024                -1.147004e-02 3 1  ON 23
ci_0025                -2.029321e-03 3 1  ON 24
ci_0026                -2.390578e-03 3 1  ON 25
ci_0027                -1.213157e-02 3 1  ON 26
ci_0028                -1.154873e-02 3 1  ON 27
ci_0029                -1.065815e-02 3 1  ON 28
ci_0030                -1.058721e-02 3 1  ON 29
ci_0031                 1.340939e-02 3 1  ON 30
ci_0032                 1.211394e-02 3 1  ON 31
ci_0033                 7.848115e-03 3 1  ON 32
ci_0034                 8.490817e-03 3 1  ON 33
ci_0035                 4.858732e-03 3 1  ON 34
ci_0036                 4.934114e-03 3 1  ON 35
ci_0037                -1.133417e-02 3 1  ON 36
ci_0038                -1.131389e-02 3 1  ON 37
ci_0039                -4.015107e-03 3 1  ON 38
ci_0040                -3.886165e-03 3 1  ON 39
ci_0041                 9.104097e-03 3 1  ON 40
ci_0042                 8.780745e-03 3 1  ON 41
ci_0043                -1.307265e-02 3 1  ON 42
ci_0044                -1.384515e-02 3 1  ON 43
ci_0045                 1.059158e-02 3 1  ON 44
ci_0046                 1.007904e-02 3 1  ON 45
ci_0047                -3.585369e-03 3 1  ON 46
ci_0048                -3.481773e-03 3 1  ON 47
ci_0049                -2.594331e-03 3 1  ON 48
ci_0050                -2.696300e-03 3 1  ON 49
ci_0051                -1.797488e-03 3 1  ON 50
ci_0052                -2.016468e-03 3 1  ON 51
ci_0053                -3.932033e-03 3 1  ON 52
ci_0054                -3.323845e-03 3 1  ON 53
ci_0055                 2.399259e-03 3 1  ON 54
ci_0056                 2.269165e-03 3 1  ON 55
ci_0057                 2.454140e-03 3 1  ON 56
ci_0058                 2.857699e-03 3 1  ON 57
ci_0059                -3.395952e-03 3 1  ON 58
ci_0060                -3.376185e-03 3 1  ON 59
ci_0061                -3.976546e-03 3 1  ON 60
ci_0062                -3.922576e-03 3 1  ON 61
ci_0063                -9.802771e-03 3 1  ON 62
ci_0064                -9.372854e-03 3 1  ON 63
ci_0065                -6.435380e-03 3 1  ON 64
ci_0066                -6.132265e-03 3 1  ON 65
ci_0067                -3.748282e-03 3 1  ON 66
ci_0068                -3.479656e-03 3 1  ON 67
ci_0069                 3.569562e-03 3 1  ON 68
ci_0070                 3.348543e-03 3 1  ON 69
ci_0071                 3.005353e-03 3 1  ON 70
ci_0072                 3.481631e-03 3 1  ON 71
ci_0073                 3.552488e-03 3 1  ON 72
ci_0074                 3.529431e-03 3 1  ON 73
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 4.0319e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s055 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s055 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=55  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6904e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 55
    time step          = 0.05
    reference energy   = -16.8977
    reference variance = 0.172086
====================================================
  Execution time = 1.6655e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s055
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5237e+04
  VMC Eavg = -1.6899e+01
  VMC Evar = 2.8991e-01
  Total weights = 1.950849679e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 2.5923e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.281471791566
                                         uncertainty =       0.001503903268

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.281471791566
                                         uncertainty =       0.001503903268

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000375114542
  error estimate for blocks of size 2^( 2) =       0.000392785502
  error estimate for blocks of size 2^( 3) =       0.000410939293
  error estimate for blocks of size 2^( 4) =       0.000426535928
  error estimate for blocks of size 2^( 5) =       0.000438674248
  error estimate for blocks of size 2^( 6) =       0.000446836301
  error estimate for blocks of size 2^( 7) =       0.000450363005

      target function =      -0.928533804826
              le_mean =     -16.898765050844
             les_mean =     285.858173547724
             stat err =       0.000440602370
             autocorr =       1.379640256805
   target nu stat err =       0.000440602370
   target dn stat err =       0.001970198080
      target stat err =       0.003204818215
              std dev =       0.530492072165
             le_variance =       0.281421838630


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.689876505084e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 74
Check correct_vf_var_size: 225, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.2737e+02, overlap shift 2.2737e+03 and omega -1.7444e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.928543284038       residual = 6.74e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.928543419063       residual = 1.08e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.928543442195       residual = 2.70e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.928543447705       residual = 1.06e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.928543451067       residual = 2.51e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.928543452883       residual = 1.37e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.928543453222       residual = 5.41e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.928543453434       residual = 1.55e-06           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.928543453354       residual = 7.54e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.928543453431       residual = 2.73e-07           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.928543453366       residual = 2.46e-07           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.928543453401       residual = 1.62e-07           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.928543453417       residual = 1.83e-07           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.928543453500       residual = 9.62e-08           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.928543453520       residual = 4.15e-08           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.928543453501       residual = 1.04e-08           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.928543453511       residual = 4.11e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         16 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 2.2737e+02 is 7.935908e-07

solving harmonic davidson linear method for identity shift 9.0949e+02, overlap shift 9.0949e+03 and omega -1.7444e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.928543284038       residual = 6.74e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.928543317803       residual = 1.08e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.928543323587       residual = 2.70e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.928543324964       residual = 1.06e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.928543325804       residual = 2.51e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.928543326258       residual = 1.37e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.928543326344       residual = 5.41e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.928543326397       residual = 1.55e-06           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.928543326378       residual = 7.53e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.928543326397       residual = 2.73e-07           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.928543326382       residual = 2.46e-07           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.928543326389       residual = 1.61e-07           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.928543326393       residual = 1.83e-07           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.928543326412       residual = 9.61e-08           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.928543326418       residual = 4.14e-08           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.928543326411       residual = 1.04e-08           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.928543326417       residual = 4.10e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         16 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 9.0949e+02 is 1.984493e-07

solving harmonic davidson linear method for identity shift 3.6380e+03, overlap shift 3.6380e+04 and omega -1.7444e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.928543284038       residual = 6.74e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.928543292479       residual = 1.08e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.928543293926       residual = 2.70e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.928543294269       residual = 1.06e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.928543294477       residual = 2.51e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.928543294592       residual = 1.37e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.928543294610       residual = 5.41e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.928543294626       residual = 1.55e-06           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.928543294626       residual = 7.53e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.928543294626       residual = 2.73e-07           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.928543294620       residual = 2.46e-07           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.928543294630       residual = 1.61e-07           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.928543294631       residual = 1.83e-07           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.928543294616       residual = 9.61e-08           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.928543294628       residual = 4.14e-08           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.928543294631       residual = 1.04e-08           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.928543294624       residual = 4.10e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         16 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 3.6380e+03 is 4.961555e-08

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.693854 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 75 and numParams is: 74

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.9261e+01
  </log>
  <optVariables href="H2O.s055.opt.xml">
ci_0001                 7.086070e-01 3 1  ON 0
ci_0002                 6.927476e-01 3 1  ON 1
ci_0003                -3.099736e-02 3 1  ON 2
ci_0004                -3.009228e-02 3 1  ON 3
ci_0005                -3.060377e-02 3 1  ON 4
ci_0006                -3.069545e-02 3 1  ON 5
ci_0007                -1.338136e-02 3 1  ON 6
ci_0008                -1.335090e-02 3 1  ON 7
ci_0009                -1.869658e-02 3 1  ON 8
ci_0010                -1.813048e-02 3 1  ON 9
ci_0011                -1.474505e-02 3 1  ON 10
ci_0012                -1.451115e-02 3 1  ON 11
ci_0013                 1.529483e-02 3 1  ON 12
ci_0014                 1.480540e-02 3 1  ON 13
ci_0015                 1.574753e-02 3 1  ON 14
ci_0016                 1.538668e-02 3 1  ON 15
ci_0017                 1.336761e-02 3 1  ON 16
ci_0018                 1.303917e-02 3 1  ON 17
ci_0019                 1.308973e-02 3 1  ON 18
ci_0020                 1.266818e-02 3 1  ON 19
ci_0021                 6.753364e-03 3 1  ON 20
ci_0022                 7.461654e-03 3 1  ON 21
ci_0023                -1.180430e-02 3 1  ON 22
ci_0024                -1.147013e-02 3 1  ON 23
ci_0025                -2.029453e-03 3 1  ON 24
ci_0026                -2.390568e-03 3 1  ON 25
ci_0027                -1.213156e-02 3 1  ON 26
ci_0028                -1.154866e-02 3 1  ON 27
ci_0029                -1.065819e-02 3 1  ON 28
ci_0030                -1.058715e-02 3 1  ON 29
ci_0031                 1.340937e-02 3 1  ON 30
ci_0032                 1.211394e-02 3 1  ON 31
ci_0033                 7.848142e-03 3 1  ON 32
ci_0034                 8.490835e-03 3 1  ON 33
ci_0035                 4.858930e-03 3 1  ON 34
ci_0036                 4.934208e-03 3 1  ON 35
ci_0037                -1.133423e-02 3 1  ON 36
ci_0038                -1.131386e-02 3 1  ON 37
ci_0039                -4.015111e-03 3 1  ON 38
ci_0040                -3.886140e-03 3 1  ON 39
ci_0041                 9.104133e-03 3 1  ON 40
ci_0042                 8.780772e-03 3 1  ON 41
ci_0043                -1.307262e-02 3 1  ON 42
ci_0044                -1.384523e-02 3 1  ON 43
ci_0045                 1.059165e-02 3 1  ON 44
ci_0046                 1.007910e-02 3 1  ON 45
ci_0047                -3.585367e-03 3 1  ON 46
ci_0048                -3.481770e-03 3 1  ON 47
ci_0049                -2.594326e-03 3 1  ON 48
ci_0050                -2.696265e-03 3 1  ON 49
ci_0051                -1.797481e-03 3 1  ON 50
ci_0052                -2.016417e-03 3 1  ON 51
ci_0053                -3.932037e-03 3 1  ON 52
ci_0054                -3.323856e-03 3 1  ON 53
ci_0055                 2.399195e-03 3 1  ON 54
ci_0056                 2.269219e-03 3 1  ON 55
ci_0057                 2.454174e-03 3 1  ON 56
ci_0058                 2.857657e-03 3 1  ON 57
ci_0059                -3.395935e-03 3 1  ON 58
ci_0060                -3.376175e-03 3 1  ON 59
ci_0061                -3.976562e-03 3 1  ON 60
ci_0062                -3.922496e-03 3 1  ON 61
ci_0063                -9.802759e-03 3 1  ON 62
ci_0064                -9.372880e-03 3 1  ON 63
ci_0065                -6.435319e-03 3 1  ON 64
ci_0066                -6.132260e-03 3 1  ON 65
ci_0067                -3.748298e-03 3 1  ON 66
ci_0068                -3.479706e-03 3 1  ON 67
ci_0069                 3.569495e-03 3 1  ON 68
ci_0070                 3.348514e-03 3 1  ON 69
ci_0071                 3.005397e-03 3 1  ON 70
ci_0072                 3.481556e-03 3 1  ON 71
ci_0073                 3.552491e-03 3 1  ON 72
ci_0074                 3.529494e-03 3 1  ON 73
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 55
    time step          = 0.05
    reference energy   = -16.8952
    reference variance = 0.181744
====================================================
  Execution time = 1.6328e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s055
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6899e+01
  VMC Evar = 2.9317e-01
  Total weights = 1.9511e+06
  Execution time = 1.8721e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.281113377125
                                         uncertainty =       0.001739085730

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.281113377125
                                         uncertainty =       0.001739085730

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000374912390
  error estimate for blocks of size 2^( 2) =       0.000391542867
  error estimate for blocks of size 2^( 3) =       0.000408591726
  error estimate for blocks of size 2^( 4) =       0.000423884201
  error estimate for blocks of size 2^( 5) =       0.000435569226
  error estimate for blocks of size 2^( 6) =       0.000443781733
  error estimate for blocks of size 2^( 7) =       0.000448910841

      target function =      -0.923409090966
              le_mean =     -16.898946529410
             les_mean =     285.867560333878
             stat err =       0.000438036500
             autocorr =       1.365089147938
   target nu stat err =       0.000438036500
   target dn stat err =       0.002788634713
      target stat err =       0.004425655017
              std dev =       0.530206186998
             le_variance =       0.281118600731

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.281113369858
                                         uncertainty =       0.001739104724

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.281113369858
                                         uncertainty =       0.001739104724

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000374912385
  error estimate for blocks of size 2^( 2) =       0.000391542841
  error estimate for blocks of size 2^( 3) =       0.000408591670
  error estimate for blocks of size 2^( 4) =       0.000423884132
  error estimate for blocks of size 2^( 5) =       0.000435569137
  error estimate for blocks of size 2^( 6) =       0.000443781647
  error estimate for blocks of size 2^( 7) =       0.000448910754

      target function =      -0.923408601638
              le_mean =     -16.898946542075
             les_mean =     285.867561074097
             stat err =       0.000438036418
             autocorr =       1.365088668000
   target nu stat err =       0.000438036418
   target dn stat err =       0.002788708734
      target stat err =       0.004425764647
              std dev =       0.530206180191
             le_variance =       0.281118593513

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.281113373479
                                         uncertainty =       0.001739095228

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.281113373479
                                         uncertainty =       0.001739095228

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000374912388
  error estimate for blocks of size 2^( 2) =       0.000391542854
  error estimate for blocks of size 2^( 3) =       0.000408591698
  error estimate for blocks of size 2^( 4) =       0.000423884167
  error estimate for blocks of size 2^( 5) =       0.000435569181
  error estimate for blocks of size 2^( 6) =       0.000443781690
  error estimate for blocks of size 2^( 7) =       0.000448910798

      target function =      -0.923408848293
              le_mean =     -16.898946535743
             les_mean =     285.867560702716
             stat err =       0.000438036459
             autocorr =       1.365088907940
   target nu stat err =       0.000438036459
   target dn stat err =       0.002788671612
      target stat err =       0.004425709678
              std dev =       0.530206183583
             le_variance =       0.281118597109

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.281113376667
                                         uncertainty =       0.001739086918

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.281113376667
                                         uncertainty =       0.001739086918

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000374912390
  error estimate for blocks of size 2^( 2) =       0.000391542865
  error estimate for blocks of size 2^( 3) =       0.000408591723
  error estimate for blocks of size 2^( 4) =       0.000423884197
  error estimate for blocks of size 2^( 5) =       0.000435569221
  error estimate for blocks of size 2^( 6) =       0.000443781727
  error estimate for blocks of size 2^( 7) =       0.000448910836

      target function =      -0.923409060854
              le_mean =     -16.898946530201
             les_mean =     285.867560379838
             stat err =       0.000438036495
             autocorr =       1.365089117931
   target nu stat err =       0.000438036495
   target dn stat err =       0.002788639313
      target stat err =       0.004425661832
              std dev =       0.530206186570
             le_variance =       0.281118600277


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.923409090966        initial  <--
     2.2737e+02     2.2737e+03             7.9359e-07        -0.923408601638
     9.0949e+02     9.0949e+03             1.9845e-07        -0.923408848293
     3.6380e+03     3.6380e+04             4.9616e-08        -0.923409060854

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 25.7453
  </log>
  <optVariables href="H2O.s055.opt.xml">
ci_0001                 7.086071e-01 3 1  ON 0
ci_0002                 6.927476e-01 3 1  ON 1
ci_0003                -3.099732e-02 3 1  ON 2
ci_0004                -3.009222e-02 3 1  ON 3
ci_0005                -3.060360e-02 3 1  ON 4
ci_0006                -3.069541e-02 3 1  ON 5
ci_0007                -1.338120e-02 3 1  ON 6
ci_0008                -1.335089e-02 3 1  ON 7
ci_0009                -1.869656e-02 3 1  ON 8
ci_0010                -1.813042e-02 3 1  ON 9
ci_0011                -1.474502e-02 3 1  ON 10
ci_0012                -1.451123e-02 3 1  ON 11
ci_0013                 1.529487e-02 3 1  ON 12
ci_0014                 1.480542e-02 3 1  ON 13
ci_0015                 1.574758e-02 3 1  ON 14
ci_0016                 1.538662e-02 3 1  ON 15
ci_0017                 1.336761e-02 3 1  ON 16
ci_0018                 1.303916e-02 3 1  ON 17
ci_0019                 1.308970e-02 3 1  ON 18
ci_0020                 1.266821e-02 3 1  ON 19
ci_0021                 6.753387e-03 3 1  ON 20
ci_0022                 7.461742e-03 3 1  ON 21
ci_0023                -1.180422e-02 3 1  ON 22
ci_0024                -1.147004e-02 3 1  ON 23
ci_0025                -2.029321e-03 3 1  ON 24
ci_0026                -2.390578e-03 3 1  ON 25
ci_0027                -1.213157e-02 3 1  ON 26
ci_0028                -1.154873e-02 3 1  ON 27
ci_0029                -1.065815e-02 3 1  ON 28
ci_0030                -1.058721e-02 3 1  ON 29
ci_0031                 1.340939e-02 3 1  ON 30
ci_0032                 1.211394e-02 3 1  ON 31
ci_0033                 7.848115e-03 3 1  ON 32
ci_0034                 8.490817e-03 3 1  ON 33
ci_0035                 4.858732e-03 3 1  ON 34
ci_0036                 4.934114e-03 3 1  ON 35
ci_0037                -1.133417e-02 3 1  ON 36
ci_0038                -1.131389e-02 3 1  ON 37
ci_0039                -4.015107e-03 3 1  ON 38
ci_0040                -3.886165e-03 3 1  ON 39
ci_0041                 9.104097e-03 3 1  ON 40
ci_0042                 8.780745e-03 3 1  ON 41
ci_0043                -1.307265e-02 3 1  ON 42
ci_0044                -1.384515e-02 3 1  ON 43
ci_0045                 1.059158e-02 3 1  ON 44
ci_0046                 1.007904e-02 3 1  ON 45
ci_0047                -3.585369e-03 3 1  ON 46
ci_0048                -3.481773e-03 3 1  ON 47
ci_0049                -2.594331e-03 3 1  ON 48
ci_0050                -2.696300e-03 3 1  ON 49
ci_0051                -1.797488e-03 3 1  ON 50
ci_0052                -2.016468e-03 3 1  ON 51
ci_0053                -3.932033e-03 3 1  ON 52
ci_0054                -3.323845e-03 3 1  ON 53
ci_0055                 2.399259e-03 3 1  ON 54
ci_0056                 2.269165e-03 3 1  ON 55
ci_0057                 2.454140e-03 3 1  ON 56
ci_0058                 2.857699e-03 3 1  ON 57
ci_0059                -3.395952e-03 3 1  ON 58
ci_0060                -3.376185e-03 3 1  ON 59
ci_0061                -3.976546e-03 3 1  ON 60
ci_0062                -3.922576e-03 3 1  ON 61
ci_0063                -9.802771e-03 3 1  ON 62
ci_0064                -9.372854e-03 3 1  ON 63
ci_0065                -6.435380e-03 3 1  ON 64
ci_0066                -6.132265e-03 3 1  ON 65
ci_0067                -3.748282e-03 3 1  ON 66
ci_0068                -3.479656e-03 3 1  ON 67
ci_0069                 3.569562e-03 3 1  ON 68
ci_0070                 3.348543e-03 3 1  ON 69
ci_0071                 3.005353e-03 3 1  ON 70
ci_0072                 3.481631e-03 3 1  ON 71
ci_0073                 3.552488e-03 3 1  ON 72
ci_0074                 3.529431e-03 3 1  ON 73
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 4.5013e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s056 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s056 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=56  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6904e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 56
    time step          = 0.05
    reference energy   = -16.86
    reference variance = 0.192603
====================================================
  Execution time = 1.4145e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s056
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5244e+04
  VMC Eavg = -1.6899e+01
  VMC Evar = 2.9442e-01
  Total weights = 1.951083620e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 2.5930e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.280159711303
                                         uncertainty =       0.001708799866

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.280159711303
                                         uncertainty =       0.001708799866

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000374309628
  error estimate for blocks of size 2^( 2) =       0.000391171586
  error estimate for blocks of size 2^( 3) =       0.000408326601
  error estimate for blocks of size 2^( 4) =       0.000423788895
  error estimate for blocks of size 2^( 5) =       0.000435968200
  error estimate for blocks of size 2^( 6) =       0.000442319029
  error estimate for blocks of size 2^( 7) =       0.000445353538

      target function =      -0.921406109554
              le_mean =     -16.898930333341
             les_mean =     285.868263690698
             stat err =       0.000436857416
             autocorr =       1.362126457579
   target nu stat err =       0.000436857416
   target dn stat err =       0.005183193738
      target stat err =       0.008108172840
              std dev =       0.529353752062
             le_variance =       0.280215394822


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.689893033334e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 74
Check correct_vf_var_size: 225, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.2737e+03, overlap shift 2.2737e+04 and omega -1.7444e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.921476003082       residual = 5.39e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.921476107487       residual = 1.64e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.921476111079       residual = 3.99e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.921476111839       residual = 2.10e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.921476112534       residual = 7.36e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.921476112631       residual = 3.75e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.921476112624       residual = 1.43e-05           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.921476112632       residual = 2.52e-06           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.921476112628       residual = 1.06e-06           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.921476112628       residual = 5.84e-07           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.921476112623       residual = 2.82e-07           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.921476112635       residual = 1.62e-07           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.921476112635       residual = 2.41e-07           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.921476112651       residual = 1.70e-07           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.921476112654       residual = 6.09e-08           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.921476112656       residual = 2.27e-08           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.921476112648       residual = 7.00e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         16 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 2.2737e+03 is 2.949081e-07

solving harmonic davidson linear method for identity shift 9.0949e+03, overlap shift 9.0949e+04 and omega -1.7444e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.921476003082       residual = 5.39e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.921476029184       residual = 1.64e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.921476030082       residual = 3.99e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.921476030274       residual = 2.10e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.921476030438       residual = 7.36e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.921476030469       residual = 3.75e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.921476030468       residual = 1.43e-05           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.921476030457       residual = 2.52e-06           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.921476030492       residual = 1.06e-06           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.921476030469       residual = 5.84e-07           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.921476030468       residual = 2.82e-07           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.921476030495       residual = 1.62e-07           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.921476030472       residual = 2.41e-07           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.921476030475       residual = 1.70e-07           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.921476030500       residual = 6.09e-08           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.921476030476       residual = 2.27e-08           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.921476030451       residual = 7.00e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         16 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 9.0949e+03 is 7.372899e-08

solving harmonic davidson linear method for identity shift 3.6380e+04, overlap shift 3.6380e+05 and omega -1.7444e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.921476003082       residual = 5.39e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.921476009607       residual = 1.64e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.921476009832       residual = 3.99e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.921476009838       residual = 2.10e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.921476009914       residual = 7.36e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.921476009892       residual = 3.75e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.921476009923       residual = 1.43e-05           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.921476009892       residual = 2.52e-06           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.921476009912       residual = 1.06e-06           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.921476009881       residual = 5.84e-07           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.921476009928       residual = 2.82e-07           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.921476009929       residual = 1.62e-07           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.921476009930       residual = 2.41e-07           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.921476009935       residual = 1.70e-07           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.921476010021       residual = 6.09e-08           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.921476009824       residual = 2.27e-08           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.921476009930       residual = 7.00e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         16 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 3.6380e+04 is 1.843237e-08

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.702949 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 75 and numParams is: 74

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.6753e+01
  </log>
  <optVariables href="H2O.s056.opt.xml">
ci_0001                 7.086071e-01 3 1  ON 0
ci_0002                 6.927475e-01 3 1  ON 1
ci_0003                -3.099732e-02 3 1  ON 2
ci_0004                -3.009222e-02 3 1  ON 3
ci_0005                -3.060361e-02 3 1  ON 4
ci_0006                -3.069542e-02 3 1  ON 5
ci_0007                -1.338121e-02 3 1  ON 6
ci_0008                -1.335088e-02 3 1  ON 7
ci_0009                -1.869654e-02 3 1  ON 8
ci_0010                -1.813042e-02 3 1  ON 9
ci_0011                -1.474502e-02 3 1  ON 10
ci_0012                -1.451124e-02 3 1  ON 11
ci_0013                 1.529487e-02 3 1  ON 12
ci_0014                 1.480541e-02 3 1  ON 13
ci_0015                 1.574758e-02 3 1  ON 14
ci_0016                 1.538662e-02 3 1  ON 15
ci_0017                 1.336761e-02 3 1  ON 16
ci_0018                 1.303916e-02 3 1  ON 17
ci_0019                 1.308970e-02 3 1  ON 18
ci_0020                 1.266821e-02 3 1  ON 19
ci_0021                 6.753378e-03 3 1  ON 20
ci_0022                 7.461725e-03 3 1  ON 21
ci_0023                -1.180422e-02 3 1  ON 22
ci_0024                -1.147003e-02 3 1  ON 23
ci_0025                -2.029316e-03 3 1  ON 24
ci_0026                -2.390586e-03 3 1  ON 25
ci_0027                -1.213157e-02 3 1  ON 26
ci_0028                -1.154872e-02 3 1  ON 27
ci_0029                -1.065816e-02 3 1  ON 28
ci_0030                -1.058720e-02 3 1  ON 29
ci_0031                 1.340941e-02 3 1  ON 30
ci_0032                 1.211394e-02 3 1  ON 31
ci_0033                 7.848116e-03 3 1  ON 32
ci_0034                 8.490814e-03 3 1  ON 33
ci_0035                 4.858724e-03 3 1  ON 34
ci_0036                 4.934041e-03 3 1  ON 35
ci_0037                -1.133416e-02 3 1  ON 36
ci_0038                -1.131388e-02 3 1  ON 37
ci_0039                -4.015103e-03 3 1  ON 38
ci_0040                -3.886165e-03 3 1  ON 39
ci_0041                 9.104102e-03 3 1  ON 40
ci_0042                 8.780747e-03 3 1  ON 41
ci_0043                -1.307266e-02 3 1  ON 42
ci_0044                -1.384516e-02 3 1  ON 43
ci_0045                 1.059158e-02 3 1  ON 44
ci_0046                 1.007904e-02 3 1  ON 45
ci_0047                -3.585370e-03 3 1  ON 46
ci_0048                -3.481779e-03 3 1  ON 47
ci_0049                -2.594330e-03 3 1  ON 48
ci_0050                -2.696269e-03 3 1  ON 49
ci_0051                -1.797486e-03 3 1  ON 50
ci_0052                -2.016469e-03 3 1  ON 51
ci_0053                -3.932033e-03 3 1  ON 52
ci_0054                -3.323850e-03 3 1  ON 53
ci_0055                 2.399243e-03 3 1  ON 54
ci_0056                 2.269160e-03 3 1  ON 55
ci_0057                 2.454134e-03 3 1  ON 56
ci_0058                 2.857693e-03 3 1  ON 57
ci_0059                -3.395951e-03 3 1  ON 58
ci_0060                -3.376176e-03 3 1  ON 59
ci_0061                -3.976545e-03 3 1  ON 60
ci_0062                -3.922563e-03 3 1  ON 61
ci_0063                -9.802773e-03 3 1  ON 62
ci_0064                -9.372849e-03 3 1  ON 63
ci_0065                -6.435376e-03 3 1  ON 64
ci_0066                -6.132266e-03 3 1  ON 65
ci_0067                -3.748281e-03 3 1  ON 66
ci_0068                -3.479661e-03 3 1  ON 67
ci_0069                 3.569567e-03 3 1  ON 68
ci_0070                 3.348534e-03 3 1  ON 69
ci_0071                 3.005360e-03 3 1  ON 70
ci_0072                 3.481644e-03 3 1  ON 71
ci_0073                 3.552488e-03 3 1  ON 72
ci_0074                 3.529427e-03 3 1  ON 73
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 56
    time step          = 0.05
    reference energy   = -16.8334
    reference variance = 0.373533
====================================================
  Execution time = 1.3963e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s056
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6899e+01
  VMC Evar = 2.9389e-01
  Total weights = 1.9512e+06
  Execution time = 1.8778e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.283537552163
                                         uncertainty =       0.002071698394

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.283537552163
                                         uncertainty =       0.002071698394

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000376556947
  error estimate for blocks of size 2^( 2) =       0.000393421290
  error estimate for blocks of size 2^( 3) =       0.000410853641
  error estimate for blocks of size 2^( 4) =       0.000426473275
  error estimate for blocks of size 2^( 5) =       0.000438414050
  error estimate for blocks of size 2^( 6) =       0.000444478101
  error estimate for blocks of size 2^( 7) =       0.000447550573

      target function =      -0.922271932602
              le_mean =     -16.899054651659
             les_mean =     285.871941637453
             stat err =       0.000439229000
             autocorr =       1.360569352985
   target nu stat err =       0.000439229000
   target dn stat err =       0.002926079321
      target stat err =       0.004627772755
              std dev =       0.532531941429
             le_variance =       0.283590268642

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.283537583802
                                         uncertainty =       0.002071724958

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.283537583802
                                         uncertainty =       0.002071724958

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000376556968
  error estimate for blocks of size 2^( 2) =       0.000393421315
  error estimate for blocks of size 2^( 3) =       0.000410853672
  error estimate for blocks of size 2^( 4) =       0.000426473309
  error estimate for blocks of size 2^( 5) =       0.000438414084
  error estimate for blocks of size 2^( 6) =       0.000444478130
  error estimate for blocks of size 2^( 7) =       0.000447550603

      target function =      -0.922272327822
              le_mean =     -16.899054651620
             les_mean =     285.871941382601
             stat err =       0.000439229031
             autocorr =       1.360569397768
   target nu stat err =       0.000439229031
   target dn stat err =       0.002926112730
      target stat err =       0.004627828156
              std dev =       0.532531971156
             le_variance =       0.283590300303

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.283537567982
                                         uncertainty =       0.002071711676

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.283537567982
                                         uncertainty =       0.002071711676

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000376556957
  error estimate for blocks of size 2^( 2) =       0.000393421303
  error estimate for blocks of size 2^( 3) =       0.000410853656
  error estimate for blocks of size 2^( 4) =       0.000426473292
  error estimate for blocks of size 2^( 5) =       0.000438414067
  error estimate for blocks of size 2^( 6) =       0.000444478116
  error estimate for blocks of size 2^( 7) =       0.000447550588

      target function =      -0.922272131036
              le_mean =     -16.899054651640
             les_mean =     285.871941509492
             stat err =       0.000439229016
             autocorr =       1.360569375388
   target nu stat err =       0.000439229016
   target dn stat err =       0.002926096019
      target stat err =       0.004627800454
              std dev =       0.532531956291
             le_variance =       0.283590284472

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.283537554141
                                         uncertainty =       0.002071700054

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.283537554141
                                         uncertainty =       0.002071700054

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000376556948
  error estimate for blocks of size 2^( 2) =       0.000393421292
  error estimate for blocks of size 2^( 3) =       0.000410853643
  error estimate for blocks of size 2^( 4) =       0.000426473277
  error estimate for blocks of size 2^( 5) =       0.000438414052
  error estimate for blocks of size 2^( 6) =       0.000444478103
  error estimate for blocks of size 2^( 7) =       0.000447550575

      target function =      -0.922271957496
              le_mean =     -16.899054651657
             les_mean =     285.871941621400
             stat err =       0.000439229002
             autocorr =       1.360569355789
   target nu stat err =       0.000439229002
   target dn stat err =       0.002926081408
      target stat err =       0.004627776217
              std dev =       0.532531943286
             le_variance =       0.283590270620


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.922271932602        initial
     2.2737e+03     2.2737e+04             2.9491e-07        -0.922272327822  <--
     9.0949e+03     9.0949e+04             7.3729e-08        -0.922272131036
     3.6380e+04     3.6380e+05             1.8432e-08        -0.922271957496

*****************************************************************************
Applying the update for shift_i =   2.2737e+03     and shift_s =   2.2737e+04
*****************************************************************************

  Execution time = 2.3443e+01
  </log>
  <optVariables href="H2O.s056.opt.xml">
ci_0001                 7.086071e-01 3 1  ON 0
ci_0002                 6.927475e-01 3 1  ON 1
ci_0003                -3.099732e-02 3 1  ON 2
ci_0004                -3.009222e-02 3 1  ON 3
ci_0005                -3.060365e-02 3 1  ON 4
ci_0006                -3.069545e-02 3 1  ON 5
ci_0007                -1.338124e-02 3 1  ON 6
ci_0008                -1.335085e-02 3 1  ON 7
ci_0009                -1.869651e-02 3 1  ON 8
ci_0010                -1.813042e-02 3 1  ON 9
ci_0011                -1.474503e-02 3 1  ON 10
ci_0012                -1.451125e-02 3 1  ON 11
ci_0013                 1.529485e-02 3 1  ON 12
ci_0014                 1.480540e-02 3 1  ON 13
ci_0015                 1.574759e-02 3 1  ON 14
ci_0016                 1.538659e-02 3 1  ON 15
ci_0017                 1.336762e-02 3 1  ON 16
ci_0018                 1.303915e-02 3 1  ON 17
ci_0019                 1.308970e-02 3 1  ON 18
ci_0020                 1.266822e-02 3 1  ON 19
ci_0021                 6.753351e-03 3 1  ON 20
ci_0022                 7.461674e-03 3 1  ON 21
ci_0023                -1.180422e-02 3 1  ON 22
ci_0024                -1.147002e-02 3 1  ON 23
ci_0025                -2.029301e-03 3 1  ON 24
ci_0026                -2.390610e-03 3 1  ON 25
ci_0027                -1.213156e-02 3 1  ON 26
ci_0028                -1.154870e-02 3 1  ON 27
ci_0029                -1.065816e-02 3 1  ON 28
ci_0030                -1.058719e-02 3 1  ON 29
ci_0031                 1.340944e-02 3 1  ON 30
ci_0032                 1.211391e-02 3 1  ON 31
ci_0033                 7.848120e-03 3 1  ON 32
ci_0034                 8.490804e-03 3 1  ON 33
ci_0035                 4.858700e-03 3 1  ON 34
ci_0036                 4.933819e-03 3 1  ON 35
ci_0037                -1.133415e-02 3 1  ON 36
ci_0038                -1.131387e-02 3 1  ON 37
ci_0039                -4.015090e-03 3 1  ON 38
ci_0040                -3.886167e-03 3 1  ON 39
ci_0041                 9.104117e-03 3 1  ON 40
ci_0042                 8.780754e-03 3 1  ON 41
ci_0043                -1.307267e-02 3 1  ON 42
ci_0044                -1.384518e-02 3 1  ON 43
ci_0045                 1.059159e-02 3 1  ON 44
ci_0046                 1.007903e-02 3 1  ON 45
ci_0047                -3.585375e-03 3 1  ON 46
ci_0048                -3.481794e-03 3 1  ON 47
ci_0049                -2.594326e-03 3 1  ON 48
ci_0050                -2.696175e-03 3 1  ON 49
ci_0051                -1.797477e-03 3 1  ON 50
ci_0052                -2.016473e-03 3 1  ON 51
ci_0053                -3.932033e-03 3 1  ON 52
ci_0054                -3.323866e-03 3 1  ON 53
ci_0055                 2.399195e-03 3 1  ON 54
ci_0056                 2.269146e-03 3 1  ON 55
ci_0057                 2.454117e-03 3 1  ON 56
ci_0058                 2.857674e-03 3 1  ON 57
ci_0059                -3.395945e-03 3 1  ON 58
ci_0060                -3.376147e-03 3 1  ON 59
ci_0061                -3.976543e-03 3 1  ON 60
ci_0062                -3.922524e-03 3 1  ON 61
ci_0063                -9.802779e-03 3 1  ON 62
ci_0064                -9.372834e-03 3 1  ON 63
ci_0065                -6.435363e-03 3 1  ON 64
ci_0066                -6.132268e-03 3 1  ON 65
ci_0067                -3.748279e-03 3 1  ON 66
ci_0068                -3.479678e-03 3 1  ON 67
ci_0069                 3.569584e-03 3 1  ON 68
ci_0070                 3.348509e-03 3 1  ON 69
ci_0071                 3.005383e-03 3 1  ON 70
ci_0072                 3.481683e-03 3 1  ON 71
ci_0073                 3.552487e-03 3 1  ON 72
ci_0074                 3.529416e-03 3 1  ON 73
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 4.0202e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s057 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s057 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=57  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6903e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 57
    time step          = 0.05
    reference energy   = -16.9048
    reference variance = 0.211375
====================================================
  Execution time = 1.4257e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s057
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5248e+04
  VMC Eavg = -1.6899e+01
  VMC Evar = 2.9108e-01
  Total weights = 1.950989339e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 2.5997e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.281575550203
                                         uncertainty =       0.001861263163

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.281575550203
                                         uncertainty =       0.001861263163

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000375243644
  error estimate for blocks of size 2^( 2) =       0.000392386402
  error estimate for blocks of size 2^( 3) =       0.000410383963
  error estimate for blocks of size 2^( 4) =       0.000425702122
  error estimate for blocks of size 2^( 5) =       0.000438008086
  error estimate for blocks of size 2^( 6) =       0.000445662542
  error estimate for blocks of size 2^( 7) =       0.000449721260

      target function =      -0.926678792221
              le_mean =     -16.898574004927
             les_mean =     285.852888165344
             stat err =       0.000439773502
             autocorr =       1.373508740214
   target nu stat err =       0.000439773502
   target dn stat err =       0.002203823024
      target stat err =       0.003549612481
              std dev =       0.530674650305
             le_variance =       0.281615584477


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.689857400493e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 74
Check correct_vf_var_size: 225, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 5.6843e+02, overlap shift 5.6843e+03 and omega -1.7444e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.926690919912       residual = 5.47e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.926690956594       residual = 8.35e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.926690961996       residual = 2.71e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.926690963932       residual = 8.64e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.926690965459       residual = 2.97e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.926690965872       residual = 1.11e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.926690965980       residual = 2.26e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.926690966060       residual = 8.49e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.926690966015       residual = 4.05e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.926690965978       residual = 1.96e-07           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.926690965995       residual = 1.63e-07           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.926690966022       residual = 1.31e-07           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.926690966046       residual = 1.44e-07           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.926690966015       residual = 6.34e-08           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.926690966023       residual = 2.66e-08           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.926690966024       residual = 8.38e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         15 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 5.6843e+02 is 2.359378e-07

solving harmonic davidson linear method for identity shift 2.2737e+03, overlap shift 2.2737e+04 and omega -1.7444e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.926690919912       residual = 5.47e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.926690929084       residual = 8.35e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.926690930434       residual = 2.71e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.926690930918       residual = 8.64e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.926690931301       residual = 2.97e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.926690931407       residual = 1.11e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.926690931431       residual = 2.26e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.926690931444       residual = 8.48e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.926690931438       residual = 4.05e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.926690931431       residual = 1.96e-07           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.926690931430       residual = 1.63e-07           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.926690931439       residual = 1.31e-07           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.926690931444       residual = 1.43e-07           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.926690931438       residual = 6.34e-08           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.926690931437       residual = 2.66e-08           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.926690931436       residual = 8.38e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         15 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 2.2737e+03 is 5.898803e-08

solving harmonic davidson linear method for identity shift 9.0949e+03, overlap shift 9.0949e+04 and omega -1.7444e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.926690919912       residual = 5.47e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.926690922205       residual = 8.35e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.926690922543       residual = 2.71e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.926690922664       residual = 8.64e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.926690922753       residual = 2.97e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.926690922789       residual = 1.11e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.926690922800       residual = 2.26e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.926690922799       residual = 8.48e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.926690922793       residual = 4.05e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.926690922788       residual = 1.96e-07           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.926690922783       residual = 1.63e-07           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.926690922800       residual = 1.31e-07           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.926690922791       residual = 1.43e-07           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.926690922775       residual = 6.34e-08           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.926690922774       residual = 2.66e-08           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.926690922790       residual = 8.38e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         15 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 9.0949e+03 is 1.474723e-08

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.710935 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 75 and numParams is: 74

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.6870e+01
  </log>
  <optVariables href="H2O.s057.opt.xml">
ci_0001                 7.086071e-01 3 1  ON 0
ci_0002                 6.927476e-01 3 1  ON 1
ci_0003                -3.099730e-02 3 1  ON 2
ci_0004                -3.009220e-02 3 1  ON 3
ci_0005                -3.060365e-02 3 1  ON 4
ci_0006                -3.069541e-02 3 1  ON 5
ci_0007                -1.338124e-02 3 1  ON 6
ci_0008                -1.335087e-02 3 1  ON 7
ci_0009                -1.869653e-02 3 1  ON 8
ci_0010                -1.813040e-02 3 1  ON 9
ci_0011                -1.474504e-02 3 1  ON 10
ci_0012                -1.451124e-02 3 1  ON 11
ci_0013                 1.529480e-02 3 1  ON 12
ci_0014                 1.480541e-02 3 1  ON 13
ci_0015                 1.574758e-02 3 1  ON 14
ci_0016                 1.538656e-02 3 1  ON 15
ci_0017                 1.336761e-02 3 1  ON 16
ci_0018                 1.303914e-02 3 1  ON 17
ci_0019                 1.308971e-02 3 1  ON 18
ci_0020                 1.266820e-02 3 1  ON 19
ci_0021                 6.753295e-03 3 1  ON 20
ci_0022                 7.461621e-03 3 1  ON 21
ci_0023                -1.180421e-02 3 1  ON 22
ci_0024                -1.147005e-02 3 1  ON 23
ci_0025                -2.029307e-03 3 1  ON 24
ci_0026                -2.390594e-03 3 1  ON 25
ci_0027                -1.213158e-02 3 1  ON 26
ci_0028                -1.154872e-02 3 1  ON 27
ci_0029                -1.065816e-02 3 1  ON 28
ci_0030                -1.058719e-02 3 1  ON 29
ci_0031                 1.340946e-02 3 1  ON 30
ci_0032                 1.211393e-02 3 1  ON 31
ci_0033                 7.848100e-03 3 1  ON 32
ci_0034                 8.490789e-03 3 1  ON 33
ci_0035                 4.858707e-03 3 1  ON 34
ci_0036                 4.933800e-03 3 1  ON 35
ci_0037                -1.133413e-02 3 1  ON 36
ci_0038                -1.131385e-02 3 1  ON 37
ci_0039                -4.015100e-03 3 1  ON 38
ci_0040                -3.886158e-03 3 1  ON 39
ci_0041                 9.104115e-03 3 1  ON 40
ci_0042                 8.780741e-03 3 1  ON 41
ci_0043                -1.307273e-02 3 1  ON 42
ci_0044                -1.384521e-02 3 1  ON 43
ci_0045                 1.059158e-02 3 1  ON 44
ci_0046                 1.007904e-02 3 1  ON 45
ci_0047                -3.585365e-03 3 1  ON 46
ci_0048                -3.481794e-03 3 1  ON 47
ci_0049                -2.594360e-03 3 1  ON 48
ci_0050                -2.696172e-03 3 1  ON 49
ci_0051                -1.797455e-03 3 1  ON 50
ci_0052                -2.016448e-03 3 1  ON 51
ci_0053                -3.932041e-03 3 1  ON 52
ci_0054                -3.323857e-03 3 1  ON 53
ci_0055                 2.399176e-03 3 1  ON 54
ci_0056                 2.269158e-03 3 1  ON 55
ci_0057                 2.454117e-03 3 1  ON 56
ci_0058                 2.857656e-03 3 1  ON 57
ci_0059                -3.395925e-03 3 1  ON 58
ci_0060                -3.376161e-03 3 1  ON 59
ci_0061                -3.976535e-03 3 1  ON 60
ci_0062                -3.922514e-03 3 1  ON 61
ci_0063                -9.802773e-03 3 1  ON 62
ci_0064                -9.372846e-03 3 1  ON 63
ci_0065                -6.435362e-03 3 1  ON 64
ci_0066                -6.132262e-03 3 1  ON 65
ci_0067                -3.748278e-03 3 1  ON 66
ci_0068                -3.479674e-03 3 1  ON 67
ci_0069                 3.569573e-03 3 1  ON 68
ci_0070                 3.348470e-03 3 1  ON 69
ci_0071                 3.005380e-03 3 1  ON 70
ci_0072                 3.481656e-03 3 1  ON 71
ci_0073                 3.552496e-03 3 1  ON 72
ci_0074                 3.529395e-03 3 1  ON 73
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 57
    time step          = 0.05
    reference energy   = -16.8943
    reference variance = 0.269685
====================================================
  Execution time = 1.3935e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s057
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6900e+01
  VMC Evar = 2.9223e-01
  Total weights = 1.9511e+06
  Execution time = 1.8866e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.283788024339
                                         uncertainty =       0.001413028929

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.283788024339
                                         uncertainty =       0.001413028929

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000376699229
  error estimate for blocks of size 2^( 2) =       0.000393696074
  error estimate for blocks of size 2^( 3) =       0.000410830761
  error estimate for blocks of size 2^( 4) =       0.000426117027
  error estimate for blocks of size 2^( 5) =       0.000436972519
  error estimate for blocks of size 2^( 6) =       0.000443471731
  error estimate for blocks of size 2^( 7) =       0.000445678487

      target function =      -0.924897524707
              le_mean =     -16.899631779891
             les_mean =     285.889783737134
             stat err =       0.000438059941
             autocorr =       1.352314228715
   target nu stat err =       0.000438059941
   target dn stat err =       0.001871169751
      target stat err =       0.003033401752
              std dev =       0.532733159026
             le_variance =       0.283804618726

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.283787991592
                                         uncertainty =       0.001413029880

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.283787991592
                                         uncertainty =       0.001413029880

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000376699207
  error estimate for blocks of size 2^( 2) =       0.000393696055
  error estimate for blocks of size 2^( 3) =       0.000410830743
  error estimate for blocks of size 2^( 4) =       0.000426117006
  error estimate for blocks of size 2^( 5) =       0.000436972495
  error estimate for blocks of size 2^( 6) =       0.000443471699
  error estimate for blocks of size 2^( 7) =       0.000445678452

      target function =      -0.924897527416
              le_mean =     -16.899631779705
             les_mean =     285.889783729134
             stat err =       0.000438059913
             autocorr =       1.352314211032
   target nu stat err =       0.000438059913
   target dn stat err =       0.001871171557
      target stat err =       0.003033404508
              std dev =       0.532733128043
             le_variance =       0.283804585715

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.283788007963
                                         uncertainty =       0.001413029404

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.283788007963
                                         uncertainty =       0.001413029404

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000376699218
  error estimate for blocks of size 2^( 2) =       0.000393696065
  error estimate for blocks of size 2^( 3) =       0.000410830752
  error estimate for blocks of size 2^( 4) =       0.000426117016
  error estimate for blocks of size 2^( 5) =       0.000436972507
  error estimate for blocks of size 2^( 6) =       0.000443471715
  error estimate for blocks of size 2^( 7) =       0.000445678470

      target function =      -0.924897526216
              le_mean =     -16.899631779798
             les_mean =     285.889783733031
             stat err =       0.000438059927
             autocorr =       1.352314219881
   target nu stat err =       0.000438059927
   target dn stat err =       0.001871170654
      target stat err =       0.003033403130
              std dev =       0.532733143532
             le_variance =       0.283804602218

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.283788022292
                                         uncertainty =       0.001413028988

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.283788022292
                                         uncertainty =       0.001413028988

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000376699228
  error estimate for blocks of size 2^( 2) =       0.000393696073
  error estimate for blocks of size 2^( 3) =       0.000410830760
  error estimate for blocks of size 2^( 4) =       0.000426117026
  error estimate for blocks of size 2^( 5) =       0.000436972518
  error estimate for blocks of size 2^( 6) =       0.000443471729
  error estimate for blocks of size 2^( 7) =       0.000445678485

      target function =      -0.924897524912
              le_mean =     -16.899631779879
             les_mean =     285.889783736609
             stat err =       0.000438059939
             autocorr =       1.352314227627
   target nu stat err =       0.000438059939
   target dn stat err =       0.001871169864
      target stat err =       0.003033401924
              std dev =       0.532733157089
             le_variance =       0.283804616662


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.924897524707        initial
     5.6843e+02     5.6843e+03             2.3594e-07        -0.924897527416  <--
     2.2737e+03     2.2737e+04             5.8988e-08        -0.924897526216
     9.0949e+03     9.0949e+04             1.4747e-08        -0.924897524912

*****************************************************************************
Applying the update for shift_i =   5.6843e+02     and shift_s =   5.6843e+03
*****************************************************************************

  Execution time = 2.3444e+01
  </log>
  <optVariables href="H2O.s057.opt.xml">
ci_0001                 7.086070e-01 3 1  ON 0
ci_0002                 6.927476e-01 3 1  ON 1
ci_0003                -3.099724e-02 3 1  ON 2
ci_0004                -3.009214e-02 3 1  ON 3
ci_0005                -3.060365e-02 3 1  ON 4
ci_0006                -3.069529e-02 3 1  ON 5
ci_0007                -1.338123e-02 3 1  ON 6
ci_0008                -1.335090e-02 3 1  ON 7
ci_0009                -1.869659e-02 3 1  ON 8
ci_0010                -1.813037e-02 3 1  ON 9
ci_0011                -1.474507e-02 3 1  ON 10
ci_0012                -1.451124e-02 3 1  ON 11
ci_0013                 1.529468e-02 3 1  ON 12
ci_0014                 1.480542e-02 3 1  ON 13
ci_0015                 1.574756e-02 3 1  ON 14
ci_0016                 1.538647e-02 3 1  ON 15
ci_0017                 1.336758e-02 3 1  ON 16
ci_0018                 1.303908e-02 3 1  ON 17
ci_0019                 1.308974e-02 3 1  ON 18
ci_0020                 1.266815e-02 3 1  ON 19
ci_0021                 6.753128e-03 3 1  ON 20
ci_0022                 7.461459e-03 3 1  ON 21
ci_0023                -1.180420e-02 3 1  ON 22
ci_0024                -1.147011e-02 3 1  ON 23
ci_0025                -2.029326e-03 3 1  ON 24
ci_0026                -2.390549e-03 3 1  ON 25
ci_0027                -1.213162e-02 3 1  ON 26
ci_0028                -1.154876e-02 3 1  ON 27
ci_0029                -1.065817e-02 3 1  ON 28
ci_0030                -1.058718e-02 3 1  ON 29
ci_0031                 1.340953e-02 3 1  ON 30
ci_0032                 1.211398e-02 3 1  ON 31
ci_0033                 7.848039e-03 3 1  ON 32
ci_0034                 8.490745e-03 3 1  ON 33
ci_0035                 4.858727e-03 3 1  ON 34
ci_0036                 4.933742e-03 3 1  ON 35
ci_0037                -1.133410e-02 3 1  ON 36
ci_0038                -1.131379e-02 3 1  ON 37
ci_0039                -4.015128e-03 3 1  ON 38
ci_0040                -3.886128e-03 3 1  ON 39
ci_0041                 9.104108e-03 3 1  ON 40
ci_0042                 8.780703e-03 3 1  ON 41
ci_0043                -1.307291e-02 3 1  ON 42
ci_0044                -1.384530e-02 3 1  ON 43
ci_0045                 1.059154e-02 3 1  ON 44
ci_0046                 1.007907e-02 3 1  ON 45
ci_0047                -3.585334e-03 3 1  ON 46
ci_0048                -3.481795e-03 3 1  ON 47
ci_0049                -2.594463e-03 3 1  ON 48
ci_0050                -2.696161e-03 3 1  ON 49
ci_0051                -1.797387e-03 3 1  ON 50
ci_0052                -2.016374e-03 3 1  ON 51
ci_0053                -3.932065e-03 3 1  ON 52
ci_0054                -3.323829e-03 3 1  ON 53
ci_0055                 2.399120e-03 3 1  ON 54
ci_0056                 2.269196e-03 3 1  ON 55
ci_0057                 2.454114e-03 3 1  ON 56
ci_0058                 2.857603e-03 3 1  ON 57
ci_0059                -3.395863e-03 3 1  ON 58
ci_0060                -3.376200e-03 3 1  ON 59
ci_0061                -3.976510e-03 3 1  ON 60
ci_0062                -3.922483e-03 3 1  ON 61
ci_0063                -9.802756e-03 3 1  ON 62
ci_0064                -9.372881e-03 3 1  ON 63
ci_0065                -6.435359e-03 3 1  ON 64
ci_0066                -6.132244e-03 3 1  ON 65
ci_0067                -3.748277e-03 3 1  ON 66
ci_0068                -3.479662e-03 3 1  ON 67
ci_0069                 3.569540e-03 3 1  ON 68
ci_0070                 3.348354e-03 3 1  ON 69
ci_0071                 3.005374e-03 3 1  ON 70
ci_0072                 3.481572e-03 3 1  ON 71
ci_0073                 3.552523e-03 3 1  ON 72
ci_0074                 3.529331e-03 3 1  ON 73
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 4.0319e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s058 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s058 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=58  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6903e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 58
    time step          = 0.05
    reference energy   = -16.9098
    reference variance = 0.202771
====================================================
  Execution time = 1.4354e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s058
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5259e+04
  VMC Eavg = -1.6899e+01
  VMC Evar = 2.9057e-01
  Total weights = 1.950953233e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 2.5323e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.280873288512
                                         uncertainty =       0.001608059141

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.280873288512
                                         uncertainty =       0.001608059141

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000374728327
  error estimate for blocks of size 2^( 2) =       0.000391425636
  error estimate for blocks of size 2^( 3) =       0.000409149746
  error estimate for blocks of size 2^( 4) =       0.000424805718
  error estimate for blocks of size 2^( 5) =       0.000437587235
  error estimate for blocks of size 2^( 6) =       0.000447094089
  error estimate for blocks of size 2^( 7) =       0.000450534951

      target function =      -0.927491309097
              le_mean =     -16.898997476067
             les_mean =     285.866689880938
             stat err =       0.000440005498
             autocorr =       1.378742483331
   target nu stat err =       0.000440005498
   target dn stat err =       0.002226850341
      target stat err =       0.003594092996
              std dev =       0.529945882794
             le_variance =       0.280842638690


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.689899747607e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 74
Check correct_vf_var_size: 225, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.4211e+02, overlap shift 1.4211e+03 and omega -1.7444e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.927503709491       residual = 4.97e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.927503849326       residual = 7.06e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.927503880118       residual = 2.88e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.927503892030       residual = 1.38e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.927503899813       residual = 3.89e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.927503901829       residual = 1.36e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.927503904422       residual = 7.29e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.927503904855       residual = 2.56e-06           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.927503905337       residual = 1.96e-06           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.927503906451       residual = 1.89e-06           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.927503907001       residual = 1.71e-06           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.927503907177       residual = 8.54e-07           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.927503906778       residual = 4.72e-07           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.927503906778       residual = 1.67e-07           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.927503906826       residual = 6.88e-08           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.927503906722       residual = 1.62e-08           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.927503906723       residual = 5.88e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         16 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 1.4211e+02 is 1.061126e-06

solving harmonic davidson linear method for identity shift 5.6843e+02, overlap shift 5.6843e+03 and omega -1.7444e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.927503709491       residual = 4.97e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.927503744464       residual = 7.06e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.927503752165       residual = 2.88e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.927503755143       residual = 1.38e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.927503757089       residual = 3.89e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.927503757594       residual = 1.36e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.927503758242       residual = 7.28e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.927503758351       residual = 2.55e-06           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.927503758471       residual = 1.96e-06           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.927503758748       residual = 1.89e-06           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.927503758886       residual = 1.71e-06           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.927503758931       residual = 8.53e-07           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.927503758830       residual = 4.72e-07           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.927503758830       residual = 1.66e-07           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.927503758843       residual = 6.86e-08           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.927503758815       residual = 1.62e-08           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.927503758816       residual = 5.86e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         16 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 5.6843e+02 is 2.653530e-07

solving harmonic davidson linear method for identity shift 2.2737e+03, overlap shift 2.2737e+04 and omega -1.7444e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.927503709491       residual = 4.97e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.927503718235       residual = 7.06e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.927503720161       residual = 2.88e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.927503720905       residual = 1.38e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.927503721392       residual = 3.89e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.927503721518       residual = 1.35e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.927503721681       residual = 7.28e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.927503721709       residual = 2.55e-06           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.927503721737       residual = 1.96e-06           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.927503721807       residual = 1.89e-06           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.927503721841       residual = 1.71e-06           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.927503721852       residual = 8.53e-07           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.927503721822       residual = 4.71e-07           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.927503721825       residual = 1.66e-07           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.927503721834       residual = 6.86e-08           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.927503721819       residual = 1.61e-08           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.927503721819       residual = 5.86e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         16 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 2.2737e+03 is 6.634271e-08

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.719954 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 75 and numParams is: 74

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.6900e+01
  </log>
  <optVariables href="H2O.s058.opt.xml">
ci_0001                 7.086069e-01 3 1  ON 0
ci_0002                 6.927478e-01 3 1  ON 1
ci_0003                -3.099718e-02 3 1  ON 2
ci_0004                -3.009201e-02 3 1  ON 3
ci_0005                -3.060369e-02 3 1  ON 4
ci_0006                -3.069544e-02 3 1  ON 5
ci_0007                -1.338119e-02 3 1  ON 6
ci_0008                -1.335092e-02 3 1  ON 7
ci_0009                -1.869656e-02 3 1  ON 8
ci_0010                -1.813035e-02 3 1  ON 9
ci_0011                -1.474506e-02 3 1  ON 10
ci_0012                -1.451127e-02 3 1  ON 11
ci_0013                 1.529456e-02 3 1  ON 12
ci_0014                 1.480535e-02 3 1  ON 13
ci_0015                 1.574758e-02 3 1  ON 14
ci_0016                 1.538644e-02 3 1  ON 15
ci_0017                 1.336755e-02 3 1  ON 16
ci_0018                 1.303908e-02 3 1  ON 17
ci_0019                 1.308968e-02 3 1  ON 18
ci_0020                 1.266821e-02 3 1  ON 19
ci_0021                 6.753055e-03 3 1  ON 20
ci_0022                 7.461235e-03 3 1  ON 21
ci_0023                -1.180415e-02 3 1  ON 22
ci_0024                -1.147014e-02 3 1  ON 23
ci_0025                -2.029383e-03 3 1  ON 24
ci_0026                -2.390609e-03 3 1  ON 25
ci_0027                -1.213161e-02 3 1  ON 26
ci_0028                -1.154884e-02 3 1  ON 27
ci_0029                -1.065821e-02 3 1  ON 28
ci_0030                -1.058722e-02 3 1  ON 29
ci_0031                 1.340941e-02 3 1  ON 30
ci_0032                 1.211413e-02 3 1  ON 31
ci_0033                 7.848076e-03 3 1  ON 32
ci_0034                 8.490480e-03 3 1  ON 33
ci_0035                 4.858910e-03 3 1  ON 34
ci_0036                 4.933724e-03 3 1  ON 35
ci_0037                -1.133398e-02 3 1  ON 36
ci_0038                -1.131371e-02 3 1  ON 37
ci_0039                -4.015097e-03 3 1  ON 38
ci_0040                -3.886133e-03 3 1  ON 39
ci_0041                 9.104138e-03 3 1  ON 40
ci_0042                 8.780766e-03 3 1  ON 41
ci_0043                -1.307310e-02 3 1  ON 42
ci_0044                -1.384542e-02 3 1  ON 43
ci_0045                 1.059145e-02 3 1  ON 44
ci_0046                 1.007897e-02 3 1  ON 45
ci_0047                -3.585269e-03 3 1  ON 46
ci_0048                -3.481752e-03 3 1  ON 47
ci_0049                -2.594487e-03 3 1  ON 48
ci_0050                -2.696099e-03 3 1  ON 49
ci_0051                -1.797436e-03 3 1  ON 50
ci_0052                -2.016315e-03 3 1  ON 51
ci_0053                -3.931912e-03 3 1  ON 52
ci_0054                -3.323850e-03 3 1  ON 53
ci_0055                 2.399047e-03 3 1  ON 54
ci_0056                 2.269354e-03 3 1  ON 55
ci_0057                 2.454080e-03 3 1  ON 56
ci_0058                 2.857527e-03 3 1  ON 57
ci_0059                -3.395849e-03 3 1  ON 58
ci_0060                -3.376127e-03 3 1  ON 59
ci_0061                -3.976505e-03 3 1  ON 60
ci_0062                -3.922458e-03 3 1  ON 61
ci_0063                -9.802716e-03 3 1  ON 62
ci_0064                -9.372818e-03 3 1  ON 63
ci_0065                -6.435391e-03 3 1  ON 64
ci_0066                -6.132224e-03 3 1  ON 65
ci_0067                -3.748210e-03 3 1  ON 66
ci_0068                -3.479627e-03 3 1  ON 67
ci_0069                 3.569462e-03 3 1  ON 68
ci_0070                 3.348408e-03 3 1  ON 69
ci_0071                 3.005351e-03 3 1  ON 70
ci_0072                 3.481616e-03 3 1  ON 71
ci_0073                 3.552537e-03 3 1  ON 72
ci_0074                 3.529219e-03 3 1  ON 73
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 58
    time step          = 0.05
    reference energy   = -16.8917
    reference variance = 0.225065
====================================================
  Execution time = 1.4119e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s058
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6898e+01
  VMC Evar = 2.9851e-01
  Total weights = 1.9510e+06
  Execution time = 1.8808e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.287028934864
                                         uncertainty =       0.003295800277

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.287028934864
                                         uncertainty =       0.003295800277

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000378808943
  error estimate for blocks of size 2^( 2) =       0.000395399739
  error estimate for blocks of size 2^( 3) =       0.000412577109
  error estimate for blocks of size 2^( 4) =       0.000427669898
  error estimate for blocks of size 2^( 5) =       0.000440192883
  error estimate for blocks of size 2^( 6) =       0.000446386596
  error estimate for blocks of size 2^( 7) =       0.000448353317

      target function =      -0.915097521095
              le_mean =     -16.898263739396
             les_mean =     285.849831765672
             stat err =       0.000440650674
             autocorr =       1.353157752325
   target nu stat err =       0.000440650674
   target dn stat err =       0.004057819304
      target stat err =       0.006270958734
              std dev =       0.535716744751
             le_variance =       0.286992430606

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.287028982636
                                         uncertainty =       0.003295858629

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.287028982636
                                         uncertainty =       0.003295858629

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000378808974
  error estimate for blocks of size 2^( 2) =       0.000395399787
  error estimate for blocks of size 2^( 3) =       0.000412577177
  error estimate for blocks of size 2^( 4) =       0.000427669961
  error estimate for blocks of size 2^( 5) =       0.000440192917
  error estimate for blocks of size 2^( 6) =       0.000446386596
  error estimate for blocks of size 2^( 7) =       0.000448353355

      target function =      -0.915107821753
              le_mean =     -16.898263739204
             les_mean =     285.849825047120
             stat err =       0.000440650708
             autocorr =       1.353157736406
   target nu stat err =       0.000440650708
   target dn stat err =       0.004057780060
      target stat err =       0.006271039129
              std dev =       0.535716789185
             le_variance =       0.286992478215

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.287028958724
                                         uncertainty =       0.003295829460

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.287028958724
                                         uncertainty =       0.003295829460

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000378808959
  error estimate for blocks of size 2^( 2) =       0.000395399763
  error estimate for blocks of size 2^( 3) =       0.000412577143
  error estimate for blocks of size 2^( 4) =       0.000427669930
  error estimate for blocks of size 2^( 5) =       0.000440192900
  error estimate for blocks of size 2^( 6) =       0.000446386596
  error estimate for blocks of size 2^( 7) =       0.000448353336

      target function =      -0.915103204032
              le_mean =     -16.898263739293
             les_mean =     285.849828059148
             stat err =       0.000440650691
             autocorr =       1.353157744406
   target nu stat err =       0.000440650691
   target dn stat err =       0.004057794303
      target stat err =       0.006270997983
              std dev =       0.535716766943
             le_variance =       0.286992454384

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.287028937843
                                         uncertainty =       0.003295803925

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.287028937843
                                         uncertainty =       0.003295803925

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000378808945
  error estimate for blocks of size 2^( 2) =       0.000395399742
  error estimate for blocks of size 2^( 3) =       0.000412577113
  error estimate for blocks of size 2^( 4) =       0.000427669902
  error estimate for blocks of size 2^( 5) =       0.000440192886
  error estimate for blocks of size 2^( 6) =       0.000446386596
  error estimate for blocks of size 2^( 7) =       0.000448353320

      target function =      -0.915098294757
              le_mean =     -16.898263739382
             les_mean =     285.849831261090
             stat err =       0.000440650676
             autocorr =       1.353157751338
   target nu stat err =       0.000440650676
   target dn stat err =       0.004057815490
      target stat err =       0.006270963452
              std dev =       0.535716747521
             le_variance =       0.286992433574


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.915097521095        initial
     1.4211e+02     1.4211e+03             1.0611e-06        -0.915107821753  <--
     5.6843e+02     5.6843e+03             2.6535e-07        -0.915103204032
     2.2737e+03     2.2737e+04             6.6343e-08        -0.915098294757

*****************************************************************************
Applying the update for shift_i =   1.4211e+02     and shift_s =   1.4211e+03
*****************************************************************************

  Execution time = 2.3583e+01
  </log>
  <optVariables href="H2O.s058.opt.xml">
ci_0001                 7.086064e-01 3 1  ON 0
ci_0002                 6.927483e-01 3 1  ON 1
ci_0003                -3.099700e-02 3 1  ON 2
ci_0004                -3.009163e-02 3 1  ON 3
ci_0005                -3.060381e-02 3 1  ON 4
ci_0006                -3.069589e-02 3 1  ON 5
ci_0007                -1.338106e-02 3 1  ON 6
ci_0008                -1.335098e-02 3 1  ON 7
ci_0009                -1.869649e-02 3 1  ON 8
ci_0010                -1.813029e-02 3 1  ON 9
ci_0011                -1.474502e-02 3 1  ON 10
ci_0012                -1.451137e-02 3 1  ON 11
ci_0013                 1.529423e-02 3 1  ON 12
ci_0014                 1.480516e-02 3 1  ON 13
ci_0015                 1.574766e-02 3 1  ON 14
ci_0016                 1.538635e-02 3 1  ON 15
ci_0017                 1.336745e-02 3 1  ON 16
ci_0018                 1.303907e-02 3 1  ON 17
ci_0019                 1.308951e-02 3 1  ON 18
ci_0020                 1.266839e-02 3 1  ON 19
ci_0021                 6.752834e-03 3 1  ON 20
ci_0022                 7.460564e-03 3 1  ON 21
ci_0023                -1.180401e-02 3 1  ON 22
ci_0024                -1.147024e-02 3 1  ON 23
ci_0025                -2.029552e-03 3 1  ON 24
ci_0026                -2.390792e-03 3 1  ON 25
ci_0027                -1.213158e-02 3 1  ON 26
ci_0028                -1.154911e-02 3 1  ON 27
ci_0029                -1.065831e-02 3 1  ON 28
ci_0030                -1.058733e-02 3 1  ON 29
ci_0031                 1.340906e-02 3 1  ON 30
ci_0032                 1.211456e-02 3 1  ON 31
ci_0033                 7.848187e-03 3 1  ON 32
ci_0034                 8.489684e-03 3 1  ON 33
ci_0035                 4.859456e-03 3 1  ON 34
ci_0036                 4.933672e-03 3 1  ON 35
ci_0037                -1.133361e-02 3 1  ON 36
ci_0038                -1.131346e-02 3 1  ON 37
ci_0039                -4.015004e-03 3 1  ON 38
ci_0040                -3.886149e-03 3 1  ON 39
ci_0041                 9.104229e-03 3 1  ON 40
ci_0042                 8.780956e-03 3 1  ON 41
ci_0043                -1.307368e-02 3 1  ON 42
ci_0044                -1.384577e-02 3 1  ON 43
ci_0045                 1.059116e-02 3 1  ON 44
ci_0046                 1.007867e-02 3 1  ON 45
ci_0047                -3.585075e-03 3 1  ON 46
ci_0048                -3.481624e-03 3 1  ON 47
ci_0049                -2.594559e-03 3 1  ON 48
ci_0050                -2.695914e-03 3 1  ON 49
ci_0051                -1.797581e-03 3 1  ON 50
ci_0052                -2.016135e-03 3 1  ON 51
ci_0053                -3.931451e-03 3 1  ON 52
ci_0054                -3.323911e-03 3 1  ON 53
ci_0055                 2.398828e-03 3 1  ON 54
ci_0056                 2.269830e-03 3 1  ON 55
ci_0057                 2.453976e-03 3 1  ON 56
ci_0058                 2.857301e-03 3 1  ON 57
ci_0059                -3.395807e-03 3 1  ON 58
ci_0060                -3.375907e-03 3 1  ON 59
ci_0061                -3.976492e-03 3 1  ON 60
ci_0062                -3.922381e-03 3 1  ON 61
ci_0063                -9.802596e-03 3 1  ON 62
ci_0064                -9.372629e-03 3 1  ON 63
ci_0065                -6.435487e-03 3 1  ON 64
ci_0066                -6.132163e-03 3 1  ON 65
ci_0067                -3.748011e-03 3 1  ON 66
ci_0068                -3.479525e-03 3 1  ON 67
ci_0069                 3.569227e-03 3 1  ON 68
ci_0070                 3.348567e-03 3 1  ON 69
ci_0071                 3.005283e-03 3 1  ON 70
ci_0072                 3.481746e-03 3 1  ON 71
ci_0073                 3.552582e-03 3 1  ON 72
ci_0074                 3.528881e-03 3 1  ON 73
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 4.0489e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s059 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s059 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=59  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6903e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 59
    time step          = 0.05
    reference energy   = -16.86
    reference variance = 0.26247
====================================================
  Execution time = 1.4052e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s059
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5242e+04
  VMC Eavg = -1.6899e+01
  VMC Evar = 3.0163e-01
  Total weights = 1.950851565e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 2.5873e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.282670924203
                                         uncertainty =       0.001924191252

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.282670924203
                                         uncertainty =       0.001924191252

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000375928626
  error estimate for blocks of size 2^( 2) =       0.000393036381
  error estimate for blocks of size 2^( 3) =       0.000410338039
  error estimate for blocks of size 2^( 4) =       0.000425805983
  error estimate for blocks of size 2^( 5) =       0.000437761476
  error estimate for blocks of size 2^( 6) =       0.000444685964
  error estimate for blocks of size 2^( 7) =       0.000450668264

      target function =      -0.910183843841
              le_mean =     -16.898894127869
             les_mean =     285.874256422746
             stat err =       0.000439730422
             autocorr =       1.368239836730
   target nu stat err =       0.000439730422
   target dn stat err =       0.008575032668
      target stat err =       0.013056384102
              std dev =       0.531643360687
             le_variance =       0.282644662963


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.689889412787e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 74
Check correct_vf_var_size: 225, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 3.5527e+01, overlap shift 3.5527e+02 and omega -1.7444e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.910369294249       residual = 3.60e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.910372854627       residual = 2.56e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.910373267779       residual = 1.16e-03           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.910373527908       residual = 5.81e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.910373756518       residual = 2.83e-04           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.910373846836       residual = 1.70e-04           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.910373888171       residual = 7.56e-05           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.910373918167       residual = 1.13e-04           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.910373951431       residual = 1.40e-04           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.910373968038       residual = 5.79e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.910373977080       residual = 2.59e-05           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.910373978716       residual = 7.36e-06           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.910373979509       residual = 2.54e-06           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.910373982096       residual = 5.11e-07           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.910373981912       residual = 1.93e-07           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.910373982385       residual = 5.07e-08           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.910373982414       residual = 1.78e-08           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.910373982334       residual = 6.16e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         17 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 3.5527e+01 is 1.926347e-05

solving harmonic davidson linear method for identity shift 1.4211e+02, overlap shift 1.4211e+03 and omega -1.7444e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.910369294249       residual = 3.60e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.910370185813       residual = 2.56e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.910370289251       residual = 1.16e-03           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.910370354343       residual = 5.80e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.910370411523       residual = 2.83e-04           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.910370434096       residual = 1.69e-04           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.910370444425       residual = 7.55e-05           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.910370451928       residual = 1.13e-04           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.910370460241       residual = 1.39e-04           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.910370464375       residual = 5.76e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.910370466624       residual = 2.57e-05           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.910370467029       residual = 7.31e-06           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.910370467227       residual = 2.52e-06           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.910370467872       residual = 5.06e-07           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.910370467826       residual = 1.91e-07           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.910370467944       residual = 5.03e-08           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.910370467951       residual = 1.76e-08           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.910370467931       residual = 6.10e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         17 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 1.4211e+02 is 4.816162e-06

solving harmonic davidson linear method for identity shift 5.6843e+02, overlap shift 5.6843e+03 and omega -1.7444e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.910369294249       residual = 3.60e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.910369517232       residual = 2.56e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.910369543101       residual = 1.16e-03           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.910369559378       residual = 5.80e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.910369573675       residual = 2.83e-04           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.910369579317       residual = 1.69e-04           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.910369581900       residual = 7.55e-05           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.910369583774       residual = 1.13e-04           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.910369585853       residual = 1.39e-04           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.910369586886       residual = 5.75e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.910369587448       residual = 2.57e-05           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.910369587549       residual = 7.30e-06           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.910369587598       residual = 2.51e-06           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.910369587759       residual = 5.05e-07           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.910369587746       residual = 1.91e-07           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.910369587777       residual = 5.01e-08           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.910369587778       residual = 1.76e-08           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.910369587774       residual = 6.08e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         17 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 5.6843e+02 is 1.204059e-06

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.730089 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 75 and numParams is: 74

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.6656e+01
  </log>
  <optVariables href="H2O.s059.opt.xml">
ci_0001                 7.086112e-01 3 1  ON 0
ci_0002                 6.927436e-01 3 1  ON 1
ci_0003                -3.099688e-02 3 1  ON 2
ci_0004                -3.009075e-02 3 1  ON 3
ci_0005                -3.060403e-02 3 1  ON 4
ci_0006                -3.069505e-02 3 1  ON 5
ci_0007                -1.338202e-02 3 1  ON 6
ci_0008                -1.334980e-02 3 1  ON 7
ci_0009                -1.869610e-02 3 1  ON 8
ci_0010                -1.813017e-02 3 1  ON 9
ci_0011                -1.474486e-02 3 1  ON 10
ci_0012                -1.451122e-02 3 1  ON 11
ci_0013                 1.529414e-02 3 1  ON 12
ci_0014                 1.480512e-02 3 1  ON 13
ci_0015                 1.574799e-02 3 1  ON 14
ci_0016                 1.538685e-02 3 1  ON 15
ci_0017                 1.336707e-02 3 1  ON 16
ci_0018                 1.303941e-02 3 1  ON 17
ci_0019                 1.309011e-02 3 1  ON 18
ci_0020                 1.266828e-02 3 1  ON 19
ci_0021                 6.752464e-03 3 1  ON 20
ci_0022                 7.457853e-03 3 1  ON 21
ci_0023                -1.180439e-02 3 1  ON 22
ci_0024                -1.147072e-02 3 1  ON 23
ci_0025                -2.030035e-03 3 1  ON 24
ci_0026                -2.390902e-03 3 1  ON 25
ci_0027                -1.213139e-02 3 1  ON 26
ci_0028                -1.154905e-02 3 1  ON 27
ci_0029                -1.065871e-02 3 1  ON 28
ci_0030                -1.058717e-02 3 1  ON 29
ci_0031                 1.340952e-02 3 1  ON 30
ci_0032                 1.211456e-02 3 1  ON 31
ci_0033                 7.848422e-03 3 1  ON 32
ci_0034                 8.489666e-03 3 1  ON 33
ci_0035                 4.859147e-03 3 1  ON 34
ci_0036                 4.933514e-03 3 1  ON 35
ci_0037                -1.133335e-02 3 1  ON 36
ci_0038                -1.131319e-02 3 1  ON 37
ci_0039                -4.015177e-03 3 1  ON 38
ci_0040                -3.886355e-03 3 1  ON 39
ci_0041                 9.104581e-03 3 1  ON 40
ci_0042                 8.780670e-03 3 1  ON 41
ci_0043                -1.307429e-02 3 1  ON 42
ci_0044                -1.384275e-02 3 1  ON 43
ci_0045                 1.059141e-02 3 1  ON 44
ci_0046                 1.007794e-02 3 1  ON 45
ci_0047                -3.585040e-03 3 1  ON 46
ci_0048                -3.482090e-03 3 1  ON 47
ci_0049                -2.595019e-03 3 1  ON 48
ci_0050                -2.696453e-03 3 1  ON 49
ci_0051                -1.797169e-03 3 1  ON 50
ci_0052                -2.016771e-03 3 1  ON 51
ci_0053                -3.931797e-03 3 1  ON 52
ci_0054                -3.324097e-03 3 1  ON 53
ci_0055                 2.398514e-03 3 1  ON 54
ci_0056                 2.269017e-03 3 1  ON 55
ci_0057                 2.454150e-03 3 1  ON 56
ci_0058                 2.858985e-03 3 1  ON 57
ci_0059                -3.395737e-03 3 1  ON 58
ci_0060                -3.373564e-03 3 1  ON 59
ci_0061                -3.977099e-03 3 1  ON 60
ci_0062                -3.922586e-03 3 1  ON 61
ci_0063                -9.802818e-03 3 1  ON 62
ci_0064                -9.372327e-03 3 1  ON 63
ci_0065                -6.435407e-03 3 1  ON 64
ci_0066                -6.132292e-03 3 1  ON 65
ci_0067                -3.747592e-03 3 1  ON 66
ci_0068                -3.479224e-03 3 1  ON 67
ci_0069                 3.569039e-03 3 1  ON 68
ci_0070                 3.348419e-03 3 1  ON 69
ci_0071                 3.005199e-03 3 1  ON 70
ci_0072                 3.481479e-03 3 1  ON 71
ci_0073                 3.552097e-03 3 1  ON 72
ci_0074                 3.530045e-03 3 1  ON 73
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 59
    time step          = 0.05
    reference energy   = -16.9659
    reference variance = 0.166029
====================================================
  Execution time = 1.3735e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s059
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6899e+01
  VMC Evar = 2.9308e-01
  Total weights = 1.9508e+06
  Execution time = 1.8765e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.283484022454
                                         uncertainty =       0.002166021869

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.283484022454
                                         uncertainty =       0.002166021869

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000376440873
  error estimate for blocks of size 2^( 2) =       0.000393333362
  error estimate for blocks of size 2^( 3) =       0.000410567508
  error estimate for blocks of size 2^( 4) =       0.000426700347
  error estimate for blocks of size 2^( 5) =       0.000439009035
  error estimate for blocks of size 2^( 6) =       0.000446921420
  error estimate for blocks of size 2^( 7) =       0.000453747194

      target function =      -0.923557191313
              le_mean =     -16.898946820561
             les_mean =     285.867476872389
             stat err =       0.000441594499
             autocorr =       1.376111952219
   target nu stat err =       0.000441594499
   target dn stat err =       0.002655857250
      target stat err =       0.004223392664
              std dev =       0.532367787426
             le_variance =       0.283415461089

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.283483442238
                                         uncertainty =       0.002165956929

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.283483442238
                                         uncertainty =       0.002165956929

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000376440488
  error estimate for blocks of size 2^( 2) =       0.000393333030
  error estimate for blocks of size 2^( 3) =       0.000410567191
  error estimate for blocks of size 2^( 4) =       0.000426700190
  error estimate for blocks of size 2^( 5) =       0.000439008848
  error estimate for blocks of size 2^( 6) =       0.000446921366
  error estimate for blocks of size 2^( 7) =       0.000453747349

      target function =      -0.922924931124
              le_mean =     -16.898946804363
             les_mean =     285.867880316149
             stat err =       0.000441594438
             autocorr =       1.376114381962
   target nu stat err =       0.000441594438
   target dn stat err =       0.002687449568
      target stat err =       0.004266307366
              std dev =       0.532367244101
             le_variance =       0.283414882592

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.283483730015
                                         uncertainty =       0.002165989348

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.283483730015
                                         uncertainty =       0.002165989348

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000376440679
  error estimate for blocks of size 2^( 2) =       0.000393333194
  error estimate for blocks of size 2^( 3) =       0.000410567347
  error estimate for blocks of size 2^( 4) =       0.000426700270
  error estimate for blocks of size 2^( 5) =       0.000439008940
  error estimate for blocks of size 2^( 6) =       0.000446921385
  error estimate for blocks of size 2^( 7) =       0.000453747270

      target function =      -0.923525903751
              le_mean =     -16.898946810308
             les_mean =     285.867496517967
             stat err =       0.000441594466
             autocorr =       1.376113162738
   target nu stat err =       0.000441594466
   target dn stat err =       0.002655924725
      target stat err =       0.004223214841
              std dev =       0.532367513578
             le_variance =       0.283415169514

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.283483985666
                                         uncertainty =       0.002166017801

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.283483985666
                                         uncertainty =       0.002166017801

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000376440848
  error estimate for blocks of size 2^( 2) =       0.000393333341
  error estimate for blocks of size 2^( 3) =       0.000410567488
  error estimate for blocks of size 2^( 4) =       0.000426700337
  error estimate for blocks of size 2^( 5) =       0.000439009023
  error estimate for blocks of size 2^( 6) =       0.000446921416
  error estimate for blocks of size 2^( 7) =       0.000453747204

      target function =      -0.923556431132
              le_mean =     -16.898946819254
             les_mean =     285.867477314022
             stat err =       0.000441594495
             autocorr =       1.376112103608
   target nu stat err =       0.000441594495
   target dn stat err =       0.002655849913
      target stat err =       0.004223374508
              std dev =       0.532367752976
             le_variance =       0.283415424409


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.923557191313        initial  <--
     3.5527e+01     3.5527e+02             1.9263e-05        -0.922924931124
     1.4211e+02     1.4211e+03             4.8162e-06        -0.923525903751
     5.6843e+02     5.6843e+03             1.2041e-06        -0.923556431132

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 23.1879
  </log>
  <optVariables href="H2O.s059.opt.xml">
ci_0001                 7.086064e-01 3 1  ON 0
ci_0002                 6.927483e-01 3 1  ON 1
ci_0003                -3.099700e-02 3 1  ON 2
ci_0004                -3.009163e-02 3 1  ON 3
ci_0005                -3.060381e-02 3 1  ON 4
ci_0006                -3.069589e-02 3 1  ON 5
ci_0007                -1.338106e-02 3 1  ON 6
ci_0008                -1.335098e-02 3 1  ON 7
ci_0009                -1.869649e-02 3 1  ON 8
ci_0010                -1.813029e-02 3 1  ON 9
ci_0011                -1.474502e-02 3 1  ON 10
ci_0012                -1.451137e-02 3 1  ON 11
ci_0013                 1.529423e-02 3 1  ON 12
ci_0014                 1.480516e-02 3 1  ON 13
ci_0015                 1.574766e-02 3 1  ON 14
ci_0016                 1.538635e-02 3 1  ON 15
ci_0017                 1.336745e-02 3 1  ON 16
ci_0018                 1.303907e-02 3 1  ON 17
ci_0019                 1.308951e-02 3 1  ON 18
ci_0020                 1.266839e-02 3 1  ON 19
ci_0021                 6.752834e-03 3 1  ON 20
ci_0022                 7.460564e-03 3 1  ON 21
ci_0023                -1.180401e-02 3 1  ON 22
ci_0024                -1.147024e-02 3 1  ON 23
ci_0025                -2.029552e-03 3 1  ON 24
ci_0026                -2.390792e-03 3 1  ON 25
ci_0027                -1.213158e-02 3 1  ON 26
ci_0028                -1.154911e-02 3 1  ON 27
ci_0029                -1.065831e-02 3 1  ON 28
ci_0030                -1.058733e-02 3 1  ON 29
ci_0031                 1.340906e-02 3 1  ON 30
ci_0032                 1.211456e-02 3 1  ON 31
ci_0033                 7.848187e-03 3 1  ON 32
ci_0034                 8.489684e-03 3 1  ON 33
ci_0035                 4.859456e-03 3 1  ON 34
ci_0036                 4.933672e-03 3 1  ON 35
ci_0037                -1.133361e-02 3 1  ON 36
ci_0038                -1.131346e-02 3 1  ON 37
ci_0039                -4.015004e-03 3 1  ON 38
ci_0040                -3.886149e-03 3 1  ON 39
ci_0041                 9.104229e-03 3 1  ON 40
ci_0042                 8.780956e-03 3 1  ON 41
ci_0043                -1.307368e-02 3 1  ON 42
ci_0044                -1.384577e-02 3 1  ON 43
ci_0045                 1.059116e-02 3 1  ON 44
ci_0046                 1.007867e-02 3 1  ON 45
ci_0047                -3.585075e-03 3 1  ON 46
ci_0048                -3.481624e-03 3 1  ON 47
ci_0049                -2.594559e-03 3 1  ON 48
ci_0050                -2.695914e-03 3 1  ON 49
ci_0051                -1.797581e-03 3 1  ON 50
ci_0052                -2.016135e-03 3 1  ON 51
ci_0053                -3.931451e-03 3 1  ON 52
ci_0054                -3.323911e-03 3 1  ON 53
ci_0055                 2.398828e-03 3 1  ON 54
ci_0056                 2.269830e-03 3 1  ON 55
ci_0057                 2.453976e-03 3 1  ON 56
ci_0058                 2.857301e-03 3 1  ON 57
ci_0059                -3.395807e-03 3 1  ON 58
ci_0060                -3.375907e-03 3 1  ON 59
ci_0061                -3.976492e-03 3 1  ON 60
ci_0062                -3.922381e-03 3 1  ON 61
ci_0063                -9.802596e-03 3 1  ON 62
ci_0064                -9.372629e-03 3 1  ON 63
ci_0065                -6.435487e-03 3 1  ON 64
ci_0066                -6.132163e-03 3 1  ON 65
ci_0067                -3.748011e-03 3 1  ON 66
ci_0068                -3.479525e-03 3 1  ON 67
ci_0069                 3.569227e-03 3 1  ON 68
ci_0070                 3.348567e-03 3 1  ON 69
ci_0071                 3.005283e-03 3 1  ON 70
ci_0072                 3.481746e-03 3 1  ON 71
ci_0073                 3.552582e-03 3 1  ON 72
ci_0074                 3.528881e-03 3 1  ON 73
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 3.9850e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s060 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s060 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=60  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6903e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 60
    time step          = 0.05
    reference energy   = -16.9323
    reference variance = 0.332488
====================================================
  Execution time = 1.4103e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s060
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5252e+04
  VMC Eavg = -1.6899e+01
  VMC Evar = 2.9464e-01
  Total weights = 1.950761753e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 2.5770e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.285285825287
                                         uncertainty =       0.003580391526

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.285285825287
                                         uncertainty =       0.003580391526

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000377662157
  error estimate for blocks of size 2^( 2) =       0.000394410082
  error estimate for blocks of size 2^( 3) =       0.000411629117
  error estimate for blocks of size 2^( 4) =       0.000426627278
  error estimate for blocks of size 2^( 5) =       0.000437135080
  error estimate for blocks of size 2^( 6) =       0.000445023388
  error estimate for blocks of size 2^( 7) =       0.000447006160

      target function =      -0.921086838254
              le_mean =     -16.899225602442
             les_mean =     285.878469222745
             stat err =       0.000438947977
             autocorr =       1.350887439580
   target nu stat err =       0.000438947977
   target dn stat err =       0.003909479430
      target stat err =       0.006134198038
              std dev =       0.534094945068
             le_variance =       0.285257410347


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.689922560244e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 74
Check correct_vf_var_size: 225, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 3.5527e+02, overlap shift 3.5527e+03 and omega -1.7444e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.921125977170       residual = 2.23e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.921126214567       residual = 2.51e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.921126237189       residual = 5.82e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.921126243745       residual = 2.81e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.921126249908       residual = 2.46e-04           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.921126252509       residual = 2.13e-04           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.921126258186       residual = 1.76e-04           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.921126261275       residual = 1.31e-04           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.921126264034       residual = 9.07e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.921126264449       residual = 2.07e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.921126264327       residual = 1.05e-05           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.921126263880       residual = 2.07e-06           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.921126263876       residual = 8.94e-07           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.921126263814       residual = 2.24e-07           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.921126263820       residual = 8.00e-08           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.921126263790       residual = 2.66e-08           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.921126263762       residual = 4.01e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         16 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 3.5527e+02 is 2.091825e-06

solving harmonic davidson linear method for identity shift 1.4211e+03, overlap shift 1.4211e+04 and omega -1.7444e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.921125977170       residual = 2.23e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.921126036529       residual = 2.51e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.921126042185       residual = 5.82e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.921126043824       residual = 2.81e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.921126045365       residual = 2.46e-04           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.921126046015       residual = 2.13e-04           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.921126047435       residual = 1.76e-04           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.921126048207       residual = 1.31e-04           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.921126048895       residual = 9.07e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.921126049000       residual = 2.07e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.921126048969       residual = 1.05e-05           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.921126048861       residual = 2.07e-06           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.921126048855       residual = 8.93e-07           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.921126048841       residual = 2.24e-07           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.921126048841       residual = 7.99e-08           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.921126048837       residual = 2.66e-08           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.921126048830       residual = 4.01e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         16 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 1.4211e+03 is 5.229633e-07

solving harmonic davidson linear method for identity shift 5.6843e+03, overlap shift 5.6843e+04 and omega -1.7444e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.921125977170       residual = 2.23e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.921125992010       residual = 2.51e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.921125993424       residual = 5.82e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.921125993834       residual = 2.81e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.921125994223       residual = 2.46e-04           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.921125994382       residual = 2.12e-04           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.921125994736       residual = 1.76e-04           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.921125994930       residual = 1.31e-04           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.921125995111       residual = 9.07e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.921125995130       residual = 2.07e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.921125995104       residual = 1.05e-05           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.921125995093       residual = 2.07e-06           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.921125995086       residual = 8.93e-07           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.921125995103       residual = 2.24e-07           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.921125995096       residual = 7.99e-08           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.921125995089       residual = 2.66e-08           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.921125995094       residual = 4.01e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         16 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 5.6843e+03 is 1.307413e-07

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.739091 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 75 and numParams is: 74

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.6695e+01
  </log>
  <optVariables href="H2O.s060.opt.xml">
ci_0001                 7.086059e-01 3 1  ON 0
ci_0002                 6.927489e-01 3 1  ON 1
ci_0003                -3.099702e-02 3 1  ON 2
ci_0004                -3.009165e-02 3 1  ON 3
ci_0005                -3.060379e-02 3 1  ON 4
ci_0006                -3.069590e-02 3 1  ON 5
ci_0007                -1.338099e-02 3 1  ON 6
ci_0008                -1.335101e-02 3 1  ON 7
ci_0009                -1.869644e-02 3 1  ON 8
ci_0010                -1.813029e-02 3 1  ON 9
ci_0011                -1.474499e-02 3 1  ON 10
ci_0012                -1.451140e-02 3 1  ON 11
ci_0013                 1.529419e-02 3 1  ON 12
ci_0014                 1.480511e-02 3 1  ON 13
ci_0015                 1.574765e-02 3 1  ON 14
ci_0016                 1.538633e-02 3 1  ON 15
ci_0017                 1.336745e-02 3 1  ON 16
ci_0018                 1.303913e-02 3 1  ON 17
ci_0019                 1.308946e-02 3 1  ON 18
ci_0020                 1.266844e-02 3 1  ON 19
ci_0021                 6.752864e-03 3 1  ON 20
ci_0022                 7.460549e-03 3 1  ON 21
ci_0023                -1.180400e-02 3 1  ON 22
ci_0024                -1.147024e-02 3 1  ON 23
ci_0025                -2.029539e-03 3 1  ON 24
ci_0026                -2.390841e-03 3 1  ON 25
ci_0027                -1.213157e-02 3 1  ON 26
ci_0028                -1.154911e-02 3 1  ON 27
ci_0029                -1.065833e-02 3 1  ON 28
ci_0030                -1.058738e-02 3 1  ON 29
ci_0031                 1.340914e-02 3 1  ON 30
ci_0032                 1.211462e-02 3 1  ON 31
ci_0033                 7.848274e-03 3 1  ON 32
ci_0034                 8.489716e-03 3 1  ON 33
ci_0035                 4.859379e-03 3 1  ON 34
ci_0036                 4.933640e-03 3 1  ON 35
ci_0037                -1.133355e-02 3 1  ON 36
ci_0038                -1.131345e-02 3 1  ON 37
ci_0039                -4.015060e-03 3 1  ON 38
ci_0040                -3.886152e-03 3 1  ON 39
ci_0041                 9.104205e-03 3 1  ON 40
ci_0042                 8.780881e-03 3 1  ON 41
ci_0043                -1.307363e-02 3 1  ON 42
ci_0044                -1.384585e-02 3 1  ON 43
ci_0045                 1.059121e-02 3 1  ON 44
ci_0046                 1.007865e-02 3 1  ON 45
ci_0047                -3.585061e-03 3 1  ON 46
ci_0048                -3.481626e-03 3 1  ON 47
ci_0049                -2.594585e-03 3 1  ON 48
ci_0050                -2.696026e-03 3 1  ON 49
ci_0051                -1.797521e-03 3 1  ON 50
ci_0052                -2.016087e-03 3 1  ON 51
ci_0053                -3.931475e-03 3 1  ON 52
ci_0054                -3.323924e-03 3 1  ON 53
ci_0055                 2.398698e-03 3 1  ON 54
ci_0056                 2.269803e-03 3 1  ON 55
ci_0057                 2.453947e-03 3 1  ON 56
ci_0058                 2.857269e-03 3 1  ON 57
ci_0059                -3.395941e-03 3 1  ON 58
ci_0060                -3.375933e-03 3 1  ON 59
ci_0061                -3.976486e-03 3 1  ON 60
ci_0062                -3.922417e-03 3 1  ON 61
ci_0063                -9.802611e-03 3 1  ON 62
ci_0064                -9.372626e-03 3 1  ON 63
ci_0065                -6.435495e-03 3 1  ON 64
ci_0066                -6.132126e-03 3 1  ON 65
ci_0067                -3.748020e-03 3 1  ON 66
ci_0068                -3.479541e-03 3 1  ON 67
ci_0069                 3.569213e-03 3 1  ON 68
ci_0070                 3.348566e-03 3 1  ON 69
ci_0071                 3.005343e-03 3 1  ON 70
ci_0072                 3.481598e-03 3 1  ON 71
ci_0073                 3.552654e-03 3 1  ON 72
ci_0074                 3.528885e-03 3 1  ON 73
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 60
    time step          = 0.05
    reference energy   = -16.9013
    reference variance = 0.298061
====================================================
  Execution time = 1.3717e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s060
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6899e+01
  VMC Evar = 2.8922e-01
  Total weights = 1.9511e+06
  Execution time = 1.8773e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.280310997181
                                         uncertainty =       0.001587422016

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.280310997181
                                         uncertainty =       0.001587422016

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000374466271
  error estimate for blocks of size 2^( 2) =       0.000391236164
  error estimate for blocks of size 2^( 3) =       0.000408543413
  error estimate for blocks of size 2^( 4) =       0.000423287885
  error estimate for blocks of size 2^( 5) =       0.000434585007
  error estimate for blocks of size 2^( 6) =       0.000440107095
  error estimate for blocks of size 2^( 7) =       0.000445271470

      target function =      -0.929625702151
              le_mean =     -16.898586126333
             les_mean =     285.851433192443
             stat err =       0.000435812864
             autocorr =       1.354486496422
   target nu stat err =       0.000435812864
   target dn stat err =       0.002072213985
      target stat err =       0.003366679187
              std dev =       0.529575278708
             le_variance =       0.280449975819

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.280310855359
                                         uncertainty =       0.001587399230

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.280310855359
                                         uncertainty =       0.001587399230

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000374466176
  error estimate for blocks of size 2^( 2) =       0.000391236073
  error estimate for blocks of size 2^( 3) =       0.000408543328
  error estimate for blocks of size 2^( 4) =       0.000423287796
  error estimate for blocks of size 2^( 5) =       0.000434584926
  error estimate for blocks of size 2^( 6) =       0.000440107003
  error estimate for blocks of size 2^( 7) =       0.000445271380

      target function =      -0.929625369919
              le_mean =     -16.898586122882
             les_mean =     285.851433285429
             stat err =       0.000435812776
             autocorr =       1.354486635059
   target nu stat err =       0.000435812776
   target dn stat err =       0.002072217281
      target stat err =       0.003366681879
              std dev =       0.529575144613
             le_variance =       0.280449833792

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.280310926235
                                         uncertainty =       0.001587410618

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.280310926235
                                         uncertainty =       0.001587410618

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000374466223
  error estimate for blocks of size 2^( 2) =       0.000391236119
  error estimate for blocks of size 2^( 3) =       0.000408543370
  error estimate for blocks of size 2^( 4) =       0.000423287840
  error estimate for blocks of size 2^( 5) =       0.000434584966
  error estimate for blocks of size 2^( 6) =       0.000440107049
  error estimate for blocks of size 2^( 7) =       0.000445271425

      target function =      -0.929625537205
              le_mean =     -16.898586124606
             les_mean =     285.851433238141
             stat err =       0.000435812820
             autocorr =       1.354486565792
   target nu stat err =       0.000435812820
   target dn stat err =       0.002072215579
      target stat err =       0.003366680458
              std dev =       0.529575211628
             le_variance =       0.280449904770

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.280310988309
                                         uncertainty =       0.001587420591

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.280310988309
                                         uncertainty =       0.001587420591

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000374466265
  error estimate for blocks of size 2^( 2) =       0.000391236158
  error estimate for blocks of size 2^( 3) =       0.000408543408
  error estimate for blocks of size 2^( 4) =       0.000423287879
  error estimate for blocks of size 2^( 5) =       0.000434585002
  error estimate for blocks of size 2^( 6) =       0.000440107089
  error estimate for blocks of size 2^( 7) =       0.000445271464

      target function =      -0.929625681669
              le_mean =     -16.898586126117
             les_mean =     285.851433198063
             stat err =       0.000435812859
             autocorr =       1.354486505094
   target nu stat err =       0.000435812859
   target dn stat err =       0.002072214178
      target stat err =       0.003366679337
              std dev =       0.529575270320
             le_variance =       0.280449966934


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.929625702151        initial  <--
     3.5527e+02     3.5527e+03             2.0918e-06        -0.929625369919
     1.4211e+03     1.4211e+04             5.2296e-07        -0.929625537205
     5.6843e+03     5.6843e+04             1.3074e-07        -0.929625681669

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 23.1635
  </log>
  <optVariables href="H2O.s060.opt.xml">
ci_0001                 7.086064e-01 3 1  ON 0
ci_0002                 6.927483e-01 3 1  ON 1
ci_0003                -3.099700e-02 3 1  ON 2
ci_0004                -3.009163e-02 3 1  ON 3
ci_0005                -3.060381e-02 3 1  ON 4
ci_0006                -3.069589e-02 3 1  ON 5
ci_0007                -1.338106e-02 3 1  ON 6
ci_0008                -1.335098e-02 3 1  ON 7
ci_0009                -1.869649e-02 3 1  ON 8
ci_0010                -1.813029e-02 3 1  ON 9
ci_0011                -1.474502e-02 3 1  ON 10
ci_0012                -1.451137e-02 3 1  ON 11
ci_0013                 1.529423e-02 3 1  ON 12
ci_0014                 1.480516e-02 3 1  ON 13
ci_0015                 1.574766e-02 3 1  ON 14
ci_0016                 1.538635e-02 3 1  ON 15
ci_0017                 1.336745e-02 3 1  ON 16
ci_0018                 1.303907e-02 3 1  ON 17
ci_0019                 1.308951e-02 3 1  ON 18
ci_0020                 1.266839e-02 3 1  ON 19
ci_0021                 6.752834e-03 3 1  ON 20
ci_0022                 7.460564e-03 3 1  ON 21
ci_0023                -1.180401e-02 3 1  ON 22
ci_0024                -1.147024e-02 3 1  ON 23
ci_0025                -2.029552e-03 3 1  ON 24
ci_0026                -2.390792e-03 3 1  ON 25
ci_0027                -1.213158e-02 3 1  ON 26
ci_0028                -1.154911e-02 3 1  ON 27
ci_0029                -1.065831e-02 3 1  ON 28
ci_0030                -1.058733e-02 3 1  ON 29
ci_0031                 1.340906e-02 3 1  ON 30
ci_0032                 1.211456e-02 3 1  ON 31
ci_0033                 7.848187e-03 3 1  ON 32
ci_0034                 8.489684e-03 3 1  ON 33
ci_0035                 4.859456e-03 3 1  ON 34
ci_0036                 4.933672e-03 3 1  ON 35
ci_0037                -1.133361e-02 3 1  ON 36
ci_0038                -1.131346e-02 3 1  ON 37
ci_0039                -4.015004e-03 3 1  ON 38
ci_0040                -3.886149e-03 3 1  ON 39
ci_0041                 9.104229e-03 3 1  ON 40
ci_0042                 8.780956e-03 3 1  ON 41
ci_0043                -1.307368e-02 3 1  ON 42
ci_0044                -1.384577e-02 3 1  ON 43
ci_0045                 1.059116e-02 3 1  ON 44
ci_0046                 1.007867e-02 3 1  ON 45
ci_0047                -3.585075e-03 3 1  ON 46
ci_0048                -3.481624e-03 3 1  ON 47
ci_0049                -2.594559e-03 3 1  ON 48
ci_0050                -2.695914e-03 3 1  ON 49
ci_0051                -1.797581e-03 3 1  ON 50
ci_0052                -2.016135e-03 3 1  ON 51
ci_0053                -3.931451e-03 3 1  ON 52
ci_0054                -3.323911e-03 3 1  ON 53
ci_0055                 2.398828e-03 3 1  ON 54
ci_0056                 2.269830e-03 3 1  ON 55
ci_0057                 2.453976e-03 3 1  ON 56
ci_0058                 2.857301e-03 3 1  ON 57
ci_0059                -3.395807e-03 3 1  ON 58
ci_0060                -3.375907e-03 3 1  ON 59
ci_0061                -3.976492e-03 3 1  ON 60
ci_0062                -3.922381e-03 3 1  ON 61
ci_0063                -9.802596e-03 3 1  ON 62
ci_0064                -9.372629e-03 3 1  ON 63
ci_0065                -6.435487e-03 3 1  ON 64
ci_0066                -6.132163e-03 3 1  ON 65
ci_0067                -3.748011e-03 3 1  ON 66
ci_0068                -3.479525e-03 3 1  ON 67
ci_0069                 3.569227e-03 3 1  ON 68
ci_0070                 3.348567e-03 3 1  ON 69
ci_0071                 3.005283e-03 3 1  ON 70
ci_0072                 3.481746e-03 3 1  ON 71
ci_0073                 3.552582e-03 3 1  ON 72
ci_0074                 3.528881e-03 3 1  ON 73
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 3.9864e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s061 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s061 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=61  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6903e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 61
    time step          = 0.05
    reference energy   = -16.8913
    reference variance = 0.225761
====================================================
  Execution time = 1.4045e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s061
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5225e+04
  VMC Eavg = -1.6899e+01
  VMC Evar = 2.9685e-01
  Total weights = 1.951150001e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 2.5562e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.285450992225
                                         uncertainty =       0.002450566139

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.285450992225
                                         uncertainty =       0.002450566139

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000377793740
  error estimate for blocks of size 2^( 2) =       0.000394834559
  error estimate for blocks of size 2^( 3) =       0.000412573334
  error estimate for blocks of size 2^( 4) =       0.000428667049
  error estimate for blocks of size 2^( 5) =       0.000440703881
  error estimate for blocks of size 2^( 6) =       0.000449438927
  error estimate for blocks of size 2^( 7) =       0.000454670080

      target function =      -0.917673704234
              le_mean =     -16.898562337357
             les_mean =     285.858256392273
             stat err =       0.000443369984
             autocorr =       1.377282601696
   target nu stat err =       0.000443369984
   target dn stat err =       0.003520229764
      target stat err =       0.005486593866
              std dev =       0.534281031305
             le_variance =       0.285456220413


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.689856233736e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 74
Check correct_vf_var_size: 225, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 3.5527e+03, overlap shift 3.5527e+04 and omega -1.7444e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.917705219814       residual = 1.41e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.917705235710       residual = 1.52e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.917705237386       residual = 3.80e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.917705237887       residual = 1.36e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.917705238048       residual = 6.28e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.917705238094       residual = 3.40e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.917705238119       residual = 2.17e-05           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.917705238165       residual = 7.99e-06           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.917705238178       residual = 6.42e-06           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.917705238161       residual = 6.22e-06           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.917705238202       residual = 4.78e-06           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.917705238218       residual = 2.66e-06           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.917705238238       residual = 1.11e-06           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.917705238250       residual = 3.23e-07           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.917705238251       residual = 8.92e-08           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.917705238259       residual = 3.97e-08           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.917705238245       residual = 9.29e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         16 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 3.5527e+03 is 6.242712e-08

solving harmonic davidson linear method for identity shift 1.4211e+04, overlap shift 1.4211e+05 and omega -1.7444e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.917705219814       residual = 1.41e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.917705223788       residual = 1.52e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.917705224208       residual = 3.80e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.917705224333       residual = 1.36e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.917705224366       residual = 6.28e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.917705224402       residual = 3.40e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.917705224398       residual = 2.17e-05           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.917705224407       residual = 7.99e-06           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.917705224429       residual = 6.42e-06           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.917705224414       residual = 6.22e-06           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.917705224449       residual = 4.78e-06           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.917705224389       residual = 2.65e-06           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.917705224378       residual = 1.11e-06           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.917705224392       residual = 3.23e-07           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.917705224460       residual = 8.92e-08           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.917705224429       residual = 3.97e-08           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.917705224408       residual = 9.29e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         16 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 1.4211e+04 is 1.560704e-08

solving harmonic davidson linear method for identity shift 5.6843e+04, overlap shift 5.6843e+05 and omega -1.7444e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.917705219814       residual = 1.41e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.917705220808       residual = 1.52e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.917705220913       residual = 3.80e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.917705220926       residual = 1.36e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.917705220954       residual = 6.28e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.917705220919       residual = 3.40e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.917705221031       residual = 2.17e-05           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.917705220966       residual = 7.99e-06           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.917705220979       residual = 6.42e-06           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.917705220976       residual = 6.22e-06           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.917705221014       residual = 4.78e-06           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.917705220792       residual = 2.65e-06           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.917705220864       residual = 1.11e-06           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.917705220961       residual = 3.23e-07           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.917705220908       residual = 8.92e-08           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.917705220882       residual = 3.97e-08           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.917705220993       residual = 9.29e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         16 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 5.6843e+04 is 3.901777e-09

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.748128 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 75 and numParams is: 74

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.6615e+01
  </log>
  <optVariables href="H2O.s061.opt.xml">
ci_0001                 7.086064e-01 3 1  ON 0
ci_0002                 6.927484e-01 3 1  ON 1
ci_0003                -3.099700e-02 3 1  ON 2
ci_0004                -3.009164e-02 3 1  ON 3
ci_0005                -3.060381e-02 3 1  ON 4
ci_0006                -3.069589e-02 3 1  ON 5
ci_0007                -1.338106e-02 3 1  ON 6
ci_0008                -1.335098e-02 3 1  ON 7
ci_0009                -1.869649e-02 3 1  ON 8
ci_0010                -1.813028e-02 3 1  ON 9
ci_0011                -1.474502e-02 3 1  ON 10
ci_0012                -1.451137e-02 3 1  ON 11
ci_0013                 1.529423e-02 3 1  ON 12
ci_0014                 1.480516e-02 3 1  ON 13
ci_0015                 1.574766e-02 3 1  ON 14
ci_0016                 1.538635e-02 3 1  ON 15
ci_0017                 1.336745e-02 3 1  ON 16
ci_0018                 1.303907e-02 3 1  ON 17
ci_0019                 1.308951e-02 3 1  ON 18
ci_0020                 1.266839e-02 3 1  ON 19
ci_0021                 6.752825e-03 3 1  ON 20
ci_0022                 7.460561e-03 3 1  ON 21
ci_0023                -1.180402e-02 3 1  ON 22
ci_0024                -1.147024e-02 3 1  ON 23
ci_0025                -2.029556e-03 3 1  ON 24
ci_0026                -2.390792e-03 3 1  ON 25
ci_0027                -1.213158e-02 3 1  ON 26
ci_0028                -1.154911e-02 3 1  ON 27
ci_0029                -1.065831e-02 3 1  ON 28
ci_0030                -1.058732e-02 3 1  ON 29
ci_0031                 1.340906e-02 3 1  ON 30
ci_0032                 1.211456e-02 3 1  ON 31
ci_0033                 7.848186e-03 3 1  ON 32
ci_0034                 8.489676e-03 3 1  ON 33
ci_0035                 4.859451e-03 3 1  ON 34
ci_0036                 4.933657e-03 3 1  ON 35
ci_0037                -1.133361e-02 3 1  ON 36
ci_0038                -1.131346e-02 3 1  ON 37
ci_0039                -4.015002e-03 3 1  ON 38
ci_0040                -3.886150e-03 3 1  ON 39
ci_0041                 9.104224e-03 3 1  ON 40
ci_0042                 8.780958e-03 3 1  ON 41
ci_0043                -1.307367e-02 3 1  ON 42
ci_0044                -1.384577e-02 3 1  ON 43
ci_0045                 1.059116e-02 3 1  ON 44
ci_0046                 1.007868e-02 3 1  ON 45
ci_0047                -3.585073e-03 3 1  ON 46
ci_0048                -3.481625e-03 3 1  ON 47
ci_0049                -2.594568e-03 3 1  ON 48
ci_0050                -2.695909e-03 3 1  ON 49
ci_0051                -1.797584e-03 3 1  ON 50
ci_0052                -2.016137e-03 3 1  ON 51
ci_0053                -3.931453e-03 3 1  ON 52
ci_0054                -3.323900e-03 3 1  ON 53
ci_0055                 2.398828e-03 3 1  ON 54
ci_0056                 2.269830e-03 3 1  ON 55
ci_0057                 2.453975e-03 3 1  ON 56
ci_0058                 2.857294e-03 3 1  ON 57
ci_0059                -3.395811e-03 3 1  ON 58
ci_0060                -3.375912e-03 3 1  ON 59
ci_0061                -3.976488e-03 3 1  ON 60
ci_0062                -3.922380e-03 3 1  ON 61
ci_0063                -9.802598e-03 3 1  ON 62
ci_0064                -9.372629e-03 3 1  ON 63
ci_0065                -6.435485e-03 3 1  ON 64
ci_0066                -6.132163e-03 3 1  ON 65
ci_0067                -3.748015e-03 3 1  ON 66
ci_0068                -3.479522e-03 3 1  ON 67
ci_0069                 3.569226e-03 3 1  ON 68
ci_0070                 3.348565e-03 3 1  ON 69
ci_0071                 3.005285e-03 3 1  ON 70
ci_0072                 3.481738e-03 3 1  ON 71
ci_0073                 3.552583e-03 3 1  ON 72
ci_0074                 3.528876e-03 3 1  ON 73
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 61
    time step          = 0.05
    reference energy   = -16.8915
    reference variance = 0.163082
====================================================
  Execution time = 1.3817e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s061
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6899e+01
  VMC Evar = 2.9396e-01
  Total weights = 1.9509e+06
  Execution time = 1.8725e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.282776334080
                                         uncertainty =       0.002080064114

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.282776334080
                                         uncertainty =       0.002080064114

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000376020240
  error estimate for blocks of size 2^( 2) =       0.000392849165
  error estimate for blocks of size 2^( 3) =       0.000410074803
  error estimate for blocks of size 2^( 4) =       0.000424932142
  error estimate for blocks of size 2^( 5) =       0.000436503146
  error estimate for blocks of size 2^( 6) =       0.000442134001
  error estimate for blocks of size 2^( 7) =       0.000442977093

      target function =      -0.922171324776
              le_mean =     -16.898789870550
             les_mean =     285.863056251875
             stat err =       0.000436636595
             autocorr =       1.348397127129
   target nu stat err =       0.000436636595
   target dn stat err =       0.002873432663
      target stat err =       0.004542770038
              std dev =       0.531772923800
             le_variance =       0.282782442487

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.282776333421
                                         uncertainty =       0.002080064807

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.282776333421
                                         uncertainty =       0.002080064807

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000376020240
  error estimate for blocks of size 2^( 2) =       0.000392849165
  error estimate for blocks of size 2^( 3) =       0.000410074804
  error estimate for blocks of size 2^( 4) =       0.000424932145
  error estimate for blocks of size 2^( 5) =       0.000436503150
  error estimate for blocks of size 2^( 6) =       0.000442134004
  error estimate for blocks of size 2^( 7) =       0.000442977097

      target function =      -0.922171152542
              le_mean =     -16.898789870359
             les_mean =     285.863056355751
             stat err =       0.000436636599
             autocorr =       1.348397151409
   target nu stat err =       0.000436636599
   target dn stat err =       0.002873442972
      target stat err =       0.004542784231
              std dev =       0.531772923233
             le_variance =       0.282782441884

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.282776333751
                                         uncertainty =       0.002080064461

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.282776333751
                                         uncertainty =       0.002080064461

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000376020240
  error estimate for blocks of size 2^( 2) =       0.000392849165
  error estimate for blocks of size 2^( 3) =       0.000410074803
  error estimate for blocks of size 2^( 4) =       0.000424932144
  error estimate for blocks of size 2^( 5) =       0.000436503148
  error estimate for blocks of size 2^( 6) =       0.000442134002
  error estimate for blocks of size 2^( 7) =       0.000442977095

      target function =      -0.922171238701
              le_mean =     -16.898789870455
             les_mean =     285.863056303786
             stat err =       0.000436636597
             autocorr =       1.348397139276
   target nu stat err =       0.000436636597
   target dn stat err =       0.002873437816
      target stat err =       0.004542777132
              std dev =       0.531772923516
             le_variance =       0.282782442185

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.282776334039
                                         uncertainty =       0.002080064157

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.282776334039
                                         uncertainty =       0.002080064157

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000376020240
  error estimate for blocks of size 2^( 2) =       0.000392849165
  error estimate for blocks of size 2^( 3) =       0.000410074803
  error estimate for blocks of size 2^( 4) =       0.000424932142
  error estimate for blocks of size 2^( 5) =       0.000436503146
  error estimate for blocks of size 2^( 6) =       0.000442134001
  error estimate for blocks of size 2^( 7) =       0.000442977094

      target function =      -0.922171314021
              le_mean =     -16.898789870538
             les_mean =     285.863056258361
             stat err =       0.000436636596
             autocorr =       1.348397128644
   target nu stat err =       0.000436636596
   target dn stat err =       0.002873433307
      target stat err =       0.004542770924
              std dev =       0.531772923765
             le_variance =       0.282782442449


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.922171324776        initial  <--
     3.5527e+03     3.5527e+04             6.2427e-08        -0.922171152542
     1.4211e+04     1.4211e+05             1.5607e-08        -0.922171238701
     5.6843e+04     5.6843e+05             3.9018e-09        -0.922171314021

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 23.3616
  </log>
  <optVariables href="H2O.s061.opt.xml">
ci_0001                 7.086064e-01 3 1  ON 0
ci_0002                 6.927483e-01 3 1  ON 1
ci_0003                -3.099700e-02 3 1  ON 2
ci_0004                -3.009163e-02 3 1  ON 3
ci_0005                -3.060381e-02 3 1  ON 4
ci_0006                -3.069589e-02 3 1  ON 5
ci_0007                -1.338106e-02 3 1  ON 6
ci_0008                -1.335098e-02 3 1  ON 7
ci_0009                -1.869649e-02 3 1  ON 8
ci_0010                -1.813029e-02 3 1  ON 9
ci_0011                -1.474502e-02 3 1  ON 10
ci_0012                -1.451137e-02 3 1  ON 11
ci_0013                 1.529423e-02 3 1  ON 12
ci_0014                 1.480516e-02 3 1  ON 13
ci_0015                 1.574766e-02 3 1  ON 14
ci_0016                 1.538635e-02 3 1  ON 15
ci_0017                 1.336745e-02 3 1  ON 16
ci_0018                 1.303907e-02 3 1  ON 17
ci_0019                 1.308951e-02 3 1  ON 18
ci_0020                 1.266839e-02 3 1  ON 19
ci_0021                 6.752834e-03 3 1  ON 20
ci_0022                 7.460564e-03 3 1  ON 21
ci_0023                -1.180401e-02 3 1  ON 22
ci_0024                -1.147024e-02 3 1  ON 23
ci_0025                -2.029552e-03 3 1  ON 24
ci_0026                -2.390792e-03 3 1  ON 25
ci_0027                -1.213158e-02 3 1  ON 26
ci_0028                -1.154911e-02 3 1  ON 27
ci_0029                -1.065831e-02 3 1  ON 28
ci_0030                -1.058733e-02 3 1  ON 29
ci_0031                 1.340906e-02 3 1  ON 30
ci_0032                 1.211456e-02 3 1  ON 31
ci_0033                 7.848187e-03 3 1  ON 32
ci_0034                 8.489684e-03 3 1  ON 33
ci_0035                 4.859456e-03 3 1  ON 34
ci_0036                 4.933672e-03 3 1  ON 35
ci_0037                -1.133361e-02 3 1  ON 36
ci_0038                -1.131346e-02 3 1  ON 37
ci_0039                -4.015004e-03 3 1  ON 38
ci_0040                -3.886149e-03 3 1  ON 39
ci_0041                 9.104229e-03 3 1  ON 40
ci_0042                 8.780956e-03 3 1  ON 41
ci_0043                -1.307368e-02 3 1  ON 42
ci_0044                -1.384577e-02 3 1  ON 43
ci_0045                 1.059116e-02 3 1  ON 44
ci_0046                 1.007867e-02 3 1  ON 45
ci_0047                -3.585075e-03 3 1  ON 46
ci_0048                -3.481624e-03 3 1  ON 47
ci_0049                -2.594559e-03 3 1  ON 48
ci_0050                -2.695914e-03 3 1  ON 49
ci_0051                -1.797581e-03 3 1  ON 50
ci_0052                -2.016135e-03 3 1  ON 51
ci_0053                -3.931451e-03 3 1  ON 52
ci_0054                -3.323911e-03 3 1  ON 53
ci_0055                 2.398828e-03 3 1  ON 54
ci_0056                 2.269830e-03 3 1  ON 55
ci_0057                 2.453976e-03 3 1  ON 56
ci_0058                 2.857301e-03 3 1  ON 57
ci_0059                -3.395807e-03 3 1  ON 58
ci_0060                -3.375907e-03 3 1  ON 59
ci_0061                -3.976492e-03 3 1  ON 60
ci_0062                -3.922381e-03 3 1  ON 61
ci_0063                -9.802596e-03 3 1  ON 62
ci_0064                -9.372629e-03 3 1  ON 63
ci_0065                -6.435487e-03 3 1  ON 64
ci_0066                -6.132163e-03 3 1  ON 65
ci_0067                -3.748011e-03 3 1  ON 66
ci_0068                -3.479525e-03 3 1  ON 67
ci_0069                 3.569227e-03 3 1  ON 68
ci_0070                 3.348567e-03 3 1  ON 69
ci_0071                 3.005283e-03 3 1  ON 70
ci_0072                 3.481746e-03 3 1  ON 71
ci_0073                 3.552582e-03 3 1  ON 72
ci_0074                 3.528881e-03 3 1  ON 73
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 3.9983e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s062 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s062 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=62  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6903e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 62
    time step          = 0.05
    reference energy   = -16.8446
    reference variance = 0.20323
====================================================
  Execution time = 1.4036e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s062
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5245e+04
  VMC Eavg = -1.6898e+01
  VMC Evar = 2.9690e-01
  Total weights = 1.951225051e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 2.6020e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.287141686281
                                         uncertainty =       0.002061199647

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.287141686281
                                         uncertainty =       0.002061199647

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000378885089
  error estimate for blocks of size 2^( 2) =       0.000396100906
  error estimate for blocks of size 2^( 3) =       0.000413392588
  error estimate for blocks of size 2^( 4) =       0.000429284275
  error estimate for blocks of size 2^( 5) =       0.000441702021
  error estimate for blocks of size 2^( 6) =       0.000449522459
  error estimate for blocks of size 2^( 7) =       0.000455892008

      target function =      -0.917608223814
              le_mean =     -16.898288537500
             les_mean =     285.849052179861
             stat err =       0.000444100191
             autocorr =       1.373873962170
   target nu stat err =       0.000444100191
   target dn stat err =       0.002923078797
      target stat err =       0.004572011767
              std dev =       0.535824431045
             le_variance =       0.287107820905


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.689828853750e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 74
Check correct_vf_var_size: 225, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 3.5527e+04, overlap shift 3.5527e+05 and omega -1.7444e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.917628457021       residual = 8.65e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.917628457980       residual = 1.01e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.917628458100       residual = 3.15e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.917628458150       residual = 1.40e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.917628458180       residual = 6.42e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.917628458191       residual = 4.05e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.917628458193       residual = 1.18e-05           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.917628458170       residual = 4.55e-06           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.917628458218       residual = 4.13e-06           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.917628458256       residual = 3.30e-06           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.917628458359       residual = 3.26e-06           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.917628458240       residual = 1.82e-06           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.917628458278       residual = 8.81e-07           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.917628458305       residual = 2.47e-07           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.917628458148       residual = 7.88e-08           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.917628458142       residual = 2.12e-08           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.917628458189       residual = 5.66e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         16 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 3.5527e+04 is 4.952305e-09

solving harmonic davidson linear method for identity shift 1.4211e+05, overlap shift 1.4211e+06 and omega -1.7444e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.917628457021       residual = 8.65e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.917628457261       residual = 1.01e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.917628457291       residual = 3.15e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.917628457216       residual = 1.40e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.917628457311       residual = 6.42e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.917628457172       residual = 4.05e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.917628457505       residual = 1.18e-05           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.917628457276       residual = 4.55e-06           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.917628457441       residual = 4.13e-06           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.917628457475       residual = 3.30e-06           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.917628457484       residual = 3.26e-06           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.917628457387       residual = 1.82e-06           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.917628457124       residual = 8.81e-07           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.917628457213       residual = 2.47e-07           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.917628456789       residual = 7.88e-08           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.917628457486       residual = 2.12e-08           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.917628457425       residual = 5.66e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         16 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 1.4211e+05 is 1.238077e-09

solving harmonic davidson linear method for identity shift 5.6843e+05, overlap shift 5.6843e+06 and omega -1.7444e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.917628457021       residual = 8.65e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.917628457081       residual = 1.01e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.917628457089       residual = 3.15e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.917628457092       residual = 1.40e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.917628457094       residual = 6.42e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.917628455576       residual = 4.05e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.917628457515       residual = 1.18e-05           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.917628456370       residual = 4.55e-06           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.917628456773       residual = 4.13e-06           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.917628455794       residual = 3.30e-06           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.917628458565       residual = 3.26e-06           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.917628457377       residual = 1.82e-06           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.917628454700       residual = 8.81e-07           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.917628456218       residual = 2.47e-07           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.917628458029       residual = 7.88e-08           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.917628458697       residual = 2.12e-08           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.917628457548       residual = 5.66e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         16 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 5.6843e+05 is 3.095193e-10

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.757150 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 75 and numParams is: 74

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.6652e+01
  </log>
  <optVariables href="H2O.s062.opt.xml">
ci_0001                 7.086064e-01 3 1  ON 0
ci_0002                 6.927483e-01 3 1  ON 1
ci_0003                -3.099700e-02 3 1  ON 2
ci_0004                -3.009163e-02 3 1  ON 3
ci_0005                -3.060381e-02 3 1  ON 4
ci_0006                -3.069589e-02 3 1  ON 5
ci_0007                -1.338106e-02 3 1  ON 6
ci_0008                -1.335098e-02 3 1  ON 7
ci_0009                -1.869649e-02 3 1  ON 8
ci_0010                -1.813029e-02 3 1  ON 9
ci_0011                -1.474502e-02 3 1  ON 10
ci_0012                -1.451137e-02 3 1  ON 11
ci_0013                 1.529423e-02 3 1  ON 12
ci_0014                 1.480516e-02 3 1  ON 13
ci_0015                 1.574766e-02 3 1  ON 14
ci_0016                 1.538635e-02 3 1  ON 15
ci_0017                 1.336745e-02 3 1  ON 16
ci_0018                 1.303907e-02 3 1  ON 17
ci_0019                 1.308951e-02 3 1  ON 18
ci_0020                 1.266839e-02 3 1  ON 19
ci_0021                 6.752833e-03 3 1  ON 20
ci_0022                 7.460564e-03 3 1  ON 21
ci_0023                -1.180401e-02 3 1  ON 22
ci_0024                -1.147024e-02 3 1  ON 23
ci_0025                -2.029553e-03 3 1  ON 24
ci_0026                -2.390792e-03 3 1  ON 25
ci_0027                -1.213158e-02 3 1  ON 26
ci_0028                -1.154911e-02 3 1  ON 27
ci_0029                -1.065831e-02 3 1  ON 28
ci_0030                -1.058733e-02 3 1  ON 29
ci_0031                 1.340906e-02 3 1  ON 30
ci_0032                 1.211456e-02 3 1  ON 31
ci_0033                 7.848187e-03 3 1  ON 32
ci_0034                 8.489684e-03 3 1  ON 33
ci_0035                 4.859456e-03 3 1  ON 34
ci_0036                 4.933673e-03 3 1  ON 35
ci_0037                -1.133361e-02 3 1  ON 36
ci_0038                -1.131346e-02 3 1  ON 37
ci_0039                -4.015004e-03 3 1  ON 38
ci_0040                -3.886149e-03 3 1  ON 39
ci_0041                 9.104229e-03 3 1  ON 40
ci_0042                 8.780956e-03 3 1  ON 41
ci_0043                -1.307368e-02 3 1  ON 42
ci_0044                -1.384578e-02 3 1  ON 43
ci_0045                 1.059116e-02 3 1  ON 44
ci_0046                 1.007867e-02 3 1  ON 45
ci_0047                -3.585075e-03 3 1  ON 46
ci_0048                -3.481624e-03 3 1  ON 47
ci_0049                -2.594559e-03 3 1  ON 48
ci_0050                -2.695914e-03 3 1  ON 49
ci_0051                -1.797581e-03 3 1  ON 50
ci_0052                -2.016135e-03 3 1  ON 51
ci_0053                -3.931450e-03 3 1  ON 52
ci_0054                -3.323911e-03 3 1  ON 53
ci_0055                 2.398828e-03 3 1  ON 54
ci_0056                 2.269830e-03 3 1  ON 55
ci_0057                 2.453976e-03 3 1  ON 56
ci_0058                 2.857300e-03 3 1  ON 57
ci_0059                -3.395807e-03 3 1  ON 58
ci_0060                -3.375907e-03 3 1  ON 59
ci_0061                -3.976492e-03 3 1  ON 60
ci_0062                -3.922382e-03 3 1  ON 61
ci_0063                -9.802596e-03 3 1  ON 62
ci_0064                -9.372629e-03 3 1  ON 63
ci_0065                -6.435487e-03 3 1  ON 64
ci_0066                -6.132163e-03 3 1  ON 65
ci_0067                -3.748010e-03 3 1  ON 66
ci_0068                -3.479524e-03 3 1  ON 67
ci_0069                 3.569226e-03 3 1  ON 68
ci_0070                 3.348567e-03 3 1  ON 69
ci_0071                 3.005282e-03 3 1  ON 70
ci_0072                 3.481746e-03 3 1  ON 71
ci_0073                 3.552582e-03 3 1  ON 72
ci_0074                 3.528881e-03 3 1  ON 73
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 62
    time step          = 0.05
    reference energy   = -16.905
    reference variance = 0.265977
====================================================
  Execution time = 1.5968e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s062
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6899e+01
  VMC Evar = 2.9023e-01
  Total weights = 1.9510e+06
  Execution time = 1.8687e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.280117874518
                                         uncertainty =       0.001772993884

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.280117874518
                                         uncertainty =       0.001772993884

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000374207702
  error estimate for blocks of size 2^( 2) =       0.000391101215
  error estimate for blocks of size 2^( 3) =       0.000408859768
  error estimate for blocks of size 2^( 4) =       0.000423280701
  error estimate for blocks of size 2^( 5) =       0.000435049321
  error estimate for blocks of size 2^( 6) =       0.000440507702
  error estimate for blocks of size 2^( 7) =       0.000444835134

      target function =      -0.928033383514
              le_mean =     -16.898815807989
             les_mean =     285.860200997705
             stat err =       0.000435918214
             autocorr =       1.357014814902
   target nu stat err =       0.000435918214
   target dn stat err =       0.002613842092
      target stat err =       0.004195719568
              std dev =       0.529209606703
             le_variance =       0.280062807827

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.280117874778
                                         uncertainty =       0.001772993890

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.280117874778
                                         uncertainty =       0.001772993890

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000374207702
  error estimate for blocks of size 2^( 2) =       0.000391101215
  error estimate for blocks of size 2^( 3) =       0.000408859768
  error estimate for blocks of size 2^( 4) =       0.000423280701
  error estimate for blocks of size 2^( 5) =       0.000435049321
  error estimate for blocks of size 2^( 6) =       0.000440507703
  error estimate for blocks of size 2^( 7) =       0.000444835134

      target function =      -0.928033381236
              le_mean =     -16.898815808004
             les_mean =     285.860200999644
             stat err =       0.000435918215
             autocorr =       1.357014815118
   target nu stat err =       0.000435918215
   target dn stat err =       0.002613842499
      target stat err =       0.004195720181
              std dev =       0.529209606947
             le_variance =       0.280062808085

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.280117874648
                                         uncertainty =       0.001772993887

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.280117874648
                                         uncertainty =       0.001772993887

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000374207702
  error estimate for blocks of size 2^( 2) =       0.000391101215
  error estimate for blocks of size 2^( 3) =       0.000408859768
  error estimate for blocks of size 2^( 4) =       0.000423280701
  error estimate for blocks of size 2^( 5) =       0.000435049321
  error estimate for blocks of size 2^( 6) =       0.000440507702
  error estimate for blocks of size 2^( 7) =       0.000444835134

      target function =      -0.928033382375
              le_mean =     -16.898815807997
             les_mean =     285.860200998674
             stat err =       0.000435918215
             autocorr =       1.357014815010
   target nu stat err =       0.000435918215
   target dn stat err =       0.002613842295
      target stat err =       0.004195719874
              std dev =       0.529209606825
             le_variance =       0.280062807956

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.280117874534
                                         uncertainty =       0.001772993884

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.280117874534
                                         uncertainty =       0.001772993884

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000374207702
  error estimate for blocks of size 2^( 2) =       0.000391101215
  error estimate for blocks of size 2^( 3) =       0.000408859768
  error estimate for blocks of size 2^( 4) =       0.000423280701
  error estimate for blocks of size 2^( 5) =       0.000435049321
  error estimate for blocks of size 2^( 6) =       0.000440507702
  error estimate for blocks of size 2^( 7) =       0.000444835134

      target function =      -0.928033383371
              le_mean =     -16.898815807990
             les_mean =     285.860200997826
             stat err =       0.000435918214
             autocorr =       1.357014814915
   target nu stat err =       0.000435918214
   target dn stat err =       0.002613842117
      target stat err =       0.004195719606
              std dev =       0.529209606719
             le_variance =       0.280062807843


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.928033383514        initial  <--
     3.5527e+04     3.5527e+05             4.9523e-09        -0.928033381236
     1.4211e+05     1.4211e+06             1.2381e-09        -0.928033382375
     5.6843e+05     5.6843e+06             3.0952e-10        -0.928033383371

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 29.5224
  </log>
  <optVariables href="H2O.s062.opt.xml">
ci_0001                 7.086064e-01 3 1  ON 0
ci_0002                 6.927483e-01 3 1  ON 1
ci_0003                -3.099700e-02 3 1  ON 2
ci_0004                -3.009163e-02 3 1  ON 3
ci_0005                -3.060381e-02 3 1  ON 4
ci_0006                -3.069589e-02 3 1  ON 5
ci_0007                -1.338106e-02 3 1  ON 6
ci_0008                -1.335098e-02 3 1  ON 7
ci_0009                -1.869649e-02 3 1  ON 8
ci_0010                -1.813029e-02 3 1  ON 9
ci_0011                -1.474502e-02 3 1  ON 10
ci_0012                -1.451137e-02 3 1  ON 11
ci_0013                 1.529423e-02 3 1  ON 12
ci_0014                 1.480516e-02 3 1  ON 13
ci_0015                 1.574766e-02 3 1  ON 14
ci_0016                 1.538635e-02 3 1  ON 15
ci_0017                 1.336745e-02 3 1  ON 16
ci_0018                 1.303907e-02 3 1  ON 17
ci_0019                 1.308951e-02 3 1  ON 18
ci_0020                 1.266839e-02 3 1  ON 19
ci_0021                 6.752834e-03 3 1  ON 20
ci_0022                 7.460564e-03 3 1  ON 21
ci_0023                -1.180401e-02 3 1  ON 22
ci_0024                -1.147024e-02 3 1  ON 23
ci_0025                -2.029552e-03 3 1  ON 24
ci_0026                -2.390792e-03 3 1  ON 25
ci_0027                -1.213158e-02 3 1  ON 26
ci_0028                -1.154911e-02 3 1  ON 27
ci_0029                -1.065831e-02 3 1  ON 28
ci_0030                -1.058733e-02 3 1  ON 29
ci_0031                 1.340906e-02 3 1  ON 30
ci_0032                 1.211456e-02 3 1  ON 31
ci_0033                 7.848187e-03 3 1  ON 32
ci_0034                 8.489684e-03 3 1  ON 33
ci_0035                 4.859456e-03 3 1  ON 34
ci_0036                 4.933672e-03 3 1  ON 35
ci_0037                -1.133361e-02 3 1  ON 36
ci_0038                -1.131346e-02 3 1  ON 37
ci_0039                -4.015004e-03 3 1  ON 38
ci_0040                -3.886149e-03 3 1  ON 39
ci_0041                 9.104229e-03 3 1  ON 40
ci_0042                 8.780956e-03 3 1  ON 41
ci_0043                -1.307368e-02 3 1  ON 42
ci_0044                -1.384577e-02 3 1  ON 43
ci_0045                 1.059116e-02 3 1  ON 44
ci_0046                 1.007867e-02 3 1  ON 45
ci_0047                -3.585075e-03 3 1  ON 46
ci_0048                -3.481624e-03 3 1  ON 47
ci_0049                -2.594559e-03 3 1  ON 48
ci_0050                -2.695914e-03 3 1  ON 49
ci_0051                -1.797581e-03 3 1  ON 50
ci_0052                -2.016135e-03 3 1  ON 51
ci_0053                -3.931451e-03 3 1  ON 52
ci_0054                -3.323911e-03 3 1  ON 53
ci_0055                 2.398828e-03 3 1  ON 54
ci_0056                 2.269830e-03 3 1  ON 55
ci_0057                 2.453976e-03 3 1  ON 56
ci_0058                 2.857301e-03 3 1  ON 57
ci_0059                -3.395807e-03 3 1  ON 58
ci_0060                -3.375907e-03 3 1  ON 59
ci_0061                -3.976492e-03 3 1  ON 60
ci_0062                -3.922381e-03 3 1  ON 61
ci_0063                -9.802596e-03 3 1  ON 62
ci_0064                -9.372629e-03 3 1  ON 63
ci_0065                -6.435487e-03 3 1  ON 64
ci_0066                -6.132163e-03 3 1  ON 65
ci_0067                -3.748011e-03 3 1  ON 66
ci_0068                -3.479525e-03 3 1  ON 67
ci_0069                 3.569227e-03 3 1  ON 68
ci_0070                 3.348567e-03 3 1  ON 69
ci_0071                 3.005283e-03 3 1  ON 70
ci_0072                 3.481746e-03 3 1  ON 71
ci_0073                 3.552582e-03 3 1  ON 72
ci_0074                 3.528881e-03 3 1  ON 73
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 4.6207e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s063 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s063 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=63  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6902e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 63
    time step          = 0.05
    reference energy   = -16.8563
    reference variance = 0.201304
====================================================
  Execution time = 1.4063e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s063
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5240e+04
  VMC Eavg = -1.6898e+01
  VMC Evar = 2.8871e-01
  Total weights = 1.950866287e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 2.5622e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.278773913519
                                         uncertainty =       0.001498720953

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.278773913519
                                         uncertainty =       0.001498720953

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000373343237
  error estimate for blocks of size 2^( 2) =       0.000390954399
  error estimate for blocks of size 2^( 3) =       0.000409035794
  error estimate for blocks of size 2^( 4) =       0.000424653830
  error estimate for blocks of size 2^( 5) =       0.000435600356
  error estimate for blocks of size 2^( 6) =       0.000443274226
  error estimate for blocks of size 2^( 7) =       0.000449027657

      target function =      -0.930425239889
              le_mean =     -16.898499282274
             les_mean =     285.847991798147
             stat err =       0.000438139017
             autocorr =       1.377232565840
   target nu stat err =       0.000438139017
   target dn stat err =       0.002043634609
      target stat err =       0.003328460498
              std dev =       0.527987068559
             le_variance =       0.278770344565


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.689849928227e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 74
Check correct_vf_var_size: 225, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 3.5527e+05, overlap shift 3.5527e+06 and omega -1.7444e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.930437401940       residual = 4.60e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.930437401992       residual = 1.18e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.930437402010       residual = 2.46e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.930437402017       residual = 1.11e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.930437402177       residual = 4.93e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.930437402031       residual = 3.90e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.930437402022       residual = 1.52e-05           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.930437402022       residual = 1.06e-05           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.930437401388       residual = 1.69e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.930437402260       residual = 7.42e-06           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.930437402004       residual = 3.47e-06           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.930437401148       residual = 1.36e-06           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.930437402457       residual = 5.06e-07           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.930437402124       residual = 1.37e-07           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.930437401841       residual = 3.33e-08           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.930437402443       residual = 1.37e-08           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.930437402974       residual = 3.16e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         16 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 3.5527e+05 is 6.898310e-10

solving harmonic davidson linear method for identity shift 1.4211e+06, overlap shift 1.4211e+07 and omega -1.7444e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.930437401940       residual = 4.60e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.930437401953       residual = 1.18e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.930437401957       residual = 2.46e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.930437401959       residual = 1.11e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.930437402323       residual = 4.93e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.930437401960       residual = 3.90e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.930437404706       residual = 1.52e-05           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.930437403450       residual = 1.06e-05           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.930437401960       residual = 1.69e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.930437401832       residual = 7.42e-06           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.930437404225       residual = 3.47e-06           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.930437402853       residual = 1.36e-06           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.930437407954       residual = 5.06e-07           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.930437399022       residual = 1.37e-07           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.930437395775       residual = 3.33e-08           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.930437404041       residual = 1.37e-08           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.930437400108       residual = 3.16e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         16 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 1.4211e+06 is 1.724578e-10

solving harmonic davidson linear method for identity shift 5.6843e+06, overlap shift 5.6843e+07 and omega -1.7444e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.930437401940       residual = 4.60e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.930437401943       residual = 1.18e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.930437401944       residual = 2.46e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.930437401945       residual = 1.11e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.930437402063       residual = 4.93e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.930437393471       residual = 3.90e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.930437399503       residual = 1.52e-05           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.930437399691       residual = 1.06e-05           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.930437399111       residual = 1.69e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.930437393757       residual = 7.42e-06           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.930437390819       residual = 3.47e-06           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.930437406584       residual = 1.36e-06           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.930437406194       residual = 5.06e-07           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.930437392336       residual = 1.37e-07           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.930437400686       residual = 3.33e-08           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.930437403842       residual = 1.37e-08           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.930437387401       residual = 3.16e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         16 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 5.6843e+06 is 4.311433e-11

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.766195 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 75 and numParams is: 74

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.6639e+01
  </log>
  <optVariables href="H2O.s063.opt.xml">
ci_0001                 7.086064e-01 3 1  ON 0
ci_0002                 6.927483e-01 3 1  ON 1
ci_0003                -3.099700e-02 3 1  ON 2
ci_0004                -3.009163e-02 3 1  ON 3
ci_0005                -3.060381e-02 3 1  ON 4
ci_0006                -3.069589e-02 3 1  ON 5
ci_0007                -1.338106e-02 3 1  ON 6
ci_0008                -1.335098e-02 3 1  ON 7
ci_0009                -1.869649e-02 3 1  ON 8
ci_0010                -1.813029e-02 3 1  ON 9
ci_0011                -1.474502e-02 3 1  ON 10
ci_0012                -1.451137e-02 3 1  ON 11
ci_0013                 1.529423e-02 3 1  ON 12
ci_0014                 1.480516e-02 3 1  ON 13
ci_0015                 1.574766e-02 3 1  ON 14
ci_0016                 1.538635e-02 3 1  ON 15
ci_0017                 1.336745e-02 3 1  ON 16
ci_0018                 1.303907e-02 3 1  ON 17
ci_0019                 1.308951e-02 3 1  ON 18
ci_0020                 1.266839e-02 3 1  ON 19
ci_0021                 6.752834e-03 3 1  ON 20
ci_0022                 7.460564e-03 3 1  ON 21
ci_0023                -1.180401e-02 3 1  ON 22
ci_0024                -1.147024e-02 3 1  ON 23
ci_0025                -2.029552e-03 3 1  ON 24
ci_0026                -2.390792e-03 3 1  ON 25
ci_0027                -1.213158e-02 3 1  ON 26
ci_0028                -1.154911e-02 3 1  ON 27
ci_0029                -1.065831e-02 3 1  ON 28
ci_0030                -1.058733e-02 3 1  ON 29
ci_0031                 1.340906e-02 3 1  ON 30
ci_0032                 1.211456e-02 3 1  ON 31
ci_0033                 7.848187e-03 3 1  ON 32
ci_0034                 8.489684e-03 3 1  ON 33
ci_0035                 4.859456e-03 3 1  ON 34
ci_0036                 4.933672e-03 3 1  ON 35
ci_0037                -1.133361e-02 3 1  ON 36
ci_0038                -1.131346e-02 3 1  ON 37
ci_0039                -4.015004e-03 3 1  ON 38
ci_0040                -3.886149e-03 3 1  ON 39
ci_0041                 9.104229e-03 3 1  ON 40
ci_0042                 8.780956e-03 3 1  ON 41
ci_0043                -1.307368e-02 3 1  ON 42
ci_0044                -1.384577e-02 3 1  ON 43
ci_0045                 1.059116e-02 3 1  ON 44
ci_0046                 1.007867e-02 3 1  ON 45
ci_0047                -3.585075e-03 3 1  ON 46
ci_0048                -3.481624e-03 3 1  ON 47
ci_0049                -2.594559e-03 3 1  ON 48
ci_0050                -2.695914e-03 3 1  ON 49
ci_0051                -1.797582e-03 3 1  ON 50
ci_0052                -2.016135e-03 3 1  ON 51
ci_0053                -3.931451e-03 3 1  ON 52
ci_0054                -3.323911e-03 3 1  ON 53
ci_0055                 2.398828e-03 3 1  ON 54
ci_0056                 2.269830e-03 3 1  ON 55
ci_0057                 2.453976e-03 3 1  ON 56
ci_0058                 2.857301e-03 3 1  ON 57
ci_0059                -3.395807e-03 3 1  ON 58
ci_0060                -3.375907e-03 3 1  ON 59
ci_0061                -3.976492e-03 3 1  ON 60
ci_0062                -3.922381e-03 3 1  ON 61
ci_0063                -9.802596e-03 3 1  ON 62
ci_0064                -9.372629e-03 3 1  ON 63
ci_0065                -6.435487e-03 3 1  ON 64
ci_0066                -6.132163e-03 3 1  ON 65
ci_0067                -3.748011e-03 3 1  ON 66
ci_0068                -3.479525e-03 3 1  ON 67
ci_0069                 3.569227e-03 3 1  ON 68
ci_0070                 3.348567e-03 3 1  ON 69
ci_0071                 3.005283e-03 3 1  ON 70
ci_0072                 3.481746e-03 3 1  ON 71
ci_0073                 3.552582e-03 3 1  ON 72
ci_0074                 3.528881e-03 3 1  ON 73
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 63
    time step          = 0.05
    reference energy   = -16.8841
    reference variance = 0.26693
====================================================
  Execution time = 1.3699e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s063
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6899e+01
  VMC Evar = 2.9207e-01
  Total weights = 1.9512e+06
  Execution time = 1.8708e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.283005748610
                                         uncertainty =       0.001887588090

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.283005748610
                                         uncertainty =       0.001887588090

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000376211922
  error estimate for blocks of size 2^( 2) =       0.000393266152
  error estimate for blocks of size 2^( 3) =       0.000410372148
  error estimate for blocks of size 2^( 4) =       0.000424948945
  error estimate for blocks of size 2^( 5) =       0.000435870889
  error estimate for blocks of size 2^( 6) =       0.000442990015
  error estimate for blocks of size 2^( 7) =       0.000445962720

      target function =      -0.925143210412
              le_mean =     -16.899346507523
             les_mean =     285.879979674425
             stat err =       0.000437443142
             autocorr =       1.352004434764
   target nu stat err =       0.000437443142
   target dn stat err =       0.002362411062
      target stat err =       0.003786362424
              std dev =       0.532044003018
             le_variance =       0.283070821148

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.283005748528
                                         uncertainty =       0.001887588086

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.283005748528
                                         uncertainty =       0.001887588086

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000376211922
  error estimate for blocks of size 2^( 2) =       0.000393266152
  error estimate for blocks of size 2^( 3) =       0.000410372148
  error estimate for blocks of size 2^( 4) =       0.000424948945
  error estimate for blocks of size 2^( 5) =       0.000435870889
  error estimate for blocks of size 2^( 6) =       0.000442990015
  error estimate for blocks of size 2^( 7) =       0.000445962720

      target function =      -0.925143211020
              le_mean =     -16.899346507523
             les_mean =     285.879979674039
             stat err =       0.000437443142
             autocorr =       1.352004434945
   target nu stat err =       0.000437443142
   target dn stat err =       0.002362411032
      target stat err =       0.003786362383
              std dev =       0.532044002942
             le_variance =       0.283070821066

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.283005748569
                                         uncertainty =       0.001887588088

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.283005748569
                                         uncertainty =       0.001887588088

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000376211922
  error estimate for blocks of size 2^( 2) =       0.000393266152
  error estimate for blocks of size 2^( 3) =       0.000410372148
  error estimate for blocks of size 2^( 4) =       0.000424948945
  error estimate for blocks of size 2^( 5) =       0.000435870889
  error estimate for blocks of size 2^( 6) =       0.000442990015
  error estimate for blocks of size 2^( 7) =       0.000445962720

      target function =      -0.925143210716
              le_mean =     -16.899346507523
             les_mean =     285.879979674232
             stat err =       0.000437443142
             autocorr =       1.352004434853
   target nu stat err =       0.000437443142
   target dn stat err =       0.002362411047
      target stat err =       0.003786362404
              std dev =       0.532044002980
             le_variance =       0.283070821107

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.283005748605
                                         uncertainty =       0.001887588089

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.283005748605
                                         uncertainty =       0.001887588089

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000376211922
  error estimate for blocks of size 2^( 2) =       0.000393266152
  error estimate for blocks of size 2^( 3) =       0.000410372148
  error estimate for blocks of size 2^( 4) =       0.000424948945
  error estimate for blocks of size 2^( 5) =       0.000435870889
  error estimate for blocks of size 2^( 6) =       0.000442990015
  error estimate for blocks of size 2^( 7) =       0.000445962720

      target function =      -0.925143210450
              le_mean =     -16.899346507523
             les_mean =     285.879979674401
             stat err =       0.000437443142
             autocorr =       1.352004434777
   target nu stat err =       0.000437443142
   target dn stat err =       0.002362411060
      target stat err =       0.003786362422
              std dev =       0.532044003013
             le_variance =       0.283070821143


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.925143210412        initial
     3.5527e+05     3.5527e+06             6.8983e-10        -0.925143211020  <--
     1.4211e+06     1.4211e+07             1.7246e-10        -0.925143210716
     5.6843e+06     5.6843e+07             4.3114e-11        -0.925143210450

*****************************************************************************
Applying the update for shift_i =   3.5527e+05     and shift_s =   3.5527e+06
*****************************************************************************

  Execution time = 2.3139e+01
  </log>
  <optVariables href="H2O.s063.opt.xml">
ci_0001                 7.086064e-01 3 1  ON 0
ci_0002                 6.927483e-01 3 1  ON 1
ci_0003                -3.099700e-02 3 1  ON 2
ci_0004                -3.009163e-02 3 1  ON 3
ci_0005                -3.060381e-02 3 1  ON 4
ci_0006                -3.069589e-02 3 1  ON 5
ci_0007                -1.338106e-02 3 1  ON 6
ci_0008                -1.335098e-02 3 1  ON 7
ci_0009                -1.869649e-02 3 1  ON 8
ci_0010                -1.813029e-02 3 1  ON 9
ci_0011                -1.474502e-02 3 1  ON 10
ci_0012                -1.451137e-02 3 1  ON 11
ci_0013                 1.529423e-02 3 1  ON 12
ci_0014                 1.480516e-02 3 1  ON 13
ci_0015                 1.574766e-02 3 1  ON 14
ci_0016                 1.538635e-02 3 1  ON 15
ci_0017                 1.336745e-02 3 1  ON 16
ci_0018                 1.303907e-02 3 1  ON 17
ci_0019                 1.308951e-02 3 1  ON 18
ci_0020                 1.266839e-02 3 1  ON 19
ci_0021                 6.752834e-03 3 1  ON 20
ci_0022                 7.460564e-03 3 1  ON 21
ci_0023                -1.180401e-02 3 1  ON 22
ci_0024                -1.147024e-02 3 1  ON 23
ci_0025                -2.029552e-03 3 1  ON 24
ci_0026                -2.390792e-03 3 1  ON 25
ci_0027                -1.213158e-02 3 1  ON 26
ci_0028                -1.154911e-02 3 1  ON 27
ci_0029                -1.065831e-02 3 1  ON 28
ci_0030                -1.058733e-02 3 1  ON 29
ci_0031                 1.340906e-02 3 1  ON 30
ci_0032                 1.211456e-02 3 1  ON 31
ci_0033                 7.848187e-03 3 1  ON 32
ci_0034                 8.489684e-03 3 1  ON 33
ci_0035                 4.859456e-03 3 1  ON 34
ci_0036                 4.933672e-03 3 1  ON 35
ci_0037                -1.133361e-02 3 1  ON 36
ci_0038                -1.131346e-02 3 1  ON 37
ci_0039                -4.015004e-03 3 1  ON 38
ci_0040                -3.886150e-03 3 1  ON 39
ci_0041                 9.104229e-03 3 1  ON 40
ci_0042                 8.780956e-03 3 1  ON 41
ci_0043                -1.307368e-02 3 1  ON 42
ci_0044                -1.384577e-02 3 1  ON 43
ci_0045                 1.059116e-02 3 1  ON 44
ci_0046                 1.007867e-02 3 1  ON 45
ci_0047                -3.585075e-03 3 1  ON 46
ci_0048                -3.481624e-03 3 1  ON 47
ci_0049                -2.594559e-03 3 1  ON 48
ci_0050                -2.695914e-03 3 1  ON 49
ci_0051                -1.797582e-03 3 1  ON 50
ci_0052                -2.016135e-03 3 1  ON 51
ci_0053                -3.931451e-03 3 1  ON 52
ci_0054                -3.323911e-03 3 1  ON 53
ci_0055                 2.398828e-03 3 1  ON 54
ci_0056                 2.269829e-03 3 1  ON 55
ci_0057                 2.453976e-03 3 1  ON 56
ci_0058                 2.857301e-03 3 1  ON 57
ci_0059                -3.395807e-03 3 1  ON 58
ci_0060                -3.375907e-03 3 1  ON 59
ci_0061                -3.976492e-03 3 1  ON 60
ci_0062                -3.922381e-03 3 1  ON 61
ci_0063                -9.802596e-03 3 1  ON 62
ci_0064                -9.372629e-03 3 1  ON 63
ci_0065                -6.435487e-03 3 1  ON 64
ci_0066                -6.132163e-03 3 1  ON 65
ci_0067                -3.748011e-03 3 1  ON 66
ci_0068                -3.479525e-03 3 1  ON 67
ci_0069                 3.569227e-03 3 1  ON 68
ci_0070                 3.348567e-03 3 1  ON 69
ci_0071                 3.005283e-03 3 1  ON 70
ci_0072                 3.481746e-03 3 1  ON 71
ci_0073                 3.552582e-03 3 1  ON 72
ci_0074                 3.528881e-03 3 1  ON 73
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 3.9785e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s064 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s064 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=64  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6902e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 64
    time step          = 0.05
    reference energy   = -16.8963
    reference variance = 0.809612
====================================================
  Execution time = 1.4212e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s064
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5231e+04
  VMC Eavg = -1.6898e+01
  VMC Evar = 2.8846e-01
  Total weights = 1.951291737e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 2.5464e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.279846975935
                                         uncertainty =       0.001404261434

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.279846975935
                                         uncertainty =       0.001404261434

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000374052305
  error estimate for blocks of size 2^( 2) =       0.000390986282
  error estimate for blocks of size 2^( 3) =       0.000408233199
  error estimate for blocks of size 2^( 4) =       0.000422951306
  error estimate for blocks of size 2^( 5) =       0.000434135893
  error estimate for blocks of size 2^( 6) =       0.000441416885
  error estimate for blocks of size 2^( 7) =       0.000445691625

      target function =      -0.930828440206
              le_mean =     -16.898318985775
             les_mean =     285.841643156747
             stat err =       0.000436048927
             autocorr =       1.358957185293
   target nu stat err =       0.000436048927
   target dn stat err =       0.001935997536
      target stat err =       0.003162992988
              std dev =       0.528989842799
             le_variance =       0.279830253784


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.689831898577e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 74
Check correct_vf_var_size: 225, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 8.8818e+04, overlap shift 8.8818e+05 and omega -1.7444e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.930837793628       residual = 4.21e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.930837793852       residual = 6.14e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.930837793893       residual = 2.37e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.930837793916       residual = 1.35e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.930837793907       residual = 4.87e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.930837794052       residual = 2.86e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.930837793934       residual = 1.56e-05           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.930837793942       residual = 1.57e-05           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.930837793943       residual = 1.90e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.930837794156       residual = 1.22e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.930837793887       residual = 6.26e-06           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.930837793762       residual = 2.75e-06           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.930837793903       residual = 1.03e-06           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.930837793812       residual = 3.64e-07           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.930837794124       residual = 1.11e-07           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.930837793908       residual = 3.77e-08           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.930837794060       residual = 9.48e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         16 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 8.8818e+04 is 2.993675e-09

solving harmonic davidson linear method for identity shift 3.5527e+05, overlap shift 3.5527e+06 and omega -1.7444e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.930837793628       residual = 4.21e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.930837793684       residual = 6.14e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.930837793694       residual = 2.37e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.930837793706       residual = 1.35e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.930837793723       residual = 4.87e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.930837793064       residual = 2.86e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.930837793355       residual = 1.56e-05           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.930837794311       residual = 1.57e-05           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.930837793516       residual = 1.90e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.930837794276       residual = 1.22e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.930837793808       residual = 6.26e-06           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.930837792715       residual = 2.75e-06           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.930837793487       residual = 1.03e-06           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.930837794696       residual = 3.64e-07           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.930837793240       residual = 1.11e-07           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.930837793091       residual = 3.77e-08           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.930837794407       residual = 9.48e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         16 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 3.5527e+05 is 7.484188e-10

solving harmonic davidson linear method for identity shift 1.4211e+06, overlap shift 1.4211e+07 and omega -1.7444e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.930837793628       residual = 4.21e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.930837793642       residual = 6.14e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.930837793644       residual = 2.37e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.930837792343       residual = 1.35e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.930837793472       residual = 4.87e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.930837794007       residual = 2.86e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.930837793741       residual = 1.56e-05           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.930837794066       residual = 1.57e-05           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.930837795004       residual = 1.90e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.930837794757       residual = 1.22e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.930837790630       residual = 6.26e-06           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.930837794848       residual = 2.75e-06           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.930837797716       residual = 1.03e-06           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.930837797471       residual = 3.64e-07           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.930837797100       residual = 1.11e-07           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.930837794792       residual = 3.77e-08           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.930837794440       residual = 9.48e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         16 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 1.4211e+06 is 1.871048e-10

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.775254 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 75 and numParams is: 74

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.6773e+01
  </log>
  <optVariables href="H2O.s064.opt.xml">
ci_0001                 7.086064e-01 3 1  ON 0
ci_0002                 6.927483e-01 3 1  ON 1
ci_0003                -3.099700e-02 3 1  ON 2
ci_0004                -3.009163e-02 3 1  ON 3
ci_0005                -3.060381e-02 3 1  ON 4
ci_0006                -3.069589e-02 3 1  ON 5
ci_0007                -1.338106e-02 3 1  ON 6
ci_0008                -1.335098e-02 3 1  ON 7
ci_0009                -1.869649e-02 3 1  ON 8
ci_0010                -1.813029e-02 3 1  ON 9
ci_0011                -1.474502e-02 3 1  ON 10
ci_0012                -1.451137e-02 3 1  ON 11
ci_0013                 1.529423e-02 3 1  ON 12
ci_0014                 1.480516e-02 3 1  ON 13
ci_0015                 1.574766e-02 3 1  ON 14
ci_0016                 1.538635e-02 3 1  ON 15
ci_0017                 1.336745e-02 3 1  ON 16
ci_0018                 1.303907e-02 3 1  ON 17
ci_0019                 1.308951e-02 3 1  ON 18
ci_0020                 1.266839e-02 3 1  ON 19
ci_0021                 6.752834e-03 3 1  ON 20
ci_0022                 7.460564e-03 3 1  ON 21
ci_0023                -1.180401e-02 3 1  ON 22
ci_0024                -1.147024e-02 3 1  ON 23
ci_0025                -2.029552e-03 3 1  ON 24
ci_0026                -2.390792e-03 3 1  ON 25
ci_0027                -1.213158e-02 3 1  ON 26
ci_0028                -1.154911e-02 3 1  ON 27
ci_0029                -1.065831e-02 3 1  ON 28
ci_0030                -1.058733e-02 3 1  ON 29
ci_0031                 1.340906e-02 3 1  ON 30
ci_0032                 1.211456e-02 3 1  ON 31
ci_0033                 7.848187e-03 3 1  ON 32
ci_0034                 8.489683e-03 3 1  ON 33
ci_0035                 4.859456e-03 3 1  ON 34
ci_0036                 4.933672e-03 3 1  ON 35
ci_0037                -1.133361e-02 3 1  ON 36
ci_0038                -1.131346e-02 3 1  ON 37
ci_0039                -4.015004e-03 3 1  ON 38
ci_0040                -3.886150e-03 3 1  ON 39
ci_0041                 9.104229e-03 3 1  ON 40
ci_0042                 8.780956e-03 3 1  ON 41
ci_0043                -1.307368e-02 3 1  ON 42
ci_0044                -1.384578e-02 3 1  ON 43
ci_0045                 1.059116e-02 3 1  ON 44
ci_0046                 1.007867e-02 3 1  ON 45
ci_0047                -3.585075e-03 3 1  ON 46
ci_0048                -3.481624e-03 3 1  ON 47
ci_0049                -2.594559e-03 3 1  ON 48
ci_0050                -2.695914e-03 3 1  ON 49
ci_0051                -1.797582e-03 3 1  ON 50
ci_0052                -2.016135e-03 3 1  ON 51
ci_0053                -3.931451e-03 3 1  ON 52
ci_0054                -3.323911e-03 3 1  ON 53
ci_0055                 2.398828e-03 3 1  ON 54
ci_0056                 2.269830e-03 3 1  ON 55
ci_0057                 2.453976e-03 3 1  ON 56
ci_0058                 2.857301e-03 3 1  ON 57
ci_0059                -3.395807e-03 3 1  ON 58
ci_0060                -3.375907e-03 3 1  ON 59
ci_0061                -3.976492e-03 3 1  ON 60
ci_0062                -3.922381e-03 3 1  ON 61
ci_0063                -9.802596e-03 3 1  ON 62
ci_0064                -9.372629e-03 3 1  ON 63
ci_0065                -6.435487e-03 3 1  ON 64
ci_0066                -6.132163e-03 3 1  ON 65
ci_0067                -3.748011e-03 3 1  ON 66
ci_0068                -3.479525e-03 3 1  ON 67
ci_0069                 3.569227e-03 3 1  ON 68
ci_0070                 3.348567e-03 3 1  ON 69
ci_0071                 3.005283e-03 3 1  ON 70
ci_0072                 3.481747e-03 3 1  ON 71
ci_0073                 3.552582e-03 3 1  ON 72
ci_0074                 3.528881e-03 3 1  ON 73
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 64
    time step          = 0.05
    reference energy   = -16.9255
    reference variance = 0.22134
====================================================
  Execution time = 1.3890e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s064
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6898e+01
  VMC Evar = 2.9737e-01
  Total weights = 1.9508e+06
  Execution time = 1.8762e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.285652507976
                                         uncertainty =       0.003706509311

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.285652507976
                                         uncertainty =       0.003706509311

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000377947312
  error estimate for blocks of size 2^( 2) =       0.000394988706
  error estimate for blocks of size 2^( 3) =       0.000412876845
  error estimate for blocks of size 2^( 4) =       0.000429177341
  error estimate for blocks of size 2^( 5) =       0.000441353822
  error estimate for blocks of size 2^( 6) =       0.000449488272
  error estimate for blocks of size 2^( 7) =       0.000455054346

      target function =      -0.916841144429
              le_mean =     -16.898335153771
             les_mean =     285.851103334414
             stat err =       0.000443768445
             autocorr =       1.378638219623
   target nu stat err =       0.000443768445
   target dn stat err =       0.004624142001
      target stat err =       0.007163382438
              std dev =       0.534498214577
             le_variance =       0.285688341386

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.285652507843
                                         uncertainty =       0.003706509350

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.285652507843
                                         uncertainty =       0.003706509350

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000377947312
  error estimate for blocks of size 2^( 2) =       0.000394988706
  error estimate for blocks of size 2^( 3) =       0.000412876845
  error estimate for blocks of size 2^( 4) =       0.000429177341
  error estimate for blocks of size 2^( 5) =       0.000441353822
  error estimate for blocks of size 2^( 6) =       0.000449488272
  error estimate for blocks of size 2^( 7) =       0.000455054346

      target function =      -0.916841367393
              le_mean =     -16.898335153768
             les_mean =     285.851103189764
             stat err =       0.000443768445
             autocorr =       1.378638220514
   target nu stat err =       0.000443768445
   target dn stat err =       0.004624131596
      target stat err =       0.007163369958
              std dev =       0.534498214454
             le_variance =       0.285688341255

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.285652507910
                                         uncertainty =       0.003706509330

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.285652507910
                                         uncertainty =       0.003706509330

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000377947312
  error estimate for blocks of size 2^( 2) =       0.000394988706
  error estimate for blocks of size 2^( 3) =       0.000412876845
  error estimate for blocks of size 2^( 4) =       0.000429177341
  error estimate for blocks of size 2^( 5) =       0.000441353822
  error estimate for blocks of size 2^( 6) =       0.000449488272
  error estimate for blocks of size 2^( 7) =       0.000455054346

      target function =      -0.916841255929
              le_mean =     -16.898335153769
             les_mean =     285.851103262077
             stat err =       0.000443768445
             autocorr =       1.378638220067
   target nu stat err =       0.000443768445
   target dn stat err =       0.004624136797
      target stat err =       0.007163376196
              std dev =       0.534498214516
             le_variance =       0.285688341320

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.285652507968
                                         uncertainty =       0.003706509313

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.285652507968
                                         uncertainty =       0.003706509313

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000377947312
  error estimate for blocks of size 2^( 2) =       0.000394988706
  error estimate for blocks of size 2^( 3) =       0.000412876845
  error estimate for blocks of size 2^( 4) =       0.000429177341
  error estimate for blocks of size 2^( 5) =       0.000441353822
  error estimate for blocks of size 2^( 6) =       0.000449488272
  error estimate for blocks of size 2^( 7) =       0.000455054346

      target function =      -0.916841158368
              le_mean =     -16.898335153770
             les_mean =     285.851103325371
             stat err =       0.000443768445
             autocorr =       1.378638219685
   target nu stat err =       0.000443768445
   target dn stat err =       0.004624141351
      target stat err =       0.007163381658
              std dev =       0.534498214569
             le_variance =       0.285688341378


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.916841144429        initial
     8.8818e+04     8.8818e+05             2.9937e-09        -0.916841367393  <--
     3.5527e+05     3.5527e+06             7.4842e-10        -0.916841255929
     1.4211e+06     1.4211e+07             1.8710e-10        -0.916841158368

*****************************************************************************
Applying the update for shift_i =   8.8818e+04     and shift_s =   8.8818e+05
*****************************************************************************

  Execution time = 2.3347e+01
  </log>
  <optVariables href="H2O.s064.opt.xml">
ci_0001                 7.086064e-01 3 1  ON 0
ci_0002                 6.927483e-01 3 1  ON 1
ci_0003                -3.099700e-02 3 1  ON 2
ci_0004                -3.009163e-02 3 1  ON 3
ci_0005                -3.060381e-02 3 1  ON 4
ci_0006                -3.069589e-02 3 1  ON 5
ci_0007                -1.338106e-02 3 1  ON 6
ci_0008                -1.335098e-02 3 1  ON 7
ci_0009                -1.869649e-02 3 1  ON 8
ci_0010                -1.813029e-02 3 1  ON 9
ci_0011                -1.474502e-02 3 1  ON 10
ci_0012                -1.451137e-02 3 1  ON 11
ci_0013                 1.529423e-02 3 1  ON 12
ci_0014                 1.480516e-02 3 1  ON 13
ci_0015                 1.574765e-02 3 1  ON 14
ci_0016                 1.538635e-02 3 1  ON 15
ci_0017                 1.336745e-02 3 1  ON 16
ci_0018                 1.303907e-02 3 1  ON 17
ci_0019                 1.308951e-02 3 1  ON 18
ci_0020                 1.266839e-02 3 1  ON 19
ci_0021                 6.752833e-03 3 1  ON 20
ci_0022                 7.460564e-03 3 1  ON 21
ci_0023                -1.180401e-02 3 1  ON 22
ci_0024                -1.147024e-02 3 1  ON 23
ci_0025                -2.029552e-03 3 1  ON 24
ci_0026                -2.390792e-03 3 1  ON 25
ci_0027                -1.213158e-02 3 1  ON 26
ci_0028                -1.154911e-02 3 1  ON 27
ci_0029                -1.065831e-02 3 1  ON 28
ci_0030                -1.058733e-02 3 1  ON 29
ci_0031                 1.340906e-02 3 1  ON 30
ci_0032                 1.211456e-02 3 1  ON 31
ci_0033                 7.848187e-03 3 1  ON 32
ci_0034                 8.489683e-03 3 1  ON 33
ci_0035                 4.859456e-03 3 1  ON 34
ci_0036                 4.933672e-03 3 1  ON 35
ci_0037                -1.133361e-02 3 1  ON 36
ci_0038                -1.131346e-02 3 1  ON 37
ci_0039                -4.015003e-03 3 1  ON 38
ci_0040                -3.886150e-03 3 1  ON 39
ci_0041                 9.104230e-03 3 1  ON 40
ci_0042                 8.780955e-03 3 1  ON 41
ci_0043                -1.307368e-02 3 1  ON 42
ci_0044                -1.384578e-02 3 1  ON 43
ci_0045                 1.059116e-02 3 1  ON 44
ci_0046                 1.007867e-02 3 1  ON 45
ci_0047                -3.585076e-03 3 1  ON 46
ci_0048                -3.481624e-03 3 1  ON 47
ci_0049                -2.594559e-03 3 1  ON 48
ci_0050                -2.695914e-03 3 1  ON 49
ci_0051                -1.797582e-03 3 1  ON 50
ci_0052                -2.016135e-03 3 1  ON 51
ci_0053                -3.931451e-03 3 1  ON 52
ci_0054                -3.323910e-03 3 1  ON 53
ci_0055                 2.398827e-03 3 1  ON 54
ci_0056                 2.269830e-03 3 1  ON 55
ci_0057                 2.453975e-03 3 1  ON 56
ci_0058                 2.857300e-03 3 1  ON 57
ci_0059                -3.395807e-03 3 1  ON 58
ci_0060                -3.375906e-03 3 1  ON 59
ci_0061                -3.976492e-03 3 1  ON 60
ci_0062                -3.922381e-03 3 1  ON 61
ci_0063                -9.802596e-03 3 1  ON 62
ci_0064                -9.372628e-03 3 1  ON 63
ci_0065                -6.435487e-03 3 1  ON 64
ci_0066                -6.132163e-03 3 1  ON 65
ci_0067                -3.748011e-03 3 1  ON 66
ci_0068                -3.479524e-03 3 1  ON 67
ci_0069                 3.569227e-03 3 1  ON 68
ci_0070                 3.348567e-03 3 1  ON 69
ci_0071                 3.005282e-03 3 1  ON 70
ci_0072                 3.481747e-03 3 1  ON 71
ci_0073                 3.552582e-03 3 1  ON 72
ci_0074                 3.528881e-03 3 1  ON 73
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 4.0126e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s065 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s065 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=65  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6902e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 65
    time step          = 0.05
    reference energy   = -16.8194
    reference variance = 0.262794
====================================================
  Execution time = 1.4020e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s065
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5251e+04
  VMC Eavg = -1.6899e+01
  VMC Evar = 2.9340e-01
  Total weights = 1.950978290e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 2.5492e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.284388496034
                                         uncertainty =       0.001514684826

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.284388496034
                                         uncertainty =       0.001514684826

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000377066222
  error estimate for blocks of size 2^( 2) =       0.000394254618
  error estimate for blocks of size 2^( 3) =       0.000411877354
  error estimate for blocks of size 2^( 4) =       0.000427175195
  error estimate for blocks of size 2^( 5) =       0.000439279097
  error estimate for blocks of size 2^( 6) =       0.000447630851
  error estimate for blocks of size 2^( 7) =       0.000451145788

      target function =      -0.923060013467
              le_mean =     -16.898864278929
             les_mean =     285.865008946773
             stat err =       0.000441307733
             autocorr =       1.369770524792
   target nu stat err =       0.000441307733
   target dn stat err =       0.002087334581
      target stat err =       0.003347252598
              std dev =       0.533252164364
             le_variance =       0.284357870799


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.689886427893e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 74
Check correct_vf_var_size: 225, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.2204e+04, overlap shift 2.2204e+05 and omega -1.7444e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.923070664188       residual = 5.97e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.923070665380       residual = 9.98e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.923070665575       residual = 2.33e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.923070665625       residual = 8.12e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.923070665653       residual = 2.41e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.923070665649       residual = 1.29e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.923070665651       residual = 3.25e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.923070665645       residual = 2.08e-06           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.923070665688       residual = 2.87e-06           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.923070665710       residual = 2.32e-06           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.923070665683       residual = 2.39e-06           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.923070665632       residual = 8.52e-07           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.923070665709       residual = 4.61e-07           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.923070665606       residual = 1.19e-07           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.923070665602       residual = 5.38e-08           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.923070665605       residual = 1.38e-08           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.923070665631       residual = 3.06e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         16 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 2.2204e+04 is 5.720810e-09

solving harmonic davidson linear method for identity shift 8.8818e+04, overlap shift 8.8818e+05 and omega -1.7444e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.923070664188       residual = 5.97e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.923070664486       residual = 9.98e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.923070664535       residual = 2.33e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.923070664547       residual = 8.12e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.923070664551       residual = 2.41e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.923070664553       residual = 1.29e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.923070664310       residual = 3.25e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.923070664648       residual = 2.08e-06           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.923070664553       residual = 2.87e-06           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.923070664331       residual = 2.32e-06           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.923070664584       residual = 2.39e-06           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.923070664554       residual = 8.52e-07           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.923070664566       residual = 4.61e-07           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.923070664349       residual = 1.19e-07           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.923070664733       residual = 5.38e-08           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.923070664423       residual = 1.38e-08           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.923070664366       residual = 3.06e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         16 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 8.8818e+04 is 1.430205e-09

solving harmonic davidson linear method for identity shift 3.5527e+05, overlap shift 3.5527e+06 and omega -1.7444e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.923070664188       residual = 5.97e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.923070664262       residual = 9.98e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.923070664275       residual = 2.33e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.923070664278       residual = 8.12e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.923070664279       residual = 2.41e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.923070664279       residual = 1.29e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.923070663576       residual = 3.25e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.923070664279       residual = 2.08e-06           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.923070663838       residual = 2.87e-06           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.923070664565       residual = 2.32e-06           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.923070664764       residual = 2.39e-06           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.923070664279       residual = 8.52e-07           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.923070664279       residual = 4.61e-07           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.923070664279       residual = 1.19e-07           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.923070664095       residual = 5.38e-08           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.923070664279       residual = 1.38e-08           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.923070663938       residual = 3.06e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         16 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 3.5527e+05 is 3.575513e-10

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.784303 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 75 and numParams is: 74

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.6584e+01
  </log>
  <optVariables href="H2O.s065.opt.xml">
ci_0001                 7.086064e-01 3 1  ON 0
ci_0002                 6.927483e-01 3 1  ON 1
ci_0003                -3.099700e-02 3 1  ON 2
ci_0004                -3.009163e-02 3 1  ON 3
ci_0005                -3.060381e-02 3 1  ON 4
ci_0006                -3.069589e-02 3 1  ON 5
ci_0007                -1.338106e-02 3 1  ON 6
ci_0008                -1.335098e-02 3 1  ON 7
ci_0009                -1.869649e-02 3 1  ON 8
ci_0010                -1.813029e-02 3 1  ON 9
ci_0011                -1.474502e-02 3 1  ON 10
ci_0012                -1.451137e-02 3 1  ON 11
ci_0013                 1.529423e-02 3 1  ON 12
ci_0014                 1.480516e-02 3 1  ON 13
ci_0015                 1.574765e-02 3 1  ON 14
ci_0016                 1.538635e-02 3 1  ON 15
ci_0017                 1.336745e-02 3 1  ON 16
ci_0018                 1.303907e-02 3 1  ON 17
ci_0019                 1.308951e-02 3 1  ON 18
ci_0020                 1.266839e-02 3 1  ON 19
ci_0021                 6.752833e-03 3 1  ON 20
ci_0022                 7.460562e-03 3 1  ON 21
ci_0023                -1.180401e-02 3 1  ON 22
ci_0024                -1.147024e-02 3 1  ON 23
ci_0025                -2.029552e-03 3 1  ON 24
ci_0026                -2.390790e-03 3 1  ON 25
ci_0027                -1.213158e-02 3 1  ON 26
ci_0028                -1.154911e-02 3 1  ON 27
ci_0029                -1.065831e-02 3 1  ON 28
ci_0030                -1.058733e-02 3 1  ON 29
ci_0031                 1.340905e-02 3 1  ON 30
ci_0032                 1.211456e-02 3 1  ON 31
ci_0033                 7.848188e-03 3 1  ON 32
ci_0034                 8.489682e-03 3 1  ON 33
ci_0035                 4.859455e-03 3 1  ON 34
ci_0036                 4.933672e-03 3 1  ON 35
ci_0037                -1.133361e-02 3 1  ON 36
ci_0038                -1.131346e-02 3 1  ON 37
ci_0039                -4.015003e-03 3 1  ON 38
ci_0040                -3.886150e-03 3 1  ON 39
ci_0041                 9.104231e-03 3 1  ON 40
ci_0042                 8.780956e-03 3 1  ON 41
ci_0043                -1.307368e-02 3 1  ON 42
ci_0044                -1.384578e-02 3 1  ON 43
ci_0045                 1.059116e-02 3 1  ON 44
ci_0046                 1.007867e-02 3 1  ON 45
ci_0047                -3.585076e-03 3 1  ON 46
ci_0048                -3.481624e-03 3 1  ON 47
ci_0049                -2.594558e-03 3 1  ON 48
ci_0050                -2.695914e-03 3 1  ON 49
ci_0051                -1.797581e-03 3 1  ON 50
ci_0052                -2.016135e-03 3 1  ON 51
ci_0053                -3.931450e-03 3 1  ON 52
ci_0054                -3.323911e-03 3 1  ON 53
ci_0055                 2.398827e-03 3 1  ON 54
ci_0056                 2.269830e-03 3 1  ON 55
ci_0057                 2.453975e-03 3 1  ON 56
ci_0058                 2.857299e-03 3 1  ON 57
ci_0059                -3.395807e-03 3 1  ON 58
ci_0060                -3.375906e-03 3 1  ON 59
ci_0061                -3.976491e-03 3 1  ON 60
ci_0062                -3.922381e-03 3 1  ON 61
ci_0063                -9.802596e-03 3 1  ON 62
ci_0064                -9.372629e-03 3 1  ON 63
ci_0065                -6.435487e-03 3 1  ON 64
ci_0066                -6.132163e-03 3 1  ON 65
ci_0067                -3.748011e-03 3 1  ON 66
ci_0068                -3.479525e-03 3 1  ON 67
ci_0069                 3.569227e-03 3 1  ON 68
ci_0070                 3.348567e-03 3 1  ON 69
ci_0071                 3.005283e-03 3 1  ON 70
ci_0072                 3.481747e-03 3 1  ON 71
ci_0073                 3.552581e-03 3 1  ON 72
ci_0074                 3.528881e-03 3 1  ON 73
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 65
    time step          = 0.05
    reference energy   = -16.9418
    reference variance = 0.141019
====================================================
  Execution time = 1.3775e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s065
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6898e+01
  VMC Evar = 2.9245e-01
  Total weights = 1.9507e+06
  Execution time = 1.8782e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.282617110595
                                         uncertainty =       0.002689953879

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.282617110595
                                         uncertainty =       0.002689953879

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000375899831
  error estimate for blocks of size 2^( 2) =       0.000392950422
  error estimate for blocks of size 2^( 3) =       0.000409896166
  error estimate for blocks of size 2^( 4) =       0.000424637215
  error estimate for blocks of size 2^( 5) =       0.000435456967
  error estimate for blocks of size 2^( 6) =       0.000443889936
  error estimate for blocks of size 2^( 7) =       0.000448865903

      target function =      -0.924507506142
              le_mean =     -16.898010611568
             les_mean =     285.835216846682
             stat err =       0.000438212505
             autocorr =       1.359018198854
   target nu stat err =       0.000438212505
   target dn stat err =       0.003031891892
      target stat err =       0.004804387038
              std dev =       0.531602639256
             le_variance =       0.282601366064

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.282617109990
                                         uncertainty =       0.002689953798

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.282617109990
                                         uncertainty =       0.002689953798

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000375899831
  error estimate for blocks of size 2^( 2) =       0.000392950421
  error estimate for blocks of size 2^( 3) =       0.000409896166
  error estimate for blocks of size 2^( 4) =       0.000424637215
  error estimate for blocks of size 2^( 5) =       0.000435456967
  error estimate for blocks of size 2^( 6) =       0.000443889936
  error estimate for blocks of size 2^( 7) =       0.000448865902

      target function =      -0.924507517450
              le_mean =     -16.898010611487
             les_mean =     285.835216836738
             stat err =       0.000438212505
             autocorr =       1.359018199364
   target nu stat err =       0.000438212505
   target dn stat err =       0.003031890027
      target stat err =       0.004804384268
              std dev =       0.531602638683
             le_variance =       0.282601365455

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.282617110292
                                         uncertainty =       0.002689953838

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.282617110292
                                         uncertainty =       0.002689953838

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000375899831
  error estimate for blocks of size 2^( 2) =       0.000392950422
  error estimate for blocks of size 2^( 3) =       0.000409896166
  error estimate for blocks of size 2^( 4) =       0.000424637215
  error estimate for blocks of size 2^( 5) =       0.000435456967
  error estimate for blocks of size 2^( 6) =       0.000443889936
  error estimate for blocks of size 2^( 7) =       0.000448865902

      target function =      -0.924507511796
              le_mean =     -16.898010611527
             les_mean =     285.835216841710
             stat err =       0.000438212505
             autocorr =       1.359018199109
   target nu stat err =       0.000438212505
   target dn stat err =       0.003031890959
      target stat err =       0.004804385653
              std dev =       0.531602638969
             le_variance =       0.282601365759

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.282617110557
                                         uncertainty =       0.002689953874

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.282617110557
                                         uncertainty =       0.002689953874

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000375899831
  error estimate for blocks of size 2^( 2) =       0.000392950422
  error estimate for blocks of size 2^( 3) =       0.000409896166
  error estimate for blocks of size 2^( 4) =       0.000424637215
  error estimate for blocks of size 2^( 5) =       0.000435456967
  error estimate for blocks of size 2^( 6) =       0.000443889936
  error estimate for blocks of size 2^( 7) =       0.000448865903

      target function =      -0.924507506849
              le_mean =     -16.898010611563
             les_mean =     285.835216846061
             stat err =       0.000438212505
             autocorr =       1.359018198889
   target nu stat err =       0.000438212505
   target dn stat err =       0.003031891776
      target stat err =       0.004804386865
              std dev =       0.531602639220
             le_variance =       0.282601366025


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.924507506142        initial
     2.2204e+04     2.2204e+05             5.7208e-09        -0.924507517450  <--
     8.8818e+04     8.8818e+05             1.4302e-09        -0.924507511796
     3.5527e+05     3.5527e+06             3.5755e-10        -0.924507506849

*****************************************************************************
Applying the update for shift_i =   2.2204e+04     and shift_s =   2.2204e+05
*****************************************************************************

  Execution time = 2.3452e+01
  </log>
  <optVariables href="H2O.s065.opt.xml">
ci_0001                 7.086064e-01 3 1  ON 0
ci_0002                 6.927483e-01 3 1  ON 1
ci_0003                -3.099700e-02 3 1  ON 2
ci_0004                -3.009163e-02 3 1  ON 3
ci_0005                -3.060381e-02 3 1  ON 4
ci_0006                -3.069589e-02 3 1  ON 5
ci_0007                -1.338106e-02 3 1  ON 6
ci_0008                -1.335098e-02 3 1  ON 7
ci_0009                -1.869649e-02 3 1  ON 8
ci_0010                -1.813029e-02 3 1  ON 9
ci_0011                -1.474502e-02 3 1  ON 10
ci_0012                -1.451136e-02 3 1  ON 11
ci_0013                 1.529423e-02 3 1  ON 12
ci_0014                 1.480516e-02 3 1  ON 13
ci_0015                 1.574765e-02 3 1  ON 14
ci_0016                 1.538635e-02 3 1  ON 15
ci_0017                 1.336745e-02 3 1  ON 16
ci_0018                 1.303907e-02 3 1  ON 17
ci_0019                 1.308951e-02 3 1  ON 18
ci_0020                 1.266839e-02 3 1  ON 19
ci_0021                 6.752832e-03 3 1  ON 20
ci_0022                 7.460559e-03 3 1  ON 21
ci_0023                -1.180401e-02 3 1  ON 22
ci_0024                -1.147024e-02 3 1  ON 23
ci_0025                -2.029553e-03 3 1  ON 24
ci_0026                -2.390786e-03 3 1  ON 25
ci_0027                -1.213157e-02 3 1  ON 26
ci_0028                -1.154911e-02 3 1  ON 27
ci_0029                -1.065831e-02 3 1  ON 28
ci_0030                -1.058733e-02 3 1  ON 29
ci_0031                 1.340905e-02 3 1  ON 30
ci_0032                 1.211456e-02 3 1  ON 31
ci_0033                 7.848190e-03 3 1  ON 32
ci_0034                 8.489682e-03 3 1  ON 33
ci_0035                 4.859454e-03 3 1  ON 34
ci_0036                 4.933670e-03 3 1  ON 35
ci_0037                -1.133361e-02 3 1  ON 36
ci_0038                -1.131346e-02 3 1  ON 37
ci_0039                -4.015001e-03 3 1  ON 38
ci_0040                -3.886151e-03 3 1  ON 39
ci_0041                 9.104233e-03 3 1  ON 40
ci_0042                 8.780957e-03 3 1  ON 41
ci_0043                -1.307368e-02 3 1  ON 42
ci_0044                -1.384578e-02 3 1  ON 43
ci_0045                 1.059115e-02 3 1  ON 44
ci_0046                 1.007868e-02 3 1  ON 45
ci_0047                -3.585076e-03 3 1  ON 46
ci_0048                -3.481624e-03 3 1  ON 47
ci_0049                -2.594557e-03 3 1  ON 48
ci_0050                -2.695914e-03 3 1  ON 49
ci_0051                -1.797579e-03 3 1  ON 50
ci_0052                -2.016135e-03 3 1  ON 51
ci_0053                -3.931448e-03 3 1  ON 52
ci_0054                -3.323912e-03 3 1  ON 53
ci_0055                 2.398827e-03 3 1  ON 54
ci_0056                 2.269829e-03 3 1  ON 55
ci_0057                 2.453974e-03 3 1  ON 56
ci_0058                 2.857295e-03 3 1  ON 57
ci_0059                -3.395809e-03 3 1  ON 58
ci_0060                -3.375905e-03 3 1  ON 59
ci_0061                -3.976489e-03 3 1  ON 60
ci_0062                -3.922380e-03 3 1  ON 61
ci_0063                -9.802596e-03 3 1  ON 62
ci_0064                -9.372629e-03 3 1  ON 63
ci_0065                -6.435488e-03 3 1  ON 64
ci_0066                -6.132163e-03 3 1  ON 65
ci_0067                -3.748011e-03 3 1  ON 66
ci_0068                -3.479525e-03 3 1  ON 67
ci_0069                 3.569228e-03 3 1  ON 68
ci_0070                 3.348568e-03 3 1  ON 69
ci_0071                 3.005285e-03 3 1  ON 70
ci_0072                 3.481746e-03 3 1  ON 71
ci_0073                 3.552581e-03 3 1  ON 72
ci_0074                 3.528881e-03 3 1  ON 73
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 4.0058e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s066 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s066 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=66  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6902e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 66
    time step          = 0.05
    reference energy   = -16.9786
    reference variance = 0.211535
====================================================
  Execution time = 1.4175e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s066
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5233e+04
  VMC Eavg = -1.6899e+01
  VMC Evar = 2.9503e-01
  Total weights = 1.950966020e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 2.5570e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.282655554455
                                         uncertainty =       0.002042017328

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.282655554455
                                         uncertainty =       0.002042017328

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000375946813
  error estimate for blocks of size 2^( 2) =       0.000393466796
  error estimate for blocks of size 2^( 3) =       0.000410997504
  error estimate for blocks of size 2^( 4) =       0.000426284946
  error estimate for blocks of size 2^( 5) =       0.000437548911
  error estimate for blocks of size 2^( 6) =       0.000443889907
  error estimate for blocks of size 2^( 7) =       0.000447645615

      target function =      -0.920478496378
              le_mean =     -16.899131596441
             les_mean =     285.875679895166
             stat err =       0.000438842345
             autocorr =       1.362586994424
   target nu stat err =       0.000438842345
   target dn stat err =       0.004076346569
      target stat err =       0.006382787998
              std dev =       0.531669081269
             le_variance =       0.282672011977


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.689913159644e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 74
Check correct_vf_var_size: 225, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 5.5511e+03, overlap shift 5.5511e+04 and omega -1.7444e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.920521676483       residual = 6.10e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.920521707848       residual = 1.49e-02           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.920521716161       residual = 1.55e-03           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.920521717704       residual = 6.39e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.920521718651       residual = 3.37e-04           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.920521719256       residual = 1.21e-04           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.920521719390       residual = 5.56e-05           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.920521719445       residual = 2.14e-05           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.920521719480       residual = 8.84e-06           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.920521719512       residual = 7.55e-06           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.920521719527       residual = 5.24e-06           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.920521719518       residual = 5.19e-06           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.920521719516       residual = 2.93e-06           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.920521719547       residual = 2.00e-06           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.920521719539       residual = 7.54e-07           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.920521719531       residual = 2.30e-07           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.920521719536       residual = 6.75e-08           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.920521719546       residual = 1.29e-08           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.920521719541       residual = 6.80e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         18 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 5.5511e+03 is 6.685477e-08

solving harmonic davidson linear method for identity shift 2.2204e+04, overlap shift 2.2204e+05 and omega -1.7444e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.920521676483       residual = 6.10e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.920521684324       residual = 1.49e-02           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.920521686403       residual = 1.55e-03           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.920521686789       residual = 6.39e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.920521687031       residual = 3.37e-04           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.920521687178       residual = 1.21e-04           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.920521687234       residual = 5.56e-05           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.920521687213       residual = 2.14e-05           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.920521687222       residual = 8.84e-06           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.920521687239       residual = 7.55e-06           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.920521687214       residual = 5.24e-06           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.920521687217       residual = 5.19e-06           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.920521687314       residual = 2.93e-06           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.920521687209       residual = 2.00e-06           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.920521687280       residual = 7.54e-07           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.920521687266       residual = 2.30e-07           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.920521687259       residual = 6.75e-08           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.920521687356       residual = 1.29e-08           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.920521687206       residual = 6.80e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         18 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 2.2204e+04 is 1.671388e-08

solving harmonic davidson linear method for identity shift 8.8818e+04, overlap shift 8.8818e+05 and omega -1.7444e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.920521676483       residual = 6.10e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.920521678443       residual = 1.49e-02           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.920521678963       residual = 1.55e-03           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.920521679060       residual = 6.39e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.920521679119       residual = 3.37e-04           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.920521679111       residual = 1.21e-04           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.920521679151       residual = 5.56e-05           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.920521679205       residual = 2.14e-05           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.920521679163       residual = 8.84e-06           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.920521679128       residual = 7.55e-06           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.920521679129       residual = 5.24e-06           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.920521679195       residual = 5.19e-06           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.920521679136       residual = 2.93e-06           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.920521679189       residual = 2.00e-06           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.920521678889       residual = 7.54e-07           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.920521679363       residual = 2.30e-07           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.920521679171       residual = 6.75e-08           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.920521679006       residual = 1.29e-08           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.920521679227       residual = 6.80e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         18 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 8.8818e+04 is 4.178481e-09

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.795599 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 75 and numParams is: 74

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.6748e+01
  </log>
  <optVariables href="H2O.s066.opt.xml">
ci_0001                 7.086064e-01 3 1  ON 0
ci_0002                 6.927484e-01 3 1  ON 1
ci_0003                -3.099700e-02 3 1  ON 2
ci_0004                -3.009163e-02 3 1  ON 3
ci_0005                -3.060381e-02 3 1  ON 4
ci_0006                -3.069589e-02 3 1  ON 5
ci_0007                -1.338107e-02 3 1  ON 6
ci_0008                -1.335098e-02 3 1  ON 7
ci_0009                -1.869649e-02 3 1  ON 8
ci_0010                -1.813029e-02 3 1  ON 9
ci_0011                -1.474502e-02 3 1  ON 10
ci_0012                -1.451136e-02 3 1  ON 11
ci_0013                 1.529423e-02 3 1  ON 12
ci_0014                 1.480516e-02 3 1  ON 13
ci_0015                 1.574766e-02 3 1  ON 14
ci_0016                 1.538635e-02 3 1  ON 15
ci_0017                 1.336745e-02 3 1  ON 16
ci_0018                 1.303907e-02 3 1  ON 17
ci_0019                 1.308950e-02 3 1  ON 18
ci_0020                 1.266839e-02 3 1  ON 19
ci_0021                 6.752816e-03 3 1  ON 20
ci_0022                 7.460550e-03 3 1  ON 21
ci_0023                -1.180401e-02 3 1  ON 22
ci_0024                -1.147024e-02 3 1  ON 23
ci_0025                -2.029546e-03 3 1  ON 24
ci_0026                -2.390777e-03 3 1  ON 25
ci_0027                -1.213158e-02 3 1  ON 26
ci_0028                -1.154911e-02 3 1  ON 27
ci_0029                -1.065831e-02 3 1  ON 28
ci_0030                -1.058733e-02 3 1  ON 29
ci_0031                 1.340906e-02 3 1  ON 30
ci_0032                 1.211456e-02 3 1  ON 31
ci_0033                 7.848188e-03 3 1  ON 32
ci_0034                 8.489678e-03 3 1  ON 33
ci_0035                 4.859449e-03 3 1  ON 34
ci_0036                 4.933666e-03 3 1  ON 35
ci_0037                -1.133361e-02 3 1  ON 36
ci_0038                -1.131346e-02 3 1  ON 37
ci_0039                -4.015001e-03 3 1  ON 38
ci_0040                -3.886151e-03 3 1  ON 39
ci_0041                 9.104233e-03 3 1  ON 40
ci_0042                 8.780957e-03 3 1  ON 41
ci_0043                -1.307368e-02 3 1  ON 42
ci_0044                -1.384579e-02 3 1  ON 43
ci_0045                 1.059115e-02 3 1  ON 44
ci_0046                 1.007867e-02 3 1  ON 45
ci_0047                -3.585075e-03 3 1  ON 46
ci_0048                -3.481625e-03 3 1  ON 47
ci_0049                -2.594556e-03 3 1  ON 48
ci_0050                -2.695918e-03 3 1  ON 49
ci_0051                -1.797581e-03 3 1  ON 50
ci_0052                -2.016130e-03 3 1  ON 51
ci_0053                -3.931443e-03 3 1  ON 52
ci_0054                -3.323914e-03 3 1  ON 53
ci_0055                 2.398810e-03 3 1  ON 54
ci_0056                 2.269816e-03 3 1  ON 55
ci_0057                 2.453981e-03 3 1  ON 56
ci_0058                 2.857293e-03 3 1  ON 57
ci_0059                -3.395816e-03 3 1  ON 58
ci_0060                -3.375904e-03 3 1  ON 59
ci_0061                -3.976490e-03 3 1  ON 60
ci_0062                -3.922380e-03 3 1  ON 61
ci_0063                -9.802598e-03 3 1  ON 62
ci_0064                -9.372628e-03 3 1  ON 63
ci_0065                -6.435491e-03 3 1  ON 64
ci_0066                -6.132156e-03 3 1  ON 65
ci_0067                -3.748005e-03 3 1  ON 66
ci_0068                -3.479526e-03 3 1  ON 67
ci_0069                 3.569232e-03 3 1  ON 68
ci_0070                 3.348571e-03 3 1  ON 69
ci_0071                 3.005289e-03 3 1  ON 70
ci_0072                 3.481747e-03 3 1  ON 71
ci_0073                 3.552577e-03 3 1  ON 72
ci_0074                 3.528877e-03 3 1  ON 73
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 66
    time step          = 0.05
    reference energy   = -16.9571
    reference variance = 0.294689
====================================================
  Execution time = 1.3842e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s066
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6899e+01
  VMC Evar = 2.8817e-01
  Total weights = 1.9510e+06
  Execution time = 1.8724e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.279459202675
                                         uncertainty =       0.001339013535

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.279459202675
                                         uncertainty =       0.001339013535

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000373760383
  error estimate for blocks of size 2^( 2) =       0.000390813420
  error estimate for blocks of size 2^( 3) =       0.000408591471
  error estimate for blocks of size 2^( 4) =       0.000423830407
  error estimate for blocks of size 2^( 5) =       0.000434968017
  error estimate for blocks of size 2^( 6) =       0.000443410729
  error estimate for blocks of size 2^( 7) =       0.000448163486

      target function =      -0.931295803300
              le_mean =     -16.898596675140
             les_mean =     285.850738966899
             stat err =       0.000437593160
             autocorr =       1.370738203886
   target nu stat err =       0.000437593160
   target dn stat err =       0.001917602255
      target stat err =       0.003139892264
              std dev =       0.528577002674
             le_variance =       0.279393647756

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.279459189531
                                         uncertainty =       0.001339012485

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.279459189531
                                         uncertainty =       0.001339012485

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000373760374
  error estimate for blocks of size 2^( 2) =       0.000390813412
  error estimate for blocks of size 2^( 3) =       0.000408591464
  error estimate for blocks of size 2^( 4) =       0.000423830401
  error estimate for blocks of size 2^( 5) =       0.000434968009
  error estimate for blocks of size 2^( 6) =       0.000443410724
  error estimate for blocks of size 2^( 7) =       0.000448163480

      target function =      -0.931295655557
              le_mean =     -16.898596674992
             les_mean =     285.850739054783
             stat err =       0.000437593154
             autocorr =       1.370738230342
   target nu stat err =       0.000437593154
   target dn stat err =       0.001917604170
      target stat err =       0.003139894251
              std dev =       0.528576990158
             le_variance =       0.279393634525

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.279459196103
                                         uncertainty =       0.001339013010

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.279459196103
                                         uncertainty =       0.001339013010

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000373760379
  error estimate for blocks of size 2^( 2) =       0.000390813416
  error estimate for blocks of size 2^( 3) =       0.000408591467
  error estimate for blocks of size 2^( 4) =       0.000423830404
  error estimate for blocks of size 2^( 5) =       0.000434968013
  error estimate for blocks of size 2^( 6) =       0.000443410727
  error estimate for blocks of size 2^( 7) =       0.000448163483

      target function =      -0.931295729452
              le_mean =     -16.898596675066
             les_mean =     285.850739010826
             stat err =       0.000437593157
             autocorr =       1.370738217111
   target nu stat err =       0.000437593157
   target dn stat err =       0.001917603212
      target stat err =       0.003139893256
              std dev =       0.528576996416
             le_variance =       0.279393641140

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.279459201854
                                         uncertainty =       0.001339013469

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.279459201854
                                         uncertainty =       0.001339013469

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000373760382
  error estimate for blocks of size 2^( 2) =       0.000390813419
  error estimate for blocks of size 2^( 3) =       0.000408591470
  error estimate for blocks of size 2^( 4) =       0.000423830407
  error estimate for blocks of size 2^( 5) =       0.000434968016
  error estimate for blocks of size 2^( 6) =       0.000443410729
  error estimate for blocks of size 2^( 7) =       0.000448163485

      target function =      -0.931295794071
              le_mean =     -16.898596675131
             les_mean =     285.850738972388
             stat err =       0.000437593159
             autocorr =       1.370738205549
   target nu stat err =       0.000437593159
   target dn stat err =       0.001917602374
      target stat err =       0.003139892388
              std dev =       0.528577001892
             le_variance =       0.279393646929


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.931295803300        initial  <--
     5.5511e+03     5.5511e+04             6.6855e-08        -0.931295655557
     2.2204e+04     2.2204e+05             1.6714e-08        -0.931295729452
     8.8818e+04     8.8818e+05             4.1785e-09        -0.931295794071

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 23.2829
  </log>
  <optVariables href="H2O.s066.opt.xml">
ci_0001                 7.086064e-01 3 1  ON 0
ci_0002                 6.927483e-01 3 1  ON 1
ci_0003                -3.099700e-02 3 1  ON 2
ci_0004                -3.009163e-02 3 1  ON 3
ci_0005                -3.060381e-02 3 1  ON 4
ci_0006                -3.069589e-02 3 1  ON 5
ci_0007                -1.338106e-02 3 1  ON 6
ci_0008                -1.335098e-02 3 1  ON 7
ci_0009                -1.869649e-02 3 1  ON 8
ci_0010                -1.813029e-02 3 1  ON 9
ci_0011                -1.474502e-02 3 1  ON 10
ci_0012                -1.451136e-02 3 1  ON 11
ci_0013                 1.529423e-02 3 1  ON 12
ci_0014                 1.480516e-02 3 1  ON 13
ci_0015                 1.574765e-02 3 1  ON 14
ci_0016                 1.538635e-02 3 1  ON 15
ci_0017                 1.336745e-02 3 1  ON 16
ci_0018                 1.303907e-02 3 1  ON 17
ci_0019                 1.308951e-02 3 1  ON 18
ci_0020                 1.266839e-02 3 1  ON 19
ci_0021                 6.752832e-03 3 1  ON 20
ci_0022                 7.460559e-03 3 1  ON 21
ci_0023                -1.180401e-02 3 1  ON 22
ci_0024                -1.147024e-02 3 1  ON 23
ci_0025                -2.029553e-03 3 1  ON 24
ci_0026                -2.390786e-03 3 1  ON 25
ci_0027                -1.213157e-02 3 1  ON 26
ci_0028                -1.154911e-02 3 1  ON 27
ci_0029                -1.065831e-02 3 1  ON 28
ci_0030                -1.058733e-02 3 1  ON 29
ci_0031                 1.340905e-02 3 1  ON 30
ci_0032                 1.211456e-02 3 1  ON 31
ci_0033                 7.848190e-03 3 1  ON 32
ci_0034                 8.489682e-03 3 1  ON 33
ci_0035                 4.859454e-03 3 1  ON 34
ci_0036                 4.933670e-03 3 1  ON 35
ci_0037                -1.133361e-02 3 1  ON 36
ci_0038                -1.131346e-02 3 1  ON 37
ci_0039                -4.015001e-03 3 1  ON 38
ci_0040                -3.886151e-03 3 1  ON 39
ci_0041                 9.104233e-03 3 1  ON 40
ci_0042                 8.780957e-03 3 1  ON 41
ci_0043                -1.307368e-02 3 1  ON 42
ci_0044                -1.384578e-02 3 1  ON 43
ci_0045                 1.059115e-02 3 1  ON 44
ci_0046                 1.007868e-02 3 1  ON 45
ci_0047                -3.585076e-03 3 1  ON 46
ci_0048                -3.481624e-03 3 1  ON 47
ci_0049                -2.594557e-03 3 1  ON 48
ci_0050                -2.695914e-03 3 1  ON 49
ci_0051                -1.797579e-03 3 1  ON 50
ci_0052                -2.016135e-03 3 1  ON 51
ci_0053                -3.931448e-03 3 1  ON 52
ci_0054                -3.323912e-03 3 1  ON 53
ci_0055                 2.398827e-03 3 1  ON 54
ci_0056                 2.269829e-03 3 1  ON 55
ci_0057                 2.453974e-03 3 1  ON 56
ci_0058                 2.857295e-03 3 1  ON 57
ci_0059                -3.395809e-03 3 1  ON 58
ci_0060                -3.375905e-03 3 1  ON 59
ci_0061                -3.976489e-03 3 1  ON 60
ci_0062                -3.922380e-03 3 1  ON 61
ci_0063                -9.802596e-03 3 1  ON 62
ci_0064                -9.372629e-03 3 1  ON 63
ci_0065                -6.435488e-03 3 1  ON 64
ci_0066                -6.132163e-03 3 1  ON 65
ci_0067                -3.748011e-03 3 1  ON 66
ci_0068                -3.479525e-03 3 1  ON 67
ci_0069                 3.569228e-03 3 1  ON 68
ci_0070                 3.348568e-03 3 1  ON 69
ci_0071                 3.005285e-03 3 1  ON 70
ci_0072                 3.481746e-03 3 1  ON 71
ci_0073                 3.552581e-03 3 1  ON 72
ci_0074                 3.528881e-03 3 1  ON 73
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 4.0037e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s067 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s067 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=67  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6903e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 67
    time step          = 0.05
    reference energy   = -16.9289
    reference variance = 0.218879
====================================================
  Execution time = 1.4199e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s067
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5201e+04
  VMC Eavg = -1.6899e+01
  VMC Evar = 2.9195e-01
  Total weights = 1.950890941e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 2.5448e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.283141269702
                                         uncertainty =       0.001485988553

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.283141269702
                                         uncertainty =       0.001485988553

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000376227819
  error estimate for blocks of size 2^( 2) =       0.000393077908
  error estimate for blocks of size 2^( 3) =       0.000410362830
  error estimate for blocks of size 2^( 4) =       0.000425008884
  error estimate for blocks of size 2^( 5) =       0.000436510016
  error estimate for blocks of size 2^( 6) =       0.000444297235
  error estimate for blocks of size 2^( 7) =       0.000449988011

      target function =      -0.925328758310
              le_mean =     -16.899219030631
             les_mean =     285.875554464348
             stat err =       0.000438951037
             autocorr =       1.361226353892
   target nu stat err =       0.000438951037
   target dn stat err =       0.002033494873
      target stat err =       0.003282146468
              std dev =       0.532066483719
             le_variance =       0.283094743097


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.689921903063e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 74
Check correct_vf_var_size: 225, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 5.5511e+04, overlap shift 5.5511e+05 and omega -1.7444e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.925339117122       residual = 3.68e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.925339117452       residual = 4.39e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.925339117507       residual = 2.19e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.925339117539       residual = 1.02e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.925339117548       residual = 3.76e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.925339117488       residual = 2.48e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.925339117455       residual = 1.33e-05           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.925339117560       residual = 1.93e-05           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.925339117679       residual = 1.82e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.925339117628       residual = 9.01e-06           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.925339117519       residual = 4.17e-06           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.925339117521       residual = 1.30e-06           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.925339117557       residual = 5.05e-07           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.925339117446       residual = 1.57e-07           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.925339117537       residual = 6.41e-08           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.925339117532       residual = 1.39e-08           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.925339117556       residual = 5.14e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         16 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 5.5511e+04 is 4.656887e-09

solving harmonic davidson linear method for identity shift 2.2204e+05, overlap shift 2.2204e+06 and omega -1.7444e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.925339117122       residual = 3.68e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.925339117204       residual = 4.39e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.925339117218       residual = 2.19e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.925339117226       residual = 1.02e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.925339117156       residual = 3.76e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.925339117376       residual = 2.48e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.925339117628       residual = 1.33e-05           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.925339117137       residual = 1.93e-05           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.925339116985       residual = 1.82e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.925339117046       residual = 9.01e-06           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.925339117381       residual = 4.17e-06           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.925339117644       residual = 1.30e-06           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.925339117908       residual = 5.05e-07           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.925339116886       residual = 1.57e-07           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.925339117403       residual = 6.41e-08           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.925339117169       residual = 1.39e-08           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.925339116923       residual = 5.14e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         16 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 2.2204e+05 is 1.164222e-09

solving harmonic davidson linear method for identity shift 8.8818e+05, overlap shift 8.8818e+06 and omega -1.7444e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.925339117122       residual = 3.68e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.925339117142       residual = 4.39e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.925339117146       residual = 2.19e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.925339117148       residual = 1.02e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.925339117617       residual = 3.76e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.925339116912       residual = 2.48e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.925339117611       residual = 1.33e-05           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.925339116517       residual = 1.93e-05           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.925339115227       residual = 1.82e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.925339116370       residual = 9.01e-06           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.925339116872       residual = 4.17e-06           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.925339116225       residual = 1.30e-06           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.925339116606       residual = 5.05e-07           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.925339116756       residual = 1.57e-07           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.925339117145       residual = 6.41e-08           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.925339116177       residual = 1.39e-08           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.925339115306       residual = 5.14e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         16 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 8.8818e+05 is 2.910556e-10

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.804668 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 75 and numParams is: 74

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.6758e+01
  </log>
  <optVariables href="H2O.s067.opt.xml">
ci_0001                 7.086064e-01 3 1  ON 0
ci_0002                 6.927483e-01 3 1  ON 1
ci_0003                -3.099700e-02 3 1  ON 2
ci_0004                -3.009163e-02 3 1  ON 3
ci_0005                -3.060381e-02 3 1  ON 4
ci_0006                -3.069589e-02 3 1  ON 5
ci_0007                -1.338106e-02 3 1  ON 6
ci_0008                -1.335098e-02 3 1  ON 7
ci_0009                -1.869649e-02 3 1  ON 8
ci_0010                -1.813029e-02 3 1  ON 9
ci_0011                -1.474502e-02 3 1  ON 10
ci_0012                -1.451136e-02 3 1  ON 11
ci_0013                 1.529423e-02 3 1  ON 12
ci_0014                 1.480516e-02 3 1  ON 13
ci_0015                 1.574765e-02 3 1  ON 14
ci_0016                 1.538635e-02 3 1  ON 15
ci_0017                 1.336745e-02 3 1  ON 16
ci_0018                 1.303907e-02 3 1  ON 17
ci_0019                 1.308951e-02 3 1  ON 18
ci_0020                 1.266839e-02 3 1  ON 19
ci_0021                 6.752832e-03 3 1  ON 20
ci_0022                 7.460559e-03 3 1  ON 21
ci_0023                -1.180401e-02 3 1  ON 22
ci_0024                -1.147024e-02 3 1  ON 23
ci_0025                -2.029553e-03 3 1  ON 24
ci_0026                -2.390786e-03 3 1  ON 25
ci_0027                -1.213157e-02 3 1  ON 26
ci_0028                -1.154911e-02 3 1  ON 27
ci_0029                -1.065831e-02 3 1  ON 28
ci_0030                -1.058733e-02 3 1  ON 29
ci_0031                 1.340905e-02 3 1  ON 30
ci_0032                 1.211456e-02 3 1  ON 31
ci_0033                 7.848191e-03 3 1  ON 32
ci_0034                 8.489681e-03 3 1  ON 33
ci_0035                 4.859454e-03 3 1  ON 34
ci_0036                 4.933670e-03 3 1  ON 35
ci_0037                -1.133361e-02 3 1  ON 36
ci_0038                -1.131346e-02 3 1  ON 37
ci_0039                -4.015000e-03 3 1  ON 38
ci_0040                -3.886150e-03 3 1  ON 39
ci_0041                 9.104233e-03 3 1  ON 40
ci_0042                 8.780957e-03 3 1  ON 41
ci_0043                -1.307368e-02 3 1  ON 42
ci_0044                -1.384578e-02 3 1  ON 43
ci_0045                 1.059115e-02 3 1  ON 44
ci_0046                 1.007868e-02 3 1  ON 45
ci_0047                -3.585076e-03 3 1  ON 46
ci_0048                -3.481624e-03 3 1  ON 47
ci_0049                -2.594557e-03 3 1  ON 48
ci_0050                -2.695915e-03 3 1  ON 49
ci_0051                -1.797579e-03 3 1  ON 50
ci_0052                -2.016135e-03 3 1  ON 51
ci_0053                -3.931448e-03 3 1  ON 52
ci_0054                -3.323912e-03 3 1  ON 53
ci_0055                 2.398826e-03 3 1  ON 54
ci_0056                 2.269828e-03 3 1  ON 55
ci_0057                 2.453974e-03 3 1  ON 56
ci_0058                 2.857295e-03 3 1  ON 57
ci_0059                -3.395809e-03 3 1  ON 58
ci_0060                -3.375905e-03 3 1  ON 59
ci_0061                -3.976489e-03 3 1  ON 60
ci_0062                -3.922379e-03 3 1  ON 61
ci_0063                -9.802596e-03 3 1  ON 62
ci_0064                -9.372629e-03 3 1  ON 63
ci_0065                -6.435488e-03 3 1  ON 64
ci_0066                -6.132163e-03 3 1  ON 65
ci_0067                -3.748011e-03 3 1  ON 66
ci_0068                -3.479525e-03 3 1  ON 67
ci_0069                 3.569228e-03 3 1  ON 68
ci_0070                 3.348568e-03 3 1  ON 69
ci_0071                 3.005285e-03 3 1  ON 70
ci_0072                 3.481746e-03 3 1  ON 71
ci_0073                 3.552581e-03 3 1  ON 72
ci_0074                 3.528881e-03 3 1  ON 73
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 67
    time step          = 0.05
    reference energy   = -16.9051
    reference variance = 0.206045
====================================================
  Execution time = 1.3718e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s067
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6899e+01
  VMC Evar = 2.9149e-01
  Total weights = 1.9511e+06
  Execution time = 1.8657e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.282871132791
                                         uncertainty =       0.002214485629

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.282871132791
                                         uncertainty =       0.002214485629

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000376089294
  error estimate for blocks of size 2^( 2) =       0.000393127343
  error estimate for blocks of size 2^( 3) =       0.000410334734
  error estimate for blocks of size 2^( 4) =       0.000424524836
  error estimate for blocks of size 2^( 5) =       0.000435480251
  error estimate for blocks of size 2^( 6) =       0.000441492125
  error estimate for blocks of size 2^( 7) =       0.000442955837

      target function =      -0.926039832111
              le_mean =     -16.898968609556
             les_mean =     285.866630967259
             stat err =       0.000436113262
             autocorr =       1.344672882322
   target nu stat err =       0.000436113262
   target dn stat err =       0.002678314870
      target stat err =       0.004279109394
              std dev =       0.531870580028
             le_variance =       0.282886313899

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.282871132567
                                         uncertainty =       0.002214485586

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.282871132567
                                         uncertainty =       0.002214485586

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000376089294
  error estimate for blocks of size 2^( 2) =       0.000393127343
  error estimate for blocks of size 2^( 3) =       0.000410334734
  error estimate for blocks of size 2^( 4) =       0.000424524836
  error estimate for blocks of size 2^( 5) =       0.000435480251
  error estimate for blocks of size 2^( 6) =       0.000441492125
  error estimate for blocks of size 2^( 7) =       0.000442955837

      target function =      -0.926039833191
              le_mean =     -16.898968609565
             les_mean =     285.866630966871
             stat err =       0.000436113262
             autocorr =       1.344672882796
   target nu stat err =       0.000436113262
   target dn stat err =       0.002678315852
      target stat err =       0.004279110925
              std dev =       0.531870579809
             le_variance =       0.282886313666

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.282871132679
                                         uncertainty =       0.002214485608

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.282871132679
                                         uncertainty =       0.002214485608

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000376089294
  error estimate for blocks of size 2^( 2) =       0.000393127343
  error estimate for blocks of size 2^( 3) =       0.000410334734
  error estimate for blocks of size 2^( 4) =       0.000424524836
  error estimate for blocks of size 2^( 5) =       0.000435480251
  error estimate for blocks of size 2^( 6) =       0.000441492125
  error estimate for blocks of size 2^( 7) =       0.000442955837

      target function =      -0.926039832654
              le_mean =     -16.898968609560
             les_mean =     285.866630967063
             stat err =       0.000436113262
             autocorr =       1.344672882553
   target nu stat err =       0.000436113262
   target dn stat err =       0.002678315361
      target stat err =       0.004279110160
              std dev =       0.531870579918
             le_variance =       0.282886313783

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.282871132777
                                         uncertainty =       0.002214485626

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.282871132777
                                         uncertainty =       0.002214485626

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000376089294
  error estimate for blocks of size 2^( 2) =       0.000393127343
  error estimate for blocks of size 2^( 3) =       0.000410334734
  error estimate for blocks of size 2^( 4) =       0.000424524836
  error estimate for blocks of size 2^( 5) =       0.000435480251
  error estimate for blocks of size 2^( 6) =       0.000441492125
  error estimate for blocks of size 2^( 7) =       0.000442955837

      target function =      -0.926039832179
              le_mean =     -16.898968609556
             les_mean =     285.866630967234
             stat err =       0.000436113262
             autocorr =       1.344672882353
   target nu stat err =       0.000436113262
   target dn stat err =       0.002678314931
      target stat err =       0.004279109490
              std dev =       0.531870580014
             le_variance =       0.282886313885


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.926039832111        initial
     5.5511e+04     5.5511e+05             4.6569e-09        -0.926039833191  <--
     2.2204e+05     2.2204e+06             1.1642e-09        -0.926039832654
     8.8818e+05     8.8818e+06             2.9106e-10        -0.926039832179

*****************************************************************************
Applying the update for shift_i =   5.5511e+04     and shift_s =   5.5511e+05
*****************************************************************************

  Execution time = 2.3148e+01
  </log>
  <optVariables href="H2O.s067.opt.xml">
ci_0001                 7.086064e-01 3 1  ON 0
ci_0002                 6.927484e-01 3 1  ON 1
ci_0003                -3.099700e-02 3 1  ON 2
ci_0004                -3.009163e-02 3 1  ON 3
ci_0005                -3.060381e-02 3 1  ON 4
ci_0006                -3.069589e-02 3 1  ON 5
ci_0007                -1.338106e-02 3 1  ON 6
ci_0008                -1.335098e-02 3 1  ON 7
ci_0009                -1.869649e-02 3 1  ON 8
ci_0010                -1.813029e-02 3 1  ON 9
ci_0011                -1.474502e-02 3 1  ON 10
ci_0012                -1.451136e-02 3 1  ON 11
ci_0013                 1.529423e-02 3 1  ON 12
ci_0014                 1.480516e-02 3 1  ON 13
ci_0015                 1.574765e-02 3 1  ON 14
ci_0016                 1.538635e-02 3 1  ON 15
ci_0017                 1.336745e-02 3 1  ON 16
ci_0018                 1.303907e-02 3 1  ON 17
ci_0019                 1.308951e-02 3 1  ON 18
ci_0020                 1.266839e-02 3 1  ON 19
ci_0021                 6.752832e-03 3 1  ON 20
ci_0022                 7.460558e-03 3 1  ON 21
ci_0023                -1.180401e-02 3 1  ON 22
ci_0024                -1.147024e-02 3 1  ON 23
ci_0025                -2.029554e-03 3 1  ON 24
ci_0026                -2.390785e-03 3 1  ON 25
ci_0027                -1.213157e-02 3 1  ON 26
ci_0028                -1.154911e-02 3 1  ON 27
ci_0029                -1.065831e-02 3 1  ON 28
ci_0030                -1.058733e-02 3 1  ON 29
ci_0031                 1.340905e-02 3 1  ON 30
ci_0032                 1.211456e-02 3 1  ON 31
ci_0033                 7.848191e-03 3 1  ON 32
ci_0034                 8.489680e-03 3 1  ON 33
ci_0035                 4.859455e-03 3 1  ON 34
ci_0036                 4.933671e-03 3 1  ON 35
ci_0037                -1.133361e-02 3 1  ON 36
ci_0038                -1.131346e-02 3 1  ON 37
ci_0039                -4.015000e-03 3 1  ON 38
ci_0040                -3.886150e-03 3 1  ON 39
ci_0041                 9.104233e-03 3 1  ON 40
ci_0042                 8.780956e-03 3 1  ON 41
ci_0043                -1.307368e-02 3 1  ON 42
ci_0044                -1.384578e-02 3 1  ON 43
ci_0045                 1.059115e-02 3 1  ON 44
ci_0046                 1.007868e-02 3 1  ON 45
ci_0047                -3.585076e-03 3 1  ON 46
ci_0048                -3.481624e-03 3 1  ON 47
ci_0049                -2.594557e-03 3 1  ON 48
ci_0050                -2.695915e-03 3 1  ON 49
ci_0051                -1.797579e-03 3 1  ON 50
ci_0052                -2.016135e-03 3 1  ON 51
ci_0053                -3.931448e-03 3 1  ON 52
ci_0054                -3.323913e-03 3 1  ON 53
ci_0055                 2.398826e-03 3 1  ON 54
ci_0056                 2.269828e-03 3 1  ON 55
ci_0057                 2.453974e-03 3 1  ON 56
ci_0058                 2.857296e-03 3 1  ON 57
ci_0059                -3.395809e-03 3 1  ON 58
ci_0060                -3.375905e-03 3 1  ON 59
ci_0061                -3.976490e-03 3 1  ON 60
ci_0062                -3.922379e-03 3 1  ON 61
ci_0063                -9.802597e-03 3 1  ON 62
ci_0064                -9.372629e-03 3 1  ON 63
ci_0065                -6.435488e-03 3 1  ON 64
ci_0066                -6.132163e-03 3 1  ON 65
ci_0067                -3.748010e-03 3 1  ON 66
ci_0068                -3.479526e-03 3 1  ON 67
ci_0069                 3.569228e-03 3 1  ON 68
ci_0070                 3.348568e-03 3 1  ON 69
ci_0071                 3.005286e-03 3 1  ON 70
ci_0072                 3.481746e-03 3 1  ON 71
ci_0073                 3.552580e-03 3 1  ON 72
ci_0074                 3.528880e-03 3 1  ON 73
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 3.9912e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s068 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s068 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=68  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6903e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 68
    time step          = 0.05
    reference energy   = -16.9121
    reference variance = 0.195447
====================================================
  Execution time = 1.4050e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s068
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5254e+04
  VMC Eavg = -1.6898e+01
  VMC Evar = 2.9163e-01
  Total weights = 1.950818584e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 2.5975e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.281701076988
                                         uncertainty =       0.001972726673

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.281701076988
                                         uncertainty =       0.001972726673

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000375396460
  error estimate for blocks of size 2^( 2) =       0.000392466829
  error estimate for blocks of size 2^( 3) =       0.000410005384
  error estimate for blocks of size 2^( 4) =       0.000425699329
  error estimate for blocks of size 2^( 5) =       0.000438333085
  error estimate for blocks of size 2^( 6) =       0.000445761862
  error estimate for blocks of size 2^( 7) =       0.000448632295

      target function =      -0.925812279147
              le_mean =     -16.897847145503
             les_mean =     285.828864125793
             stat err =       0.000439606643
             autocorr =       1.371349480051
   target nu stat err =       0.000439606643
   target dn stat err =       0.002377129152
      target stat err =       0.003804696606
              std dev =       0.530890765499
             le_variance =       0.281845004892


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.689784714550e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 74
Check correct_vf_var_size: 225, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.3878e+04, overlap shift 1.3878e+05 and omega -1.7444e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.925826523350       residual = 9.81e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.925826526323       residual = 1.23e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.925826526697       residual = 3.96e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.925826526824       residual = 1.43e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.925826526916       residual = 6.56e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.925826526927       residual = 3.38e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.925826526940       residual = 9.38e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.925826526938       residual = 2.53e-06           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.925826526944       residual = 1.60e-06           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.925826526942       residual = 1.61e-06           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.925826526943       residual = 1.15e-06           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.925826526944       residual = 7.84e-07           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.925826526944       residual = 5.42e-07           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.925826526937       residual = 2.45e-07           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.925826526947       residual = 5.92e-08           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.925826526928       residual = 3.08e-08           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.925826526918       residual = 9.23e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         16 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 1.3878e+04 is 1.598010e-08

solving harmonic davidson linear method for identity shift 5.5511e+04, overlap shift 5.5511e+05 and omega -1.7444e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.925826523350       residual = 9.81e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.925826524093       residual = 1.23e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.925826524187       residual = 3.96e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.925826524219       residual = 1.43e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.925826524242       residual = 6.56e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.925826524245       residual = 3.38e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.925826524248       residual = 9.38e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.925826524247       residual = 2.53e-06           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.925826524247       residual = 1.60e-06           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.925826524183       residual = 1.61e-06           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.925826524139       residual = 1.15e-06           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.925826524249       residual = 7.84e-07           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.925826524249       residual = 5.42e-07           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.925826524249       residual = 2.45e-07           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.925826524249       residual = 5.92e-08           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.925826524119       residual = 3.08e-08           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.925826524280       residual = 9.23e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         16 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 5.5511e+04 is 3.995033e-09

solving harmonic davidson linear method for identity shift 2.2204e+05, overlap shift 2.2204e+06 and omega -1.7444e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.925826523350       residual = 9.81e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.925826523536       residual = 1.23e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.925826523559       residual = 3.96e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.925826523567       residual = 1.43e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.925826523526       residual = 6.56e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.925826523366       residual = 3.38e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.925826523575       residual = 9.38e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.925826523574       residual = 2.53e-06           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.925826523574       residual = 1.60e-06           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.925826523575       residual = 1.61e-06           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.925826523575       residual = 1.15e-06           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.925826523575       residual = 7.84e-07           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.925826523575       residual = 5.42e-07           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.925826523361       residual = 2.45e-07           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.925826523524       residual = 5.92e-08           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.925826523432       residual = 3.08e-08           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.925826522836       residual = 9.23e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         16 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 2.2204e+05 is 9.987588e-10

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.813690 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 75 and numParams is: 74

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.6662e+01
  </log>
  <optVariables href="H2O.s068.opt.xml">
ci_0001                 7.086064e-01 3 1  ON 0
ci_0002                 6.927484e-01 3 1  ON 1
ci_0003                -3.099700e-02 3 1  ON 2
ci_0004                -3.009163e-02 3 1  ON 3
ci_0005                -3.060381e-02 3 1  ON 4
ci_0006                -3.069589e-02 3 1  ON 5
ci_0007                -1.338106e-02 3 1  ON 6
ci_0008                -1.335098e-02 3 1  ON 7
ci_0009                -1.869649e-02 3 1  ON 8
ci_0010                -1.813029e-02 3 1  ON 9
ci_0011                -1.474502e-02 3 1  ON 10
ci_0012                -1.451136e-02 3 1  ON 11
ci_0013                 1.529423e-02 3 1  ON 12
ci_0014                 1.480516e-02 3 1  ON 13
ci_0015                 1.574765e-02 3 1  ON 14
ci_0016                 1.538635e-02 3 1  ON 15
ci_0017                 1.336745e-02 3 1  ON 16
ci_0018                 1.303907e-02 3 1  ON 17
ci_0019                 1.308951e-02 3 1  ON 18
ci_0020                 1.266839e-02 3 1  ON 19
ci_0021                 6.752830e-03 3 1  ON 20
ci_0022                 7.460558e-03 3 1  ON 21
ci_0023                -1.180401e-02 3 1  ON 22
ci_0024                -1.147024e-02 3 1  ON 23
ci_0025                -2.029554e-03 3 1  ON 24
ci_0026                -2.390783e-03 3 1  ON 25
ci_0027                -1.213157e-02 3 1  ON 26
ci_0028                -1.154911e-02 3 1  ON 27
ci_0029                -1.065831e-02 3 1  ON 28
ci_0030                -1.058733e-02 3 1  ON 29
ci_0031                 1.340905e-02 3 1  ON 30
ci_0032                 1.211456e-02 3 1  ON 31
ci_0033                 7.848193e-03 3 1  ON 32
ci_0034                 8.489679e-03 3 1  ON 33
ci_0035                 4.859456e-03 3 1  ON 34
ci_0036                 4.933672e-03 3 1  ON 35
ci_0037                -1.133361e-02 3 1  ON 36
ci_0038                -1.131346e-02 3 1  ON 37
ci_0039                -4.015000e-03 3 1  ON 38
ci_0040                -3.886150e-03 3 1  ON 39
ci_0041                 9.104234e-03 3 1  ON 40
ci_0042                 8.780957e-03 3 1  ON 41
ci_0043                -1.307368e-02 3 1  ON 42
ci_0044                -1.384579e-02 3 1  ON 43
ci_0045                 1.059115e-02 3 1  ON 44
ci_0046                 1.007868e-02 3 1  ON 45
ci_0047                -3.585076e-03 3 1  ON 46
ci_0048                -3.481623e-03 3 1  ON 47
ci_0049                -2.594559e-03 3 1  ON 48
ci_0050                -2.695914e-03 3 1  ON 49
ci_0051                -1.797580e-03 3 1  ON 50
ci_0052                -2.016134e-03 3 1  ON 51
ci_0053                -3.931446e-03 3 1  ON 52
ci_0054                -3.323913e-03 3 1  ON 53
ci_0055                 2.398825e-03 3 1  ON 54
ci_0056                 2.269827e-03 3 1  ON 55
ci_0057                 2.453974e-03 3 1  ON 56
ci_0058                 2.857294e-03 3 1  ON 57
ci_0059                -3.395810e-03 3 1  ON 58
ci_0060                -3.375903e-03 3 1  ON 59
ci_0061                -3.976491e-03 3 1  ON 60
ci_0062                -3.922380e-03 3 1  ON 61
ci_0063                -9.802596e-03 3 1  ON 62
ci_0064                -9.372629e-03 3 1  ON 63
ci_0065                -6.435487e-03 3 1  ON 64
ci_0066                -6.132162e-03 3 1  ON 65
ci_0067                -3.748010e-03 3 1  ON 66
ci_0068                -3.479527e-03 3 1  ON 67
ci_0069                 3.569227e-03 3 1  ON 68
ci_0070                 3.348567e-03 3 1  ON 69
ci_0071                 3.005286e-03 3 1  ON 70
ci_0072                 3.481746e-03 3 1  ON 71
ci_0073                 3.552582e-03 3 1  ON 72
ci_0074                 3.528880e-03 3 1  ON 73
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 68
    time step          = 0.05
    reference energy   = -16.9523
    reference variance = 0.176637
====================================================
  Execution time = 1.3715e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s068
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6899e+01
  VMC Evar = 2.8792e-01
  Total weights = 1.9509e+06
  Execution time = 1.8746e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.279835038710
                                         uncertainty =       0.001881835699

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.279835038710
                                         uncertainty =       0.001881835699

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000374115500
  error estimate for blocks of size 2^( 2) =       0.000390932897
  error estimate for blocks of size 2^( 3) =       0.000408236527
  error estimate for blocks of size 2^( 4) =       0.000422973380
  error estimate for blocks of size 2^( 5) =       0.000434137850
  error estimate for blocks of size 2^( 6) =       0.000441006183
  error estimate for blocks of size 2^( 7) =       0.000443615853

      target function =      -0.931706455068
              le_mean =     -16.898913051182
             les_mean =     285.861178528362
             stat err =       0.000435433317
             autocorr =       1.354664988947
   target nu stat err =       0.000435433317
   target dn stat err =       0.001975012159
      target stat err =       0.003232442087
              std dev =       0.529079214242
             le_variance =       0.279924814943

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.279835038252
                                         uncertainty =       0.001881835869

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.279835038252
                                         uncertainty =       0.001881835869

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000374115500
  error estimate for blocks of size 2^( 2) =       0.000390932896
  error estimate for blocks of size 2^( 3) =       0.000408236527
  error estimate for blocks of size 2^( 4) =       0.000422973380
  error estimate for blocks of size 2^( 5) =       0.000434137850
  error estimate for blocks of size 2^( 6) =       0.000441006183
  error estimate for blocks of size 2^( 7) =       0.000443615853

      target function =      -0.931706468819
              le_mean =     -16.898913051137
             les_mean =     285.861178518194
             stat err =       0.000435433316
             autocorr =       1.354664989385
   target nu stat err =       0.000435433316
   target dn stat err =       0.001975011299
      target stat err =       0.003232440846
              std dev =       0.529079213810
             le_variance =       0.279924814486

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.279835038481
                                         uncertainty =       0.001881835784

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.279835038481
                                         uncertainty =       0.001881835784

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000374115500
  error estimate for blocks of size 2^( 2) =       0.000390932896
  error estimate for blocks of size 2^( 3) =       0.000408236527
  error estimate for blocks of size 2^( 4) =       0.000422973380
  error estimate for blocks of size 2^( 5) =       0.000434137850
  error estimate for blocks of size 2^( 6) =       0.000441006183
  error estimate for blocks of size 2^( 7) =       0.000443615853

      target function =      -0.931706461944
              le_mean =     -16.898913051160
             les_mean =     285.861178523278
             stat err =       0.000435433316
             autocorr =       1.354664989170
   target nu stat err =       0.000435433316
   target dn stat err =       0.001975011729
      target stat err =       0.003232441467
              std dev =       0.529079214026
             le_variance =       0.279924814715

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.279835038681
                                         uncertainty =       0.001881835710

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.279835038681
                                         uncertainty =       0.001881835710

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000374115500
  error estimate for blocks of size 2^( 2) =       0.000390932897
  error estimate for blocks of size 2^( 3) =       0.000408236527
  error estimate for blocks of size 2^( 4) =       0.000422973380
  error estimate for blocks of size 2^( 5) =       0.000434137850
  error estimate for blocks of size 2^( 6) =       0.000441006183
  error estimate for blocks of size 2^( 7) =       0.000443615853

      target function =      -0.931706455928
              le_mean =     -16.898913051179
             les_mean =     285.861178527727
             stat err =       0.000435433317
             autocorr =       1.354664988983
   target nu stat err =       0.000435433317
   target dn stat err =       0.001975012105
      target stat err =       0.003232442010
              std dev =       0.529079214215
             le_variance =       0.279924814914


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.931706455068        initial
     1.3878e+04     1.3878e+05             1.5980e-08        -0.931706468819  <--
     5.5511e+04     5.5511e+05             3.9950e-09        -0.931706461944
     2.2204e+05     2.2204e+06             9.9876e-10        -0.931706455928

*****************************************************************************
Applying the update for shift_i =   1.3878e+04     and shift_s =   1.3878e+05
*****************************************************************************

  Execution time = 2.3320e+01
  </log>
  <optVariables href="H2O.s068.opt.xml">
ci_0001                 7.086064e-01 3 1  ON 0
ci_0002                 6.927483e-01 3 1  ON 1
ci_0003                -3.099700e-02 3 1  ON 2
ci_0004                -3.009163e-02 3 1  ON 3
ci_0005                -3.060381e-02 3 1  ON 4
ci_0006                -3.069588e-02 3 1  ON 5
ci_0007                -1.338106e-02 3 1  ON 6
ci_0008                -1.335098e-02 3 1  ON 7
ci_0009                -1.869649e-02 3 1  ON 8
ci_0010                -1.813028e-02 3 1  ON 9
ci_0011                -1.474502e-02 3 1  ON 10
ci_0012                -1.451136e-02 3 1  ON 11
ci_0013                 1.529423e-02 3 1  ON 12
ci_0014                 1.480516e-02 3 1  ON 13
ci_0015                 1.574765e-02 3 1  ON 14
ci_0016                 1.538634e-02 3 1  ON 15
ci_0017                 1.336746e-02 3 1  ON 16
ci_0018                 1.303908e-02 3 1  ON 17
ci_0019                 1.308951e-02 3 1  ON 18
ci_0020                 1.266839e-02 3 1  ON 19
ci_0021                 6.752826e-03 3 1  ON 20
ci_0022                 7.460559e-03 3 1  ON 21
ci_0023                -1.180401e-02 3 1  ON 22
ci_0024                -1.147023e-02 3 1  ON 23
ci_0025                -2.029553e-03 3 1  ON 24
ci_0026                -2.390776e-03 3 1  ON 25
ci_0027                -1.213157e-02 3 1  ON 26
ci_0028                -1.154911e-02 3 1  ON 27
ci_0029                -1.065831e-02 3 1  ON 28
ci_0030                -1.058733e-02 3 1  ON 29
ci_0031                 1.340905e-02 3 1  ON 30
ci_0032                 1.211456e-02 3 1  ON 31
ci_0033                 7.848198e-03 3 1  ON 32
ci_0034                 8.489675e-03 3 1  ON 33
ci_0035                 4.859462e-03 3 1  ON 34
ci_0036                 4.933672e-03 3 1  ON 35
ci_0037                -1.133361e-02 3 1  ON 36
ci_0038                -1.131346e-02 3 1  ON 37
ci_0039                -4.015001e-03 3 1  ON 38
ci_0040                -3.886151e-03 3 1  ON 39
ci_0041                 9.104237e-03 3 1  ON 40
ci_0042                 8.780959e-03 3 1  ON 41
ci_0043                -1.307370e-02 3 1  ON 42
ci_0044                -1.384579e-02 3 1  ON 43
ci_0045                 1.059115e-02 3 1  ON 44
ci_0046                 1.007868e-02 3 1  ON 45
ci_0047                -3.585075e-03 3 1  ON 46
ci_0048                -3.481622e-03 3 1  ON 47
ci_0049                -2.594563e-03 3 1  ON 48
ci_0050                -2.695912e-03 3 1  ON 49
ci_0051                -1.797583e-03 3 1  ON 50
ci_0052                -2.016132e-03 3 1  ON 51
ci_0053                -3.931442e-03 3 1  ON 52
ci_0054                -3.323912e-03 3 1  ON 53
ci_0055                 2.398823e-03 3 1  ON 54
ci_0056                 2.269823e-03 3 1  ON 55
ci_0057                 2.453973e-03 3 1  ON 56
ci_0058                 2.857287e-03 3 1  ON 57
ci_0059                -3.395813e-03 3 1  ON 58
ci_0060                -3.375897e-03 3 1  ON 59
ci_0061                -3.976494e-03 3 1  ON 60
ci_0062                -3.922383e-03 3 1  ON 61
ci_0063                -9.802595e-03 3 1  ON 62
ci_0064                -9.372629e-03 3 1  ON 63
ci_0065                -6.435485e-03 3 1  ON 64
ci_0066                -6.132161e-03 3 1  ON 65
ci_0067                -3.748009e-03 3 1  ON 66
ci_0068                -3.479529e-03 3 1  ON 67
ci_0069                 3.569225e-03 3 1  ON 68
ci_0070                 3.348564e-03 3 1  ON 69
ci_0071                 3.005287e-03 3 1  ON 70
ci_0072                 3.481747e-03 3 1  ON 71
ci_0073                 3.552585e-03 3 1  ON 72
ci_0074                 3.528880e-03 3 1  ON 73
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 3.9990e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s069 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s069 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=69  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6903e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 69
    time step          = 0.05
    reference energy   = -16.9195
    reference variance = 0.245104
====================================================
  Execution time = 1.4043e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s069
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5252e+04
  VMC Eavg = -1.6898e+01
  VMC Evar = 2.9079e-01
  Total weights = 1.950775632e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 2.6082e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.282689127182
                                         uncertainty =       0.001788637319

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.282689127182
                                         uncertainty =       0.001788637319

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000375964486
  error estimate for blocks of size 2^( 2) =       0.000392877816
  error estimate for blocks of size 2^( 3) =       0.000410496617
  error estimate for blocks of size 2^( 4) =       0.000426191103
  error estimate for blocks of size 2^( 5) =       0.000438110493
  error estimate for blocks of size 2^( 6) =       0.000445693133
  error estimate for blocks of size 2^( 7) =       0.000451113143

      target function =      -0.927138216771
              le_mean =     -16.898059826724
             les_mean =     285.835213194454
             stat err =       0.000440276968
             autocorr =       1.371381507717
   target nu stat err =       0.000440276968
   target dn stat err =       0.002116747469
      target stat err =       0.003415969865
              std dev =       0.531694074413
             le_variance =       0.282698588766


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.689805982672e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 74
Check correct_vf_var_size: 225, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 3.4694e+03, overlap shift 3.4694e+04 and omega -1.7444e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.927149265760       residual = 1.05e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.927149281271       residual = 1.28e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.927149282617       residual = 4.34e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.927149283373       residual = 2.59e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.927149283789       residual = 6.30e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.927149283858       residual = 1.97e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.927149283879       residual = 5.64e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.927149283892       residual = 2.15e-06           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.927149283897       residual = 1.90e-06           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.927149283898       residual = 7.90e-07           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.927149283906       residual = 5.78e-07           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.927149283909       residual = 5.45e-07           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.927149283918       residual = 3.96e-07           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.927149283925       residual = 2.81e-07           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.927149283923       residual = 1.01e-07           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.927149283916       residual = 3.53e-08           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.927149283903       residual = 1.02e-08           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.927149283922       residual = 2.92e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         17 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 3.4694e+03 is 6.711644e-08

solving harmonic davidson linear method for identity shift 1.3878e+04, overlap shift 1.3878e+05 and omega -1.7444e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.927149265760       residual = 1.05e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.927149269638       residual = 1.28e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.927149269975       residual = 4.34e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.927149270164       residual = 2.59e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.927149270245       residual = 6.30e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.927149270296       residual = 1.97e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.927149270253       residual = 5.64e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.927149270292       residual = 2.15e-06           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.927149270302       residual = 1.90e-06           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.927149270294       residual = 7.90e-07           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.927149270298       residual = 5.78e-07           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.927149270307       residual = 5.45e-07           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.927149270290       residual = 3.96e-07           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.927149270322       residual = 2.81e-07           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.927149270314       residual = 1.01e-07           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.927149270292       residual = 3.53e-08           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.927149270300       residual = 1.02e-08           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.927149270279       residual = 2.92e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         17 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 1.3878e+04 is 1.677940e-08

solving harmonic davidson linear method for identity shift 5.5511e+04, overlap shift 5.5511e+05 and omega -1.7444e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.927149265760       residual = 1.05e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.927149266730       residual = 1.28e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.927149266814       residual = 4.34e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.927149266879       residual = 2.59e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.927149266960       residual = 6.30e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.927149266938       residual = 1.97e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.927149266967       residual = 5.64e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.927149266662       residual = 2.15e-06           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.927149266894       residual = 1.90e-06           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.927149266894       residual = 7.90e-07           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.927149266894       residual = 5.78e-07           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.927149266881       residual = 5.45e-07           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.927149266886       residual = 3.96e-07           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.927149266896       residual = 2.81e-07           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.927149266819       residual = 1.01e-07           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.927149266742       residual = 3.53e-08           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.927149266895       residual = 1.02e-08           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.927149266895       residual = 2.92e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         17 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 5.5511e+04 is 4.194867e-09

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.823757 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 75 and numParams is: 74

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.6667e+01
  </log>
  <optVariables href="H2O.s069.opt.xml">
ci_0001                 7.086064e-01 3 1  ON 0
ci_0002                 6.927483e-01 3 1  ON 1
ci_0003                -3.099700e-02 3 1  ON 2
ci_0004                -3.009163e-02 3 1  ON 3
ci_0005                -3.060382e-02 3 1  ON 4
ci_0006                -3.069588e-02 3 1  ON 5
ci_0007                -1.338105e-02 3 1  ON 6
ci_0008                -1.335097e-02 3 1  ON 7
ci_0009                -1.869649e-02 3 1  ON 8
ci_0010                -1.813029e-02 3 1  ON 9
ci_0011                -1.474502e-02 3 1  ON 10
ci_0012                -1.451136e-02 3 1  ON 11
ci_0013                 1.529423e-02 3 1  ON 12
ci_0014                 1.480516e-02 3 1  ON 13
ci_0015                 1.574765e-02 3 1  ON 14
ci_0016                 1.538634e-02 3 1  ON 15
ci_0017                 1.336745e-02 3 1  ON 16
ci_0018                 1.303907e-02 3 1  ON 17
ci_0019                 1.308950e-02 3 1  ON 18
ci_0020                 1.266839e-02 3 1  ON 19
ci_0021                 6.752812e-03 3 1  ON 20
ci_0022                 7.460554e-03 3 1  ON 21
ci_0023                -1.180402e-02 3 1  ON 22
ci_0024                -1.147023e-02 3 1  ON 23
ci_0025                -2.029557e-03 3 1  ON 24
ci_0026                -2.390769e-03 3 1  ON 25
ci_0027                -1.213157e-02 3 1  ON 26
ci_0028                -1.154911e-02 3 1  ON 27
ci_0029                -1.065831e-02 3 1  ON 28
ci_0030                -1.058733e-02 3 1  ON 29
ci_0031                 1.340905e-02 3 1  ON 30
ci_0032                 1.211456e-02 3 1  ON 31
ci_0033                 7.848193e-03 3 1  ON 32
ci_0034                 8.489663e-03 3 1  ON 33
ci_0035                 4.859452e-03 3 1  ON 34
ci_0036                 4.933672e-03 3 1  ON 35
ci_0037                -1.133360e-02 3 1  ON 36
ci_0038                -1.131345e-02 3 1  ON 37
ci_0039                -4.014999e-03 3 1  ON 38
ci_0040                -3.886152e-03 3 1  ON 39
ci_0041                 9.104238e-03 3 1  ON 40
ci_0042                 8.780959e-03 3 1  ON 41
ci_0043                -1.307370e-02 3 1  ON 42
ci_0044                -1.384580e-02 3 1  ON 43
ci_0045                 1.059116e-02 3 1  ON 44
ci_0046                 1.007868e-02 3 1  ON 45
ci_0047                -3.585075e-03 3 1  ON 46
ci_0048                -3.481623e-03 3 1  ON 47
ci_0049                -2.594580e-03 3 1  ON 48
ci_0050                -2.695911e-03 3 1  ON 49
ci_0051                -1.797583e-03 3 1  ON 50
ci_0052                -2.016130e-03 3 1  ON 51
ci_0053                -3.931441e-03 3 1  ON 52
ci_0054                -3.323914e-03 3 1  ON 53
ci_0055                 2.398824e-03 3 1  ON 54
ci_0056                 2.269811e-03 3 1  ON 55
ci_0057                 2.453977e-03 3 1  ON 56
ci_0058                 2.857285e-03 3 1  ON 57
ci_0059                -3.395813e-03 3 1  ON 58
ci_0060                -3.375895e-03 3 1  ON 59
ci_0061                -3.976496e-03 3 1  ON 60
ci_0062                -3.922379e-03 3 1  ON 61
ci_0063                -9.802591e-03 3 1  ON 62
ci_0064                -9.372622e-03 3 1  ON 63
ci_0065                -6.435483e-03 3 1  ON 64
ci_0066                -6.132158e-03 3 1  ON 65
ci_0067                -3.748004e-03 3 1  ON 66
ci_0068                -3.479529e-03 3 1  ON 67
ci_0069                 3.569224e-03 3 1  ON 68
ci_0070                 3.348560e-03 3 1  ON 69
ci_0071                 3.005283e-03 3 1  ON 70
ci_0072                 3.481744e-03 3 1  ON 71
ci_0073                 3.552586e-03 3 1  ON 72
ci_0074                 3.528877e-03 3 1  ON 73
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 69
    time step          = 0.05
    reference energy   = -16.9346
    reference variance = 0.260729
====================================================
  Execution time = 1.3910e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s069
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6899e+01
  VMC Evar = 2.9841e-01
  Total weights = 1.9506e+06
  Execution time = 1.8663e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.283027221048
                                         uncertainty =       0.001742289035

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.283027221048
                                         uncertainty =       0.001742289035

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000376174999
  error estimate for blocks of size 2^( 2) =       0.000393331221
  error estimate for blocks of size 2^( 3) =       0.000410698776
  error estimate for blocks of size 2^( 4) =       0.000426555401
  error estimate for blocks of size 2^( 5) =       0.000439003990
  error estimate for blocks of size 2^( 6) =       0.000446481841
  error estimate for blocks of size 2^( 7) =       0.000450356038

      target function =      -0.915238008185
              le_mean =     -16.898939660379
             les_mean =     285.872576047533
             stat err =       0.000440599318
             autocorr =       1.371853654192
   target nu stat err =       0.000440599318
   target dn stat err =       0.004538887541
      target stat err =       0.007015522491
              std dev =       0.531991785090
             le_variance =       0.283015259403

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.283027187674
                                         uncertainty =       0.001742287268

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.283027187674
                                         uncertainty =       0.001742287268

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000376174977
  error estimate for blocks of size 2^( 2) =       0.000393331200
  error estimate for blocks of size 2^( 3) =       0.000410698756
  error estimate for blocks of size 2^( 4) =       0.000426555381
  error estimate for blocks of size 2^( 5) =       0.000439003971
  error estimate for blocks of size 2^( 6) =       0.000446481816
  error estimate for blocks of size 2^( 7) =       0.000450356014

      target function =      -0.915238924203
              le_mean =     -16.898939659276
             les_mean =     285.872575419439
             stat err =       0.000440599295
             autocorr =       1.371853676421
   target nu stat err =       0.000440599295
   target dn stat err =       0.004538546806
      target stat err =       0.007015015578
              std dev =       0.531991753741
             le_variance =       0.283015226048

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.283027204360
                                         uncertainty =       0.001742288151

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.283027204360
                                         uncertainty =       0.001742288151

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000376174988
  error estimate for blocks of size 2^( 2) =       0.000393331210
  error estimate for blocks of size 2^( 3) =       0.000410698766
  error estimate for blocks of size 2^( 4) =       0.000426555391
  error estimate for blocks of size 2^( 5) =       0.000439003980
  error estimate for blocks of size 2^( 6) =       0.000446481829
  error estimate for blocks of size 2^( 7) =       0.000450356026

      target function =      -0.915238466240
              le_mean =     -16.898939659827
             les_mean =     285.872575733456
             stat err =       0.000440599307
             autocorr =       1.371853665311
   target nu stat err =       0.000440599307
   target dn stat err =       0.004538717156
      target stat err =       0.007015269009
              std dev =       0.531991769414
             le_variance =       0.283015242724

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.283027218962
                                         uncertainty =       0.001742288925

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.283027218962
                                         uncertainty =       0.001742288925

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000376174997
  error estimate for blocks of size 2^( 2) =       0.000393331219
  error estimate for blocks of size 2^( 3) =       0.000410698775
  error estimate for blocks of size 2^( 4) =       0.000426555400
  error estimate for blocks of size 2^( 5) =       0.000439003989
  error estimate for blocks of size 2^( 6) =       0.000446481840
  error estimate for blocks of size 2^( 7) =       0.000450356037

      target function =      -0.915238065446
              le_mean =     -16.898939660310
             les_mean =     285.872576008271
             stat err =       0.000440599316
             autocorr =       1.371853655588
   target nu stat err =       0.000440599316
   target dn stat err =       0.004538866241
      target stat err =       0.007015490803
              std dev =       0.531991783130
             le_variance =       0.283015257318


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.915238008185        initial
     3.4694e+03     3.4694e+04             6.7116e-08        -0.915238924203  <--
     1.3878e+04     1.3878e+05             1.6779e-08        -0.915238466240
     5.5511e+04     5.5511e+05             4.1949e-09        -0.915238065446

*****************************************************************************
Applying the update for shift_i =   3.4694e+03     and shift_s =   3.4694e+04
*****************************************************************************

  Execution time = 2.6842e+01
  </log>
  <optVariables href="H2O.s069.opt.xml">
ci_0001                 7.086064e-01 3 1  ON 0
ci_0002                 6.927483e-01 3 1  ON 1
ci_0003                -3.099699e-02 3 1  ON 2
ci_0004                -3.009162e-02 3 1  ON 3
ci_0005                -3.060382e-02 3 1  ON 4
ci_0006                -3.069587e-02 3 1  ON 5
ci_0007                -1.338102e-02 3 1  ON 6
ci_0008                -1.335093e-02 3 1  ON 7
ci_0009                -1.869650e-02 3 1  ON 8
ci_0010                -1.813030e-02 3 1  ON 9
ci_0011                -1.474501e-02 3 1  ON 10
ci_0012                -1.451134e-02 3 1  ON 11
ci_0013                 1.529423e-02 3 1  ON 12
ci_0014                 1.480516e-02 3 1  ON 13
ci_0015                 1.574766e-02 3 1  ON 14
ci_0016                 1.538632e-02 3 1  ON 15
ci_0017                 1.336745e-02 3 1  ON 16
ci_0018                 1.303906e-02 3 1  ON 17
ci_0019                 1.308950e-02 3 1  ON 18
ci_0020                 1.266839e-02 3 1  ON 19
ci_0021                 6.752771e-03 3 1  ON 20
ci_0022                 7.460540e-03 3 1  ON 21
ci_0023                -1.180403e-02 3 1  ON 22
ci_0024                -1.147023e-02 3 1  ON 23
ci_0025                -2.029570e-03 3 1  ON 24
ci_0026                -2.390751e-03 3 1  ON 25
ci_0027                -1.213155e-02 3 1  ON 26
ci_0028                -1.154912e-02 3 1  ON 27
ci_0029                -1.065832e-02 3 1  ON 28
ci_0030                -1.058734e-02 3 1  ON 29
ci_0031                 1.340906e-02 3 1  ON 30
ci_0032                 1.211459e-02 3 1  ON 31
ci_0033                 7.848178e-03 3 1  ON 32
ci_0034                 8.489629e-03 3 1  ON 33
ci_0035                 4.859422e-03 3 1  ON 34
ci_0036                 4.933672e-03 3 1  ON 35
ci_0037                -1.133359e-02 3 1  ON 36
ci_0038                -1.131343e-02 3 1  ON 37
ci_0039                -4.014993e-03 3 1  ON 38
ci_0040                -3.886155e-03 3 1  ON 39
ci_0041                 9.104241e-03 3 1  ON 40
ci_0042                 8.780957e-03 3 1  ON 41
ci_0043                -1.307372e-02 3 1  ON 42
ci_0044                -1.384583e-02 3 1  ON 43
ci_0045                 1.059118e-02 3 1  ON 44
ci_0046                 1.007868e-02 3 1  ON 45
ci_0047                -3.585074e-03 3 1  ON 46
ci_0048                -3.481623e-03 3 1  ON 47
ci_0049                -2.594630e-03 3 1  ON 48
ci_0050                -2.695910e-03 3 1  ON 49
ci_0051                -1.797585e-03 3 1  ON 50
ci_0052                -2.016123e-03 3 1  ON 51
ci_0053                -3.931438e-03 3 1  ON 52
ci_0054                -3.323921e-03 3 1  ON 53
ci_0055                 2.398827e-03 3 1  ON 54
ci_0056                 2.269778e-03 3 1  ON 55
ci_0057                 2.453989e-03 3 1  ON 56
ci_0058                 2.857280e-03 3 1  ON 57
ci_0059                -3.395814e-03 3 1  ON 58
ci_0060                -3.375888e-03 3 1  ON 59
ci_0061                -3.976505e-03 3 1  ON 60
ci_0062                -3.922366e-03 3 1  ON 61
ci_0063                -9.802579e-03 3 1  ON 62
ci_0064                -9.372601e-03 3 1  ON 63
ci_0065                -6.435479e-03 3 1  ON 64
ci_0066                -6.132151e-03 3 1  ON 65
ci_0067                -3.747986e-03 3 1  ON 66
ci_0068                -3.479531e-03 3 1  ON 67
ci_0069                 3.569219e-03 3 1  ON 68
ci_0070                 3.348549e-03 3 1  ON 69
ci_0071                 3.005272e-03 3 1  ON 70
ci_0072                 3.481735e-03 3 1  ON 71
ci_0073                 3.552586e-03 3 1  ON 72
ci_0074                 3.528871e-03 3 1  ON 73
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 4.3708e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s070 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s070 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=70  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6904e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 70
    time step          = 0.05
    reference energy   = -16.9658
    reference variance = 0.208339
====================================================
  Execution time = 1.6382e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s070
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5253e+04
  VMC Eavg = -1.6899e+01
  VMC Evar = 2.8733e-01
  Total weights = 1.950801301e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 2.6060e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.279721642371
                                         uncertainty =       0.001708517954

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.279721642371
                                         uncertainty =       0.001708517954

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000373944698
  error estimate for blocks of size 2^( 2) =       0.000391097062
  error estimate for blocks of size 2^( 3) =       0.000408726659
  error estimate for blocks of size 2^( 4) =       0.000424040476
  error estimate for blocks of size 2^( 5) =       0.000436485258
  error estimate for blocks of size 2^( 6) =       0.000445081274
  error estimate for blocks of size 2^( 7) =       0.000451535880

      target function =      -0.932642414124
              le_mean =     -16.899299675522
             les_mean =     285.873664375812
             stat err =       0.000439285722
             autocorr =       1.380001049238
   target nu stat err =       0.000439285722
   target dn stat err =       0.002132646547
      target stat err =       0.003487963497
              std dev =       0.528837662973
             le_variance =       0.279669273779


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.689929967552e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 74
Check correct_vf_var_size: 225, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 8.6736e+02, overlap shift 8.6736e+03 and omega -1.7444e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.932653997123       residual = 9.43e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.932654041410       residual = 1.25e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.932654048779       residual = 3.01e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.932654050589       residual = 1.23e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.932654051442       residual = 4.31e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.932654052126       residual = 2.15e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.932654052132       residual = 4.88e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.932654052140       residual = 2.73e-06           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.932654052126       residual = 3.01e-06           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.932654052158       residual = 2.55e-06           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.932654052123       residual = 2.24e-06           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.932654052154       residual = 1.03e-06           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.932654052178       residual = 5.03e-07           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.932654052201       residual = 2.31e-07           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.932654052221       residual = 6.47e-08           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.932654052223       residual = 2.10e-08           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.932654052228       residual = 4.28e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         16 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 8.6736e+02 is 1.812758e-07

solving harmonic davidson linear method for identity shift 3.4694e+03, overlap shift 3.4694e+04 and omega -1.7444e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.932653997123       residual = 9.43e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.932654008196       residual = 1.25e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.932654010038       residual = 3.01e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.932654010491       residual = 1.23e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.932654010704       residual = 4.31e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.932654010876       residual = 2.15e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.932654010878       residual = 4.88e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.932654010877       residual = 2.73e-06           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.932654010874       residual = 3.01e-06           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.932654010889       residual = 2.55e-06           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.932654010878       residual = 2.24e-06           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.932654010880       residual = 1.03e-06           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.932654010885       residual = 5.03e-07           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.932654010891       residual = 2.31e-07           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.932654010898       residual = 6.47e-08           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.932654010894       residual = 2.10e-08           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.932654010900       residual = 4.27e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         16 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 3.4694e+03 is 4.532044e-08

solving harmonic davidson linear method for identity shift 1.3878e+04, overlap shift 1.3878e+05 and omega -1.7444e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.932653997123       residual = 9.43e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.932653999892       residual = 1.25e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.932654000352       residual = 3.01e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.932654000466       residual = 1.23e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.932654000524       residual = 4.31e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.932654000597       residual = 2.15e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.932654000556       residual = 4.88e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.932654000582       residual = 2.73e-06           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.932654000560       residual = 3.01e-06           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.932654000573       residual = 2.55e-06           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.932654000564       residual = 2.24e-06           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.932654000549       residual = 1.03e-06           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.932654000535       residual = 5.03e-07           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.932654000584       residual = 2.31e-07           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.932654000559       residual = 6.47e-08           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.932654000570       residual = 2.10e-08           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.932654000551       residual = 4.27e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         16 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 1.3878e+04 is 1.133020e-08

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.832757 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 75 and numParams is: 74

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.9003e+01
  </log>
  <optVariables href="H2O.s070.opt.xml">
ci_0001                 7.086064e-01 3 1  ON 0
ci_0002                 6.927483e-01 3 1  ON 1
ci_0003                -3.099697e-02 3 1  ON 2
ci_0004                -3.009163e-02 3 1  ON 3
ci_0005                -3.060382e-02 3 1  ON 4
ci_0006                -3.069586e-02 3 1  ON 5
ci_0007                -1.338103e-02 3 1  ON 6
ci_0008                -1.335090e-02 3 1  ON 7
ci_0009                -1.869650e-02 3 1  ON 8
ci_0010                -1.813030e-02 3 1  ON 9
ci_0011                -1.474501e-02 3 1  ON 10
ci_0012                -1.451136e-02 3 1  ON 11
ci_0013                 1.529423e-02 3 1  ON 12
ci_0014                 1.480516e-02 3 1  ON 13
ci_0015                 1.574767e-02 3 1  ON 14
ci_0016                 1.538634e-02 3 1  ON 15
ci_0017                 1.336743e-02 3 1  ON 16
ci_0018                 1.303907e-02 3 1  ON 17
ci_0019                 1.308951e-02 3 1  ON 18
ci_0020                 1.266842e-02 3 1  ON 19
ci_0021                 6.752726e-03 3 1  ON 20
ci_0022                 7.460547e-03 3 1  ON 21
ci_0023                -1.180403e-02 3 1  ON 22
ci_0024                -1.147024e-02 3 1  ON 23
ci_0025                -2.029588e-03 3 1  ON 24
ci_0026                -2.390717e-03 3 1  ON 25
ci_0027                -1.213155e-02 3 1  ON 26
ci_0028                -1.154914e-02 3 1  ON 27
ci_0029                -1.065830e-02 3 1  ON 28
ci_0030                -1.058733e-02 3 1  ON 29
ci_0031                 1.340909e-02 3 1  ON 30
ci_0032                 1.211456e-02 3 1  ON 31
ci_0033                 7.848180e-03 3 1  ON 32
ci_0034                 8.489643e-03 3 1  ON 33
ci_0035                 4.859446e-03 3 1  ON 34
ci_0036                 4.933695e-03 3 1  ON 35
ci_0037                -1.133360e-02 3 1  ON 36
ci_0038                -1.131341e-02 3 1  ON 37
ci_0039                -4.014998e-03 3 1  ON 38
ci_0040                -3.886155e-03 3 1  ON 39
ci_0041                 9.104242e-03 3 1  ON 40
ci_0042                 8.780944e-03 3 1  ON 41
ci_0043                -1.307373e-02 3 1  ON 42
ci_0044                -1.384580e-02 3 1  ON 43
ci_0045                 1.059116e-02 3 1  ON 44
ci_0046                 1.007867e-02 3 1  ON 45
ci_0047                -3.585077e-03 3 1  ON 46
ci_0048                -3.481620e-03 3 1  ON 47
ci_0049                -2.594605e-03 3 1  ON 48
ci_0050                -2.695911e-03 3 1  ON 49
ci_0051                -1.797596e-03 3 1  ON 50
ci_0052                -2.016110e-03 3 1  ON 51
ci_0053                -3.931437e-03 3 1  ON 52
ci_0054                -3.323931e-03 3 1  ON 53
ci_0055                 2.398799e-03 3 1  ON 54
ci_0056                 2.269775e-03 3 1  ON 55
ci_0057                 2.454008e-03 3 1  ON 56
ci_0058                 2.857261e-03 3 1  ON 57
ci_0059                -3.395815e-03 3 1  ON 58
ci_0060                -3.375886e-03 3 1  ON 59
ci_0061                -3.976492e-03 3 1  ON 60
ci_0062                -3.922345e-03 3 1  ON 61
ci_0063                -9.802577e-03 3 1  ON 62
ci_0064                -9.372607e-03 3 1  ON 63
ci_0065                -6.435469e-03 3 1  ON 64
ci_0066                -6.132135e-03 3 1  ON 65
ci_0067                -3.747954e-03 3 1  ON 66
ci_0068                -3.479520e-03 3 1  ON 67
ci_0069                 3.569209e-03 3 1  ON 68
ci_0070                 3.348554e-03 3 1  ON 69
ci_0071                 3.005292e-03 3 1  ON 70
ci_0072                 3.481714e-03 3 1  ON 71
ci_0073                 3.552607e-03 3 1  ON 72
ci_0074                 3.528857e-03 3 1  ON 73
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 70
    time step          = 0.05
    reference energy   = -16.9077
    reference variance = 0.280322
====================================================
  Execution time = 1.4060e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s070
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6898e+01
  VMC Evar = 2.9095e-01
  Total weights = 1.9507e+06
  Execution time = 1.8733e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.281250870245
                                         uncertainty =       0.001586105670

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.281250870245
                                         uncertainty =       0.001586105670

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000374980491
  error estimate for blocks of size 2^( 2) =       0.000392209105
  error estimate for blocks of size 2^( 3) =       0.000409486415
  error estimate for blocks of size 2^( 4) =       0.000425595475
  error estimate for blocks of size 2^( 5) =       0.000436919297
  error estimate for blocks of size 2^( 6) =       0.000445582174
  error estimate for blocks of size 2^( 7) =       0.000451035881

      target function =      -0.926893724058
              le_mean =     -16.898333241011
             les_mean =     285.844612266046
             stat err =       0.000439783207
             autocorr =       1.375497915259
   target nu stat err =       0.000439783207
   target dn stat err =       0.002113630960
      target stat err =       0.003410951315
              std dev =       0.530302495761
             le_variance =       0.281220737011

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.281250860203
                                         uncertainty =       0.001586103824

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.281250860203
                                         uncertainty =       0.001586103824

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000374980484
  error estimate for blocks of size 2^( 2) =       0.000392209098
  error estimate for blocks of size 2^( 3) =       0.000409486411
  error estimate for blocks of size 2^( 4) =       0.000425595470
  error estimate for blocks of size 2^( 5) =       0.000436919294
  error estimate for blocks of size 2^( 6) =       0.000445582180
  error estimate for blocks of size 2^( 7) =       0.000451035882

      target function =      -0.926893259775
              le_mean =     -16.898333242859
             les_mean =     285.844612623290
             stat err =       0.000439783206
             autocorr =       1.375497963388
   target nu stat err =       0.000439783206
   target dn stat err =       0.002113641581
      target stat err =       0.003410964309
              std dev =       0.530302486413
             le_variance =       0.281220727095

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.281250865222
                                         uncertainty =       0.001586104747

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.281250865222
                                         uncertainty =       0.001586104747

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000374980488
  error estimate for blocks of size 2^( 2) =       0.000392209102
  error estimate for blocks of size 2^( 3) =       0.000409486413
  error estimate for blocks of size 2^( 4) =       0.000425595472
  error estimate for blocks of size 2^( 5) =       0.000436919295
  error estimate for blocks of size 2^( 6) =       0.000445582177
  error estimate for blocks of size 2^( 7) =       0.000451035882

      target function =      -0.926893492821
              le_mean =     -16.898333241935
             les_mean =     285.844612444091
             stat err =       0.000439783206
             autocorr =       1.375497939329
   target nu stat err =       0.000439783206
   target dn stat err =       0.002113636251
      target stat err =       0.003410957788
              std dev =       0.530302491086
             le_variance =       0.281220732052

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.281250869617
                                         uncertainty =       0.001586105554

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.281250869617
                                         uncertainty =       0.001586105554

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000374980490
  error estimate for blocks of size 2^( 2) =       0.000392209105
  error estimate for blocks of size 2^( 3) =       0.000409486414
  error estimate for blocks of size 2^( 4) =       0.000425595475
  error estimate for blocks of size 2^( 5) =       0.000436919297
  error estimate for blocks of size 2^( 6) =       0.000445582174
  error estimate for blocks of size 2^( 7) =       0.000451035881

      target function =      -0.926893695258
              le_mean =     -16.898333241127
             les_mean =     285.844612288235
             stat err =       0.000439783207
             autocorr =       1.375497918266
   target nu stat err =       0.000439783207
   target dn stat err =       0.002113631619
      target stat err =       0.003410952122
              std dev =       0.530302495176
             le_variance =       0.281220736390


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.926893724058        initial  <--
     8.6736e+02     8.6736e+03             1.8128e-07        -0.926893259775
     3.4694e+03     3.4694e+04             4.5320e-08        -0.926893492821
     1.3878e+04     1.3878e+05             1.1330e-08        -0.926893695258

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 23.5032
  </log>
  <optVariables href="H2O.s070.opt.xml">
ci_0001                 7.086064e-01 3 1  ON 0
ci_0002                 6.927483e-01 3 1  ON 1
ci_0003                -3.099699e-02 3 1  ON 2
ci_0004                -3.009162e-02 3 1  ON 3
ci_0005                -3.060382e-02 3 1  ON 4
ci_0006                -3.069587e-02 3 1  ON 5
ci_0007                -1.338102e-02 3 1  ON 6
ci_0008                -1.335093e-02 3 1  ON 7
ci_0009                -1.869650e-02 3 1  ON 8
ci_0010                -1.813030e-02 3 1  ON 9
ci_0011                -1.474501e-02 3 1  ON 10
ci_0012                -1.451134e-02 3 1  ON 11
ci_0013                 1.529423e-02 3 1  ON 12
ci_0014                 1.480516e-02 3 1  ON 13
ci_0015                 1.574766e-02 3 1  ON 14
ci_0016                 1.538632e-02 3 1  ON 15
ci_0017                 1.336745e-02 3 1  ON 16
ci_0018                 1.303906e-02 3 1  ON 17
ci_0019                 1.308950e-02 3 1  ON 18
ci_0020                 1.266839e-02 3 1  ON 19
ci_0021                 6.752771e-03 3 1  ON 20
ci_0022                 7.460540e-03 3 1  ON 21
ci_0023                -1.180403e-02 3 1  ON 22
ci_0024                -1.147023e-02 3 1  ON 23
ci_0025                -2.029570e-03 3 1  ON 24
ci_0026                -2.390751e-03 3 1  ON 25
ci_0027                -1.213155e-02 3 1  ON 26
ci_0028                -1.154912e-02 3 1  ON 27
ci_0029                -1.065832e-02 3 1  ON 28
ci_0030                -1.058734e-02 3 1  ON 29
ci_0031                 1.340906e-02 3 1  ON 30
ci_0032                 1.211459e-02 3 1  ON 31
ci_0033                 7.848178e-03 3 1  ON 32
ci_0034                 8.489629e-03 3 1  ON 33
ci_0035                 4.859422e-03 3 1  ON 34
ci_0036                 4.933672e-03 3 1  ON 35
ci_0037                -1.133359e-02 3 1  ON 36
ci_0038                -1.131343e-02 3 1  ON 37
ci_0039                -4.014993e-03 3 1  ON 38
ci_0040                -3.886155e-03 3 1  ON 39
ci_0041                 9.104241e-03 3 1  ON 40
ci_0042                 8.780957e-03 3 1  ON 41
ci_0043                -1.307372e-02 3 1  ON 42
ci_0044                -1.384583e-02 3 1  ON 43
ci_0045                 1.059118e-02 3 1  ON 44
ci_0046                 1.007868e-02 3 1  ON 45
ci_0047                -3.585074e-03 3 1  ON 46
ci_0048                -3.481623e-03 3 1  ON 47
ci_0049                -2.594630e-03 3 1  ON 48
ci_0050                -2.695910e-03 3 1  ON 49
ci_0051                -1.797585e-03 3 1  ON 50
ci_0052                -2.016123e-03 3 1  ON 51
ci_0053                -3.931438e-03 3 1  ON 52
ci_0054                -3.323921e-03 3 1  ON 53
ci_0055                 2.398827e-03 3 1  ON 54
ci_0056                 2.269778e-03 3 1  ON 55
ci_0057                 2.453989e-03 3 1  ON 56
ci_0058                 2.857280e-03 3 1  ON 57
ci_0059                -3.395814e-03 3 1  ON 58
ci_0060                -3.375888e-03 3 1  ON 59
ci_0061                -3.976505e-03 3 1  ON 60
ci_0062                -3.922366e-03 3 1  ON 61
ci_0063                -9.802579e-03 3 1  ON 62
ci_0064                -9.372601e-03 3 1  ON 63
ci_0065                -6.435479e-03 3 1  ON 64
ci_0066                -6.132151e-03 3 1  ON 65
ci_0067                -3.747986e-03 3 1  ON 66
ci_0068                -3.479531e-03 3 1  ON 67
ci_0069                 3.569219e-03 3 1  ON 68
ci_0070                 3.348549e-03 3 1  ON 69
ci_0071                 3.005272e-03 3 1  ON 70
ci_0072                 3.481735e-03 3 1  ON 71
ci_0073                 3.552586e-03 3 1  ON 72
ci_0074                 3.528871e-03 3 1  ON 73
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 4.2512e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s071 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s071 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=71  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6904e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 71
    time step          = 0.05
    reference energy   = -16.8868
    reference variance = 0.203603
====================================================
  Execution time = 1.4248e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s071
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5262e+04
  VMC Eavg = -1.6898e+01
  VMC Evar = 2.9577e-01
  Total weights = 1.951285068e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 2.5795e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.284896472315
                                         uncertainty =       0.002254457697

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.284896472315
                                         uncertainty =       0.002254457697

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000377443249
  error estimate for blocks of size 2^( 2) =       0.000394449079
  error estimate for blocks of size 2^( 3) =       0.000411709751
  error estimate for blocks of size 2^( 4) =       0.000426664739
  error estimate for blocks of size 2^( 5) =       0.000438346555
  error estimate for blocks of size 2^( 6) =       0.000445945572
  error estimate for blocks of size 2^( 7) =       0.000452844387

      target function =      -0.919345706287
              le_mean =     -16.898424609517
             les_mean =     285.852528454284
             stat err =       0.000440950313
             autocorr =       1.364821916636
   target nu stat err =       0.000440950313
   target dn stat err =       0.002760626884
      target stat err =       0.004341206999
              std dev =       0.533785361400
             le_variance =       0.284926812045


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.689842460952e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 74
Check correct_vf_var_size: 225, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 8.6736e+03, overlap shift 8.6736e+04 and omega -1.7444e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.919364657559       residual = 1.34e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.919364664548       residual = 1.58e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.919364665588       residual = 5.02e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.919364666058       residual = 1.69e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.919364666186       residual = 6.17e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.919364666230       residual = 5.05e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.919364666237       residual = 2.51e-05           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.919364666242       residual = 1.16e-05           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.919364666258       residual = 1.20e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.919364666293       residual = 1.08e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.919364666283       residual = 9.66e-06           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.919364666260       residual = 3.78e-06           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.919364666311       residual = 8.36e-07           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.919364666300       residual = 3.42e-07           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.919364666324       residual = 9.89e-08           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.919364666325       residual = 3.65e-08           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.919364666325       residual = 9.95e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         16 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 8.6736e+03 is 2.840076e-08

solving harmonic davidson linear method for identity shift 3.4694e+04, overlap shift 3.4694e+05 and omega -1.7444e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.919364657559       residual = 1.34e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.919364659306       residual = 1.58e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.919364659566       residual = 5.02e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.919364659684       residual = 1.69e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.919364659716       residual = 6.17e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.919364659727       residual = 5.05e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.919364659729       residual = 2.51e-05           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.919364659734       residual = 1.16e-05           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.919364659734       residual = 1.20e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.919364659737       residual = 1.08e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.919364659743       residual = 9.66e-06           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.919364659749       residual = 3.78e-06           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.919364659791       residual = 8.36e-07           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.919364659750       residual = 3.42e-07           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.919364659750       residual = 9.89e-08           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.919364659756       residual = 3.65e-08           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.919364659750       residual = 9.95e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         16 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 3.4694e+04 is 7.100188e-09

solving harmonic davidson linear method for identity shift 1.3878e+05, overlap shift 1.3878e+06 and omega -1.7444e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.919364657559       residual = 1.34e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.919364657996       residual = 1.58e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.919364658061       residual = 5.02e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.919364658090       residual = 1.69e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.919364658098       residual = 6.17e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.919364658101       residual = 5.05e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.919364658101       residual = 2.51e-05           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.919364658103       residual = 1.16e-05           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.919364658103       residual = 1.20e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.919364658104       residual = 1.08e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.919364658105       residual = 9.66e-06           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.919364658107       residual = 3.78e-06           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.919364658107       residual = 8.36e-07           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.919364658107       residual = 3.42e-07           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.919364658107       residual = 9.89e-08           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.919364658107       residual = 3.65e-08           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.919364657995       residual = 9.95e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         16 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 1.3878e+05 is 1.775047e-09

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.841798 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 75 and numParams is: 74

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.6842e+01
  </log>
  <optVariables href="H2O.s071.opt.xml">
ci_0001                 7.086064e-01 3 1  ON 0
ci_0002                 6.927483e-01 3 1  ON 1
ci_0003                -3.099699e-02 3 1  ON 2
ci_0004                -3.009161e-02 3 1  ON 3
ci_0005                -3.060382e-02 3 1  ON 4
ci_0006                -3.069587e-02 3 1  ON 5
ci_0007                -1.338102e-02 3 1  ON 6
ci_0008                -1.335093e-02 3 1  ON 7
ci_0009                -1.869650e-02 3 1  ON 8
ci_0010                -1.813029e-02 3 1  ON 9
ci_0011                -1.474501e-02 3 1  ON 10
ci_0012                -1.451135e-02 3 1  ON 11
ci_0013                 1.529423e-02 3 1  ON 12
ci_0014                 1.480516e-02 3 1  ON 13
ci_0015                 1.574766e-02 3 1  ON 14
ci_0016                 1.538632e-02 3 1  ON 15
ci_0017                 1.336744e-02 3 1  ON 16
ci_0018                 1.303906e-02 3 1  ON 17
ci_0019                 1.308950e-02 3 1  ON 18
ci_0020                 1.266839e-02 3 1  ON 19
ci_0021                 6.752770e-03 3 1  ON 20
ci_0022                 7.460535e-03 3 1  ON 21
ci_0023                -1.180403e-02 3 1  ON 22
ci_0024                -1.147023e-02 3 1  ON 23
ci_0025                -2.029573e-03 3 1  ON 24
ci_0026                -2.390750e-03 3 1  ON 25
ci_0027                -1.213155e-02 3 1  ON 26
ci_0028                -1.154912e-02 3 1  ON 27
ci_0029                -1.065832e-02 3 1  ON 28
ci_0030                -1.058734e-02 3 1  ON 29
ci_0031                 1.340906e-02 3 1  ON 30
ci_0032                 1.211459e-02 3 1  ON 31
ci_0033                 7.848176e-03 3 1  ON 32
ci_0034                 8.489628e-03 3 1  ON 33
ci_0035                 4.859421e-03 3 1  ON 34
ci_0036                 4.933671e-03 3 1  ON 35
ci_0037                -1.133360e-02 3 1  ON 36
ci_0038                -1.131342e-02 3 1  ON 37
ci_0039                -4.014993e-03 3 1  ON 38
ci_0040                -3.886155e-03 3 1  ON 39
ci_0041                 9.104242e-03 3 1  ON 40
ci_0042                 8.780959e-03 3 1  ON 41
ci_0043                -1.307372e-02 3 1  ON 42
ci_0044                -1.384583e-02 3 1  ON 43
ci_0045                 1.059118e-02 3 1  ON 44
ci_0046                 1.007868e-02 3 1  ON 45
ci_0047                -3.585074e-03 3 1  ON 46
ci_0048                -3.481623e-03 3 1  ON 47
ci_0049                -2.594633e-03 3 1  ON 48
ci_0050                -2.695909e-03 3 1  ON 49
ci_0051                -1.797585e-03 3 1  ON 50
ci_0052                -2.016121e-03 3 1  ON 51
ci_0053                -3.931438e-03 3 1  ON 52
ci_0054                -3.323920e-03 3 1  ON 53
ci_0055                 2.398827e-03 3 1  ON 54
ci_0056                 2.269774e-03 3 1  ON 55
ci_0057                 2.453988e-03 3 1  ON 56
ci_0058                 2.857281e-03 3 1  ON 57
ci_0059                -3.395816e-03 3 1  ON 58
ci_0060                -3.375883e-03 3 1  ON 59
ci_0061                -3.976504e-03 3 1  ON 60
ci_0062                -3.922362e-03 3 1  ON 61
ci_0063                -9.802579e-03 3 1  ON 62
ci_0064                -9.372598e-03 3 1  ON 63
ci_0065                -6.435478e-03 3 1  ON 64
ci_0066                -6.132151e-03 3 1  ON 65
ci_0067                -3.747987e-03 3 1  ON 66
ci_0068                -3.479531e-03 3 1  ON 67
ci_0069                 3.569220e-03 3 1  ON 68
ci_0070                 3.348549e-03 3 1  ON 69
ci_0071                 3.005278e-03 3 1  ON 70
ci_0072                 3.481733e-03 3 1  ON 71
ci_0073                 3.552587e-03 3 1  ON 72
ci_0074                 3.528869e-03 3 1  ON 73
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 71
    time step          = 0.05
    reference energy   = -16.8622
    reference variance = 0.209703
====================================================
  Execution time = 1.3934e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s071
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6898e+01
  VMC Evar = 2.9082e-01
  Total weights = 1.9513e+06
  Execution time = 1.8665e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.282394592640
                                         uncertainty =       0.002166798475

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.282394592640
                                         uncertainty =       0.002166798475

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000375799170
  error estimate for blocks of size 2^( 2) =       0.000392877903
  error estimate for blocks of size 2^( 3) =       0.000410281006
  error estimate for blocks of size 2^( 4) =       0.000425538203
  error estimate for blocks of size 2^( 5) =       0.000436306646
  error estimate for blocks of size 2^( 6) =       0.000444031593
  error estimate for blocks of size 2^( 7) =       0.000448956687

      target function =      -0.927083403031
              le_mean =     -16.897843887613
             les_mean =     285.827945401305
             stat err =       0.000438708282
             autocorr =       1.362824815121
   target nu stat err =       0.000438708282
   target dn stat err =       0.002338721759
      target stat err =       0.003755363491
              std dev =       0.531460283599
             le_variance =       0.282450033043

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.282394590209
                                         uncertainty =       0.002166798342

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.282394590209
                                         uncertainty =       0.002166798342

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000375799169
  error estimate for blocks of size 2^( 2) =       0.000392877902
  error estimate for blocks of size 2^( 3) =       0.000410281006
  error estimate for blocks of size 2^( 4) =       0.000425538204
  error estimate for blocks of size 2^( 5) =       0.000436306646
  error estimate for blocks of size 2^( 6) =       0.000444031593
  error estimate for blocks of size 2^( 7) =       0.000448956688

      target function =      -0.927083367652
              le_mean =     -16.897843887903
             les_mean =     285.827945433564
             stat err =       0.000438708283
             autocorr =       1.362824829345
   target nu stat err =       0.000438708283
   target dn stat err =       0.002338722004
      target stat err =       0.003755363590
              std dev =       0.531460281348
             le_variance =       0.282450030650

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.282394591424
                                         uncertainty =       0.002166798408

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.282394591424
                                         uncertainty =       0.002166798408

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000375799170
  error estimate for blocks of size 2^( 2) =       0.000392877903
  error estimate for blocks of size 2^( 3) =       0.000410281006
  error estimate for blocks of size 2^( 4) =       0.000425538204
  error estimate for blocks of size 2^( 5) =       0.000436306646
  error estimate for blocks of size 2^( 6) =       0.000444031593
  error estimate for blocks of size 2^( 7) =       0.000448956688

      target function =      -0.927083385347
              le_mean =     -16.897843887758
             les_mean =     285.827945417431
             stat err =       0.000438708283
             autocorr =       1.362824822232
   target nu stat err =       0.000438708283
   target dn stat err =       0.002338721881
      target stat err =       0.003755363540
              std dev =       0.531460282473
             le_variance =       0.282450031847

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.282394592488
                                         uncertainty =       0.002166798467

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.282394592488
                                         uncertainty =       0.002166798467

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000375799170
  error estimate for blocks of size 2^( 2) =       0.000392877903
  error estimate for blocks of size 2^( 3) =       0.000410281006
  error estimate for blocks of size 2^( 4) =       0.000425538203
  error estimate for blocks of size 2^( 5) =       0.000436306646
  error estimate for blocks of size 2^( 6) =       0.000444031593
  error estimate for blocks of size 2^( 7) =       0.000448956687

      target function =      -0.927083400821
              le_mean =     -16.897843887631
             les_mean =     285.827945403320
             stat err =       0.000438708282
             autocorr =       1.362824816020
   target nu stat err =       0.000438708282
   target dn stat err =       0.002338721774
      target stat err =       0.003755363497
              std dev =       0.531460283458
             le_variance =       0.282450032893


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.927083403031        initial  <--
     8.6736e+03     8.6736e+04             2.8401e-08        -0.927083367652
     3.4694e+04     3.4694e+05             7.1002e-09        -0.927083385347
     1.3878e+05     1.3878e+06             1.7750e-09        -0.927083400821

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 23.3601
  </log>
  <optVariables href="H2O.s071.opt.xml">
ci_0001                 7.086064e-01 3 1  ON 0
ci_0002                 6.927483e-01 3 1  ON 1
ci_0003                -3.099699e-02 3 1  ON 2
ci_0004                -3.009162e-02 3 1  ON 3
ci_0005                -3.060382e-02 3 1  ON 4
ci_0006                -3.069587e-02 3 1  ON 5
ci_0007                -1.338102e-02 3 1  ON 6
ci_0008                -1.335093e-02 3 1  ON 7
ci_0009                -1.869650e-02 3 1  ON 8
ci_0010                -1.813030e-02 3 1  ON 9
ci_0011                -1.474501e-02 3 1  ON 10
ci_0012                -1.451134e-02 3 1  ON 11
ci_0013                 1.529423e-02 3 1  ON 12
ci_0014                 1.480516e-02 3 1  ON 13
ci_0015                 1.574766e-02 3 1  ON 14
ci_0016                 1.538632e-02 3 1  ON 15
ci_0017                 1.336745e-02 3 1  ON 16
ci_0018                 1.303906e-02 3 1  ON 17
ci_0019                 1.308950e-02 3 1  ON 18
ci_0020                 1.266839e-02 3 1  ON 19
ci_0021                 6.752771e-03 3 1  ON 20
ci_0022                 7.460540e-03 3 1  ON 21
ci_0023                -1.180403e-02 3 1  ON 22
ci_0024                -1.147023e-02 3 1  ON 23
ci_0025                -2.029570e-03 3 1  ON 24
ci_0026                -2.390751e-03 3 1  ON 25
ci_0027                -1.213155e-02 3 1  ON 26
ci_0028                -1.154912e-02 3 1  ON 27
ci_0029                -1.065832e-02 3 1  ON 28
ci_0030                -1.058734e-02 3 1  ON 29
ci_0031                 1.340906e-02 3 1  ON 30
ci_0032                 1.211459e-02 3 1  ON 31
ci_0033                 7.848178e-03 3 1  ON 32
ci_0034                 8.489629e-03 3 1  ON 33
ci_0035                 4.859422e-03 3 1  ON 34
ci_0036                 4.933672e-03 3 1  ON 35
ci_0037                -1.133359e-02 3 1  ON 36
ci_0038                -1.131343e-02 3 1  ON 37
ci_0039                -4.014993e-03 3 1  ON 38
ci_0040                -3.886155e-03 3 1  ON 39
ci_0041                 9.104241e-03 3 1  ON 40
ci_0042                 8.780957e-03 3 1  ON 41
ci_0043                -1.307372e-02 3 1  ON 42
ci_0044                -1.384583e-02 3 1  ON 43
ci_0045                 1.059118e-02 3 1  ON 44
ci_0046                 1.007868e-02 3 1  ON 45
ci_0047                -3.585074e-03 3 1  ON 46
ci_0048                -3.481623e-03 3 1  ON 47
ci_0049                -2.594630e-03 3 1  ON 48
ci_0050                -2.695910e-03 3 1  ON 49
ci_0051                -1.797585e-03 3 1  ON 50
ci_0052                -2.016123e-03 3 1  ON 51
ci_0053                -3.931438e-03 3 1  ON 52
ci_0054                -3.323921e-03 3 1  ON 53
ci_0055                 2.398827e-03 3 1  ON 54
ci_0056                 2.269778e-03 3 1  ON 55
ci_0057                 2.453989e-03 3 1  ON 56
ci_0058                 2.857280e-03 3 1  ON 57
ci_0059                -3.395814e-03 3 1  ON 58
ci_0060                -3.375888e-03 3 1  ON 59
ci_0061                -3.976505e-03 3 1  ON 60
ci_0062                -3.922366e-03 3 1  ON 61
ci_0063                -9.802579e-03 3 1  ON 62
ci_0064                -9.372601e-03 3 1  ON 63
ci_0065                -6.435479e-03 3 1  ON 64
ci_0066                -6.132151e-03 3 1  ON 65
ci_0067                -3.747986e-03 3 1  ON 66
ci_0068                -3.479531e-03 3 1  ON 67
ci_0069                 3.569219e-03 3 1  ON 68
ci_0070                 3.348549e-03 3 1  ON 69
ci_0071                 3.005272e-03 3 1  ON 70
ci_0072                 3.481735e-03 3 1  ON 71
ci_0073                 3.552586e-03 3 1  ON 72
ci_0074                 3.528871e-03 3 1  ON 73
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 4.0217e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s072 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s072 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=72  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6904e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 72
    time step          = 0.05
    reference energy   = -16.8225
    reference variance = 0.267048
====================================================
  Execution time = 1.4343e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s072
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5252e+04
  VMC Eavg = -1.6899e+01
  VMC Evar = 2.9202e-01
  Total weights = 1.951054977e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 2.5865e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.281326474516
                                         uncertainty =       0.002543780832

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.281326474516
                                         uncertainty =       0.002543780832

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000375021340
  error estimate for blocks of size 2^( 2) =       0.000392639191
  error estimate for blocks of size 2^( 3) =       0.000410086967
  error estimate for blocks of size 2^( 4) =       0.000425980626
  error estimate for blocks of size 2^( 5) =       0.000439176986
  error estimate for blocks of size 2^( 6) =       0.000446674685
  error estimate for blocks of size 2^( 7) =       0.000450687127

      target function =      -0.925189493839
              le_mean =     -16.898771117196
             les_mean =     285.860489381785
             stat err =       0.000440629856
             autocorr =       1.380498309775
   target nu stat err =       0.000440629856
   target dn stat err =       0.003263627952
      target stat err =       0.005178511487
              std dev =       0.530360264775
             le_variance =       0.281282010453


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.689877111720e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 74
Check correct_vf_var_size: 225, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 8.6736e+04, overlap shift 8.6736e+05 and omega -1.7444e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.925217207746       residual = 1.92e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.925217208707       residual = 2.61e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.925217208815       residual = 5.57e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.925217208880       residual = 3.47e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.925217208919       residual = 1.83e-04           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.925217208997       residual = 1.12e-04           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.925217208890       residual = 6.18e-05           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.925217208746       residual = 5.35e-05           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.925217209082       residual = 7.00e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.925217208920       residual = 2.26e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.925217209241       residual = 1.15e-05           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.925217208851       residual = 5.64e-06           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.925217208908       residual = 1.57e-06           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.925217208946       residual = 4.76e-07           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.925217208969       residual = 1.28e-07           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.925217208960       residual = 3.31e-08           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.925217209111       residual = 1.15e-08           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.925217208908       residual = 3.88e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         17 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 8.6736e+04 is 5.650710e-09

solving harmonic davidson linear method for identity shift 3.4694e+05, overlap shift 3.4694e+06 and omega -1.7444e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.925217207746       residual = 1.92e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.925217207986       residual = 2.61e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.925217208013       residual = 5.57e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.925217208030       residual = 3.47e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.925217208141       residual = 1.83e-04           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.925217208103       residual = 1.12e-04           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.925217208801       residual = 6.18e-05           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.925217207842       residual = 5.35e-05           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.925217208452       residual = 7.00e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.925217208404       residual = 2.26e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.925217207840       residual = 1.15e-05           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.925217206258       residual = 5.64e-06           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.925217207504       residual = 1.57e-06           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.925217208200       residual = 4.76e-07           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.925217207367       residual = 1.28e-07           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.925217208310       residual = 3.31e-08           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.925217207769       residual = 1.15e-08           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.925217208338       residual = 3.88e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         17 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 3.4694e+05 is 1.412677e-09

solving harmonic davidson linear method for identity shift 1.3878e+06, overlap shift 1.3878e+07 and omega -1.7444e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.925217207746       residual = 1.92e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.925217207806       residual = 2.61e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.925217207813       residual = 5.57e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.925217207817       residual = 3.47e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.925217208473       residual = 1.83e-04           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.925217207409       residual = 1.12e-04           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.925217206511       residual = 6.18e-05           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.925217209032       residual = 5.35e-05           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.925217211239       residual = 7.00e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.925217207264       residual = 2.26e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.925217205054       residual = 1.15e-05           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.925217206436       residual = 5.64e-06           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.925217209527       residual = 1.57e-06           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.925217206197       residual = 4.76e-07           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.925217207608       residual = 1.28e-07           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.925217207049       residual = 3.31e-08           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.925217208184       residual = 1.15e-08           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.925217207677       residual = 3.88e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         17 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 1.3878e+06 is 3.531693e-10

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.851856 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 75 and numParams is: 74

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.6945e+01
  </log>
  <optVariables href="H2O.s072.opt.xml">
ci_0001                 7.086064e-01 3 1  ON 0
ci_0002                 6.927483e-01 3 1  ON 1
ci_0003                -3.099699e-02 3 1  ON 2
ci_0004                -3.009162e-02 3 1  ON 3
ci_0005                -3.060382e-02 3 1  ON 4
ci_0006                -3.069587e-02 3 1  ON 5
ci_0007                -1.338102e-02 3 1  ON 6
ci_0008                -1.335093e-02 3 1  ON 7
ci_0009                -1.869650e-02 3 1  ON 8
ci_0010                -1.813030e-02 3 1  ON 9
ci_0011                -1.474501e-02 3 1  ON 10
ci_0012                -1.451134e-02 3 1  ON 11
ci_0013                 1.529423e-02 3 1  ON 12
ci_0014                 1.480516e-02 3 1  ON 13
ci_0015                 1.574766e-02 3 1  ON 14
ci_0016                 1.538632e-02 3 1  ON 15
ci_0017                 1.336745e-02 3 1  ON 16
ci_0018                 1.303906e-02 3 1  ON 17
ci_0019                 1.308950e-02 3 1  ON 18
ci_0020                 1.266839e-02 3 1  ON 19
ci_0021                 6.752771e-03 3 1  ON 20
ci_0022                 7.460540e-03 3 1  ON 21
ci_0023                -1.180403e-02 3 1  ON 22
ci_0024                -1.147023e-02 3 1  ON 23
ci_0025                -2.029570e-03 3 1  ON 24
ci_0026                -2.390750e-03 3 1  ON 25
ci_0027                -1.213155e-02 3 1  ON 26
ci_0028                -1.154912e-02 3 1  ON 27
ci_0029                -1.065832e-02 3 1  ON 28
ci_0030                -1.058734e-02 3 1  ON 29
ci_0031                 1.340906e-02 3 1  ON 30
ci_0032                 1.211459e-02 3 1  ON 31
ci_0033                 7.848178e-03 3 1  ON 32
ci_0034                 8.489628e-03 3 1  ON 33
ci_0035                 4.859421e-03 3 1  ON 34
ci_0036                 4.933672e-03 3 1  ON 35
ci_0037                -1.133359e-02 3 1  ON 36
ci_0038                -1.131343e-02 3 1  ON 37
ci_0039                -4.014992e-03 3 1  ON 38
ci_0040                -3.886155e-03 3 1  ON 39
ci_0041                 9.104241e-03 3 1  ON 40
ci_0042                 8.780957e-03 3 1  ON 41
ci_0043                -1.307372e-02 3 1  ON 42
ci_0044                -1.384583e-02 3 1  ON 43
ci_0045                 1.059118e-02 3 1  ON 44
ci_0046                 1.007868e-02 3 1  ON 45
ci_0047                -3.585075e-03 3 1  ON 46
ci_0048                -3.481623e-03 3 1  ON 47
ci_0049                -2.594630e-03 3 1  ON 48
ci_0050                -2.695910e-03 3 1  ON 49
ci_0051                -1.797585e-03 3 1  ON 50
ci_0052                -2.016123e-03 3 1  ON 51
ci_0053                -3.931437e-03 3 1  ON 52
ci_0054                -3.323922e-03 3 1  ON 53
ci_0055                 2.398828e-03 3 1  ON 54
ci_0056                 2.269778e-03 3 1  ON 55
ci_0057                 2.453988e-03 3 1  ON 56
ci_0058                 2.857281e-03 3 1  ON 57
ci_0059                -3.395814e-03 3 1  ON 58
ci_0060                -3.375888e-03 3 1  ON 59
ci_0061                -3.976504e-03 3 1  ON 60
ci_0062                -3.922366e-03 3 1  ON 61
ci_0063                -9.802579e-03 3 1  ON 62
ci_0064                -9.372600e-03 3 1  ON 63
ci_0065                -6.435479e-03 3 1  ON 64
ci_0066                -6.132151e-03 3 1  ON 65
ci_0067                -3.747986e-03 3 1  ON 66
ci_0068                -3.479531e-03 3 1  ON 67
ci_0069                 3.569219e-03 3 1  ON 68
ci_0070                 3.348549e-03 3 1  ON 69
ci_0071                 3.005272e-03 3 1  ON 70
ci_0072                 3.481735e-03 3 1  ON 71
ci_0073                 3.552586e-03 3 1  ON 72
ci_0074                 3.528871e-03 3 1  ON 73
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 72
    time step          = 0.05
    reference energy   = -16.9147
    reference variance = 0.462383
====================================================
  Execution time = 1.3929e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s072
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6899e+01
  VMC Evar = 2.9068e-01
  Total weights = 1.9511e+06
  Execution time = 1.8831e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.280327371119
                                         uncertainty =       0.001416441036

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.280327371119
                                         uncertainty =       0.001416441036

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000374376269
  error estimate for blocks of size 2^( 2) =       0.000391075002
  error estimate for blocks of size 2^( 3) =       0.000408645419
  error estimate for blocks of size 2^( 4) =       0.000423615128
  error estimate for blocks of size 2^( 5) =       0.000433978038
  error estimate for blocks of size 2^( 6) =       0.000440517030
  error estimate for blocks of size 2^( 7) =       0.000445923648

      target function =      -0.927325082721
              le_mean =     -16.898850261564
             les_mean =     285.861819361013
             stat err =       0.000436008461
             autocorr =       1.356354493769
   target nu stat err =       0.000436008461
   target dn stat err =       0.002016163826
      target stat err =       0.003265963862
              std dev =       0.529447997046
             le_variance =       0.280315181576

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.280327371220
                                         uncertainty =       0.001416441053

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.280327371220
                                         uncertainty =       0.001416441053

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000374376269
  error estimate for blocks of size 2^( 2) =       0.000391075002
  error estimate for blocks of size 2^( 3) =       0.000408645419
  error estimate for blocks of size 2^( 4) =       0.000423615128
  error estimate for blocks of size 2^( 5) =       0.000433978038
  error estimate for blocks of size 2^( 6) =       0.000440517030
  error estimate for blocks of size 2^( 7) =       0.000445923648

      target function =      -0.927325083610
              le_mean =     -16.898850261592
             les_mean =     285.861819361388
             stat err =       0.000436008461
             autocorr =       1.356354492209
   target nu stat err =       0.000436008461
   target dn stat err =       0.002016163860
      target stat err =       0.003265963920
              std dev =       0.529447997141
             le_variance =       0.280315181676

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.280327371169
                                         uncertainty =       0.001416441045

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.280327371169
                                         uncertainty =       0.001416441045

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000374376269
  error estimate for blocks of size 2^( 2) =       0.000391075002
  error estimate for blocks of size 2^( 3) =       0.000408645419
  error estimate for blocks of size 2^( 4) =       0.000423615128
  error estimate for blocks of size 2^( 5) =       0.000433978038
  error estimate for blocks of size 2^( 6) =       0.000440517030
  error estimate for blocks of size 2^( 7) =       0.000445923648

      target function =      -0.927325083166
              le_mean =     -16.898850261578
             les_mean =     285.861819361200
             stat err =       0.000436008461
             autocorr =       1.356354492985
   target nu stat err =       0.000436008461
   target dn stat err =       0.002016163843
      target stat err =       0.003265963891
              std dev =       0.529447997094
             le_variance =       0.280315181626

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.280327371125
                                         uncertainty =       0.001416441037

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.280327371125
                                         uncertainty =       0.001416441037

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000374376269
  error estimate for blocks of size 2^( 2) =       0.000391075002
  error estimate for blocks of size 2^( 3) =       0.000408645419
  error estimate for blocks of size 2^( 4) =       0.000423615128
  error estimate for blocks of size 2^( 5) =       0.000433978038
  error estimate for blocks of size 2^( 6) =       0.000440517030
  error estimate for blocks of size 2^( 7) =       0.000445923648

      target function =      -0.927325082776
              le_mean =     -16.898850261566
             les_mean =     285.861819361036
             stat err =       0.000436008461
             autocorr =       1.356354493675
   target nu stat err =       0.000436008461
   target dn stat err =       0.002016163828
      target stat err =       0.003265963866
              std dev =       0.529447997052
             le_variance =       0.280315181583


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.927325082721        initial
     8.6736e+04     8.6736e+05             5.6507e-09        -0.927325083610  <--
     3.4694e+05     3.4694e+06             1.4127e-09        -0.927325083166
     1.3878e+06     1.3878e+07             3.5317e-10        -0.927325082776

*****************************************************************************
Applying the update for shift_i =   8.6736e+04     and shift_s =   8.6736e+05
*****************************************************************************

  Execution time = 2.3385e+01
  </log>
  <optVariables href="H2O.s072.opt.xml">
ci_0001                 7.086064e-01 3 1  ON 0
ci_0002                 6.927483e-01 3 1  ON 1
ci_0003                -3.099699e-02 3 1  ON 2
ci_0004                -3.009162e-02 3 1  ON 3
ci_0005                -3.060382e-02 3 1  ON 4
ci_0006                -3.069586e-02 3 1  ON 5
ci_0007                -1.338102e-02 3 1  ON 6
ci_0008                -1.335093e-02 3 1  ON 7
ci_0009                -1.869650e-02 3 1  ON 8
ci_0010                -1.813030e-02 3 1  ON 9
ci_0011                -1.474501e-02 3 1  ON 10
ci_0012                -1.451134e-02 3 1  ON 11
ci_0013                 1.529423e-02 3 1  ON 12
ci_0014                 1.480516e-02 3 1  ON 13
ci_0015                 1.574766e-02 3 1  ON 14
ci_0016                 1.538632e-02 3 1  ON 15
ci_0017                 1.336745e-02 3 1  ON 16
ci_0018                 1.303906e-02 3 1  ON 17
ci_0019                 1.308950e-02 3 1  ON 18
ci_0020                 1.266839e-02 3 1  ON 19
ci_0021                 6.752770e-03 3 1  ON 20
ci_0022                 7.460538e-03 3 1  ON 21
ci_0023                -1.180403e-02 3 1  ON 22
ci_0024                -1.147023e-02 3 1  ON 23
ci_0025                -2.029570e-03 3 1  ON 24
ci_0026                -2.390747e-03 3 1  ON 25
ci_0027                -1.213155e-02 3 1  ON 26
ci_0028                -1.154912e-02 3 1  ON 27
ci_0029                -1.065832e-02 3 1  ON 28
ci_0030                -1.058734e-02 3 1  ON 29
ci_0031                 1.340907e-02 3 1  ON 30
ci_0032                 1.211459e-02 3 1  ON 31
ci_0033                 7.848177e-03 3 1  ON 32
ci_0034                 8.489627e-03 3 1  ON 33
ci_0035                 4.859421e-03 3 1  ON 34
ci_0036                 4.933671e-03 3 1  ON 35
ci_0037                -1.133359e-02 3 1  ON 36
ci_0038                -1.131343e-02 3 1  ON 37
ci_0039                -4.014992e-03 3 1  ON 38
ci_0040                -3.886155e-03 3 1  ON 39
ci_0041                 9.104241e-03 3 1  ON 40
ci_0042                 8.780957e-03 3 1  ON 41
ci_0043                -1.307372e-02 3 1  ON 42
ci_0044                -1.384583e-02 3 1  ON 43
ci_0045                 1.059118e-02 3 1  ON 44
ci_0046                 1.007868e-02 3 1  ON 45
ci_0047                -3.585075e-03 3 1  ON 46
ci_0048                -3.481623e-03 3 1  ON 47
ci_0049                -2.594629e-03 3 1  ON 48
ci_0050                -2.695910e-03 3 1  ON 49
ci_0051                -1.797585e-03 3 1  ON 50
ci_0052                -2.016123e-03 3 1  ON 51
ci_0053                -3.931437e-03 3 1  ON 52
ci_0054                -3.323922e-03 3 1  ON 53
ci_0055                 2.398828e-03 3 1  ON 54
ci_0056                 2.269778e-03 3 1  ON 55
ci_0057                 2.453986e-03 3 1  ON 56
ci_0058                 2.857281e-03 3 1  ON 57
ci_0059                -3.395815e-03 3 1  ON 58
ci_0060                -3.375888e-03 3 1  ON 59
ci_0061                -3.976504e-03 3 1  ON 60
ci_0062                -3.922365e-03 3 1  ON 61
ci_0063                -9.802580e-03 3 1  ON 62
ci_0064                -9.372600e-03 3 1  ON 63
ci_0065                -6.435479e-03 3 1  ON 64
ci_0066                -6.132151e-03 3 1  ON 65
ci_0067                -3.747986e-03 3 1  ON 66
ci_0068                -3.479531e-03 3 1  ON 67
ci_0069                 3.569219e-03 3 1  ON 68
ci_0070                 3.348549e-03 3 1  ON 69
ci_0071                 3.005272e-03 3 1  ON 70
ci_0072                 3.481734e-03 3 1  ON 71
ci_0073                 3.552587e-03 3 1  ON 72
ci_0074                 3.528871e-03 3 1  ON 73
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 4.0364e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s073 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s073 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=73  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6903e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 73
    time step          = 0.05
    reference energy   = -16.8533
    reference variance = 0.293875
====================================================
  Execution time = 1.4291e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s073
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5243e+04
  VMC Eavg = -1.6898e+01
  VMC Evar = 2.9072e-01
  Total weights = 1.950997524e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 2.6045e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.281393664084
                                         uncertainty =       0.001276732125

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.281393664084
                                         uncertainty =       0.001276732125

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000375075561
  error estimate for blocks of size 2^( 2) =       0.000391793281
  error estimate for blocks of size 2^( 3) =       0.000409130466
  error estimate for blocks of size 2^( 4) =       0.000423854410
  error estimate for blocks of size 2^( 5) =       0.000435433383
  error estimate for blocks of size 2^( 6) =       0.000443591030
  error estimate for blocks of size 2^( 7) =       0.000445232377

      target function =      -0.927236777250
              le_mean =     -16.897933169887
             les_mean =     285.830869921750
             stat err =       0.000437027800
             autocorr =       1.357627393184
   target nu stat err =       0.000437027800
   target dn stat err =       0.001884647774
      target stat err =       0.003058975555
              std dev =       0.530436945558
             le_variance =       0.281363353213


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.689793316989e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 74
Check correct_vf_var_size: 225, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.1684e+04, overlap shift 2.1684e+05 and omega -1.7444e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.927245446168       residual = 7.86e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.927245447999       residual = 1.26e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.927245448174       residual = 4.14e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.927245448323       residual = 2.74e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.927245448386       residual = 1.17e-04           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.927245448342       residual = 4.14e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.927245448352       residual = 7.99e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.927245448356       residual = 2.65e-06           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.927245448344       residual = 1.74e-06           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.927245448295       residual = 7.83e-07           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.927245448380       residual = 2.59e-07           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.927245448343       residual = 8.56e-08           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.927245448371       residual = 8.65e-08           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.927245448343       residual = 7.39e-08           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.927245448343       residual = 7.06e-08           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.927245448342       residual = 3.63e-08           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.927245448342       residual = 1.49e-08           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.927245448325       residual = 2.93e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         17 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 2.1684e+04 is 1.570655e-08

solving harmonic davidson linear method for identity shift 8.6736e+04, overlap shift 8.6736e+05 and omega -1.7444e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.927245446168       residual = 7.86e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.927245446626       residual = 1.26e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.927245446669       residual = 4.14e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.927245446707       residual = 2.74e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.927245446722       residual = 1.17e-04           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.927245446712       residual = 4.14e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.927245446714       residual = 7.99e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.927245446614       residual = 2.65e-06           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.927245446712       residual = 1.74e-06           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.927245446712       residual = 7.83e-07           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.927245446712       residual = 2.59e-07           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.927245446712       residual = 8.56e-08           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.927245446712       residual = 8.65e-08           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.927245446919       residual = 7.39e-08           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.927245446901       residual = 7.06e-08           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.927245446741       residual = 3.63e-08           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.927245446681       residual = 1.49e-08           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.927245446710       residual = 2.93e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         17 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 8.6736e+04 is 3.926646e-09

solving harmonic davidson linear method for identity shift 3.4694e+05, overlap shift 3.4694e+06 and omega -1.7444e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.927245446168       residual = 7.86e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.927245446282       residual = 1.26e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.927245446293       residual = 4.14e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.927245446303       residual = 2.74e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.927245446154       residual = 1.17e-04           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.927245446304       residual = 4.14e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.927245446337       residual = 7.99e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.927245446304       residual = 2.65e-06           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.927245445962       residual = 1.74e-06           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.927245446304       residual = 7.83e-07           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.927245446304       residual = 2.59e-07           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.927245447274       residual = 8.56e-08           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.927245446304       residual = 8.65e-08           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.927245445650       residual = 7.39e-08           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.927245446304       residual = 7.06e-08           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.927245445850       residual = 3.63e-08           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.927245446199       residual = 1.49e-08           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.927245446605       residual = 2.93e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         17 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 3.4694e+05 is 9.816620e-10

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.861889 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 75 and numParams is: 74

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.6910e+01
  </log>
  <optVariables href="H2O.s073.opt.xml">
ci_0001                 7.086064e-01 3 1  ON 0
ci_0002                 6.927483e-01 3 1  ON 1
ci_0003                -3.099699e-02 3 1  ON 2
ci_0004                -3.009162e-02 3 1  ON 3
ci_0005                -3.060382e-02 3 1  ON 4
ci_0006                -3.069587e-02 3 1  ON 5
ci_0007                -1.338103e-02 3 1  ON 6
ci_0008                -1.335093e-02 3 1  ON 7
ci_0009                -1.869650e-02 3 1  ON 8
ci_0010                -1.813030e-02 3 1  ON 9
ci_0011                -1.474501e-02 3 1  ON 10
ci_0012                -1.451134e-02 3 1  ON 11
ci_0013                 1.529423e-02 3 1  ON 12
ci_0014                 1.480516e-02 3 1  ON 13
ci_0015                 1.574766e-02 3 1  ON 14
ci_0016                 1.538632e-02 3 1  ON 15
ci_0017                 1.336745e-02 3 1  ON 16
ci_0018                 1.303906e-02 3 1  ON 17
ci_0019                 1.308950e-02 3 1  ON 18
ci_0020                 1.266839e-02 3 1  ON 19
ci_0021                 6.752766e-03 3 1  ON 20
ci_0022                 7.460536e-03 3 1  ON 21
ci_0023                -1.180403e-02 3 1  ON 22
ci_0024                -1.147023e-02 3 1  ON 23
ci_0025                -2.029570e-03 3 1  ON 24
ci_0026                -2.390747e-03 3 1  ON 25
ci_0027                -1.213155e-02 3 1  ON 26
ci_0028                -1.154912e-02 3 1  ON 27
ci_0029                -1.065832e-02 3 1  ON 28
ci_0030                -1.058734e-02 3 1  ON 29
ci_0031                 1.340906e-02 3 1  ON 30
ci_0032                 1.211459e-02 3 1  ON 31
ci_0033                 7.848179e-03 3 1  ON 32
ci_0034                 8.489626e-03 3 1  ON 33
ci_0035                 4.859420e-03 3 1  ON 34
ci_0036                 4.933671e-03 3 1  ON 35
ci_0037                -1.133359e-02 3 1  ON 36
ci_0038                -1.131343e-02 3 1  ON 37
ci_0039                -4.014992e-03 3 1  ON 38
ci_0040                -3.886155e-03 3 1  ON 39
ci_0041                 9.104241e-03 3 1  ON 40
ci_0042                 8.780957e-03 3 1  ON 41
ci_0043                -1.307372e-02 3 1  ON 42
ci_0044                -1.384583e-02 3 1  ON 43
ci_0045                 1.059118e-02 3 1  ON 44
ci_0046                 1.007868e-02 3 1  ON 45
ci_0047                -3.585075e-03 3 1  ON 46
ci_0048                -3.481623e-03 3 1  ON 47
ci_0049                -2.594629e-03 3 1  ON 48
ci_0050                -2.695910e-03 3 1  ON 49
ci_0051                -1.797585e-03 3 1  ON 50
ci_0052                -2.016123e-03 3 1  ON 51
ci_0053                -3.931436e-03 3 1  ON 52
ci_0054                -3.323922e-03 3 1  ON 53
ci_0055                 2.398828e-03 3 1  ON 54
ci_0056                 2.269778e-03 3 1  ON 55
ci_0057                 2.453988e-03 3 1  ON 56
ci_0058                 2.857282e-03 3 1  ON 57
ci_0059                -3.395815e-03 3 1  ON 58
ci_0060                -3.375888e-03 3 1  ON 59
ci_0061                -3.976505e-03 3 1  ON 60
ci_0062                -3.922365e-03 3 1  ON 61
ci_0063                -9.802580e-03 3 1  ON 62
ci_0064                -9.372599e-03 3 1  ON 63
ci_0065                -6.435478e-03 3 1  ON 64
ci_0066                -6.132152e-03 3 1  ON 65
ci_0067                -3.747986e-03 3 1  ON 66
ci_0068                -3.479530e-03 3 1  ON 67
ci_0069                 3.569219e-03 3 1  ON 68
ci_0070                 3.348549e-03 3 1  ON 69
ci_0071                 3.005273e-03 3 1  ON 70
ci_0072                 3.481734e-03 3 1  ON 71
ci_0073                 3.552586e-03 3 1  ON 72
ci_0074                 3.528870e-03 3 1  ON 73
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 73
    time step          = 0.05
    reference energy   = -16.9503
    reference variance = 0.249569
====================================================
  Execution time = 1.3835e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s073
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6899e+01
  VMC Evar = 2.9462e-01
  Total weights = 1.9512e+06
  Execution time = 1.9814e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.284684475455
                                         uncertainty =       0.001970899462

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.284684475455
                                         uncertainty =       0.001970899462

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000377245498
  error estimate for blocks of size 2^( 2) =       0.000394247294
  error estimate for blocks of size 2^( 3) =       0.000411208231
  error estimate for blocks of size 2^( 4) =       0.000426793961
  error estimate for blocks of size 2^( 5) =       0.000438956516
  error estimate for blocks of size 2^( 6) =       0.000447030217
  error estimate for blocks of size 2^( 7) =       0.000453826320

      target function =      -0.921144714939
              le_mean =     -16.898576608655
             les_mean =     285.856507755575
             stat err =       0.000441651754
             autocorr =       1.370603347329
   target nu stat err =       0.000441651754
   target dn stat err =       0.002707287480
      target stat err =       0.004277639928
              std dev =       0.533505699049
             le_variance =       0.284628330918

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.284684472801
                                         uncertainty =       0.001970898867

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.284684472801
                                         uncertainty =       0.001970898867

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000377245496
  error estimate for blocks of size 2^( 2) =       0.000394247292
  error estimate for blocks of size 2^( 3) =       0.000411208229
  error estimate for blocks of size 2^( 4) =       0.000426793959
  error estimate for blocks of size 2^( 5) =       0.000438956515
  error estimate for blocks of size 2^( 6) =       0.000447030215
  error estimate for blocks of size 2^( 7) =       0.000453826318

      target function =      -0.921144712673
              le_mean =     -16.898576608703
             les_mean =     285.856507758651
             stat err =       0.000441651752
             autocorr =       1.370603347709
   target nu stat err =       0.000441651752
   target dn stat err =       0.002707287278
      target stat err =       0.004277639597
              std dev =       0.533505696565
             le_variance =       0.284628328267

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.284684474128
                                         uncertainty =       0.001970899164

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.284684474128
                                         uncertainty =       0.001970899164

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000377245497
  error estimate for blocks of size 2^( 2) =       0.000394247293
  error estimate for blocks of size 2^( 3) =       0.000411208230
  error estimate for blocks of size 2^( 4) =       0.000426793960
  error estimate for blocks of size 2^( 5) =       0.000438956515
  error estimate for blocks of size 2^( 6) =       0.000447030216
  error estimate for blocks of size 2^( 7) =       0.000453826319

      target function =      -0.921144713806
              le_mean =     -16.898576608679
             les_mean =     285.856507757113
             stat err =       0.000441651753
             autocorr =       1.370603347519
   target nu stat err =       0.000441651753
   target dn stat err =       0.002707287379
      target stat err =       0.004277639762
              std dev =       0.533505697807
             le_variance =       0.284628329592

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.284684475289
                                         uncertainty =       0.001970899424

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.284684475289
                                         uncertainty =       0.001970899424

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000377245497
  error estimate for blocks of size 2^( 2) =       0.000394247294
  error estimate for blocks of size 2^( 3) =       0.000411208231
  error estimate for blocks of size 2^( 4) =       0.000426793961
  error estimate for blocks of size 2^( 5) =       0.000438956516
  error estimate for blocks of size 2^( 6) =       0.000447030217
  error estimate for blocks of size 2^( 7) =       0.000453826320

      target function =      -0.921144714797
              le_mean =     -16.898576608658
             les_mean =     285.856507755768
             stat err =       0.000441651754
             autocorr =       1.370603347352
   target nu stat err =       0.000441651754
   target dn stat err =       0.002707287468
      target stat err =       0.004277639907
              std dev =       0.533505698894
             le_variance =       0.284628330752


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.921144714939        initial  <--
     2.1684e+04     2.1684e+05             1.5707e-08        -0.921144712673
     8.6736e+04     8.6736e+05             3.9266e-09        -0.921144713806
     3.4694e+05     3.4694e+06             9.8166e-10        -0.921144714797

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 23.4164
  </log>
  <optVariables href="H2O.s073.opt.xml">
ci_0001                 7.086064e-01 3 1  ON 0
ci_0002                 6.927483e-01 3 1  ON 1
ci_0003                -3.099699e-02 3 1  ON 2
ci_0004                -3.009162e-02 3 1  ON 3
ci_0005                -3.060382e-02 3 1  ON 4
ci_0006                -3.069586e-02 3 1  ON 5
ci_0007                -1.338102e-02 3 1  ON 6
ci_0008                -1.335093e-02 3 1  ON 7
ci_0009                -1.869650e-02 3 1  ON 8
ci_0010                -1.813030e-02 3 1  ON 9
ci_0011                -1.474501e-02 3 1  ON 10
ci_0012                -1.451134e-02 3 1  ON 11
ci_0013                 1.529423e-02 3 1  ON 12
ci_0014                 1.480516e-02 3 1  ON 13
ci_0015                 1.574766e-02 3 1  ON 14
ci_0016                 1.538632e-02 3 1  ON 15
ci_0017                 1.336745e-02 3 1  ON 16
ci_0018                 1.303906e-02 3 1  ON 17
ci_0019                 1.308950e-02 3 1  ON 18
ci_0020                 1.266839e-02 3 1  ON 19
ci_0021                 6.752770e-03 3 1  ON 20
ci_0022                 7.460538e-03 3 1  ON 21
ci_0023                -1.180403e-02 3 1  ON 22
ci_0024                -1.147023e-02 3 1  ON 23
ci_0025                -2.029570e-03 3 1  ON 24
ci_0026                -2.390747e-03 3 1  ON 25
ci_0027                -1.213155e-02 3 1  ON 26
ci_0028                -1.154912e-02 3 1  ON 27
ci_0029                -1.065832e-02 3 1  ON 28
ci_0030                -1.058734e-02 3 1  ON 29
ci_0031                 1.340907e-02 3 1  ON 30
ci_0032                 1.211459e-02 3 1  ON 31
ci_0033                 7.848177e-03 3 1  ON 32
ci_0034                 8.489627e-03 3 1  ON 33
ci_0035                 4.859421e-03 3 1  ON 34
ci_0036                 4.933671e-03 3 1  ON 35
ci_0037                -1.133359e-02 3 1  ON 36
ci_0038                -1.131343e-02 3 1  ON 37
ci_0039                -4.014992e-03 3 1  ON 38
ci_0040                -3.886155e-03 3 1  ON 39
ci_0041                 9.104241e-03 3 1  ON 40
ci_0042                 8.780957e-03 3 1  ON 41
ci_0043                -1.307372e-02 3 1  ON 42
ci_0044                -1.384583e-02 3 1  ON 43
ci_0045                 1.059118e-02 3 1  ON 44
ci_0046                 1.007868e-02 3 1  ON 45
ci_0047                -3.585075e-03 3 1  ON 46
ci_0048                -3.481623e-03 3 1  ON 47
ci_0049                -2.594629e-03 3 1  ON 48
ci_0050                -2.695910e-03 3 1  ON 49
ci_0051                -1.797585e-03 3 1  ON 50
ci_0052                -2.016123e-03 3 1  ON 51
ci_0053                -3.931437e-03 3 1  ON 52
ci_0054                -3.323922e-03 3 1  ON 53
ci_0055                 2.398828e-03 3 1  ON 54
ci_0056                 2.269778e-03 3 1  ON 55
ci_0057                 2.453986e-03 3 1  ON 56
ci_0058                 2.857281e-03 3 1  ON 57
ci_0059                -3.395815e-03 3 1  ON 58
ci_0060                -3.375888e-03 3 1  ON 59
ci_0061                -3.976504e-03 3 1  ON 60
ci_0062                -3.922365e-03 3 1  ON 61
ci_0063                -9.802580e-03 3 1  ON 62
ci_0064                -9.372600e-03 3 1  ON 63
ci_0065                -6.435479e-03 3 1  ON 64
ci_0066                -6.132151e-03 3 1  ON 65
ci_0067                -3.747986e-03 3 1  ON 66
ci_0068                -3.479531e-03 3 1  ON 67
ci_0069                 3.569219e-03 3 1  ON 68
ci_0070                 3.348549e-03 3 1  ON 69
ci_0071                 3.005272e-03 3 1  ON 70
ci_0072                 3.481734e-03 3 1  ON 71
ci_0073                 3.552587e-03 3 1  ON 72
ci_0074                 3.528871e-03 3 1  ON 73
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 4.0333e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s074 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s074 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=74  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6903e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 74
    time step          = 0.05
    reference energy   = -16.7134
    reference variance = 4.8913
====================================================
  Execution time = 1.4193e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s074
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5236e+04
  VMC Eavg = -1.6899e+01
  VMC Evar = 2.9529e-01
  Total weights = 1.951000343e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 2.5381e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.285532811913
                                         uncertainty =       0.002724400511

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.285532811913
                                         uncertainty =       0.002724400511

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000378035008
  error estimate for blocks of size 2^( 2) =       0.000394395786
  error estimate for blocks of size 2^( 3) =       0.000411639602
  error estimate for blocks of size 2^( 4) =       0.000426258725
  error estimate for blocks of size 2^( 5) =       0.000438262148
  error estimate for blocks of size 2^( 6) =       0.000447223154
  error estimate for blocks of size 2^( 7) =       0.000454275225

      target function =      -0.920096196089
              le_mean =     -16.899226431245
             les_mean =     285.879144538161
             stat err =       0.000441504813
             autocorr =       1.363976363189
   target nu stat err =       0.000441504813
   target dn stat err =       0.002960142025
      target stat err =       0.004660571000
              std dev =       0.534622235835
             le_variance =       0.285820935049


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.689922643124e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 74
Check correct_vf_var_size: 225, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.1684e+05, overlap shift 2.1684e+06 and omega -1.7444e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.920118846253       residual = 8.15e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.920118846434       residual = 1.05e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.920118846454       residual = 2.42e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.920118846459       residual = 1.33e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.920118846482       residual = 3.99e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.920118846131       residual = 2.01e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.920118846344       residual = 3.32e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.920118846198       residual = 2.34e-06           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.920118846075       residual = 2.16e-06           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.920118846735       residual = 1.84e-06           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.920118846683       residual = 1.23e-06           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.920118846743       residual = 9.02e-07           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.920118846603       residual = 5.21e-07           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.920118847059       residual = 1.20e-07           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.920118846513       residual = 3.59e-08           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.920118846300       residual = 1.14e-08           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.920118845859       residual = 4.11e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         16 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 2.1684e+05 is 9.466376e-10

solving harmonic davidson linear method for identity shift 8.6736e+05, overlap shift 8.6736e+06 and omega -1.7444e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.920118846253       residual = 8.15e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.920118846298       residual = 1.05e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.920118846304       residual = 2.42e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.920118846305       residual = 1.33e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.920118846306       residual = 3.99e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.920118846716       residual = 2.01e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.920118846307       residual = 3.32e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.920118845855       residual = 2.34e-06           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.920118844639       residual = 2.16e-06           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.920118846314       residual = 1.84e-06           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.920118844624       residual = 1.23e-06           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.920118846365       residual = 9.02e-07           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.920118846917       residual = 5.21e-07           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.920118846138       residual = 1.20e-07           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.920118847704       residual = 3.59e-08           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.920118846019       residual = 1.14e-08           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.920118846358       residual = 4.12e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         16 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 8.6736e+05 is 2.366594e-10

solving harmonic davidson linear method for identity shift 3.4694e+06, overlap shift 3.4694e+07 and omega -1.7444e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.920118846253       residual = 8.15e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.920118846265       residual = 1.05e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.920118846266       residual = 2.42e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.920118846785       residual = 1.33e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.920118846443       residual = 3.99e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.920118840660       residual = 2.01e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.920118840633       residual = 3.32e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.920118841659       residual = 2.34e-06           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.920118844733       residual = 2.16e-06           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.920118848497       residual = 1.84e-06           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.920118846267       residual = 1.23e-06           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.920118842397       residual = 9.02e-07           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.920118845012       residual = 5.21e-07           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.920118846601       residual = 1.20e-07           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.920118851243       residual = 3.59e-08           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.920118851385       residual = 1.14e-08           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.920118839654       residual = 4.11e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         16 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 3.4694e+06 is 5.916488e-11

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.870954 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 75 and numParams is: 74

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.6746e+01
  </log>
  <optVariables href="H2O.s074.opt.xml">
ci_0001                 7.086064e-01 3 1  ON 0
ci_0002                 6.927483e-01 3 1  ON 1
ci_0003                -3.099699e-02 3 1  ON 2
ci_0004                -3.009162e-02 3 1  ON 3
ci_0005                -3.060382e-02 3 1  ON 4
ci_0006                -3.069586e-02 3 1  ON 5
ci_0007                -1.338102e-02 3 1  ON 6
ci_0008                -1.335093e-02 3 1  ON 7
ci_0009                -1.869650e-02 3 1  ON 8
ci_0010                -1.813030e-02 3 1  ON 9
ci_0011                -1.474501e-02 3 1  ON 10
ci_0012                -1.451134e-02 3 1  ON 11
ci_0013                 1.529423e-02 3 1  ON 12
ci_0014                 1.480516e-02 3 1  ON 13
ci_0015                 1.574766e-02 3 1  ON 14
ci_0016                 1.538632e-02 3 1  ON 15
ci_0017                 1.336745e-02 3 1  ON 16
ci_0018                 1.303906e-02 3 1  ON 17
ci_0019                 1.308950e-02 3 1  ON 18
ci_0020                 1.266839e-02 3 1  ON 19
ci_0021                 6.752770e-03 3 1  ON 20
ci_0022                 7.460538e-03 3 1  ON 21
ci_0023                -1.180403e-02 3 1  ON 22
ci_0024                -1.147023e-02 3 1  ON 23
ci_0025                -2.029570e-03 3 1  ON 24
ci_0026                -2.390747e-03 3 1  ON 25
ci_0027                -1.213155e-02 3 1  ON 26
ci_0028                -1.154912e-02 3 1  ON 27
ci_0029                -1.065832e-02 3 1  ON 28
ci_0030                -1.058734e-02 3 1  ON 29
ci_0031                 1.340906e-02 3 1  ON 30
ci_0032                 1.211459e-02 3 1  ON 31
ci_0033                 7.848177e-03 3 1  ON 32
ci_0034                 8.489627e-03 3 1  ON 33
ci_0035                 4.859420e-03 3 1  ON 34
ci_0036                 4.933671e-03 3 1  ON 35
ci_0037                -1.133359e-02 3 1  ON 36
ci_0038                -1.131343e-02 3 1  ON 37
ci_0039                -4.014992e-03 3 1  ON 38
ci_0040                -3.886155e-03 3 1  ON 39
ci_0041                 9.104242e-03 3 1  ON 40
ci_0042                 8.780957e-03 3 1  ON 41
ci_0043                -1.307372e-02 3 1  ON 42
ci_0044                -1.384583e-02 3 1  ON 43
ci_0045                 1.059118e-02 3 1  ON 44
ci_0046                 1.007868e-02 3 1  ON 45
ci_0047                -3.585075e-03 3 1  ON 46
ci_0048                -3.481623e-03 3 1  ON 47
ci_0049                -2.594628e-03 3 1  ON 48
ci_0050                -2.695910e-03 3 1  ON 49
ci_0051                -1.797585e-03 3 1  ON 50
ci_0052                -2.016123e-03 3 1  ON 51
ci_0053                -3.931437e-03 3 1  ON 52
ci_0054                -3.323922e-03 3 1  ON 53
ci_0055                 2.398828e-03 3 1  ON 54
ci_0056                 2.269778e-03 3 1  ON 55
ci_0057                 2.453986e-03 3 1  ON 56
ci_0058                 2.857281e-03 3 1  ON 57
ci_0059                -3.395815e-03 3 1  ON 58
ci_0060                -3.375888e-03 3 1  ON 59
ci_0061                -3.976504e-03 3 1  ON 60
ci_0062                -3.922365e-03 3 1  ON 61
ci_0063                -9.802580e-03 3 1  ON 62
ci_0064                -9.372600e-03 3 1  ON 63
ci_0065                -6.435479e-03 3 1  ON 64
ci_0066                -6.132151e-03 3 1  ON 65
ci_0067                -3.747986e-03 3 1  ON 66
ci_0068                -3.479531e-03 3 1  ON 67
ci_0069                 3.569219e-03 3 1  ON 68
ci_0070                 3.348549e-03 3 1  ON 69
ci_0071                 3.005272e-03 3 1  ON 70
ci_0072                 3.481734e-03 3 1  ON 71
ci_0073                 3.552587e-03 3 1  ON 72
ci_0074                 3.528871e-03 3 1  ON 73
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 74
    time step          = 0.05
    reference energy   = -16.878
    reference variance = 0.255202
====================================================
  Execution time = 1.3934e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s074
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6899e+01
  VMC Evar = 2.9014e-01
  Total weights = 1.9510e+06
  Execution time = 1.8703e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.279025348208
                                         uncertainty =       0.001395974137

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.279025348208
                                         uncertainty =       0.001395974137

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000373569178
  error estimate for blocks of size 2^( 2) =       0.000390395854
  error estimate for blocks of size 2^( 3) =       0.000407453513
  error estimate for blocks of size 2^( 4) =       0.000422445047
  error estimate for blocks of size 2^( 5) =       0.000434865462
  error estimate for blocks of size 2^( 6) =       0.000441375572
  error estimate for blocks of size 2^( 7) =       0.000443792550

      target function =      -0.928171232323
              le_mean =     -16.899085803088
             les_mean =     285.869245244987
             stat err =       0.000435619657
             autocorr =       1.359793195983
   target nu stat err =       0.000435619657
   target dn stat err =       0.002296012022
      target stat err =       0.003705360509
              std dev =       0.528306598669
             le_variance =       0.279107862198

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.279025348178
                                         uncertainty =       0.001395974133

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.279025348178
                                         uncertainty =       0.001395974133

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000373569178
  error estimate for blocks of size 2^( 2) =       0.000390395854
  error estimate for blocks of size 2^( 3) =       0.000407453513
  error estimate for blocks of size 2^( 4) =       0.000422445047
  error estimate for blocks of size 2^( 5) =       0.000434865462
  error estimate for blocks of size 2^( 6) =       0.000441375572
  error estimate for blocks of size 2^( 7) =       0.000443792550

      target function =      -0.928171232109
              le_mean =     -16.899085803098
             les_mean =     285.869245245472
             stat err =       0.000435619657
             autocorr =       1.359793196021
   target nu stat err =       0.000435619657
   target dn stat err =       0.002296012051
      target stat err =       0.003705360553
              std dev =       0.528306598653
             le_variance =       0.279107862180

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.279025348193
                                         uncertainty =       0.001395974135

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.279025348193
                                         uncertainty =       0.001395974135

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000373569178
  error estimate for blocks of size 2^( 2) =       0.000390395854
  error estimate for blocks of size 2^( 3) =       0.000407453513
  error estimate for blocks of size 2^( 4) =       0.000422445047
  error estimate for blocks of size 2^( 5) =       0.000434865462
  error estimate for blocks of size 2^( 6) =       0.000441375572
  error estimate for blocks of size 2^( 7) =       0.000443792550

      target function =      -0.928171232216
              le_mean =     -16.899085803093
             les_mean =     285.869245245229
             stat err =       0.000435619657
             autocorr =       1.359793195991
   target nu stat err =       0.000435619657
   target dn stat err =       0.002296012037
      target stat err =       0.003705360531
              std dev =       0.528306598661
             le_variance =       0.279107862189

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.279025348206
                                         uncertainty =       0.001395974136

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.279025348206
                                         uncertainty =       0.001395974136

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000373569178
  error estimate for blocks of size 2^( 2) =       0.000390395854
  error estimate for blocks of size 2^( 3) =       0.000407453513
  error estimate for blocks of size 2^( 4) =       0.000422445047
  error estimate for blocks of size 2^( 5) =       0.000434865462
  error estimate for blocks of size 2^( 6) =       0.000441375572
  error estimate for blocks of size 2^( 7) =       0.000443792550

      target function =      -0.928171232309
              le_mean =     -16.899085803088
             les_mean =     285.869245245017
             stat err =       0.000435619657
             autocorr =       1.359793195988
   target nu stat err =       0.000435619657
   target dn stat err =       0.002296012024
      target stat err =       0.003705360512
              std dev =       0.528306598668
             le_variance =       0.279107862197


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.928171232323        initial  <--
     2.1684e+05     2.1684e+06             9.4664e-10        -0.928171232109
     8.6736e+05     8.6736e+06             2.3666e-10        -0.928171232216
     3.4694e+06     3.4694e+07             5.9165e-11        -0.928171232309

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 23.3787
  </log>
  <optVariables href="H2O.s074.opt.xml">
ci_0001                 7.086064e-01 3 1  ON 0
ci_0002                 6.927483e-01 3 1  ON 1
ci_0003                -3.099699e-02 3 1  ON 2
ci_0004                -3.009162e-02 3 1  ON 3
ci_0005                -3.060382e-02 3 1  ON 4
ci_0006                -3.069586e-02 3 1  ON 5
ci_0007                -1.338102e-02 3 1  ON 6
ci_0008                -1.335093e-02 3 1  ON 7
ci_0009                -1.869650e-02 3 1  ON 8
ci_0010                -1.813030e-02 3 1  ON 9
ci_0011                -1.474501e-02 3 1  ON 10
ci_0012                -1.451134e-02 3 1  ON 11
ci_0013                 1.529423e-02 3 1  ON 12
ci_0014                 1.480516e-02 3 1  ON 13
ci_0015                 1.574766e-02 3 1  ON 14
ci_0016                 1.538632e-02 3 1  ON 15
ci_0017                 1.336745e-02 3 1  ON 16
ci_0018                 1.303906e-02 3 1  ON 17
ci_0019                 1.308950e-02 3 1  ON 18
ci_0020                 1.266839e-02 3 1  ON 19
ci_0021                 6.752770e-03 3 1  ON 20
ci_0022                 7.460538e-03 3 1  ON 21
ci_0023                -1.180403e-02 3 1  ON 22
ci_0024                -1.147023e-02 3 1  ON 23
ci_0025                -2.029570e-03 3 1  ON 24
ci_0026                -2.390747e-03 3 1  ON 25
ci_0027                -1.213155e-02 3 1  ON 26
ci_0028                -1.154912e-02 3 1  ON 27
ci_0029                -1.065832e-02 3 1  ON 28
ci_0030                -1.058734e-02 3 1  ON 29
ci_0031                 1.340907e-02 3 1  ON 30
ci_0032                 1.211459e-02 3 1  ON 31
ci_0033                 7.848177e-03 3 1  ON 32
ci_0034                 8.489627e-03 3 1  ON 33
ci_0035                 4.859421e-03 3 1  ON 34
ci_0036                 4.933671e-03 3 1  ON 35
ci_0037                -1.133359e-02 3 1  ON 36
ci_0038                -1.131343e-02 3 1  ON 37
ci_0039                -4.014992e-03 3 1  ON 38
ci_0040                -3.886155e-03 3 1  ON 39
ci_0041                 9.104241e-03 3 1  ON 40
ci_0042                 8.780957e-03 3 1  ON 41
ci_0043                -1.307372e-02 3 1  ON 42
ci_0044                -1.384583e-02 3 1  ON 43
ci_0045                 1.059118e-02 3 1  ON 44
ci_0046                 1.007868e-02 3 1  ON 45
ci_0047                -3.585075e-03 3 1  ON 46
ci_0048                -3.481623e-03 3 1  ON 47
ci_0049                -2.594629e-03 3 1  ON 48
ci_0050                -2.695910e-03 3 1  ON 49
ci_0051                -1.797585e-03 3 1  ON 50
ci_0052                -2.016123e-03 3 1  ON 51
ci_0053                -3.931437e-03 3 1  ON 52
ci_0054                -3.323922e-03 3 1  ON 53
ci_0055                 2.398828e-03 3 1  ON 54
ci_0056                 2.269778e-03 3 1  ON 55
ci_0057                 2.453986e-03 3 1  ON 56
ci_0058                 2.857281e-03 3 1  ON 57
ci_0059                -3.395815e-03 3 1  ON 58
ci_0060                -3.375888e-03 3 1  ON 59
ci_0061                -3.976504e-03 3 1  ON 60
ci_0062                -3.922365e-03 3 1  ON 61
ci_0063                -9.802580e-03 3 1  ON 62
ci_0064                -9.372600e-03 3 1  ON 63
ci_0065                -6.435479e-03 3 1  ON 64
ci_0066                -6.132151e-03 3 1  ON 65
ci_0067                -3.747986e-03 3 1  ON 66
ci_0068                -3.479531e-03 3 1  ON 67
ci_0069                 3.569219e-03 3 1  ON 68
ci_0070                 3.348549e-03 3 1  ON 69
ci_0071                 3.005272e-03 3 1  ON 70
ci_0072                 3.481734e-03 3 1  ON 71
ci_0073                 3.552587e-03 3 1  ON 72
ci_0074                 3.528871e-03 3 1  ON 73
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 4.0135e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s075 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s075 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=75  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6902e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 75
    time step          = 0.05
    reference energy   = -16.924
    reference variance = 0.194038
====================================================
  Execution time = 1.4205e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s075
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5221e+04
  VMC Eavg = -1.6899e+01
  VMC Evar = 2.8987e-01
  Total weights = 1.951441663e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 2.6003e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.279910106137
                                         uncertainty =       0.001803548141

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.279910106137
                                         uncertainty =       0.001803548141

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000374048763
  error estimate for blocks of size 2^( 2) =       0.000391133425
  error estimate for blocks of size 2^( 3) =       0.000408596569
  error estimate for blocks of size 2^( 4) =       0.000423191028
  error estimate for blocks of size 2^( 5) =       0.000434393322
  error estimate for blocks of size 2^( 6) =       0.000441873606
  error estimate for blocks of size 2^( 7) =       0.000446880202

      target function =      -0.928593458324
              le_mean =     -16.898622997067
             les_mean =     285.853326333324
             stat err =       0.000436584540
             autocorr =       1.362323537377
   target nu stat err =       0.000436584540
   target dn stat err =       0.002761508565
      target stat err =       0.004429430954
              std dev =       0.528984832998
             le_variance =       0.279824953542


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.689862299707e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 74
Check correct_vf_var_size: 225, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.1684e+06, overlap shift 2.1684e+07 and omega -1.7444e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.928613232616       residual = 6.58e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.928613232632       residual = 9.09e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.928613232634       residual = 2.44e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.928613232393       residual = 1.14e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.928613232584       residual = 3.88e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.928613229145       residual = 2.88e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.928613233203       residual = 1.52e-05           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.928613230714       residual = 1.48e-05           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.928613232206       residual = 1.51e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.928613231085       residual = 1.03e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.928613228382       residual = 3.83e-06           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.928613229514       residual = 1.85e-06           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.928613231729       residual = 7.90e-07           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.928613231225       residual = 1.98e-07           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.928613234690       residual = 5.31e-08           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.928613228470       residual = 1.80e-08           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.928613231933       residual = 4.06e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         16 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 2.1684e+06 is 1.106395e-10

solving harmonic davidson linear method for identity shift 8.6736e+06, overlap shift 8.6736e+07 and omega -1.7444e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.928613232616       residual = 6.58e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.928613232620       residual = 9.09e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.928613232621       residual = 2.44e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.928613232621       residual = 1.14e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.928613232618       residual = 3.88e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.928613225720       residual = 2.88e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.928613239832       residual = 1.52e-05           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.928613231506       residual = 1.48e-05           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.928613216053       residual = 1.51e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.928613222522       residual = 1.03e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.928613217995       residual = 3.83e-06           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.928613247384       residual = 1.85e-06           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.928613266339       residual = 7.90e-07           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.928613227859       residual = 1.98e-07           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.928613241297       residual = 5.31e-08           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.928613239468       residual = 1.80e-08           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.928613216405       residual = 4.06e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         16 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 8.6736e+06 is 2.765981e-11

solving harmonic davidson linear method for identity shift 3.4694e+07, overlap shift 3.4694e+08 and omega -1.7444e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.928613232616       residual = 6.58e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.928613232617       residual = 9.09e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.928613232618       residual = 2.44e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.928613232555       residual = 1.14e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.928613230107       residual = 3.88e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.928613215392       residual = 2.88e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.928613269341       residual = 1.52e-05           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.928613208336       residual = 1.48e-05           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.928613267337       residual = 1.51e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.928613280142       residual = 1.03e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.928613178973       residual = 3.83e-06           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.928613165350       residual = 1.85e-06           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.928613136865       residual = 7.90e-07           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.928613197507       residual = 1.98e-07           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.928613221375       residual = 5.32e-08           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.928613196816       residual = 1.81e-08           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.928613220903       residual = 4.05e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         16 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 3.4694e+07 is 6.914917e-12

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.879961 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 75 and numParams is: 74

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.6820e+01
  </log>
  <optVariables href="H2O.s075.opt.xml">
ci_0001                 7.086064e-01 3 1  ON 0
ci_0002                 6.927483e-01 3 1  ON 1
ci_0003                -3.099699e-02 3 1  ON 2
ci_0004                -3.009162e-02 3 1  ON 3
ci_0005                -3.060382e-02 3 1  ON 4
ci_0006                -3.069586e-02 3 1  ON 5
ci_0007                -1.338102e-02 3 1  ON 6
ci_0008                -1.335093e-02 3 1  ON 7
ci_0009                -1.869650e-02 3 1  ON 8
ci_0010                -1.813030e-02 3 1  ON 9
ci_0011                -1.474501e-02 3 1  ON 10
ci_0012                -1.451134e-02 3 1  ON 11
ci_0013                 1.529423e-02 3 1  ON 12
ci_0014                 1.480516e-02 3 1  ON 13
ci_0015                 1.574766e-02 3 1  ON 14
ci_0016                 1.538632e-02 3 1  ON 15
ci_0017                 1.336745e-02 3 1  ON 16
ci_0018                 1.303906e-02 3 1  ON 17
ci_0019                 1.308950e-02 3 1  ON 18
ci_0020                 1.266839e-02 3 1  ON 19
ci_0021                 6.752770e-03 3 1  ON 20
ci_0022                 7.460538e-03 3 1  ON 21
ci_0023                -1.180403e-02 3 1  ON 22
ci_0024                -1.147023e-02 3 1  ON 23
ci_0025                -2.029570e-03 3 1  ON 24
ci_0026                -2.390747e-03 3 1  ON 25
ci_0027                -1.213155e-02 3 1  ON 26
ci_0028                -1.154912e-02 3 1  ON 27
ci_0029                -1.065832e-02 3 1  ON 28
ci_0030                -1.058734e-02 3 1  ON 29
ci_0031                 1.340906e-02 3 1  ON 30
ci_0032                 1.211459e-02 3 1  ON 31
ci_0033                 7.848177e-03 3 1  ON 32
ci_0034                 8.489627e-03 3 1  ON 33
ci_0035                 4.859421e-03 3 1  ON 34
ci_0036                 4.933671e-03 3 1  ON 35
ci_0037                -1.133359e-02 3 1  ON 36
ci_0038                -1.131343e-02 3 1  ON 37
ci_0039                -4.014992e-03 3 1  ON 38
ci_0040                -3.886155e-03 3 1  ON 39
ci_0041                 9.104241e-03 3 1  ON 40
ci_0042                 8.780957e-03 3 1  ON 41
ci_0043                -1.307372e-02 3 1  ON 42
ci_0044                -1.384583e-02 3 1  ON 43
ci_0045                 1.059118e-02 3 1  ON 44
ci_0046                 1.007868e-02 3 1  ON 45
ci_0047                -3.585075e-03 3 1  ON 46
ci_0048                -3.481623e-03 3 1  ON 47
ci_0049                -2.594629e-03 3 1  ON 48
ci_0050                -2.695910e-03 3 1  ON 49
ci_0051                -1.797585e-03 3 1  ON 50
ci_0052                -2.016123e-03 3 1  ON 51
ci_0053                -3.931437e-03 3 1  ON 52
ci_0054                -3.323922e-03 3 1  ON 53
ci_0055                 2.398828e-03 3 1  ON 54
ci_0056                 2.269778e-03 3 1  ON 55
ci_0057                 2.453986e-03 3 1  ON 56
ci_0058                 2.857281e-03 3 1  ON 57
ci_0059                -3.395815e-03 3 1  ON 58
ci_0060                -3.375888e-03 3 1  ON 59
ci_0061                -3.976504e-03 3 1  ON 60
ci_0062                -3.922365e-03 3 1  ON 61
ci_0063                -9.802580e-03 3 1  ON 62
ci_0064                -9.372600e-03 3 1  ON 63
ci_0065                -6.435479e-03 3 1  ON 64
ci_0066                -6.132151e-03 3 1  ON 65
ci_0067                -3.747986e-03 3 1  ON 66
ci_0068                -3.479531e-03 3 1  ON 67
ci_0069                 3.569219e-03 3 1  ON 68
ci_0070                 3.348549e-03 3 1  ON 69
ci_0071                 3.005272e-03 3 1  ON 70
ci_0072                 3.481734e-03 3 1  ON 71
ci_0073                 3.552587e-03 3 1  ON 72
ci_0074                 3.528871e-03 3 1  ON 73
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 75
    time step          = 0.05
    reference energy   = -16.9454
    reference variance = 0.16608
====================================================
  Execution time = 1.3909e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s075
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6899e+01
  VMC Evar = 2.9591e-01
  Total weights = 1.9508e+06
  Execution time = 1.8835e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.287047071419
                                         uncertainty =       0.002092098084

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.287047071419
                                         uncertainty =       0.002092098084

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000378830432
  error estimate for blocks of size 2^( 2) =       0.000395946470
  error estimate for blocks of size 2^( 3) =       0.000412546818
  error estimate for blocks of size 2^( 4) =       0.000427619922
  error estimate for blocks of size 2^( 5) =       0.000439312607
  error estimate for blocks of size 2^( 6) =       0.000446158579
  error estimate for blocks of size 2^( 7) =       0.000452167819

      target function =      -0.919136543657
              le_mean =     -16.898594962001
             les_mean =     285.858423244205
             stat err =       0.000441314732
             autocorr =       1.357085252943
   target nu stat err =       0.000441314732
   target dn stat err =       0.002523133726
      target stat err =       0.003978746191
              std dev =       0.535747135232
             le_variance =       0.287024992909

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.287047071416
                                         uncertainty =       0.002092098084

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.287047071416
                                         uncertainty =       0.002092098084

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000378830432
  error estimate for blocks of size 2^( 2) =       0.000395946470
  error estimate for blocks of size 2^( 3) =       0.000412546818
  error estimate for blocks of size 2^( 4) =       0.000427619922
  error estimate for blocks of size 2^( 5) =       0.000439312607
  error estimate for blocks of size 2^( 6) =       0.000446158579
  error estimate for blocks of size 2^( 7) =       0.000452167819

      target function =      -0.919136543665
              le_mean =     -16.898594962001
             les_mean =     285.858423244206
             stat err =       0.000441314732
             autocorr =       1.357085252922
   target nu stat err =       0.000441314732
   target dn stat err =       0.002523133731
      target stat err =       0.003978746199
              std dev =       0.535747135229
             le_variance =       0.287024992906

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.287047071418
                                         uncertainty =       0.002092098084

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.287047071418
                                         uncertainty =       0.002092098084

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000378830432
  error estimate for blocks of size 2^( 2) =       0.000395946470
  error estimate for blocks of size 2^( 3) =       0.000412546818
  error estimate for blocks of size 2^( 4) =       0.000427619922
  error estimate for blocks of size 2^( 5) =       0.000439312607
  error estimate for blocks of size 2^( 6) =       0.000446158579
  error estimate for blocks of size 2^( 7) =       0.000452167819

      target function =      -0.919136543661
              le_mean =     -16.898594962001
             les_mean =     285.858423244206
             stat err =       0.000441314732
             autocorr =       1.357085252928
   target nu stat err =       0.000441314732
   target dn stat err =       0.002523133729
      target stat err =       0.003978746195
              std dev =       0.535747135230
             le_variance =       0.287024992907

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.287047071419
                                         uncertainty =       0.002092098084

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.287047071419
                                         uncertainty =       0.002092098084

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000378830432
  error estimate for blocks of size 2^( 2) =       0.000395946470
  error estimate for blocks of size 2^( 3) =       0.000412546818
  error estimate for blocks of size 2^( 4) =       0.000427619922
  error estimate for blocks of size 2^( 5) =       0.000439312607
  error estimate for blocks of size 2^( 6) =       0.000446158579
  error estimate for blocks of size 2^( 7) =       0.000452167819

      target function =      -0.919136543658
              le_mean =     -16.898594962001
             les_mean =     285.858423244205
             stat err =       0.000441314732
             autocorr =       1.357085252950
   target nu stat err =       0.000441314732
   target dn stat err =       0.002523133727
      target stat err =       0.003978746192
              std dev =       0.535747135232
             le_variance =       0.287024992909


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.919136543657        initial
     2.1684e+06     2.1684e+07             1.1064e-10        -0.919136543665  <--
     8.6736e+06     8.6736e+07             2.7660e-11        -0.919136543661
     3.4694e+07     3.4694e+08             6.9149e-12        -0.919136543658

*****************************************************************************
Applying the update for shift_i =   2.1684e+06     and shift_s =   2.1684e+07
*****************************************************************************

  Execution time = 2.3378e+01
  </log>
  <optVariables href="H2O.s075.opt.xml">
ci_0001                 7.086064e-01 3 1  ON 0
ci_0002                 6.927483e-01 3 1  ON 1
ci_0003                -3.099699e-02 3 1  ON 2
ci_0004                -3.009162e-02 3 1  ON 3
ci_0005                -3.060382e-02 3 1  ON 4
ci_0006                -3.069586e-02 3 1  ON 5
ci_0007                -1.338102e-02 3 1  ON 6
ci_0008                -1.335093e-02 3 1  ON 7
ci_0009                -1.869650e-02 3 1  ON 8
ci_0010                -1.813030e-02 3 1  ON 9
ci_0011                -1.474501e-02 3 1  ON 10
ci_0012                -1.451134e-02 3 1  ON 11
ci_0013                 1.529423e-02 3 1  ON 12
ci_0014                 1.480516e-02 3 1  ON 13
ci_0015                 1.574766e-02 3 1  ON 14
ci_0016                 1.538632e-02 3 1  ON 15
ci_0017                 1.336745e-02 3 1  ON 16
ci_0018                 1.303906e-02 3 1  ON 17
ci_0019                 1.308950e-02 3 1  ON 18
ci_0020                 1.266839e-02 3 1  ON 19
ci_0021                 6.752770e-03 3 1  ON 20
ci_0022                 7.460538e-03 3 1  ON 21
ci_0023                -1.180403e-02 3 1  ON 22
ci_0024                -1.147023e-02 3 1  ON 23
ci_0025                -2.029570e-03 3 1  ON 24
ci_0026                -2.390747e-03 3 1  ON 25
ci_0027                -1.213155e-02 3 1  ON 26
ci_0028                -1.154912e-02 3 1  ON 27
ci_0029                -1.065832e-02 3 1  ON 28
ci_0030                -1.058734e-02 3 1  ON 29
ci_0031                 1.340906e-02 3 1  ON 30
ci_0032                 1.211459e-02 3 1  ON 31
ci_0033                 7.848177e-03 3 1  ON 32
ci_0034                 8.489627e-03 3 1  ON 33
ci_0035                 4.859421e-03 3 1  ON 34
ci_0036                 4.933671e-03 3 1  ON 35
ci_0037                -1.133359e-02 3 1  ON 36
ci_0038                -1.131343e-02 3 1  ON 37
ci_0039                -4.014992e-03 3 1  ON 38
ci_0040                -3.886155e-03 3 1  ON 39
ci_0041                 9.104241e-03 3 1  ON 40
ci_0042                 8.780957e-03 3 1  ON 41
ci_0043                -1.307372e-02 3 1  ON 42
ci_0044                -1.384583e-02 3 1  ON 43
ci_0045                 1.059118e-02 3 1  ON 44
ci_0046                 1.007868e-02 3 1  ON 45
ci_0047                -3.585075e-03 3 1  ON 46
ci_0048                -3.481623e-03 3 1  ON 47
ci_0049                -2.594629e-03 3 1  ON 48
ci_0050                -2.695910e-03 3 1  ON 49
ci_0051                -1.797585e-03 3 1  ON 50
ci_0052                -2.016123e-03 3 1  ON 51
ci_0053                -3.931437e-03 3 1  ON 52
ci_0054                -3.323922e-03 3 1  ON 53
ci_0055                 2.398828e-03 3 1  ON 54
ci_0056                 2.269778e-03 3 1  ON 55
ci_0057                 2.453986e-03 3 1  ON 56
ci_0058                 2.857281e-03 3 1  ON 57
ci_0059                -3.395815e-03 3 1  ON 58
ci_0060                -3.375888e-03 3 1  ON 59
ci_0061                -3.976504e-03 3 1  ON 60
ci_0062                -3.922365e-03 3 1  ON 61
ci_0063                -9.802580e-03 3 1  ON 62
ci_0064                -9.372600e-03 3 1  ON 63
ci_0065                -6.435479e-03 3 1  ON 64
ci_0066                -6.132151e-03 3 1  ON 65
ci_0067                -3.747986e-03 3 1  ON 66
ci_0068                -3.479531e-03 3 1  ON 67
ci_0069                 3.569219e-03 3 1  ON 68
ci_0070                 3.348549e-03 3 1  ON 69
ci_0071                 3.005272e-03 3 1  ON 70
ci_0072                 3.481734e-03 3 1  ON 71
ci_0073                 3.552587e-03 3 1  ON 72
ci_0074                 3.528871e-03 3 1  ON 73
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 4.0204e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s076 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s076 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=76  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6902e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 76
    time step          = 0.05
    reference energy   = -16.8265
    reference variance = 0.286829
====================================================
  Execution time = 1.4318e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s076
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5256e+04
  VMC Eavg = -1.6899e+01
  VMC Evar = 2.9205e-01
  Total weights = 1.950711150e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 2.5651e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.283160116797
                                         uncertainty =       0.002146301158

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.283160116797
                                         uncertainty =       0.002146301158

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000376261203
  error estimate for blocks of size 2^( 2) =       0.000393221418
  error estimate for blocks of size 2^( 3) =       0.000410999555
  error estimate for blocks of size 2^( 4) =       0.000426190113
  error estimate for blocks of size 2^( 5) =       0.000438854823
  error estimate for blocks of size 2^( 6) =       0.000446921352
  error estimate for blocks of size 2^( 7) =       0.000451614258

      target function =      -0.925158583174
              le_mean =     -16.898633903521
             les_mean =     285.855877599378
             stat err =       0.000440895136
             autocorr =       1.373067019912
   target nu stat err =       0.000440895136
   target dn stat err =       0.002531928475
      target stat err =       0.004043860063
              std dev =       0.532113696828
             le_variance =       0.283144986352


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.689863390352e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 74
Check correct_vf_var_size: 225, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 5.4210e+05, overlap shift 5.4210e+06 and omega -1.7444e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.925174808003       residual = 9.06e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.925174808085       residual = 1.10e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.925174808094       residual = 3.82e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.925174808098       residual = 1.89e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.925174808101       residual = 1.05e-04           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.925174808101       residual = 8.53e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.925174808397       residual = 4.02e-05           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.925174807751       residual = 2.38e-05           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.925174807674       residual = 3.05e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.925174809178       residual = 2.12e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.925174809816       residual = 8.01e-06           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.925174809274       residual = 3.35e-06           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.925174808104       residual = 1.05e-06           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.925174808104       residual = 4.97e-07           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.925174808534       residual = 1.11e-07           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.925174807970       residual = 3.11e-08           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.925174807604       residual = 7.81e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         16 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 5.4210e+05 is 6.842064e-10

solving harmonic davidson linear method for identity shift 2.1684e+06, overlap shift 2.1684e+07 and omega -1.7444e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.925174808003       residual = 9.06e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.925174808024       residual = 1.10e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.925174808026       residual = 3.82e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.925174806284       residual = 1.89e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.925174808027       residual = 1.05e-04           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.925174808028       residual = 8.53e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.925174808028       residual = 4.02e-05           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.925174808028       residual = 2.38e-05           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.925174808028       residual = 3.05e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.925174808028       residual = 2.12e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.925174808028       residual = 8.01e-06           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.925174808274       residual = 3.35e-06           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.925174808028       residual = 1.05e-06           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.925174813754       residual = 4.97e-07           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.925174808191       residual = 1.11e-07           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.925174808028       residual = 3.11e-08           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.925174808028       residual = 7.81e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         16 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 2.1684e+06 is 1.710517e-10

solving harmonic davidson linear method for identity shift 8.6736e+06, overlap shift 8.6736e+07 and omega -1.7444e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.925174808003       residual = 9.06e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.925174808008       residual = 1.10e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.925174808009       residual = 3.82e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.925174808009       residual = 1.89e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.925174808009       residual = 1.05e-04           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.925174820413       residual = 8.53e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.925174814105       residual = 4.02e-05           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.925174808205       residual = 2.38e-05           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.925174832909       residual = 3.05e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.925174791384       residual = 2.12e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.925174791029       residual = 8.01e-06           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.925174812802       residual = 3.35e-06           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.925174810933       residual = 1.05e-06           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.925174826005       residual = 4.97e-07           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.925174814972       residual = 1.11e-07           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.925174792453       residual = 3.11e-08           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.925174814344       residual = 7.82e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         16 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 8.6736e+06 is 4.276254e-11

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.888935 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 75 and numParams is: 74

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.6897e+01
  </log>
  <optVariables href="H2O.s076.opt.xml">
ci_0001                 7.086064e-01 3 1  ON 0
ci_0002                 6.927483e-01 3 1  ON 1
ci_0003                -3.099699e-02 3 1  ON 2
ci_0004                -3.009162e-02 3 1  ON 3
ci_0005                -3.060382e-02 3 1  ON 4
ci_0006                -3.069586e-02 3 1  ON 5
ci_0007                -1.338102e-02 3 1  ON 6
ci_0008                -1.335093e-02 3 1  ON 7
ci_0009                -1.869650e-02 3 1  ON 8
ci_0010                -1.813030e-02 3 1  ON 9
ci_0011                -1.474501e-02 3 1  ON 10
ci_0012                -1.451134e-02 3 1  ON 11
ci_0013                 1.529423e-02 3 1  ON 12
ci_0014                 1.480516e-02 3 1  ON 13
ci_0015                 1.574766e-02 3 1  ON 14
ci_0016                 1.538632e-02 3 1  ON 15
ci_0017                 1.336745e-02 3 1  ON 16
ci_0018                 1.303906e-02 3 1  ON 17
ci_0019                 1.308950e-02 3 1  ON 18
ci_0020                 1.266839e-02 3 1  ON 19
ci_0021                 6.752770e-03 3 1  ON 20
ci_0022                 7.460538e-03 3 1  ON 21
ci_0023                -1.180403e-02 3 1  ON 22
ci_0024                -1.147023e-02 3 1  ON 23
ci_0025                -2.029570e-03 3 1  ON 24
ci_0026                -2.390747e-03 3 1  ON 25
ci_0027                -1.213155e-02 3 1  ON 26
ci_0028                -1.154912e-02 3 1  ON 27
ci_0029                -1.065832e-02 3 1  ON 28
ci_0030                -1.058734e-02 3 1  ON 29
ci_0031                 1.340907e-02 3 1  ON 30
ci_0032                 1.211459e-02 3 1  ON 31
ci_0033                 7.848177e-03 3 1  ON 32
ci_0034                 8.489627e-03 3 1  ON 33
ci_0035                 4.859421e-03 3 1  ON 34
ci_0036                 4.933671e-03 3 1  ON 35
ci_0037                -1.133359e-02 3 1  ON 36
ci_0038                -1.131343e-02 3 1  ON 37
ci_0039                -4.014992e-03 3 1  ON 38
ci_0040                -3.886155e-03 3 1  ON 39
ci_0041                 9.104242e-03 3 1  ON 40
ci_0042                 8.780957e-03 3 1  ON 41
ci_0043                -1.307372e-02 3 1  ON 42
ci_0044                -1.384583e-02 3 1  ON 43
ci_0045                 1.059118e-02 3 1  ON 44
ci_0046                 1.007868e-02 3 1  ON 45
ci_0047                -3.585075e-03 3 1  ON 46
ci_0048                -3.481623e-03 3 1  ON 47
ci_0049                -2.594629e-03 3 1  ON 48
ci_0050                -2.695910e-03 3 1  ON 49
ci_0051                -1.797585e-03 3 1  ON 50
ci_0052                -2.016123e-03 3 1  ON 51
ci_0053                -3.931437e-03 3 1  ON 52
ci_0054                -3.323922e-03 3 1  ON 53
ci_0055                 2.398828e-03 3 1  ON 54
ci_0056                 2.269778e-03 3 1  ON 55
ci_0057                 2.453986e-03 3 1  ON 56
ci_0058                 2.857281e-03 3 1  ON 57
ci_0059                -3.395815e-03 3 1  ON 58
ci_0060                -3.375888e-03 3 1  ON 59
ci_0061                -3.976504e-03 3 1  ON 60
ci_0062                -3.922365e-03 3 1  ON 61
ci_0063                -9.802580e-03 3 1  ON 62
ci_0064                -9.372600e-03 3 1  ON 63
ci_0065                -6.435479e-03 3 1  ON 64
ci_0066                -6.132151e-03 3 1  ON 65
ci_0067                -3.747986e-03 3 1  ON 66
ci_0068                -3.479530e-03 3 1  ON 67
ci_0069                 3.569219e-03 3 1  ON 68
ci_0070                 3.348549e-03 3 1  ON 69
ci_0071                 3.005272e-03 3 1  ON 70
ci_0072                 3.481734e-03 3 1  ON 71
ci_0073                 3.552587e-03 3 1  ON 72
ci_0074                 3.528871e-03 3 1  ON 73
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 76
    time step          = 0.05
    reference energy   = -16.8877
    reference variance = 0.204124
====================================================
  Execution time = 1.3806e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s076
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6899e+01
  VMC Evar = 2.9103e-01
  Total weights = 1.9511e+06
  Execution time = 1.8698e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.281296658449
                                         uncertainty =       0.001864081847

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.281296658449
                                         uncertainty =       0.001864081847

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000375044634
  error estimate for blocks of size 2^( 2) =       0.000392043335
  error estimate for blocks of size 2^( 3) =       0.000409557216
  error estimate for blocks of size 2^( 4) =       0.000425285803
  error estimate for blocks of size 2^( 5) =       0.000436960449
  error estimate for blocks of size 2^( 6) =       0.000444512218
  error estimate for blocks of size 2^( 7) =       0.000450607789

      target function =      -0.926761925438
              le_mean =     -16.898886124799
             les_mean =     285.863385108406
             stat err =       0.000439341565
             autocorr =       1.372267167986
   target nu stat err =       0.000439341565
   target dn stat err =       0.002538966004
      target stat err =       0.004069940346
              std dev =       0.530393207879
             le_variance =       0.281316954964

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.281296658433
                                         uncertainty =       0.001864081846

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.281296658433
                                         uncertainty =       0.001864081846

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000375044634
  error estimate for blocks of size 2^( 2) =       0.000392043335
  error estimate for blocks of size 2^( 3) =       0.000409557216
  error estimate for blocks of size 2^( 4) =       0.000425285803
  error estimate for blocks of size 2^( 5) =       0.000436960449
  error estimate for blocks of size 2^( 6) =       0.000444512218
  error estimate for blocks of size 2^( 7) =       0.000450607789

      target function =      -0.926761862053
              le_mean =     -16.898886124802
             les_mean =     285.863385148635
             stat err =       0.000439341565
             autocorr =       1.372267167826
   target nu stat err =       0.000439341565
   target dn stat err =       0.002538975059
      target stat err =       0.004069953825
              std dev =       0.530393207864
             le_variance =       0.281316954948

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.281296658441
                                         uncertainty =       0.001864081846

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.281296658441
                                         uncertainty =       0.001864081846

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000375044634
  error estimate for blocks of size 2^( 2) =       0.000392043335
  error estimate for blocks of size 2^( 3) =       0.000409557216
  error estimate for blocks of size 2^( 4) =       0.000425285803
  error estimate for blocks of size 2^( 5) =       0.000436960449
  error estimate for blocks of size 2^( 6) =       0.000444512218
  error estimate for blocks of size 2^( 7) =       0.000450607789

      target function =      -0.926761893747
              le_mean =     -16.898886124801
             les_mean =     285.863385128520
             stat err =       0.000439341565
             autocorr =       1.372267167905
   target nu stat err =       0.000439341565
   target dn stat err =       0.002538970532
      target stat err =       0.004069947085
              std dev =       0.530393207871
             le_variance =       0.281316954956

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.281296658448
                                         uncertainty =       0.001864081847

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.281296658448
                                         uncertainty =       0.001864081847

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000375044634
  error estimate for blocks of size 2^( 2) =       0.000392043335
  error estimate for blocks of size 2^( 3) =       0.000409557216
  error estimate for blocks of size 2^( 4) =       0.000425285803
  error estimate for blocks of size 2^( 5) =       0.000436960449
  error estimate for blocks of size 2^( 6) =       0.000444512218
  error estimate for blocks of size 2^( 7) =       0.000450607789

      target function =      -0.926761921477
              le_mean =     -16.898886124799
             les_mean =     285.863385110920
             stat err =       0.000439341565
             autocorr =       1.372267167972
   target nu stat err =       0.000439341565
   target dn stat err =       0.002538966570
      target stat err =       0.004069941188
              std dev =       0.530393207878
             le_variance =       0.281316954963


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.926761925438        initial  <--
     5.4210e+05     5.4210e+06             6.8421e-10        -0.926761862053
     2.1684e+06     2.1684e+07             1.7105e-10        -0.926761893747
     8.6736e+06     8.6736e+07             4.2763e-11        -0.926761921477

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 23.2628
  </log>
  <optVariables href="H2O.s076.opt.xml">
ci_0001                 7.086064e-01 3 1  ON 0
ci_0002                 6.927483e-01 3 1  ON 1
ci_0003                -3.099699e-02 3 1  ON 2
ci_0004                -3.009162e-02 3 1  ON 3
ci_0005                -3.060382e-02 3 1  ON 4
ci_0006                -3.069586e-02 3 1  ON 5
ci_0007                -1.338102e-02 3 1  ON 6
ci_0008                -1.335093e-02 3 1  ON 7
ci_0009                -1.869650e-02 3 1  ON 8
ci_0010                -1.813030e-02 3 1  ON 9
ci_0011                -1.474501e-02 3 1  ON 10
ci_0012                -1.451134e-02 3 1  ON 11
ci_0013                 1.529423e-02 3 1  ON 12
ci_0014                 1.480516e-02 3 1  ON 13
ci_0015                 1.574766e-02 3 1  ON 14
ci_0016                 1.538632e-02 3 1  ON 15
ci_0017                 1.336745e-02 3 1  ON 16
ci_0018                 1.303906e-02 3 1  ON 17
ci_0019                 1.308950e-02 3 1  ON 18
ci_0020                 1.266839e-02 3 1  ON 19
ci_0021                 6.752770e-03 3 1  ON 20
ci_0022                 7.460538e-03 3 1  ON 21
ci_0023                -1.180403e-02 3 1  ON 22
ci_0024                -1.147023e-02 3 1  ON 23
ci_0025                -2.029570e-03 3 1  ON 24
ci_0026                -2.390747e-03 3 1  ON 25
ci_0027                -1.213155e-02 3 1  ON 26
ci_0028                -1.154912e-02 3 1  ON 27
ci_0029                -1.065832e-02 3 1  ON 28
ci_0030                -1.058734e-02 3 1  ON 29
ci_0031                 1.340906e-02 3 1  ON 30
ci_0032                 1.211459e-02 3 1  ON 31
ci_0033                 7.848177e-03 3 1  ON 32
ci_0034                 8.489627e-03 3 1  ON 33
ci_0035                 4.859421e-03 3 1  ON 34
ci_0036                 4.933671e-03 3 1  ON 35
ci_0037                -1.133359e-02 3 1  ON 36
ci_0038                -1.131343e-02 3 1  ON 37
ci_0039                -4.014992e-03 3 1  ON 38
ci_0040                -3.886155e-03 3 1  ON 39
ci_0041                 9.104241e-03 3 1  ON 40
ci_0042                 8.780957e-03 3 1  ON 41
ci_0043                -1.307372e-02 3 1  ON 42
ci_0044                -1.384583e-02 3 1  ON 43
ci_0045                 1.059118e-02 3 1  ON 44
ci_0046                 1.007868e-02 3 1  ON 45
ci_0047                -3.585075e-03 3 1  ON 46
ci_0048                -3.481623e-03 3 1  ON 47
ci_0049                -2.594629e-03 3 1  ON 48
ci_0050                -2.695910e-03 3 1  ON 49
ci_0051                -1.797585e-03 3 1  ON 50
ci_0052                -2.016123e-03 3 1  ON 51
ci_0053                -3.931437e-03 3 1  ON 52
ci_0054                -3.323922e-03 3 1  ON 53
ci_0055                 2.398828e-03 3 1  ON 54
ci_0056                 2.269778e-03 3 1  ON 55
ci_0057                 2.453986e-03 3 1  ON 56
ci_0058                 2.857281e-03 3 1  ON 57
ci_0059                -3.395815e-03 3 1  ON 58
ci_0060                -3.375888e-03 3 1  ON 59
ci_0061                -3.976504e-03 3 1  ON 60
ci_0062                -3.922365e-03 3 1  ON 61
ci_0063                -9.802580e-03 3 1  ON 62
ci_0064                -9.372600e-03 3 1  ON 63
ci_0065                -6.435479e-03 3 1  ON 64
ci_0066                -6.132151e-03 3 1  ON 65
ci_0067                -3.747986e-03 3 1  ON 66
ci_0068                -3.479531e-03 3 1  ON 67
ci_0069                 3.569219e-03 3 1  ON 68
ci_0070                 3.348549e-03 3 1  ON 69
ci_0071                 3.005272e-03 3 1  ON 70
ci_0072                 3.481734e-03 3 1  ON 71
ci_0073                 3.552587e-03 3 1  ON 72
ci_0074                 3.528871e-03 3 1  ON 73
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 4.0167e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s077 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s077 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=77  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6902e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 77
    time step          = 0.05
    reference energy   = -16.9619
    reference variance = 0.379157
====================================================
  Execution time = 1.6318e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s077
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5275e+04
  VMC Eavg = -1.6899e+01
  VMC Evar = 2.9550e-01
  Total weights = 1.951075723e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 2.5707e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.285099032676
                                         uncertainty =       0.002174454541

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.285099032676
                                         uncertainty =       0.002174454541

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000377536806
  error estimate for blocks of size 2^( 2) =       0.000395132444
  error estimate for blocks of size 2^( 3) =       0.000412520419
  error estimate for blocks of size 2^( 4) =       0.000427984497
  error estimate for blocks of size 2^( 5) =       0.000438573182
  error estimate for blocks of size 2^( 6) =       0.000446130632
  error estimate for blocks of size 2^( 7) =       0.000451018457

      target function =      -0.919772541950
              le_mean =     -16.898949326658
             les_mean =     285.869986852762
             stat err =       0.000440926692
             autocorr =       1.363999423229
   target nu stat err =       0.000440926692
   target dn stat err =       0.002953573291
      target stat err =       0.004644743153
              std dev =       0.533917670747
             le_variance =       0.285068079136


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.689894932666e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 74
Check correct_vf_var_size: 225, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 5.4210e+06, overlap shift 5.4210e+07 and omega -1.7444e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.919794679796       residual = 7.60e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.919794679803       residual = 8.92e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.919794679804       residual = 2.87e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.919794679847       residual = 2.16e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.919794679804       residual = 6.93e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.919794679805       residual = 4.16e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.919794679805       residual = 3.07e-05           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.919794679805       residual = 2.18e-05           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.919794679805       residual = 2.57e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.919794688267       residual = 1.64e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.919794679805       residual = 8.20e-06           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.919794663580       residual = 2.47e-06           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.919794682461       residual = 9.44e-07           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.919794653975       residual = 3.19e-07           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.919794665508       residual = 9.67e-08           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.919794678283       residual = 3.07e-08           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.919794672161       residual = 4.70e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         16 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 5.4210e+06 is 5.921548e-11

solving harmonic davidson linear method for identity shift 2.1684e+07, overlap shift 2.1684e+08 and omega -1.7444e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.919794679796       residual = 7.60e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.919794679798       residual = 8.92e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.919794679798       residual = 2.87e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.919794679798       residual = 2.16e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.919794680035       residual = 6.93e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.919794696944       residual = 4.16e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.919794688320       residual = 3.07e-05           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.919794648467       residual = 2.18e-05           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.919794707036       residual = 2.57e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.919794644876       residual = 1.64e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.919794745464       residual = 8.20e-06           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.919794686991       residual = 2.47e-06           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.919794676538       residual = 9.44e-07           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.919794644181       residual = 3.19e-07           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.919794692805       residual = 9.67e-08           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.919794704892       residual = 3.07e-08           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.919794658813       residual = 4.70e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         16 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 2.1684e+07 is 1.480383e-11

solving harmonic davidson linear method for identity shift 8.6736e+07, overlap shift 8.6736e+08 and omega -1.7444e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.919794679796       residual = 7.60e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.919794679796       residual = 8.92e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.919794679797       residual = 2.87e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.919794679797       residual = 2.16e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.919794679797       residual = 6.93e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.919794536069       residual = 4.16e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.919794684780       residual = 3.07e-05           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.919794657912       residual = 2.18e-05           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.919794877413       residual = 2.57e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.919794526772       residual = 1.64e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.919794537174       residual = 8.20e-06           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.919794965845       residual = 2.47e-06           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.919794581884       residual = 9.45e-07           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.919794966838       residual = 3.19e-07           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.919794545161       residual = 9.67e-08           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.919794763609       residual = 3.07e-08           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.919794549968       residual = 4.72e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         16 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 8.6736e+07 is 3.701099e-12

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.897974 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 75 and numParams is: 74

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.8903e+01
  </log>
  <optVariables href="H2O.s077.opt.xml">
ci_0001                 7.086064e-01 3 1  ON 0
ci_0002                 6.927483e-01 3 1  ON 1
ci_0003                -3.099699e-02 3 1  ON 2
ci_0004                -3.009162e-02 3 1  ON 3
ci_0005                -3.060382e-02 3 1  ON 4
ci_0006                -3.069586e-02 3 1  ON 5
ci_0007                -1.338102e-02 3 1  ON 6
ci_0008                -1.335093e-02 3 1  ON 7
ci_0009                -1.869650e-02 3 1  ON 8
ci_0010                -1.813030e-02 3 1  ON 9
ci_0011                -1.474501e-02 3 1  ON 10
ci_0012                -1.451134e-02 3 1  ON 11
ci_0013                 1.529423e-02 3 1  ON 12
ci_0014                 1.480516e-02 3 1  ON 13
ci_0015                 1.574766e-02 3 1  ON 14
ci_0016                 1.538632e-02 3 1  ON 15
ci_0017                 1.336745e-02 3 1  ON 16
ci_0018                 1.303906e-02 3 1  ON 17
ci_0019                 1.308950e-02 3 1  ON 18
ci_0020                 1.266839e-02 3 1  ON 19
ci_0021                 6.752770e-03 3 1  ON 20
ci_0022                 7.460538e-03 3 1  ON 21
ci_0023                -1.180403e-02 3 1  ON 22
ci_0024                -1.147023e-02 3 1  ON 23
ci_0025                -2.029570e-03 3 1  ON 24
ci_0026                -2.390747e-03 3 1  ON 25
ci_0027                -1.213155e-02 3 1  ON 26
ci_0028                -1.154912e-02 3 1  ON 27
ci_0029                -1.065832e-02 3 1  ON 28
ci_0030                -1.058734e-02 3 1  ON 29
ci_0031                 1.340906e-02 3 1  ON 30
ci_0032                 1.211459e-02 3 1  ON 31
ci_0033                 7.848177e-03 3 1  ON 32
ci_0034                 8.489627e-03 3 1  ON 33
ci_0035                 4.859421e-03 3 1  ON 34
ci_0036                 4.933671e-03 3 1  ON 35
ci_0037                -1.133359e-02 3 1  ON 36
ci_0038                -1.131343e-02 3 1  ON 37
ci_0039                -4.014992e-03 3 1  ON 38
ci_0040                -3.886155e-03 3 1  ON 39
ci_0041                 9.104241e-03 3 1  ON 40
ci_0042                 8.780957e-03 3 1  ON 41
ci_0043                -1.307372e-02 3 1  ON 42
ci_0044                -1.384583e-02 3 1  ON 43
ci_0045                 1.059118e-02 3 1  ON 44
ci_0046                 1.007868e-02 3 1  ON 45
ci_0047                -3.585075e-03 3 1  ON 46
ci_0048                -3.481623e-03 3 1  ON 47
ci_0049                -2.594629e-03 3 1  ON 48
ci_0050                -2.695910e-03 3 1  ON 49
ci_0051                -1.797585e-03 3 1  ON 50
ci_0052                -2.016123e-03 3 1  ON 51
ci_0053                -3.931437e-03 3 1  ON 52
ci_0054                -3.323922e-03 3 1  ON 53
ci_0055                 2.398828e-03 3 1  ON 54
ci_0056                 2.269778e-03 3 1  ON 55
ci_0057                 2.453986e-03 3 1  ON 56
ci_0058                 2.857281e-03 3 1  ON 57
ci_0059                -3.395815e-03 3 1  ON 58
ci_0060                -3.375888e-03 3 1  ON 59
ci_0061                -3.976504e-03 3 1  ON 60
ci_0062                -3.922365e-03 3 1  ON 61
ci_0063                -9.802580e-03 3 1  ON 62
ci_0064                -9.372600e-03 3 1  ON 63
ci_0065                -6.435479e-03 3 1  ON 64
ci_0066                -6.132151e-03 3 1  ON 65
ci_0067                -3.747986e-03 3 1  ON 66
ci_0068                -3.479531e-03 3 1  ON 67
ci_0069                 3.569219e-03 3 1  ON 68
ci_0070                 3.348549e-03 3 1  ON 69
ci_0071                 3.005272e-03 3 1  ON 70
ci_0072                 3.481734e-03 3 1  ON 71
ci_0073                 3.552587e-03 3 1  ON 72
ci_0074                 3.528871e-03 3 1  ON 73
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 77
    time step          = 0.05
    reference energy   = -16.9057
    reference variance = 0.200115
====================================================
  Execution time = 1.6067e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s077
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6898e+01
  VMC Evar = 2.9123e-01
  Total weights = 1.9511e+06
  Execution time = 1.8722e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.281088620068
                                         uncertainty =       0.001620612863

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.281088620068
                                         uncertainty =       0.001620612863

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000374898623
  error estimate for blocks of size 2^( 2) =       0.000391590744
  error estimate for blocks of size 2^( 3) =       0.000408336690
  error estimate for blocks of size 2^( 4) =       0.000423361614
  error estimate for blocks of size 2^( 5) =       0.000433636928
  error estimate for blocks of size 2^( 6) =       0.000439586733
  error estimate for blocks of size 2^( 7) =       0.000445308404

      target function =      -0.926452561000
              le_mean =     -16.898469087129
             les_mean =     285.849484519496
             stat err =       0.000435473420
             autocorr =       1.349259900264
   target nu stat err =       0.000435473420
   target dn stat err =       0.002225281785
      target stat err =       0.003578735872
              std dev =       0.530186717234
             le_variance =       0.281097955132

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.281088620065
                                         uncertainty =       0.001620612863

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.281088620065
                                         uncertainty =       0.001620612863

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000374898623
  error estimate for blocks of size 2^( 2) =       0.000391590744
  error estimate for blocks of size 2^( 3) =       0.000408336690
  error estimate for blocks of size 2^( 4) =       0.000423361614
  error estimate for blocks of size 2^( 5) =       0.000433636928
  error estimate for blocks of size 2^( 6) =       0.000439586733
  error estimate for blocks of size 2^( 7) =       0.000445308404

      target function =      -0.926452561014
              le_mean =     -16.898469087129
             les_mean =     285.849484519496
             stat err =       0.000435473420
             autocorr =       1.349259900267
   target nu stat err =       0.000435473420
   target dn stat err =       0.002225281778
      target stat err =       0.003578735861
              std dev =       0.530186717231
             le_variance =       0.281097955128

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.281088620066
                                         uncertainty =       0.001620612863

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.281088620066
                                         uncertainty =       0.001620612863

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000374898623
  error estimate for blocks of size 2^( 2) =       0.000391590744
  error estimate for blocks of size 2^( 3) =       0.000408336690
  error estimate for blocks of size 2^( 4) =       0.000423361614
  error estimate for blocks of size 2^( 5) =       0.000433636928
  error estimate for blocks of size 2^( 6) =       0.000439586733
  error estimate for blocks of size 2^( 7) =       0.000445308404

      target function =      -0.926452561007
              le_mean =     -16.898469087129
             les_mean =     285.849484519496
             stat err =       0.000435473420
             autocorr =       1.349259900267
   target nu stat err =       0.000435473420
   target dn stat err =       0.002225281781
      target stat err =       0.003578735867
              std dev =       0.530186717233
             le_variance =       0.281097955130

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.281088620068
                                         uncertainty =       0.001620612863

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.281088620068
                                         uncertainty =       0.001620612863

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000374898623
  error estimate for blocks of size 2^( 2) =       0.000391590744
  error estimate for blocks of size 2^( 3) =       0.000408336690
  error estimate for blocks of size 2^( 4) =       0.000423361614
  error estimate for blocks of size 2^( 5) =       0.000433636928
  error estimate for blocks of size 2^( 6) =       0.000439586733
  error estimate for blocks of size 2^( 7) =       0.000445308404

      target function =      -0.926452561001
              le_mean =     -16.898469087129
             les_mean =     285.849484519496
             stat err =       0.000435473420
             autocorr =       1.349259900265
   target nu stat err =       0.000435473420
   target dn stat err =       0.002225281784
      target stat err =       0.003578735871
              std dev =       0.530186717234
             le_variance =       0.281097955131


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.926452561000        initial
     5.4210e+06     5.4210e+07             5.9215e-11        -0.926452561014  <--
     2.1684e+07     2.1684e+08             1.4804e-11        -0.926452561007
     8.6736e+07     8.6736e+08             3.7011e-12        -0.926452561001

*****************************************************************************
Applying the update for shift_i =   5.4210e+06     and shift_s =   5.4210e+07
*****************************************************************************

  Execution time = 2.5495e+01
  </log>
  <optVariables href="H2O.s077.opt.xml">
ci_0001                 7.086064e-01 3 1  ON 0
ci_0002                 6.927483e-01 3 1  ON 1
ci_0003                -3.099699e-02 3 1  ON 2
ci_0004                -3.009162e-02 3 1  ON 3
ci_0005                -3.060382e-02 3 1  ON 4
ci_0006                -3.069586e-02 3 1  ON 5
ci_0007                -1.338102e-02 3 1  ON 6
ci_0008                -1.335093e-02 3 1  ON 7
ci_0009                -1.869650e-02 3 1  ON 8
ci_0010                -1.813030e-02 3 1  ON 9
ci_0011                -1.474501e-02 3 1  ON 10
ci_0012                -1.451134e-02 3 1  ON 11
ci_0013                 1.529423e-02 3 1  ON 12
ci_0014                 1.480516e-02 3 1  ON 13
ci_0015                 1.574766e-02 3 1  ON 14
ci_0016                 1.538632e-02 3 1  ON 15
ci_0017                 1.336745e-02 3 1  ON 16
ci_0018                 1.303906e-02 3 1  ON 17
ci_0019                 1.308950e-02 3 1  ON 18
ci_0020                 1.266839e-02 3 1  ON 19
ci_0021                 6.752770e-03 3 1  ON 20
ci_0022                 7.460538e-03 3 1  ON 21
ci_0023                -1.180403e-02 3 1  ON 22
ci_0024                -1.147023e-02 3 1  ON 23
ci_0025                -2.029570e-03 3 1  ON 24
ci_0026                -2.390747e-03 3 1  ON 25
ci_0027                -1.213155e-02 3 1  ON 26
ci_0028                -1.154912e-02 3 1  ON 27
ci_0029                -1.065832e-02 3 1  ON 28
ci_0030                -1.058734e-02 3 1  ON 29
ci_0031                 1.340906e-02 3 1  ON 30
ci_0032                 1.211459e-02 3 1  ON 31
ci_0033                 7.848177e-03 3 1  ON 32
ci_0034                 8.489627e-03 3 1  ON 33
ci_0035                 4.859421e-03 3 1  ON 34
ci_0036                 4.933671e-03 3 1  ON 35
ci_0037                -1.133359e-02 3 1  ON 36
ci_0038                -1.131343e-02 3 1  ON 37
ci_0039                -4.014992e-03 3 1  ON 38
ci_0040                -3.886155e-03 3 1  ON 39
ci_0041                 9.104241e-03 3 1  ON 40
ci_0042                 8.780957e-03 3 1  ON 41
ci_0043                -1.307372e-02 3 1  ON 42
ci_0044                -1.384583e-02 3 1  ON 43
ci_0045                 1.059118e-02 3 1  ON 44
ci_0046                 1.007868e-02 3 1  ON 45
ci_0047                -3.585075e-03 3 1  ON 46
ci_0048                -3.481623e-03 3 1  ON 47
ci_0049                -2.594629e-03 3 1  ON 48
ci_0050                -2.695910e-03 3 1  ON 49
ci_0051                -1.797585e-03 3 1  ON 50
ci_0052                -2.016123e-03 3 1  ON 51
ci_0053                -3.931437e-03 3 1  ON 52
ci_0054                -3.323922e-03 3 1  ON 53
ci_0055                 2.398828e-03 3 1  ON 54
ci_0056                 2.269778e-03 3 1  ON 55
ci_0057                 2.453986e-03 3 1  ON 56
ci_0058                 2.857281e-03 3 1  ON 57
ci_0059                -3.395815e-03 3 1  ON 58
ci_0060                -3.375888e-03 3 1  ON 59
ci_0061                -3.976504e-03 3 1  ON 60
ci_0062                -3.922365e-03 3 1  ON 61
ci_0063                -9.802580e-03 3 1  ON 62
ci_0064                -9.372600e-03 3 1  ON 63
ci_0065                -6.435479e-03 3 1  ON 64
ci_0066                -6.132151e-03 3 1  ON 65
ci_0067                -3.747986e-03 3 1  ON 66
ci_0068                -3.479531e-03 3 1  ON 67
ci_0069                 3.569219e-03 3 1  ON 68
ci_0070                 3.348549e-03 3 1  ON 69
ci_0071                 3.005272e-03 3 1  ON 70
ci_0072                 3.481734e-03 3 1  ON 71
ci_0073                 3.552587e-03 3 1  ON 72
ci_0074                 3.528871e-03 3 1  ON 73
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 4.4419e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s078 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s078 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=78  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6902e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 78
    time step          = 0.05
    reference energy   = -16.8728
    reference variance = 0.203349
====================================================
  Execution time = 1.4072e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s078
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5260e+04
  VMC Eavg = -1.6899e+01
  VMC Evar = 2.9232e-01
  Total weights = 1.950886628e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 2.5395e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.282483269371
                                         uncertainty =       0.001823724093

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.282483269371
                                         uncertainty =       0.001823724093

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000375837589
  error estimate for blocks of size 2^( 2) =       0.000392546445
  error estimate for blocks of size 2^( 3) =       0.000410355606
  error estimate for blocks of size 2^( 4) =       0.000426378395
  error estimate for blocks of size 2^( 5) =       0.000438820422
  error estimate for blocks of size 2^( 6) =       0.000446319944
  error estimate for blocks of size 2^( 7) =       0.000451185740

      target function =      -0.924739769944
              le_mean =     -16.898537250375
             les_mean =     285.852878946793
             stat err =       0.000440676125
             autocorr =       1.374797128475
   target nu stat err =       0.000440676125
   target dn stat err =       0.002303395308
      target stat err =       0.003687929844
              std dev =       0.531514615981
             le_variance =       0.282507787001


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.689853725038e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 74
Check correct_vf_var_size: 225, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.3553e+06, overlap shift 1.3553e+07 and omega -1.7444e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.924752998866       residual = 9.92e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.924752998898       residual = 1.25e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.924752998904       residual = 4.40e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.924752998905       residual = 1.41e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.924752998791       residual = 4.32e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.924752999137       residual = 2.51e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.924752997976       residual = 4.60e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.924752995078       residual = 2.73e-06           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.924752996740       residual = 9.08e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.924753000439       residual = 2.93e-07           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.924752999732       residual = 1.49e-07           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.924752998325       residual = 6.52e-08           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.924752998105       residual = 4.94e-08           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.924752998640       residual = 5.35e-08           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.924752999590       residual = 4.37e-08           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.924752999354       residual = 2.16e-08           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.924752994237       residual = 9.44e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         16 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 1.3553e+06 is 1.270221e-10

solving harmonic davidson linear method for identity shift 5.4210e+06, overlap shift 5.4210e+07 and omega -1.7444e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.924752998866       residual = 9.92e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.924752998874       residual = 1.25e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.924752998876       residual = 4.40e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.924752998876       residual = 1.41e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.924752998876       residual = 4.32e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.924752999036       residual = 2.51e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.924752998765       residual = 4.60e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.924752991942       residual = 2.73e-06           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.924752995060       residual = 9.08e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.924753004336       residual = 2.93e-07           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.924753001457       residual = 1.49e-07           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.924753000036       residual = 6.53e-08           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.924752995070       residual = 4.94e-08           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.924752980702       residual = 5.35e-08           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.924752999521       residual = 4.37e-08           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.924752995386       residual = 2.16e-08           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.924752988207       residual = 9.44e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         16 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 5.4210e+06 is 3.175554e-11

solving harmonic davidson linear method for identity shift 2.1684e+07, overlap shift 2.1684e+08 and omega -1.7444e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.924752998866       residual = 9.92e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.924752998868       residual = 1.25e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.924752998869       residual = 4.40e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.924752998869       residual = 1.41e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.924752998862       residual = 4.32e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.924752990884       residual = 2.51e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.924753004331       residual = 4.60e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.924752978581       residual = 2.73e-06           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.924752962258       residual = 9.09e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.924752991499       residual = 2.93e-07           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.924752990598       residual = 1.49e-07           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.924752959255       residual = 6.53e-08           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.924752981732       residual = 4.94e-08           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.924753056421       residual = 5.35e-08           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.924752965379       residual = 4.37e-08           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.924753012119       residual = 2.16e-08           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.924753033492       residual = 9.44e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         16 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 2.1684e+07 is 7.938871e-12

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.906943 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 75 and numParams is: 74

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.6626e+01
  </log>
  <optVariables href="H2O.s078.opt.xml">
ci_0001                 7.086064e-01 3 1  ON 0
ci_0002                 6.927483e-01 3 1  ON 1
ci_0003                -3.099699e-02 3 1  ON 2
ci_0004                -3.009162e-02 3 1  ON 3
ci_0005                -3.060382e-02 3 1  ON 4
ci_0006                -3.069586e-02 3 1  ON 5
ci_0007                -1.338102e-02 3 1  ON 6
ci_0008                -1.335093e-02 3 1  ON 7
ci_0009                -1.869650e-02 3 1  ON 8
ci_0010                -1.813030e-02 3 1  ON 9
ci_0011                -1.474501e-02 3 1  ON 10
ci_0012                -1.451134e-02 3 1  ON 11
ci_0013                 1.529423e-02 3 1  ON 12
ci_0014                 1.480516e-02 3 1  ON 13
ci_0015                 1.574766e-02 3 1  ON 14
ci_0016                 1.538632e-02 3 1  ON 15
ci_0017                 1.336745e-02 3 1  ON 16
ci_0018                 1.303906e-02 3 1  ON 17
ci_0019                 1.308950e-02 3 1  ON 18
ci_0020                 1.266839e-02 3 1  ON 19
ci_0021                 6.752770e-03 3 1  ON 20
ci_0022                 7.460538e-03 3 1  ON 21
ci_0023                -1.180403e-02 3 1  ON 22
ci_0024                -1.147023e-02 3 1  ON 23
ci_0025                -2.029570e-03 3 1  ON 24
ci_0026                -2.390747e-03 3 1  ON 25
ci_0027                -1.213155e-02 3 1  ON 26
ci_0028                -1.154912e-02 3 1  ON 27
ci_0029                -1.065832e-02 3 1  ON 28
ci_0030                -1.058734e-02 3 1  ON 29
ci_0031                 1.340906e-02 3 1  ON 30
ci_0032                 1.211459e-02 3 1  ON 31
ci_0033                 7.848177e-03 3 1  ON 32
ci_0034                 8.489627e-03 3 1  ON 33
ci_0035                 4.859421e-03 3 1  ON 34
ci_0036                 4.933671e-03 3 1  ON 35
ci_0037                -1.133359e-02 3 1  ON 36
ci_0038                -1.131343e-02 3 1  ON 37
ci_0039                -4.014992e-03 3 1  ON 38
ci_0040                -3.886155e-03 3 1  ON 39
ci_0041                 9.104242e-03 3 1  ON 40
ci_0042                 8.780957e-03 3 1  ON 41
ci_0043                -1.307372e-02 3 1  ON 42
ci_0044                -1.384583e-02 3 1  ON 43
ci_0045                 1.059118e-02 3 1  ON 44
ci_0046                 1.007868e-02 3 1  ON 45
ci_0047                -3.585075e-03 3 1  ON 46
ci_0048                -3.481623e-03 3 1  ON 47
ci_0049                -2.594629e-03 3 1  ON 48
ci_0050                -2.695910e-03 3 1  ON 49
ci_0051                -1.797585e-03 3 1  ON 50
ci_0052                -2.016123e-03 3 1  ON 51
ci_0053                -3.931437e-03 3 1  ON 52
ci_0054                -3.323922e-03 3 1  ON 53
ci_0055                 2.398828e-03 3 1  ON 54
ci_0056                 2.269778e-03 3 1  ON 55
ci_0057                 2.453986e-03 3 1  ON 56
ci_0058                 2.857281e-03 3 1  ON 57
ci_0059                -3.395815e-03 3 1  ON 58
ci_0060                -3.375888e-03 3 1  ON 59
ci_0061                -3.976504e-03 3 1  ON 60
ci_0062                -3.922365e-03 3 1  ON 61
ci_0063                -9.802580e-03 3 1  ON 62
ci_0064                -9.372600e-03 3 1  ON 63
ci_0065                -6.435479e-03 3 1  ON 64
ci_0066                -6.132151e-03 3 1  ON 65
ci_0067                -3.747986e-03 3 1  ON 66
ci_0068                -3.479531e-03 3 1  ON 67
ci_0069                 3.569219e-03 3 1  ON 68
ci_0070                 3.348549e-03 3 1  ON 69
ci_0071                 3.005272e-03 3 1  ON 70
ci_0072                 3.481734e-03 3 1  ON 71
ci_0073                 3.552587e-03 3 1  ON 72
ci_0074                 3.528871e-03 3 1  ON 73
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 78
    time step          = 0.05
    reference energy   = -16.9112
    reference variance = 0.278379
====================================================
  Execution time = 1.4041e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s078
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6899e+01
  VMC Evar = 2.9179e-01
  Total weights = 1.9510e+06
  Execution time = 1.8711e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.281935920567
                                         uncertainty =       0.001913138496

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.281935920567
                                         uncertainty =       0.001913138496

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000375487353
  error estimate for blocks of size 2^( 2) =       0.000391998575
  error estimate for blocks of size 2^( 3) =       0.000408984413
  error estimate for blocks of size 2^( 4) =       0.000423077019
  error estimate for blocks of size 2^( 5) =       0.000433196890
  error estimate for blocks of size 2^( 6) =       0.000438805284
  error estimate for blocks of size 2^( 7) =       0.000442062188

      target function =      -0.925563690708
              le_mean =     -16.898820031168
             les_mean =     285.861909359514
             stat err =       0.000434285345
             autocorr =       1.337703060554
   target nu stat err =       0.000434285345
   target dn stat err =       0.002849730296
      target stat err =       0.004538660831
              std dev =       0.531019307730
             le_variance =       0.281981505182

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.281935920540
                                         uncertainty =       0.001913138492

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.281935920540
                                         uncertainty =       0.001913138492

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000375487353
  error estimate for blocks of size 2^( 2) =       0.000391998575
  error estimate for blocks of size 2^( 3) =       0.000408984413
  error estimate for blocks of size 2^( 4) =       0.000423077019
  error estimate for blocks of size 2^( 5) =       0.000433196890
  error estimate for blocks of size 2^( 6) =       0.000438805284
  error estimate for blocks of size 2^( 7) =       0.000442062188

      target function =      -0.925563690726
              le_mean =     -16.898820031168
             les_mean =     285.861909359480
             stat err =       0.000434285345
             autocorr =       1.337703060573
   target nu stat err =       0.000434285345
   target dn stat err =       0.002849730290
      target stat err =       0.004538660820
              std dev =       0.531019307706
             le_variance =       0.281981505157

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.281935920553
                                         uncertainty =       0.001913138494

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.281935920553
                                         uncertainty =       0.001913138494

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000375487353
  error estimate for blocks of size 2^( 2) =       0.000391998575
  error estimate for blocks of size 2^( 3) =       0.000408984413
  error estimate for blocks of size 2^( 4) =       0.000423077019
  error estimate for blocks of size 2^( 5) =       0.000433196890
  error estimate for blocks of size 2^( 6) =       0.000438805284
  error estimate for blocks of size 2^( 7) =       0.000442062188

      target function =      -0.925563690717
              le_mean =     -16.898820031168
             les_mean =     285.861909359497
             stat err =       0.000434285345
             autocorr =       1.337703060566
   target nu stat err =       0.000434285345
   target dn stat err =       0.002849730293
      target stat err =       0.004538660826
              std dev =       0.531019307718
             le_variance =       0.281981505170

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.281935920565
                                         uncertainty =       0.001913138496

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.281935920565
                                         uncertainty =       0.001913138496

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000375487353
  error estimate for blocks of size 2^( 2) =       0.000391998575
  error estimate for blocks of size 2^( 3) =       0.000408984413
  error estimate for blocks of size 2^( 4) =       0.000423077019
  error estimate for blocks of size 2^( 5) =       0.000433196890
  error estimate for blocks of size 2^( 6) =       0.000438805284
  error estimate for blocks of size 2^( 7) =       0.000442062188

      target function =      -0.925563690709
              le_mean =     -16.898820031168
             les_mean =     285.861909359512
             stat err =       0.000434285345
             autocorr =       1.337703060561
   target nu stat err =       0.000434285345
   target dn stat err =       0.002849730296
      target stat err =       0.004538660830
              std dev =       0.531019307729
             le_variance =       0.281981505181


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.925563690708        initial
     1.3553e+06     1.3553e+07             1.2702e-10        -0.925563690726  <--
     5.4210e+06     5.4210e+07             3.1756e-11        -0.925563690717
     2.1684e+07     2.1684e+08             7.9389e-12        -0.925563690709

*****************************************************************************
Applying the update for shift_i =   1.3553e+06     and shift_s =   1.3553e+07
*****************************************************************************

  Execution time = 2.3472e+01
  </log>
  <optVariables href="H2O.s078.opt.xml">
ci_0001                 7.086064e-01 3 1  ON 0
ci_0002                 6.927483e-01 3 1  ON 1
ci_0003                -3.099699e-02 3 1  ON 2
ci_0004                -3.009162e-02 3 1  ON 3
ci_0005                -3.060382e-02 3 1  ON 4
ci_0006                -3.069586e-02 3 1  ON 5
ci_0007                -1.338102e-02 3 1  ON 6
ci_0008                -1.335093e-02 3 1  ON 7
ci_0009                -1.869650e-02 3 1  ON 8
ci_0010                -1.813030e-02 3 1  ON 9
ci_0011                -1.474501e-02 3 1  ON 10
ci_0012                -1.451134e-02 3 1  ON 11
ci_0013                 1.529423e-02 3 1  ON 12
ci_0014                 1.480516e-02 3 1  ON 13
ci_0015                 1.574766e-02 3 1  ON 14
ci_0016                 1.538632e-02 3 1  ON 15
ci_0017                 1.336745e-02 3 1  ON 16
ci_0018                 1.303906e-02 3 1  ON 17
ci_0019                 1.308950e-02 3 1  ON 18
ci_0020                 1.266839e-02 3 1  ON 19
ci_0021                 6.752770e-03 3 1  ON 20
ci_0022                 7.460538e-03 3 1  ON 21
ci_0023                -1.180403e-02 3 1  ON 22
ci_0024                -1.147023e-02 3 1  ON 23
ci_0025                -2.029570e-03 3 1  ON 24
ci_0026                -2.390747e-03 3 1  ON 25
ci_0027                -1.213155e-02 3 1  ON 26
ci_0028                -1.154912e-02 3 1  ON 27
ci_0029                -1.065832e-02 3 1  ON 28
ci_0030                -1.058734e-02 3 1  ON 29
ci_0031                 1.340906e-02 3 1  ON 30
ci_0032                 1.211459e-02 3 1  ON 31
ci_0033                 7.848177e-03 3 1  ON 32
ci_0034                 8.489627e-03 3 1  ON 33
ci_0035                 4.859421e-03 3 1  ON 34
ci_0036                 4.933671e-03 3 1  ON 35
ci_0037                -1.133359e-02 3 1  ON 36
ci_0038                -1.131343e-02 3 1  ON 37
ci_0039                -4.014992e-03 3 1  ON 38
ci_0040                -3.886155e-03 3 1  ON 39
ci_0041                 9.104242e-03 3 1  ON 40
ci_0042                 8.780957e-03 3 1  ON 41
ci_0043                -1.307372e-02 3 1  ON 42
ci_0044                -1.384583e-02 3 1  ON 43
ci_0045                 1.059118e-02 3 1  ON 44
ci_0046                 1.007868e-02 3 1  ON 45
ci_0047                -3.585075e-03 3 1  ON 46
ci_0048                -3.481623e-03 3 1  ON 47
ci_0049                -2.594629e-03 3 1  ON 48
ci_0050                -2.695910e-03 3 1  ON 49
ci_0051                -1.797585e-03 3 1  ON 50
ci_0052                -2.016123e-03 3 1  ON 51
ci_0053                -3.931436e-03 3 1  ON 52
ci_0054                -3.323922e-03 3 1  ON 53
ci_0055                 2.398828e-03 3 1  ON 54
ci_0056                 2.269778e-03 3 1  ON 55
ci_0057                 2.453986e-03 3 1  ON 56
ci_0058                 2.857281e-03 3 1  ON 57
ci_0059                -3.395815e-03 3 1  ON 58
ci_0060                -3.375888e-03 3 1  ON 59
ci_0061                -3.976504e-03 3 1  ON 60
ci_0062                -3.922365e-03 3 1  ON 61
ci_0063                -9.802580e-03 3 1  ON 62
ci_0064                -9.372600e-03 3 1  ON 63
ci_0065                -6.435479e-03 3 1  ON 64
ci_0066                -6.132151e-03 3 1  ON 65
ci_0067                -3.747986e-03 3 1  ON 66
ci_0068                -3.479531e-03 3 1  ON 67
ci_0069                 3.569219e-03 3 1  ON 68
ci_0070                 3.348549e-03 3 1  ON 69
ci_0071                 3.005272e-03 3 1  ON 70
ci_0072                 3.481734e-03 3 1  ON 71
ci_0073                 3.552587e-03 3 1  ON 72
ci_0074                 3.528871e-03 3 1  ON 73
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 4.0104e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s079 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s079 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=79  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6902e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 79
    time step          = 0.05
    reference energy   = -16.9197
    reference variance = 0.170773
====================================================
  Execution time = 1.4028e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s079
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5211e+04
  VMC Eavg = -1.6899e+01
  VMC Evar = 2.9420e-01
  Total weights = 1.951070732e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 2.5502e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.284771365917
                                         uncertainty =       0.002205526570

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.284771365917
                                         uncertainty =       0.002205526570

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000377369353
  error estimate for blocks of size 2^( 2) =       0.000394519797
  error estimate for blocks of size 2^( 3) =       0.000411614778
  error estimate for blocks of size 2^( 4) =       0.000427113016
  error estimate for blocks of size 2^( 5) =       0.000439003011
  error estimate for blocks of size 2^( 6) =       0.000446067354
  error estimate for blocks of size 2^( 7) =       0.000451451871

      target function =      -0.921794961669
              le_mean =     -16.899122752487
             les_mean =     285.874549741349
             stat err =       0.000440908813
             autocorr =       1.365099491326
   target nu stat err =       0.000440908813
   target dn stat err =       0.002885504317
      target stat err =       0.004561641151
              std dev =       0.533680856805
             le_variance =       0.284815256920


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.689912275249e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 74
Check correct_vf_var_size: 225, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 3.3881e+05, overlap shift 3.3881e+06 and omega -1.7444e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.921816250339       residual = 1.45e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.921816250505       residual = 2.80e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.921816250538       residual = 5.38e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.921816250547       residual = 2.11e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.921816250554       residual = 9.19e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.921816250556       residual = 6.18e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.921816250558       residual = 1.59e-05           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.921816250559       residual = 3.00e-06           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.921816250559       residual = 7.62e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.921816250559       residual = 4.96e-07           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.921816250559       residual = 2.77e-07           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.921816250559       residual = 8.83e-08           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.921816250559       residual = 4.40e-08           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.921816250559       residual = 4.81e-08           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.921816250559       residual = 5.04e-08           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.921816250899       residual = 2.80e-08           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.921816250506       residual = 1.43e-08           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.921816250559       residual = 4.38e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         17 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 3.3881e+05 is 8.650328e-10

solving harmonic davidson linear method for identity shift 1.3553e+06, overlap shift 1.3553e+07 and omega -1.7444e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.921816250339       residual = 1.45e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.921816250381       residual = 2.80e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.921816250389       residual = 5.38e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.921816250391       residual = 2.11e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.921816250393       residual = 9.19e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.921816250394       residual = 6.18e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.921816248840       residual = 1.59e-05           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.921816249934       residual = 3.00e-06           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.921816250394       residual = 7.62e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.921816250394       residual = 4.96e-07           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.921816250394       residual = 2.77e-07           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.921816253348       residual = 8.83e-08           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.921816250944       residual = 4.40e-08           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.921816250394       residual = 4.81e-08           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.921816250394       residual = 5.04e-08           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.921816252550       residual = 2.80e-08           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.921816250394       residual = 1.43e-08           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.921816250566       residual = 4.38e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         17 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 1.3553e+06 is 2.162582e-10

solving harmonic davidson linear method for identity shift 5.4210e+06, overlap shift 5.4210e+07 and omega -1.7444e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.921816250339       residual = 1.45e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.921816250350       residual = 2.80e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.921816250352       residual = 5.38e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.921816250352       residual = 2.11e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.921816250353       residual = 9.19e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.921816250353       residual = 6.18e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.921816241021       residual = 1.59e-05           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.921816256276       residual = 3.00e-06           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.921816254579       residual = 7.62e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.921816246059       residual = 4.96e-07           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.921816258586       residual = 2.77e-07           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.921816252739       residual = 8.83e-08           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.921816245084       residual = 4.40e-08           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.921816241708       residual = 4.81e-08           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.921816247946       residual = 5.04e-08           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.921816251448       residual = 2.80e-08           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.921816251230       residual = 1.43e-08           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.921816256052       residual = 4.38e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         17 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 5.4210e+06 is 5.406450e-11

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.917029 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 75 and numParams is: 74

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.6597e+01
  </log>
  <optVariables href="H2O.s079.opt.xml">
ci_0001                 7.086064e-01 3 1  ON 0
ci_0002                 6.927483e-01 3 1  ON 1
ci_0003                -3.099699e-02 3 1  ON 2
ci_0004                -3.009162e-02 3 1  ON 3
ci_0005                -3.060382e-02 3 1  ON 4
ci_0006                -3.069586e-02 3 1  ON 5
ci_0007                -1.338102e-02 3 1  ON 6
ci_0008                -1.335093e-02 3 1  ON 7
ci_0009                -1.869650e-02 3 1  ON 8
ci_0010                -1.813030e-02 3 1  ON 9
ci_0011                -1.474501e-02 3 1  ON 10
ci_0012                -1.451134e-02 3 1  ON 11
ci_0013                 1.529423e-02 3 1  ON 12
ci_0014                 1.480516e-02 3 1  ON 13
ci_0015                 1.574766e-02 3 1  ON 14
ci_0016                 1.538632e-02 3 1  ON 15
ci_0017                 1.336745e-02 3 1  ON 16
ci_0018                 1.303906e-02 3 1  ON 17
ci_0019                 1.308950e-02 3 1  ON 18
ci_0020                 1.266839e-02 3 1  ON 19
ci_0021                 6.752770e-03 3 1  ON 20
ci_0022                 7.460538e-03 3 1  ON 21
ci_0023                -1.180403e-02 3 1  ON 22
ci_0024                -1.147023e-02 3 1  ON 23
ci_0025                -2.029570e-03 3 1  ON 24
ci_0026                -2.390747e-03 3 1  ON 25
ci_0027                -1.213155e-02 3 1  ON 26
ci_0028                -1.154912e-02 3 1  ON 27
ci_0029                -1.065832e-02 3 1  ON 28
ci_0030                -1.058734e-02 3 1  ON 29
ci_0031                 1.340906e-02 3 1  ON 30
ci_0032                 1.211459e-02 3 1  ON 31
ci_0033                 7.848177e-03 3 1  ON 32
ci_0034                 8.489627e-03 3 1  ON 33
ci_0035                 4.859421e-03 3 1  ON 34
ci_0036                 4.933671e-03 3 1  ON 35
ci_0037                -1.133359e-02 3 1  ON 36
ci_0038                -1.131343e-02 3 1  ON 37
ci_0039                -4.014992e-03 3 1  ON 38
ci_0040                -3.886155e-03 3 1  ON 39
ci_0041                 9.104242e-03 3 1  ON 40
ci_0042                 8.780957e-03 3 1  ON 41
ci_0043                -1.307372e-02 3 1  ON 42
ci_0044                -1.384583e-02 3 1  ON 43
ci_0045                 1.059118e-02 3 1  ON 44
ci_0046                 1.007868e-02 3 1  ON 45
ci_0047                -3.585075e-03 3 1  ON 46
ci_0048                -3.481623e-03 3 1  ON 47
ci_0049                -2.594629e-03 3 1  ON 48
ci_0050                -2.695910e-03 3 1  ON 49
ci_0051                -1.797585e-03 3 1  ON 50
ci_0052                -2.016123e-03 3 1  ON 51
ci_0053                -3.931436e-03 3 1  ON 52
ci_0054                -3.323922e-03 3 1  ON 53
ci_0055                 2.398828e-03 3 1  ON 54
ci_0056                 2.269778e-03 3 1  ON 55
ci_0057                 2.453986e-03 3 1  ON 56
ci_0058                 2.857281e-03 3 1  ON 57
ci_0059                -3.395815e-03 3 1  ON 58
ci_0060                -3.375888e-03 3 1  ON 59
ci_0061                -3.976504e-03 3 1  ON 60
ci_0062                -3.922365e-03 3 1  ON 61
ci_0063                -9.802580e-03 3 1  ON 62
ci_0064                -9.372600e-03 3 1  ON 63
ci_0065                -6.435479e-03 3 1  ON 64
ci_0066                -6.132151e-03 3 1  ON 65
ci_0067                -3.747986e-03 3 1  ON 66
ci_0068                -3.479531e-03 3 1  ON 67
ci_0069                 3.569219e-03 3 1  ON 68
ci_0070                 3.348549e-03 3 1  ON 69
ci_0071                 3.005272e-03 3 1  ON 70
ci_0072                 3.481734e-03 3 1  ON 71
ci_0073                 3.552587e-03 3 1  ON 72
ci_0074                 3.528871e-03 3 1  ON 73
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 79
    time step          = 0.05
    reference energy   = -16.956
    reference variance = 0.308447
====================================================
  Execution time = 1.4046e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s079
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6899e+01
  VMC Evar = 2.9590e-01
  Total weights = 1.9512e+06
  Execution time = 1.8765e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.283260271237
                                         uncertainty =       0.001814400018

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.283260271237
                                         uncertainty =       0.001814400018

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000376284803
  error estimate for blocks of size 2^( 2) =       0.000393489975
  error estimate for blocks of size 2^( 3) =       0.000411298392
  error estimate for blocks of size 2^( 4) =       0.000426374795
  error estimate for blocks of size 2^( 5) =       0.000438485150
  error estimate for blocks of size 2^( 6) =       0.000446871293
  error estimate for blocks of size 2^( 7) =       0.000451244768

      target function =      -0.919132680519
              le_mean =     -16.898901487549
             les_mean =     285.868770032581
             stat err =       0.000440744002
             autocorr =       1.371953726224
   target nu stat err =       0.000440744002
   target dn stat err =       0.004000013088
      target stat err =       0.006244445432
              std dev =       0.532147071562
             le_variance =       0.283180505772

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.283260271215
                                         uncertainty =       0.001814400010

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.283260271215
                                         uncertainty =       0.001814400010

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000376284803
  error estimate for blocks of size 2^( 2) =       0.000393489975
  error estimate for blocks of size 2^( 3) =       0.000411298392
  error estimate for blocks of size 2^( 4) =       0.000426374795
  error estimate for blocks of size 2^( 5) =       0.000438485150
  error estimate for blocks of size 2^( 6) =       0.000446871293
  error estimate for blocks of size 2^( 7) =       0.000451244768

      target function =      -0.919131898021
              le_mean =     -16.898901487551
             les_mean =     285.868770537505
             stat err =       0.000440744002
             autocorr =       1.371953726109
   target nu stat err =       0.000440744002
   target dn stat err =       0.004000013708
      target stat err =       0.006244435828
              std dev =       0.532147071542
             le_variance =       0.283180505750

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.283260271226
                                         uncertainty =       0.001814400014

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.283260271226
                                         uncertainty =       0.001814400014

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000376284803
  error estimate for blocks of size 2^( 2) =       0.000393489975
  error estimate for blocks of size 2^( 3) =       0.000411298392
  error estimate for blocks of size 2^( 4) =       0.000426374795
  error estimate for blocks of size 2^( 5) =       0.000438485150
  error estimate for blocks of size 2^( 6) =       0.000446871293
  error estimate for blocks of size 2^( 7) =       0.000451244768

      target function =      -0.919132299802
              le_mean =     -16.898901487550
             les_mean =     285.868770278247
             stat err =       0.000440744002
             autocorr =       1.371953726175
   target nu stat err =       0.000440744002
   target dn stat err =       0.004000013382
      target stat err =       0.006244440748
              std dev =       0.532147071552
             le_variance =       0.283180505761

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.283260271236
                                         uncertainty =       0.001814400017

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.283260271236
                                         uncertainty =       0.001814400017

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000376284803
  error estimate for blocks of size 2^( 2) =       0.000393489975
  error estimate for blocks of size 2^( 3) =       0.000411298392
  error estimate for blocks of size 2^( 4) =       0.000426374795
  error estimate for blocks of size 2^( 5) =       0.000438485150
  error estimate for blocks of size 2^( 6) =       0.000446871293
  error estimate for blocks of size 2^( 7) =       0.000451244768

      target function =      -0.919132634031
              le_mean =     -16.898901487549
             les_mean =     285.868770062578
             stat err =       0.000440744002
             autocorr =       1.371953726233
   target nu stat err =       0.000440744002
   target dn stat err =       0.004000013123
      target stat err =       0.006244444859
              std dev =       0.532147071561
             le_variance =       0.283180505771


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.919132680519        initial  <--
     3.3881e+05     3.3881e+06             8.6503e-10        -0.919131898021
     1.3553e+06     1.3553e+07             2.1626e-10        -0.919132299802
     5.4210e+06     5.4210e+07             5.4064e-11        -0.919132634031

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 23.4842
  </log>
  <optVariables href="H2O.s079.opt.xml">
ci_0001                 7.086064e-01 3 1  ON 0
ci_0002                 6.927483e-01 3 1  ON 1
ci_0003                -3.099699e-02 3 1  ON 2
ci_0004                -3.009162e-02 3 1  ON 3
ci_0005                -3.060382e-02 3 1  ON 4
ci_0006                -3.069586e-02 3 1  ON 5
ci_0007                -1.338102e-02 3 1  ON 6
ci_0008                -1.335093e-02 3 1  ON 7
ci_0009                -1.869650e-02 3 1  ON 8
ci_0010                -1.813030e-02 3 1  ON 9
ci_0011                -1.474501e-02 3 1  ON 10
ci_0012                -1.451134e-02 3 1  ON 11
ci_0013                 1.529423e-02 3 1  ON 12
ci_0014                 1.480516e-02 3 1  ON 13
ci_0015                 1.574766e-02 3 1  ON 14
ci_0016                 1.538632e-02 3 1  ON 15
ci_0017                 1.336745e-02 3 1  ON 16
ci_0018                 1.303906e-02 3 1  ON 17
ci_0019                 1.308950e-02 3 1  ON 18
ci_0020                 1.266839e-02 3 1  ON 19
ci_0021                 6.752770e-03 3 1  ON 20
ci_0022                 7.460538e-03 3 1  ON 21
ci_0023                -1.180403e-02 3 1  ON 22
ci_0024                -1.147023e-02 3 1  ON 23
ci_0025                -2.029570e-03 3 1  ON 24
ci_0026                -2.390747e-03 3 1  ON 25
ci_0027                -1.213155e-02 3 1  ON 26
ci_0028                -1.154912e-02 3 1  ON 27
ci_0029                -1.065832e-02 3 1  ON 28
ci_0030                -1.058734e-02 3 1  ON 29
ci_0031                 1.340906e-02 3 1  ON 30
ci_0032                 1.211459e-02 3 1  ON 31
ci_0033                 7.848177e-03 3 1  ON 32
ci_0034                 8.489627e-03 3 1  ON 33
ci_0035                 4.859421e-03 3 1  ON 34
ci_0036                 4.933671e-03 3 1  ON 35
ci_0037                -1.133359e-02 3 1  ON 36
ci_0038                -1.131343e-02 3 1  ON 37
ci_0039                -4.014992e-03 3 1  ON 38
ci_0040                -3.886155e-03 3 1  ON 39
ci_0041                 9.104242e-03 3 1  ON 40
ci_0042                 8.780957e-03 3 1  ON 41
ci_0043                -1.307372e-02 3 1  ON 42
ci_0044                -1.384583e-02 3 1  ON 43
ci_0045                 1.059118e-02 3 1  ON 44
ci_0046                 1.007868e-02 3 1  ON 45
ci_0047                -3.585075e-03 3 1  ON 46
ci_0048                -3.481623e-03 3 1  ON 47
ci_0049                -2.594629e-03 3 1  ON 48
ci_0050                -2.695910e-03 3 1  ON 49
ci_0051                -1.797585e-03 3 1  ON 50
ci_0052                -2.016123e-03 3 1  ON 51
ci_0053                -3.931436e-03 3 1  ON 52
ci_0054                -3.323922e-03 3 1  ON 53
ci_0055                 2.398828e-03 3 1  ON 54
ci_0056                 2.269778e-03 3 1  ON 55
ci_0057                 2.453986e-03 3 1  ON 56
ci_0058                 2.857281e-03 3 1  ON 57
ci_0059                -3.395815e-03 3 1  ON 58
ci_0060                -3.375888e-03 3 1  ON 59
ci_0061                -3.976504e-03 3 1  ON 60
ci_0062                -3.922365e-03 3 1  ON 61
ci_0063                -9.802580e-03 3 1  ON 62
ci_0064                -9.372600e-03 3 1  ON 63
ci_0065                -6.435479e-03 3 1  ON 64
ci_0066                -6.132151e-03 3 1  ON 65
ci_0067                -3.747986e-03 3 1  ON 66
ci_0068                -3.479531e-03 3 1  ON 67
ci_0069                 3.569219e-03 3 1  ON 68
ci_0070                 3.348549e-03 3 1  ON 69
ci_0071                 3.005272e-03 3 1  ON 70
ci_0072                 3.481734e-03 3 1  ON 71
ci_0073                 3.552587e-03 3 1  ON 72
ci_0074                 3.528871e-03 3 1  ON 73
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 4.0115e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s080 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s080 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=80  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6902e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 80
    time step          = 0.05
    reference energy   = -16.7989
    reference variance = 0.259907
====================================================
  Execution time = 1.4039e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s080
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5267e+04
  VMC Eavg = -1.6899e+01
  VMC Evar = 2.8870e-01
  Total weights = 1.951090215e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 2.5719e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.279752288366
                                         uncertainty =       0.001414761054

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.279752288366
                                         uncertainty =       0.001414761054

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000373988100
  error estimate for blocks of size 2^( 2) =       0.000391038216
  error estimate for blocks of size 2^( 3) =       0.000408442975
  error estimate for blocks of size 2^( 4) =       0.000423679056
  error estimate for blocks of size 2^( 5) =       0.000436034316
  error estimate for blocks of size 2^( 6) =       0.000443706235
  error estimate for blocks of size 2^( 7) =       0.000447012021

      target function =      -0.930448472207
              le_mean =     -16.898563530219
             les_mean =     285.850151034301
             stat err =       0.000437607907
             autocorr =       1.369161735824
   target nu stat err =       0.000437607907
   target dn stat err =       0.001984639560
      target stat err =       0.003237610160
              std dev =       0.528899043549
             le_variance =       0.279734198267


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.689856353022e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 74
Check correct_vf_var_size: 225, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 3.3881e+06, overlap shift 3.3881e+07 and omega -1.7444e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.930458338987       residual = 7.22e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.930458338996       residual = 1.42e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.930458338998       residual = 2.86e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.930458338998       residual = 1.12e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.930458339039       residual = 6.59e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.930458341864       residual = 6.60e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.930458338999       residual = 3.23e-05           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.930458338999       residual = 2.04e-05           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.930458335388       residual = 2.81e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.930458338088       residual = 1.23e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.930458336811       residual = 4.49e-06           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.930458347639       residual = 1.48e-06           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.930458338999       residual = 5.39e-07           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.930458338407       residual = 1.63e-07           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.930458342814       residual = 5.65e-08           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.930458338999       residual = 2.02e-08           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.930458332858       residual = 3.89e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         16 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 3.3881e+06 is 1.002107e-10

solving harmonic davidson linear method for identity shift 1.3553e+07, overlap shift 1.3553e+08 and omega -1.7444e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.930458338987       residual = 7.22e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.930458338989       residual = 1.42e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.930458338989       residual = 2.86e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.930458347316       residual = 1.12e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.930458338991       residual = 6.59e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.930458348050       residual = 6.60e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.930458328551       residual = 3.23e-05           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.930458338990       residual = 2.04e-05           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.930458356522       residual = 2.81e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.930458343778       residual = 1.23e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.930458338325       residual = 4.49e-06           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.930458342493       residual = 1.48e-06           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.930458303229       residual = 5.39e-07           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.930458365660       residual = 1.63e-07           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.930458299561       residual = 5.65e-08           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.930458351952       residual = 2.02e-08           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.930458339218       residual = 3.89e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         16 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 1.3553e+07 is 2.505246e-11

solving harmonic davidson linear method for identity shift 5.4210e+07, overlap shift 5.4210e+08 and omega -1.7444e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.930458338987       residual = 7.22e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.930458338987       residual = 1.42e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.930458338987       residual = 2.86e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.930458338988       residual = 1.12e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.930458338987       residual = 6.59e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.930458340038       residual = 6.60e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.930458337505       residual = 3.23e-05           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.930458303710       residual = 2.04e-05           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.930458375677       residual = 2.81e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.930458331456       residual = 1.23e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.930458328453       residual = 4.49e-06           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.930458353663       residual = 1.48e-06           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.930458356279       residual = 5.39e-07           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.930458252042       residual = 1.63e-07           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.930458263257       residual = 5.65e-08           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.930458278803       residual = 2.02e-08           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.930458221393       residual = 3.89e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         16 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 5.4210e+07 is 6.263217e-12

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.926046 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 75 and numParams is: 74

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.6625e+01
  </log>
  <optVariables href="H2O.s080.opt.xml">
ci_0001                 7.086064e-01 3 1  ON 0
ci_0002                 6.927483e-01 3 1  ON 1
ci_0003                -3.099699e-02 3 1  ON 2
ci_0004                -3.009162e-02 3 1  ON 3
ci_0005                -3.060382e-02 3 1  ON 4
ci_0006                -3.069586e-02 3 1  ON 5
ci_0007                -1.338102e-02 3 1  ON 6
ci_0008                -1.335093e-02 3 1  ON 7
ci_0009                -1.869650e-02 3 1  ON 8
ci_0010                -1.813030e-02 3 1  ON 9
ci_0011                -1.474501e-02 3 1  ON 10
ci_0012                -1.451134e-02 3 1  ON 11
ci_0013                 1.529423e-02 3 1  ON 12
ci_0014                 1.480516e-02 3 1  ON 13
ci_0015                 1.574766e-02 3 1  ON 14
ci_0016                 1.538632e-02 3 1  ON 15
ci_0017                 1.336745e-02 3 1  ON 16
ci_0018                 1.303906e-02 3 1  ON 17
ci_0019                 1.308950e-02 3 1  ON 18
ci_0020                 1.266839e-02 3 1  ON 19
ci_0021                 6.752770e-03 3 1  ON 20
ci_0022                 7.460538e-03 3 1  ON 21
ci_0023                -1.180403e-02 3 1  ON 22
ci_0024                -1.147023e-02 3 1  ON 23
ci_0025                -2.029570e-03 3 1  ON 24
ci_0026                -2.390747e-03 3 1  ON 25
ci_0027                -1.213155e-02 3 1  ON 26
ci_0028                -1.154912e-02 3 1  ON 27
ci_0029                -1.065832e-02 3 1  ON 28
ci_0030                -1.058734e-02 3 1  ON 29
ci_0031                 1.340906e-02 3 1  ON 30
ci_0032                 1.211459e-02 3 1  ON 31
ci_0033                 7.848177e-03 3 1  ON 32
ci_0034                 8.489627e-03 3 1  ON 33
ci_0035                 4.859421e-03 3 1  ON 34
ci_0036                 4.933671e-03 3 1  ON 35
ci_0037                -1.133359e-02 3 1  ON 36
ci_0038                -1.131343e-02 3 1  ON 37
ci_0039                -4.014992e-03 3 1  ON 38
ci_0040                -3.886155e-03 3 1  ON 39
ci_0041                 9.104242e-03 3 1  ON 40
ci_0042                 8.780957e-03 3 1  ON 41
ci_0043                -1.307372e-02 3 1  ON 42
ci_0044                -1.384583e-02 3 1  ON 43
ci_0045                 1.059118e-02 3 1  ON 44
ci_0046                 1.007868e-02 3 1  ON 45
ci_0047                -3.585075e-03 3 1  ON 46
ci_0048                -3.481623e-03 3 1  ON 47
ci_0049                -2.594629e-03 3 1  ON 48
ci_0050                -2.695910e-03 3 1  ON 49
ci_0051                -1.797585e-03 3 1  ON 50
ci_0052                -2.016123e-03 3 1  ON 51
ci_0053                -3.931436e-03 3 1  ON 52
ci_0054                -3.323922e-03 3 1  ON 53
ci_0055                 2.398828e-03 3 1  ON 54
ci_0056                 2.269778e-03 3 1  ON 55
ci_0057                 2.453986e-03 3 1  ON 56
ci_0058                 2.857281e-03 3 1  ON 57
ci_0059                -3.395815e-03 3 1  ON 58
ci_0060                -3.375888e-03 3 1  ON 59
ci_0061                -3.976504e-03 3 1  ON 60
ci_0062                -3.922365e-03 3 1  ON 61
ci_0063                -9.802580e-03 3 1  ON 62
ci_0064                -9.372600e-03 3 1  ON 63
ci_0065                -6.435479e-03 3 1  ON 64
ci_0066                -6.132151e-03 3 1  ON 65
ci_0067                -3.747986e-03 3 1  ON 66
ci_0068                -3.479531e-03 3 1  ON 67
ci_0069                 3.569219e-03 3 1  ON 68
ci_0070                 3.348549e-03 3 1  ON 69
ci_0071                 3.005272e-03 3 1  ON 70
ci_0072                 3.481734e-03 3 1  ON 71
ci_0073                 3.552587e-03 3 1  ON 72
ci_0074                 3.528871e-03 3 1  ON 73
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 80
    time step          = 0.05
    reference energy   = -16.967
    reference variance = 0.248985
====================================================
  Execution time = 1.4017e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s080
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6899e+01
  VMC Evar = 2.9563e-01
  Total weights = 1.9514e+06
  Execution time = 1.8722e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.284613330913
                                         uncertainty =       0.003158707236

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.284613330913
                                         uncertainty =       0.003158707236

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000377222752
  error estimate for blocks of size 2^( 2) =       0.000393886219
  error estimate for blocks of size 2^( 3) =       0.000410857896
  error estimate for blocks of size 2^( 4) =       0.000425840767
  error estimate for blocks of size 2^( 5) =       0.000437170573
  error estimate for blocks of size 2^( 6) =       0.000443835790
  error estimate for blocks of size 2^( 7) =       0.000446964560

      target function =      -0.919531149052
              le_mean =     -16.898659258408
             les_mean =     285.860318590891
             stat err =       0.000438452922
             autocorr =       1.350983917873
   target nu stat err =       0.000438452922
   target dn stat err =       0.004517537178
      target stat err =       0.007044175697
              std dev =       0.533473532438
             le_variance =       0.284594009812

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.284613330903
                                         uncertainty =       0.003158707226

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.284613330903
                                         uncertainty =       0.003158707226

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000377222752
  error estimate for blocks of size 2^( 2) =       0.000393886219
  error estimate for blocks of size 2^( 3) =       0.000410857896
  error estimate for blocks of size 2^( 4) =       0.000425840767
  error estimate for blocks of size 2^( 5) =       0.000437170573
  error estimate for blocks of size 2^( 6) =       0.000443835790
  error estimate for blocks of size 2^( 7) =       0.000446964560

      target function =      -0.919531149124
              le_mean =     -16.898659258408
             les_mean =     285.860318590847
             stat err =       0.000438452922
             autocorr =       1.350983917851
   target nu stat err =       0.000438452922
   target dn stat err =       0.004517537164
      target stat err =       0.007044175676
              std dev =       0.533473532429
             le_variance =       0.284594009802

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.284613330908
                                         uncertainty =       0.003158707231

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.284613330908
                                         uncertainty =       0.003158707231

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000377222752
  error estimate for blocks of size 2^( 2) =       0.000393886219
  error estimate for blocks of size 2^( 3) =       0.000410857896
  error estimate for blocks of size 2^( 4) =       0.000425840767
  error estimate for blocks of size 2^( 5) =       0.000437170573
  error estimate for blocks of size 2^( 6) =       0.000443835790
  error estimate for blocks of size 2^( 7) =       0.000446964560

      target function =      -0.919531149088
              le_mean =     -16.898659258408
             les_mean =     285.860318590869
             stat err =       0.000438452922
             autocorr =       1.350983917857
   target nu stat err =       0.000438452922
   target dn stat err =       0.004517537171
      target stat err =       0.007044175687
              std dev =       0.533473532433
             le_variance =       0.284594009807

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.284613330912
                                         uncertainty =       0.003158707235

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.284613330912
                                         uncertainty =       0.003158707235

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000377222752
  error estimate for blocks of size 2^( 2) =       0.000393886219
  error estimate for blocks of size 2^( 3) =       0.000410857896
  error estimate for blocks of size 2^( 4) =       0.000425840767
  error estimate for blocks of size 2^( 5) =       0.000437170573
  error estimate for blocks of size 2^( 6) =       0.000443835790
  error estimate for blocks of size 2^( 7) =       0.000446964560

      target function =      -0.919531149056
              le_mean =     -16.898659258408
             les_mean =     285.860318590888
             stat err =       0.000438452922
             autocorr =       1.350983917864
   target nu stat err =       0.000438452922
   target dn stat err =       0.004517537177
      target stat err =       0.007044175696
              std dev =       0.533473532437
             le_variance =       0.284594009811


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.919531149052        initial
     3.3881e+06     3.3881e+07             1.0021e-10        -0.919531149124  <--
     1.3553e+07     1.3553e+08             2.5052e-11        -0.919531149088
     5.4210e+07     5.4210e+08             6.2632e-12        -0.919531149056

*****************************************************************************
Applying the update for shift_i =   3.3881e+06     and shift_s =   3.3881e+07
*****************************************************************************

  Execution time = 2.3459e+01
  </log>
  <optVariables href="H2O.s080.opt.xml">
ci_0001                 7.086064e-01 3 1  ON 0
ci_0002                 6.927483e-01 3 1  ON 1
ci_0003                -3.099699e-02 3 1  ON 2
ci_0004                -3.009162e-02 3 1  ON 3
ci_0005                -3.060382e-02 3 1  ON 4
ci_0006                -3.069586e-02 3 1  ON 5
ci_0007                -1.338102e-02 3 1  ON 6
ci_0008                -1.335093e-02 3 1  ON 7
ci_0009                -1.869650e-02 3 1  ON 8
ci_0010                -1.813030e-02 3 1  ON 9
ci_0011                -1.474501e-02 3 1  ON 10
ci_0012                -1.451134e-02 3 1  ON 11
ci_0013                 1.529423e-02 3 1  ON 12
ci_0014                 1.480516e-02 3 1  ON 13
ci_0015                 1.574766e-02 3 1  ON 14
ci_0016                 1.538632e-02 3 1  ON 15
ci_0017                 1.336745e-02 3 1  ON 16
ci_0018                 1.303906e-02 3 1  ON 17
ci_0019                 1.308950e-02 3 1  ON 18
ci_0020                 1.266839e-02 3 1  ON 19
ci_0021                 6.752770e-03 3 1  ON 20
ci_0022                 7.460538e-03 3 1  ON 21
ci_0023                -1.180403e-02 3 1  ON 22
ci_0024                -1.147023e-02 3 1  ON 23
ci_0025                -2.029570e-03 3 1  ON 24
ci_0026                -2.390747e-03 3 1  ON 25
ci_0027                -1.213155e-02 3 1  ON 26
ci_0028                -1.154912e-02 3 1  ON 27
ci_0029                -1.065832e-02 3 1  ON 28
ci_0030                -1.058734e-02 3 1  ON 29
ci_0031                 1.340907e-02 3 1  ON 30
ci_0032                 1.211459e-02 3 1  ON 31
ci_0033                 7.848177e-03 3 1  ON 32
ci_0034                 8.489627e-03 3 1  ON 33
ci_0035                 4.859421e-03 3 1  ON 34
ci_0036                 4.933671e-03 3 1  ON 35
ci_0037                -1.133359e-02 3 1  ON 36
ci_0038                -1.131343e-02 3 1  ON 37
ci_0039                -4.014992e-03 3 1  ON 38
ci_0040                -3.886155e-03 3 1  ON 39
ci_0041                 9.104242e-03 3 1  ON 40
ci_0042                 8.780957e-03 3 1  ON 41
ci_0043                -1.307372e-02 3 1  ON 42
ci_0044                -1.384583e-02 3 1  ON 43
ci_0045                 1.059118e-02 3 1  ON 44
ci_0046                 1.007868e-02 3 1  ON 45
ci_0047                -3.585075e-03 3 1  ON 46
ci_0048                -3.481623e-03 3 1  ON 47
ci_0049                -2.594629e-03 3 1  ON 48
ci_0050                -2.695910e-03 3 1  ON 49
ci_0051                -1.797585e-03 3 1  ON 50
ci_0052                -2.016123e-03 3 1  ON 51
ci_0053                -3.931436e-03 3 1  ON 52
ci_0054                -3.323922e-03 3 1  ON 53
ci_0055                 2.398828e-03 3 1  ON 54
ci_0056                 2.269778e-03 3 1  ON 55
ci_0057                 2.453986e-03 3 1  ON 56
ci_0058                 2.857281e-03 3 1  ON 57
ci_0059                -3.395815e-03 3 1  ON 58
ci_0060                -3.375888e-03 3 1  ON 59
ci_0061                -3.976504e-03 3 1  ON 60
ci_0062                -3.922365e-03 3 1  ON 61
ci_0063                -9.802580e-03 3 1  ON 62
ci_0064                -9.372600e-03 3 1  ON 63
ci_0065                -6.435479e-03 3 1  ON 64
ci_0066                -6.132151e-03 3 1  ON 65
ci_0067                -3.747986e-03 3 1  ON 66
ci_0068                -3.479531e-03 3 1  ON 67
ci_0069                 3.569219e-03 3 1  ON 68
ci_0070                 3.348549e-03 3 1  ON 69
ci_0071                 3.005272e-03 3 1  ON 70
ci_0072                 3.481734e-03 3 1  ON 71
ci_0073                 3.552587e-03 3 1  ON 72
ci_0074                 3.528871e-03 3 1  ON 73
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 4.0091e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s081 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s081 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=81  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6902e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 81
    time step          = 0.05
    reference energy   = -16.8385
    reference variance = 0.722213
====================================================
  Execution time = 1.4039e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s081
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5239e+04
  VMC Eavg = -1.6899e+01
  VMC Evar = 2.9361e-01
  Total weights = 1.950903755e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 2.5625e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.282255710338
                                         uncertainty =       0.001424721089

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.282255710338
                                         uncertainty =       0.001424721089

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000375644059
  error estimate for blocks of size 2^( 2) =       0.000392478357
  error estimate for blocks of size 2^( 3) =       0.000409289559
  error estimate for blocks of size 2^( 4) =       0.000423934077
  error estimate for blocks of size 2^( 5) =       0.000434690087
  error estimate for blocks of size 2^( 6) =       0.000441890111
  error estimate for blocks of size 2^( 7) =       0.000447203984

      target function =      -0.922717103324
              le_mean =     -16.898689680327
             les_mean =     285.859319602910
             stat err =       0.000436929565
             autocorr =       1.352912829876
   target nu stat err =       0.000436929565
   target dn stat err =       0.002876988878
      target stat err =       0.004552802767
              std dev =       0.531240922784
             le_variance =       0.282216918041


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.689868968033e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 74
Check correct_vf_var_size: 225, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 8.4703e+05, overlap shift 8.4703e+06 and omega -1.7444e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.922738114809       residual = 5.44e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.922738114839       residual = 7.46e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.922738114847       residual = 1.94e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.922738114850       residual = 1.26e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.922738114894       residual = 1.06e-04           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.922738114825       residual = 7.94e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.922738113937       residual = 4.83e-05           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.922738115916       residual = 5.03e-05           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.922738115717       residual = 4.70e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.922738116018       residual = 1.99e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.922738116841       residual = 8.68e-06           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.922738113121       residual = 1.98e-06           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.922738115853       residual = 8.99e-07           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.922738115316       residual = 2.02e-07           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.922738115365       residual = 6.41e-08           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.922738117418       residual = 1.42e-08           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.922738114134       residual = 3.59e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         16 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 8.4703e+05 is 5.371240e-10

solving harmonic davidson linear method for identity shift 3.3881e+06, overlap shift 3.3881e+07 and omega -1.7444e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.922738114809       residual = 5.44e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.922738114817       residual = 7.46e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.922738114819       residual = 1.94e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.922738114820       residual = 1.26e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.922738114784       residual = 1.06e-04           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.922738114549       residual = 7.94e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.922738116721       residual = 4.83e-05           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.922738106228       residual = 5.03e-05           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.922738113611       residual = 4.70e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.922738121127       residual = 1.99e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.922738114322       residual = 8.68e-06           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.922738109691       residual = 1.98e-06           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.922738104868       residual = 8.99e-07           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.922738110441       residual = 2.02e-07           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.922738110281       residual = 6.41e-08           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.922738119403       residual = 1.42e-08           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.922738108376       residual = 3.59e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         16 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 3.3881e+06 is 1.342810e-10

solving harmonic davidson linear method for identity shift 1.3553e+07, overlap shift 1.3553e+08 and omega -1.7444e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.922738114809       residual = 5.44e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.922738114811       residual = 7.46e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.922738114812       residual = 1.94e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.922738114812       residual = 1.26e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.922738114812       residual = 1.06e-04           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.922738098901       residual = 7.94e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.922738088857       residual = 4.83e-05           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.922738113209       residual = 5.03e-05           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.922738113632       residual = 4.70e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.922738131399       residual = 1.99e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.922738081639       residual = 8.68e-06           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.922738163091       residual = 1.98e-06           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.922738117372       residual = 8.99e-07           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.922738118021       residual = 2.02e-07           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.922738121115       residual = 6.41e-08           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.922738112255       residual = 1.42e-08           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.922738086503       residual = 3.59e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         16 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 1.3553e+07 is 3.357032e-11

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.935034 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 75 and numParams is: 74

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.6616e+01
  </log>
  <optVariables href="H2O.s081.opt.xml">
ci_0001                 7.086064e-01 3 1  ON 0
ci_0002                 6.927483e-01 3 1  ON 1
ci_0003                -3.099699e-02 3 1  ON 2
ci_0004                -3.009162e-02 3 1  ON 3
ci_0005                -3.060382e-02 3 1  ON 4
ci_0006                -3.069586e-02 3 1  ON 5
ci_0007                -1.338102e-02 3 1  ON 6
ci_0008                -1.335093e-02 3 1  ON 7
ci_0009                -1.869650e-02 3 1  ON 8
ci_0010                -1.813030e-02 3 1  ON 9
ci_0011                -1.474501e-02 3 1  ON 10
ci_0012                -1.451134e-02 3 1  ON 11
ci_0013                 1.529423e-02 3 1  ON 12
ci_0014                 1.480516e-02 3 1  ON 13
ci_0015                 1.574766e-02 3 1  ON 14
ci_0016                 1.538632e-02 3 1  ON 15
ci_0017                 1.336745e-02 3 1  ON 16
ci_0018                 1.303906e-02 3 1  ON 17
ci_0019                 1.308950e-02 3 1  ON 18
ci_0020                 1.266839e-02 3 1  ON 19
ci_0021                 6.752770e-03 3 1  ON 20
ci_0022                 7.460538e-03 3 1  ON 21
ci_0023                -1.180403e-02 3 1  ON 22
ci_0024                -1.147023e-02 3 1  ON 23
ci_0025                -2.029570e-03 3 1  ON 24
ci_0026                -2.390747e-03 3 1  ON 25
ci_0027                -1.213155e-02 3 1  ON 26
ci_0028                -1.154912e-02 3 1  ON 27
ci_0029                -1.065832e-02 3 1  ON 28
ci_0030                -1.058734e-02 3 1  ON 29
ci_0031                 1.340907e-02 3 1  ON 30
ci_0032                 1.211459e-02 3 1  ON 31
ci_0033                 7.848177e-03 3 1  ON 32
ci_0034                 8.489627e-03 3 1  ON 33
ci_0035                 4.859421e-03 3 1  ON 34
ci_0036                 4.933671e-03 3 1  ON 35
ci_0037                -1.133359e-02 3 1  ON 36
ci_0038                -1.131343e-02 3 1  ON 37
ci_0039                -4.014992e-03 3 1  ON 38
ci_0040                -3.886155e-03 3 1  ON 39
ci_0041                 9.104242e-03 3 1  ON 40
ci_0042                 8.780957e-03 3 1  ON 41
ci_0043                -1.307372e-02 3 1  ON 42
ci_0044                -1.384583e-02 3 1  ON 43
ci_0045                 1.059118e-02 3 1  ON 44
ci_0046                 1.007868e-02 3 1  ON 45
ci_0047                -3.585075e-03 3 1  ON 46
ci_0048                -3.481623e-03 3 1  ON 47
ci_0049                -2.594629e-03 3 1  ON 48
ci_0050                -2.695910e-03 3 1  ON 49
ci_0051                -1.797585e-03 3 1  ON 50
ci_0052                -2.016123e-03 3 1  ON 51
ci_0053                -3.931436e-03 3 1  ON 52
ci_0054                -3.323922e-03 3 1  ON 53
ci_0055                 2.398828e-03 3 1  ON 54
ci_0056                 2.269778e-03 3 1  ON 55
ci_0057                 2.453986e-03 3 1  ON 56
ci_0058                 2.857281e-03 3 1  ON 57
ci_0059                -3.395815e-03 3 1  ON 58
ci_0060                -3.375888e-03 3 1  ON 59
ci_0061                -3.976504e-03 3 1  ON 60
ci_0062                -3.922365e-03 3 1  ON 61
ci_0063                -9.802580e-03 3 1  ON 62
ci_0064                -9.372600e-03 3 1  ON 63
ci_0065                -6.435479e-03 3 1  ON 64
ci_0066                -6.132151e-03 3 1  ON 65
ci_0067                -3.747986e-03 3 1  ON 66
ci_0068                -3.479531e-03 3 1  ON 67
ci_0069                 3.569219e-03 3 1  ON 68
ci_0070                 3.348549e-03 3 1  ON 69
ci_0071                 3.005272e-03 3 1  ON 70
ci_0072                 3.481734e-03 3 1  ON 71
ci_0073                 3.552587e-03 3 1  ON 72
ci_0074                 3.528871e-03 3 1  ON 73
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 81
    time step          = 0.05
    reference energy   = -16.8403
    reference variance = 0.264299
====================================================
  Execution time = 1.3920e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s081
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6898e+01
  VMC Evar = 2.8883e-01
  Total weights = 1.9511e+06
  Execution time = 2.0117e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.280632742601
                                         uncertainty =       0.001620628119

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.280632742601
                                         uncertainty =       0.001620628119

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000374589060
  error estimate for blocks of size 2^( 2) =       0.000391297505
  error estimate for blocks of size 2^( 3) =       0.000408994299
  error estimate for blocks of size 2^( 4) =       0.000423838646
  error estimate for blocks of size 2^( 5) =       0.000435142350
  error estimate for blocks of size 2^( 6) =       0.000443416159
  error estimate for blocks of size 2^( 7) =       0.000448158915

      target function =      -0.930234524679
              le_mean =     -16.898403918934
             les_mean =     285.844886786573
             stat err =       0.000437639017
             autocorr =       1.364966177346
   target nu stat err =       0.000437639017
   target dn stat err =       0.002276539705
      target stat err =       0.003687306596
              std dev =       0.529748928535
             le_variance =       0.280633927284

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.280632742631
                                         uncertainty =       0.001620628124

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.280632742631
                                         uncertainty =       0.001620628124

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000374589060
  error estimate for blocks of size 2^( 2) =       0.000391297505
  error estimate for blocks of size 2^( 3) =       0.000408994299
  error estimate for blocks of size 2^( 4) =       0.000423838646
  error estimate for blocks of size 2^( 5) =       0.000435142350
  error estimate for blocks of size 2^( 6) =       0.000443416159
  error estimate for blocks of size 2^( 7) =       0.000448158915

      target function =      -0.930234524627
              le_mean =     -16.898403918937
             les_mean =     285.844886786713
             stat err =       0.000437639017
             autocorr =       1.364966177257
   target nu stat err =       0.000437639017
   target dn stat err =       0.002276539710
      target stat err =       0.003687306604
              std dev =       0.529748928563
             le_variance =       0.280633927313

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.280632742616
                                         uncertainty =       0.001620628122

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.280632742616
                                         uncertainty =       0.001620628122

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000374589060
  error estimate for blocks of size 2^( 2) =       0.000391297505
  error estimate for blocks of size 2^( 3) =       0.000408994299
  error estimate for blocks of size 2^( 4) =       0.000423838646
  error estimate for blocks of size 2^( 5) =       0.000435142350
  error estimate for blocks of size 2^( 6) =       0.000443416159
  error estimate for blocks of size 2^( 7) =       0.000448158915

      target function =      -0.930234524653
              le_mean =     -16.898403918935
             les_mean =     285.844886786643
             stat err =       0.000437639017
             autocorr =       1.364966177300
   target nu stat err =       0.000437639017
   target dn stat err =       0.002276539707
      target stat err =       0.003687306600
              std dev =       0.529748928549
             le_variance =       0.280633927299

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.280632742603
                                         uncertainty =       0.001620628120

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.280632742603
                                         uncertainty =       0.001620628120

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000374589060
  error estimate for blocks of size 2^( 2) =       0.000391297505
  error estimate for blocks of size 2^( 3) =       0.000408994299
  error estimate for blocks of size 2^( 4) =       0.000423838646
  error estimate for blocks of size 2^( 5) =       0.000435142350
  error estimate for blocks of size 2^( 6) =       0.000443416159
  error estimate for blocks of size 2^( 7) =       0.000448158915

      target function =      -0.930234524676
              le_mean =     -16.898403918934
             les_mean =     285.844886786582
             stat err =       0.000437639017
             autocorr =       1.364966177350
   target nu stat err =       0.000437639017
   target dn stat err =       0.002276539705
      target stat err =       0.003687306597
              std dev =       0.529748928536
             le_variance =       0.280633927285


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.930234524679        initial  <--
     8.4703e+05     8.4703e+06             5.3712e-10        -0.930234524627
     3.3881e+06     3.3881e+07             1.3428e-10        -0.930234524653
     1.3553e+07     1.3553e+08             3.3570e-11        -0.930234524676

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 23.5083
  </log>
  <optVariables href="H2O.s081.opt.xml">
ci_0001                 7.086064e-01 3 1  ON 0
ci_0002                 6.927483e-01 3 1  ON 1
ci_0003                -3.099699e-02 3 1  ON 2
ci_0004                -3.009162e-02 3 1  ON 3
ci_0005                -3.060382e-02 3 1  ON 4
ci_0006                -3.069586e-02 3 1  ON 5
ci_0007                -1.338102e-02 3 1  ON 6
ci_0008                -1.335093e-02 3 1  ON 7
ci_0009                -1.869650e-02 3 1  ON 8
ci_0010                -1.813030e-02 3 1  ON 9
ci_0011                -1.474501e-02 3 1  ON 10
ci_0012                -1.451134e-02 3 1  ON 11
ci_0013                 1.529423e-02 3 1  ON 12
ci_0014                 1.480516e-02 3 1  ON 13
ci_0015                 1.574766e-02 3 1  ON 14
ci_0016                 1.538632e-02 3 1  ON 15
ci_0017                 1.336745e-02 3 1  ON 16
ci_0018                 1.303906e-02 3 1  ON 17
ci_0019                 1.308950e-02 3 1  ON 18
ci_0020                 1.266839e-02 3 1  ON 19
ci_0021                 6.752770e-03 3 1  ON 20
ci_0022                 7.460538e-03 3 1  ON 21
ci_0023                -1.180403e-02 3 1  ON 22
ci_0024                -1.147023e-02 3 1  ON 23
ci_0025                -2.029570e-03 3 1  ON 24
ci_0026                -2.390747e-03 3 1  ON 25
ci_0027                -1.213155e-02 3 1  ON 26
ci_0028                -1.154912e-02 3 1  ON 27
ci_0029                -1.065832e-02 3 1  ON 28
ci_0030                -1.058734e-02 3 1  ON 29
ci_0031                 1.340907e-02 3 1  ON 30
ci_0032                 1.211459e-02 3 1  ON 31
ci_0033                 7.848177e-03 3 1  ON 32
ci_0034                 8.489627e-03 3 1  ON 33
ci_0035                 4.859421e-03 3 1  ON 34
ci_0036                 4.933671e-03 3 1  ON 35
ci_0037                -1.133359e-02 3 1  ON 36
ci_0038                -1.131343e-02 3 1  ON 37
ci_0039                -4.014992e-03 3 1  ON 38
ci_0040                -3.886155e-03 3 1  ON 39
ci_0041                 9.104242e-03 3 1  ON 40
ci_0042                 8.780957e-03 3 1  ON 41
ci_0043                -1.307372e-02 3 1  ON 42
ci_0044                -1.384583e-02 3 1  ON 43
ci_0045                 1.059118e-02 3 1  ON 44
ci_0046                 1.007868e-02 3 1  ON 45
ci_0047                -3.585075e-03 3 1  ON 46
ci_0048                -3.481623e-03 3 1  ON 47
ci_0049                -2.594629e-03 3 1  ON 48
ci_0050                -2.695910e-03 3 1  ON 49
ci_0051                -1.797585e-03 3 1  ON 50
ci_0052                -2.016123e-03 3 1  ON 51
ci_0053                -3.931436e-03 3 1  ON 52
ci_0054                -3.323922e-03 3 1  ON 53
ci_0055                 2.398828e-03 3 1  ON 54
ci_0056                 2.269778e-03 3 1  ON 55
ci_0057                 2.453986e-03 3 1  ON 56
ci_0058                 2.857281e-03 3 1  ON 57
ci_0059                -3.395815e-03 3 1  ON 58
ci_0060                -3.375888e-03 3 1  ON 59
ci_0061                -3.976504e-03 3 1  ON 60
ci_0062                -3.922365e-03 3 1  ON 61
ci_0063                -9.802580e-03 3 1  ON 62
ci_0064                -9.372600e-03 3 1  ON 63
ci_0065                -6.435479e-03 3 1  ON 64
ci_0066                -6.132151e-03 3 1  ON 65
ci_0067                -3.747986e-03 3 1  ON 66
ci_0068                -3.479531e-03 3 1  ON 67
ci_0069                 3.569219e-03 3 1  ON 68
ci_0070                 3.348549e-03 3 1  ON 69
ci_0071                 3.005272e-03 3 1  ON 70
ci_0072                 3.481734e-03 3 1  ON 71
ci_0073                 3.552587e-03 3 1  ON 72
ci_0074                 3.528871e-03 3 1  ON 73
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 4.0130e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s082 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s082 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=82  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6901e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 82
    time step          = 0.05
    reference energy   = -16.9477
    reference variance = 0.344134
====================================================
  Execution time = 1.4076e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s082
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5272e+04
  VMC Eavg = -1.6898e+01
  VMC Evar = 2.8781e-01
  Total weights = 1.951368113e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 2.5455e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.278739144676
                                         uncertainty =       0.001356272160

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.278739144676
                                         uncertainty =       0.001356272160

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000373354874
  error estimate for blocks of size 2^( 2) =       0.000390256942
  error estimate for blocks of size 2^( 3) =       0.000408041645
  error estimate for blocks of size 2^( 4) =       0.000423874064
  error estimate for blocks of size 2^( 5) =       0.000436070336
  error estimate for blocks of size 2^( 6) =       0.000445150901
  error estimate for blocks of size 2^( 7) =       0.000448165658

      target function =      -0.931859336887
              le_mean =     -16.898230194373
             les_mean =     285.837993205925
             stat err =       0.000438315240
             autocorr =       1.378254731112
   target nu stat err =       0.000438315240
   target dn stat err =       0.001777776592
      target stat err =       0.002926157180
              std dev =       0.528003525791
             le_variance =       0.278787723248


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.689823019437e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 74
Check correct_vf_var_size: 225, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 8.4703e+06, overlap shift 8.4703e+07 and omega -1.7444e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.931867120953       residual = 3.57e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.931867120955       residual = 6.43e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.931867120956       residual = 1.99e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.931867121080       residual = 8.08e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.931867120782       residual = 2.68e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.931867111595       residual = 1.95e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.931867120251       residual = 9.52e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.931867110731       residual = 5.58e-06           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.931867122530       residual = 6.33e-06           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.931867120333       residual = 4.54e-06           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.931867112196       residual = 3.76e-06           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.931867110797       residual = 9.31e-07           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.931867110219       residual = 3.05e-07           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.931867124546       residual = 1.45e-07           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.931867095993       residual = 5.62e-08           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.931867113455       residual = 2.08e-08           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.931867111683       residual = 3.51e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         16 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 8.4703e+06 is 1.972954e-11

solving harmonic davidson linear method for identity shift 3.3881e+07, overlap shift 3.3881e+08 and omega -1.7444e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.931867120953       residual = 3.57e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.931867120954       residual = 6.43e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.931867120954       residual = 1.99e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.931867117166       residual = 8.08e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.931867119249       residual = 2.68e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.931867137453       residual = 1.95e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.931867120954       residual = 9.52e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.931867102967       residual = 5.58e-06           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.931867275177       residual = 6.33e-06           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.931867144246       residual = 4.54e-06           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.931867233193       residual = 3.76e-06           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.931867034540       residual = 9.31e-07           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.931867060864       residual = 3.05e-07           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.931867096275       residual = 1.45e-07           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.931867107571       residual = 5.62e-08           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.931867070120       residual = 2.08e-08           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.931867133813       residual = 3.52e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         16 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 3.3881e+07 is 4.932578e-12

solving harmonic davidson linear method for identity shift 1.3553e+08, overlap shift 1.3553e+09 and omega -1.7444e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.931867120953       residual = 3.57e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.931867120953       residual = 6.43e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.931867120953       residual = 1.99e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.931867120953       residual = 8.08e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.931867120953       residual = 2.68e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.931867120953       residual = 1.95e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.931867120953       residual = 9.53e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.931866779229       residual = 5.59e-06           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.931866915484       residual = 6.33e-06           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.931866799240       residual = 4.54e-06           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.931867215880       residual = 3.76e-06           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.931867369102       residual = 9.30e-07           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.931867199630       residual = 3.05e-07           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.931867101105       residual = 1.45e-07           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.931867556087       residual = 5.58e-08           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.931867118276       residual = 2.07e-08           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.931866919442       residual = 3.49e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         16 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 1.3553e+08 is 1.233006e-12

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.943929 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 75 and numParams is: 74

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.6636e+01
  </log>
  <optVariables href="H2O.s082.opt.xml">
ci_0001                 7.086064e-01 3 1  ON 0
ci_0002                 6.927483e-01 3 1  ON 1
ci_0003                -3.099699e-02 3 1  ON 2
ci_0004                -3.009162e-02 3 1  ON 3
ci_0005                -3.060382e-02 3 1  ON 4
ci_0006                -3.069586e-02 3 1  ON 5
ci_0007                -1.338102e-02 3 1  ON 6
ci_0008                -1.335093e-02 3 1  ON 7
ci_0009                -1.869650e-02 3 1  ON 8
ci_0010                -1.813030e-02 3 1  ON 9
ci_0011                -1.474501e-02 3 1  ON 10
ci_0012                -1.451134e-02 3 1  ON 11
ci_0013                 1.529423e-02 3 1  ON 12
ci_0014                 1.480516e-02 3 1  ON 13
ci_0015                 1.574766e-02 3 1  ON 14
ci_0016                 1.538632e-02 3 1  ON 15
ci_0017                 1.336745e-02 3 1  ON 16
ci_0018                 1.303906e-02 3 1  ON 17
ci_0019                 1.308950e-02 3 1  ON 18
ci_0020                 1.266839e-02 3 1  ON 19
ci_0021                 6.752770e-03 3 1  ON 20
ci_0022                 7.460538e-03 3 1  ON 21
ci_0023                -1.180403e-02 3 1  ON 22
ci_0024                -1.147023e-02 3 1  ON 23
ci_0025                -2.029570e-03 3 1  ON 24
ci_0026                -2.390747e-03 3 1  ON 25
ci_0027                -1.213155e-02 3 1  ON 26
ci_0028                -1.154912e-02 3 1  ON 27
ci_0029                -1.065832e-02 3 1  ON 28
ci_0030                -1.058734e-02 3 1  ON 29
ci_0031                 1.340907e-02 3 1  ON 30
ci_0032                 1.211459e-02 3 1  ON 31
ci_0033                 7.848177e-03 3 1  ON 32
ci_0034                 8.489627e-03 3 1  ON 33
ci_0035                 4.859421e-03 3 1  ON 34
ci_0036                 4.933671e-03 3 1  ON 35
ci_0037                -1.133359e-02 3 1  ON 36
ci_0038                -1.131343e-02 3 1  ON 37
ci_0039                -4.014992e-03 3 1  ON 38
ci_0040                -3.886155e-03 3 1  ON 39
ci_0041                 9.104242e-03 3 1  ON 40
ci_0042                 8.780957e-03 3 1  ON 41
ci_0043                -1.307372e-02 3 1  ON 42
ci_0044                -1.384583e-02 3 1  ON 43
ci_0045                 1.059118e-02 3 1  ON 44
ci_0046                 1.007868e-02 3 1  ON 45
ci_0047                -3.585075e-03 3 1  ON 46
ci_0048                -3.481623e-03 3 1  ON 47
ci_0049                -2.594629e-03 3 1  ON 48
ci_0050                -2.695910e-03 3 1  ON 49
ci_0051                -1.797585e-03 3 1  ON 50
ci_0052                -2.016123e-03 3 1  ON 51
ci_0053                -3.931436e-03 3 1  ON 52
ci_0054                -3.323922e-03 3 1  ON 53
ci_0055                 2.398828e-03 3 1  ON 54
ci_0056                 2.269778e-03 3 1  ON 55
ci_0057                 2.453986e-03 3 1  ON 56
ci_0058                 2.857281e-03 3 1  ON 57
ci_0059                -3.395815e-03 3 1  ON 58
ci_0060                -3.375888e-03 3 1  ON 59
ci_0061                -3.976504e-03 3 1  ON 60
ci_0062                -3.922365e-03 3 1  ON 61
ci_0063                -9.802580e-03 3 1  ON 62
ci_0064                -9.372600e-03 3 1  ON 63
ci_0065                -6.435479e-03 3 1  ON 64
ci_0066                -6.132151e-03 3 1  ON 65
ci_0067                -3.747986e-03 3 1  ON 66
ci_0068                -3.479531e-03 3 1  ON 67
ci_0069                 3.569219e-03 3 1  ON 68
ci_0070                 3.348549e-03 3 1  ON 69
ci_0071                 3.005272e-03 3 1  ON 70
ci_0072                 3.481734e-03 3 1  ON 71
ci_0073                 3.552587e-03 3 1  ON 72
ci_0074                 3.528871e-03 3 1  ON 73
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 82
    time step          = 0.05
    reference energy   = -16.9584
    reference variance = 0.17142
====================================================
  Execution time = 1.3831e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s082
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6899e+01
  VMC Evar = 2.9237e-01
  Total weights = 1.9511e+06
  Execution time = 1.8720e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.283495467418
                                         uncertainty =       0.001947119997

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.283495467418
                                         uncertainty =       0.001947119997

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000376466642
  error estimate for blocks of size 2^( 2) =       0.000393626138
  error estimate for blocks of size 2^( 3) =       0.000411180598
  error estimate for blocks of size 2^( 4) =       0.000426254535
  error estimate for blocks of size 2^( 5) =       0.000437760577
  error estimate for blocks of size 2^( 6) =       0.000444556332
  error estimate for blocks of size 2^( 7) =       0.000449725999

      target function =      -0.924665419479
              le_mean =     -16.898915057182
             les_mean =     285.865699067466
             stat err =       0.000439574361
             autocorr =       1.363363633636
   target nu stat err =       0.000439574361
   target dn stat err =       0.002235653640
      target stat err =       0.003585514639
              std dev =       0.532404231169
             le_variance =       0.283454265366

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.283495467420
                                         uncertainty =       0.001947119997

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.283495467420
                                         uncertainty =       0.001947119997

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000376466642
  error estimate for blocks of size 2^( 2) =       0.000393626138
  error estimate for blocks of size 2^( 3) =       0.000411180598
  error estimate for blocks of size 2^( 4) =       0.000426254535
  error estimate for blocks of size 2^( 5) =       0.000437760577
  error estimate for blocks of size 2^( 6) =       0.000444556332
  error estimate for blocks of size 2^( 7) =       0.000449725999

      target function =      -0.924665419485
              le_mean =     -16.898915057182
             les_mean =     285.865699067466
             stat err =       0.000439574361
             autocorr =       1.363363633631
   target nu stat err =       0.000439574361
   target dn stat err =       0.002235653641
      target stat err =       0.003585514640
              std dev =       0.532404231171
             le_variance =       0.283454265368

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.283495467419
                                         uncertainty =       0.001947119997

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.283495467419
                                         uncertainty =       0.001947119997

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000376466642
  error estimate for blocks of size 2^( 2) =       0.000393626138
  error estimate for blocks of size 2^( 3) =       0.000411180598
  error estimate for blocks of size 2^( 4) =       0.000426254535
  error estimate for blocks of size 2^( 5) =       0.000437760577
  error estimate for blocks of size 2^( 6) =       0.000444556332
  error estimate for blocks of size 2^( 7) =       0.000449725999

      target function =      -0.924665419482
              le_mean =     -16.898915057182
             les_mean =     285.865699067466
             stat err =       0.000439574361
             autocorr =       1.363363633631
   target nu stat err =       0.000439574361
   target dn stat err =       0.002235653640
      target stat err =       0.003585514639
              std dev =       0.532404231170
             le_variance =       0.283454265367

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.283495467418
                                         uncertainty =       0.001947119997

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.283495467418
                                         uncertainty =       0.001947119997

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000376466642
  error estimate for blocks of size 2^( 2) =       0.000393626138
  error estimate for blocks of size 2^( 3) =       0.000411180598
  error estimate for blocks of size 2^( 4) =       0.000426254535
  error estimate for blocks of size 2^( 5) =       0.000437760577
  error estimate for blocks of size 2^( 6) =       0.000444556332
  error estimate for blocks of size 2^( 7) =       0.000449725999

      target function =      -0.924665419479
              le_mean =     -16.898915057182
             les_mean =     285.865699067466
             stat err =       0.000439574361
             autocorr =       1.363363633629
   target nu stat err =       0.000439574361
   target dn stat err =       0.002235653640
      target stat err =       0.003585514639
              std dev =       0.532404231169
             le_variance =       0.283454265367


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.924665419479        initial
     8.4703e+06     8.4703e+07             1.9730e-11        -0.924665419485  <--
     3.3881e+07     3.3881e+08             4.9326e-12        -0.924665419482
     1.3553e+08     1.3553e+09             1.2330e-12        -0.924665419479

*****************************************************************************
Applying the update for shift_i =   8.4703e+06     and shift_s =   8.4703e+07
*****************************************************************************

  Execution time = 2.3287e+01
  </log>
  <optVariables href="H2O.s082.opt.xml">
ci_0001                 7.086064e-01 3 1  ON 0
ci_0002                 6.927483e-01 3 1  ON 1
ci_0003                -3.099699e-02 3 1  ON 2
ci_0004                -3.009162e-02 3 1  ON 3
ci_0005                -3.060382e-02 3 1  ON 4
ci_0006                -3.069586e-02 3 1  ON 5
ci_0007                -1.338102e-02 3 1  ON 6
ci_0008                -1.335093e-02 3 1  ON 7
ci_0009                -1.869650e-02 3 1  ON 8
ci_0010                -1.813030e-02 3 1  ON 9
ci_0011                -1.474501e-02 3 1  ON 10
ci_0012                -1.451134e-02 3 1  ON 11
ci_0013                 1.529423e-02 3 1  ON 12
ci_0014                 1.480516e-02 3 1  ON 13
ci_0015                 1.574766e-02 3 1  ON 14
ci_0016                 1.538632e-02 3 1  ON 15
ci_0017                 1.336745e-02 3 1  ON 16
ci_0018                 1.303906e-02 3 1  ON 17
ci_0019                 1.308950e-02 3 1  ON 18
ci_0020                 1.266839e-02 3 1  ON 19
ci_0021                 6.752770e-03 3 1  ON 20
ci_0022                 7.460538e-03 3 1  ON 21
ci_0023                -1.180403e-02 3 1  ON 22
ci_0024                -1.147023e-02 3 1  ON 23
ci_0025                -2.029570e-03 3 1  ON 24
ci_0026                -2.390747e-03 3 1  ON 25
ci_0027                -1.213155e-02 3 1  ON 26
ci_0028                -1.154912e-02 3 1  ON 27
ci_0029                -1.065832e-02 3 1  ON 28
ci_0030                -1.058734e-02 3 1  ON 29
ci_0031                 1.340907e-02 3 1  ON 30
ci_0032                 1.211459e-02 3 1  ON 31
ci_0033                 7.848177e-03 3 1  ON 32
ci_0034                 8.489627e-03 3 1  ON 33
ci_0035                 4.859421e-03 3 1  ON 34
ci_0036                 4.933671e-03 3 1  ON 35
ci_0037                -1.133359e-02 3 1  ON 36
ci_0038                -1.131343e-02 3 1  ON 37
ci_0039                -4.014992e-03 3 1  ON 38
ci_0040                -3.886155e-03 3 1  ON 39
ci_0041                 9.104242e-03 3 1  ON 40
ci_0042                 8.780957e-03 3 1  ON 41
ci_0043                -1.307372e-02 3 1  ON 42
ci_0044                -1.384583e-02 3 1  ON 43
ci_0045                 1.059118e-02 3 1  ON 44
ci_0046                 1.007868e-02 3 1  ON 45
ci_0047                -3.585075e-03 3 1  ON 46
ci_0048                -3.481623e-03 3 1  ON 47
ci_0049                -2.594629e-03 3 1  ON 48
ci_0050                -2.695910e-03 3 1  ON 49
ci_0051                -1.797585e-03 3 1  ON 50
ci_0052                -2.016123e-03 3 1  ON 51
ci_0053                -3.931436e-03 3 1  ON 52
ci_0054                -3.323922e-03 3 1  ON 53
ci_0055                 2.398828e-03 3 1  ON 54
ci_0056                 2.269778e-03 3 1  ON 55
ci_0057                 2.453986e-03 3 1  ON 56
ci_0058                 2.857281e-03 3 1  ON 57
ci_0059                -3.395815e-03 3 1  ON 58
ci_0060                -3.375888e-03 3 1  ON 59
ci_0061                -3.976504e-03 3 1  ON 60
ci_0062                -3.922365e-03 3 1  ON 61
ci_0063                -9.802580e-03 3 1  ON 62
ci_0064                -9.372600e-03 3 1  ON 63
ci_0065                -6.435479e-03 3 1  ON 64
ci_0066                -6.132151e-03 3 1  ON 65
ci_0067                -3.747986e-03 3 1  ON 66
ci_0068                -3.479531e-03 3 1  ON 67
ci_0069                 3.569219e-03 3 1  ON 68
ci_0070                 3.348549e-03 3 1  ON 69
ci_0071                 3.005272e-03 3 1  ON 70
ci_0072                 3.481734e-03 3 1  ON 71
ci_0073                 3.552587e-03 3 1  ON 72
ci_0074                 3.528871e-03 3 1  ON 73
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 3.9929e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s083 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s083 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=83  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6902e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 83
    time step          = 0.05
    reference energy   = -16.8631
    reference variance = 0.208473
====================================================
  Execution time = 1.4314e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s083
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5223e+04
  VMC Eavg = -1.6899e+01
  VMC Evar = 2.9336e-01
  Total weights = 1.951261531e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 2.5634e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.283137803675
                                         uncertainty =       0.002085410861

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.283137803675
                                         uncertainty =       0.002085410861

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000376265557
  error estimate for blocks of size 2^( 2) =       0.000393149016
  error estimate for blocks of size 2^( 3) =       0.000410467940
  error estimate for blocks of size 2^( 4) =       0.000425869905
  error estimate for blocks of size 2^( 5) =       0.000437599299
  error estimate for blocks of size 2^( 6) =       0.000446376137
  error estimate for blocks of size 2^( 7) =       0.000451537257

      target function =      -0.923104066028
              le_mean =     -16.898754513133
             les_mean =     285.861260644139
             stat err =       0.000440345649
             autocorr =       1.369614951483
   target nu stat err =       0.000440345649
   target dn stat err =       0.003155343287
      target stat err =       0.004987789634
              std dev =       0.532119854223
             le_variance =       0.283151539258


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.689875451313e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 74
Check correct_vf_var_size: 225, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.1176e+06, overlap shift 2.1176e+07 and omega -1.7444e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.923129611438       residual = 2.12e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.923129611478       residual = 3.33e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.923129611484       residual = 6.64e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.923129611486       residual = 2.14e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.923129611486       residual = 1.43e-04           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.923129611486       residual = 5.30e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.923129608501       residual = 5.17e-05           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.923129611487       residual = 3.14e-05           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.923129611487       residual = 3.09e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.923129611487       residual = 2.64e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.923129612995       residual = 9.65e-06           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.923129613937       residual = 3.36e-06           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.923129611487       residual = 1.21e-06           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.923129607115       residual = 3.70e-07           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.923129610974       residual = 9.49e-08           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.923129611617       residual = 3.09e-08           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.923129606371       residual = 6.63e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         16 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 2.1176e+06 is 1.742153e-10

solving harmonic davidson linear method for identity shift 8.4703e+06, overlap shift 8.4703e+07 and omega -1.7444e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.923129611438       residual = 2.12e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.923129611448       residual = 3.33e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.923129611449       residual = 6.64e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.923129611450       residual = 2.14e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.923129611450       residual = 1.43e-04           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.923129611450       residual = 5.30e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.923129624775       residual = 5.17e-05           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.923129611450       residual = 3.14e-05           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.923129611450       residual = 3.09e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.923129610620       residual = 2.64e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.923129611450       residual = 9.65e-06           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.923129605528       residual = 3.36e-06           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.923129611450       residual = 1.21e-06           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.923129635784       residual = 3.70e-07           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.923129611450       residual = 9.49e-08           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.923129611450       residual = 3.09e-08           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.923129611450       residual = 6.63e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         16 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 8.4703e+06 is 4.355381e-11

solving harmonic davidson linear method for identity shift 3.3881e+07, overlap shift 3.3881e+08 and omega -1.7444e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.923129611438       residual = 2.12e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.923129611440       residual = 3.33e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.923129611440       residual = 6.64e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.923129611441       residual = 2.14e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.923129611441       residual = 1.43e-04           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.923129611441       residual = 5.30e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.923129611441       residual = 5.17e-05           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.923129611441       residual = 3.14e-05           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.923129611441       residual = 3.09e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.923129627225       residual = 2.64e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.923129625304       residual = 9.65e-06           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.923129572244       residual = 3.36e-06           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.923129611441       residual = 1.20e-06           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.923129611441       residual = 3.70e-07           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.923129639781       residual = 9.50e-08           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.923129611441       residual = 3.09e-08           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.923129611441       residual = 6.63e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         16 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 3.3881e+07 is 1.088845e-11

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.959889 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 75 and numParams is: 74

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.6902e+01
  </log>
  <optVariables href="H2O.s083.opt.xml">
ci_0001                 7.086064e-01 3 1  ON 0
ci_0002                 6.927483e-01 3 1  ON 1
ci_0003                -3.099699e-02 3 1  ON 2
ci_0004                -3.009162e-02 3 1  ON 3
ci_0005                -3.060382e-02 3 1  ON 4
ci_0006                -3.069586e-02 3 1  ON 5
ci_0007                -1.338102e-02 3 1  ON 6
ci_0008                -1.335093e-02 3 1  ON 7
ci_0009                -1.869650e-02 3 1  ON 8
ci_0010                -1.813030e-02 3 1  ON 9
ci_0011                -1.474501e-02 3 1  ON 10
ci_0012                -1.451134e-02 3 1  ON 11
ci_0013                 1.529423e-02 3 1  ON 12
ci_0014                 1.480516e-02 3 1  ON 13
ci_0015                 1.574766e-02 3 1  ON 14
ci_0016                 1.538632e-02 3 1  ON 15
ci_0017                 1.336745e-02 3 1  ON 16
ci_0018                 1.303906e-02 3 1  ON 17
ci_0019                 1.308950e-02 3 1  ON 18
ci_0020                 1.266839e-02 3 1  ON 19
ci_0021                 6.752770e-03 3 1  ON 20
ci_0022                 7.460538e-03 3 1  ON 21
ci_0023                -1.180403e-02 3 1  ON 22
ci_0024                -1.147023e-02 3 1  ON 23
ci_0025                -2.029570e-03 3 1  ON 24
ci_0026                -2.390747e-03 3 1  ON 25
ci_0027                -1.213155e-02 3 1  ON 26
ci_0028                -1.154912e-02 3 1  ON 27
ci_0029                -1.065832e-02 3 1  ON 28
ci_0030                -1.058734e-02 3 1  ON 29
ci_0031                 1.340907e-02 3 1  ON 30
ci_0032                 1.211459e-02 3 1  ON 31
ci_0033                 7.848177e-03 3 1  ON 32
ci_0034                 8.489627e-03 3 1  ON 33
ci_0035                 4.859421e-03 3 1  ON 34
ci_0036                 4.933671e-03 3 1  ON 35
ci_0037                -1.133359e-02 3 1  ON 36
ci_0038                -1.131343e-02 3 1  ON 37
ci_0039                -4.014992e-03 3 1  ON 38
ci_0040                -3.886155e-03 3 1  ON 39
ci_0041                 9.104242e-03 3 1  ON 40
ci_0042                 8.780957e-03 3 1  ON 41
ci_0043                -1.307372e-02 3 1  ON 42
ci_0044                -1.384583e-02 3 1  ON 43
ci_0045                 1.059118e-02 3 1  ON 44
ci_0046                 1.007868e-02 3 1  ON 45
ci_0047                -3.585075e-03 3 1  ON 46
ci_0048                -3.481623e-03 3 1  ON 47
ci_0049                -2.594629e-03 3 1  ON 48
ci_0050                -2.695910e-03 3 1  ON 49
ci_0051                -1.797585e-03 3 1  ON 50
ci_0052                -2.016123e-03 3 1  ON 51
ci_0053                -3.931436e-03 3 1  ON 52
ci_0054                -3.323922e-03 3 1  ON 53
ci_0055                 2.398828e-03 3 1  ON 54
ci_0056                 2.269778e-03 3 1  ON 55
ci_0057                 2.453986e-03 3 1  ON 56
ci_0058                 2.857281e-03 3 1  ON 57
ci_0059                -3.395815e-03 3 1  ON 58
ci_0060                -3.375888e-03 3 1  ON 59
ci_0061                -3.976504e-03 3 1  ON 60
ci_0062                -3.922365e-03 3 1  ON 61
ci_0063                -9.802580e-03 3 1  ON 62
ci_0064                -9.372600e-03 3 1  ON 63
ci_0065                -6.435479e-03 3 1  ON 64
ci_0066                -6.132151e-03 3 1  ON 65
ci_0067                -3.747986e-03 3 1  ON 66
ci_0068                -3.479531e-03 3 1  ON 67
ci_0069                 3.569219e-03 3 1  ON 68
ci_0070                 3.348549e-03 3 1  ON 69
ci_0071                 3.005272e-03 3 1  ON 70
ci_0072                 3.481734e-03 3 1  ON 71
ci_0073                 3.552587e-03 3 1  ON 72
ci_0074                 3.528871e-03 3 1  ON 73
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 83
    time step          = 0.05
    reference energy   = -16.8516
    reference variance = 0.175366
====================================================
  Execution time = 1.4097e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s083
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6899e+01
  VMC Evar = 2.9349e-01
  Total weights = 1.9511e+06
  Execution time = 1.8795e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.283881074420
                                         uncertainty =       0.002078264314

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.283881074420
                                         uncertainty =       0.002078264314

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000376724791
  error estimate for blocks of size 2^( 2) =       0.000393614984
  error estimate for blocks of size 2^( 3) =       0.000411092324
  error estimate for blocks of size 2^( 4) =       0.000426547400
  error estimate for blocks of size 2^( 5) =       0.000438748268
  error estimate for blocks of size 2^( 6) =       0.000446074968
  error estimate for blocks of size 2^( 7) =       0.000449121108

      target function =      -0.922900413663
              le_mean =     -16.898845092751
             les_mean =     285.864459841200
             stat err =       0.000440122936
             autocorr =       1.364896130151
   target nu stat err =       0.000440122936
   target dn stat err =       0.002444435349
      target stat err =       0.003891525000
              std dev =       0.532769308358
             le_variance =       0.283843135928

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.283881074410
                                         uncertainty =       0.002078264313

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.283881074410
                                         uncertainty =       0.002078264313

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000376724791
  error estimate for blocks of size 2^( 2) =       0.000393614984
  error estimate for blocks of size 2^( 3) =       0.000411092324
  error estimate for blocks of size 2^( 4) =       0.000426547400
  error estimate for blocks of size 2^( 5) =       0.000438748268
  error estimate for blocks of size 2^( 6) =       0.000446074968
  error estimate for blocks of size 2^( 7) =       0.000449121108

      target function =      -0.922900413205
              le_mean =     -16.898845092753
             les_mean =     285.864459841565
             stat err =       0.000440122936
             autocorr =       1.364896130114
   target nu stat err =       0.000440122936
   target dn stat err =       0.002444435355
      target stat err =       0.003891525005
              std dev =       0.532769308349
             le_variance =       0.283843135918

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.283881074415
                                         uncertainty =       0.002078264314

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.283881074415
                                         uncertainty =       0.002078264314

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000376724791
  error estimate for blocks of size 2^( 2) =       0.000393614984
  error estimate for blocks of size 2^( 3) =       0.000411092324
  error estimate for blocks of size 2^( 4) =       0.000426547400
  error estimate for blocks of size 2^( 5) =       0.000438748268
  error estimate for blocks of size 2^( 6) =       0.000446074968
  error estimate for blocks of size 2^( 7) =       0.000449121108

      target function =      -0.922900413434
              le_mean =     -16.898845092752
             les_mean =     285.864459841383
             stat err =       0.000440122936
             autocorr =       1.364896130134
   target nu stat err =       0.000440122936
   target dn stat err =       0.002444435352
      target stat err =       0.003891525002
              std dev =       0.532769308353
             le_variance =       0.283843135923

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.283881074419
                                         uncertainty =       0.002078264314

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.283881074419
                                         uncertainty =       0.002078264314

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000376724791
  error estimate for blocks of size 2^( 2) =       0.000393614984
  error estimate for blocks of size 2^( 3) =       0.000411092324
  error estimate for blocks of size 2^( 4) =       0.000426547400
  error estimate for blocks of size 2^( 5) =       0.000438748268
  error estimate for blocks of size 2^( 6) =       0.000446074968
  error estimate for blocks of size 2^( 7) =       0.000449121108

      target function =      -0.922900413634
              le_mean =     -16.898845092751
             les_mean =     285.864459841222
             stat err =       0.000440122936
             autocorr =       1.364896130156
   target nu stat err =       0.000440122936
   target dn stat err =       0.002444435350
      target stat err =       0.003891525000
              std dev =       0.532769308357
             le_variance =       0.283843135927


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.922900413663        initial  <--
     2.1176e+06     2.1176e+07             1.7422e-10        -0.922900413205
     8.4703e+06     8.4703e+07             4.3554e-11        -0.922900413434
     3.3881e+07     3.3881e+08             1.0888e-11        -0.922900413634

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 23.5535
  </log>
  <optVariables href="H2O.s083.opt.xml">
ci_0001                 7.086064e-01 3 1  ON 0
ci_0002                 6.927483e-01 3 1  ON 1
ci_0003                -3.099699e-02 3 1  ON 2
ci_0004                -3.009162e-02 3 1  ON 3
ci_0005                -3.060382e-02 3 1  ON 4
ci_0006                -3.069586e-02 3 1  ON 5
ci_0007                -1.338102e-02 3 1  ON 6
ci_0008                -1.335093e-02 3 1  ON 7
ci_0009                -1.869650e-02 3 1  ON 8
ci_0010                -1.813030e-02 3 1  ON 9
ci_0011                -1.474501e-02 3 1  ON 10
ci_0012                -1.451134e-02 3 1  ON 11
ci_0013                 1.529423e-02 3 1  ON 12
ci_0014                 1.480516e-02 3 1  ON 13
ci_0015                 1.574766e-02 3 1  ON 14
ci_0016                 1.538632e-02 3 1  ON 15
ci_0017                 1.336745e-02 3 1  ON 16
ci_0018                 1.303906e-02 3 1  ON 17
ci_0019                 1.308950e-02 3 1  ON 18
ci_0020                 1.266839e-02 3 1  ON 19
ci_0021                 6.752770e-03 3 1  ON 20
ci_0022                 7.460538e-03 3 1  ON 21
ci_0023                -1.180403e-02 3 1  ON 22
ci_0024                -1.147023e-02 3 1  ON 23
ci_0025                -2.029570e-03 3 1  ON 24
ci_0026                -2.390747e-03 3 1  ON 25
ci_0027                -1.213155e-02 3 1  ON 26
ci_0028                -1.154912e-02 3 1  ON 27
ci_0029                -1.065832e-02 3 1  ON 28
ci_0030                -1.058734e-02 3 1  ON 29
ci_0031                 1.340907e-02 3 1  ON 30
ci_0032                 1.211459e-02 3 1  ON 31
ci_0033                 7.848177e-03 3 1  ON 32
ci_0034                 8.489627e-03 3 1  ON 33
ci_0035                 4.859421e-03 3 1  ON 34
ci_0036                 4.933671e-03 3 1  ON 35
ci_0037                -1.133359e-02 3 1  ON 36
ci_0038                -1.131343e-02 3 1  ON 37
ci_0039                -4.014992e-03 3 1  ON 38
ci_0040                -3.886155e-03 3 1  ON 39
ci_0041                 9.104242e-03 3 1  ON 40
ci_0042                 8.780957e-03 3 1  ON 41
ci_0043                -1.307372e-02 3 1  ON 42
ci_0044                -1.384583e-02 3 1  ON 43
ci_0045                 1.059118e-02 3 1  ON 44
ci_0046                 1.007868e-02 3 1  ON 45
ci_0047                -3.585075e-03 3 1  ON 46
ci_0048                -3.481623e-03 3 1  ON 47
ci_0049                -2.594629e-03 3 1  ON 48
ci_0050                -2.695910e-03 3 1  ON 49
ci_0051                -1.797585e-03 3 1  ON 50
ci_0052                -2.016123e-03 3 1  ON 51
ci_0053                -3.931436e-03 3 1  ON 52
ci_0054                -3.323922e-03 3 1  ON 53
ci_0055                 2.398828e-03 3 1  ON 54
ci_0056                 2.269778e-03 3 1  ON 55
ci_0057                 2.453986e-03 3 1  ON 56
ci_0058                 2.857281e-03 3 1  ON 57
ci_0059                -3.395815e-03 3 1  ON 58
ci_0060                -3.375888e-03 3 1  ON 59
ci_0061                -3.976504e-03 3 1  ON 60
ci_0062                -3.922365e-03 3 1  ON 61
ci_0063                -9.802580e-03 3 1  ON 62
ci_0064                -9.372600e-03 3 1  ON 63
ci_0065                -6.435479e-03 3 1  ON 64
ci_0066                -6.132151e-03 3 1  ON 65
ci_0067                -3.747986e-03 3 1  ON 66
ci_0068                -3.479531e-03 3 1  ON 67
ci_0069                 3.569219e-03 3 1  ON 68
ci_0070                 3.348549e-03 3 1  ON 69
ci_0071                 3.005272e-03 3 1  ON 70
ci_0072                 3.481734e-03 3 1  ON 71
ci_0073                 3.552587e-03 3 1  ON 72
ci_0074                 3.528871e-03 3 1  ON 73
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 4.0483e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s084 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s084 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=84  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6901e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 84
    time step          = 0.05
    reference energy   = -16.8597
    reference variance = 0.536232
====================================================
  Execution time = 1.4358e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s084
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5226e+04
  VMC Eavg = -1.6899e+01
  VMC Evar = 2.8948e-01
  Total weights = 1.951268201e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 2.6033e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.280204150731
                                         uncertainty =       0.002020536294

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.280204150731
                                         uncertainty =       0.002020536294

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000374316265
  error estimate for blocks of size 2^( 2) =       0.000391403177
  error estimate for blocks of size 2^( 3) =       0.000408119040
  error estimate for blocks of size 2^( 4) =       0.000422605603
  error estimate for blocks of size 2^( 5) =       0.000433353171
  error estimate for blocks of size 2^( 6) =       0.000439507727
  error estimate for blocks of size 2^( 7) =       0.000442215553

      target function =      -0.929222081428
              le_mean =     -16.899315016200
             les_mean =     285.876329451402
             stat err =       0.000434420514
             autocorr =       1.346924497148
   target nu stat err =       0.000434420514
   target dn stat err =       0.002521750168
      target stat err =       0.004066066788
              std dev =       0.529363138999
             le_variance =       0.280225332930


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.689931501620e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 74
Check correct_vf_var_size: 225, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.1176e+07, overlap shift 2.1176e+08 and omega -1.7444e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.929238685104       residual = 1.06e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.929238685106       residual = 1.81e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.929238685106       residual = 3.72e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.929238684669       residual = 1.36e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.929238685107       residual = 5.37e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.929238664435       residual = 3.10e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.929238650713       residual = 1.39e-05           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.929238713140       residual = 4.72e-06           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.929238663073       residual = 3.25e-06           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.929238710738       residual = 1.58e-06           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.929238690020       residual = 2.03e-06           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.929238669962       residual = 1.60e-06           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.929238677108       residual = 9.05e-07           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.929238628290       residual = 2.33e-07           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.929238616764       residual = 1.09e-07           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.929238690115       residual = 3.29e-08           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.929238712711       residual = 7.01e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         16 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 2.1176e+07 is 1.236790e-11

solving harmonic davidson linear method for identity shift 8.4703e+07, overlap shift 8.4703e+08 and omega -1.7444e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.929238685104       residual = 1.06e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.929238685105       residual = 1.81e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.929238685105       residual = 3.72e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.929238685105       residual = 1.36e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.929238682552       residual = 5.37e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.929238685878       residual = 3.10e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.929238779693       residual = 1.39e-05           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.929238672589       residual = 4.72e-06           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.929238502232       residual = 3.25e-06           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.929238843533       residual = 1.58e-06           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.929238804084       residual = 2.03e-06           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.929238664871       residual = 1.60e-06           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.929238350987       residual = 9.05e-07           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.929238488300       residual = 2.33e-07           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.929238847317       residual = 1.09e-07           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.929238733121       residual = 3.30e-08           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.929238833386       residual = 7.03e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         16 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 8.4703e+07 is 3.091965e-12

solving harmonic davidson linear method for identity shift 3.3881e+08, overlap shift 3.3881e+09 and omega -1.7444e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.929238685104       residual = 1.06e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.929238685104       residual = 1.81e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.929238685104       residual = 3.72e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.929238685104       residual = 1.36e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.929238752398       residual = 5.37e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.929238684212       residual = 3.10e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.929238514488       residual = 1.39e-05           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.929238489271       residual = 4.73e-06           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.929238434099       residual = 3.25e-06           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.929239196643       residual = 1.58e-06           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.929239261468       residual = 2.03e-06           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.929239359984       residual = 1.60e-06           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.929238937204       residual = 9.07e-07           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.929239020425       residual = 2.32e-07           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.929238440437       residual = 1.09e-07           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.929238416575       residual = 3.35e-08           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.929238385660       residual = 6.93e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         16 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 3.3881e+08 is 7.730126e-13

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.975771 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 75 and numParams is: 74

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.6986e+01
  </log>
  <optVariables href="H2O.s084.opt.xml">
ci_0001                 7.086064e-01 3 1  ON 0
ci_0002                 6.927483e-01 3 1  ON 1
ci_0003                -3.099699e-02 3 1  ON 2
ci_0004                -3.009162e-02 3 1  ON 3
ci_0005                -3.060382e-02 3 1  ON 4
ci_0006                -3.069586e-02 3 1  ON 5
ci_0007                -1.338102e-02 3 1  ON 6
ci_0008                -1.335093e-02 3 1  ON 7
ci_0009                -1.869650e-02 3 1  ON 8
ci_0010                -1.813030e-02 3 1  ON 9
ci_0011                -1.474501e-02 3 1  ON 10
ci_0012                -1.451134e-02 3 1  ON 11
ci_0013                 1.529423e-02 3 1  ON 12
ci_0014                 1.480516e-02 3 1  ON 13
ci_0015                 1.574766e-02 3 1  ON 14
ci_0016                 1.538632e-02 3 1  ON 15
ci_0017                 1.336745e-02 3 1  ON 16
ci_0018                 1.303906e-02 3 1  ON 17
ci_0019                 1.308950e-02 3 1  ON 18
ci_0020                 1.266839e-02 3 1  ON 19
ci_0021                 6.752770e-03 3 1  ON 20
ci_0022                 7.460538e-03 3 1  ON 21
ci_0023                -1.180403e-02 3 1  ON 22
ci_0024                -1.147023e-02 3 1  ON 23
ci_0025                -2.029570e-03 3 1  ON 24
ci_0026                -2.390747e-03 3 1  ON 25
ci_0027                -1.213155e-02 3 1  ON 26
ci_0028                -1.154912e-02 3 1  ON 27
ci_0029                -1.065832e-02 3 1  ON 28
ci_0030                -1.058734e-02 3 1  ON 29
ci_0031                 1.340907e-02 3 1  ON 30
ci_0032                 1.211459e-02 3 1  ON 31
ci_0033                 7.848177e-03 3 1  ON 32
ci_0034                 8.489627e-03 3 1  ON 33
ci_0035                 4.859421e-03 3 1  ON 34
ci_0036                 4.933671e-03 3 1  ON 35
ci_0037                -1.133359e-02 3 1  ON 36
ci_0038                -1.131343e-02 3 1  ON 37
ci_0039                -4.014992e-03 3 1  ON 38
ci_0040                -3.886155e-03 3 1  ON 39
ci_0041                 9.104242e-03 3 1  ON 40
ci_0042                 8.780957e-03 3 1  ON 41
ci_0043                -1.307372e-02 3 1  ON 42
ci_0044                -1.384583e-02 3 1  ON 43
ci_0045                 1.059118e-02 3 1  ON 44
ci_0046                 1.007868e-02 3 1  ON 45
ci_0047                -3.585075e-03 3 1  ON 46
ci_0048                -3.481623e-03 3 1  ON 47
ci_0049                -2.594629e-03 3 1  ON 48
ci_0050                -2.695910e-03 3 1  ON 49
ci_0051                -1.797585e-03 3 1  ON 50
ci_0052                -2.016123e-03 3 1  ON 51
ci_0053                -3.931436e-03 3 1  ON 52
ci_0054                -3.323922e-03 3 1  ON 53
ci_0055                 2.398828e-03 3 1  ON 54
ci_0056                 2.269778e-03 3 1  ON 55
ci_0057                 2.453986e-03 3 1  ON 56
ci_0058                 2.857281e-03 3 1  ON 57
ci_0059                -3.395815e-03 3 1  ON 58
ci_0060                -3.375888e-03 3 1  ON 59
ci_0061                -3.976504e-03 3 1  ON 60
ci_0062                -3.922365e-03 3 1  ON 61
ci_0063                -9.802580e-03 3 1  ON 62
ci_0064                -9.372600e-03 3 1  ON 63
ci_0065                -6.435479e-03 3 1  ON 64
ci_0066                -6.132151e-03 3 1  ON 65
ci_0067                -3.747986e-03 3 1  ON 66
ci_0068                -3.479531e-03 3 1  ON 67
ci_0069                 3.569219e-03 3 1  ON 68
ci_0070                 3.348549e-03 3 1  ON 69
ci_0071                 3.005272e-03 3 1  ON 70
ci_0072                 3.481734e-03 3 1  ON 71
ci_0073                 3.552587e-03 3 1  ON 72
ci_0074                 3.528871e-03 3 1  ON 73
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 84
    time step          = 0.05
    reference energy   = -16.893
    reference variance = 0.328729
====================================================
  Execution time = 1.5921e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s084
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6898e+01
  VMC Evar = 2.9551e-01
  Total weights = 1.9509e+06
  Execution time = 1.8772e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.284232587297
                                         uncertainty =       0.001732368219

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.284232587297
                                         uncertainty =       0.001732368219

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000376977585
  error estimate for blocks of size 2^( 2) =       0.000394061805
  error estimate for blocks of size 2^( 3) =       0.000411468874
  error estimate for blocks of size 2^( 4) =       0.000426802898
  error estimate for blocks of size 2^( 5) =       0.000438369290
  error estimate for blocks of size 2^( 6) =       0.000447015803
  error estimate for blocks of size 2^( 7) =       0.000455392595

      target function =      -0.919761607293
              le_mean =     -16.898190673173
             les_mean =     285.844355313558
             stat err =       0.000441895147
             autocorr =       1.374065412976
   target nu stat err =       0.000441895147
   target dn stat err =       0.002486055571
      target stat err =       0.003924848616
              std dev =       0.533126813151
             le_variance =       0.284224198900

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.284232587295
                                         uncertainty =       0.001732368219

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.284232587295
                                         uncertainty =       0.001732368219

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000376977585
  error estimate for blocks of size 2^( 2) =       0.000394061805
  error estimate for blocks of size 2^( 3) =       0.000411468874
  error estimate for blocks of size 2^( 4) =       0.000426802898
  error estimate for blocks of size 2^( 5) =       0.000438369290
  error estimate for blocks of size 2^( 6) =       0.000447015803
  error estimate for blocks of size 2^( 7) =       0.000455392595

      target function =      -0.919761607289
              le_mean =     -16.898190673173
             les_mean =     285.844355313557
             stat err =       0.000441895147
             autocorr =       1.374065412974
   target nu stat err =       0.000441895147
   target dn stat err =       0.002486055571
      target stat err =       0.003924848616
              std dev =       0.533126813149
             le_variance =       0.284224198898

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.284232587296
                                         uncertainty =       0.001732368219

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.284232587296
                                         uncertainty =       0.001732368219

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000376977585
  error estimate for blocks of size 2^( 2) =       0.000394061805
  error estimate for blocks of size 2^( 3) =       0.000411468874
  error estimate for blocks of size 2^( 4) =       0.000426802898
  error estimate for blocks of size 2^( 5) =       0.000438369290
  error estimate for blocks of size 2^( 6) =       0.000447015803
  error estimate for blocks of size 2^( 7) =       0.000455392595

      target function =      -0.919761607291
              le_mean =     -16.898190673173
             les_mean =     285.844355313557
             stat err =       0.000441895147
             autocorr =       1.374065412976
   target nu stat err =       0.000441895147
   target dn stat err =       0.002486055571
      target stat err =       0.003924848616
              std dev =       0.533126813150
             le_variance =       0.284224198899

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.284232587297
                                         uncertainty =       0.001732368219

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.284232587297
                                         uncertainty =       0.001732368219

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000376977585
  error estimate for blocks of size 2^( 2) =       0.000394061805
  error estimate for blocks of size 2^( 3) =       0.000411468874
  error estimate for blocks of size 2^( 4) =       0.000426802898
  error estimate for blocks of size 2^( 5) =       0.000438369290
  error estimate for blocks of size 2^( 6) =       0.000447015803
  error estimate for blocks of size 2^( 7) =       0.000455392595

      target function =      -0.919761607292
              le_mean =     -16.898190673173
             les_mean =     285.844355313558
             stat err =       0.000441895147
             autocorr =       1.374065412983
   target nu stat err =       0.000441895147
   target dn stat err =       0.002486055571
      target stat err =       0.003924848616
              std dev =       0.533126813151
             le_variance =       0.284224198900


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.919761607293        initial  <--
     2.1176e+07     2.1176e+08             1.2368e-11        -0.919761607289
     8.4703e+07     8.4703e+08             3.0920e-12        -0.919761607291
     3.3881e+08     3.3881e+09             7.7301e-13        -0.919761607292

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 29.4017
  </log>
  <optVariables href="H2O.s084.opt.xml">
ci_0001                 7.086064e-01 3 1  ON 0
ci_0002                 6.927483e-01 3 1  ON 1
ci_0003                -3.099699e-02 3 1  ON 2
ci_0004                -3.009162e-02 3 1  ON 3
ci_0005                -3.060382e-02 3 1  ON 4
ci_0006                -3.069586e-02 3 1  ON 5
ci_0007                -1.338102e-02 3 1  ON 6
ci_0008                -1.335093e-02 3 1  ON 7
ci_0009                -1.869650e-02 3 1  ON 8
ci_0010                -1.813030e-02 3 1  ON 9
ci_0011                -1.474501e-02 3 1  ON 10
ci_0012                -1.451134e-02 3 1  ON 11
ci_0013                 1.529423e-02 3 1  ON 12
ci_0014                 1.480516e-02 3 1  ON 13
ci_0015                 1.574766e-02 3 1  ON 14
ci_0016                 1.538632e-02 3 1  ON 15
ci_0017                 1.336745e-02 3 1  ON 16
ci_0018                 1.303906e-02 3 1  ON 17
ci_0019                 1.308950e-02 3 1  ON 18
ci_0020                 1.266839e-02 3 1  ON 19
ci_0021                 6.752770e-03 3 1  ON 20
ci_0022                 7.460538e-03 3 1  ON 21
ci_0023                -1.180403e-02 3 1  ON 22
ci_0024                -1.147023e-02 3 1  ON 23
ci_0025                -2.029570e-03 3 1  ON 24
ci_0026                -2.390747e-03 3 1  ON 25
ci_0027                -1.213155e-02 3 1  ON 26
ci_0028                -1.154912e-02 3 1  ON 27
ci_0029                -1.065832e-02 3 1  ON 28
ci_0030                -1.058734e-02 3 1  ON 29
ci_0031                 1.340907e-02 3 1  ON 30
ci_0032                 1.211459e-02 3 1  ON 31
ci_0033                 7.848177e-03 3 1  ON 32
ci_0034                 8.489627e-03 3 1  ON 33
ci_0035                 4.859421e-03 3 1  ON 34
ci_0036                 4.933671e-03 3 1  ON 35
ci_0037                -1.133359e-02 3 1  ON 36
ci_0038                -1.131343e-02 3 1  ON 37
ci_0039                -4.014992e-03 3 1  ON 38
ci_0040                -3.886155e-03 3 1  ON 39
ci_0041                 9.104242e-03 3 1  ON 40
ci_0042                 8.780957e-03 3 1  ON 41
ci_0043                -1.307372e-02 3 1  ON 42
ci_0044                -1.384583e-02 3 1  ON 43
ci_0045                 1.059118e-02 3 1  ON 44
ci_0046                 1.007868e-02 3 1  ON 45
ci_0047                -3.585075e-03 3 1  ON 46
ci_0048                -3.481623e-03 3 1  ON 47
ci_0049                -2.594629e-03 3 1  ON 48
ci_0050                -2.695910e-03 3 1  ON 49
ci_0051                -1.797585e-03 3 1  ON 50
ci_0052                -2.016123e-03 3 1  ON 51
ci_0053                -3.931436e-03 3 1  ON 52
ci_0054                -3.323922e-03 3 1  ON 53
ci_0055                 2.398828e-03 3 1  ON 54
ci_0056                 2.269778e-03 3 1  ON 55
ci_0057                 2.453986e-03 3 1  ON 56
ci_0058                 2.857281e-03 3 1  ON 57
ci_0059                -3.395815e-03 3 1  ON 58
ci_0060                -3.375888e-03 3 1  ON 59
ci_0061                -3.976504e-03 3 1  ON 60
ci_0062                -3.922365e-03 3 1  ON 61
ci_0063                -9.802580e-03 3 1  ON 62
ci_0064                -9.372600e-03 3 1  ON 63
ci_0065                -6.435479e-03 3 1  ON 64
ci_0066                -6.132151e-03 3 1  ON 65
ci_0067                -3.747986e-03 3 1  ON 66
ci_0068                -3.479531e-03 3 1  ON 67
ci_0069                 3.569219e-03 3 1  ON 68
ci_0070                 3.348549e-03 3 1  ON 69
ci_0071                 3.005272e-03 3 1  ON 70
ci_0072                 3.481734e-03 3 1  ON 71
ci_0073                 3.552587e-03 3 1  ON 72
ci_0074                 3.528871e-03 3 1  ON 73
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 4.6446e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s085 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s085 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=85  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6901e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 85
    time step          = 0.05
    reference energy   = -16.8509
    reference variance = 0.21078
====================================================
  Execution time = 1.4142e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s085
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5229e+04
  VMC Eavg = -1.6898e+01
  VMC Evar = 2.9673e-01
  Total weights = 1.951123394e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 2.5929e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.284871398512
                                         uncertainty =       0.001799671123

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.284871398512
                                         uncertainty =       0.001799671123

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000377404850
  error estimate for blocks of size 2^( 2) =       0.000394477206
  error estimate for blocks of size 2^( 3) =       0.000412132389
  error estimate for blocks of size 2^( 4) =       0.000427500957
  error estimate for blocks of size 2^( 5) =       0.000439222058
  error estimate for blocks of size 2^( 6) =       0.000447641205
  error estimate for blocks of size 2^( 7) =       0.000449300181

      target function =      -0.917857827249
              le_mean =     -16.898146037619
             les_mean =     285.844070375073
             stat err =       0.000440916100
             autocorr =       1.364887829605
   target nu stat err =       0.000440916100
   target dn stat err =       0.003212918169
      target stat err =       0.005014413650
              std dev =       0.533731057535
             le_variance =       0.284868841778


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.689814603762e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 74
Check correct_vf_var_size: 225, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.1176e+08, overlap shift 2.1176e+09 and omega -1.7444e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.917883960326       residual = 1.40e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.917883960326       residual = 1.25e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.917883960326       residual = 3.30e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.917883963895       residual = 1.48e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.917883940447       residual = 5.53e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.917883873963       residual = 2.99e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.917883960326       residual = 2.29e-05           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.917884325422       residual = 1.83e-05           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.917883691801       residual = 1.88e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.917883960326       residual = 1.25e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.917883960326       residual = 5.61e-06           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.917883711529       residual = 1.69e-06           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.917884005769       residual = 1.09e-06           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.917883733636       residual = 2.92e-07           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.917884390630       residual = 5.74e-08           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.917883670737       residual = 1.35e-08           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.917884460499       residual = 3.69e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         16 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 2.1176e+08 is 1.287974e-12

solving harmonic davidson linear method for identity shift 8.4703e+08, overlap shift 8.4703e+09 and omega -1.7444e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.917883960326       residual = 1.40e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.917883960326       residual = 1.25e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.917883960326       residual = 3.30e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.917883246483       residual = 1.48e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.917884018555       residual = 5.53e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.917883730706       residual = 3.00e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.917883332432       residual = 2.29e-05           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.917881949170       residual = 1.83e-05           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.917884036503       residual = 1.88e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.917883830094       residual = 1.25e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.917883762533       residual = 5.60e-06           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.917884328008       residual = 1.69e-06           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.917881251450       residual = 1.09e-06           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.917883653634       residual = 2.98e-07           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.917883007017       residual = 5.75e-08           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.917880874150       residual = 1.43e-08           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.917885931461       residual = 4.11e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         16 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 8.4703e+08 is 3.220800e-13

solving harmonic davidson linear method for identity shift 3.3881e+09, overlap shift 3.3881e+10 and omega -1.7444e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.917883960326       residual = 1.40e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.917883960326       residual = 1.25e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.917883960326       residual = 3.30e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.917883960326       residual = 1.48e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.917884561992       residual = 5.53e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.917883960326       residual = 2.99e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.917887814753       residual = 2.30e-05           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.917875439662       residual = 1.84e-05           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.917890699739       residual = 1.88e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.917884231903       residual = 1.26e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.917888734332       residual = 5.68e-06           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.917877364195       residual = 1.73e-06           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.917883960326       residual = 1.09e-06           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.917882176301       residual = 2.91e-07           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.917864624523       residual = 5.85e-08           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.917873472661       residual = 1.78e-08           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.917887330220       residual = 5.17e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         16 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 3.3881e+09 is 8.077464e-14

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.984793 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 75 and numParams is: 74

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.6752e+01
  </log>
  <optVariables href="H2O.s085.opt.xml">
ci_0001                 7.086064e-01 3 1  ON 0
ci_0002                 6.927483e-01 3 1  ON 1
ci_0003                -3.099699e-02 3 1  ON 2
ci_0004                -3.009162e-02 3 1  ON 3
ci_0005                -3.060382e-02 3 1  ON 4
ci_0006                -3.069586e-02 3 1  ON 5
ci_0007                -1.338102e-02 3 1  ON 6
ci_0008                -1.335093e-02 3 1  ON 7
ci_0009                -1.869650e-02 3 1  ON 8
ci_0010                -1.813030e-02 3 1  ON 9
ci_0011                -1.474501e-02 3 1  ON 10
ci_0012                -1.451134e-02 3 1  ON 11
ci_0013                 1.529423e-02 3 1  ON 12
ci_0014                 1.480516e-02 3 1  ON 13
ci_0015                 1.574766e-02 3 1  ON 14
ci_0016                 1.538632e-02 3 1  ON 15
ci_0017                 1.336745e-02 3 1  ON 16
ci_0018                 1.303906e-02 3 1  ON 17
ci_0019                 1.308950e-02 3 1  ON 18
ci_0020                 1.266839e-02 3 1  ON 19
ci_0021                 6.752770e-03 3 1  ON 20
ci_0022                 7.460538e-03 3 1  ON 21
ci_0023                -1.180403e-02 3 1  ON 22
ci_0024                -1.147023e-02 3 1  ON 23
ci_0025                -2.029570e-03 3 1  ON 24
ci_0026                -2.390747e-03 3 1  ON 25
ci_0027                -1.213155e-02 3 1  ON 26
ci_0028                -1.154912e-02 3 1  ON 27
ci_0029                -1.065832e-02 3 1  ON 28
ci_0030                -1.058734e-02 3 1  ON 29
ci_0031                 1.340907e-02 3 1  ON 30
ci_0032                 1.211459e-02 3 1  ON 31
ci_0033                 7.848177e-03 3 1  ON 32
ci_0034                 8.489627e-03 3 1  ON 33
ci_0035                 4.859421e-03 3 1  ON 34
ci_0036                 4.933671e-03 3 1  ON 35
ci_0037                -1.133359e-02 3 1  ON 36
ci_0038                -1.131343e-02 3 1  ON 37
ci_0039                -4.014992e-03 3 1  ON 38
ci_0040                -3.886155e-03 3 1  ON 39
ci_0041                 9.104242e-03 3 1  ON 40
ci_0042                 8.780957e-03 3 1  ON 41
ci_0043                -1.307372e-02 3 1  ON 42
ci_0044                -1.384583e-02 3 1  ON 43
ci_0045                 1.059118e-02 3 1  ON 44
ci_0046                 1.007868e-02 3 1  ON 45
ci_0047                -3.585075e-03 3 1  ON 46
ci_0048                -3.481623e-03 3 1  ON 47
ci_0049                -2.594629e-03 3 1  ON 48
ci_0050                -2.695910e-03 3 1  ON 49
ci_0051                -1.797585e-03 3 1  ON 50
ci_0052                -2.016123e-03 3 1  ON 51
ci_0053                -3.931436e-03 3 1  ON 52
ci_0054                -3.323922e-03 3 1  ON 53
ci_0055                 2.398828e-03 3 1  ON 54
ci_0056                 2.269778e-03 3 1  ON 55
ci_0057                 2.453986e-03 3 1  ON 56
ci_0058                 2.857281e-03 3 1  ON 57
ci_0059                -3.395815e-03 3 1  ON 58
ci_0060                -3.375888e-03 3 1  ON 59
ci_0061                -3.976504e-03 3 1  ON 60
ci_0062                -3.922365e-03 3 1  ON 61
ci_0063                -9.802580e-03 3 1  ON 62
ci_0064                -9.372600e-03 3 1  ON 63
ci_0065                -6.435479e-03 3 1  ON 64
ci_0066                -6.132151e-03 3 1  ON 65
ci_0067                -3.747986e-03 3 1  ON 66
ci_0068                -3.479531e-03 3 1  ON 67
ci_0069                 3.569219e-03 3 1  ON 68
ci_0070                 3.348549e-03 3 1  ON 69
ci_0071                 3.005272e-03 3 1  ON 70
ci_0072                 3.481734e-03 3 1  ON 71
ci_0073                 3.552587e-03 3 1  ON 72
ci_0074                 3.528871e-03 3 1  ON 73
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 85
    time step          = 0.05
    reference energy   = -16.8763
    reference variance = 0.188572
====================================================
  Execution time = 1.4220e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s085
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6899e+01
  VMC Evar = 2.9387e-01
  Total weights = 1.9511e+06
  Execution time = 1.8712e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.281217507345
                                         uncertainty =       0.001565442081

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.281217507345
                                         uncertainty =       0.001565442081

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000374977922
  error estimate for blocks of size 2^( 2) =       0.000391886131
  error estimate for blocks of size 2^( 3) =       0.000409289570
  error estimate for blocks of size 2^( 4) =       0.000424311484
  error estimate for blocks of size 2^( 5) =       0.000435571405
  error estimate for blocks of size 2^( 6) =       0.000443370330
  error estimate for blocks of size 2^( 7) =       0.000446882662

      target function =      -0.922300907824
              le_mean =     -16.898787856378
             les_mean =     285.862903773034
             stat err =       0.000437533970
             autocorr =       1.361482799670
   target nu stat err =       0.000437533970
   target dn stat err =       0.002993751977
      target stat err =       0.004729602738
              std dev =       0.530298862880
             le_variance =       0.281216883972

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.281217507345
                                         uncertainty =       0.001565442081

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.281217507345
                                         uncertainty =       0.001565442081

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000374977922
  error estimate for blocks of size 2^( 2) =       0.000391886131
  error estimate for blocks of size 2^( 3) =       0.000409289570
  error estimate for blocks of size 2^( 4) =       0.000424311484
  error estimate for blocks of size 2^( 5) =       0.000435571405
  error estimate for blocks of size 2^( 6) =       0.000443370330
  error estimate for blocks of size 2^( 7) =       0.000446882662

      target function =      -0.922300907830
              le_mean =     -16.898787856379
             les_mean =     285.862903773030
             stat err =       0.000437533970
             autocorr =       1.361482799664
   target nu stat err =       0.000437533970
   target dn stat err =       0.002993751975
      target stat err =       0.004729602735
              std dev =       0.530298862880
             le_variance =       0.281216883972

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.281217507345
                                         uncertainty =       0.001565442081

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.281217507345
                                         uncertainty =       0.001565442081

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000374977922
  error estimate for blocks of size 2^( 2) =       0.000391886131
  error estimate for blocks of size 2^( 3) =       0.000409289570
  error estimate for blocks of size 2^( 4) =       0.000424311484
  error estimate for blocks of size 2^( 5) =       0.000435571405
  error estimate for blocks of size 2^( 6) =       0.000443370330
  error estimate for blocks of size 2^( 7) =       0.000446882662

      target function =      -0.922300907827
              le_mean =     -16.898787856379
             les_mean =     285.862903773032
             stat err =       0.000437533970
             autocorr =       1.361482799665
   target nu stat err =       0.000437533970
   target dn stat err =       0.002993751976
      target stat err =       0.004729602737
              std dev =       0.530298862880
             le_variance =       0.281216883972

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.281217507345
                                         uncertainty =       0.001565442081

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.281217507345
                                         uncertainty =       0.001565442081

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000374977922
  error estimate for blocks of size 2^( 2) =       0.000391886131
  error estimate for blocks of size 2^( 3) =       0.000409289570
  error estimate for blocks of size 2^( 4) =       0.000424311484
  error estimate for blocks of size 2^( 5) =       0.000435571405
  error estimate for blocks of size 2^( 6) =       0.000443370330
  error estimate for blocks of size 2^( 7) =       0.000446882662

      target function =      -0.922300907824
              le_mean =     -16.898787856378
             les_mean =     285.862903773033
             stat err =       0.000437533970
             autocorr =       1.361482799663
   target nu stat err =       0.000437533970
   target dn stat err =       0.002993751977
      target stat err =       0.004729602738
              std dev =       0.530298862880
             le_variance =       0.281216883972


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.922300907824        initial
     2.1176e+08     2.1176e+09             1.2880e-12        -0.922300907830  <--
     8.4703e+08     8.4703e+09             3.2208e-13        -0.922300907827
     3.3881e+09     3.3881e+10             8.0775e-14        -0.922300907824

*****************************************************************************
Applying the update for shift_i =   2.1176e+08     and shift_s =   2.1176e+09
*****************************************************************************

  Execution time = 2.3644e+01
  </log>
  <optVariables href="H2O.s085.opt.xml">
ci_0001                 7.086064e-01 3 1  ON 0
ci_0002                 6.927483e-01 3 1  ON 1
ci_0003                -3.099699e-02 3 1  ON 2
ci_0004                -3.009162e-02 3 1  ON 3
ci_0005                -3.060382e-02 3 1  ON 4
ci_0006                -3.069586e-02 3 1  ON 5
ci_0007                -1.338102e-02 3 1  ON 6
ci_0008                -1.335093e-02 3 1  ON 7
ci_0009                -1.869650e-02 3 1  ON 8
ci_0010                -1.813030e-02 3 1  ON 9
ci_0011                -1.474501e-02 3 1  ON 10
ci_0012                -1.451134e-02 3 1  ON 11
ci_0013                 1.529423e-02 3 1  ON 12
ci_0014                 1.480516e-02 3 1  ON 13
ci_0015                 1.574766e-02 3 1  ON 14
ci_0016                 1.538632e-02 3 1  ON 15
ci_0017                 1.336745e-02 3 1  ON 16
ci_0018                 1.303906e-02 3 1  ON 17
ci_0019                 1.308950e-02 3 1  ON 18
ci_0020                 1.266839e-02 3 1  ON 19
ci_0021                 6.752770e-03 3 1  ON 20
ci_0022                 7.460538e-03 3 1  ON 21
ci_0023                -1.180403e-02 3 1  ON 22
ci_0024                -1.147023e-02 3 1  ON 23
ci_0025                -2.029570e-03 3 1  ON 24
ci_0026                -2.390747e-03 3 1  ON 25
ci_0027                -1.213155e-02 3 1  ON 26
ci_0028                -1.154912e-02 3 1  ON 27
ci_0029                -1.065832e-02 3 1  ON 28
ci_0030                -1.058734e-02 3 1  ON 29
ci_0031                 1.340907e-02 3 1  ON 30
ci_0032                 1.211459e-02 3 1  ON 31
ci_0033                 7.848177e-03 3 1  ON 32
ci_0034                 8.489627e-03 3 1  ON 33
ci_0035                 4.859421e-03 3 1  ON 34
ci_0036                 4.933671e-03 3 1  ON 35
ci_0037                -1.133359e-02 3 1  ON 36
ci_0038                -1.131343e-02 3 1  ON 37
ci_0039                -4.014992e-03 3 1  ON 38
ci_0040                -3.886155e-03 3 1  ON 39
ci_0041                 9.104242e-03 3 1  ON 40
ci_0042                 8.780957e-03 3 1  ON 41
ci_0043                -1.307372e-02 3 1  ON 42
ci_0044                -1.384583e-02 3 1  ON 43
ci_0045                 1.059118e-02 3 1  ON 44
ci_0046                 1.007868e-02 3 1  ON 45
ci_0047                -3.585075e-03 3 1  ON 46
ci_0048                -3.481623e-03 3 1  ON 47
ci_0049                -2.594629e-03 3 1  ON 48
ci_0050                -2.695910e-03 3 1  ON 49
ci_0051                -1.797585e-03 3 1  ON 50
ci_0052                -2.016123e-03 3 1  ON 51
ci_0053                -3.931436e-03 3 1  ON 52
ci_0054                -3.323922e-03 3 1  ON 53
ci_0055                 2.398828e-03 3 1  ON 54
ci_0056                 2.269778e-03 3 1  ON 55
ci_0057                 2.453986e-03 3 1  ON 56
ci_0058                 2.857281e-03 3 1  ON 57
ci_0059                -3.395815e-03 3 1  ON 58
ci_0060                -3.375888e-03 3 1  ON 59
ci_0061                -3.976504e-03 3 1  ON 60
ci_0062                -3.922365e-03 3 1  ON 61
ci_0063                -9.802580e-03 3 1  ON 62
ci_0064                -9.372600e-03 3 1  ON 63
ci_0065                -6.435479e-03 3 1  ON 64
ci_0066                -6.132151e-03 3 1  ON 65
ci_0067                -3.747986e-03 3 1  ON 66
ci_0068                -3.479531e-03 3 1  ON 67
ci_0069                 3.569219e-03 3 1  ON 68
ci_0070                 3.348549e-03 3 1  ON 69
ci_0071                 3.005272e-03 3 1  ON 70
ci_0072                 3.481734e-03 3 1  ON 71
ci_0073                 3.552587e-03 3 1  ON 72
ci_0074                 3.528871e-03 3 1  ON 73
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 4.0402e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s086 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s086 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=86  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6901e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 86
    time step          = 0.05
    reference energy   = -16.9255
    reference variance = 0.211422
====================================================
  Execution time = 1.3993e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s086
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5245e+04
  VMC Eavg = -1.6899e+01
  VMC Evar = 2.9274e-01
  Total weights = 1.951000744e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 2.5324e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.282123603396
                                         uncertainty =       0.001325172524

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.282123603396
                                         uncertainty =       0.001325172524

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000375560734
  error estimate for blocks of size 2^( 2) =       0.000392534910
  error estimate for blocks of size 2^( 3) =       0.000410083893
  error estimate for blocks of size 2^( 4) =       0.000425856899
  error estimate for blocks of size 2^( 5) =       0.000436965912
  error estimate for blocks of size 2^( 6) =       0.000444517752
  error estimate for blocks of size 2^( 7) =       0.000445845259

      target function =      -0.924079944717
              le_mean =     -16.899054765306
             les_mean =     285.870795184551
             stat err =       0.000438296455
             autocorr =       1.361995138759
   target nu stat err =       0.000438296455
   target dn stat err =       0.002268775246
      target stat err =       0.003632334954
              std dev =       0.531123084144
             le_variance =       0.282091730511


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.689905476531e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 74
Check correct_vf_var_size: 225, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 5.2940e+07, overlap shift 5.2940e+08 and omega -1.7444e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.924092997645       residual = 4.32e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.924092997645       residual = 6.57e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.924092997645       residual = 2.39e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.924092994840       residual = 1.03e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.924092957959       residual = 2.51e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.924092997646       residual = 1.27e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.924092997646       residual = 3.84e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.924092997646       residual = 3.31e-06           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.924092997646       residual = 4.68e-06           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.924093049303       residual = 3.71e-06           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.924092943154       residual = 2.48e-06           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.924092867205       residual = 9.87e-07           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.924092950066       residual = 3.09e-07           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.924093047304       residual = 1.02e-07           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.924093033579       residual = 2.92e-08           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.924092990138       residual = 8.18e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         15 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 5.2940e+07 is 2.525335e-12

solving harmonic davidson linear method for identity shift 2.1176e+08, overlap shift 2.1176e+09 and omega -1.7444e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.924092997645       residual = 4.32e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.924092997645       residual = 6.57e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.924092997645       residual = 2.39e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.924092997645       residual = 1.03e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.924092997645       residual = 2.51e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.924093128696       residual = 1.27e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.924092997645       residual = 3.85e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.924092402276       residual = 3.31e-06           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.924092956333       residual = 4.68e-06           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.924093112654       residual = 3.71e-06           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.924093206309       residual = 2.48e-06           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.924092861814       residual = 9.88e-07           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.924092977045       residual = 3.09e-07           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.924092962155       residual = 1.02e-07           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.924092926399       residual = 2.92e-08           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.924092099537       residual = 8.19e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         15 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 2.1176e+08 is 6.312589e-13

solving harmonic davidson linear method for identity shift 8.4703e+08, overlap shift 8.4703e+09 and omega -1.7444e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.924092997645       residual = 4.32e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.924092997645       residual = 6.57e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.924092997645       residual = 2.39e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.924092997645       residual = 1.02e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.924092997641       residual = 2.50e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.924093000810       residual = 1.27e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.924092764465       residual = 3.85e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.924093056692       residual = 3.32e-06           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.924092997657       residual = 4.67e-06           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.924090694197       residual = 3.73e-06           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.924094355989       residual = 2.50e-06           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.924092160713       residual = 9.91e-07           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.924092735724       residual = 3.13e-07           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.924092576959       residual = 1.01e-07           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.924089413825       residual = 2.92e-08           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.924092739275       residual = 9.16e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         15 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 8.4703e+08 is 1.578622e-13

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.992795 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 75 and numParams is: 74

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.6538e+01
  </log>
  <optVariables href="H2O.s086.opt.xml">
ci_0001                 7.086064e-01 3 1  ON 0
ci_0002                 6.927483e-01 3 1  ON 1
ci_0003                -3.099699e-02 3 1  ON 2
ci_0004                -3.009162e-02 3 1  ON 3
ci_0005                -3.060382e-02 3 1  ON 4
ci_0006                -3.069586e-02 3 1  ON 5
ci_0007                -1.338102e-02 3 1  ON 6
ci_0008                -1.335093e-02 3 1  ON 7
ci_0009                -1.869650e-02 3 1  ON 8
ci_0010                -1.813030e-02 3 1  ON 9
ci_0011                -1.474501e-02 3 1  ON 10
ci_0012                -1.451134e-02 3 1  ON 11
ci_0013                 1.529423e-02 3 1  ON 12
ci_0014                 1.480516e-02 3 1  ON 13
ci_0015                 1.574766e-02 3 1  ON 14
ci_0016                 1.538632e-02 3 1  ON 15
ci_0017                 1.336745e-02 3 1  ON 16
ci_0018                 1.303906e-02 3 1  ON 17
ci_0019                 1.308950e-02 3 1  ON 18
ci_0020                 1.266839e-02 3 1  ON 19
ci_0021                 6.752770e-03 3 1  ON 20
ci_0022                 7.460538e-03 3 1  ON 21
ci_0023                -1.180403e-02 3 1  ON 22
ci_0024                -1.147023e-02 3 1  ON 23
ci_0025                -2.029570e-03 3 1  ON 24
ci_0026                -2.390747e-03 3 1  ON 25
ci_0027                -1.213155e-02 3 1  ON 26
ci_0028                -1.154912e-02 3 1  ON 27
ci_0029                -1.065832e-02 3 1  ON 28
ci_0030                -1.058734e-02 3 1  ON 29
ci_0031                 1.340907e-02 3 1  ON 30
ci_0032                 1.211459e-02 3 1  ON 31
ci_0033                 7.848177e-03 3 1  ON 32
ci_0034                 8.489627e-03 3 1  ON 33
ci_0035                 4.859421e-03 3 1  ON 34
ci_0036                 4.933671e-03 3 1  ON 35
ci_0037                -1.133359e-02 3 1  ON 36
ci_0038                -1.131343e-02 3 1  ON 37
ci_0039                -4.014992e-03 3 1  ON 38
ci_0040                -3.886155e-03 3 1  ON 39
ci_0041                 9.104242e-03 3 1  ON 40
ci_0042                 8.780957e-03 3 1  ON 41
ci_0043                -1.307372e-02 3 1  ON 42
ci_0044                -1.384583e-02 3 1  ON 43
ci_0045                 1.059118e-02 3 1  ON 44
ci_0046                 1.007868e-02 3 1  ON 45
ci_0047                -3.585075e-03 3 1  ON 46
ci_0048                -3.481623e-03 3 1  ON 47
ci_0049                -2.594629e-03 3 1  ON 48
ci_0050                -2.695910e-03 3 1  ON 49
ci_0051                -1.797585e-03 3 1  ON 50
ci_0052                -2.016123e-03 3 1  ON 51
ci_0053                -3.931436e-03 3 1  ON 52
ci_0054                -3.323922e-03 3 1  ON 53
ci_0055                 2.398828e-03 3 1  ON 54
ci_0056                 2.269778e-03 3 1  ON 55
ci_0057                 2.453986e-03 3 1  ON 56
ci_0058                 2.857281e-03 3 1  ON 57
ci_0059                -3.395815e-03 3 1  ON 58
ci_0060                -3.375888e-03 3 1  ON 59
ci_0061                -3.976504e-03 3 1  ON 60
ci_0062                -3.922365e-03 3 1  ON 61
ci_0063                -9.802580e-03 3 1  ON 62
ci_0064                -9.372600e-03 3 1  ON 63
ci_0065                -6.435479e-03 3 1  ON 64
ci_0066                -6.132151e-03 3 1  ON 65
ci_0067                -3.747986e-03 3 1  ON 66
ci_0068                -3.479531e-03 3 1  ON 67
ci_0069                 3.569219e-03 3 1  ON 68
ci_0070                 3.348549e-03 3 1  ON 69
ci_0071                 3.005272e-03 3 1  ON 70
ci_0072                 3.481734e-03 3 1  ON 71
ci_0073                 3.552587e-03 3 1  ON 72
ci_0074                 3.528871e-03 3 1  ON 73
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 86
    time step          = 0.05
    reference energy   = -16.9104
    reference variance = 0.202377
====================================================
  Execution time = 1.4019e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s086
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6899e+01
  VMC Evar = 2.9090e-01
  Total weights = 1.9509e+06
  Execution time = 1.8697e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.281450163725
                                         uncertainty =       0.001787932766

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.281450163725
                                         uncertainty =       0.001787932766

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000375165963
  error estimate for blocks of size 2^( 2) =       0.000392147325
  error estimate for blocks of size 2^( 3) =       0.000409185888
  error estimate for blocks of size 2^( 4) =       0.000424061512
  error estimate for blocks of size 2^( 5) =       0.000435590558
  error estimate for blocks of size 2^( 6) =       0.000443879602
  error estimate for blocks of size 2^( 7) =       0.000446752264

      target function =      -0.926968484293
              le_mean =     -16.899025921821
             les_mean =     285.867981206602
             stat err =       0.000437570984
             autocorr =       1.360348464315
   target nu stat err =       0.000437570984
   target dn stat err =       0.002423597033
      target stat err =       0.003893497776
              std dev =       0.530564793491
             le_variance =       0.281499000092

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.281450163724
                                         uncertainty =       0.001787932766

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.281450163724
                                         uncertainty =       0.001787932766

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000375165963
  error estimate for blocks of size 2^( 2) =       0.000392147325
  error estimate for blocks of size 2^( 3) =       0.000409185888
  error estimate for blocks of size 2^( 4) =       0.000424061512
  error estimate for blocks of size 2^( 5) =       0.000435590558
  error estimate for blocks of size 2^( 6) =       0.000443879602
  error estimate for blocks of size 2^( 7) =       0.000446752264

      target function =      -0.926968484297
              le_mean =     -16.899025921821
             les_mean =     285.867981206601
             stat err =       0.000437570984
             autocorr =       1.360348464307
   target nu stat err =       0.000437570984
   target dn stat err =       0.002423597033
      target stat err =       0.003893497775
              std dev =       0.530564793490
             le_variance =       0.281499000091

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.281450163725
                                         uncertainty =       0.001787932766

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.281450163725
                                         uncertainty =       0.001787932766

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000375165963
  error estimate for blocks of size 2^( 2) =       0.000392147325
  error estimate for blocks of size 2^( 3) =       0.000409185888
  error estimate for blocks of size 2^( 4) =       0.000424061512
  error estimate for blocks of size 2^( 5) =       0.000435590558
  error estimate for blocks of size 2^( 6) =       0.000443879602
  error estimate for blocks of size 2^( 7) =       0.000446752264

      target function =      -0.926968484295
              le_mean =     -16.899025921821
             les_mean =     285.867981206602
             stat err =       0.000437570984
             autocorr =       1.360348464303
   target nu stat err =       0.000437570984
   target dn stat err =       0.002423597033
      target stat err =       0.003893497776
              std dev =       0.530564793490
             le_variance =       0.281499000091

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.281450163725
                                         uncertainty =       0.001787932766

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.281450163725
                                         uncertainty =       0.001787932766

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000375165963
  error estimate for blocks of size 2^( 2) =       0.000392147325
  error estimate for blocks of size 2^( 3) =       0.000409185888
  error estimate for blocks of size 2^( 4) =       0.000424061512
  error estimate for blocks of size 2^( 5) =       0.000435590558
  error estimate for blocks of size 2^( 6) =       0.000443879602
  error estimate for blocks of size 2^( 7) =       0.000446752264

      target function =      -0.926968484293
              le_mean =     -16.899025921821
             les_mean =     285.867981206602
             stat err =       0.000437570984
             autocorr =       1.360348464306
   target nu stat err =       0.000437570984
   target dn stat err =       0.002423597033
      target stat err =       0.003893497776
              std dev =       0.530564793490
             le_variance =       0.281499000092


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.926968484293        initial
     5.2940e+07     5.2940e+08             2.5253e-12        -0.926968484297  <--
     2.1176e+08     2.1176e+09             6.3126e-13        -0.926968484295
     8.4703e+08     8.4703e+09             1.5786e-13        -0.926968484293

*****************************************************************************
Applying the update for shift_i =   5.2940e+07     and shift_s =   5.2940e+08
*****************************************************************************

  Execution time = 2.3445e+01
  </log>
  <optVariables href="H2O.s086.opt.xml">
ci_0001                 7.086064e-01 3 1  ON 0
ci_0002                 6.927483e-01 3 1  ON 1
ci_0003                -3.099699e-02 3 1  ON 2
ci_0004                -3.009162e-02 3 1  ON 3
ci_0005                -3.060382e-02 3 1  ON 4
ci_0006                -3.069586e-02 3 1  ON 5
ci_0007                -1.338102e-02 3 1  ON 6
ci_0008                -1.335093e-02 3 1  ON 7
ci_0009                -1.869650e-02 3 1  ON 8
ci_0010                -1.813030e-02 3 1  ON 9
ci_0011                -1.474501e-02 3 1  ON 10
ci_0012                -1.451134e-02 3 1  ON 11
ci_0013                 1.529423e-02 3 1  ON 12
ci_0014                 1.480516e-02 3 1  ON 13
ci_0015                 1.574766e-02 3 1  ON 14
ci_0016                 1.538632e-02 3 1  ON 15
ci_0017                 1.336745e-02 3 1  ON 16
ci_0018                 1.303906e-02 3 1  ON 17
ci_0019                 1.308950e-02 3 1  ON 18
ci_0020                 1.266839e-02 3 1  ON 19
ci_0021                 6.752770e-03 3 1  ON 20
ci_0022                 7.460538e-03 3 1  ON 21
ci_0023                -1.180403e-02 3 1  ON 22
ci_0024                -1.147023e-02 3 1  ON 23
ci_0025                -2.029570e-03 3 1  ON 24
ci_0026                -2.390747e-03 3 1  ON 25
ci_0027                -1.213155e-02 3 1  ON 26
ci_0028                -1.154912e-02 3 1  ON 27
ci_0029                -1.065832e-02 3 1  ON 28
ci_0030                -1.058734e-02 3 1  ON 29
ci_0031                 1.340907e-02 3 1  ON 30
ci_0032                 1.211459e-02 3 1  ON 31
ci_0033                 7.848177e-03 3 1  ON 32
ci_0034                 8.489627e-03 3 1  ON 33
ci_0035                 4.859421e-03 3 1  ON 34
ci_0036                 4.933671e-03 3 1  ON 35
ci_0037                -1.133359e-02 3 1  ON 36
ci_0038                -1.131343e-02 3 1  ON 37
ci_0039                -4.014992e-03 3 1  ON 38
ci_0040                -3.886155e-03 3 1  ON 39
ci_0041                 9.104242e-03 3 1  ON 40
ci_0042                 8.780957e-03 3 1  ON 41
ci_0043                -1.307372e-02 3 1  ON 42
ci_0044                -1.384583e-02 3 1  ON 43
ci_0045                 1.059118e-02 3 1  ON 44
ci_0046                 1.007868e-02 3 1  ON 45
ci_0047                -3.585075e-03 3 1  ON 46
ci_0048                -3.481623e-03 3 1  ON 47
ci_0049                -2.594629e-03 3 1  ON 48
ci_0050                -2.695910e-03 3 1  ON 49
ci_0051                -1.797585e-03 3 1  ON 50
ci_0052                -2.016123e-03 3 1  ON 51
ci_0053                -3.931436e-03 3 1  ON 52
ci_0054                -3.323922e-03 3 1  ON 53
ci_0055                 2.398828e-03 3 1  ON 54
ci_0056                 2.269778e-03 3 1  ON 55
ci_0057                 2.453986e-03 3 1  ON 56
ci_0058                 2.857281e-03 3 1  ON 57
ci_0059                -3.395815e-03 3 1  ON 58
ci_0060                -3.375888e-03 3 1  ON 59
ci_0061                -3.976504e-03 3 1  ON 60
ci_0062                -3.922365e-03 3 1  ON 61
ci_0063                -9.802580e-03 3 1  ON 62
ci_0064                -9.372600e-03 3 1  ON 63
ci_0065                -6.435479e-03 3 1  ON 64
ci_0066                -6.132151e-03 3 1  ON 65
ci_0067                -3.747986e-03 3 1  ON 66
ci_0068                -3.479531e-03 3 1  ON 67
ci_0069                 3.569219e-03 3 1  ON 68
ci_0070                 3.348549e-03 3 1  ON 69
ci_0071                 3.005272e-03 3 1  ON 70
ci_0072                 3.481734e-03 3 1  ON 71
ci_0073                 3.552587e-03 3 1  ON 72
ci_0074                 3.528871e-03 3 1  ON 73
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 3.9989e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s087 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s087 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=87  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6901e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 87
    time step          = 0.05
    reference energy   = -16.9045
    reference variance = 0.171553
====================================================
  Execution time = 1.4257e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s087
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5224e+04
  VMC Eavg = -1.6900e+01
  VMC Evar = 2.9471e-01
  Total weights = 1.950987335e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 2.6039e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.283891952159
                                         uncertainty =       0.001731269403

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.283891952159
                                         uncertainty =       0.001731269403

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000376771460
  error estimate for blocks of size 2^( 2) =       0.000393808338
  error estimate for blocks of size 2^( 3) =       0.000411239553
  error estimate for blocks of size 2^( 4) =       0.000427542490
  error estimate for blocks of size 2^( 5) =       0.000440151323
  error estimate for blocks of size 2^( 6) =       0.000449882093
  error estimate for blocks of size 2^( 7) =       0.000454807710

      target function =      -0.921003367255
              le_mean =     -16.899684014866
             les_mean =     285.894033390327
             stat err =       0.000443095904
             autocorr =       1.383055070206
   target nu stat err =       0.000443095904
   target dn stat err =       0.002507915528
      target stat err =       0.003979899874
              std dev =       0.532835309344
             le_variance =       0.283913466883


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.689968401487e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 74
Check correct_vf_var_size: 225, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.3235e+07, overlap shift 1.3235e+08 and omega -1.7444e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.921018769086       residual = 1.53e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.921018769090       residual = 3.27e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.921018769091       residual = 6.24e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.921018769091       residual = 2.14e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.921018769091       residual = 9.84e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.921018769091       residual = 3.60e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.921018769091       residual = 2.60e-05           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.921018769091       residual = 8.51e-06           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.921018784205       residual = 6.00e-06           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.921018720558       residual = 9.29e-06           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.921018769091       residual = 5.36e-06           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.921018769091       residual = 1.63e-06           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.921018769091       residual = 6.51e-07           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.921018769091       residual = 2.31e-07           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.921018769091       residual = 7.68e-08           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.921018769091       residual = 2.24e-08           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.921018769091       residual = 5.46e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         16 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 1.3235e+07 is 1.720078e-11

solving harmonic davidson linear method for identity shift 5.2940e+07, overlap shift 5.2940e+08 and omega -1.7444e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.921018769086       residual = 1.53e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.921018769087       residual = 3.27e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.921018769087       residual = 6.24e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.921018769087       residual = 2.14e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.921018769087       residual = 9.84e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.921018769087       residual = 3.60e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.921018769087       residual = 2.60e-05           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.921018769087       residual = 8.51e-06           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.921018821108       residual = 6.00e-06           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.921018769087       residual = 9.29e-06           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.921018769087       residual = 5.36e-06           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.921018633494       residual = 1.63e-06           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.921018705484       residual = 6.51e-07           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.921018769087       residual = 2.31e-07           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.921018694488       residual = 7.69e-08           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.921018769087       residual = 2.24e-08           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.921018769087       residual = 5.45e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         16 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 5.2940e+07 is 4.300194e-12

solving harmonic davidson linear method for identity shift 2.1176e+08, overlap shift 2.1176e+09 and omega -1.7444e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.921018769086       residual = 1.53e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.921018769086       residual = 3.27e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.921018769086       residual = 6.24e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.921018769086       residual = 2.14e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.921018769086       residual = 9.84e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.921018769086       residual = 3.60e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.921018548771       residual = 2.60e-05           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.921018542290       residual = 8.51e-06           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.921018769086       residual = 6.00e-06           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.921018769086       residual = 9.29e-06           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.921018769086       residual = 5.36e-06           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.921018824778       residual = 1.63e-06           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.921019313978       residual = 6.52e-07           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.921018485214       residual = 2.31e-07           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.921018769086       residual = 7.68e-08           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.921018769086       residual = 2.24e-08           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.921018407225       residual = 5.54e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         16 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 2.1176e+08 is 1.075054e-12

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               1.001946 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 75 and numParams is: 74

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.6875e+01
  </log>
  <optVariables href="H2O.s087.opt.xml">
ci_0001                 7.086064e-01 3 1  ON 0
ci_0002                 6.927483e-01 3 1  ON 1
ci_0003                -3.099699e-02 3 1  ON 2
ci_0004                -3.009162e-02 3 1  ON 3
ci_0005                -3.060382e-02 3 1  ON 4
ci_0006                -3.069586e-02 3 1  ON 5
ci_0007                -1.338102e-02 3 1  ON 6
ci_0008                -1.335093e-02 3 1  ON 7
ci_0009                -1.869650e-02 3 1  ON 8
ci_0010                -1.813030e-02 3 1  ON 9
ci_0011                -1.474501e-02 3 1  ON 10
ci_0012                -1.451134e-02 3 1  ON 11
ci_0013                 1.529423e-02 3 1  ON 12
ci_0014                 1.480516e-02 3 1  ON 13
ci_0015                 1.574766e-02 3 1  ON 14
ci_0016                 1.538632e-02 3 1  ON 15
ci_0017                 1.336745e-02 3 1  ON 16
ci_0018                 1.303906e-02 3 1  ON 17
ci_0019                 1.308950e-02 3 1  ON 18
ci_0020                 1.266839e-02 3 1  ON 19
ci_0021                 6.752770e-03 3 1  ON 20
ci_0022                 7.460538e-03 3 1  ON 21
ci_0023                -1.180403e-02 3 1  ON 22
ci_0024                -1.147023e-02 3 1  ON 23
ci_0025                -2.029570e-03 3 1  ON 24
ci_0026                -2.390747e-03 3 1  ON 25
ci_0027                -1.213155e-02 3 1  ON 26
ci_0028                -1.154912e-02 3 1  ON 27
ci_0029                -1.065832e-02 3 1  ON 28
ci_0030                -1.058734e-02 3 1  ON 29
ci_0031                 1.340907e-02 3 1  ON 30
ci_0032                 1.211459e-02 3 1  ON 31
ci_0033                 7.848177e-03 3 1  ON 32
ci_0034                 8.489627e-03 3 1  ON 33
ci_0035                 4.859421e-03 3 1  ON 34
ci_0036                 4.933671e-03 3 1  ON 35
ci_0037                -1.133359e-02 3 1  ON 36
ci_0038                -1.131343e-02 3 1  ON 37
ci_0039                -4.014992e-03 3 1  ON 38
ci_0040                -3.886155e-03 3 1  ON 39
ci_0041                 9.104242e-03 3 1  ON 40
ci_0042                 8.780957e-03 3 1  ON 41
ci_0043                -1.307372e-02 3 1  ON 42
ci_0044                -1.384583e-02 3 1  ON 43
ci_0045                 1.059118e-02 3 1  ON 44
ci_0046                 1.007868e-02 3 1  ON 45
ci_0047                -3.585075e-03 3 1  ON 46
ci_0048                -3.481623e-03 3 1  ON 47
ci_0049                -2.594629e-03 3 1  ON 48
ci_0050                -2.695910e-03 3 1  ON 49
ci_0051                -1.797585e-03 3 1  ON 50
ci_0052                -2.016123e-03 3 1  ON 51
ci_0053                -3.931436e-03 3 1  ON 52
ci_0054                -3.323922e-03 3 1  ON 53
ci_0055                 2.398828e-03 3 1  ON 54
ci_0056                 2.269778e-03 3 1  ON 55
ci_0057                 2.453986e-03 3 1  ON 56
ci_0058                 2.857281e-03 3 1  ON 57
ci_0059                -3.395815e-03 3 1  ON 58
ci_0060                -3.375888e-03 3 1  ON 59
ci_0061                -3.976504e-03 3 1  ON 60
ci_0062                -3.922365e-03 3 1  ON 61
ci_0063                -9.802580e-03 3 1  ON 62
ci_0064                -9.372600e-03 3 1  ON 63
ci_0065                -6.435479e-03 3 1  ON 64
ci_0066                -6.132151e-03 3 1  ON 65
ci_0067                -3.747986e-03 3 1  ON 66
ci_0068                -3.479531e-03 3 1  ON 67
ci_0069                 3.569219e-03 3 1  ON 68
ci_0070                 3.348549e-03 3 1  ON 69
ci_0071                 3.005272e-03 3 1  ON 70
ci_0072                 3.481734e-03 3 1  ON 71
ci_0073                 3.552587e-03 3 1  ON 72
ci_0074                 3.528871e-03 3 1  ON 73
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 87
    time step          = 0.05
    reference energy   = -16.8459
    reference variance = 0.870026
====================================================
  Execution time = 1.3928e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s087
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6899e+01
  VMC Evar = 2.9908e-01
  Total weights = 1.9510e+06
  Execution time = 1.8699e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.283429158254
                                         uncertainty =       0.001826074433

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.283429158254
                                         uncertainty =       0.001826074433

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000376551250
  error estimate for blocks of size 2^( 2) =       0.000393427178
  error estimate for blocks of size 2^( 3) =       0.000410598379
  error estimate for blocks of size 2^( 4) =       0.000425246836
  error estimate for blocks of size 2^( 5) =       0.000436060117
  error estimate for blocks of size 2^( 6) =       0.000442398934
  error estimate for blocks of size 2^( 7) =       0.000446298831

      target function =      -0.914232579532
              le_mean =     -16.899081461356
             les_mean =     285.878031993369
             stat err =       0.000437501179
             autocorr =       1.349926950634
   target nu stat err =       0.000437501179
   target dn stat err =       0.003901986848
      target stat err =       0.006030603769
              std dev =       0.532523885302
             le_variance =       0.283581688417

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.283429158255
                                         uncertainty =       0.001826074433

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.283429158255
                                         uncertainty =       0.001826074433

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000376551250
  error estimate for blocks of size 2^( 2) =       0.000393427178
  error estimate for blocks of size 2^( 3) =       0.000410598379
  error estimate for blocks of size 2^( 4) =       0.000425246836
  error estimate for blocks of size 2^( 5) =       0.000436060117
  error estimate for blocks of size 2^( 6) =       0.000442398934
  error estimate for blocks of size 2^( 7) =       0.000446298831

      target function =      -0.914232579573
              le_mean =     -16.899081461356
             les_mean =     285.878031993341
             stat err =       0.000437501179
             autocorr =       1.349926950618
   target nu stat err =       0.000437501179
   target dn stat err =       0.003901986852
      target stat err =       0.006030603777
              std dev =       0.532523885303
             le_variance =       0.283581688418

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.283429158254
                                         uncertainty =       0.001826074433

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.283429158254
                                         uncertainty =       0.001826074433

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000376551250
  error estimate for blocks of size 2^( 2) =       0.000393427178
  error estimate for blocks of size 2^( 3) =       0.000410598379
  error estimate for blocks of size 2^( 4) =       0.000425246836
  error estimate for blocks of size 2^( 5) =       0.000436060117
  error estimate for blocks of size 2^( 6) =       0.000442398934
  error estimate for blocks of size 2^( 7) =       0.000446298831

      target function =      -0.914232579553
              le_mean =     -16.899081461356
             les_mean =     285.878031993355
             stat err =       0.000437501179
             autocorr =       1.349926950622
   target nu stat err =       0.000437501179
   target dn stat err =       0.003901986850
      target stat err =       0.006030603773
              std dev =       0.532523885302
             le_variance =       0.283581688417

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.283429158254
                                         uncertainty =       0.001826074433

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.283429158254
                                         uncertainty =       0.001826074433

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000376551250
  error estimate for blocks of size 2^( 2) =       0.000393427178
  error estimate for blocks of size 2^( 3) =       0.000410598379
  error estimate for blocks of size 2^( 4) =       0.000425246836
  error estimate for blocks of size 2^( 5) =       0.000436060117
  error estimate for blocks of size 2^( 6) =       0.000442398934
  error estimate for blocks of size 2^( 7) =       0.000446298831

      target function =      -0.914232579534
              le_mean =     -16.899081461356
             les_mean =     285.878031993367
             stat err =       0.000437501179
             autocorr =       1.349926950633
   target nu stat err =       0.000437501179
   target dn stat err =       0.003901986848
      target stat err =       0.006030603770
              std dev =       0.532523885302
             le_variance =       0.283581688417


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.914232579532        initial
     1.3235e+07     1.3235e+08             1.7201e-11        -0.914232579573  <--
     5.2940e+07     5.2940e+08             4.3002e-12        -0.914232579553
     2.1176e+08     2.1176e+09             1.0751e-12        -0.914232579534

*****************************************************************************
Applying the update for shift_i =   1.3235e+07     and shift_s =   1.3235e+08
*****************************************************************************

  Execution time = 2.3390e+01
  </log>
  <optVariables href="H2O.s087.opt.xml">
ci_0001                 7.086064e-01 3 1  ON 0
ci_0002                 6.927483e-01 3 1  ON 1
ci_0003                -3.099699e-02 3 1  ON 2
ci_0004                -3.009162e-02 3 1  ON 3
ci_0005                -3.060382e-02 3 1  ON 4
ci_0006                -3.069586e-02 3 1  ON 5
ci_0007                -1.338102e-02 3 1  ON 6
ci_0008                -1.335093e-02 3 1  ON 7
ci_0009                -1.869650e-02 3 1  ON 8
ci_0010                -1.813030e-02 3 1  ON 9
ci_0011                -1.474501e-02 3 1  ON 10
ci_0012                -1.451134e-02 3 1  ON 11
ci_0013                 1.529423e-02 3 1  ON 12
ci_0014                 1.480516e-02 3 1  ON 13
ci_0015                 1.574766e-02 3 1  ON 14
ci_0016                 1.538632e-02 3 1  ON 15
ci_0017                 1.336745e-02 3 1  ON 16
ci_0018                 1.303906e-02 3 1  ON 17
ci_0019                 1.308950e-02 3 1  ON 18
ci_0020                 1.266839e-02 3 1  ON 19
ci_0021                 6.752770e-03 3 1  ON 20
ci_0022                 7.460538e-03 3 1  ON 21
ci_0023                -1.180403e-02 3 1  ON 22
ci_0024                -1.147023e-02 3 1  ON 23
ci_0025                -2.029570e-03 3 1  ON 24
ci_0026                -2.390747e-03 3 1  ON 25
ci_0027                -1.213155e-02 3 1  ON 26
ci_0028                -1.154912e-02 3 1  ON 27
ci_0029                -1.065832e-02 3 1  ON 28
ci_0030                -1.058734e-02 3 1  ON 29
ci_0031                 1.340907e-02 3 1  ON 30
ci_0032                 1.211459e-02 3 1  ON 31
ci_0033                 7.848177e-03 3 1  ON 32
ci_0034                 8.489627e-03 3 1  ON 33
ci_0035                 4.859421e-03 3 1  ON 34
ci_0036                 4.933671e-03 3 1  ON 35
ci_0037                -1.133359e-02 3 1  ON 36
ci_0038                -1.131343e-02 3 1  ON 37
ci_0039                -4.014992e-03 3 1  ON 38
ci_0040                -3.886155e-03 3 1  ON 39
ci_0041                 9.104242e-03 3 1  ON 40
ci_0042                 8.780957e-03 3 1  ON 41
ci_0043                -1.307372e-02 3 1  ON 42
ci_0044                -1.384583e-02 3 1  ON 43
ci_0045                 1.059118e-02 3 1  ON 44
ci_0046                 1.007868e-02 3 1  ON 45
ci_0047                -3.585075e-03 3 1  ON 46
ci_0048                -3.481623e-03 3 1  ON 47
ci_0049                -2.594629e-03 3 1  ON 48
ci_0050                -2.695910e-03 3 1  ON 49
ci_0051                -1.797585e-03 3 1  ON 50
ci_0052                -2.016123e-03 3 1  ON 51
ci_0053                -3.931436e-03 3 1  ON 52
ci_0054                -3.323922e-03 3 1  ON 53
ci_0055                 2.398828e-03 3 1  ON 54
ci_0056                 2.269778e-03 3 1  ON 55
ci_0057                 2.453986e-03 3 1  ON 56
ci_0058                 2.857281e-03 3 1  ON 57
ci_0059                -3.395815e-03 3 1  ON 58
ci_0060                -3.375888e-03 3 1  ON 59
ci_0061                -3.976504e-03 3 1  ON 60
ci_0062                -3.922365e-03 3 1  ON 61
ci_0063                -9.802580e-03 3 1  ON 62
ci_0064                -9.372600e-03 3 1  ON 63
ci_0065                -6.435479e-03 3 1  ON 64
ci_0066                -6.132151e-03 3 1  ON 65
ci_0067                -3.747986e-03 3 1  ON 66
ci_0068                -3.479531e-03 3 1  ON 67
ci_0069                 3.569219e-03 3 1  ON 68
ci_0070                 3.348549e-03 3 1  ON 69
ci_0071                 3.005272e-03 3 1  ON 70
ci_0072                 3.481734e-03 3 1  ON 71
ci_0073                 3.552587e-03 3 1  ON 72
ci_0074                 3.528871e-03 3 1  ON 73
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 4.0270e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s088 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s088 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=88  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6901e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 88
    time step          = 0.05
    reference energy   = -16.9617
    reference variance = 0.524772
====================================================
  Execution time = 1.4267e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s088
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5234e+04
  VMC Eavg = -1.6897e+01
  VMC Evar = 2.9159e-01
  Total weights = 1.951025662e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 2.5894e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.282421594293
                                         uncertainty =       0.001741336684

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.282421594293
                                         uncertainty =       0.001741336684

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000375749375
  error estimate for blocks of size 2^( 2) =       0.000392799050
  error estimate for blocks of size 2^( 3) =       0.000410126122
  error estimate for blocks of size 2^( 4) =       0.000424950980
  error estimate for blocks of size 2^( 5) =       0.000436362735
  error estimate for blocks of size 2^( 6) =       0.000443660125
  error estimate for blocks of size 2^( 7) =       0.000448485866

      target function =      -0.925864134647
              le_mean =     -16.897333239511
             les_mean =     285.811455987997
             stat err =       0.000438364927
             autocorr =       1.361053087593
   target nu stat err =       0.000438364927
   target dn stat err =       0.002503852345
      target stat err =       0.003996225010
              std dev =       0.531389862082
             le_variance =       0.282375185524


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.689733323951e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 74
Check correct_vf_var_size: 225, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 3.3087e+06, overlap shift 3.3087e+07 and omega -1.7444e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.925880009034       residual = 8.35e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.925880009045       residual = 1.57e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.925880009047       residual = 3.13e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.925880009049       residual = 1.19e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.925880009063       residual = 4.91e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.925880014825       residual = 4.17e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.925880007957       residual = 2.80e-05           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.925880012280       residual = 1.96e-05           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.925880011880       residual = 2.16e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.925880004870       residual = 1.23e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.925880009211       residual = 5.02e-06           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.925880001468       residual = 1.50e-06           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.925880010757       residual = 1.01e-06           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.925880002315       residual = 2.31e-07           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.925880008726       residual = 6.32e-08           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.925880007769       residual = 1.53e-08           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.925880006308       residual = 3.18e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         16 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 3.3087e+06 is 9.034624e-11

solving harmonic davidson linear method for identity shift 1.3235e+07, overlap shift 1.3235e+08 and omega -1.7444e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.925880009034       residual = 8.35e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.925880009037       residual = 1.57e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.925880009038       residual = 3.13e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.925880009045       residual = 1.19e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.925880004376       residual = 4.91e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.925880027839       residual = 4.17e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.925880009301       residual = 2.80e-05           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.925880016382       residual = 1.96e-05           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.925880031150       residual = 2.16e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.925879990321       residual = 1.23e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.925879984806       residual = 5.02e-06           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.925880013942       residual = 1.50e-06           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.925879971192       residual = 1.01e-06           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.925880031787       residual = 2.31e-07           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.925879988591       residual = 6.32e-08           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.925880029276       residual = 1.53e-08           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.925880013193       residual = 3.18e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         16 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 1.3235e+07 is 2.258648e-11

solving harmonic davidson linear method for identity shift 5.2940e+07, overlap shift 5.2940e+08 and omega -1.7444e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.925880009034       residual = 8.35e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.925880009035       residual = 1.57e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.925880009035       residual = 3.13e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.925880009035       residual = 1.19e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.925880010005       residual = 4.91e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.925880009035       residual = 4.17e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.925879964593       residual = 2.80e-05           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.925879919509       residual = 1.96e-05           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.925879954006       residual = 2.16e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.925879998752       residual = 1.23e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.925880001905       residual = 5.02e-06           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.925880054297       residual = 1.50e-06           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.925879919992       residual = 1.01e-06           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.925880044959       residual = 2.31e-07           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.925880001313       residual = 6.32e-08           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.925879938507       residual = 1.52e-08           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.925879854943       residual = 3.17e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         16 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 5.2940e+07 is 5.646304e-12

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               1.010900 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 75 and numParams is: 74

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.6871e+01
  </log>
  <optVariables href="H2O.s088.opt.xml">
ci_0001                 7.086064e-01 3 1  ON 0
ci_0002                 6.927483e-01 3 1  ON 1
ci_0003                -3.099699e-02 3 1  ON 2
ci_0004                -3.009162e-02 3 1  ON 3
ci_0005                -3.060382e-02 3 1  ON 4
ci_0006                -3.069586e-02 3 1  ON 5
ci_0007                -1.338102e-02 3 1  ON 6
ci_0008                -1.335093e-02 3 1  ON 7
ci_0009                -1.869650e-02 3 1  ON 8
ci_0010                -1.813030e-02 3 1  ON 9
ci_0011                -1.474501e-02 3 1  ON 10
ci_0012                -1.451134e-02 3 1  ON 11
ci_0013                 1.529423e-02 3 1  ON 12
ci_0014                 1.480516e-02 3 1  ON 13
ci_0015                 1.574766e-02 3 1  ON 14
ci_0016                 1.538632e-02 3 1  ON 15
ci_0017                 1.336745e-02 3 1  ON 16
ci_0018                 1.303906e-02 3 1  ON 17
ci_0019                 1.308950e-02 3 1  ON 18
ci_0020                 1.266839e-02 3 1  ON 19
ci_0021                 6.752770e-03 3 1  ON 20
ci_0022                 7.460538e-03 3 1  ON 21
ci_0023                -1.180403e-02 3 1  ON 22
ci_0024                -1.147023e-02 3 1  ON 23
ci_0025                -2.029570e-03 3 1  ON 24
ci_0026                -2.390747e-03 3 1  ON 25
ci_0027                -1.213155e-02 3 1  ON 26
ci_0028                -1.154912e-02 3 1  ON 27
ci_0029                -1.065832e-02 3 1  ON 28
ci_0030                -1.058734e-02 3 1  ON 29
ci_0031                 1.340906e-02 3 1  ON 30
ci_0032                 1.211459e-02 3 1  ON 31
ci_0033                 7.848177e-03 3 1  ON 32
ci_0034                 8.489627e-03 3 1  ON 33
ci_0035                 4.859421e-03 3 1  ON 34
ci_0036                 4.933671e-03 3 1  ON 35
ci_0037                -1.133359e-02 3 1  ON 36
ci_0038                -1.131343e-02 3 1  ON 37
ci_0039                -4.014992e-03 3 1  ON 38
ci_0040                -3.886155e-03 3 1  ON 39
ci_0041                 9.104242e-03 3 1  ON 40
ci_0042                 8.780957e-03 3 1  ON 41
ci_0043                -1.307372e-02 3 1  ON 42
ci_0044                -1.384583e-02 3 1  ON 43
ci_0045                 1.059118e-02 3 1  ON 44
ci_0046                 1.007868e-02 3 1  ON 45
ci_0047                -3.585075e-03 3 1  ON 46
ci_0048                -3.481623e-03 3 1  ON 47
ci_0049                -2.594629e-03 3 1  ON 48
ci_0050                -2.695910e-03 3 1  ON 49
ci_0051                -1.797585e-03 3 1  ON 50
ci_0052                -2.016123e-03 3 1  ON 51
ci_0053                -3.931436e-03 3 1  ON 52
ci_0054                -3.323922e-03 3 1  ON 53
ci_0055                 2.398828e-03 3 1  ON 54
ci_0056                 2.269778e-03 3 1  ON 55
ci_0057                 2.453986e-03 3 1  ON 56
ci_0058                 2.857281e-03 3 1  ON 57
ci_0059                -3.395815e-03 3 1  ON 58
ci_0060                -3.375888e-03 3 1  ON 59
ci_0061                -3.976504e-03 3 1  ON 60
ci_0062                -3.922365e-03 3 1  ON 61
ci_0063                -9.802580e-03 3 1  ON 62
ci_0064                -9.372600e-03 3 1  ON 63
ci_0065                -6.435479e-03 3 1  ON 64
ci_0066                -6.132151e-03 3 1  ON 65
ci_0067                -3.747986e-03 3 1  ON 66
ci_0068                -3.479531e-03 3 1  ON 67
ci_0069                 3.569219e-03 3 1  ON 68
ci_0070                 3.348549e-03 3 1  ON 69
ci_0071                 3.005272e-03 3 1  ON 70
ci_0072                 3.481734e-03 3 1  ON 71
ci_0073                 3.552587e-03 3 1  ON 72
ci_0074                 3.528871e-03 3 1  ON 73
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 88
    time step          = 0.05
    reference energy   = -16.8049
    reference variance = 0.145243
====================================================
  Execution time = 1.3727e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s088
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6899e+01
  VMC Evar = 2.9963e-01
  Total weights = 1.9514e+06
  Execution time = 1.8745e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.288480532070
                                         uncertainty =       0.004888910296

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.288480532070
                                         uncertainty =       0.004888910296

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000379808509
  error estimate for blocks of size 2^( 2) =       0.000396400135
  error estimate for blocks of size 2^( 3) =       0.000413665076
  error estimate for blocks of size 2^( 4) =       0.000428682021
  error estimate for blocks of size 2^( 5) =       0.000440519414
  error estimate for blocks of size 2^( 6) =       0.000447996486
  error estimate for blocks of size 2^( 7) =       0.000449567168

      target function =      -0.913358417992
              le_mean =     -16.898589220646
             les_mean =     285.861946011123
             stat err =       0.000441691272
             autocorr =       1.352409630923
   target nu stat err =       0.000441691272
   target dn stat err =       0.005317752313
      target stat err =       0.008168506586
              std dev =       0.537130344570
             le_variance =       0.288509007058

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.288480531817
                                         uncertainty =       0.004888910076

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.288480531817
                                         uncertainty =       0.004888910076

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000379808509
  error estimate for blocks of size 2^( 2) =       0.000396400135
  error estimate for blocks of size 2^( 3) =       0.000413665076
  error estimate for blocks of size 2^( 4) =       0.000428682021
  error estimate for blocks of size 2^( 5) =       0.000440519414
  error estimate for blocks of size 2^( 6) =       0.000447996486
  error estimate for blocks of size 2^( 7) =       0.000449567167

      target function =      -0.913358418370
              le_mean =     -16.898589220645
             les_mean =     285.861946010845
             stat err =       0.000441691272
             autocorr =       1.352409631253
   target nu stat err =       0.000441691272
   target dn stat err =       0.005317752092
      target stat err =       0.008168506255
              std dev =       0.537130344335
             le_variance =       0.288509006805

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.288480531944
                                         uncertainty =       0.004888910186

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.288480531944
                                         uncertainty =       0.004888910186

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000379808509
  error estimate for blocks of size 2^( 2) =       0.000396400135
  error estimate for blocks of size 2^( 3) =       0.000413665076
  error estimate for blocks of size 2^( 4) =       0.000428682021
  error estimate for blocks of size 2^( 5) =       0.000440519414
  error estimate for blocks of size 2^( 6) =       0.000447996486
  error estimate for blocks of size 2^( 7) =       0.000449567168

      target function =      -0.913358418181
              le_mean =     -16.898589220646
             les_mean =     285.861946010984
             stat err =       0.000441691272
             autocorr =       1.352409631083
   target nu stat err =       0.000441691272
   target dn stat err =       0.005317752203
      target stat err =       0.008168506421
              std dev =       0.537130344452
             le_variance =       0.288509006931

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.288480532055
                                         uncertainty =       0.004888910283

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.288480532055
                                         uncertainty =       0.004888910283

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000379808509
  error estimate for blocks of size 2^( 2) =       0.000396400135
  error estimate for blocks of size 2^( 3) =       0.000413665076
  error estimate for blocks of size 2^( 4) =       0.000428682021
  error estimate for blocks of size 2^( 5) =       0.000440519414
  error estimate for blocks of size 2^( 6) =       0.000447996486
  error estimate for blocks of size 2^( 7) =       0.000449567168

      target function =      -0.913358418016
              le_mean =     -16.898589220646
             les_mean =     285.861946011105
             stat err =       0.000441691272
             autocorr =       1.352409630947
   target nu stat err =       0.000441691272
   target dn stat err =       0.005317752299
      target stat err =       0.008168506565
              std dev =       0.537130344555
             le_variance =       0.288509007042


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.913358417992        initial
     3.3087e+06     3.3087e+07             9.0346e-11        -0.913358418370  <--
     1.3235e+07     1.3235e+08             2.2586e-11        -0.913358418181
     5.2940e+07     5.2940e+08             5.6463e-12        -0.913358418016

*****************************************************************************
Applying the update for shift_i =   3.3087e+06     and shift_s =   3.3087e+07
*****************************************************************************

  Execution time = 2.3145e+01
  </log>
  <optVariables href="H2O.s088.opt.xml">
ci_0001                 7.086064e-01 3 1  ON 0
ci_0002                 6.927483e-01 3 1  ON 1
ci_0003                -3.099699e-02 3 1  ON 2
ci_0004                -3.009162e-02 3 1  ON 3
ci_0005                -3.060382e-02 3 1  ON 4
ci_0006                -3.069586e-02 3 1  ON 5
ci_0007                -1.338102e-02 3 1  ON 6
ci_0008                -1.335093e-02 3 1  ON 7
ci_0009                -1.869650e-02 3 1  ON 8
ci_0010                -1.813030e-02 3 1  ON 9
ci_0011                -1.474501e-02 3 1  ON 10
ci_0012                -1.451134e-02 3 1  ON 11
ci_0013                 1.529423e-02 3 1  ON 12
ci_0014                 1.480516e-02 3 1  ON 13
ci_0015                 1.574766e-02 3 1  ON 14
ci_0016                 1.538632e-02 3 1  ON 15
ci_0017                 1.336745e-02 3 1  ON 16
ci_0018                 1.303906e-02 3 1  ON 17
ci_0019                 1.308950e-02 3 1  ON 18
ci_0020                 1.266839e-02 3 1  ON 19
ci_0021                 6.752770e-03 3 1  ON 20
ci_0022                 7.460538e-03 3 1  ON 21
ci_0023                -1.180403e-02 3 1  ON 22
ci_0024                -1.147023e-02 3 1  ON 23
ci_0025                -2.029570e-03 3 1  ON 24
ci_0026                -2.390747e-03 3 1  ON 25
ci_0027                -1.213155e-02 3 1  ON 26
ci_0028                -1.154912e-02 3 1  ON 27
ci_0029                -1.065832e-02 3 1  ON 28
ci_0030                -1.058734e-02 3 1  ON 29
ci_0031                 1.340906e-02 3 1  ON 30
ci_0032                 1.211459e-02 3 1  ON 31
ci_0033                 7.848177e-03 3 1  ON 32
ci_0034                 8.489627e-03 3 1  ON 33
ci_0035                 4.859421e-03 3 1  ON 34
ci_0036                 4.933671e-03 3 1  ON 35
ci_0037                -1.133359e-02 3 1  ON 36
ci_0038                -1.131343e-02 3 1  ON 37
ci_0039                -4.014992e-03 3 1  ON 38
ci_0040                -3.886155e-03 3 1  ON 39
ci_0041                 9.104242e-03 3 1  ON 40
ci_0042                 8.780957e-03 3 1  ON 41
ci_0043                -1.307372e-02 3 1  ON 42
ci_0044                -1.384583e-02 3 1  ON 43
ci_0045                 1.059118e-02 3 1  ON 44
ci_0046                 1.007868e-02 3 1  ON 45
ci_0047                -3.585075e-03 3 1  ON 46
ci_0048                -3.481623e-03 3 1  ON 47
ci_0049                -2.594629e-03 3 1  ON 48
ci_0050                -2.695910e-03 3 1  ON 49
ci_0051                -1.797585e-03 3 1  ON 50
ci_0052                -2.016123e-03 3 1  ON 51
ci_0053                -3.931436e-03 3 1  ON 52
ci_0054                -3.323922e-03 3 1  ON 53
ci_0055                 2.398828e-03 3 1  ON 54
ci_0056                 2.269778e-03 3 1  ON 55
ci_0057                 2.453986e-03 3 1  ON 56
ci_0058                 2.857281e-03 3 1  ON 57
ci_0059                -3.395815e-03 3 1  ON 58
ci_0060                -3.375888e-03 3 1  ON 59
ci_0061                -3.976504e-03 3 1  ON 60
ci_0062                -3.922365e-03 3 1  ON 61
ci_0063                -9.802580e-03 3 1  ON 62
ci_0064                -9.372600e-03 3 1  ON 63
ci_0065                -6.435479e-03 3 1  ON 64
ci_0066                -6.132151e-03 3 1  ON 65
ci_0067                -3.747986e-03 3 1  ON 66
ci_0068                -3.479531e-03 3 1  ON 67
ci_0069                 3.569219e-03 3 1  ON 68
ci_0070                 3.348549e-03 3 1  ON 69
ci_0071                 3.005272e-03 3 1  ON 70
ci_0072                 3.481734e-03 3 1  ON 71
ci_0073                 3.552587e-03 3 1  ON 72
ci_0074                 3.528871e-03 3 1  ON 73
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 4.0541e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s089 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s089 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=89  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6900e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 89
    time step          = 0.05
    reference energy   = -16.8084
    reference variance = 0.179354
====================================================
  Execution time = 1.4356e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s089
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5254e+04
  VMC Eavg = -1.6898e+01
  VMC Evar = 2.8795e-01
  Total weights = 1.951011340e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 2.5943e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.280066234380
                                         uncertainty =       0.001596574896

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.280066234380
                                         uncertainty =       0.001596574896

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000374205765
  error estimate for blocks of size 2^( 2) =       0.000391036044
  error estimate for blocks of size 2^( 3) =       0.000408249326
  error estimate for blocks of size 2^( 4) =       0.000423439787
  error estimate for blocks of size 2^( 5) =       0.000435198022
  error estimate for blocks of size 2^( 6) =       0.000442479651
  error estimate for blocks of size 2^( 7) =       0.000448575127

      target function =      -0.931648609693
              le_mean =     -16.898427682608
             les_mean =     285.844803637321
             stat err =       0.000437423147
             autocorr =       1.366414849981
   target nu stat err =       0.000437423147
   target dn stat err =       0.001781830572
      target stat err =       0.002931783480
              std dev =       0.529206867781
             le_variance =       0.280059908906


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.689842768261e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 74
Check correct_vf_var_size: 225, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 8.2718e+05, overlap shift 8.2718e+06 and omega -1.7444e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.931656405652       residual = 8.19e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.931656405686       residual = 1.32e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.931656405692       residual = 2.35e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.931656405695       residual = 8.01e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.931656405696       residual = 4.19e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.931656407340       residual = 1.62e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.931656405487       residual = 5.56e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.931656404738       residual = 1.23e-06           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.931656406935       residual = 4.05e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.931656405112       residual = 1.35e-07           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.931656405063       residual = 1.18e-07           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.931656406294       residual = 6.28e-08           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.931656404689       residual = 6.13e-08           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.931656406133       residual = 4.22e-08           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.931656404830       residual = 2.84e-08           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.931656405895       residual = 7.83e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         15 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 8.2718e+05 is 1.428608e-10

solving harmonic davidson linear method for identity shift 3.3087e+06, overlap shift 3.3087e+07 and omega -1.7444e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.931656405652       residual = 8.19e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.931656405660       residual = 1.32e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.931656405662       residual = 2.35e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.931656406467       residual = 8.01e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.931656406686       residual = 4.19e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.931656403548       residual = 1.62e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.931656401133       residual = 5.56e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.931656406933       residual = 1.23e-06           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.931656403236       residual = 4.05e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.931656404826       residual = 1.35e-07           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.931656412222       residual = 1.18e-07           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.931656397273       residual = 6.28e-08           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.931656402320       residual = 6.13e-08           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.931656401606       residual = 4.22e-08           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.931656402543       residual = 2.84e-08           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.931656410483       residual = 7.83e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         15 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 3.3087e+06 is 3.571522e-11

solving harmonic davidson linear method for identity shift 1.3235e+07, overlap shift 1.3235e+08 and omega -1.7444e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.931656405652       residual = 8.19e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.931656405654       residual = 1.32e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.931656405654       residual = 2.35e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.931656405654       residual = 8.01e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.931656398076       residual = 4.19e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.931656405811       residual = 1.62e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.931656402031       residual = 5.56e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.931656395687       residual = 1.23e-06           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.931656419805       residual = 4.05e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.931656407447       residual = 1.35e-07           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.931656399645       residual = 1.18e-07           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.931656445196       residual = 6.29e-08           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.931656417299       residual = 6.13e-08           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.931656419652       residual = 4.21e-08           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.931656391599       residual = 2.84e-08           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.931656423692       residual = 7.82e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         15 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 1.3235e+07 is 8.928808e-12

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               1.019000 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 75 and numParams is: 74

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.6963e+01
  </log>
  <optVariables href="H2O.s089.opt.xml">
ci_0001                 7.086064e-01 3 1  ON 0
ci_0002                 6.927483e-01 3 1  ON 1
ci_0003                -3.099699e-02 3 1  ON 2
ci_0004                -3.009162e-02 3 1  ON 3
ci_0005                -3.060382e-02 3 1  ON 4
ci_0006                -3.069586e-02 3 1  ON 5
ci_0007                -1.338102e-02 3 1  ON 6
ci_0008                -1.335093e-02 3 1  ON 7
ci_0009                -1.869650e-02 3 1  ON 8
ci_0010                -1.813030e-02 3 1  ON 9
ci_0011                -1.474501e-02 3 1  ON 10
ci_0012                -1.451134e-02 3 1  ON 11
ci_0013                 1.529423e-02 3 1  ON 12
ci_0014                 1.480516e-02 3 1  ON 13
ci_0015                 1.574766e-02 3 1  ON 14
ci_0016                 1.538632e-02 3 1  ON 15
ci_0017                 1.336745e-02 3 1  ON 16
ci_0018                 1.303906e-02 3 1  ON 17
ci_0019                 1.308950e-02 3 1  ON 18
ci_0020                 1.266839e-02 3 1  ON 19
ci_0021                 6.752770e-03 3 1  ON 20
ci_0022                 7.460538e-03 3 1  ON 21
ci_0023                -1.180403e-02 3 1  ON 22
ci_0024                -1.147023e-02 3 1  ON 23
ci_0025                -2.029570e-03 3 1  ON 24
ci_0026                -2.390747e-03 3 1  ON 25
ci_0027                -1.213155e-02 3 1  ON 26
ci_0028                -1.154912e-02 3 1  ON 27
ci_0029                -1.065832e-02 3 1  ON 28
ci_0030                -1.058734e-02 3 1  ON 29
ci_0031                 1.340906e-02 3 1  ON 30
ci_0032                 1.211459e-02 3 1  ON 31
ci_0033                 7.848177e-03 3 1  ON 32
ci_0034                 8.489627e-03 3 1  ON 33
ci_0035                 4.859421e-03 3 1  ON 34
ci_0036                 4.933671e-03 3 1  ON 35
ci_0037                -1.133359e-02 3 1  ON 36
ci_0038                -1.131343e-02 3 1  ON 37
ci_0039                -4.014992e-03 3 1  ON 38
ci_0040                -3.886155e-03 3 1  ON 39
ci_0041                 9.104242e-03 3 1  ON 40
ci_0042                 8.780957e-03 3 1  ON 41
ci_0043                -1.307372e-02 3 1  ON 42
ci_0044                -1.384583e-02 3 1  ON 43
ci_0045                 1.059118e-02 3 1  ON 44
ci_0046                 1.007868e-02 3 1  ON 45
ci_0047                -3.585075e-03 3 1  ON 46
ci_0048                -3.481623e-03 3 1  ON 47
ci_0049                -2.594629e-03 3 1  ON 48
ci_0050                -2.695910e-03 3 1  ON 49
ci_0051                -1.797585e-03 3 1  ON 50
ci_0052                -2.016123e-03 3 1  ON 51
ci_0053                -3.931436e-03 3 1  ON 52
ci_0054                -3.323922e-03 3 1  ON 53
ci_0055                 2.398828e-03 3 1  ON 54
ci_0056                 2.269778e-03 3 1  ON 55
ci_0057                 2.453986e-03 3 1  ON 56
ci_0058                 2.857281e-03 3 1  ON 57
ci_0059                -3.395815e-03 3 1  ON 58
ci_0060                -3.375888e-03 3 1  ON 59
ci_0061                -3.976504e-03 3 1  ON 60
ci_0062                -3.922365e-03 3 1  ON 61
ci_0063                -9.802580e-03 3 1  ON 62
ci_0064                -9.372600e-03 3 1  ON 63
ci_0065                -6.435479e-03 3 1  ON 64
ci_0066                -6.132151e-03 3 1  ON 65
ci_0067                -3.747986e-03 3 1  ON 66
ci_0068                -3.479531e-03 3 1  ON 67
ci_0069                 3.569219e-03 3 1  ON 68
ci_0070                 3.348549e-03 3 1  ON 69
ci_0071                 3.005272e-03 3 1  ON 70
ci_0072                 3.481734e-03 3 1  ON 71
ci_0073                 3.552587e-03 3 1  ON 72
ci_0074                 3.528871e-03 3 1  ON 73
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 89
    time step          = 0.05
    reference energy   = -16.9186
    reference variance = 0.155305
====================================================
  Execution time = 1.3882e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s089
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6897e+01
  VMC Evar = 2.9561e-01
  Total weights = 1.9506e+06
  Execution time = 1.8663e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.284938385122
                                         uncertainty =       0.002120090545

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.284938385122
                                         uncertainty =       0.002120090545

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000377444543
  error estimate for blocks of size 2^( 2) =       0.000394632250
  error estimate for blocks of size 2^( 3) =       0.000412129764
  error estimate for blocks of size 2^( 4) =       0.000427607505
  error estimate for blocks of size 2^( 5) =       0.000439756514
  error estimate for blocks of size 2^( 6) =       0.000449040516
  error estimate for blocks of size 2^( 7) =       0.000452191003

      target function =      -0.919584682666
              le_mean =     -16.897325035612
             les_mean =     285.815207083080
             stat err =       0.000442148885
             autocorr =       1.372242182342
   target nu stat err =       0.000442148885
   target dn stat err =       0.002865438010
      target stat err =       0.004494873823
              std dev =       0.533787192256
             le_variance =       0.284928766617

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.284938385105
                                         uncertainty =       0.002120090546

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.284938385105
                                         uncertainty =       0.002120090546

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000377444543
  error estimate for blocks of size 2^( 2) =       0.000394632250
  error estimate for blocks of size 2^( 3) =       0.000412129764
  error estimate for blocks of size 2^( 4) =       0.000427607505
  error estimate for blocks of size 2^( 5) =       0.000439756514
  error estimate for blocks of size 2^( 6) =       0.000449040516
  error estimate for blocks of size 2^( 7) =       0.000452191003

      target function =      -0.919584682470
              le_mean =     -16.897325035613
             les_mean =     285.815207083221
             stat err =       0.000442148885
             autocorr =       1.372242182253
   target nu stat err =       0.000442148885
   target dn stat err =       0.002865438041
      target stat err =       0.004494873868
              std dev =       0.533787192241
             le_variance =       0.284928766600

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.284938385114
                                         uncertainty =       0.002120090545

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.284938385114
                                         uncertainty =       0.002120090545

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000377444543
  error estimate for blocks of size 2^( 2) =       0.000394632250
  error estimate for blocks of size 2^( 3) =       0.000412129764
  error estimate for blocks of size 2^( 4) =       0.000427607505
  error estimate for blocks of size 2^( 5) =       0.000439756514
  error estimate for blocks of size 2^( 6) =       0.000449040516
  error estimate for blocks of size 2^( 7) =       0.000452191003

      target function =      -0.919584682568
              le_mean =     -16.897325035612
             les_mean =     285.815207083150
             stat err =       0.000442148885
             autocorr =       1.372242182295
   target nu stat err =       0.000442148885
   target dn stat err =       0.002865438025
      target stat err =       0.004494873845
              std dev =       0.533787192249
             le_variance =       0.284928766609

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.284938385121
                                         uncertainty =       0.002120090545

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.284938385121
                                         uncertainty =       0.002120090545

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000377444543
  error estimate for blocks of size 2^( 2) =       0.000394632250
  error estimate for blocks of size 2^( 3) =       0.000412129764
  error estimate for blocks of size 2^( 4) =       0.000427607505
  error estimate for blocks of size 2^( 5) =       0.000439756514
  error estimate for blocks of size 2^( 6) =       0.000449040516
  error estimate for blocks of size 2^( 7) =       0.000452191003

      target function =      -0.919584682654
              le_mean =     -16.897325035612
             les_mean =     285.815207083089
             stat err =       0.000442148885
             autocorr =       1.372242182333
   target nu stat err =       0.000442148885
   target dn stat err =       0.002865438011
      target stat err =       0.004494873825
              std dev =       0.533787192256
             le_variance =       0.284928766616


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.919584682666        initial  <--
     8.2718e+05     8.2718e+06             1.4286e-10        -0.919584682470
     3.3087e+06     3.3087e+07             3.5715e-11        -0.919584682568
     1.3235e+07     1.3235e+08             8.9288e-12        -0.919584682654

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 23.4614
  </log>
  <optVariables href="H2O.s089.opt.xml">
ci_0001                 7.086064e-01 3 1  ON 0
ci_0002                 6.927483e-01 3 1  ON 1
ci_0003                -3.099699e-02 3 1  ON 2
ci_0004                -3.009162e-02 3 1  ON 3
ci_0005                -3.060382e-02 3 1  ON 4
ci_0006                -3.069586e-02 3 1  ON 5
ci_0007                -1.338102e-02 3 1  ON 6
ci_0008                -1.335093e-02 3 1  ON 7
ci_0009                -1.869650e-02 3 1  ON 8
ci_0010                -1.813030e-02 3 1  ON 9
ci_0011                -1.474501e-02 3 1  ON 10
ci_0012                -1.451134e-02 3 1  ON 11
ci_0013                 1.529423e-02 3 1  ON 12
ci_0014                 1.480516e-02 3 1  ON 13
ci_0015                 1.574766e-02 3 1  ON 14
ci_0016                 1.538632e-02 3 1  ON 15
ci_0017                 1.336745e-02 3 1  ON 16
ci_0018                 1.303906e-02 3 1  ON 17
ci_0019                 1.308950e-02 3 1  ON 18
ci_0020                 1.266839e-02 3 1  ON 19
ci_0021                 6.752770e-03 3 1  ON 20
ci_0022                 7.460538e-03 3 1  ON 21
ci_0023                -1.180403e-02 3 1  ON 22
ci_0024                -1.147023e-02 3 1  ON 23
ci_0025                -2.029570e-03 3 1  ON 24
ci_0026                -2.390747e-03 3 1  ON 25
ci_0027                -1.213155e-02 3 1  ON 26
ci_0028                -1.154912e-02 3 1  ON 27
ci_0029                -1.065832e-02 3 1  ON 28
ci_0030                -1.058734e-02 3 1  ON 29
ci_0031                 1.340906e-02 3 1  ON 30
ci_0032                 1.211459e-02 3 1  ON 31
ci_0033                 7.848177e-03 3 1  ON 32
ci_0034                 8.489627e-03 3 1  ON 33
ci_0035                 4.859421e-03 3 1  ON 34
ci_0036                 4.933671e-03 3 1  ON 35
ci_0037                -1.133359e-02 3 1  ON 36
ci_0038                -1.131343e-02 3 1  ON 37
ci_0039                -4.014992e-03 3 1  ON 38
ci_0040                -3.886155e-03 3 1  ON 39
ci_0041                 9.104242e-03 3 1  ON 40
ci_0042                 8.780957e-03 3 1  ON 41
ci_0043                -1.307372e-02 3 1  ON 42
ci_0044                -1.384583e-02 3 1  ON 43
ci_0045                 1.059118e-02 3 1  ON 44
ci_0046                 1.007868e-02 3 1  ON 45
ci_0047                -3.585075e-03 3 1  ON 46
ci_0048                -3.481623e-03 3 1  ON 47
ci_0049                -2.594629e-03 3 1  ON 48
ci_0050                -2.695910e-03 3 1  ON 49
ci_0051                -1.797585e-03 3 1  ON 50
ci_0052                -2.016123e-03 3 1  ON 51
ci_0053                -3.931436e-03 3 1  ON 52
ci_0054                -3.323922e-03 3 1  ON 53
ci_0055                 2.398828e-03 3 1  ON 54
ci_0056                 2.269778e-03 3 1  ON 55
ci_0057                 2.453986e-03 3 1  ON 56
ci_0058                 2.857281e-03 3 1  ON 57
ci_0059                -3.395815e-03 3 1  ON 58
ci_0060                -3.375888e-03 3 1  ON 59
ci_0061                -3.976504e-03 3 1  ON 60
ci_0062                -3.922365e-03 3 1  ON 61
ci_0063                -9.802580e-03 3 1  ON 62
ci_0064                -9.372600e-03 3 1  ON 63
ci_0065                -6.435479e-03 3 1  ON 64
ci_0066                -6.132151e-03 3 1  ON 65
ci_0067                -3.747986e-03 3 1  ON 66
ci_0068                -3.479531e-03 3 1  ON 67
ci_0069                 3.569219e-03 3 1  ON 68
ci_0070                 3.348549e-03 3 1  ON 69
ci_0071                 3.005272e-03 3 1  ON 70
ci_0072                 3.481734e-03 3 1  ON 71
ci_0073                 3.552587e-03 3 1  ON 72
ci_0074                 3.528871e-03 3 1  ON 73
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 4.0430e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s090 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s090 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=90  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6900e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 90
    time step          = 0.05
    reference energy   = -16.9255
    reference variance = 0.250986
====================================================
  Execution time = 1.4225e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s090
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5232e+04
  VMC Eavg = -1.6899e+01
  VMC Evar = 2.8921e-01
  Total weights = 1.950974751e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 2.6065e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.281213393390
                                         uncertainty =       0.002185662980

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.281213393390
                                         uncertainty =       0.002185662980

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000374966561
  error estimate for blocks of size 2^( 2) =       0.000392084888
  error estimate for blocks of size 2^( 3) =       0.000409632679
  error estimate for blocks of size 2^( 4) =       0.000424960326
  error estimate for blocks of size 2^( 5) =       0.000436608565
  error estimate for blocks of size 2^( 6) =       0.000444218836
  error estimate for blocks of size 2^( 7) =       0.000447605119

      target function =      -0.929647024363
              le_mean =     -16.898698818967
             les_mean =     285.855228476623
             stat err =       0.000438348211
             autocorr =       1.366637707001
   target nu stat err =       0.000438348211
   target dn stat err =       0.002308839190
      target stat err =       0.003735130035
              std dev =       0.530282795334
             le_variance =       0.281199843027


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.689869881897e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 74
Check correct_vf_var_size: 225, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 8.2718e+06, overlap shift 8.2718e+07 and omega -1.7444e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.929660529158       residual = 5.39e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.929660529161       residual = 8.21e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.929660529162       residual = 2.36e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.929660529162       residual = 6.83e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.929660535953       residual = 2.66e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.929660559478       residual = 1.53e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.929660530217       residual = 7.65e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.929660537331       residual = 2.93e-06           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.929660535991       residual = 3.82e-06           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.929660549910       residual = 3.58e-06           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.929660499220       residual = 1.68e-06           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.929660520681       residual = 8.47e-07           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.929660527051       residual = 3.01e-07           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.929660534639       residual = 1.53e-07           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.929660493841       residual = 4.65e-08           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.929660535734       residual = 7.78e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         15 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 8.2718e+06 is 1.704593e-11

solving harmonic davidson linear method for identity shift 3.3087e+07, overlap shift 3.3087e+08 and omega -1.7444e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.929660529158       residual = 5.39e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.929660529159       residual = 8.21e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.929660529159       residual = 2.36e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.929660529159       residual = 6.83e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.929660529159       residual = 2.66e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.929660529159       residual = 1.53e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.929660529159       residual = 7.65e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.929660529159       residual = 2.93e-06           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.929660529159       residual = 3.82e-06           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.929660539836       residual = 3.58e-06           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.929660512718       residual = 1.68e-06           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.929660515147       residual = 8.48e-07           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.929660528153       residual = 3.01e-07           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.929660587233       residual = 1.53e-07           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.929660520090       residual = 4.65e-08           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.929660531711       residual = 7.80e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         15 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 3.3087e+07 is 4.261422e-12

solving harmonic davidson linear method for identity shift 1.3235e+08, overlap shift 1.3235e+09 and omega -1.7444e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.929660529158       residual = 5.39e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.929660529158       residual = 8.21e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.929660529158       residual = 2.36e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.929660529158       residual = 6.83e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.929660529158       residual = 2.66e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.929660529158       residual = 1.53e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.929660493550       residual = 7.65e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.929660272978       residual = 2.93e-06           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.929660671614       residual = 3.82e-06           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.929660311189       residual = 3.58e-06           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.929660524555       residual = 1.68e-06           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.929660792429       residual = 8.47e-07           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.929660198341       residual = 3.01e-07           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.929660720648       residual = 1.53e-07           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.929660612510       residual = 4.66e-08           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.929660570992       residual = 7.73e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         15 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 1.3235e+08 is 1.065149e-12

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               1.027032 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 75 and numParams is: 74

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.6844e+01
  </log>
  <optVariables href="H2O.s090.opt.xml">
ci_0001                 7.086064e-01 3 1  ON 0
ci_0002                 6.927483e-01 3 1  ON 1
ci_0003                -3.099699e-02 3 1  ON 2
ci_0004                -3.009162e-02 3 1  ON 3
ci_0005                -3.060382e-02 3 1  ON 4
ci_0006                -3.069586e-02 3 1  ON 5
ci_0007                -1.338102e-02 3 1  ON 6
ci_0008                -1.335093e-02 3 1  ON 7
ci_0009                -1.869650e-02 3 1  ON 8
ci_0010                -1.813030e-02 3 1  ON 9
ci_0011                -1.474501e-02 3 1  ON 10
ci_0012                -1.451134e-02 3 1  ON 11
ci_0013                 1.529423e-02 3 1  ON 12
ci_0014                 1.480516e-02 3 1  ON 13
ci_0015                 1.574766e-02 3 1  ON 14
ci_0016                 1.538632e-02 3 1  ON 15
ci_0017                 1.336745e-02 3 1  ON 16
ci_0018                 1.303906e-02 3 1  ON 17
ci_0019                 1.308950e-02 3 1  ON 18
ci_0020                 1.266839e-02 3 1  ON 19
ci_0021                 6.752770e-03 3 1  ON 20
ci_0022                 7.460538e-03 3 1  ON 21
ci_0023                -1.180403e-02 3 1  ON 22
ci_0024                -1.147023e-02 3 1  ON 23
ci_0025                -2.029570e-03 3 1  ON 24
ci_0026                -2.390747e-03 3 1  ON 25
ci_0027                -1.213155e-02 3 1  ON 26
ci_0028                -1.154912e-02 3 1  ON 27
ci_0029                -1.065832e-02 3 1  ON 28
ci_0030                -1.058734e-02 3 1  ON 29
ci_0031                 1.340906e-02 3 1  ON 30
ci_0032                 1.211459e-02 3 1  ON 31
ci_0033                 7.848177e-03 3 1  ON 32
ci_0034                 8.489627e-03 3 1  ON 33
ci_0035                 4.859421e-03 3 1  ON 34
ci_0036                 4.933671e-03 3 1  ON 35
ci_0037                -1.133359e-02 3 1  ON 36
ci_0038                -1.131343e-02 3 1  ON 37
ci_0039                -4.014992e-03 3 1  ON 38
ci_0040                -3.886155e-03 3 1  ON 39
ci_0041                 9.104242e-03 3 1  ON 40
ci_0042                 8.780957e-03 3 1  ON 41
ci_0043                -1.307372e-02 3 1  ON 42
ci_0044                -1.384583e-02 3 1  ON 43
ci_0045                 1.059118e-02 3 1  ON 44
ci_0046                 1.007868e-02 3 1  ON 45
ci_0047                -3.585075e-03 3 1  ON 46
ci_0048                -3.481623e-03 3 1  ON 47
ci_0049                -2.594629e-03 3 1  ON 48
ci_0050                -2.695910e-03 3 1  ON 49
ci_0051                -1.797585e-03 3 1  ON 50
ci_0052                -2.016123e-03 3 1  ON 51
ci_0053                -3.931436e-03 3 1  ON 52
ci_0054                -3.323922e-03 3 1  ON 53
ci_0055                 2.398828e-03 3 1  ON 54
ci_0056                 2.269778e-03 3 1  ON 55
ci_0057                 2.453986e-03 3 1  ON 56
ci_0058                 2.857281e-03 3 1  ON 57
ci_0059                -3.395815e-03 3 1  ON 58
ci_0060                -3.375888e-03 3 1  ON 59
ci_0061                -3.976504e-03 3 1  ON 60
ci_0062                -3.922365e-03 3 1  ON 61
ci_0063                -9.802580e-03 3 1  ON 62
ci_0064                -9.372600e-03 3 1  ON 63
ci_0065                -6.435479e-03 3 1  ON 64
ci_0066                -6.132151e-03 3 1  ON 65
ci_0067                -3.747986e-03 3 1  ON 66
ci_0068                -3.479531e-03 3 1  ON 67
ci_0069                 3.569219e-03 3 1  ON 68
ci_0070                 3.348549e-03 3 1  ON 69
ci_0071                 3.005272e-03 3 1  ON 70
ci_0072                 3.481734e-03 3 1  ON 71
ci_0073                 3.552587e-03 3 1  ON 72
ci_0074                 3.528871e-03 3 1  ON 73
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 90
    time step          = 0.05
    reference energy   = -16.9024
    reference variance = 0.28991
====================================================
  Execution time = 1.3866e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s090
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6898e+01
  VMC Evar = 2.8988e-01
  Total weights = 1.9510e+06
  Execution time = 1.8683e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.282489097266
                                         uncertainty =       0.001713031675

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.282489097266
                                         uncertainty =       0.001713031675

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000375783641
  error estimate for blocks of size 2^( 2) =       0.000393014762
  error estimate for blocks of size 2^( 3) =       0.000410386663
  error estimate for blocks of size 2^( 4) =       0.000426228624
  error estimate for blocks of size 2^( 5) =       0.000437829018
  error estimate for blocks of size 2^( 6) =       0.000445356159
  error estimate for blocks of size 2^( 7) =       0.000450566671

      target function =      -0.928572811230
              le_mean =     -16.897923158499
             les_mean =     285.829683289808
             stat err =       0.000439995118
             autocorr =       1.370944823408
   target nu stat err =       0.000439995118
   target dn stat err =       0.002026384791
      target stat err =       0.003286230152
              std dev =       0.531438321064
             le_variance =       0.282426689095

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.282489097266
                                         uncertainty =       0.001713031675

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.282489097266
                                         uncertainty =       0.001713031675

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000375783641
  error estimate for blocks of size 2^( 2) =       0.000393014762
  error estimate for blocks of size 2^( 3) =       0.000410386663
  error estimate for blocks of size 2^( 4) =       0.000426228624
  error estimate for blocks of size 2^( 5) =       0.000437829018
  error estimate for blocks of size 2^( 6) =       0.000445356159
  error estimate for blocks of size 2^( 7) =       0.000450566671

      target function =      -0.928572811224
              le_mean =     -16.897923158499
             les_mean =     285.829683289810
             stat err =       0.000439995118
             autocorr =       1.370944823395
   target nu stat err =       0.000439995118
   target dn stat err =       0.002026384790
      target stat err =       0.003286230151
              std dev =       0.531438321064
             le_variance =       0.282426689095

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.282489097266
                                         uncertainty =       0.001713031675

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.282489097266
                                         uncertainty =       0.001713031675

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000375783641
  error estimate for blocks of size 2^( 2) =       0.000393014762
  error estimate for blocks of size 2^( 3) =       0.000410386663
  error estimate for blocks of size 2^( 4) =       0.000426228624
  error estimate for blocks of size 2^( 5) =       0.000437829018
  error estimate for blocks of size 2^( 6) =       0.000445356159
  error estimate for blocks of size 2^( 7) =       0.000450566671

      target function =      -0.928572811227
              le_mean =     -16.897923158499
             les_mean =     285.829683289809
             stat err =       0.000439995118
             autocorr =       1.370944823402
   target nu stat err =       0.000439995118
   target dn stat err =       0.002026384790
      target stat err =       0.003286230151
              std dev =       0.531438321064
             le_variance =       0.282426689095

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.282489097266
                                         uncertainty =       0.001713031675

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.282489097266
                                         uncertainty =       0.001713031675

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000375783641
  error estimate for blocks of size 2^( 2) =       0.000393014762
  error estimate for blocks of size 2^( 3) =       0.000410386663
  error estimate for blocks of size 2^( 4) =       0.000426228624
  error estimate for blocks of size 2^( 5) =       0.000437829018
  error estimate for blocks of size 2^( 6) =       0.000445356159
  error estimate for blocks of size 2^( 7) =       0.000450566671

      target function =      -0.928572811229
              le_mean =     -16.897923158499
             les_mean =     285.829683289808
             stat err =       0.000439995118
             autocorr =       1.370944823404
   target nu stat err =       0.000439995118
   target dn stat err =       0.002026384791
      target stat err =       0.003286230151
              std dev =       0.531438321064
             le_variance =       0.282426689095


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.928572811230        initial  <--
     8.2718e+06     8.2718e+07             1.7046e-11        -0.928572811224
     3.3087e+07     3.3087e+08             4.2614e-12        -0.928572811227
     1.3235e+08     1.3235e+09             1.0651e-12        -0.928572811229

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 23.3883
  </log>
  <optVariables href="H2O.s090.opt.xml">
ci_0001                 7.086064e-01 3 1  ON 0
ci_0002                 6.927483e-01 3 1  ON 1
ci_0003                -3.099699e-02 3 1  ON 2
ci_0004                -3.009162e-02 3 1  ON 3
ci_0005                -3.060382e-02 3 1  ON 4
ci_0006                -3.069586e-02 3 1  ON 5
ci_0007                -1.338102e-02 3 1  ON 6
ci_0008                -1.335093e-02 3 1  ON 7
ci_0009                -1.869650e-02 3 1  ON 8
ci_0010                -1.813030e-02 3 1  ON 9
ci_0011                -1.474501e-02 3 1  ON 10
ci_0012                -1.451134e-02 3 1  ON 11
ci_0013                 1.529423e-02 3 1  ON 12
ci_0014                 1.480516e-02 3 1  ON 13
ci_0015                 1.574766e-02 3 1  ON 14
ci_0016                 1.538632e-02 3 1  ON 15
ci_0017                 1.336745e-02 3 1  ON 16
ci_0018                 1.303906e-02 3 1  ON 17
ci_0019                 1.308950e-02 3 1  ON 18
ci_0020                 1.266839e-02 3 1  ON 19
ci_0021                 6.752770e-03 3 1  ON 20
ci_0022                 7.460538e-03 3 1  ON 21
ci_0023                -1.180403e-02 3 1  ON 22
ci_0024                -1.147023e-02 3 1  ON 23
ci_0025                -2.029570e-03 3 1  ON 24
ci_0026                -2.390747e-03 3 1  ON 25
ci_0027                -1.213155e-02 3 1  ON 26
ci_0028                -1.154912e-02 3 1  ON 27
ci_0029                -1.065832e-02 3 1  ON 28
ci_0030                -1.058734e-02 3 1  ON 29
ci_0031                 1.340906e-02 3 1  ON 30
ci_0032                 1.211459e-02 3 1  ON 31
ci_0033                 7.848177e-03 3 1  ON 32
ci_0034                 8.489627e-03 3 1  ON 33
ci_0035                 4.859421e-03 3 1  ON 34
ci_0036                 4.933671e-03 3 1  ON 35
ci_0037                -1.133359e-02 3 1  ON 36
ci_0038                -1.131343e-02 3 1  ON 37
ci_0039                -4.014992e-03 3 1  ON 38
ci_0040                -3.886155e-03 3 1  ON 39
ci_0041                 9.104242e-03 3 1  ON 40
ci_0042                 8.780957e-03 3 1  ON 41
ci_0043                -1.307372e-02 3 1  ON 42
ci_0044                -1.384583e-02 3 1  ON 43
ci_0045                 1.059118e-02 3 1  ON 44
ci_0046                 1.007868e-02 3 1  ON 45
ci_0047                -3.585075e-03 3 1  ON 46
ci_0048                -3.481623e-03 3 1  ON 47
ci_0049                -2.594629e-03 3 1  ON 48
ci_0050                -2.695910e-03 3 1  ON 49
ci_0051                -1.797585e-03 3 1  ON 50
ci_0052                -2.016123e-03 3 1  ON 51
ci_0053                -3.931436e-03 3 1  ON 52
ci_0054                -3.323922e-03 3 1  ON 53
ci_0055                 2.398828e-03 3 1  ON 54
ci_0056                 2.269778e-03 3 1  ON 55
ci_0057                 2.453986e-03 3 1  ON 56
ci_0058                 2.857281e-03 3 1  ON 57
ci_0059                -3.395815e-03 3 1  ON 58
ci_0060                -3.375888e-03 3 1  ON 59
ci_0061                -3.976504e-03 3 1  ON 60
ci_0062                -3.922365e-03 3 1  ON 61
ci_0063                -9.802580e-03 3 1  ON 62
ci_0064                -9.372600e-03 3 1  ON 63
ci_0065                -6.435479e-03 3 1  ON 64
ci_0066                -6.132151e-03 3 1  ON 65
ci_0067                -3.747986e-03 3 1  ON 66
ci_0068                -3.479531e-03 3 1  ON 67
ci_0069                 3.569219e-03 3 1  ON 68
ci_0070                 3.348549e-03 3 1  ON 69
ci_0071                 3.005272e-03 3 1  ON 70
ci_0072                 3.481734e-03 3 1  ON 71
ci_0073                 3.552587e-03 3 1  ON 72
ci_0074                 3.528871e-03 3 1  ON 73
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 4.0238e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s091 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s091 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=91  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6900e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 91
    time step          = 0.05
    reference energy   = -16.9251
    reference variance = 0.25304
====================================================
  Execution time = 1.4243e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s091
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5254e+04
  VMC Eavg = -1.6899e+01
  VMC Evar = 2.9390e-01
  Total weights = 1.950743251e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 2.5584e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.282961306427
                                         uncertainty =       0.001730622244

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.282961306427
                                         uncertainty =       0.001730622244

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000376135627
  error estimate for blocks of size 2^( 2) =       0.000392883131
  error estimate for blocks of size 2^( 3) =       0.000410296823
  error estimate for blocks of size 2^( 4) =       0.000425187534
  error estimate for blocks of size 2^( 5) =       0.000436416188
  error estimate for blocks of size 2^( 6) =       0.000443493003
  error estimate for blocks of size 2^( 7) =       0.000446594282

      target function =      -0.922254666823
              le_mean =     -16.898681064755
             les_mean =     285.859321573035
             stat err =       0.000437922752
             autocorr =       1.355520459546
   target nu stat err =       0.000437922752
   target dn stat err =       0.003167122035
      target stat err =       0.004995606640
              std dev =       0.531936104407
             le_variance =       0.282956019172


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.689868106476e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 74
Check correct_vf_var_size: 225, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 8.2718e+07, overlap shift 8.2718e+08 and omega -1.7444e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.922280493282       residual = 8.23e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.922280493282       residual = 1.56e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.922280493282       residual = 2.66e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.922280493282       residual = 1.03e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.922280520832       residual = 5.40e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.922280541084       residual = 6.72e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.922280392556       residual = 4.89e-05           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.922280493282       residual = 3.03e-05           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.922280505654       residual = 2.39e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.922280401564       residual = 1.37e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.922280522921       residual = 5.64e-06           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.922280493282       residual = 2.03e-06           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.922280611904       residual = 6.15e-07           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.922280489677       residual = 1.55e-07           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.922280493282       residual = 5.57e-08           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.922280493282       residual = 1.53e-08           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.922280511186       residual = 3.57e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         16 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 8.2718e+07 is 4.392523e-12

solving harmonic davidson linear method for identity shift 3.3087e+08, overlap shift 3.3087e+09 and omega -1.7444e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.922280493282       residual = 8.23e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.922280493282       residual = 1.56e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.922280493282       residual = 2.66e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.922280463476       residual = 1.03e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.922280787923       residual = 5.40e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.922280666962       residual = 6.71e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.922281065327       residual = 4.89e-05           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.922280951521       residual = 3.03e-05           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.922280218217       residual = 2.39e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.922281131631       residual = 1.37e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.922281143575       residual = 5.63e-06           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.922280695744       residual = 2.04e-06           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.922279993472       residual = 6.16e-07           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.922279725620       residual = 1.55e-07           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.922280699479       residual = 5.53e-08           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.922280493282       residual = 1.53e-08           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.922280227717       residual = 3.73e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         16 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 3.3087e+08 is 1.098004e-12

solving harmonic davidson linear method for identity shift 1.3235e+09, overlap shift 1.3235e+10 and omega -1.7444e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.922280493282       residual = 8.23e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.922280493282       residual = 1.56e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.922280493282       residual = 2.66e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.922280493282       residual = 1.03e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.922280493282       residual = 5.40e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.922280493282       residual = 6.72e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.922280493282       residual = 4.89e-05           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.922280493282       residual = 3.03e-05           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.922281405510       residual = 2.40e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.922280493282       residual = 1.37e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.922280084091       residual = 5.65e-06           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.922281787172       residual = 2.04e-06           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.922280493282       residual = 6.18e-07           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.922280493282       residual = 1.56e-07           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.922280493282       residual = 5.63e-08           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.922280493282       residual = 1.55e-08           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.922284038326       residual = 4.14e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         16 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 1.3235e+09 is 2.745267e-13

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               1.036037 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 75 and numParams is: 74

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.6815e+01
  </log>
  <optVariables href="H2O.s091.opt.xml">
ci_0001                 7.086064e-01 3 1  ON 0
ci_0002                 6.927483e-01 3 1  ON 1
ci_0003                -3.099699e-02 3 1  ON 2
ci_0004                -3.009162e-02 3 1  ON 3
ci_0005                -3.060382e-02 3 1  ON 4
ci_0006                -3.069586e-02 3 1  ON 5
ci_0007                -1.338102e-02 3 1  ON 6
ci_0008                -1.335093e-02 3 1  ON 7
ci_0009                -1.869650e-02 3 1  ON 8
ci_0010                -1.813030e-02 3 1  ON 9
ci_0011                -1.474501e-02 3 1  ON 10
ci_0012                -1.451134e-02 3 1  ON 11
ci_0013                 1.529423e-02 3 1  ON 12
ci_0014                 1.480516e-02 3 1  ON 13
ci_0015                 1.574766e-02 3 1  ON 14
ci_0016                 1.538632e-02 3 1  ON 15
ci_0017                 1.336745e-02 3 1  ON 16
ci_0018                 1.303906e-02 3 1  ON 17
ci_0019                 1.308950e-02 3 1  ON 18
ci_0020                 1.266839e-02 3 1  ON 19
ci_0021                 6.752770e-03 3 1  ON 20
ci_0022                 7.460538e-03 3 1  ON 21
ci_0023                -1.180403e-02 3 1  ON 22
ci_0024                -1.147023e-02 3 1  ON 23
ci_0025                -2.029570e-03 3 1  ON 24
ci_0026                -2.390747e-03 3 1  ON 25
ci_0027                -1.213155e-02 3 1  ON 26
ci_0028                -1.154912e-02 3 1  ON 27
ci_0029                -1.065832e-02 3 1  ON 28
ci_0030                -1.058734e-02 3 1  ON 29
ci_0031                 1.340906e-02 3 1  ON 30
ci_0032                 1.211459e-02 3 1  ON 31
ci_0033                 7.848177e-03 3 1  ON 32
ci_0034                 8.489627e-03 3 1  ON 33
ci_0035                 4.859421e-03 3 1  ON 34
ci_0036                 4.933671e-03 3 1  ON 35
ci_0037                -1.133359e-02 3 1  ON 36
ci_0038                -1.131343e-02 3 1  ON 37
ci_0039                -4.014992e-03 3 1  ON 38
ci_0040                -3.886155e-03 3 1  ON 39
ci_0041                 9.104242e-03 3 1  ON 40
ci_0042                 8.780957e-03 3 1  ON 41
ci_0043                -1.307372e-02 3 1  ON 42
ci_0044                -1.384583e-02 3 1  ON 43
ci_0045                 1.059118e-02 3 1  ON 44
ci_0046                 1.007868e-02 3 1  ON 45
ci_0047                -3.585075e-03 3 1  ON 46
ci_0048                -3.481623e-03 3 1  ON 47
ci_0049                -2.594629e-03 3 1  ON 48
ci_0050                -2.695910e-03 3 1  ON 49
ci_0051                -1.797585e-03 3 1  ON 50
ci_0052                -2.016123e-03 3 1  ON 51
ci_0053                -3.931436e-03 3 1  ON 52
ci_0054                -3.323922e-03 3 1  ON 53
ci_0055                 2.398828e-03 3 1  ON 54
ci_0056                 2.269778e-03 3 1  ON 55
ci_0057                 2.453986e-03 3 1  ON 56
ci_0058                 2.857281e-03 3 1  ON 57
ci_0059                -3.395815e-03 3 1  ON 58
ci_0060                -3.375888e-03 3 1  ON 59
ci_0061                -3.976504e-03 3 1  ON 60
ci_0062                -3.922365e-03 3 1  ON 61
ci_0063                -9.802580e-03 3 1  ON 62
ci_0064                -9.372600e-03 3 1  ON 63
ci_0065                -6.435479e-03 3 1  ON 64
ci_0066                -6.132151e-03 3 1  ON 65
ci_0067                -3.747986e-03 3 1  ON 66
ci_0068                -3.479531e-03 3 1  ON 67
ci_0069                 3.569219e-03 3 1  ON 68
ci_0070                 3.348549e-03 3 1  ON 69
ci_0071                 3.005272e-03 3 1  ON 70
ci_0072                 3.481734e-03 3 1  ON 71
ci_0073                 3.552587e-03 3 1  ON 72
ci_0074                 3.528871e-03 3 1  ON 73
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 91
    time step          = 0.05
    reference energy   = -16.9429
    reference variance = 0.137563
====================================================
  Execution time = 1.3968e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s091
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6899e+01
  VMC Evar = 2.9188e-01
  Total weights = 1.9513e+06
  Execution time = 2.2676e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.282827415074
                                         uncertainty =       0.001934658241

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.282827415074
                                         uncertainty =       0.001934658241

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000376030340
  error estimate for blocks of size 2^( 2) =       0.000393072623
  error estimate for blocks of size 2^( 3) =       0.000410476364
  error estimate for blocks of size 2^( 4) =       0.000426313221
  error estimate for blocks of size 2^( 5) =       0.000438148918
  error estimate for blocks of size 2^( 6) =       0.000445596778
  error estimate for blocks of size 2^( 7) =       0.000450565403

      target function =      -0.925432654584
              le_mean =     -16.898841122974
             les_mean =     285.862710600365
             stat err =       0.000440156080
             autocorr =       1.370148492019
   target nu stat err =       0.000440156080
   target dn stat err =       0.002269926741
      target stat err =       0.003643743619
              std dev =       0.531787205985
             le_variance =       0.282797632450

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.282827415074
                                         uncertainty =       0.001934658241

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.282827415074
                                         uncertainty =       0.001934658241

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000376030340
  error estimate for blocks of size 2^( 2) =       0.000393072623
  error estimate for blocks of size 2^( 3) =       0.000410476364
  error estimate for blocks of size 2^( 4) =       0.000426313221
  error estimate for blocks of size 2^( 5) =       0.000438148918
  error estimate for blocks of size 2^( 6) =       0.000445596778
  error estimate for blocks of size 2^( 7) =       0.000450565403

      target function =      -0.925432654588
              le_mean =     -16.898841122974
             les_mean =     285.862710600363
             stat err =       0.000440156080
             autocorr =       1.370148492020
   target nu stat err =       0.000440156080
   target dn stat err =       0.002269926740
      target stat err =       0.003643743619
              std dev =       0.531787205985
             le_variance =       0.282797632449

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.282827415074
                                         uncertainty =       0.001934658241

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.282827415074
                                         uncertainty =       0.001934658241

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000376030340
  error estimate for blocks of size 2^( 2) =       0.000393072623
  error estimate for blocks of size 2^( 3) =       0.000410476364
  error estimate for blocks of size 2^( 4) =       0.000426313221
  error estimate for blocks of size 2^( 5) =       0.000438148918
  error estimate for blocks of size 2^( 6) =       0.000445596778
  error estimate for blocks of size 2^( 7) =       0.000450565403

      target function =      -0.925432654586
              le_mean =     -16.898841122974
             les_mean =     285.862710600364
             stat err =       0.000440156080
             autocorr =       1.370148492022
   target nu stat err =       0.000440156080
   target dn stat err =       0.002269926740
      target stat err =       0.003643743619
              std dev =       0.531787205985
             le_variance =       0.282797632449

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.282827415074
                                         uncertainty =       0.001934658241

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.282827415074
                                         uncertainty =       0.001934658241

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000376030340
  error estimate for blocks of size 2^( 2) =       0.000393072623
  error estimate for blocks of size 2^( 3) =       0.000410476364
  error estimate for blocks of size 2^( 4) =       0.000426313221
  error estimate for blocks of size 2^( 5) =       0.000438148918
  error estimate for blocks of size 2^( 6) =       0.000445596778
  error estimate for blocks of size 2^( 7) =       0.000450565403

      target function =      -0.925432654584
              le_mean =     -16.898841122974
             les_mean =     285.862710600365
             stat err =       0.000440156080
             autocorr =       1.370148492020
   target nu stat err =       0.000440156080
   target dn stat err =       0.002269926741
      target stat err =       0.003643743619
              std dev =       0.531787205985
             le_variance =       0.282797632450


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.925432654584        initial
     8.2718e+07     8.2718e+08             4.3925e-12        -0.925432654588  <--
     3.3087e+08     3.3087e+09             1.0980e-12        -0.925432654586
     1.3235e+09     1.3235e+10             2.7453e-13        -0.925432654584

*****************************************************************************
Applying the update for shift_i =   8.2718e+07     and shift_s =   8.2718e+08
*****************************************************************************

  Execution time = 2.5082e+01
  </log>
  <optVariables href="H2O.s091.opt.xml">
ci_0001                 7.086064e-01 3 1  ON 0
ci_0002                 6.927483e-01 3 1  ON 1
ci_0003                -3.099699e-02 3 1  ON 2
ci_0004                -3.009162e-02 3 1  ON 3
ci_0005                -3.060382e-02 3 1  ON 4
ci_0006                -3.069586e-02 3 1  ON 5
ci_0007                -1.338102e-02 3 1  ON 6
ci_0008                -1.335093e-02 3 1  ON 7
ci_0009                -1.869650e-02 3 1  ON 8
ci_0010                -1.813030e-02 3 1  ON 9
ci_0011                -1.474501e-02 3 1  ON 10
ci_0012                -1.451134e-02 3 1  ON 11
ci_0013                 1.529423e-02 3 1  ON 12
ci_0014                 1.480516e-02 3 1  ON 13
ci_0015                 1.574766e-02 3 1  ON 14
ci_0016                 1.538632e-02 3 1  ON 15
ci_0017                 1.336745e-02 3 1  ON 16
ci_0018                 1.303906e-02 3 1  ON 17
ci_0019                 1.308950e-02 3 1  ON 18
ci_0020                 1.266839e-02 3 1  ON 19
ci_0021                 6.752770e-03 3 1  ON 20
ci_0022                 7.460538e-03 3 1  ON 21
ci_0023                -1.180403e-02 3 1  ON 22
ci_0024                -1.147023e-02 3 1  ON 23
ci_0025                -2.029570e-03 3 1  ON 24
ci_0026                -2.390747e-03 3 1  ON 25
ci_0027                -1.213155e-02 3 1  ON 26
ci_0028                -1.154912e-02 3 1  ON 27
ci_0029                -1.065832e-02 3 1  ON 28
ci_0030                -1.058734e-02 3 1  ON 29
ci_0031                 1.340906e-02 3 1  ON 30
ci_0032                 1.211459e-02 3 1  ON 31
ci_0033                 7.848177e-03 3 1  ON 32
ci_0034                 8.489627e-03 3 1  ON 33
ci_0035                 4.859421e-03 3 1  ON 34
ci_0036                 4.933671e-03 3 1  ON 35
ci_0037                -1.133359e-02 3 1  ON 36
ci_0038                -1.131343e-02 3 1  ON 37
ci_0039                -4.014992e-03 3 1  ON 38
ci_0040                -3.886155e-03 3 1  ON 39
ci_0041                 9.104242e-03 3 1  ON 40
ci_0042                 8.780957e-03 3 1  ON 41
ci_0043                -1.307372e-02 3 1  ON 42
ci_0044                -1.384583e-02 3 1  ON 43
ci_0045                 1.059118e-02 3 1  ON 44
ci_0046                 1.007868e-02 3 1  ON 45
ci_0047                -3.585075e-03 3 1  ON 46
ci_0048                -3.481623e-03 3 1  ON 47
ci_0049                -2.594629e-03 3 1  ON 48
ci_0050                -2.695910e-03 3 1  ON 49
ci_0051                -1.797585e-03 3 1  ON 50
ci_0052                -2.016123e-03 3 1  ON 51
ci_0053                -3.931436e-03 3 1  ON 52
ci_0054                -3.323922e-03 3 1  ON 53
ci_0055                 2.398828e-03 3 1  ON 54
ci_0056                 2.269778e-03 3 1  ON 55
ci_0057                 2.453986e-03 3 1  ON 56
ci_0058                 2.857281e-03 3 1  ON 57
ci_0059                -3.395815e-03 3 1  ON 58
ci_0060                -3.375888e-03 3 1  ON 59
ci_0061                -3.976504e-03 3 1  ON 60
ci_0062                -3.922365e-03 3 1  ON 61
ci_0063                -9.802580e-03 3 1  ON 62
ci_0064                -9.372600e-03 3 1  ON 63
ci_0065                -6.435479e-03 3 1  ON 64
ci_0066                -6.132151e-03 3 1  ON 65
ci_0067                -3.747986e-03 3 1  ON 66
ci_0068                -3.479531e-03 3 1  ON 67
ci_0069                 3.569219e-03 3 1  ON 68
ci_0070                 3.348549e-03 3 1  ON 69
ci_0071                 3.005272e-03 3 1  ON 70
ci_0072                 3.481734e-03 3 1  ON 71
ci_0073                 3.552587e-03 3 1  ON 72
ci_0074                 3.528871e-03 3 1  ON 73
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 4.1903e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s092 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s092 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=92  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6900e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 92
    time step          = 0.05
    reference energy   = -16.8528
    reference variance = 0.266408
====================================================
  Execution time = 1.6334e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s092
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5235e+04
  VMC Eavg = -1.6899e+01
  VMC Evar = 2.9179e-01
  Total weights = 1.951192392e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 2.5499e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.281952891986
                                         uncertainty =       0.002818249685

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.281952891986
                                         uncertainty =       0.002818249685

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000375434928
  error estimate for blocks of size 2^( 2) =       0.000392669809
  error estimate for blocks of size 2^( 3) =       0.000410114087
  error estimate for blocks of size 2^( 4) =       0.000425663806
  error estimate for blocks of size 2^( 5) =       0.000437452333
  error estimate for blocks of size 2^( 6) =       0.000444147667
  error estimate for blocks of size 2^( 7) =       0.000447529569

      target function =      -0.925561444749
              le_mean =     -16.898957651036
             les_mean =     285.866561055485
             stat err =       0.000438698344
             autocorr =       1.365408621464
   target nu stat err =       0.000438698344
   target dn stat err =       0.003077904086
      target stat err =       0.004895186093
              std dev =       0.530945167465
             le_variance =       0.281902770854


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.689895765104e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 74
Check correct_vf_var_size: 225, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.0680e+07, overlap shift 2.0680e+08 and omega -1.7444e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.925585670044       residual = 1.04e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.925585670046       residual = 9.89e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.925585670046       residual = 2.45e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.925585670046       residual = 1.67e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.925585670046       residual = 6.27e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.925585675637       residual = 2.23e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.925585670046       residual = 3.39e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.925585637294       residual = 1.55e-06           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.925585694362       residual = 8.59e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.925585670046       residual = 2.49e-07           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.925585636107       residual = 8.71e-08           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.925585665633       residual = 4.32e-08           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.925585644392       residual = 3.50e-08           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.925585646397       residual = 3.78e-08           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.925585670046       residual = 2.52e-08           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.925585667493       residual = 1.76e-08           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.925585670046       residual = 5.98e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         16 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 2.0680e+07 is 1.227162e-11

solving harmonic davidson linear method for identity shift 8.2718e+07, overlap shift 8.2718e+08 and omega -1.7444e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.925585670044       residual = 1.04e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.925585670044       residual = 9.89e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.925585670044       residual = 2.45e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.925585670044       residual = 1.67e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.925585612499       residual = 6.27e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.925585590862       residual = 2.23e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.925585658313       residual = 3.39e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.925585701361       residual = 1.55e-06           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.925585578775       residual = 8.59e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.925585596567       residual = 2.49e-07           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.925585424912       residual = 8.72e-08           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.925585618351       residual = 4.33e-08           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.925585559452       residual = 3.51e-08           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.925585563102       residual = 3.77e-08           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.925585691764       residual = 2.52e-08           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.925585857123       residual = 1.76e-08           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.925585697718       residual = 6.01e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         16 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 8.2718e+07 is 3.067913e-12

solving harmonic davidson linear method for identity shift 3.3087e+08, overlap shift 3.3087e+09 and omega -1.7444e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.925585670044       residual = 1.04e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.925585670044       residual = 9.89e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.925585670044       residual = 2.45e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.925585670044       residual = 1.67e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.925585670044       residual = 6.27e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.925585670044       residual = 2.23e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.925585670044       residual = 3.39e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.925585189751       residual = 1.54e-06           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.925585891975       residual = 8.52e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.925586066855       residual = 2.47e-07           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.925584540004       residual = 8.56e-08           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.925585923728       residual = 4.36e-08           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.925584829212       residual = 3.47e-08           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.925585447070       residual = 3.69e-08           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.925586112049       residual = 2.51e-08           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.925586094650       residual = 1.79e-08           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.925585768407       residual = 6.26e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         16 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 3.3087e+08 is 7.668403e-13

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               1.045093 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 75 and numParams is: 74

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.8898e+01
  </log>
  <optVariables href="H2O.s092.opt.xml">
ci_0001                 7.086064e-01 3 1  ON 0
ci_0002                 6.927483e-01 3 1  ON 1
ci_0003                -3.099699e-02 3 1  ON 2
ci_0004                -3.009162e-02 3 1  ON 3
ci_0005                -3.060382e-02 3 1  ON 4
ci_0006                -3.069586e-02 3 1  ON 5
ci_0007                -1.338102e-02 3 1  ON 6
ci_0008                -1.335093e-02 3 1  ON 7
ci_0009                -1.869650e-02 3 1  ON 8
ci_0010                -1.813030e-02 3 1  ON 9
ci_0011                -1.474501e-02 3 1  ON 10
ci_0012                -1.451134e-02 3 1  ON 11
ci_0013                 1.529423e-02 3 1  ON 12
ci_0014                 1.480516e-02 3 1  ON 13
ci_0015                 1.574766e-02 3 1  ON 14
ci_0016                 1.538632e-02 3 1  ON 15
ci_0017                 1.336745e-02 3 1  ON 16
ci_0018                 1.303906e-02 3 1  ON 17
ci_0019                 1.308950e-02 3 1  ON 18
ci_0020                 1.266839e-02 3 1  ON 19
ci_0021                 6.752770e-03 3 1  ON 20
ci_0022                 7.460538e-03 3 1  ON 21
ci_0023                -1.180403e-02 3 1  ON 22
ci_0024                -1.147023e-02 3 1  ON 23
ci_0025                -2.029570e-03 3 1  ON 24
ci_0026                -2.390747e-03 3 1  ON 25
ci_0027                -1.213155e-02 3 1  ON 26
ci_0028                -1.154912e-02 3 1  ON 27
ci_0029                -1.065832e-02 3 1  ON 28
ci_0030                -1.058734e-02 3 1  ON 29
ci_0031                 1.340906e-02 3 1  ON 30
ci_0032                 1.211459e-02 3 1  ON 31
ci_0033                 7.848177e-03 3 1  ON 32
ci_0034                 8.489627e-03 3 1  ON 33
ci_0035                 4.859421e-03 3 1  ON 34
ci_0036                 4.933671e-03 3 1  ON 35
ci_0037                -1.133359e-02 3 1  ON 36
ci_0038                -1.131343e-02 3 1  ON 37
ci_0039                -4.014992e-03 3 1  ON 38
ci_0040                -3.886155e-03 3 1  ON 39
ci_0041                 9.104242e-03 3 1  ON 40
ci_0042                 8.780957e-03 3 1  ON 41
ci_0043                -1.307372e-02 3 1  ON 42
ci_0044                -1.384583e-02 3 1  ON 43
ci_0045                 1.059118e-02 3 1  ON 44
ci_0046                 1.007868e-02 3 1  ON 45
ci_0047                -3.585075e-03 3 1  ON 46
ci_0048                -3.481623e-03 3 1  ON 47
ci_0049                -2.594629e-03 3 1  ON 48
ci_0050                -2.695910e-03 3 1  ON 49
ci_0051                -1.797585e-03 3 1  ON 50
ci_0052                -2.016123e-03 3 1  ON 51
ci_0053                -3.931436e-03 3 1  ON 52
ci_0054                -3.323922e-03 3 1  ON 53
ci_0055                 2.398828e-03 3 1  ON 54
ci_0056                 2.269778e-03 3 1  ON 55
ci_0057                 2.453986e-03 3 1  ON 56
ci_0058                 2.857281e-03 3 1  ON 57
ci_0059                -3.395815e-03 3 1  ON 58
ci_0060                -3.375888e-03 3 1  ON 59
ci_0061                -3.976504e-03 3 1  ON 60
ci_0062                -3.922365e-03 3 1  ON 61
ci_0063                -9.802580e-03 3 1  ON 62
ci_0064                -9.372600e-03 3 1  ON 63
ci_0065                -6.435479e-03 3 1  ON 64
ci_0066                -6.132151e-03 3 1  ON 65
ci_0067                -3.747986e-03 3 1  ON 66
ci_0068                -3.479531e-03 3 1  ON 67
ci_0069                 3.569219e-03 3 1  ON 68
ci_0070                 3.348549e-03 3 1  ON 69
ci_0071                 3.005272e-03 3 1  ON 70
ci_0072                 3.481734e-03 3 1  ON 71
ci_0073                 3.552587e-03 3 1  ON 72
ci_0074                 3.528871e-03 3 1  ON 73
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 92
    time step          = 0.05
    reference energy   = -16.8693
    reference variance = 0.318379
====================================================
  Execution time = 1.3999e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s092
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6898e+01
  VMC Evar = 2.9417e-01
  Total weights = 1.9510e+06
  Execution time = 1.8777e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.283732528428
                                         uncertainty =       0.002015976202

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.283732528428
                                         uncertainty =       0.002015976202

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000376729339
  error estimate for blocks of size 2^( 2) =       0.000393270289
  error estimate for blocks of size 2^( 3) =       0.000410531407
  error estimate for blocks of size 2^( 4) =       0.000425805170
  error estimate for blocks of size 2^( 5) =       0.000437256997
  error estimate for blocks of size 2^( 6) =       0.000444381443
  error estimate for blocks of size 2^( 7) =       0.000447118342

      target function =      -0.921827852085
              le_mean =     -16.898186515612
             les_mean =     285.842878526014
             stat err =       0.000438640488
             autocorr =       1.355684234594
   target nu stat err =       0.000438640488
   target dn stat err =       0.003130257851
      target stat err =       0.004929932968
              std dev =       0.532775739925
             le_variance =       0.283849989052

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.283732528426
                                         uncertainty =       0.002015976202

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.283732528426
                                         uncertainty =       0.002015976202

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000376729339
  error estimate for blocks of size 2^( 2) =       0.000393270289
  error estimate for blocks of size 2^( 3) =       0.000410531407
  error estimate for blocks of size 2^( 4) =       0.000425805170
  error estimate for blocks of size 2^( 5) =       0.000437256997
  error estimate for blocks of size 2^( 6) =       0.000444381443
  error estimate for blocks of size 2^( 7) =       0.000447118342

      target function =      -0.921827852099
              le_mean =     -16.898186515612
             les_mean =     285.842878526006
             stat err =       0.000438640488
             autocorr =       1.355684234587
   target nu stat err =       0.000438640488
   target dn stat err =       0.003130257848
      target stat err =       0.004929932964
              std dev =       0.532775739923
             le_variance =       0.283849989051

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.283732528427
                                         uncertainty =       0.002015976202

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.283732528427
                                         uncertainty =       0.002015976202

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000376729339
  error estimate for blocks of size 2^( 2) =       0.000393270289
  error estimate for blocks of size 2^( 3) =       0.000410531407
  error estimate for blocks of size 2^( 4) =       0.000425805170
  error estimate for blocks of size 2^( 5) =       0.000437256997
  error estimate for blocks of size 2^( 6) =       0.000444381443
  error estimate for blocks of size 2^( 7) =       0.000447118342

      target function =      -0.921827852092
              le_mean =     -16.898186515612
             les_mean =     285.842878526010
             stat err =       0.000438640488
             autocorr =       1.355684234581
   target nu stat err =       0.000438640488
   target dn stat err =       0.003130257849
      target stat err =       0.004929932966
              std dev =       0.532775739924
             le_variance =       0.283849989052

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.283732528428
                                         uncertainty =       0.002015976202

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.283732528428
                                         uncertainty =       0.002015976202

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000376729339
  error estimate for blocks of size 2^( 2) =       0.000393270289
  error estimate for blocks of size 2^( 3) =       0.000410531407
  error estimate for blocks of size 2^( 4) =       0.000425805170
  error estimate for blocks of size 2^( 5) =       0.000437256997
  error estimate for blocks of size 2^( 6) =       0.000444381443
  error estimate for blocks of size 2^( 7) =       0.000447118342

      target function =      -0.921827852086
              le_mean =     -16.898186515612
             les_mean =     285.842878526014
             stat err =       0.000438640488
             autocorr =       1.355684234586
   target nu stat err =       0.000438640488
   target dn stat err =       0.003130257851
      target stat err =       0.004929932968
              std dev =       0.532775739925
             le_variance =       0.283849989052


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.921827852085        initial
     2.0680e+07     2.0680e+08             1.2272e-11        -0.921827852099  <--
     8.2718e+07     8.2718e+08             3.0679e-12        -0.921827852092
     3.3087e+08     3.3087e+09             7.6684e-13        -0.921827852086

*****************************************************************************
Applying the update for shift_i =   2.0680e+07     and shift_s =   2.0680e+08
*****************************************************************************

  Execution time = 2.3465e+01
  </log>
  <optVariables href="H2O.s092.opt.xml">
ci_0001                 7.086064e-01 3 1  ON 0
ci_0002                 6.927483e-01 3 1  ON 1
ci_0003                -3.099699e-02 3 1  ON 2
ci_0004                -3.009162e-02 3 1  ON 3
ci_0005                -3.060382e-02 3 1  ON 4
ci_0006                -3.069586e-02 3 1  ON 5
ci_0007                -1.338102e-02 3 1  ON 6
ci_0008                -1.335093e-02 3 1  ON 7
ci_0009                -1.869650e-02 3 1  ON 8
ci_0010                -1.813030e-02 3 1  ON 9
ci_0011                -1.474501e-02 3 1  ON 10
ci_0012                -1.451134e-02 3 1  ON 11
ci_0013                 1.529423e-02 3 1  ON 12
ci_0014                 1.480516e-02 3 1  ON 13
ci_0015                 1.574766e-02 3 1  ON 14
ci_0016                 1.538632e-02 3 1  ON 15
ci_0017                 1.336745e-02 3 1  ON 16
ci_0018                 1.303906e-02 3 1  ON 17
ci_0019                 1.308950e-02 3 1  ON 18
ci_0020                 1.266839e-02 3 1  ON 19
ci_0021                 6.752770e-03 3 1  ON 20
ci_0022                 7.460538e-03 3 1  ON 21
ci_0023                -1.180403e-02 3 1  ON 22
ci_0024                -1.147023e-02 3 1  ON 23
ci_0025                -2.029570e-03 3 1  ON 24
ci_0026                -2.390747e-03 3 1  ON 25
ci_0027                -1.213155e-02 3 1  ON 26
ci_0028                -1.154912e-02 3 1  ON 27
ci_0029                -1.065832e-02 3 1  ON 28
ci_0030                -1.058734e-02 3 1  ON 29
ci_0031                 1.340906e-02 3 1  ON 30
ci_0032                 1.211459e-02 3 1  ON 31
ci_0033                 7.848177e-03 3 1  ON 32
ci_0034                 8.489627e-03 3 1  ON 33
ci_0035                 4.859421e-03 3 1  ON 34
ci_0036                 4.933671e-03 3 1  ON 35
ci_0037                -1.133359e-02 3 1  ON 36
ci_0038                -1.131343e-02 3 1  ON 37
ci_0039                -4.014992e-03 3 1  ON 38
ci_0040                -3.886155e-03 3 1  ON 39
ci_0041                 9.104242e-03 3 1  ON 40
ci_0042                 8.780957e-03 3 1  ON 41
ci_0043                -1.307372e-02 3 1  ON 42
ci_0044                -1.384583e-02 3 1  ON 43
ci_0045                 1.059118e-02 3 1  ON 44
ci_0046                 1.007868e-02 3 1  ON 45
ci_0047                -3.585075e-03 3 1  ON 46
ci_0048                -3.481623e-03 3 1  ON 47
ci_0049                -2.594629e-03 3 1  ON 48
ci_0050                -2.695910e-03 3 1  ON 49
ci_0051                -1.797585e-03 3 1  ON 50
ci_0052                -2.016123e-03 3 1  ON 51
ci_0053                -3.931436e-03 3 1  ON 52
ci_0054                -3.323922e-03 3 1  ON 53
ci_0055                 2.398828e-03 3 1  ON 54
ci_0056                 2.269778e-03 3 1  ON 55
ci_0057                 2.453986e-03 3 1  ON 56
ci_0058                 2.857281e-03 3 1  ON 57
ci_0059                -3.395815e-03 3 1  ON 58
ci_0060                -3.375888e-03 3 1  ON 59
ci_0061                -3.976504e-03 3 1  ON 60
ci_0062                -3.922365e-03 3 1  ON 61
ci_0063                -9.802580e-03 3 1  ON 62
ci_0064                -9.372600e-03 3 1  ON 63
ci_0065                -6.435479e-03 3 1  ON 64
ci_0066                -6.132151e-03 3 1  ON 65
ci_0067                -3.747986e-03 3 1  ON 66
ci_0068                -3.479531e-03 3 1  ON 67
ci_0069                 3.569219e-03 3 1  ON 68
ci_0070                 3.348549e-03 3 1  ON 69
ci_0071                 3.005272e-03 3 1  ON 70
ci_0072                 3.481734e-03 3 1  ON 71
ci_0073                 3.552587e-03 3 1  ON 72
ci_0074                 3.528871e-03 3 1  ON 73
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 4.2368e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s093 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s093 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=93  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6900e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 93
    time step          = 0.05
    reference energy   = -16.9443
    reference variance = 0.433774
====================================================
  Execution time = 1.4299e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s093
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5265e+04
  VMC Eavg = -1.6899e+01
  VMC Evar = 2.9341e-01
  Total weights = 1.950791011e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 2.5981e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.282784264040
                                         uncertainty =       0.001783565231

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.282784264040
                                         uncertainty =       0.001783565231

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000376044773
  error estimate for blocks of size 2^( 2) =       0.000393081464
  error estimate for blocks of size 2^( 3) =       0.000410330541
  error estimate for blocks of size 2^( 4) =       0.000425865753
  error estimate for blocks of size 2^( 5) =       0.000437891151
  error estimate for blocks of size 2^( 6) =       0.000442849308
  error estimate for blocks of size 2^( 7) =       0.000446458051

      target function =      -0.923042433983
              le_mean =     -16.899175081729
             les_mean =     285.875525658789
             stat err =       0.000438266066
             autocorr =       1.358302744654
   target nu stat err =       0.000438266066
   target dn stat err =       0.002242384404
      target stat err =       0.003584752032
              std dev =       0.531807617569
             le_variance =       0.282819342105


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.689917508173e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 74
Check correct_vf_var_size: 225, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 5.1699e+06, overlap shift 5.1699e+07 and omega -1.7444e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.923054780045       residual = 6.12e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.923054780050       residual = 1.42e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.923054780051       residual = 2.74e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.923054780052       residual = 1.25e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.923054786188       residual = 4.64e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.923054779265       residual = 2.40e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.923054784817       residual = 1.07e-05           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.923054776808       residual = 8.16e-06           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.923054776423       residual = 1.11e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.923054784848       residual = 1.01e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.923054775297       residual = 5.83e-06           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.923054790133       residual = 2.14e-06           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.923054789204       residual = 9.47e-07           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.923054780723       residual = 3.82e-07           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.923054780620       residual = 7.59e-08           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.923054771724       residual = 2.87e-08           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.923054786194       residual = 7.85e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         16 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 5.1699e+06 is 3.978797e-11

solving harmonic davidson linear method for identity shift 2.0680e+07, overlap shift 2.0680e+08 and omega -1.7444e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.923054780045       residual = 6.12e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.923054780046       residual = 1.42e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.923054780047       residual = 2.74e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.923054780047       residual = 1.25e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.923054780153       residual = 4.64e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.923054768869       residual = 2.40e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.923054774934       residual = 1.07e-05           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.923054789849       residual = 8.16e-06           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.923054776635       residual = 1.11e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.923054785732       residual = 1.01e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.923054798390       residual = 5.83e-06           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.923054769113       residual = 2.14e-06           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.923054779974       residual = 9.47e-07           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.923054719046       residual = 3.82e-07           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.923054765978       residual = 7.59e-08           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.923054778034       residual = 2.87e-08           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.923054780427       residual = 7.85e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         16 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 2.0680e+07 is 9.946967e-12

solving harmonic davidson linear method for identity shift 8.2718e+07, overlap shift 8.2718e+08 and omega -1.7444e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.923054780045       residual = 6.12e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.923054780045       residual = 1.42e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.923054780045       residual = 2.74e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.923054765801       residual = 1.25e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.923054780045       residual = 4.64e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.923054777962       residual = 2.40e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.923054728540       residual = 1.07e-05           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.923054794841       residual = 8.16e-06           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.923054985990       residual = 1.11e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.923054910723       residual = 1.01e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.923054691770       residual = 5.83e-06           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.923054682924       residual = 2.14e-06           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.923054718491       residual = 9.47e-07           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.923054681727       residual = 3.81e-07           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.923054678711       residual = 7.58e-08           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.923055076407       residual = 2.87e-08           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.923054770028       residual = 7.81e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         16 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 8.2718e+07 is 2.486567e-12

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               1.054146 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 75 and numParams is: 74

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.6912e+01
  </log>
  <optVariables href="H2O.s093.opt.xml">
ci_0001                 7.086064e-01 3 1  ON 0
ci_0002                 6.927483e-01 3 1  ON 1
ci_0003                -3.099699e-02 3 1  ON 2
ci_0004                -3.009162e-02 3 1  ON 3
ci_0005                -3.060382e-02 3 1  ON 4
ci_0006                -3.069586e-02 3 1  ON 5
ci_0007                -1.338102e-02 3 1  ON 6
ci_0008                -1.335093e-02 3 1  ON 7
ci_0009                -1.869650e-02 3 1  ON 8
ci_0010                -1.813030e-02 3 1  ON 9
ci_0011                -1.474501e-02 3 1  ON 10
ci_0012                -1.451134e-02 3 1  ON 11
ci_0013                 1.529423e-02 3 1  ON 12
ci_0014                 1.480516e-02 3 1  ON 13
ci_0015                 1.574766e-02 3 1  ON 14
ci_0016                 1.538632e-02 3 1  ON 15
ci_0017                 1.336745e-02 3 1  ON 16
ci_0018                 1.303906e-02 3 1  ON 17
ci_0019                 1.308950e-02 3 1  ON 18
ci_0020                 1.266839e-02 3 1  ON 19
ci_0021                 6.752770e-03 3 1  ON 20
ci_0022                 7.460538e-03 3 1  ON 21
ci_0023                -1.180403e-02 3 1  ON 22
ci_0024                -1.147023e-02 3 1  ON 23
ci_0025                -2.029570e-03 3 1  ON 24
ci_0026                -2.390747e-03 3 1  ON 25
ci_0027                -1.213155e-02 3 1  ON 26
ci_0028                -1.154912e-02 3 1  ON 27
ci_0029                -1.065832e-02 3 1  ON 28
ci_0030                -1.058734e-02 3 1  ON 29
ci_0031                 1.340906e-02 3 1  ON 30
ci_0032                 1.211459e-02 3 1  ON 31
ci_0033                 7.848177e-03 3 1  ON 32
ci_0034                 8.489627e-03 3 1  ON 33
ci_0035                 4.859421e-03 3 1  ON 34
ci_0036                 4.933671e-03 3 1  ON 35
ci_0037                -1.133359e-02 3 1  ON 36
ci_0038                -1.131343e-02 3 1  ON 37
ci_0039                -4.014992e-03 3 1  ON 38
ci_0040                -3.886155e-03 3 1  ON 39
ci_0041                 9.104242e-03 3 1  ON 40
ci_0042                 8.780957e-03 3 1  ON 41
ci_0043                -1.307372e-02 3 1  ON 42
ci_0044                -1.384583e-02 3 1  ON 43
ci_0045                 1.059118e-02 3 1  ON 44
ci_0046                 1.007868e-02 3 1  ON 45
ci_0047                -3.585075e-03 3 1  ON 46
ci_0048                -3.481623e-03 3 1  ON 47
ci_0049                -2.594629e-03 3 1  ON 48
ci_0050                -2.695910e-03 3 1  ON 49
ci_0051                -1.797585e-03 3 1  ON 50
ci_0052                -2.016123e-03 3 1  ON 51
ci_0053                -3.931436e-03 3 1  ON 52
ci_0054                -3.323922e-03 3 1  ON 53
ci_0055                 2.398828e-03 3 1  ON 54
ci_0056                 2.269778e-03 3 1  ON 55
ci_0057                 2.453986e-03 3 1  ON 56
ci_0058                 2.857281e-03 3 1  ON 57
ci_0059                -3.395815e-03 3 1  ON 58
ci_0060                -3.375888e-03 3 1  ON 59
ci_0061                -3.976504e-03 3 1  ON 60
ci_0062                -3.922365e-03 3 1  ON 61
ci_0063                -9.802580e-03 3 1  ON 62
ci_0064                -9.372600e-03 3 1  ON 63
ci_0065                -6.435479e-03 3 1  ON 64
ci_0066                -6.132151e-03 3 1  ON 65
ci_0067                -3.747986e-03 3 1  ON 66
ci_0068                -3.479531e-03 3 1  ON 67
ci_0069                 3.569219e-03 3 1  ON 68
ci_0070                 3.348549e-03 3 1  ON 69
ci_0071                 3.005272e-03 3 1  ON 70
ci_0072                 3.481734e-03 3 1  ON 71
ci_0073                 3.552587e-03 3 1  ON 72
ci_0074                 3.528871e-03 3 1  ON 73
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 93
    time step          = 0.05
    reference energy   = -16.8525
    reference variance = 0.190416
====================================================
  Execution time = 1.3840e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s093
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6899e+01
  VMC Evar = 2.9576e-01
  Total weights = 1.9508e+06
  Execution time = 1.8758e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.283657292771
                                         uncertainty =       0.002030653502

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.283657292771
                                         uncertainty =       0.002030653502

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000376600440
  error estimate for blocks of size 2^( 2) =       0.000393742887
  error estimate for blocks of size 2^( 3) =       0.000411084177
  error estimate for blocks of size 2^( 4) =       0.000426047362
  error estimate for blocks of size 2^( 5) =       0.000438455547
  error estimate for blocks of size 2^( 6) =       0.000444962068
  error estimate for blocks of size 2^( 7) =       0.000448182137

      target function =      -0.919379508438
              le_mean =     -16.898837907734
             les_mean =     285.866477910738
             stat err =       0.000439411779
             autocorr =       1.361387445851
   target nu stat err =       0.000439411779
   target dn stat err =       0.002545619934
      target stat err =       0.004016253397
              std dev =       0.532593450235
             le_variance =       0.283655783233

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.283657292766
                                         uncertainty =       0.002030653502

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.283657292766
                                         uncertainty =       0.002030653502

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000376600440
  error estimate for blocks of size 2^( 2) =       0.000393742887
  error estimate for blocks of size 2^( 3) =       0.000411084177
  error estimate for blocks of size 2^( 4) =       0.000426047362
  error estimate for blocks of size 2^( 5) =       0.000438455547
  error estimate for blocks of size 2^( 6) =       0.000444962068
  error estimate for blocks of size 2^( 7) =       0.000448182137

      target function =      -0.919379508490
              le_mean =     -16.898837907734
             les_mean =     285.866477910707
             stat err =       0.000439411779
             autocorr =       1.361387445851
   target nu stat err =       0.000439411779
   target dn stat err =       0.002545619932
      target stat err =       0.004016253394
              std dev =       0.532593450231
             le_variance =       0.283655783229

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.283657292769
                                         uncertainty =       0.002030653502

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.283657292769
                                         uncertainty =       0.002030653502

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000376600440
  error estimate for blocks of size 2^( 2) =       0.000393742887
  error estimate for blocks of size 2^( 3) =       0.000411084177
  error estimate for blocks of size 2^( 4) =       0.000426047362
  error estimate for blocks of size 2^( 5) =       0.000438455547
  error estimate for blocks of size 2^( 6) =       0.000444962068
  error estimate for blocks of size 2^( 7) =       0.000448182137

      target function =      -0.919379508464
              le_mean =     -16.898837907734
             les_mean =     285.866477910723
             stat err =       0.000439411779
             autocorr =       1.361387445850
   target nu stat err =       0.000439411779
   target dn stat err =       0.002545619933
      target stat err =       0.004016253396
              std dev =       0.532593450233
             le_variance =       0.283655783231

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.283657292771
                                         uncertainty =       0.002030653502

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.283657292771
                                         uncertainty =       0.002030653502

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000376600440
  error estimate for blocks of size 2^( 2) =       0.000393742887
  error estimate for blocks of size 2^( 3) =       0.000411084177
  error estimate for blocks of size 2^( 4) =       0.000426047362
  error estimate for blocks of size 2^( 5) =       0.000438455547
  error estimate for blocks of size 2^( 6) =       0.000444962068
  error estimate for blocks of size 2^( 7) =       0.000448182137

      target function =      -0.919379508441
              le_mean =     -16.898837907734
             les_mean =     285.866477910736
             stat err =       0.000439411779
             autocorr =       1.361387445850
   target nu stat err =       0.000439411779
   target dn stat err =       0.002545619934
      target stat err =       0.004016253397
              std dev =       0.532593450235
             le_variance =       0.283655783233


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.919379508438        initial
     5.1699e+06     5.1699e+07             3.9788e-11        -0.919379508490  <--
     2.0680e+07     2.0680e+08             9.9470e-12        -0.919379508464
     8.2718e+07     8.2718e+08             2.4866e-12        -0.919379508441

*****************************************************************************
Applying the update for shift_i =   5.1699e+06     and shift_s =   5.1699e+07
*****************************************************************************

  Execution time = 2.3303e+01
  </log>
  <optVariables href="H2O.s093.opt.xml">
ci_0001                 7.086064e-01 3 1  ON 0
ci_0002                 6.927483e-01 3 1  ON 1
ci_0003                -3.099699e-02 3 1  ON 2
ci_0004                -3.009162e-02 3 1  ON 3
ci_0005                -3.060382e-02 3 1  ON 4
ci_0006                -3.069586e-02 3 1  ON 5
ci_0007                -1.338102e-02 3 1  ON 6
ci_0008                -1.335093e-02 3 1  ON 7
ci_0009                -1.869650e-02 3 1  ON 8
ci_0010                -1.813030e-02 3 1  ON 9
ci_0011                -1.474501e-02 3 1  ON 10
ci_0012                -1.451134e-02 3 1  ON 11
ci_0013                 1.529423e-02 3 1  ON 12
ci_0014                 1.480516e-02 3 1  ON 13
ci_0015                 1.574766e-02 3 1  ON 14
ci_0016                 1.538632e-02 3 1  ON 15
ci_0017                 1.336745e-02 3 1  ON 16
ci_0018                 1.303906e-02 3 1  ON 17
ci_0019                 1.308950e-02 3 1  ON 18
ci_0020                 1.266839e-02 3 1  ON 19
ci_0021                 6.752770e-03 3 1  ON 20
ci_0022                 7.460538e-03 3 1  ON 21
ci_0023                -1.180403e-02 3 1  ON 22
ci_0024                -1.147023e-02 3 1  ON 23
ci_0025                -2.029570e-03 3 1  ON 24
ci_0026                -2.390747e-03 3 1  ON 25
ci_0027                -1.213155e-02 3 1  ON 26
ci_0028                -1.154912e-02 3 1  ON 27
ci_0029                -1.065832e-02 3 1  ON 28
ci_0030                -1.058734e-02 3 1  ON 29
ci_0031                 1.340906e-02 3 1  ON 30
ci_0032                 1.211459e-02 3 1  ON 31
ci_0033                 7.848177e-03 3 1  ON 32
ci_0034                 8.489627e-03 3 1  ON 33
ci_0035                 4.859421e-03 3 1  ON 34
ci_0036                 4.933671e-03 3 1  ON 35
ci_0037                -1.133359e-02 3 1  ON 36
ci_0038                -1.131343e-02 3 1  ON 37
ci_0039                -4.014992e-03 3 1  ON 38
ci_0040                -3.886155e-03 3 1  ON 39
ci_0041                 9.104242e-03 3 1  ON 40
ci_0042                 8.780957e-03 3 1  ON 41
ci_0043                -1.307372e-02 3 1  ON 42
ci_0044                -1.384583e-02 3 1  ON 43
ci_0045                 1.059118e-02 3 1  ON 44
ci_0046                 1.007868e-02 3 1  ON 45
ci_0047                -3.585075e-03 3 1  ON 46
ci_0048                -3.481623e-03 3 1  ON 47
ci_0049                -2.594629e-03 3 1  ON 48
ci_0050                -2.695910e-03 3 1  ON 49
ci_0051                -1.797585e-03 3 1  ON 50
ci_0052                -2.016123e-03 3 1  ON 51
ci_0053                -3.931436e-03 3 1  ON 52
ci_0054                -3.323922e-03 3 1  ON 53
ci_0055                 2.398828e-03 3 1  ON 54
ci_0056                 2.269778e-03 3 1  ON 55
ci_0057                 2.453986e-03 3 1  ON 56
ci_0058                 2.857281e-03 3 1  ON 57
ci_0059                -3.395815e-03 3 1  ON 58
ci_0060                -3.375888e-03 3 1  ON 59
ci_0061                -3.976504e-03 3 1  ON 60
ci_0062                -3.922365e-03 3 1  ON 61
ci_0063                -9.802580e-03 3 1  ON 62
ci_0064                -9.372600e-03 3 1  ON 63
ci_0065                -6.435479e-03 3 1  ON 64
ci_0066                -6.132151e-03 3 1  ON 65
ci_0067                -3.747986e-03 3 1  ON 66
ci_0068                -3.479531e-03 3 1  ON 67
ci_0069                 3.569219e-03 3 1  ON 68
ci_0070                 3.348549e-03 3 1  ON 69
ci_0071                 3.005272e-03 3 1  ON 70
ci_0072                 3.481734e-03 3 1  ON 71
ci_0073                 3.552587e-03 3 1  ON 72
ci_0074                 3.528871e-03 3 1  ON 73
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 4.0220e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s094 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s094 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=94  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6900e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 94
    time step          = 0.05
    reference energy   = -16.9158
    reference variance = 0.324901
====================================================
  Execution time = 1.4341e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s094
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5253e+04
  VMC Eavg = -1.6899e+01
  VMC Evar = 2.9468e-01
  Total weights = 1.951357035e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 2.5932e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.283041009534
                                         uncertainty =       0.001743659056

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.283041009534
                                         uncertainty =       0.001743659056

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000376197612
  error estimate for blocks of size 2^( 2) =       0.000392974313
  error estimate for blocks of size 2^( 3) =       0.000410033098
  error estimate for blocks of size 2^( 4) =       0.000425370765
  error estimate for blocks of size 2^( 5) =       0.000436330285
  error estimate for blocks of size 2^( 6) =       0.000443337216
  error estimate for blocks of size 2^( 7) =       0.000447901895

      target function =      -0.921040153787
              le_mean =     -16.898621943810
             les_mean =     285.858103962192
             stat err =       0.000438235040
             autocorr =       1.357007134868
   target nu stat err =       0.000438235040
   target dn stat err =       0.003068381463
      target stat err =       0.004830286140
              std dev =       0.532023764846
             le_variance =       0.283049286361


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.689862194381e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 74
Check correct_vf_var_size: 225, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.2925e+06, overlap shift 1.2925e+07 and omega -1.7444e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.921064082930       residual = 2.59e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.921064083002       residual = 1.67e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.921064083010       residual = 5.85e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.921064083013       residual = 1.68e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.921064083014       residual = 7.58e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.921064082756       residual = 3.82e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.921064081962       residual = 1.31e-05           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.921064083179       residual = 4.76e-06           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.921064083015       residual = 1.30e-06           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.921064083015       residual = 4.91e-07           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.921064084003       residual = 2.43e-07           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.921064082953       residual = 9.85e-08           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.921064079628       residual = 9.33e-08           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.921064083612       residual = 9.72e-08           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.921064083015       residual = 7.78e-08           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.921064080275       residual = 4.75e-08           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.921064083015       residual = 1.65e-08           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.921064080303       residual = 6.57e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         17 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 1.2925e+06 is 2.097327e-10

solving harmonic davidson linear method for identity shift 5.1699e+06, overlap shift 5.1699e+07 and omega -1.7444e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.921064082930       residual = 2.59e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.921064082948       residual = 1.67e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.921064082950       residual = 5.85e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.921064082951       residual = 1.68e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.921064082951       residual = 7.58e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.921064082951       residual = 3.82e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.921064082951       residual = 1.31e-05           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.921064082951       residual = 4.76e-06           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.921064082951       residual = 1.30e-06           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.921064088008       residual = 4.91e-07           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.921064082951       residual = 2.43e-07           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.921064074462       residual = 9.85e-08           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.921064082951       residual = 9.33e-08           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.921064082951       residual = 9.72e-08           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.921064090896       residual = 7.78e-08           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.921064079085       residual = 4.75e-08           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.921064082951       residual = 1.65e-08           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.921064076698       residual = 6.58e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         17 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 5.1699e+06 is 5.243318e-11

solving harmonic davidson linear method for identity shift 2.0680e+07, overlap shift 2.0680e+08 and omega -1.7444e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.921064082930       residual = 2.59e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.921064082935       residual = 1.67e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.921064082935       residual = 5.85e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.921064082935       residual = 1.68e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.921064084275       residual = 7.58e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.921064086959       residual = 3.82e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.921064082387       residual = 1.31e-05           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.921064073677       residual = 4.76e-06           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.921064078683       residual = 1.30e-06           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.921064082935       residual = 4.91e-07           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.921064073242       residual = 2.43e-07           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.921064082935       residual = 9.84e-08           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.921064069247       residual = 9.33e-08           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.921064093690       residual = 9.73e-08           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.921064082935       residual = 7.78e-08           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.921064109159       residual = 4.75e-08           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.921064082935       residual = 1.65e-08           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.921064083576       residual = 6.58e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         17 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 2.0680e+07 is 1.310823e-11

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               1.064251 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 75 and numParams is: 74

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.6949e+01
  </log>
  <optVariables href="H2O.s094.opt.xml">
ci_0001                 7.086064e-01 3 1  ON 0
ci_0002                 6.927483e-01 3 1  ON 1
ci_0003                -3.099699e-02 3 1  ON 2
ci_0004                -3.009162e-02 3 1  ON 3
ci_0005                -3.060382e-02 3 1  ON 4
ci_0006                -3.069586e-02 3 1  ON 5
ci_0007                -1.338102e-02 3 1  ON 6
ci_0008                -1.335093e-02 3 1  ON 7
ci_0009                -1.869650e-02 3 1  ON 8
ci_0010                -1.813030e-02 3 1  ON 9
ci_0011                -1.474501e-02 3 1  ON 10
ci_0012                -1.451134e-02 3 1  ON 11
ci_0013                 1.529423e-02 3 1  ON 12
ci_0014                 1.480516e-02 3 1  ON 13
ci_0015                 1.574766e-02 3 1  ON 14
ci_0016                 1.538632e-02 3 1  ON 15
ci_0017                 1.336745e-02 3 1  ON 16
ci_0018                 1.303906e-02 3 1  ON 17
ci_0019                 1.308950e-02 3 1  ON 18
ci_0020                 1.266839e-02 3 1  ON 19
ci_0021                 6.752770e-03 3 1  ON 20
ci_0022                 7.460538e-03 3 1  ON 21
ci_0023                -1.180403e-02 3 1  ON 22
ci_0024                -1.147023e-02 3 1  ON 23
ci_0025                -2.029570e-03 3 1  ON 24
ci_0026                -2.390747e-03 3 1  ON 25
ci_0027                -1.213155e-02 3 1  ON 26
ci_0028                -1.154912e-02 3 1  ON 27
ci_0029                -1.065832e-02 3 1  ON 28
ci_0030                -1.058734e-02 3 1  ON 29
ci_0031                 1.340906e-02 3 1  ON 30
ci_0032                 1.211459e-02 3 1  ON 31
ci_0033                 7.848177e-03 3 1  ON 32
ci_0034                 8.489627e-03 3 1  ON 33
ci_0035                 4.859421e-03 3 1  ON 34
ci_0036                 4.933671e-03 3 1  ON 35
ci_0037                -1.133359e-02 3 1  ON 36
ci_0038                -1.131343e-02 3 1  ON 37
ci_0039                -4.014992e-03 3 1  ON 38
ci_0040                -3.886155e-03 3 1  ON 39
ci_0041                 9.104242e-03 3 1  ON 40
ci_0042                 8.780957e-03 3 1  ON 41
ci_0043                -1.307372e-02 3 1  ON 42
ci_0044                -1.384583e-02 3 1  ON 43
ci_0045                 1.059118e-02 3 1  ON 44
ci_0046                 1.007868e-02 3 1  ON 45
ci_0047                -3.585075e-03 3 1  ON 46
ci_0048                -3.481623e-03 3 1  ON 47
ci_0049                -2.594629e-03 3 1  ON 48
ci_0050                -2.695910e-03 3 1  ON 49
ci_0051                -1.797585e-03 3 1  ON 50
ci_0052                -2.016123e-03 3 1  ON 51
ci_0053                -3.931436e-03 3 1  ON 52
ci_0054                -3.323922e-03 3 1  ON 53
ci_0055                 2.398828e-03 3 1  ON 54
ci_0056                 2.269778e-03 3 1  ON 55
ci_0057                 2.453986e-03 3 1  ON 56
ci_0058                 2.857281e-03 3 1  ON 57
ci_0059                -3.395815e-03 3 1  ON 58
ci_0060                -3.375888e-03 3 1  ON 59
ci_0061                -3.976504e-03 3 1  ON 60
ci_0062                -3.922365e-03 3 1  ON 61
ci_0063                -9.802580e-03 3 1  ON 62
ci_0064                -9.372600e-03 3 1  ON 63
ci_0065                -6.435479e-03 3 1  ON 64
ci_0066                -6.132151e-03 3 1  ON 65
ci_0067                -3.747986e-03 3 1  ON 66
ci_0068                -3.479531e-03 3 1  ON 67
ci_0069                 3.569219e-03 3 1  ON 68
ci_0070                 3.348549e-03 3 1  ON 69
ci_0071                 3.005272e-03 3 1  ON 70
ci_0072                 3.481734e-03 3 1  ON 71
ci_0073                 3.552587e-03 3 1  ON 72
ci_0074                 3.528871e-03 3 1  ON 73
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 94
    time step          = 0.05
    reference energy   = -16.9356
    reference variance = 0.223477
====================================================
  Execution time = 1.3870e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s094
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6899e+01
  VMC Evar = 2.9628e-01
  Total weights = 1.9508e+06
  Execution time = 1.8746e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.284161905032
                                         uncertainty =       0.002078422393

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.284161905032
                                         uncertainty =       0.002078422393

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000376896198
  error estimate for blocks of size 2^( 2) =       0.000393928132
  error estimate for blocks of size 2^( 3) =       0.000411069655
  error estimate for blocks of size 2^( 4) =       0.000426314925
  error estimate for blocks of size 2^( 5) =       0.000438873610
  error estimate for blocks of size 2^( 6) =       0.000447684443
  error estimate for blocks of size 2^( 7) =       0.000451382473

      target function =      -0.918557544640
              le_mean =     -16.898985481131
             les_mean =     285.871988749061
             stat err =       0.000441063863
             autocorr =       1.369491813027
   target nu stat err =       0.000441063863
   target dn stat err =       0.003342292154
      target stat err =       0.005227952747
              std dev =       0.533011714796
             le_variance =       0.284101488109

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.284161905001
                                         uncertainty =       0.002078422389

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.284161905001
                                         uncertainty =       0.002078422389

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000376896198
  error estimate for blocks of size 2^( 2) =       0.000393928132
  error estimate for blocks of size 2^( 3) =       0.000411069655
  error estimate for blocks of size 2^( 4) =       0.000426314925
  error estimate for blocks of size 2^( 5) =       0.000438873610
  error estimate for blocks of size 2^( 6) =       0.000447684443
  error estimate for blocks of size 2^( 7) =       0.000451382473

      target function =      -0.918557545435
              le_mean =     -16.898985481131
             les_mean =     285.871988748541
             stat err =       0.000441063863
             autocorr =       1.369491813140
   target nu stat err =       0.000441063863
   target dn stat err =       0.003342292151
      target stat err =       0.005227952751
              std dev =       0.533011714766
             le_variance =       0.284101488078

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.284161905017
                                         uncertainty =       0.002078422391

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.284161905017
                                         uncertainty =       0.002078422391

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000376896198
  error estimate for blocks of size 2^( 2) =       0.000393928132
  error estimate for blocks of size 2^( 3) =       0.000411069655
  error estimate for blocks of size 2^( 4) =       0.000426314925
  error estimate for blocks of size 2^( 5) =       0.000438873610
  error estimate for blocks of size 2^( 6) =       0.000447684443
  error estimate for blocks of size 2^( 7) =       0.000451382473

      target function =      -0.918557545037
              le_mean =     -16.898985481131
             les_mean =     285.871988748801
             stat err =       0.000441063863
             autocorr =       1.369491813083
   target nu stat err =       0.000441063863
   target dn stat err =       0.003342292153
      target stat err =       0.005227952749
              std dev =       0.533011714781
             le_variance =       0.284101488093

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.284161905030
                                         uncertainty =       0.002078422393

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.284161905030
                                         uncertainty =       0.002078422393

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000376896198
  error estimate for blocks of size 2^( 2) =       0.000393928132
  error estimate for blocks of size 2^( 3) =       0.000411069655
  error estimate for blocks of size 2^( 4) =       0.000426314925
  error estimate for blocks of size 2^( 5) =       0.000438873610
  error estimate for blocks of size 2^( 6) =       0.000447684443
  error estimate for blocks of size 2^( 7) =       0.000451382473

      target function =      -0.918557544689
              le_mean =     -16.898985481131
             les_mean =     285.871988749028
             stat err =       0.000441063863
             autocorr =       1.369491813035
   target nu stat err =       0.000441063863
   target dn stat err =       0.003342292154
      target stat err =       0.005227952747
              std dev =       0.533011714794
             le_variance =       0.284101488107


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.918557544640        initial
     1.2925e+06     1.2925e+07             2.0973e-10        -0.918557545435  <--
     5.1699e+06     5.1699e+07             5.2433e-11        -0.918557545037
     2.0680e+07     2.0680e+08             1.3108e-11        -0.918557544689

*****************************************************************************
Applying the update for shift_i =   1.2925e+06     and shift_s =   1.2925e+07
*****************************************************************************

  Execution time = 2.3309e+01
  </log>
  <optVariables href="H2O.s094.opt.xml">
ci_0001                 7.086064e-01 3 1  ON 0
ci_0002                 6.927483e-01 3 1  ON 1
ci_0003                -3.099699e-02 3 1  ON 2
ci_0004                -3.009162e-02 3 1  ON 3
ci_0005                -3.060382e-02 3 1  ON 4
ci_0006                -3.069586e-02 3 1  ON 5
ci_0007                -1.338102e-02 3 1  ON 6
ci_0008                -1.335093e-02 3 1  ON 7
ci_0009                -1.869650e-02 3 1  ON 8
ci_0010                -1.813030e-02 3 1  ON 9
ci_0011                -1.474501e-02 3 1  ON 10
ci_0012                -1.451134e-02 3 1  ON 11
ci_0013                 1.529423e-02 3 1  ON 12
ci_0014                 1.480516e-02 3 1  ON 13
ci_0015                 1.574766e-02 3 1  ON 14
ci_0016                 1.538632e-02 3 1  ON 15
ci_0017                 1.336745e-02 3 1  ON 16
ci_0018                 1.303906e-02 3 1  ON 17
ci_0019                 1.308950e-02 3 1  ON 18
ci_0020                 1.266839e-02 3 1  ON 19
ci_0021                 6.752770e-03 3 1  ON 20
ci_0022                 7.460538e-03 3 1  ON 21
ci_0023                -1.180403e-02 3 1  ON 22
ci_0024                -1.147023e-02 3 1  ON 23
ci_0025                -2.029570e-03 3 1  ON 24
ci_0026                -2.390747e-03 3 1  ON 25
ci_0027                -1.213155e-02 3 1  ON 26
ci_0028                -1.154912e-02 3 1  ON 27
ci_0029                -1.065832e-02 3 1  ON 28
ci_0030                -1.058734e-02 3 1  ON 29
ci_0031                 1.340906e-02 3 1  ON 30
ci_0032                 1.211459e-02 3 1  ON 31
ci_0033                 7.848177e-03 3 1  ON 32
ci_0034                 8.489627e-03 3 1  ON 33
ci_0035                 4.859421e-03 3 1  ON 34
ci_0036                 4.933671e-03 3 1  ON 35
ci_0037                -1.133359e-02 3 1  ON 36
ci_0038                -1.131343e-02 3 1  ON 37
ci_0039                -4.014992e-03 3 1  ON 38
ci_0040                -3.886155e-03 3 1  ON 39
ci_0041                 9.104242e-03 3 1  ON 40
ci_0042                 8.780957e-03 3 1  ON 41
ci_0043                -1.307372e-02 3 1  ON 42
ci_0044                -1.384583e-02 3 1  ON 43
ci_0045                 1.059118e-02 3 1  ON 44
ci_0046                 1.007868e-02 3 1  ON 45
ci_0047                -3.585075e-03 3 1  ON 46
ci_0048                -3.481623e-03 3 1  ON 47
ci_0049                -2.594629e-03 3 1  ON 48
ci_0050                -2.695910e-03 3 1  ON 49
ci_0051                -1.797585e-03 3 1  ON 50
ci_0052                -2.016123e-03 3 1  ON 51
ci_0053                -3.931436e-03 3 1  ON 52
ci_0054                -3.323922e-03 3 1  ON 53
ci_0055                 2.398828e-03 3 1  ON 54
ci_0056                 2.269778e-03 3 1  ON 55
ci_0057                 2.453986e-03 3 1  ON 56
ci_0058                 2.857281e-03 3 1  ON 57
ci_0059                -3.395815e-03 3 1  ON 58
ci_0060                -3.375888e-03 3 1  ON 59
ci_0061                -3.976504e-03 3 1  ON 60
ci_0062                -3.922365e-03 3 1  ON 61
ci_0063                -9.802580e-03 3 1  ON 62
ci_0064                -9.372600e-03 3 1  ON 63
ci_0065                -6.435479e-03 3 1  ON 64
ci_0066                -6.132151e-03 3 1  ON 65
ci_0067                -3.747986e-03 3 1  ON 66
ci_0068                -3.479531e-03 3 1  ON 67
ci_0069                 3.569219e-03 3 1  ON 68
ci_0070                 3.348549e-03 3 1  ON 69
ci_0071                 3.005272e-03 3 1  ON 70
ci_0072                 3.481734e-03 3 1  ON 71
ci_0073                 3.552587e-03 3 1  ON 72
ci_0074                 3.528871e-03 3 1  ON 73
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 4.0287e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s095 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s095 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=95  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6900e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 95
    time step          = 0.05
    reference energy   = -16.8716
    reference variance = 0.230993
====================================================
  Execution time = 1.4278e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s095
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5217e+04
  VMC Eavg = -1.6899e+01
  VMC Evar = 2.8813e-01
  Total weights = 1.950843959e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 2.5700e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.278711134842
                                         uncertainty =       0.001451470848

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.278711134842
                                         uncertainty =       0.001451470848

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000373263644
  error estimate for blocks of size 2^( 2) =       0.000390475596
  error estimate for blocks of size 2^( 3) =       0.000408277981
  error estimate for blocks of size 2^( 4) =       0.000423469291
  error estimate for blocks of size 2^( 5) =       0.000434876178
  error estimate for blocks of size 2^( 6) =       0.000444448905
  error estimate for blocks of size 2^( 7) =       0.000449153135

      target function =      -0.931352326416
              le_mean =     -16.898612491751
             les_mean =     285.851234628857
             stat err =       0.000437986877
             autocorr =       1.376863268199
   target nu stat err =       0.000437986877
   target dn stat err =       0.002391987007
      target stat err =       0.003877544378
              std dev =       0.527874507646
             le_variance =       0.278651495822


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.689861249175e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 74
Check correct_vf_var_size: 225, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 3.2312e+05, overlap shift 3.2312e+06 and omega -1.7444e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.931367214071       residual = 1.51e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.931367214222       residual = 2.25e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.931367214258       residual = 2.91e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.931367214262       residual = 1.42e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.931367214136       residual = 9.63e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.931367214347       residual = 4.20e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.931367214776       residual = 1.55e-05           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.931367214195       residual = 8.38e-06           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.931367214184       residual = 7.93e-06           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.931367213852       residual = 7.17e-06           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.931367213460       residual = 6.30e-06           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.931367215272       residual = 1.77e-06           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.931367214808       residual = 6.58e-07           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.931367214555       residual = 1.57e-07           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.931367213927       residual = 7.22e-08           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.931367214915       residual = 1.53e-08           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.931367213886       residual = 4.32e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         16 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 3.2312e+05 is 6.764351e-10

solving harmonic davidson linear method for identity shift 1.2925e+06, overlap shift 1.2925e+07 and omega -1.7444e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.931367214071       residual = 1.51e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.931367214109       residual = 2.25e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.931367214118       residual = 2.91e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.931367214178       residual = 1.42e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.931367214694       residual = 9.63e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.931367213540       residual = 4.20e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.931367212796       residual = 1.55e-05           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.931367217482       residual = 8.38e-06           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.931367214662       residual = 7.93e-06           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.931367212905       residual = 7.17e-06           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.931367215132       residual = 6.30e-06           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.931367211213       residual = 1.77e-06           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.931367210530       residual = 6.58e-07           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.931367211923       residual = 1.57e-07           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.931367215468       residual = 7.22e-08           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.931367214912       residual = 1.53e-08           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.931367216101       residual = 4.32e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         16 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 1.2925e+06 is 1.691088e-10

solving harmonic davidson linear method for identity shift 5.1699e+06, overlap shift 5.1699e+07 and omega -1.7444e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.931367214071       residual = 1.51e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.931367214081       residual = 2.25e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.931367214083       residual = 2.91e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.931367214082       residual = 1.42e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.931367214195       residual = 9.63e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.931367216408       residual = 4.20e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.931367206046       residual = 1.55e-05           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.931367208673       residual = 8.38e-06           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.931367210361       residual = 7.93e-06           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.931367225903       residual = 7.17e-06           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.931367218667       residual = 6.30e-06           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.931367216887       residual = 1.77e-06           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.931367207604       residual = 6.58e-07           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.931367211577       residual = 1.57e-07           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.931367206223       residual = 7.22e-08           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.931367220522       residual = 1.53e-08           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.931367216774       residual = 4.32e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         16 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 5.1699e+06 is 4.227724e-11

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               1.073367 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 75 and numParams is: 74

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.6862e+01
  </log>
  <optVariables href="H2O.s095.opt.xml">
ci_0001                 7.086064e-01 3 1  ON 0
ci_0002                 6.927483e-01 3 1  ON 1
ci_0003                -3.099699e-02 3 1  ON 2
ci_0004                -3.009162e-02 3 1  ON 3
ci_0005                -3.060382e-02 3 1  ON 4
ci_0006                -3.069586e-02 3 1  ON 5
ci_0007                -1.338102e-02 3 1  ON 6
ci_0008                -1.335093e-02 3 1  ON 7
ci_0009                -1.869650e-02 3 1  ON 8
ci_0010                -1.813030e-02 3 1  ON 9
ci_0011                -1.474501e-02 3 1  ON 10
ci_0012                -1.451134e-02 3 1  ON 11
ci_0013                 1.529423e-02 3 1  ON 12
ci_0014                 1.480516e-02 3 1  ON 13
ci_0015                 1.574766e-02 3 1  ON 14
ci_0016                 1.538632e-02 3 1  ON 15
ci_0017                 1.336745e-02 3 1  ON 16
ci_0018                 1.303906e-02 3 1  ON 17
ci_0019                 1.308950e-02 3 1  ON 18
ci_0020                 1.266839e-02 3 1  ON 19
ci_0021                 6.752770e-03 3 1  ON 20
ci_0022                 7.460538e-03 3 1  ON 21
ci_0023                -1.180403e-02 3 1  ON 22
ci_0024                -1.147023e-02 3 1  ON 23
ci_0025                -2.029570e-03 3 1  ON 24
ci_0026                -2.390747e-03 3 1  ON 25
ci_0027                -1.213155e-02 3 1  ON 26
ci_0028                -1.154912e-02 3 1  ON 27
ci_0029                -1.065832e-02 3 1  ON 28
ci_0030                -1.058734e-02 3 1  ON 29
ci_0031                 1.340906e-02 3 1  ON 30
ci_0032                 1.211459e-02 3 1  ON 31
ci_0033                 7.848177e-03 3 1  ON 32
ci_0034                 8.489627e-03 3 1  ON 33
ci_0035                 4.859421e-03 3 1  ON 34
ci_0036                 4.933671e-03 3 1  ON 35
ci_0037                -1.133359e-02 3 1  ON 36
ci_0038                -1.131343e-02 3 1  ON 37
ci_0039                -4.014992e-03 3 1  ON 38
ci_0040                -3.886155e-03 3 1  ON 39
ci_0041                 9.104242e-03 3 1  ON 40
ci_0042                 8.780957e-03 3 1  ON 41
ci_0043                -1.307372e-02 3 1  ON 42
ci_0044                -1.384583e-02 3 1  ON 43
ci_0045                 1.059118e-02 3 1  ON 44
ci_0046                 1.007868e-02 3 1  ON 45
ci_0047                -3.585075e-03 3 1  ON 46
ci_0048                -3.481623e-03 3 1  ON 47
ci_0049                -2.594629e-03 3 1  ON 48
ci_0050                -2.695910e-03 3 1  ON 49
ci_0051                -1.797585e-03 3 1  ON 50
ci_0052                -2.016123e-03 3 1  ON 51
ci_0053                -3.931436e-03 3 1  ON 52
ci_0054                -3.323922e-03 3 1  ON 53
ci_0055                 2.398828e-03 3 1  ON 54
ci_0056                 2.269778e-03 3 1  ON 55
ci_0057                 2.453986e-03 3 1  ON 56
ci_0058                 2.857281e-03 3 1  ON 57
ci_0059                -3.395815e-03 3 1  ON 58
ci_0060                -3.375888e-03 3 1  ON 59
ci_0061                -3.976504e-03 3 1  ON 60
ci_0062                -3.922365e-03 3 1  ON 61
ci_0063                -9.802580e-03 3 1  ON 62
ci_0064                -9.372600e-03 3 1  ON 63
ci_0065                -6.435479e-03 3 1  ON 64
ci_0066                -6.132151e-03 3 1  ON 65
ci_0067                -3.747986e-03 3 1  ON 66
ci_0068                -3.479531e-03 3 1  ON 67
ci_0069                 3.569219e-03 3 1  ON 68
ci_0070                 3.348549e-03 3 1  ON 69
ci_0071                 3.005272e-03 3 1  ON 70
ci_0072                 3.481734e-03 3 1  ON 71
ci_0073                 3.552587e-03 3 1  ON 72
ci_0074                 3.528871e-03 3 1  ON 73
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 95
    time step          = 0.05
    reference energy   = -16.8998
    reference variance = 0.344962
====================================================
  Execution time = 1.3803e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s095
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6899e+01
  VMC Evar = 2.9357e-01
  Total weights = 1.9510e+06
  Execution time = 1.8900e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.283171698093
                                         uncertainty =       0.001698399418

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.283171698093
                                         uncertainty =       0.001698399418

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000376263455
  error estimate for blocks of size 2^( 2) =       0.000393205867
  error estimate for blocks of size 2^( 3) =       0.000410597453
  error estimate for blocks of size 2^( 4) =       0.000426287880
  error estimate for blocks of size 2^( 5) =       0.000438455793
  error estimate for blocks of size 2^( 6) =       0.000448630427
  error estimate for blocks of size 2^( 7) =       0.000451734324

      target function =      -0.922787470735
              le_mean =     -16.898822370351
             les_mean =     285.863764785712
             stat err =       0.000441277106
             autocorr =       1.375430707103
   target nu stat err =       0.000441277106
   target dn stat err =       0.002331801011
      target stat err =       0.003718279454
              std dev =       0.532116880475
             le_variance =       0.283148374486

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.283171698050
                                         uncertainty =       0.001698399416

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.283171698050
                                         uncertainty =       0.001698399416

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000376263455
  error estimate for blocks of size 2^( 2) =       0.000393205867
  error estimate for blocks of size 2^( 3) =       0.000410597453
  error estimate for blocks of size 2^( 4) =       0.000426287880
  error estimate for blocks of size 2^( 5) =       0.000438455793
  error estimate for blocks of size 2^( 6) =       0.000448630427
  error estimate for blocks of size 2^( 7) =       0.000451734324

      target function =      -0.922787471147
              le_mean =     -16.898822370357
             les_mean =     285.863764785676
             stat err =       0.000441277106
             autocorr =       1.375430707089
   target nu stat err =       0.000441277106
   target dn stat err =       0.002331800974
      target stat err =       0.003718279400
              std dev =       0.532116880435
             le_variance =       0.283148374443

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.283171698072
                                         uncertainty =       0.001698399417

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.283171698072
                                         uncertainty =       0.001698399417

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000376263455
  error estimate for blocks of size 2^( 2) =       0.000393205867
  error estimate for blocks of size 2^( 3) =       0.000410597453
  error estimate for blocks of size 2^( 4) =       0.000426287880
  error estimate for blocks of size 2^( 5) =       0.000438455793
  error estimate for blocks of size 2^( 6) =       0.000448630427
  error estimate for blocks of size 2^( 7) =       0.000451734324

      target function =      -0.922787470941
              le_mean =     -16.898822370354
             les_mean =     285.863764785694
             stat err =       0.000441277106
             autocorr =       1.375430707089
   target nu stat err =       0.000441277106
   target dn stat err =       0.002331800992
      target stat err =       0.003718279427
              std dev =       0.532116880455
             le_variance =       0.283148374465

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.283171698091
                                         uncertainty =       0.001698399418

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.283171698091
                                         uncertainty =       0.001698399418

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000376263455
  error estimate for blocks of size 2^( 2) =       0.000393205867
  error estimate for blocks of size 2^( 3) =       0.000410597453
  error estimate for blocks of size 2^( 4) =       0.000426287880
  error estimate for blocks of size 2^( 5) =       0.000438455793
  error estimate for blocks of size 2^( 6) =       0.000448630427
  error estimate for blocks of size 2^( 7) =       0.000451734324

      target function =      -0.922787470761
              le_mean =     -16.898822370351
             les_mean =     285.863764785710
             stat err =       0.000441277106
             autocorr =       1.375430707109
   target nu stat err =       0.000441277106
   target dn stat err =       0.002331801009
      target stat err =       0.003718279450
              std dev =       0.532116880472
             le_variance =       0.283148374483


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.922787470735        initial
     3.2312e+05     3.2312e+06             6.7644e-10        -0.922787471147  <--
     1.2925e+06     1.2925e+07             1.6911e-10        -0.922787470941
     5.1699e+06     5.1699e+07             4.2277e-11        -0.922787470761

*****************************************************************************
Applying the update for shift_i =   3.2312e+05     and shift_s =   3.2312e+06
*****************************************************************************

  Execution time = 2.3281e+01
  </log>
  <optVariables href="H2O.s095.opt.xml">
ci_0001                 7.086064e-01 3 1  ON 0
ci_0002                 6.927483e-01 3 1  ON 1
ci_0003                -3.099699e-02 3 1  ON 2
ci_0004                -3.009162e-02 3 1  ON 3
ci_0005                -3.060382e-02 3 1  ON 4
ci_0006                -3.069587e-02 3 1  ON 5
ci_0007                -1.338102e-02 3 1  ON 6
ci_0008                -1.335093e-02 3 1  ON 7
ci_0009                -1.869650e-02 3 1  ON 8
ci_0010                -1.813030e-02 3 1  ON 9
ci_0011                -1.474501e-02 3 1  ON 10
ci_0012                -1.451134e-02 3 1  ON 11
ci_0013                 1.529423e-02 3 1  ON 12
ci_0014                 1.480516e-02 3 1  ON 13
ci_0015                 1.574766e-02 3 1  ON 14
ci_0016                 1.538632e-02 3 1  ON 15
ci_0017                 1.336745e-02 3 1  ON 16
ci_0018                 1.303906e-02 3 1  ON 17
ci_0019                 1.308950e-02 3 1  ON 18
ci_0020                 1.266839e-02 3 1  ON 19
ci_0021                 6.752770e-03 3 1  ON 20
ci_0022                 7.460537e-03 3 1  ON 21
ci_0023                -1.180403e-02 3 1  ON 22
ci_0024                -1.147023e-02 3 1  ON 23
ci_0025                -2.029570e-03 3 1  ON 24
ci_0026                -2.390747e-03 3 1  ON 25
ci_0027                -1.213155e-02 3 1  ON 26
ci_0028                -1.154912e-02 3 1  ON 27
ci_0029                -1.065832e-02 3 1  ON 28
ci_0030                -1.058734e-02 3 1  ON 29
ci_0031                 1.340907e-02 3 1  ON 30
ci_0032                 1.211459e-02 3 1  ON 31
ci_0033                 7.848177e-03 3 1  ON 32
ci_0034                 8.489627e-03 3 1  ON 33
ci_0035                 4.859421e-03 3 1  ON 34
ci_0036                 4.933671e-03 3 1  ON 35
ci_0037                -1.133359e-02 3 1  ON 36
ci_0038                -1.131343e-02 3 1  ON 37
ci_0039                -4.014992e-03 3 1  ON 38
ci_0040                -3.886155e-03 3 1  ON 39
ci_0041                 9.104242e-03 3 1  ON 40
ci_0042                 8.780957e-03 3 1  ON 41
ci_0043                -1.307372e-02 3 1  ON 42
ci_0044                -1.384583e-02 3 1  ON 43
ci_0045                 1.059118e-02 3 1  ON 44
ci_0046                 1.007868e-02 3 1  ON 45
ci_0047                -3.585075e-03 3 1  ON 46
ci_0048                -3.481623e-03 3 1  ON 47
ci_0049                -2.594629e-03 3 1  ON 48
ci_0050                -2.695911e-03 3 1  ON 49
ci_0051                -1.797585e-03 3 1  ON 50
ci_0052                -2.016123e-03 3 1  ON 51
ci_0053                -3.931436e-03 3 1  ON 52
ci_0054                -3.323922e-03 3 1  ON 53
ci_0055                 2.398828e-03 3 1  ON 54
ci_0056                 2.269778e-03 3 1  ON 55
ci_0057                 2.453986e-03 3 1  ON 56
ci_0058                 2.857281e-03 3 1  ON 57
ci_0059                -3.395815e-03 3 1  ON 58
ci_0060                -3.375888e-03 3 1  ON 59
ci_0061                -3.976504e-03 3 1  ON 60
ci_0062                -3.922365e-03 3 1  ON 61
ci_0063                -9.802580e-03 3 1  ON 62
ci_0064                -9.372600e-03 3 1  ON 63
ci_0065                -6.435478e-03 3 1  ON 64
ci_0066                -6.132151e-03 3 1  ON 65
ci_0067                -3.747986e-03 3 1  ON 66
ci_0068                -3.479531e-03 3 1  ON 67
ci_0069                 3.569219e-03 3 1  ON 68
ci_0070                 3.348549e-03 3 1  ON 69
ci_0071                 3.005272e-03 3 1  ON 70
ci_0072                 3.481734e-03 3 1  ON 71
ci_0073                 3.552587e-03 3 1  ON 72
ci_0074                 3.528871e-03 3 1  ON 73
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 4.0148e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s096 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s096 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=96  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6900e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 96
    time step          = 0.05
    reference energy   = -16.9104
    reference variance = 0.187101
====================================================
  Execution time = 1.4127e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s096
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5239e+04
  VMC Eavg = -1.6898e+01
  VMC Evar = 2.9782e-01
  Total weights = 1.951104208e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 2.5759e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.285109915035
                                         uncertainty =       0.003250347597

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.285109915035
                                         uncertainty =       0.003250347597

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000377546169
  error estimate for blocks of size 2^( 2) =       0.000394885506
  error estimate for blocks of size 2^( 3) =       0.000412695268
  error estimate for blocks of size 2^( 4) =       0.000428381457
  error estimate for blocks of size 2^( 5) =       0.000440421690
  error estimate for blocks of size 2^( 6) =       0.000448912021
  error estimate for blocks of size 2^( 7) =       0.000453867346

      target function =      -0.916106777820
              le_mean =     -16.898166337510
             les_mean =     285.845848418596
             stat err =       0.000442895628
             autocorr =       1.376140107417
   target nu stat err =       0.000442895628
   target dn stat err =       0.006070209174
      target stat err =       0.009364541073
              std dev =       0.533930912023
             le_variance =       0.285082218814


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.689816633751e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 74
Check correct_vf_var_size: 225, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 8.0779e+04, overlap shift 8.0779e+05 and omega -1.7444e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.916201479427       residual = 2.43e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.916201480413       residual = 2.31e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.916201480542       residual = 5.29e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.916201480592       residual = 3.03e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.916201480648       residual = 1.56e-04           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.916201480701       residual = 1.45e-04           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.916201480681       residual = 8.52e-05           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.916201480699       residual = 7.69e-05           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.916201480693       residual = 6.96e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.916201480897       residual = 6.34e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.916201480333       residual = 1.48e-05           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.916201480537       residual = 8.32e-06           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.916201480590       residual = 2.54e-06           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.916201480789       residual = 8.87e-07           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.916201480530       residual = 1.52e-07           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.916201480698       residual = 4.45e-08           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.916201480520       residual = 1.20e-08           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.916201480557       residual = 4.96e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         17 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 8.0779e+04 is 6.801605e-09

solving harmonic davidson linear method for identity shift 3.2312e+05, overlap shift 3.2312e+06 and omega -1.7444e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.916201479427       residual = 2.43e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.916201479673       residual = 2.31e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.916201479706       residual = 5.29e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.916201479718       residual = 3.03e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.916201479825       residual = 1.56e-04           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.916201479672       residual = 1.45e-04           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.916201480125       residual = 8.52e-05           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.916201479462       residual = 7.69e-05           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.916201480611       residual = 6.96e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.916201479128       residual = 6.34e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.916201479482       residual = 1.48e-05           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.916201480211       residual = 8.32e-06           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.916201479657       residual = 2.54e-06           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.916201480362       residual = 8.87e-07           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.916201480347       residual = 1.52e-07           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.916201479452       residual = 4.45e-08           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.916201479115       residual = 1.20e-08           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.916201479745       residual = 4.96e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         17 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 3.2312e+05 is 1.700401e-09

solving harmonic davidson linear method for identity shift 1.2925e+06, overlap shift 1.2925e+07 and omega -1.7444e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.916201479427       residual = 2.43e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.916201479488       residual = 2.31e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.916201479496       residual = 5.29e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.916201479499       residual = 3.03e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.916201477826       residual = 1.56e-04           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.916201480604       residual = 1.45e-04           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.916201480559       residual = 8.52e-05           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.916201479809       residual = 7.69e-05           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.916201479140       residual = 6.96e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.916201476712       residual = 6.34e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.916201477769       residual = 1.48e-05           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.916201478270       residual = 8.32e-06           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.916201480466       residual = 2.54e-06           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.916201474569       residual = 8.87e-07           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.916201477902       residual = 1.52e-07           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.916201477901       residual = 4.45e-08           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.916201480278       residual = 1.20e-08           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.916201476521       residual = 4.96e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         17 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 1.2925e+06 is 4.251003e-10

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               1.083409 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 75 and numParams is: 74

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.6718e+01
  </log>
  <optVariables href="H2O.s096.opt.xml">
ci_0001                 7.086064e-01 3 1  ON 0
ci_0002                 6.927483e-01 3 1  ON 1
ci_0003                -3.099699e-02 3 1  ON 2
ci_0004                -3.009162e-02 3 1  ON 3
ci_0005                -3.060382e-02 3 1  ON 4
ci_0006                -3.069587e-02 3 1  ON 5
ci_0007                -1.338102e-02 3 1  ON 6
ci_0008                -1.335093e-02 3 1  ON 7
ci_0009                -1.869650e-02 3 1  ON 8
ci_0010                -1.813030e-02 3 1  ON 9
ci_0011                -1.474501e-02 3 1  ON 10
ci_0012                -1.451134e-02 3 1  ON 11
ci_0013                 1.529423e-02 3 1  ON 12
ci_0014                 1.480516e-02 3 1  ON 13
ci_0015                 1.574766e-02 3 1  ON 14
ci_0016                 1.538632e-02 3 1  ON 15
ci_0017                 1.336745e-02 3 1  ON 16
ci_0018                 1.303906e-02 3 1  ON 17
ci_0019                 1.308950e-02 3 1  ON 18
ci_0020                 1.266839e-02 3 1  ON 19
ci_0021                 6.752769e-03 3 1  ON 20
ci_0022                 7.460537e-03 3 1  ON 21
ci_0023                -1.180403e-02 3 1  ON 22
ci_0024                -1.147023e-02 3 1  ON 23
ci_0025                -2.029570e-03 3 1  ON 24
ci_0026                -2.390747e-03 3 1  ON 25
ci_0027                -1.213155e-02 3 1  ON 26
ci_0028                -1.154912e-02 3 1  ON 27
ci_0029                -1.065832e-02 3 1  ON 28
ci_0030                -1.058734e-02 3 1  ON 29
ci_0031                 1.340907e-02 3 1  ON 30
ci_0032                 1.211459e-02 3 1  ON 31
ci_0033                 7.848177e-03 3 1  ON 32
ci_0034                 8.489627e-03 3 1  ON 33
ci_0035                 4.859421e-03 3 1  ON 34
ci_0036                 4.933671e-03 3 1  ON 35
ci_0037                -1.133359e-02 3 1  ON 36
ci_0038                -1.131343e-02 3 1  ON 37
ci_0039                -4.014992e-03 3 1  ON 38
ci_0040                -3.886155e-03 3 1  ON 39
ci_0041                 9.104242e-03 3 1  ON 40
ci_0042                 8.780957e-03 3 1  ON 41
ci_0043                -1.307372e-02 3 1  ON 42
ci_0044                -1.384583e-02 3 1  ON 43
ci_0045                 1.059118e-02 3 1  ON 44
ci_0046                 1.007868e-02 3 1  ON 45
ci_0047                -3.585075e-03 3 1  ON 46
ci_0048                -3.481623e-03 3 1  ON 47
ci_0049                -2.594629e-03 3 1  ON 48
ci_0050                -2.695910e-03 3 1  ON 49
ci_0051                -1.797585e-03 3 1  ON 50
ci_0052                -2.016123e-03 3 1  ON 51
ci_0053                -3.931436e-03 3 1  ON 52
ci_0054                -3.323922e-03 3 1  ON 53
ci_0055                 2.398828e-03 3 1  ON 54
ci_0056                 2.269778e-03 3 1  ON 55
ci_0057                 2.453986e-03 3 1  ON 56
ci_0058                 2.857281e-03 3 1  ON 57
ci_0059                -3.395815e-03 3 1  ON 58
ci_0060                -3.375889e-03 3 1  ON 59
ci_0061                -3.976503e-03 3 1  ON 60
ci_0062                -3.922365e-03 3 1  ON 61
ci_0063                -9.802580e-03 3 1  ON 62
ci_0064                -9.372600e-03 3 1  ON 63
ci_0065                -6.435478e-03 3 1  ON 64
ci_0066                -6.132151e-03 3 1  ON 65
ci_0067                -3.747986e-03 3 1  ON 66
ci_0068                -3.479531e-03 3 1  ON 67
ci_0069                 3.569219e-03 3 1  ON 68
ci_0070                 3.348549e-03 3 1  ON 69
ci_0071                 3.005272e-03 3 1  ON 70
ci_0072                 3.481734e-03 3 1  ON 71
ci_0073                 3.552586e-03 3 1  ON 72
ci_0074                 3.528870e-03 3 1  ON 73
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 96
    time step          = 0.05
    reference energy   = -16.9131
    reference variance = 0.176291
====================================================
  Execution time = 1.3905e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s096
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6898e+01
  VMC Evar = 2.9135e-01
  Total weights = 1.9505e+06
  Execution time = 1.8729e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.281261931855
                                         uncertainty =       0.001306479242

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.281261931855
                                         uncertainty =       0.001306479242

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000375051764
  error estimate for blocks of size 2^( 2) =       0.000392221444
  error estimate for blocks of size 2^( 3) =       0.000409415400
  error estimate for blocks of size 2^( 4) =       0.000424133651
  error estimate for blocks of size 2^( 5) =       0.000434746359
  error estimate for blocks of size 2^( 6) =       0.000443334765
  error estimate for blocks of size 2^( 7) =       0.000447373310

      target function =      -0.926244982467
              le_mean =     -16.897910262619
             les_mean =     285.830724605644
             stat err =       0.000437397021
             autocorr =       1.360094915683
   target nu stat err =       0.000437397021
   target dn stat err =       0.002095596330
      target stat err =       0.003375119851
              std dev =       0.530403291514
             le_variance =       0.281327651649

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.281261931095
                                         uncertainty =       0.001306479154

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.281261931095
                                         uncertainty =       0.001306479154

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000375051764
  error estimate for blocks of size 2^( 2) =       0.000392221444
  error estimate for blocks of size 2^( 3) =       0.000409415400
  error estimate for blocks of size 2^( 4) =       0.000424133651
  error estimate for blocks of size 2^( 5) =       0.000434746359
  error estimate for blocks of size 2^( 6) =       0.000443334764
  error estimate for blocks of size 2^( 7) =       0.000447373310

      target function =      -0.926244989005
              le_mean =     -16.897910262689
             les_mean =     285.830724603845
             stat err =       0.000437397021
             autocorr =       1.360094917261
   target nu stat err =       0.000437397021
   target dn stat err =       0.002095595708
      target stat err =       0.003375118944
              std dev =       0.530403290784
             le_variance =       0.281327650875

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.281261931475
                                         uncertainty =       0.001306479198

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.281261931475
                                         uncertainty =       0.001306479198

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000375051764
  error estimate for blocks of size 2^( 2) =       0.000392221444
  error estimate for blocks of size 2^( 3) =       0.000409415400
  error estimate for blocks of size 2^( 4) =       0.000424133651
  error estimate for blocks of size 2^( 5) =       0.000434746359
  error estimate for blocks of size 2^( 6) =       0.000443334765
  error estimate for blocks of size 2^( 7) =       0.000447373310

      target function =      -0.926244985736
              le_mean =     -16.897910262654
             les_mean =     285.830724604745
             stat err =       0.000437397021
             autocorr =       1.360094916471
   target nu stat err =       0.000437397021
   target dn stat err =       0.002095596019
      target stat err =       0.003375119398
              std dev =       0.530403291149
             le_variance =       0.281327651262

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.281261931808
                                         uncertainty =       0.001306479236

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.281261931808
                                         uncertainty =       0.001306479236

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000375051764
  error estimate for blocks of size 2^( 2) =       0.000392221444
  error estimate for blocks of size 2^( 3) =       0.000409415400
  error estimate for blocks of size 2^( 4) =       0.000424133651
  error estimate for blocks of size 2^( 5) =       0.000434746359
  error estimate for blocks of size 2^( 6) =       0.000443334765
  error estimate for blocks of size 2^( 7) =       0.000447373310

      target function =      -0.926244982875
              le_mean =     -16.897910262624
             les_mean =     285.830724605532
             stat err =       0.000437397021
             autocorr =       1.360094915781
   target nu stat err =       0.000437397021
   target dn stat err =       0.002095596291
      target stat err =       0.003375119794
              std dev =       0.530403291469
             le_variance =       0.281327651601


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.926244982467        initial
     8.0779e+04     8.0779e+05             6.8016e-09        -0.926244989005  <--
     3.2312e+05     3.2312e+06             1.7004e-09        -0.926244985736
     1.2925e+06     1.2925e+07             4.2510e-10        -0.926244982875

*****************************************************************************
Applying the update for shift_i =   8.0779e+04     and shift_s =   8.0779e+05
*****************************************************************************

  Execution time = 2.3322e+01
  </log>
  <optVariables href="H2O.s096.opt.xml">
ci_0001                 7.086064e-01 3 1  ON 0
ci_0002                 6.927483e-01 3 1  ON 1
ci_0003                -3.099699e-02 3 1  ON 2
ci_0004                -3.009162e-02 3 1  ON 3
ci_0005                -3.060382e-02 3 1  ON 4
ci_0006                -3.069587e-02 3 1  ON 5
ci_0007                -1.338102e-02 3 1  ON 6
ci_0008                -1.335093e-02 3 1  ON 7
ci_0009                -1.869650e-02 3 1  ON 8
ci_0010                -1.813030e-02 3 1  ON 9
ci_0011                -1.474501e-02 3 1  ON 10
ci_0012                -1.451134e-02 3 1  ON 11
ci_0013                 1.529423e-02 3 1  ON 12
ci_0014                 1.480516e-02 3 1  ON 13
ci_0015                 1.574766e-02 3 1  ON 14
ci_0016                 1.538632e-02 3 1  ON 15
ci_0017                 1.336745e-02 3 1  ON 16
ci_0018                 1.303906e-02 3 1  ON 17
ci_0019                 1.308950e-02 3 1  ON 18
ci_0020                 1.266839e-02 3 1  ON 19
ci_0021                 6.752768e-03 3 1  ON 20
ci_0022                 7.460537e-03 3 1  ON 21
ci_0023                -1.180403e-02 3 1  ON 22
ci_0024                -1.147023e-02 3 1  ON 23
ci_0025                -2.029569e-03 3 1  ON 24
ci_0026                -2.390747e-03 3 1  ON 25
ci_0027                -1.213155e-02 3 1  ON 26
ci_0028                -1.154912e-02 3 1  ON 27
ci_0029                -1.065832e-02 3 1  ON 28
ci_0030                -1.058734e-02 3 1  ON 29
ci_0031                 1.340907e-02 3 1  ON 30
ci_0032                 1.211459e-02 3 1  ON 31
ci_0033                 7.848176e-03 3 1  ON 32
ci_0034                 8.489629e-03 3 1  ON 33
ci_0035                 4.859421e-03 3 1  ON 34
ci_0036                 4.933670e-03 3 1  ON 35
ci_0037                -1.133359e-02 3 1  ON 36
ci_0038                -1.131343e-02 3 1  ON 37
ci_0039                -4.014992e-03 3 1  ON 38
ci_0040                -3.886155e-03 3 1  ON 39
ci_0041                 9.104242e-03 3 1  ON 40
ci_0042                 8.780958e-03 3 1  ON 41
ci_0043                -1.307372e-02 3 1  ON 42
ci_0044                -1.384583e-02 3 1  ON 43
ci_0045                 1.059118e-02 3 1  ON 44
ci_0046                 1.007868e-02 3 1  ON 45
ci_0047                -3.585074e-03 3 1  ON 46
ci_0048                -3.481622e-03 3 1  ON 47
ci_0049                -2.594629e-03 3 1  ON 48
ci_0050                -2.695910e-03 3 1  ON 49
ci_0051                -1.797586e-03 3 1  ON 50
ci_0052                -2.016123e-03 3 1  ON 51
ci_0053                -3.931436e-03 3 1  ON 52
ci_0054                -3.323923e-03 3 1  ON 53
ci_0055                 2.398826e-03 3 1  ON 54
ci_0056                 2.269777e-03 3 1  ON 55
ci_0057                 2.453984e-03 3 1  ON 56
ci_0058                 2.857281e-03 3 1  ON 57
ci_0059                -3.395815e-03 3 1  ON 58
ci_0060                -3.375890e-03 3 1  ON 59
ci_0061                -3.976502e-03 3 1  ON 60
ci_0062                -3.922365e-03 3 1  ON 61
ci_0063                -9.802580e-03 3 1  ON 62
ci_0064                -9.372600e-03 3 1  ON 63
ci_0065                -6.435478e-03 3 1  ON 64
ci_0066                -6.132151e-03 3 1  ON 65
ci_0067                -3.747986e-03 3 1  ON 66
ci_0068                -3.479530e-03 3 1  ON 67
ci_0069                 3.569219e-03 3 1  ON 68
ci_0070                 3.348549e-03 3 1  ON 69
ci_0071                 3.005272e-03 3 1  ON 70
ci_0072                 3.481735e-03 3 1  ON 71
ci_0073                 3.552585e-03 3 1  ON 72
ci_0074                 3.528869e-03 3 1  ON 73
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 4.0083e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s097 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s097 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=97  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6900e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 97
    time step          = 0.05
    reference energy   = -16.8875
    reference variance = 0.237169
====================================================
  Execution time = 1.4097e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s097
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5231e+04
  VMC Eavg = -1.6899e+01
  VMC Evar = 2.9498e-01
  Total weights = 1.950834077e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 2.5532e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.282898914574
                                         uncertainty =       0.001509731169

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.282898914574
                                         uncertainty =       0.001509731169

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000376076494
  error estimate for blocks of size 2^( 2) =       0.000393231443
  error estimate for blocks of size 2^( 3) =       0.000410676977
  error estimate for blocks of size 2^( 4) =       0.000426169793
  error estimate for blocks of size 2^( 5) =       0.000437535701
  error estimate for blocks of size 2^( 6) =       0.000443295484
  error estimate for blocks of size 2^( 7) =       0.000447027135

      target function =      -0.920590883502
              le_mean =     -16.899069518482
             les_mean =     285.873526751191
             stat err =       0.000438507028
             autocorr =       1.359567386152
   target nu stat err =       0.000438507028
   target dn stat err =       0.002523075326
      target stat err =       0.003993630766
              std dev =       0.531852478290
             le_variance =       0.282867058663


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.689906951848e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 74
Check correct_vf_var_size: 225, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.0195e+04, overlap shift 2.0195e+05 and omega -1.7444e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.920606921723       residual = 1.60e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.920606925416       residual = 1.47e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.920606925812       residual = 2.70e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.920606925936       residual = 1.72e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.920606926008       residual = 4.82e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.920606925998       residual = 3.53e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.920606926001       residual = 1.31e-05           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.920606926019       residual = 1.59e-05           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.920606926006       residual = 1.65e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.920606926044       residual = 1.12e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.920606926018       residual = 5.36e-06           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.920606926034       residual = 1.92e-06           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.920606926093       residual = 9.29e-07           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.920606926041       residual = 2.77e-07           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.920606926075       residual = 7.87e-08           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.920606925972       residual = 1.62e-08           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.920606926060       residual = 6.65e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         16 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 2.0195e+04 is 1.537009e-08

solving harmonic davidson linear method for identity shift 8.0779e+04, overlap shift 8.0779e+05 and omega -1.7444e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.920606921723       residual = 1.60e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.920606922646       residual = 1.47e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.920606922745       residual = 2.70e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.920606922776       residual = 1.72e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.920606922910       residual = 4.82e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.920606922882       residual = 3.53e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.920606922817       residual = 1.31e-05           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.920606922679       residual = 1.59e-05           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.920606922725       residual = 1.65e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.920606922479       residual = 1.12e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.920606922716       residual = 5.36e-06           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.920606922565       residual = 1.92e-06           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.920606922745       residual = 9.29e-07           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.920606922785       residual = 2.77e-07           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.920606922901       residual = 7.87e-08           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.920606922926       residual = 1.62e-08           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.920606922590       residual = 6.65e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         16 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 8.0779e+04 is 3.842535e-09

solving harmonic davidson linear method for identity shift 3.2312e+05, overlap shift 3.2312e+06 and omega -1.7444e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.920606921723       residual = 1.60e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.920606921953       residual = 1.47e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.920606921978       residual = 2.70e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.920606921986       residual = 1.72e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.920606921868       residual = 4.82e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.920606922392       residual = 3.53e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.920606921757       residual = 1.31e-05           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.920606921901       residual = 1.59e-05           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.920606922262       residual = 1.65e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.920606923064       residual = 1.12e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.920606921161       residual = 5.36e-06           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.920606921654       residual = 1.92e-06           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.920606922199       residual = 9.29e-07           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.920606921846       residual = 2.77e-07           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.920606921322       residual = 7.87e-08           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.920606921142       residual = 1.62e-08           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.920606921992       residual = 6.65e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         16 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 3.2312e+05 is 9.606344e-10

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               1.092370 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 75 and numParams is: 74

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.6664e+01
  </log>
  <optVariables href="H2O.s097.opt.xml">
ci_0001                 7.086064e-01 3 1  ON 0
ci_0002                 6.927483e-01 3 1  ON 1
ci_0003                -3.099698e-02 3 1  ON 2
ci_0004                -3.009162e-02 3 1  ON 3
ci_0005                -3.060382e-02 3 1  ON 4
ci_0006                -3.069587e-02 3 1  ON 5
ci_0007                -1.338102e-02 3 1  ON 6
ci_0008                -1.335093e-02 3 1  ON 7
ci_0009                -1.869650e-02 3 1  ON 8
ci_0010                -1.813029e-02 3 1  ON 9
ci_0011                -1.474501e-02 3 1  ON 10
ci_0012                -1.451134e-02 3 1  ON 11
ci_0013                 1.529423e-02 3 1  ON 12
ci_0014                 1.480516e-02 3 1  ON 13
ci_0015                 1.574766e-02 3 1  ON 14
ci_0016                 1.538632e-02 3 1  ON 15
ci_0017                 1.336745e-02 3 1  ON 16
ci_0018                 1.303906e-02 3 1  ON 17
ci_0019                 1.308950e-02 3 1  ON 18
ci_0020                 1.266839e-02 3 1  ON 19
ci_0021                 6.752766e-03 3 1  ON 20
ci_0022                 7.460536e-03 3 1  ON 21
ci_0023                -1.180403e-02 3 1  ON 22
ci_0024                -1.147023e-02 3 1  ON 23
ci_0025                -2.029569e-03 3 1  ON 24
ci_0026                -2.390747e-03 3 1  ON 25
ci_0027                -1.213155e-02 3 1  ON 26
ci_0028                -1.154912e-02 3 1  ON 27
ci_0029                -1.065832e-02 3 1  ON 28
ci_0030                -1.058734e-02 3 1  ON 29
ci_0031                 1.340906e-02 3 1  ON 30
ci_0032                 1.211459e-02 3 1  ON 31
ci_0033                 7.848176e-03 3 1  ON 32
ci_0034                 8.489629e-03 3 1  ON 33
ci_0035                 4.859420e-03 3 1  ON 34
ci_0036                 4.933666e-03 3 1  ON 35
ci_0037                -1.133359e-02 3 1  ON 36
ci_0038                -1.131343e-02 3 1  ON 37
ci_0039                -4.014992e-03 3 1  ON 38
ci_0040                -3.886155e-03 3 1  ON 39
ci_0041                 9.104242e-03 3 1  ON 40
ci_0042                 8.780958e-03 3 1  ON 41
ci_0043                -1.307373e-02 3 1  ON 42
ci_0044                -1.384583e-02 3 1  ON 43
ci_0045                 1.059118e-02 3 1  ON 44
ci_0046                 1.007868e-02 3 1  ON 45
ci_0047                -3.585074e-03 3 1  ON 46
ci_0048                -3.481622e-03 3 1  ON 47
ci_0049                -2.594629e-03 3 1  ON 48
ci_0050                -2.695910e-03 3 1  ON 49
ci_0051                -1.797586e-03 3 1  ON 50
ci_0052                -2.016123e-03 3 1  ON 51
ci_0053                -3.931436e-03 3 1  ON 52
ci_0054                -3.323923e-03 3 1  ON 53
ci_0055                 2.398823e-03 3 1  ON 54
ci_0056                 2.269778e-03 3 1  ON 55
ci_0057                 2.453983e-03 3 1  ON 56
ci_0058                 2.857281e-03 3 1  ON 57
ci_0059                -3.395815e-03 3 1  ON 58
ci_0060                -3.375890e-03 3 1  ON 59
ci_0061                -3.976501e-03 3 1  ON 60
ci_0062                -3.922365e-03 3 1  ON 61
ci_0063                -9.802579e-03 3 1  ON 62
ci_0064                -9.372600e-03 3 1  ON 63
ci_0065                -6.435478e-03 3 1  ON 64
ci_0066                -6.132150e-03 3 1  ON 65
ci_0067                -3.747986e-03 3 1  ON 66
ci_0068                -3.479530e-03 3 1  ON 67
ci_0069                 3.569218e-03 3 1  ON 68
ci_0070                 3.348548e-03 3 1  ON 69
ci_0071                 3.005271e-03 3 1  ON 70
ci_0072                 3.481737e-03 3 1  ON 71
ci_0073                 3.552584e-03 3 1  ON 72
ci_0074                 3.528869e-03 3 1  ON 73
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 97
    time step          = 0.05
    reference energy   = -16.9116
    reference variance = 0.150066
====================================================
  Execution time = 1.4169e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s097
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6898e+01
  VMC Evar = 2.9124e-01
  Total weights = 1.9507e+06
  Execution time = 1.8747e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.282156493235
                                         uncertainty =       0.001682648271

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.282156493235
                                         uncertainty =       0.001682648271

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000375559395
  error estimate for blocks of size 2^( 2) =       0.000392424144
  error estimate for blocks of size 2^( 3) =       0.000409697915
  error estimate for blocks of size 2^( 4) =       0.000425800801
  error estimate for blocks of size 2^( 5) =       0.000438545062
  error estimate for blocks of size 2^( 6) =       0.000445442786
  error estimate for blocks of size 2^( 7) =       0.000450967018

      target function =      -0.926413474784
              le_mean =     -16.897964597840
             les_mean =     285.832450462852
             stat err =       0.000440188917
             autocorr =       1.373791880417
   target nu stat err =       0.000440188917
   target dn stat err =       0.002609904005
      target stat err =       0.004169991244
              std dev =       0.531121190182
             le_variance =       0.282089718660

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.282156491668
                                         uncertainty =       0.001682647835

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.282156491668
                                         uncertainty =       0.001682647835

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000375559394
  error estimate for blocks of size 2^( 2) =       0.000392424144
  error estimate for blocks of size 2^( 3) =       0.000409697915
  error estimate for blocks of size 2^( 4) =       0.000425800801
  error estimate for blocks of size 2^( 5) =       0.000438545063
  error estimate for blocks of size 2^( 6) =       0.000445442787
  error estimate for blocks of size 2^( 7) =       0.000450967019

      target function =      -0.926413484622
              le_mean =     -16.897964597823
             les_mean =     285.832450456051
             stat err =       0.000440188918
             autocorr =       1.373791892591
   target nu stat err =       0.000440188918
   target dn stat err =       0.002609898782
      target stat err =       0.004169983254
              std dev =       0.531121188716
             le_variance =       0.282089717103

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.282156492452
                                         uncertainty =       0.001682648053

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.282156492452
                                         uncertainty =       0.001682648053

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000375559395
  error estimate for blocks of size 2^( 2) =       0.000392424144
  error estimate for blocks of size 2^( 3) =       0.000409697915
  error estimate for blocks of size 2^( 4) =       0.000425800801
  error estimate for blocks of size 2^( 5) =       0.000438545063
  error estimate for blocks of size 2^( 6) =       0.000445442786
  error estimate for blocks of size 2^( 7) =       0.000450967018

      target function =      -0.926413479703
              le_mean =     -16.897964597831
             les_mean =     285.832450459451
             stat err =       0.000440188917
             autocorr =       1.373791886501
   target nu stat err =       0.000440188917
   target dn stat err =       0.002609901393
      target stat err =       0.004169987249
              std dev =       0.531121189449
             le_variance =       0.282089717882

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.282156493137
                                         uncertainty =       0.001682648243

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.282156493137
                                         uncertainty =       0.001682648243

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000375559395
  error estimate for blocks of size 2^( 2) =       0.000392424144
  error estimate for blocks of size 2^( 3) =       0.000409697915
  error estimate for blocks of size 2^( 4) =       0.000425800801
  error estimate for blocks of size 2^( 5) =       0.000438545063
  error estimate for blocks of size 2^( 6) =       0.000445442786
  error estimate for blocks of size 2^( 7) =       0.000450967018

      target function =      -0.926413475399
              le_mean =     -16.897964597839
             les_mean =     285.832450462426
             stat err =       0.000440188917
             autocorr =       1.373791881181
   target nu stat err =       0.000440188917
   target dn stat err =       0.002609903678
      target stat err =       0.004169990745
              std dev =       0.531121190090
             le_variance =       0.282089718563


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.926413474784        initial
     2.0195e+04     2.0195e+05             1.5370e-08        -0.926413484622  <--
     8.0779e+04     8.0779e+05             3.8425e-09        -0.926413479703
     3.2312e+05     3.2312e+06             9.6063e-10        -0.926413475399

*****************************************************************************
Applying the update for shift_i =   2.0195e+04     and shift_s =   2.0195e+05
*****************************************************************************

  Execution time = 2.3699e+01
  </log>
  <optVariables href="H2O.s097.opt.xml">
ci_0001                 7.086064e-01 3 1  ON 0
ci_0002                 6.927483e-01 3 1  ON 1
ci_0003                -3.099698e-02 3 1  ON 2
ci_0004                -3.009162e-02 3 1  ON 3
ci_0005                -3.060383e-02 3 1  ON 4
ci_0006                -3.069587e-02 3 1  ON 5
ci_0007                -1.338103e-02 3 1  ON 6
ci_0008                -1.335093e-02 3 1  ON 7
ci_0009                -1.869649e-02 3 1  ON 8
ci_0010                -1.813029e-02 3 1  ON 9
ci_0011                -1.474500e-02 3 1  ON 10
ci_0012                -1.451134e-02 3 1  ON 11
ci_0013                 1.529423e-02 3 1  ON 12
ci_0014                 1.480516e-02 3 1  ON 13
ci_0015                 1.574766e-02 3 1  ON 14
ci_0016                 1.538632e-02 3 1  ON 15
ci_0017                 1.336745e-02 3 1  ON 16
ci_0018                 1.303906e-02 3 1  ON 17
ci_0019                 1.308950e-02 3 1  ON 18
ci_0020                 1.266839e-02 3 1  ON 19
ci_0021                 6.752761e-03 3 1  ON 20
ci_0022                 7.460534e-03 3 1  ON 21
ci_0023                -1.180402e-02 3 1  ON 22
ci_0024                -1.147023e-02 3 1  ON 23
ci_0025                -2.029568e-03 3 1  ON 24
ci_0026                -2.390746e-03 3 1  ON 25
ci_0027                -1.213155e-02 3 1  ON 26
ci_0028                -1.154912e-02 3 1  ON 27
ci_0029                -1.065831e-02 3 1  ON 28
ci_0030                -1.058733e-02 3 1  ON 29
ci_0031                 1.340906e-02 3 1  ON 30
ci_0032                 1.211459e-02 3 1  ON 31
ci_0033                 7.848175e-03 3 1  ON 32
ci_0034                 8.489629e-03 3 1  ON 33
ci_0035                 4.859420e-03 3 1  ON 34
ci_0036                 4.933655e-03 3 1  ON 35
ci_0037                -1.133359e-02 3 1  ON 36
ci_0038                -1.131343e-02 3 1  ON 37
ci_0039                -4.014993e-03 3 1  ON 38
ci_0040                -3.886155e-03 3 1  ON 39
ci_0041                 9.104243e-03 3 1  ON 40
ci_0042                 8.780958e-03 3 1  ON 41
ci_0043                -1.307373e-02 3 1  ON 42
ci_0044                -1.384583e-02 3 1  ON 43
ci_0045                 1.059117e-02 3 1  ON 44
ci_0046                 1.007868e-02 3 1  ON 45
ci_0047                -3.585074e-03 3 1  ON 46
ci_0048                -3.481623e-03 3 1  ON 47
ci_0049                -2.594627e-03 3 1  ON 48
ci_0050                -2.695909e-03 3 1  ON 49
ci_0051                -1.797585e-03 3 1  ON 50
ci_0052                -2.016123e-03 3 1  ON 51
ci_0053                -3.931433e-03 3 1  ON 52
ci_0054                -3.323923e-03 3 1  ON 53
ci_0055                 2.398815e-03 3 1  ON 54
ci_0056                 2.269780e-03 3 1  ON 55
ci_0057                 2.453977e-03 3 1  ON 56
ci_0058                 2.857281e-03 3 1  ON 57
ci_0059                -3.395815e-03 3 1  ON 58
ci_0060                -3.375889e-03 3 1  ON 59
ci_0061                -3.976499e-03 3 1  ON 60
ci_0062                -3.922366e-03 3 1  ON 61
ci_0063                -9.802577e-03 3 1  ON 62
ci_0064                -9.372599e-03 3 1  ON 63
ci_0065                -6.435476e-03 3 1  ON 64
ci_0066                -6.132148e-03 3 1  ON 65
ci_0067                -3.747986e-03 3 1  ON 66
ci_0068                -3.479532e-03 3 1  ON 67
ci_0069                 3.569215e-03 3 1  ON 68
ci_0070                 3.348545e-03 3 1  ON 69
ci_0071                 3.005270e-03 3 1  ON 70
ci_0072                 3.481741e-03 3 1  ON 71
ci_0073                 3.552580e-03 3 1  ON 72
ci_0074                 3.528867e-03 3 1  ON 73
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 4.0385e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s098 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s098 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=98  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6900e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 98
    time step          = 0.05
    reference energy   = -16.8359
    reference variance = 0.679265
====================================================
  Execution time = 1.4058e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s098
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5244e+04
  VMC Eavg = -1.6899e+01
  VMC Evar = 2.9222e-01
  Total weights = 1.950658131e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 2.5636e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.282176266758
                                         uncertainty =       0.001599624395

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.282176266758
                                         uncertainty =       0.001599624395

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000375667567
  error estimate for blocks of size 2^( 2) =       0.000392700064
  error estimate for blocks of size 2^( 3) =       0.000409559757
  error estimate for blocks of size 2^( 4) =       0.000424736321
  error estimate for blocks of size 2^( 5) =       0.000436051695
  error estimate for blocks of size 2^( 6) =       0.000442631581
  error estimate for blocks of size 2^( 7) =       0.000447390393

      target function =      -0.924898372302
              le_mean =     -16.899018231636
             les_mean =     285.869038740075
             stat err =       0.000437702497
             autocorr =       1.357533777773
   target nu stat err =       0.000437702497
   target dn stat err =       0.002221690470
      target stat err =       0.003565860104
              std dev =       0.531274168448
             le_variance =       0.282252242060


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.689901823164e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 74
Check correct_vf_var_size: 225, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 5.0487e+03, overlap shift 5.0487e+04 and omega -1.7444e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.924910773785       residual = 5.00e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.924910778424       residual = 9.37e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.924910779573       residual = 4.86e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.924910780211       residual = 1.80e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.924910780433       residual = 8.14e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.924910780552       residual = 3.46e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.924910780587       residual = 8.38e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.924910780583       residual = 2.48e-06           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.924910780577       residual = 1.19e-06           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.924910780582       residual = 3.36e-07           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.924910780582       residual = 1.98e-07           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.924910780599       residual = 1.03e-07           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.924910780584       residual = 1.07e-07           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.924910780575       residual = 7.33e-08           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.924910780590       residual = 7.95e-08           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.924910780586       residual = 2.39e-08           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.924910780590       residual = 7.28e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         16 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 5.0487e+03 is 4.256185e-08

solving harmonic davidson linear method for identity shift 2.0195e+04, overlap shift 2.0195e+05 and omega -1.7444e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.924910773785       residual = 5.00e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.924910774945       residual = 9.37e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.924910775232       residual = 4.86e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.924910775392       residual = 1.80e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.924910775447       residual = 8.14e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.924910775479       residual = 3.46e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.924910775475       residual = 8.38e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.924910775483       residual = 2.48e-06           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.924910775483       residual = 1.19e-06           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.924910775484       residual = 3.36e-07           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.924910775477       residual = 1.98e-07           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.924910775467       residual = 1.03e-07           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.924910775479       residual = 1.07e-07           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.924910775532       residual = 7.33e-08           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.924910775506       residual = 7.95e-08           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.924910775443       residual = 2.39e-08           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.924910775482       residual = 7.28e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         16 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 2.0195e+04 is 1.064052e-08

solving harmonic davidson linear method for identity shift 8.0779e+04, overlap shift 8.0779e+05 and omega -1.7444e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.924910773785       residual = 5.00e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.924910774075       residual = 9.37e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.924910774147       residual = 4.86e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.924910774187       residual = 1.80e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.924910774247       residual = 8.14e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.924910774208       residual = 3.46e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.924910774258       residual = 8.38e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.924910774369       residual = 2.48e-06           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.924910774182       residual = 1.19e-06           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.924910774122       residual = 3.36e-07           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.924910774345       residual = 1.98e-07           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.924910774292       residual = 1.03e-07           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.924910774290       residual = 1.07e-07           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.924910774503       residual = 7.33e-08           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.924910774383       residual = 7.95e-08           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.924910774055       residual = 2.39e-08           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.924910774319       residual = 7.28e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         16 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 8.0779e+04 is 2.660135e-09

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               1.101344 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 75 and numParams is: 74

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.6636e+01
  </log>
  <optVariables href="H2O.s098.opt.xml">
ci_0001                 7.086064e-01 3 1  ON 0
ci_0002                 6.927483e-01 3 1  ON 1
ci_0003                -3.099698e-02 3 1  ON 2
ci_0004                -3.009162e-02 3 1  ON 3
ci_0005                -3.060383e-02 3 1  ON 4
ci_0006                -3.069587e-02 3 1  ON 5
ci_0007                -1.338102e-02 3 1  ON 6
ci_0008                -1.335092e-02 3 1  ON 7
ci_0009                -1.869649e-02 3 1  ON 8
ci_0010                -1.813029e-02 3 1  ON 9
ci_0011                -1.474501e-02 3 1  ON 10
ci_0012                -1.451134e-02 3 1  ON 11
ci_0013                 1.529423e-02 3 1  ON 12
ci_0014                 1.480516e-02 3 1  ON 13
ci_0015                 1.574766e-02 3 1  ON 14
ci_0016                 1.538632e-02 3 1  ON 15
ci_0017                 1.336745e-02 3 1  ON 16
ci_0018                 1.303907e-02 3 1  ON 17
ci_0019                 1.308950e-02 3 1  ON 18
ci_0020                 1.266839e-02 3 1  ON 19
ci_0021                 6.752757e-03 3 1  ON 20
ci_0022                 7.460535e-03 3 1  ON 21
ci_0023                -1.180402e-02 3 1  ON 22
ci_0024                -1.147023e-02 3 1  ON 23
ci_0025                -2.029567e-03 3 1  ON 24
ci_0026                -2.390744e-03 3 1  ON 25
ci_0027                -1.213155e-02 3 1  ON 26
ci_0028                -1.154912e-02 3 1  ON 27
ci_0029                -1.065831e-02 3 1  ON 28
ci_0030                -1.058734e-02 3 1  ON 29
ci_0031                 1.340906e-02 3 1  ON 30
ci_0032                 1.211459e-02 3 1  ON 31
ci_0033                 7.848172e-03 3 1  ON 32
ci_0034                 8.489622e-03 3 1  ON 33
ci_0035                 4.859423e-03 3 1  ON 34
ci_0036                 4.933651e-03 3 1  ON 35
ci_0037                -1.133359e-02 3 1  ON 36
ci_0038                -1.131343e-02 3 1  ON 37
ci_0039                -4.014992e-03 3 1  ON 38
ci_0040                -3.886155e-03 3 1  ON 39
ci_0041                 9.104242e-03 3 1  ON 40
ci_0042                 8.780960e-03 3 1  ON 41
ci_0043                -1.307374e-02 3 1  ON 42
ci_0044                -1.384584e-02 3 1  ON 43
ci_0045                 1.059117e-02 3 1  ON 44
ci_0046                 1.007868e-02 3 1  ON 45
ci_0047                -3.585073e-03 3 1  ON 46
ci_0048                -3.481623e-03 3 1  ON 47
ci_0049                -2.594628e-03 3 1  ON 48
ci_0050                -2.695905e-03 3 1  ON 49
ci_0051                -1.797584e-03 3 1  ON 50
ci_0052                -2.016122e-03 3 1  ON 51
ci_0053                -3.931431e-03 3 1  ON 52
ci_0054                -3.323923e-03 3 1  ON 53
ci_0055                 2.398813e-03 3 1  ON 54
ci_0056                 2.269783e-03 3 1  ON 55
ci_0057                 2.453978e-03 3 1  ON 56
ci_0058                 2.857280e-03 3 1  ON 57
ci_0059                -3.395819e-03 3 1  ON 58
ci_0060                -3.375887e-03 3 1  ON 59
ci_0061                -3.976496e-03 3 1  ON 60
ci_0062                -3.922366e-03 3 1  ON 61
ci_0063                -9.802577e-03 3 1  ON 62
ci_0064                -9.372600e-03 3 1  ON 63
ci_0065                -6.435474e-03 3 1  ON 64
ci_0066                -6.132148e-03 3 1  ON 65
ci_0067                -3.747986e-03 3 1  ON 66
ci_0068                -3.479531e-03 3 1  ON 67
ci_0069                 3.569217e-03 3 1  ON 68
ci_0070                 3.348544e-03 3 1  ON 69
ci_0071                 3.005273e-03 3 1  ON 70
ci_0072                 3.481741e-03 3 1  ON 71
ci_0073                 3.552580e-03 3 1  ON 72
ci_0074                 3.528867e-03 3 1  ON 73
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 98
    time step          = 0.05
    reference energy   = -16.8633
    reference variance = 0.243928
====================================================
  Execution time = 1.4039e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s098
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6899e+01
  VMC Evar = 2.9802e-01
  Total weights = 1.9506e+06
  Execution time = 1.8785e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.284133670151
                                         uncertainty =       0.002007407024

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.284133670151
                                         uncertainty =       0.002007407024

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000376894136
  error estimate for blocks of size 2^( 2) =       0.000394107274
  error estimate for blocks of size 2^( 3) =       0.000411956647
  error estimate for blocks of size 2^( 4) =       0.000428003459
  error estimate for blocks of size 2^( 5) =       0.000442618263
  error estimate for blocks of size 2^( 6) =       0.000453498938
  error estimate for blocks of size 2^( 7) =       0.000462751748

      target function =      -0.915856181488
              le_mean =     -16.898847930676
             les_mean =     285.869083476080
             stat err =       0.000446718102
             autocorr =       1.404844780389
   target nu stat err =       0.000446718102
   target dn stat err =       0.003891719526
      target stat err =       0.006035510725
              std dev =       0.533008798607
             le_variance =       0.284098379392

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.284133667767
                                         uncertainty =       0.002007406201

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.284133667767
                                         uncertainty =       0.002007406201

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000376894134
  error estimate for blocks of size 2^( 2) =       0.000394107273
  error estimate for blocks of size 2^( 3) =       0.000411956647
  error estimate for blocks of size 2^( 4) =       0.000428003459
  error estimate for blocks of size 2^( 5) =       0.000442618263
  error estimate for blocks of size 2^( 6) =       0.000453498938
  error estimate for blocks of size 2^( 7) =       0.000462751749

      target function =      -0.915856179788
              le_mean =     -16.898847930787
             les_mean =     285.869083480941
             stat err =       0.000446718102
             autocorr =       1.404844793524
   target nu stat err =       0.000446718102
   target dn stat err =       0.003891717790
      target stat err =       0.006035508054
              std dev =       0.533008796369
             le_variance =       0.284098377007

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.284133668959
                                         uncertainty =       0.002007406612

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.284133668959
                                         uncertainty =       0.002007406612

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000376894135
  error estimate for blocks of size 2^( 2) =       0.000394107273
  error estimate for blocks of size 2^( 3) =       0.000411956647
  error estimate for blocks of size 2^( 4) =       0.000428003459
  error estimate for blocks of size 2^( 5) =       0.000442618263
  error estimate for blocks of size 2^( 6) =       0.000453498938
  error estimate for blocks of size 2^( 7) =       0.000462751748

      target function =      -0.915856180641
              le_mean =     -16.898847930732
             les_mean =     285.869083478509
             stat err =       0.000446718102
             autocorr =       1.404844786952
   target nu stat err =       0.000446718102
   target dn stat err =       0.003891718658
      target stat err =       0.006035509390
              std dev =       0.533008797488
             le_variance =       0.284098378200

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.284133670002
                                         uncertainty =       0.002007406973

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.284133670002
                                         uncertainty =       0.002007406973

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000376894136
  error estimate for blocks of size 2^( 2) =       0.000394107274
  error estimate for blocks of size 2^( 3) =       0.000411956647
  error estimate for blocks of size 2^( 4) =       0.000428003459
  error estimate for blocks of size 2^( 5) =       0.000442618263
  error estimate for blocks of size 2^( 6) =       0.000453498938
  error estimate for blocks of size 2^( 7) =       0.000462751748

      target function =      -0.915856181382
              le_mean =     -16.898847930683
             les_mean =     285.869083476383
             stat err =       0.000446718102
             autocorr =       1.404844781203
   target nu stat err =       0.000446718102
   target dn stat err =       0.003891719418
      target stat err =       0.006035510558
              std dev =       0.533008798467
             le_variance =       0.284098379243


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.915856181488        initial  <--
     5.0487e+03     5.0487e+04             4.2562e-08        -0.915856179788
     2.0195e+04     2.0195e+05             1.0641e-08        -0.915856180641
     8.0779e+04     8.0779e+05             2.6601e-09        -0.915856181382

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 23.5051
  </log>
  <optVariables href="H2O.s098.opt.xml">
ci_0001                 7.086064e-01 3 1  ON 0
ci_0002                 6.927483e-01 3 1  ON 1
ci_0003                -3.099698e-02 3 1  ON 2
ci_0004                -3.009162e-02 3 1  ON 3
ci_0005                -3.060383e-02 3 1  ON 4
ci_0006                -3.069587e-02 3 1  ON 5
ci_0007                -1.338103e-02 3 1  ON 6
ci_0008                -1.335093e-02 3 1  ON 7
ci_0009                -1.869649e-02 3 1  ON 8
ci_0010                -1.813029e-02 3 1  ON 9
ci_0011                -1.474500e-02 3 1  ON 10
ci_0012                -1.451134e-02 3 1  ON 11
ci_0013                 1.529423e-02 3 1  ON 12
ci_0014                 1.480516e-02 3 1  ON 13
ci_0015                 1.574766e-02 3 1  ON 14
ci_0016                 1.538632e-02 3 1  ON 15
ci_0017                 1.336745e-02 3 1  ON 16
ci_0018                 1.303906e-02 3 1  ON 17
ci_0019                 1.308950e-02 3 1  ON 18
ci_0020                 1.266839e-02 3 1  ON 19
ci_0021                 6.752761e-03 3 1  ON 20
ci_0022                 7.460534e-03 3 1  ON 21
ci_0023                -1.180402e-02 3 1  ON 22
ci_0024                -1.147023e-02 3 1  ON 23
ci_0025                -2.029568e-03 3 1  ON 24
ci_0026                -2.390746e-03 3 1  ON 25
ci_0027                -1.213155e-02 3 1  ON 26
ci_0028                -1.154912e-02 3 1  ON 27
ci_0029                -1.065831e-02 3 1  ON 28
ci_0030                -1.058733e-02 3 1  ON 29
ci_0031                 1.340906e-02 3 1  ON 30
ci_0032                 1.211459e-02 3 1  ON 31
ci_0033                 7.848175e-03 3 1  ON 32
ci_0034                 8.489629e-03 3 1  ON 33
ci_0035                 4.859420e-03 3 1  ON 34
ci_0036                 4.933655e-03 3 1  ON 35
ci_0037                -1.133359e-02 3 1  ON 36
ci_0038                -1.131343e-02 3 1  ON 37
ci_0039                -4.014993e-03 3 1  ON 38
ci_0040                -3.886155e-03 3 1  ON 39
ci_0041                 9.104243e-03 3 1  ON 40
ci_0042                 8.780958e-03 3 1  ON 41
ci_0043                -1.307373e-02 3 1  ON 42
ci_0044                -1.384583e-02 3 1  ON 43
ci_0045                 1.059117e-02 3 1  ON 44
ci_0046                 1.007868e-02 3 1  ON 45
ci_0047                -3.585074e-03 3 1  ON 46
ci_0048                -3.481623e-03 3 1  ON 47
ci_0049                -2.594627e-03 3 1  ON 48
ci_0050                -2.695909e-03 3 1  ON 49
ci_0051                -1.797585e-03 3 1  ON 50
ci_0052                -2.016123e-03 3 1  ON 51
ci_0053                -3.931433e-03 3 1  ON 52
ci_0054                -3.323923e-03 3 1  ON 53
ci_0055                 2.398815e-03 3 1  ON 54
ci_0056                 2.269780e-03 3 1  ON 55
ci_0057                 2.453977e-03 3 1  ON 56
ci_0058                 2.857281e-03 3 1  ON 57
ci_0059                -3.395815e-03 3 1  ON 58
ci_0060                -3.375889e-03 3 1  ON 59
ci_0061                -3.976499e-03 3 1  ON 60
ci_0062                -3.922366e-03 3 1  ON 61
ci_0063                -9.802577e-03 3 1  ON 62
ci_0064                -9.372599e-03 3 1  ON 63
ci_0065                -6.435476e-03 3 1  ON 64
ci_0066                -6.132148e-03 3 1  ON 65
ci_0067                -3.747986e-03 3 1  ON 66
ci_0068                -3.479532e-03 3 1  ON 67
ci_0069                 3.569215e-03 3 1  ON 68
ci_0070                 3.348545e-03 3 1  ON 69
ci_0071                 3.005270e-03 3 1  ON 70
ci_0072                 3.481741e-03 3 1  ON 71
ci_0073                 3.552580e-03 3 1  ON 72
ci_0074                 3.528867e-03 3 1  ON 73
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 4.0146e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s099 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s099 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=99  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6900e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 99
    time step          = 0.05
    reference energy   = -16.8928
    reference variance = 0.450296
====================================================
  Execution time = 1.6147e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s099
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5267e+04
  VMC Eavg = -1.6899e+01
  VMC Evar = 2.9370e-01
  Total weights = 1.950909556e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 2.5522e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.283888881839
                                         uncertainty =       0.001953243419

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.283888881839
                                         uncertainty =       0.001953243419

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000376814011
  error estimate for blocks of size 2^( 2) =       0.000393754489
  error estimate for blocks of size 2^( 3) =       0.000410907210
  error estimate for blocks of size 2^( 4) =       0.000426194315
  error estimate for blocks of size 2^( 5) =       0.000438481345
  error estimate for blocks of size 2^( 6) =       0.000445554462
  error estimate for blocks of size 2^( 7) =       0.000449789503

      target function =      -0.922580850653
              le_mean =     -16.899044339434
             les_mean =     285.871400829074
             stat err =       0.000440004906
             autocorr =       1.363518243003
   target nu stat err =       0.000440004906
   target dn stat err =       0.002293303452
      target stat err =       0.003658833533
              std dev =       0.532895484666
             le_variance =       0.283977597578


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.689904433943e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 74
Check correct_vf_var_size: 225, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 5.0487e+04, overlap shift 5.0487e+05 and omega -1.7444e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.922593973059       residual = 3.79e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.922593973356       residual = 4.74e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.922593973417       residual = 2.56e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.922593973441       residual = 7.48e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.922593973455       residual = 3.13e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.922593973466       residual = 1.75e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.922593973459       residual = 8.23e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.922593973457       residual = 1.08e-05           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.922593973488       residual = 9.72e-06           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.922593973468       residual = 8.04e-06           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.922593973458       residual = 2.82e-06           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.922593973479       residual = 1.04e-06           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.922593973442       residual = 3.90e-07           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.922593973469       residual = 1.15e-07           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.922593973443       residual = 3.35e-08           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.922593973417       residual = 1.47e-08           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.922593973610       residual = 3.43e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         16 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 5.0487e+04 is 3.964551e-09

solving harmonic davidson linear method for identity shift 2.0195e+05, overlap shift 2.0195e+06 and omega -1.7444e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.922593973059       residual = 3.79e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.922593973133       residual = 4.74e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.922593973148       residual = 2.56e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.922593973154       residual = 7.48e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.922593973158       residual = 3.13e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.922593973031       residual = 1.75e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.922593973343       residual = 8.23e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.922593973158       residual = 1.08e-05           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.922593973348       residual = 9.72e-06           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.922593973159       residual = 8.04e-06           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.922593973015       residual = 2.82e-06           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.922593972886       residual = 1.04e-06           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.922593973422       residual = 3.90e-07           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.922593972873       residual = 1.15e-07           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.922593972785       residual = 3.35e-08           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.922593973021       residual = 1.47e-08           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.922593973089       residual = 3.43e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         16 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 2.0195e+05 is 9.911379e-10

solving harmonic davidson linear method for identity shift 8.0779e+05, overlap shift 8.0779e+06 and omega -1.7444e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.922593973059       residual = 3.79e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.922593973077       residual = 4.74e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.922593973081       residual = 2.56e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.922593973083       residual = 7.48e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.922593973084       residual = 3.13e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.922593973084       residual = 1.75e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.922593973116       residual = 8.23e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.922593974019       residual = 1.08e-05           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.922593973084       residual = 9.72e-06           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.922593973084       residual = 8.04e-06           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.922593973084       residual = 2.82e-06           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.922593974798       residual = 1.04e-06           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.922593972225       residual = 3.90e-07           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.922593973084       residual = 1.15e-07           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.922593973462       residual = 3.35e-08           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.922593973548       residual = 1.47e-08           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.922593973028       residual = 3.43e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         16 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 8.0779e+05 is 2.477844e-10

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               1.110310 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 75 and numParams is: 74

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.8713e+01
  </log>
  <optVariables href="H2O.s099.opt.xml">
ci_0001                 7.086064e-01 3 1  ON 0
ci_0002                 6.927483e-01 3 1  ON 1
ci_0003                -3.099698e-02 3 1  ON 2
ci_0004                -3.009162e-02 3 1  ON 3
ci_0005                -3.060383e-02 3 1  ON 4
ci_0006                -3.069587e-02 3 1  ON 5
ci_0007                -1.338103e-02 3 1  ON 6
ci_0008                -1.335093e-02 3 1  ON 7
ci_0009                -1.869649e-02 3 1  ON 8
ci_0010                -1.813029e-02 3 1  ON 9
ci_0011                -1.474500e-02 3 1  ON 10
ci_0012                -1.451134e-02 3 1  ON 11
ci_0013                 1.529423e-02 3 1  ON 12
ci_0014                 1.480516e-02 3 1  ON 13
ci_0015                 1.574766e-02 3 1  ON 14
ci_0016                 1.538632e-02 3 1  ON 15
ci_0017                 1.336745e-02 3 1  ON 16
ci_0018                 1.303906e-02 3 1  ON 17
ci_0019                 1.308950e-02 3 1  ON 18
ci_0020                 1.266839e-02 3 1  ON 19
ci_0021                 6.752760e-03 3 1  ON 20
ci_0022                 7.460534e-03 3 1  ON 21
ci_0023                -1.180402e-02 3 1  ON 22
ci_0024                -1.147023e-02 3 1  ON 23
ci_0025                -2.029568e-03 3 1  ON 24
ci_0026                -2.390745e-03 3 1  ON 25
ci_0027                -1.213155e-02 3 1  ON 26
ci_0028                -1.154912e-02 3 1  ON 27
ci_0029                -1.065831e-02 3 1  ON 28
ci_0030                -1.058733e-02 3 1  ON 29
ci_0031                 1.340906e-02 3 1  ON 30
ci_0032                 1.211458e-02 3 1  ON 31
ci_0033                 7.848175e-03 3 1  ON 32
ci_0034                 8.489629e-03 3 1  ON 33
ci_0035                 4.859420e-03 3 1  ON 34
ci_0036                 4.933655e-03 3 1  ON 35
ci_0037                -1.133359e-02 3 1  ON 36
ci_0038                -1.131343e-02 3 1  ON 37
ci_0039                -4.014993e-03 3 1  ON 38
ci_0040                -3.886155e-03 3 1  ON 39
ci_0041                 9.104243e-03 3 1  ON 40
ci_0042                 8.780958e-03 3 1  ON 41
ci_0043                -1.307373e-02 3 1  ON 42
ci_0044                -1.384583e-02 3 1  ON 43
ci_0045                 1.059117e-02 3 1  ON 44
ci_0046                 1.007868e-02 3 1  ON 45
ci_0047                -3.585074e-03 3 1  ON 46
ci_0048                -3.481623e-03 3 1  ON 47
ci_0049                -2.594628e-03 3 1  ON 48
ci_0050                -2.695909e-03 3 1  ON 49
ci_0051                -1.797585e-03 3 1  ON 50
ci_0052                -2.016123e-03 3 1  ON 51
ci_0053                -3.931433e-03 3 1  ON 52
ci_0054                -3.323924e-03 3 1  ON 53
ci_0055                 2.398815e-03 3 1  ON 54
ci_0056                 2.269780e-03 3 1  ON 55
ci_0057                 2.453978e-03 3 1  ON 56
ci_0058                 2.857281e-03 3 1  ON 57
ci_0059                -3.395815e-03 3 1  ON 58
ci_0060                -3.375889e-03 3 1  ON 59
ci_0061                -3.976499e-03 3 1  ON 60
ci_0062                -3.922366e-03 3 1  ON 61
ci_0063                -9.802577e-03 3 1  ON 62
ci_0064                -9.372599e-03 3 1  ON 63
ci_0065                -6.435476e-03 3 1  ON 64
ci_0066                -6.132148e-03 3 1  ON 65
ci_0067                -3.747986e-03 3 1  ON 66
ci_0068                -3.479532e-03 3 1  ON 67
ci_0069                 3.569215e-03 3 1  ON 68
ci_0070                 3.348545e-03 3 1  ON 69
ci_0071                 3.005270e-03 3 1  ON 70
ci_0072                 3.481741e-03 3 1  ON 71
ci_0073                 3.552580e-03 3 1  ON 72
ci_0074                 3.528867e-03 3 1  ON 73
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 99
    time step          = 0.05
    reference energy   = -16.9734
    reference variance = 0.240523
====================================================
  Execution time = 1.6334e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s099
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6899e+01
  VMC Evar = 2.9839e-01
  Total weights = 1.9510e+06
  Execution time = 1.8637e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.286152312090
                                         uncertainty =       0.002086804200

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.286152312090
                                         uncertainty =       0.002086804200

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000378335229
  error estimate for blocks of size 2^( 2) =       0.000395226222
  error estimate for blocks of size 2^( 3) =       0.000412336830
  error estimate for blocks of size 2^( 4) =       0.000427052826
  error estimate for blocks of size 2^( 5) =       0.000439431138
  error estimate for blocks of size 2^( 6) =       0.000445749526
  error estimate for blocks of size 2^( 7) =       0.000452533575

      target function =      -0.915294458399
              le_mean =     -16.898654176537
             les_mean =     285.862907596011
             stat err =       0.000441191766
             autocorr =       1.359882024012
   target nu stat err =       0.000441191766
   target dn stat err =       0.003295265188
      target stat err =       0.005116622924
              std dev =       0.535046811351
             le_variance =       0.286275090337

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.286152312017
                                         uncertainty =       0.002086804158

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.286152312017
                                         uncertainty =       0.002086804158

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000378335229
  error estimate for blocks of size 2^( 2) =       0.000395226222
  error estimate for blocks of size 2^( 3) =       0.000412336830
  error estimate for blocks of size 2^( 4) =       0.000427052826
  error estimate for blocks of size 2^( 5) =       0.000439431138
  error estimate for blocks of size 2^( 6) =       0.000445749526
  error estimate for blocks of size 2^( 7) =       0.000452533575

      target function =      -0.915294450031
              le_mean =     -16.898654176557
             les_mean =     285.862907602098
             stat err =       0.000441191766
             autocorr =       1.359882023675
   target nu stat err =       0.000441191766
   target dn stat err =       0.003295268363
      target stat err =       0.005116627659
              std dev =       0.535046811286
             le_variance =       0.286275090268

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.286152312054
                                         uncertainty =       0.002086804179

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.286152312054
                                         uncertainty =       0.002086804179

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000378335229
  error estimate for blocks of size 2^( 2) =       0.000395226222
  error estimate for blocks of size 2^( 3) =       0.000412336830
  error estimate for blocks of size 2^( 4) =       0.000427052826
  error estimate for blocks of size 2^( 5) =       0.000439431138
  error estimate for blocks of size 2^( 6) =       0.000445749526
  error estimate for blocks of size 2^( 7) =       0.000452533575

      target function =      -0.915294454215
              le_mean =     -16.898654176547
             les_mean =     285.862907599054
             stat err =       0.000441191766
             autocorr =       1.359882023838
   target nu stat err =       0.000441191766
   target dn stat err =       0.003295266776
      target stat err =       0.005116625291
              std dev =       0.535046811319
             le_variance =       0.286275090302

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.286152312085
                                         uncertainty =       0.002086804197

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.286152312085
                                         uncertainty =       0.002086804197

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000378335229
  error estimate for blocks of size 2^( 2) =       0.000395226222
  error estimate for blocks of size 2^( 3) =       0.000412336830
  error estimate for blocks of size 2^( 4) =       0.000427052826
  error estimate for blocks of size 2^( 5) =       0.000439431138
  error estimate for blocks of size 2^( 6) =       0.000445749526
  error estimate for blocks of size 2^( 7) =       0.000452533575

      target function =      -0.915294457876
              le_mean =     -16.898654176539
             les_mean =     285.862907596391
             stat err =       0.000441191766
             autocorr =       1.359882023996
   target nu stat err =       0.000441191766
   target dn stat err =       0.003295265386
      target stat err =       0.005116623220
              std dev =       0.535046811347
             le_variance =       0.286275090332


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.915294458399        initial  <--
     5.0487e+04     5.0487e+05             3.9646e-09        -0.915294450031
     2.0195e+05     2.0195e+06             9.9114e-10        -0.915294454215
     8.0779e+05     8.0779e+06             2.4778e-10        -0.915294457876

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 25.7127
  </log>
  <optVariables href="H2O.s099.opt.xml">
ci_0001                 7.086064e-01 3 1  ON 0
ci_0002                 6.927483e-01 3 1  ON 1
ci_0003                -3.099698e-02 3 1  ON 2
ci_0004                -3.009162e-02 3 1  ON 3
ci_0005                -3.060383e-02 3 1  ON 4
ci_0006                -3.069587e-02 3 1  ON 5
ci_0007                -1.338103e-02 3 1  ON 6
ci_0008                -1.335093e-02 3 1  ON 7
ci_0009                -1.869649e-02 3 1  ON 8
ci_0010                -1.813029e-02 3 1  ON 9
ci_0011                -1.474500e-02 3 1  ON 10
ci_0012                -1.451134e-02 3 1  ON 11
ci_0013                 1.529423e-02 3 1  ON 12
ci_0014                 1.480516e-02 3 1  ON 13
ci_0015                 1.574766e-02 3 1  ON 14
ci_0016                 1.538632e-02 3 1  ON 15
ci_0017                 1.336745e-02 3 1  ON 16
ci_0018                 1.303906e-02 3 1  ON 17
ci_0019                 1.308950e-02 3 1  ON 18
ci_0020                 1.266839e-02 3 1  ON 19
ci_0021                 6.752761e-03 3 1  ON 20
ci_0022                 7.460534e-03 3 1  ON 21
ci_0023                -1.180402e-02 3 1  ON 22
ci_0024                -1.147023e-02 3 1  ON 23
ci_0025                -2.029568e-03 3 1  ON 24
ci_0026                -2.390746e-03 3 1  ON 25
ci_0027                -1.213155e-02 3 1  ON 26
ci_0028                -1.154912e-02 3 1  ON 27
ci_0029                -1.065831e-02 3 1  ON 28
ci_0030                -1.058733e-02 3 1  ON 29
ci_0031                 1.340906e-02 3 1  ON 30
ci_0032                 1.211459e-02 3 1  ON 31
ci_0033                 7.848175e-03 3 1  ON 32
ci_0034                 8.489629e-03 3 1  ON 33
ci_0035                 4.859420e-03 3 1  ON 34
ci_0036                 4.933655e-03 3 1  ON 35
ci_0037                -1.133359e-02 3 1  ON 36
ci_0038                -1.131343e-02 3 1  ON 37
ci_0039                -4.014993e-03 3 1  ON 38
ci_0040                -3.886155e-03 3 1  ON 39
ci_0041                 9.104243e-03 3 1  ON 40
ci_0042                 8.780958e-03 3 1  ON 41
ci_0043                -1.307373e-02 3 1  ON 42
ci_0044                -1.384583e-02 3 1  ON 43
ci_0045                 1.059117e-02 3 1  ON 44
ci_0046                 1.007868e-02 3 1  ON 45
ci_0047                -3.585074e-03 3 1  ON 46
ci_0048                -3.481623e-03 3 1  ON 47
ci_0049                -2.594627e-03 3 1  ON 48
ci_0050                -2.695909e-03 3 1  ON 49
ci_0051                -1.797585e-03 3 1  ON 50
ci_0052                -2.016123e-03 3 1  ON 51
ci_0053                -3.931433e-03 3 1  ON 52
ci_0054                -3.323923e-03 3 1  ON 53
ci_0055                 2.398815e-03 3 1  ON 54
ci_0056                 2.269780e-03 3 1  ON 55
ci_0057                 2.453977e-03 3 1  ON 56
ci_0058                 2.857281e-03 3 1  ON 57
ci_0059                -3.395815e-03 3 1  ON 58
ci_0060                -3.375889e-03 3 1  ON 59
ci_0061                -3.976499e-03 3 1  ON 60
ci_0062                -3.922366e-03 3 1  ON 61
ci_0063                -9.802577e-03 3 1  ON 62
ci_0064                -9.372599e-03 3 1  ON 63
ci_0065                -6.435476e-03 3 1  ON 64
ci_0066                -6.132148e-03 3 1  ON 65
ci_0067                -3.747986e-03 3 1  ON 66
ci_0068                -3.479532e-03 3 1  ON 67
ci_0069                 3.569215e-03 3 1  ON 68
ci_0070                 3.348545e-03 3 1  ON 69
ci_0071                 3.005270e-03 3 1  ON 70
ci_0072                 3.481741e-03 3 1  ON 71
ci_0073                 3.552580e-03 3 1  ON 72
ci_0074                 3.528867e-03 3 1  ON 73
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 4.4430e+01 secs
  Total Execution time = 4.1091e+03 secs

=========================================================
  A new xml input file : H2O.s099.cont.xml
